<!--  RSS generated by JIRA (Enterprise Edition, Version: 3.13.5-#360) at Tue Feb 02 19:49:10 UTC 2010 -->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="http://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>http://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&amp;pid=12310780&amp;sorter/field=issuekey&amp;sorter/order=DESC</link>
    <description>An XML representation of a search request</description>
    <language>en-uk</language>     <issue start="0" end="637" total="637" />     <build-info>
        <version>3.13.5</version>
        <build-number>360</build-number>
        <build-date>07-07-2009</build-date>
        <edition>Enterprise</edition>
    </build-info>

<item>
<title>[COUCHDB-637] more info in #http available to handler</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-637</link>

                    <description>Attached is a diff that add default_fun and url_handlers to #http. It&apos;s useful for any custom handler that need to use the&lt;br/&gt;
http_handler and not only the db and design http handlers. Like for example in the rewriter.</description>
                <environment></environment>
            <key id="12455066">COUCHDB-637</key>
        <summary>more info in #http available to handler</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 2 Feb 2010 15:12:42 +0000 (UTC)</created>
    <updated>Tue, 2 Feb 2010 18:30:59 +0000 (UTC)</updated>

                        <version>0.11</version>
                    <version>0.12</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12828672" author="jchris" created="Tue, 2 Feb 2010 17:28:28 +0000 (UTC)"  >I&apos;ve got nothing against this but I&apos;d suggest the change should be part of a patch that makes use of it.</comment>
                    <comment id="12828680" author="benoitc" created="Tue, 2 Feb 2010 17:45:02 +0000 (UTC)"  >Here is a full patch with the rewriter. It eases the code, also we don&apos;t need to refetch DefaultFun and UrlHandlers each time we rewrite an url. All tests pass (make check and web tests)</comment>
                </comments>
    
    <attachments>
            <attachment id="12434528" name="http_record.diff" size="958" author="benoitc" created="Tue, 2 Feb 2010 15:14:22 +0000 (UTC)" />
            <attachment id="12434543" name="http_record2.patch" size="2344" author="benoitc" created="Tue, 2 Feb 2010 17:45:02 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 2 Feb 2010 17:28:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-636] proxy authentification handler</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-636</link>

                    <description>Find attached a patch that add a proxy authentification handler to couch_httpd_auth. &lt;br/&gt;
&lt;br/&gt;
This handler allows creation of a userCtx objec from a user authenticated remotly. The client just pass specific headers to CouchDB and the handler create the userCtx. Headers  name can be defined in local.ini. By thefault they are :&lt;br/&gt;
&lt;br/&gt;
* X-Auth-CouchDB-UserName : username, (x_auth_username in couch_httpd_auth section)&lt;br/&gt;
* X-Auth-CouchDB-Roles :  user roles, list of roles separated by a comma (x_auth_roles in couch_httpd_auth section)&lt;br/&gt;
* X-Auth-CouchDB-Token : token to authenticate the authorization (x_auth_token in couch_httpd_auth section). This token is an hmac-sha1 created from secret key and username. The secret key should be the same in the client and couchdb node. secret key is the secret key in couch_httpd_auth section of ini. This token is optional if secret key isn&apos;t defined.</description>
                <environment></environment>
            <key id="12455062">COUCHDB-636</key>
        <summary>proxy authentification handler</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 2 Feb 2010 14:54:13 +0000 (UTC)</created>
    <updated>Tue, 2 Feb 2010 18:27:18 +0000 (UTC)</updated>

                        <version>0.11</version>
                    <version>0.12</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12828702" author="benoitc" created="Tue, 2 Feb 2010 18:27:18 +0000 (UTC)"  >new patch that makes secret key use optional. &lt;br/&gt;
&lt;br/&gt;
If value of proxy_use_secret key in couch_httpd_auth section of ini isn&apos;t true the secret key isn&apos;t use.</comment>
                </comments>
    
    <attachments>
            <attachment id="12434527" name="proxyauth.diff" size="8038" author="benoitc" created="Tue, 2 Feb 2010 14:54:46 +0000 (UTC)" />
            <attachment id="12434551" name="proxyauth2.patch" size="8962" author="benoitc" created="Tue, 2 Feb 2010 18:27:18 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-635] A document with a field named &apos;constructor&apos; causes it to silently be excluded from any and all map views</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-635</link>

                    <description>If a document has a (nested) field named &apos;constructor&apos;, any map which attempts to emit the document will instead silently discard it.&lt;br/&gt;
&lt;br/&gt;
For example, the document&lt;br/&gt;
{   &amp;quot;_id&amp;quot;: &amp;quot;CSC190H1S&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_rev&amp;quot;: &amp;quot;32-287eec55e59305ee94129a0be940bf41&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;outcomes&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;constructor&amp;quot;: [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;knowledge&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
will silently be excluded by any view which attempts to emit &amp;quot;doc&amp;quot; or &amp;quot;doc.outcomes&amp;quot; .&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Mac OS X 10.6.2, CouchDB 0.10.1</environment>
            <key id="12447096">COUCHDB-635</key>
        <summary>A document with a field named &apos;constructor&apos; causes it to silently be excluded from any and all map views</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jamesnvc">James Cash</reporter>
            
    <created>Sat, 30 Jan 2010 22:50:13 +0000 (UTC)</created>
    <updated>Sun, 31 Jan 2010 11:01:07 +0000 (UTC)</updated>

                        <version>0.10.1</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12806759" author="paul.joseph.davis" created="Sun, 31 Jan 2010 00:27:36 +0000 (UTC)"  >I can&apos;t seem to trigger any sort of weirdness using json2.js and couchjs. Do you have any log output when you try and emit that?&lt;br/&gt;
&lt;br/&gt;
For reference:&lt;br/&gt;
&lt;br/&gt;
//test.js&lt;br/&gt;
print(JSON.stringify({&amp;quot;constructor&amp;quot;: &amp;quot;foo&amp;quot;}));&lt;br/&gt;
var p = JSON.parse(&amp;quot;{\&amp;quot;constructor\&amp;quot;: \&amp;quot;foo\&amp;quot;}&amp;quot;);&lt;br/&gt;
print(p);&lt;br/&gt;
print(JSON.stringify(p));&lt;br/&gt;
print(JSON.stringify({&amp;quot;foo&amp;quot;: {&amp;quot;constructor&amp;quot;: &amp;quot;baz&amp;quot;}}));&lt;br/&gt;
&lt;br/&gt;
cat test.js | ./src/couchdb/priv/couchjs&lt;br/&gt;
&lt;br/&gt;
Produces:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;constructor&amp;quot;:&amp;quot;foo&amp;quot;}&lt;br/&gt;
[object Object]&lt;br/&gt;
{&amp;quot;constructor&amp;quot;:&amp;quot;foo&amp;quot;}&lt;br/&gt;
{&amp;quot;foo&amp;quot;:{&amp;quot;constructor&amp;quot;:&amp;quot;baz&amp;quot;}}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
As expected.&lt;br/&gt;
</comment>
                    <comment id="12806762" author="jamesnvc" created="Sun, 31 Jan 2010 00:41:49 +0000 (UTC)"  >Sure, when I try to run the following map:&lt;br/&gt;
&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (doc._id == &apos;CSC190H1S&apos;) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;emit([doc._id], doc.activities.L02.outcomes);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
where the doc in question resembles:&lt;br/&gt;
&lt;br/&gt;
{   &amp;quot;_id&amp;quot;: &amp;quot;CSC190H1S&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_rev&amp;quot;: &amp;quot;34-b3a5079ea3f7818534426991a8d11907&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;activities&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;L02&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;outcomes&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;constructor&amp;quot;: [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;knowledge&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;] } } }&lt;br/&gt;
&lt;br/&gt;
The log contains the following entry:&lt;br/&gt;
&lt;br/&gt;
[Sun, 31 Jan 2010 00:37:48 GMT] [info] [&amp;lt;0.19833.3&amp;gt;] OS Process :: function raised exception (TypeError: toJSON.dispatcher[val.constructor.name] is not a function) with doc._id CSC190H1S&lt;br/&gt;
</comment>
                    <comment id="12806803" author="jchris" created="Sun, 31 Jan 2010 11:01:07 +0000 (UTC)"  >when 0.11 is released (next week I hope) the new JSON handler should make it in there which should have this issue.&lt;br/&gt;
&lt;br/&gt;
For now I suggest deleting the offending doc or changing the names.&lt;br/&gt;
&lt;br/&gt;
I&apos;m unable to reproduce on trunk.&lt;br/&gt;
&lt;br/&gt;
If you do try trunk, please be aware that you might not be able to downgrade your file to 0.10 afterwards so you want to use a copy of your data.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 31 Jan 2010 00:27:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-634] Make bulkSave actually save docs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-634</link>

                    <description>The bulkSave method in jquery.couch.js is missing essential parts - the way it is, nothing is done with the docs the method takes. I guess it was just forgotten.&lt;br/&gt;
&lt;br/&gt;
The complete callback is just an example, it might make sense to do something with each of the docs.</description>
                <environment></environment>
            <key id="12447080">COUCHDB-634</key>
        <summary>Make bulkSave actually save docs</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kilaulena">Lena Herrmann</reporter>
            
    <created>Sat, 30 Jan 2010 16:24:48 +0000 (UTC)</created>
    <updated>Sun, 31 Jan 2010 21:16:45 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="600">0.17h</timeoriginalestimate>        <timeestimate seconds="600">0.17h</timeestimate>                    

            <comments>
                    <comment id="12806865" author="janl" created="Sun, 31 Jan 2010 21:16:45 +0000 (UTC)"  >A variation applied in r905121.</comment>
                </comments>
    
    <attachments>
            <attachment id="12431867" name="bulk_save.patch" size="1098" author="kilaulena" created="Sat, 30 Jan 2010 16:25:41 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 31 Jan 2010 21:16:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 31 Jan 2010 21:16:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-633] invalid UTF-8 JSON with Mac OSX Leopard and Trunk Revision: 904726</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-633</link>

                    <description>Either by using Futon OR curl I get the same result by just saving a document with only _id&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.136.0&amp;gt;] attempted upload of invalid JSON {&amp;quot;_id&amp;quot;:&amp;quot;d332ed442bf2edf991e79b560e000a3b&amp;quot;}&lt;br/&gt;
[info] [&amp;lt;0.136.0&amp;gt;] 127.0.0.1 - - &apos;PUT&apos; /plankton/d332ed442bf2edf991e79b560e000a3b 400&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12447069">COUCHDB-633</key>
        <summary>invalid UTF-8 JSON with Mac OSX Leopard and Trunk Revision: 904726</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="sunfmin">Felix Sun</reporter>
            
    <created>Sat, 30 Jan 2010 04:22:01 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 08:22:58 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12806626" author="sunfmin" created="Sat, 30 Jan 2010 04:22:58 +0000 (UTC)"  >The image by using Futon</comment>
                    <comment id="12806631" author="paul.joseph.davis" created="Sat, 30 Jan 2010 05:06:52 +0000 (UTC)"  >The futon image suggests that you need to quote the value.&lt;br/&gt;
&lt;br/&gt;
What&apos;s the command line invocation of curl that causes this?</comment>
                    <comment id="12827991" author="sunfmin" created="Mon, 1 Feb 2010 02:43:43 +0000 (UTC)"  >curl -X POST &lt;a href=&quot;http://admin:&quot;&gt;http://admin:&lt;/a&gt;&lt;a href=&apos;mailto:admin@localhost&apos;&gt;admin@localhost&lt;/a&gt;:5984/plankton -d &apos;{&amp;quot;_id&amp;quot;:&amp;quot;f1697c8d57561cd14416d0a5690001d3&amp;quot;}&apos;</comment>
                    <comment id="12827992" author="sunfmin" created="Mon, 1 Feb 2010 02:47:40 +0000 (UTC)"  >Actually I click &amp;quot;New Document&amp;quot;, and &amp;quot;Save Document&amp;quot; directly only with the _id value which is generated automatically, This should work right?&lt;br/&gt;
</comment>
                    <comment id="12828008" author="janl" created="Mon, 1 Feb 2010 05:27:45 +0000 (UTC)"  >Do you have any old revisions of CouchDB installed? Try removing any old traces of CouchDB and try again.</comment>
                    <comment id="12828031" author="sunfmin" created="Mon, 1 Feb 2010 08:22:43 +0000 (UTC)"  >Removed the old versions, and reinstalled with the trunk, solved my problem, thank you very much.</comment>
                </comments>
    
    <attachments>
            <attachment id="12431856" name="2010-01-30_1213.png" size="103261" author="sunfmin" created="Sat, 30 Jan 2010 04:22:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 08:22:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 30 Jan 2010 05:06:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-632] Generic _changes listener added to jquery.couch.js</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-632</link>

                    <description>I&apos;ve written a Generic _changes listener and added it to jquery.couch.js taken from Futon.</description>
                <environment>the Browser!</environment>
            <key id="12446613">COUCHDB-632</key>
        <summary>Generic _changes listener added to jquery.couch.js</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mikeal">mikeal</reporter>
            
    <created>Mon, 25 Jan 2010 22:50:27 +0000 (UTC)</created>
    <updated>Tue, 26 Jan 2010 00:40:04 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="60">0.02h</timeoriginalestimate>        <timeestimate seconds="60">0.02h</timeestimate>                    

            <comments>
                    <comment id="12804763" author="mikeal" created="Mon, 25 Jan 2010 22:52:18 +0000 (UTC)"  >modified jquery.couch.js , jchris said I should just attach the whole file instead of a diff.</comment>
                    <comment id="12804785" author="jchris" created="Mon, 25 Jan 2010 23:24:35 +0000 (UTC)"  >here&apos;s a diff merged to work with latest trunk</comment>
                    <comment id="12804804" author="benoitc" created="Tue, 26 Jan 2010 00:08:30 +0000 (UTC)"  >Updated diff. fix a try catch non closed :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/benoitc/couchdb/commit/41eafc56799b1516c9a8d2207fa53366787be0bf&quot;&gt;http://github.com/benoitc/couchdb/commit/41eafc56799b1516c9a8d2207fa53366787be0bf&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12804819" author="benoitc" created="Tue, 26 Jan 2010 00:40:04 +0000 (UTC)"  >If couchdb stop to get changes we received undefined results and oldest id :&lt;br/&gt;
&lt;br/&gt;
Got 79ca040d0a6d784619c61b28e00005ff&lt;br/&gt;
Got undefined&lt;br/&gt;
Got 79ca040d0a6d784619c61b28e00005ff&lt;br/&gt;
&lt;br/&gt;
Here is a quick test.html to reproduce :&lt;br/&gt;
&lt;br/&gt;
&amp;lt;!DOCTYPE html&amp;gt;&lt;br/&gt;
&amp;lt;html&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;head&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;title&amp;gt;Test&amp;lt;/title&amp;gt;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;/head&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;body&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;h1&amp;gt;Test changes&amp;lt;/h1&amp;gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
	&amp;lt;ul id=&amp;quot;lines&amp;quot;&amp;gt;&amp;lt;/ul&amp;gt;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;/body&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;script src=&amp;quot;/_utils/script/json2.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;script src=&amp;quot;/_utils/script/jquery.js?1.3.1&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;script src=&amp;quot;/_utils/script/jquery.couch.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;script&amp;gt;&lt;br/&gt;
	var db = $.couch.db(&amp;quot;test&amp;quot;);&lt;br/&gt;
	var changes = db.changes({seq:15})&lt;br/&gt;
	changes.addListener(function(data) {&lt;br/&gt;
		console.log(data);&lt;br/&gt;
		$(&amp;quot;#lines&amp;quot;).append(&amp;quot;&amp;lt;li&amp;gt; Got &amp;quot; + data.id + &amp;quot;&amp;lt;/li&amp;gt;&amp;quot;);&lt;br/&gt;
	});&lt;br/&gt;
	changes.start();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;lt;/script&amp;gt;&lt;br/&gt;
&lt;br/&gt;
&amp;lt;/html&amp;gt;&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12431375" name="changes.diff" size="5421" author="jchris" created="Mon, 25 Jan 2010 23:24:35 +0000 (UTC)" />
            <attachment id="12431383" name="changes1.diff" size="5434" author="benoitc" created="Tue, 26 Jan 2010 00:08:30 +0000 (UTC)" />
            <attachment id="12431367" name="jquery.couch.js" size="16948" author="mikeal" created="Mon, 25 Jan 2010 22:52:18 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 25 Jan 2010 23:24:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-631] Replication by doc Ids</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-631</link>

                    <description>The following patch adds support for the optional &amp;quot;doc_ids&amp;quot; attribute (array of strings) of a JSON replication object.&lt;br/&gt;
&lt;br/&gt;
The idea was suggested recently by Chris Anderson in the dev mailing list.</description>
                <environment>trunk</environment>
            <key id="12446611">COUCHDB-631</key>
        <summary>Replication by doc Ids</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="fdmanana">Filipe Manana</reporter>
            
    <created>Mon, 25 Jan 2010 22:38:57 +0000 (UTC)</created>
    <updated>Fri, 29 Jan 2010 20:09:46 +0000 (UTC)</updated>

                
                
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12804756" author="fdmanana" created="Mon, 25 Jan 2010 22:39:21 +0000 (UTC)"  >The following patch adds support for the optional &amp;quot;doc_ids&amp;quot; attribute (array of strings) of a JSON replication object.&lt;br/&gt;
&lt;br/&gt;
The idea was suggested recently by Chris Anderson in the dev mailing list.</comment>
                    <comment id="12805129" author="fdmanana" created="Tue, 26 Jan 2010 18:43:51 +0000 (UTC)"  >An alternative implementation of this feature.&lt;br/&gt;
&lt;br/&gt;
Instead of doing the document filtering in couch_rep_missing_revs.erl, after the full Changes list has been downloaded from the source DB (if it&apos;s a remote DB), the filtering is done by the filter function used in couch_httpd_db:handle_changes_req/2.&lt;br/&gt;
&lt;br/&gt;
This avoids downloading the whole Changes list from the remote source DB, and it&apos;s more logical to do the doc filtering there (so it seems to me).&lt;br/&gt;
Also, it adds the query parameter &amp;quot;doc_ids&amp;quot; to the _changes API (the value of this option is a comma separated list of doc IDs).&lt;br/&gt;
&lt;br/&gt;
The implementation of the first submitted patch has only the advantage of being shorter.&lt;br/&gt;
&lt;br/&gt;
@Chris, @Adam, @Paul&lt;br/&gt;
what are your opinions?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12805141" author="fdmanana" created="Tue, 26 Jan 2010 19:06:18 +0000 (UTC)"  >Forgot to make a call to couch_httpd:unquote/1 in the previous patch.</comment>
                    <comment id="12805566" author="jchris" created="Wed, 27 Jan 2010 16:44:45 +0000 (UTC)"  >There&apos;s a better approach:&lt;br/&gt;
&lt;br/&gt;
Instead of following _changes at all, just replicate the list of docs directly. Since we don&apos;t keep old revs around, this won&apos;t be any different than normal replication (for those docs).&lt;br/&gt;
&lt;br/&gt;
The #1 use case for this sort of thing is when you have a short list of docs you want to replicate from a large database. If you traverse the by_seq index you have to look at all the docids in the database. If you lookup the handlful of docs on your list, it&apos;s much faster.</comment>
                    <comment id="12805569" author="fdmanana" created="Wed, 27 Jan 2010 16:51:55 +0000 (UTC)"  >Ah!&lt;br/&gt;
&lt;br/&gt;
I was not aware that only the latest rev of a doc is replicated.&lt;br/&gt;
&lt;br/&gt;
That makes sense.&lt;br/&gt;
I&apos;ll redo the patch, if you don&apos;t mind.&lt;br/&gt;
&lt;br/&gt;
Thanks for the tip.</comment>
                    <comment id="12806165" author="fdmanana" created="Fri, 29 Jan 2010 00:15:40 +0000 (UTC)"  >@Chris&lt;br/&gt;
&lt;br/&gt;
Here it goes, implementation without using at all the _changes API and db sequence update numbers.&lt;br/&gt;
&lt;br/&gt;
It just fetches the latest rev of the docs, specified in the doc_ids Json field, and sends them to the target DB.&lt;br/&gt;
&lt;br/&gt;
Let me know if this is what you had in mind and if there&apos;s something in the code that needs to be enhanced.&lt;br/&gt;
&lt;br/&gt;
PS: use git apply patch :)&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12806422" author="fdmanana" created="Fri, 29 Jan 2010 18:29:14 +0000 (UTC)"  >+ Updated the test to cover the case where a non existing doc ID is supplied in the doc_ids array.&lt;br/&gt;
+ Fixed a bad match error in a case statement&lt;br/&gt;
&lt;br/&gt;
cheers&lt;br/&gt;
</comment>
                    <comment id="12806478" author="jchris" created="Fri, 29 Jan 2010 20:09:46 +0000 (UTC)"  >latest patch applied in r904615&lt;br/&gt;
&lt;br/&gt;
Thanks Filipe!</comment>
                </comments>
    
    <attachments>
            <attachment id="12431791" name="couchdb-631-rep-doc-ids-trunk-git-2nd-try.patch" size="12402" author="fdmanana" created="Fri, 29 Jan 2010 18:29:14 +0000 (UTC)" />
            <attachment id="12431723" name="couchdb-631-rep-doc-ids-trunk-git.patch" size="12292" author="fdmanana" created="Fri, 29 Jan 2010 00:15:40 +0000 (UTC)" />
            <attachment id="12431448" name="replication-by-doc-ids-alternative-impl-2_trunk.patch" size="6857" author="fdmanana" created="Tue, 26 Jan 2010 19:06:18 +0000 (UTC)" />
            <attachment id="12431441" name="replication-by-doc-ids-alternative-impl_trunk.patch" size="6836" author="fdmanana" created="Tue, 26 Jan 2010 18:43:51 +0000 (UTC)" />
            <attachment id="12431366" name="replication-by-doc-ids_trunk.patch" size="4313" author="fdmanana" created="Mon, 25 Jan 2010 22:39:21 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 29 Jan 2010 20:09:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 27 Jan 2010 16:44:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-630] Make the changes_filter use _conflicts field</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-630</link>

                    <description>I want to filter the changes feed for documents with conflicts.</description>
                <environment></environment>
            <key id="12446424">COUCHDB-630</key>
        <summary>Make the changes_filter use _conflicts field</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kilaulena">Lena Herrmann</reporter>
            
    <created>Sat, 23 Jan 2010 15:11:01 +0000 (UTC)</created>
    <updated>Sat, 23 Jan 2010 15:29:55 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="60">0.02h</timeoriginalestimate>        <timeestimate seconds="60">0.02h</timeestimate>                    

            <comments>
                    <comment id="12804091" author="kilaulena" created="Sat, 23 Jan 2010 15:11:58 +0000 (UTC)"  >small patch with test.</comment>
                    <comment id="12804095" author="janl" created="Sat, 23 Jan 2010 15:29:55 +0000 (UTC)"  >Committed in r902422.</comment>
                </comments>
    
    <attachments>
            <attachment id="12431214" name="add_conflicts_field_to_changes_filter.patch" size="1966" author="kilaulena" created="Sat, 23 Jan 2010 15:11:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 23 Jan 2010 15:29:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 23 Jan 2010 15:29:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-629] futon doesn&apos;t raise a popup anymore to ask for login if needed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-629</link>

                    <description>Since latest change, futon doesn&apos;t raised a window to ask for login if needed.&lt;br/&gt;
&lt;br/&gt;
Steps to reproduce :&lt;br/&gt;
&lt;br/&gt;
try to delete a db with an admin user set, you only get &amp;quot;The database could not be deleted: You are not a server admin.&amp;quot; message. It would be more intuitive to raise popup or something that ask for a login. Here I lost some time to understand what to do. Especially since login was at the bottom.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12445950">COUCHDB-629</key>
        <summary>futon doesn&apos;t raise a popup anymore to ask for login if needed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 19 Jan 2010 17:39:06 +0000 (UTC)</created>
    <updated>Tue, 19 Jan 2010 17:59:53 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12802378" author="jchris" created="Tue, 19 Jan 2010 17:59:53 +0000 (UTC)"  >It shouldn&apos;t be too hard to make the login dialog appear in these situations.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 19 Jan 2010 17:59:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-628] add dates to releases on website download page</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-628</link>

                    <description>it may seem like a small deal but its very handy to have the date of the release listed along with the version of couchdb on the download page. &lt;a href=&quot;http://couchdb.apache.org/downloads.html&quot;&gt;http://couchdb.apache.org/downloads.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
thanks!</description>
                <environment></environment>
            <key id="12445891">COUCHDB-628</key>
        <summary>add dates to releases on website download page</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="donpdonp">Don Park</reporter>
            
    <created>Tue, 19 Jan 2010 07:24:32 +0000 (UTC)</created>
    <updated>Tue, 19 Jan 2010 09:51:40 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12802171" author="nslater" created="Tue, 19 Jan 2010 09:51:40 +0000 (UTC)"  >I will retro-actively do this, and add this step to the release procedure.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 19 Jan 2010 09:51:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-627] badarg caused in UTC+7 timezones</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-627</link>

                    <description>A user reported problems on IRC. It turns out that couchdb (or mochiweb) barfs when the local machine is set to some timezones.&lt;br/&gt;
&lt;br/&gt;
I set my local timezone to Western Indonesian Time (WIT) and reproduced the bug. &lt;br/&gt;
&lt;br/&gt;
Steps&lt;br/&gt;
1) Change to WIT&lt;br/&gt;
2) Visit Futon&lt;br/&gt;
&lt;br/&gt;
Error;&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;badarg&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
and logs report;&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.104.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /_utils/index.html 500&lt;br/&gt;
[error] [&amp;lt;0.112.0&amp;gt;] Badarg error in HTTP request&lt;br/&gt;
[info] [&amp;lt;0.112.0&amp;gt;] Stacktrace: [{erlang,universaltime_to_localtime,[{{1969,12,31},{23,59,59}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{calendar,local_time_to_universal_time_dst,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{httpd_util,rfc1123_date,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request,maybe_serve_file,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,serve_file,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]&lt;br/&gt;
</description>
                <environment>MacBook Pro, Snow Leopard 10.6.2</environment>
            <key id="12445860">COUCHDB-627</key>
        <summary>badarg caused in UTC+7 timezones</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Mon, 18 Jan 2010 20:32:08 +0000 (UTC)</created>
    <updated>Thu, 21 Jan 2010 16:54:44 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12801951" author="rnewson" created="Mon, 18 Jan 2010 21:02:33 +0000 (UTC)"  >This might even be an Erlang bug;&lt;br/&gt;
&lt;br/&gt;
1&amp;gt; httpd_util:rfc1123_date(erlang:localtime()).&lt;br/&gt;
** exception error: bad argument&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;in function  erlang:universaltime_to_localtime/1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;called as erlang:universaltime_to_localtime({{1969,12,31},{23,59,59}})&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;in call from calendar:local_time_to_universal_time_dst/1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;in call from httpd_util:rfc1123_date/1&lt;br/&gt;
2&amp;gt; &lt;br/&gt;
&lt;br/&gt;
httpd_util:rfc1123_date declares it takes local time, but it blows up if you try it in the WIT timezone.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Ooooops.</comment>
                    <comment id="12801955" author="rnewson" created="Mon, 18 Jan 2010 21:15:41 +0000 (UTC)"  >And Arabian Standard Time and East Africa Time...&lt;br/&gt;
</comment>
                    <comment id="12801956" author="paul.joseph.davis" created="Mon, 18 Jan 2010 21:17:52 +0000 (UTC)"  >Confirmed locally.&lt;br/&gt;
&lt;br/&gt;
Judging by erlang:universaltime_to_localtime({{1969,12,31},{23,59,59}}) it looks like someone&apos;s date math is off by a second.&lt;br/&gt;
&lt;br/&gt;
Where do we file Erlang bugs?</comment>
                    <comment id="12801962" author="paul.joseph.davis" created="Mon, 18 Jan 2010 21:21:40 +0000 (UTC)"  >Submitting to &lt;a href=&apos;mailto:erlang-bugs@erlang.org&apos;&gt;erlang-bugs@erlang.org&lt;/a&gt;. I&apos;ll post back if I hear anything.</comment>
                    <comment id="12803357" author="paul.joseph.davis" created="Thu, 21 Jan 2010 16:54:44 +0000 (UTC)"  >Looks like the OTP team knows about it.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.erlang.org/cgi-bin/ezmlm-cgi?2:mss:1681:201001:jffdfifdokimdicjnpcp&quot;&gt;http://www.erlang.org/cgi-bin/ezmlm-cgi?2:mss:1681:201001:jffdfifdokimdicjnpcp&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 18 Jan 2010 21:17:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-626] [PATCH] test for _update with base64</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-626</link>

                    <description>The first attached patch adds a (passing) test for base64 output from _update functions.&lt;br/&gt;
&lt;br/&gt;
The second patch tidies up slightly by using stringFun() in a couple of places where it currently isn&apos;t.</description>
                <environment></environment>
            <key id="12445827">COUCHDB-626</key>
        <summary>[PATCH] test for _update with base64</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Mon, 18 Jan 2010 14:35:49 +0000 (UTC)</created>
    <updated>Mon, 18 Jan 2010 14:36:21 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
            <attachment id="12430635" name="test-update-base64.diff" size="1212" author="candlerb" created="Mon, 18 Jan 2010 14:36:21 +0000 (UTC)" />
            <attachment id="12430636" name="use-stringfun.diff" size="1641" author="candlerb" created="Mon, 18 Jan 2010 14:36:21 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-625] Pure Erlang alternative to crypto library</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-625</link>

                    <description>On some platforms (in my case a SheevaPlug running on armv5te) it may be difficult or impossible to obtain a version of Erlang built with support for the crypto standard library.  I grepped the CouchDB source and have attempted to reproduce the used crypto calls in pure Erlang.&lt;br/&gt;
&lt;br/&gt;
I have reproduced the start/0, rand_uniform/2, rand_bytes/1, sha/1, and sha_mac/2 functions, along with test_sha/1 and test_sha_mac/1 functions to validate the pure Erlang results against the crypto library&apos;s results.  The public non-test functions attempt to first call into crypto if available, as it is the preferred implementation.&lt;br/&gt;
&lt;br/&gt;
As I&apos;m not familiar with the build system, app system, etc. of Erlang I am only attaching the library implementation.  I&apos;m sure more work would be required to fully integrate it into CouchDB if accepted.&lt;br/&gt;
&lt;br/&gt;
As far as licensing goes, SHA1 is defined in NIST FIPS 180-2 (&lt;a href=&quot;http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf),&quot;&gt;http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf),&lt;/a&gt; and according to the IETF, the patent covering the algorithm has been made royalty-free (&lt;a href=&quot;https://datatracker.ietf.org/ipr/858&quot;&gt;https://datatracker.ietf.org/ipr/858&lt;/a&gt;).</description>
                <environment></environment>
            <key id="12445791">COUCHDB-625</key>
        <summary>Pure Erlang alternative to crypto library</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="jdknezek">Jonathan D. Knezek</reporter>
            
    <created>Mon, 18 Jan 2010 03:03:28 +0000 (UTC)</created>
    <updated>Thu, 21 Jan 2010 06:39:17 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12801713" author="jdknezek" created="Mon, 18 Jan 2010 09:16:28 +0000 (UTC)"  >Added notes about cryptographic insecurity of the rand_* functions and corrected licensing information thanks to clarification by Dw on the mailing list.  The SHA-related functions are a derivative work under the CC-BY-SA license, so I&apos;m not sure about their eligibility for inclusion under the Apache license.&lt;br/&gt;
&lt;br/&gt;
This may be a moot point however, as although the speed on small data sets is acceptable, on larger data sets it becomes a hindrance.  For example, hashing 1MB of data on my Athlon64 X2 5000+ takes ~3.3s.</comment>
                    <comment id="12801790" author="jdknezek" created="Mon, 18 Jan 2010 14:32:59 +0000 (UTC)"  >Though &lt;a href=&quot;http://creativecommons.org/licenses/by-sa/3.0/&quot;&gt;http://creativecommons.org/licenses/by-sa/3.0/&lt;/a&gt; states that derivative works of SA may be distributed &amp;quot;under the same, similar or a compatible license&amp;quot; (which would lead me to believe there&apos;s a chance the Apache license could be compatible), &lt;a href=&quot;http://creativecommons.org/about/licenses/&quot;&gt;http://creativecommons.org/about/licenses/&lt;/a&gt; declares that one must &amp;quot;license their new creations under the identical terms.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Sorry for the trouble. :[</comment>
                    <comment id="12802016" author="jchris" created="Tue, 19 Jan 2010 01:10:09 +0000 (UTC)"  >Reopening, as this is a good idea.&lt;br/&gt;
&lt;br/&gt;
I think it&apos;s worth inquiring from the legal list about algorithms implemented based on wikipedia articles.&lt;br/&gt;
&lt;br/&gt;
My gut says we can use it. If we can&apos;t, it&apos;s worth redoing the work based on the original govt papers, or perhaps APR because we know it is clean.</comment>
                    <comment id="12802030" author="jchris" created="Tue, 19 Jan 2010 01:45:15 +0000 (UTC)"  >Jonathan, do you have a Wikipedia URL for the pseudocode?&lt;br/&gt;
&lt;br/&gt;
I&apos;m guessing that a big part of this hinges on 2 questions:&lt;br/&gt;
&lt;br/&gt;
did you copy/paste or type from scratch?&lt;br/&gt;
&lt;br/&gt;
how different is the code.&lt;br/&gt;
&lt;br/&gt;
I&apos;m working on an email to legal-discuss, but we should have the Wikipedia URLs before sending.&lt;br/&gt;
&lt;br/&gt;
Thanks!&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12802038" author="jdknezek" created="Tue, 19 Jan 2010 02:07:58 +0000 (UTC)"  >Sure.&lt;br/&gt;
&lt;br/&gt;
The SHA1 pseudo-code came from &lt;a href=&quot;http://en.wikipedia.org/w/index.php?title=SHA_hash_functions&amp;oldid=338273346#SHA-1_pseudocode&quot;&gt;http://en.wikipedia.org/w/index.php?title=SHA_hash_functions&amp;amp;oldid=338273346#SHA-1_pseudocode&lt;/a&gt;.  It was hand-typed as I attempted to convert from imperative to functional code.  This is one of my first attempts at serious Erlang and functional programming in general so it was originally intended as an intellectual challenge.&lt;br/&gt;
&lt;br/&gt;
The currently posted version is very similar structurally.  My latest (unposted) version has ~15% improved performance and is very different structurally (combined the extend and loop sections to avoid list construction).  I can post this latest version if it&apos;ll help.&lt;br/&gt;
&lt;br/&gt;
The HMAC pseudo-code came from &lt;a href=&quot;http://en.wikipedia.org/w/index.php?title=HMAC&amp;oldid=336183553#Implementation&quot;&gt;http://en.wikipedia.org/w/index.php?title=HMAC&amp;amp;oldid=336183553#Implementation&lt;/a&gt; which is actually incorrect.  I corrected my implementation from the RFC description at &lt;a href=&quot;http://tools.ietf.org/html/rfc2104&quot;&gt;http://tools.ietf.org/html/rfc2104&lt;/a&gt;.  The code is very similar, but this is an algorithm I would argue can only really be implemented one way...  It&apos;s only ten lines of pseudo-code.&lt;br/&gt;
&lt;br/&gt;
I unfortunately think it&apos;s a moot point because the pure Erlang performance is too poor to be useful and will likely have to be implemented as a native extension, external port, or something like that to be feasible...&lt;br/&gt;
</comment>
                    <comment id="12802388" author="jchris" created="Tue, 19 Jan 2010 18:08:45 +0000 (UTC)"  >Thanks for the links. If you are interested in sharing the new version, I&apos;m interested in pursing the licensing questions.&lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure about the performance. I know it would be slower, but so much slower that it would matter for a single user running an app on an embedded device?&lt;br/&gt;
&lt;br/&gt;
The idea of making a C-based port version of it seems redundant to me: isn&apos;t that already basically what the stdlib crypto app does?&lt;br/&gt;
&lt;br/&gt;
The appeal of pure-Erlang crypto is that we can fall back on it in places where it&apos;s hard to build native code.&lt;br/&gt;
&lt;br/&gt;
Do others think this is worth pursing or are we just setting a bunch of GameBoy users up for UUID collisions in the year 2050?&lt;br/&gt;
</comment>
                    <comment id="12802626" author="jdknezek" created="Wed, 20 Jan 2010 02:24:11 +0000 (UTC)"  >This new version exports the pure functions (prefixed with pure_) for testing, adds test_rand_bytes/1 which reports the number of collisions found in N generated UUIDs, and combines the word expansion and mixing steps for sha/1.&lt;br/&gt;
&lt;br/&gt;
The SHA1 implementation is about 15% faster than the previous version due to the elimination of list construction.&lt;br/&gt;
&lt;br/&gt;
Also, after actually checking the sites where sha/1 and sha_mac/2 were called, I&apos;m much less concerned about speed.  I thought they were being used to calculate the revisions, so I was worried about possibly handling several MB.  All the uses are dealing with authentication, though, and this version can hash about 21kB/s on my 1.2 GHz SheevaPlug.&lt;br/&gt;
&lt;br/&gt;
I say give legal a ring. :]</comment>
                    <comment id="12802627" author="paul.joseph.davis" created="Wed, 20 Jan 2010 02:38:15 +0000 (UTC)"  >When you say reports the number of collisions that&apos;s always zero right?  If not then I&apos;d be a bit worried. </comment>
                    <comment id="12802628" author="jdknezek" created="Wed, 20 Jan 2010 02:43:00 +0000 (UTC)"  >Right, I&apos;ve never had one reported.</comment>
                    <comment id="12802678" author="jchris" created="Wed, 20 Jan 2010 05:31:32 +0000 (UTC)"  >I&apos;ve sent a request to legal-discuss. Hopefully they&apos;ve seen something like this before.</comment>
                    <comment id="12802919" author="jchris" created="Wed, 20 Jan 2010 18:20:53 +0000 (UTC)"  >It looks like the consensus is that it&apos;s OK to use this code.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/www-legal-discuss/201001.mbox/%3c3d4032301001200405i3c5dde7fve4a13247e6b061ad@mail.gmail.com%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/www-legal-discuss/201001.mbox/%3c3d4032301001200405i3c5dde7fve4a13247e6b061ad@mail.gmail.com%3e&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
With that out of the way, we should see if there are any technical concerns before we start importing this into the codebase.&lt;br/&gt;
&lt;br/&gt;
I think the module is small enough to avoid needing an explicit code grant: &lt;a href=&quot;http://www.apache.org/licenses/software-grant.txt&quot;&gt;http://www.apache.org/licenses/software-grant.txt&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Question for other committers: should we import this as couch_crypto.erl or should it treated as it&apos;s own library and get a directory inside src?</comment>
                    <comment id="12803199" author="jchris" created="Thu, 21 Jan 2010 06:39:16 +0000 (UTC)"  >On Wed, Jan 20, 2010 at 7:16 PM, Brian McCallister &amp;lt;&lt;a href=&apos;mailto:brianm@skife.org&apos;&gt;brianm@skife.org&lt;/a&gt;&amp;gt; wrote:&lt;br/&gt;
&amp;gt; On copyright front, pretty sure you are all clear -- could be&lt;br/&gt;
&amp;gt; copyright problem to cut and paste, not to learn from and use to&lt;br/&gt;
&amp;gt; implement. My bigger concern is about the the crypto impl -- avoiding&lt;br/&gt;
&amp;gt; things like timing attacks on algorithms is very tricky, and unless&lt;br/&gt;
&amp;gt; you really grok them, you probably have side channel weaknesses in the&lt;br/&gt;
&amp;gt; impl :-(&lt;br/&gt;
&lt;br/&gt;
Yes that&apos;s why I prefer to have a native erlang fallback instead of a&lt;br/&gt;
lightweight c implementation. At least it will be clear for&lt;br/&gt;
performance reasons that you shouldn&apos;t be running on less than a full&lt;br/&gt;
OpenSSL-based library.&lt;br/&gt;
&lt;br/&gt;
I&apos;d I think it&apos;s worth the cost of widespread adoption on embedded&lt;br/&gt;
devices. Maybe it&apos;d be smart to make a compile time dependency&lt;br/&gt;
warning, so people know what they are getting into.&lt;br/&gt;
&lt;br/&gt;
Devs -- what about this compile time warning if we drop back to native crypto? This might be more solid from a no-surprises standpoint than the current patch which switches at runtime.</comment>
                </comments>
    
    <attachments>
            <attachment id="12430832" name="ccrypto.erl" size="6288" author="jdknezek" created="Wed, 20 Jan 2010 02:24:11 +0000 (UTC)" />
            <attachment id="12430615" name="ccrypto.erl" size="5331" author="jdknezek" created="Mon, 18 Jan 2010 09:16:28 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 19 Jan 2010 01:10:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-624] Bulk import of non-JSON formats</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-624</link>

                    <description>The _list feature can be used to perform bulk exports in non-JSON formats (e.g. XML, CSV)&lt;br/&gt;
&lt;br/&gt;
There does not appear to be a corresponding function for bulk imports. _update can parse alien formats, but acts on a single document only.&lt;br/&gt;
&lt;br/&gt;
I think we need something like _update but which can emit a stream of documents like _list, or return an array of docs like _bulk_docs uses.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12445532">COUCHDB-624</key>
        <summary>Bulk import of non-JSON formats</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Thu, 14 Jan 2010 17:18:54 +0000 (UTC)</created>
    <updated>Thu, 14 Jan 2010 17:18:54 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-623] File format for views is space and time inefficient - use a better one</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-623</link>

                    <description>This was discussed on the dev mailing list over the last few days and noted here so it isn&apos;t forgotten.&lt;br/&gt;
&lt;br/&gt;
The main database file format is optimised for data integrity - not losing or mangling documents - and rightly so.&lt;br/&gt;
&lt;br/&gt;
That same append-only format is also used for views where it is a poor fit.  The more random the ordering of data supplied, the larger the btree.  The larger the keys (in bytes) the larger the btree.  As an example my 2GB of raw JSON data turns into a 3.9GB CouchDB database but a 27GB view file (before compacting to 900MB).  Since views are not replicated, this requires a disproportionate amount of disk space on each receiving server (not to mention I/O load).  The format also affects view generation performance.  By loading my documents into CouchDB in an order by the most emitted value in views I was able to reduce load time from 75 minutes to 40 minutes with the view file size being 15GB instead of 27GB, but still very distant from the 900MB post compaction.&lt;br/&gt;
&lt;br/&gt;
Views are a performance enhancement.  They save you from having to visit every document when doing some queries.  The data within in a view is generated and hence the only consequence of losing view data is a performance one and the view can be regenerated anyway.  Consequently the file format should be one that is optimised for performance and size.  The only integrity feature needed is the ability to tell that the view is potentially corrupt (eg the power failed while it was being generated/updated).</description>
                <environment></environment>
            <key id="12445422">COUCHDB-623</key>
        <summary>File format for views is space and time inefficient - use a better one</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="rogerbinns">Roger Binns</reporter>
            
    <created>Wed, 13 Jan 2010 18:19:42 +0000 (UTC)</created>
    <updated>Wed, 13 Jan 2010 22:10:27 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12799864" author="jchris" created="Wed, 13 Jan 2010 18:44:14 +0000 (UTC)"  >It&apos;s worth nothing that another advantage to using the storage btrees is the MVCC guarantees. This means that a slow client can take its sweet time to traverse the view index, and is not affected by ongoing writes or deletes.&lt;br/&gt;
&lt;br/&gt;
This is crucial for the consistency guarantees views make.&lt;br/&gt;
&lt;br/&gt;
It is not very hard to create alternate view index systems (like CouchDB-Lounge) and the overhead of running as an external is negligible. One fine way to prototype a view system that optimizes for different things would be as an external.</comment>
                    <comment id="12799878" author="rogerbinns" created="Wed, 13 Jan 2010 19:12:40 +0000 (UTC)"  >What are the consistency guarantees that views make?  I can&apos;t find any documentation about it anywhere!  (There is plenty about the main db, but nothing about views.)&lt;br/&gt;
&lt;br/&gt;
I can&apos;t see any that you can make as the view data is derived from the documents and the documents can be changed at any point.  For example while the first row of a view is being returned the same corresponding document could have been deleted.  The &amp;quot;slow client&amp;quot; example can also lead to inconsistent data - for example it may update a document on one connection and then access the view on a second connection and due to timing end up with the view not including that document.&lt;br/&gt;
&lt;br/&gt;
The only consistency &amp;quot;guarantee&amp;quot; I can see is that if you do not add/change/delete the documents for the period shortly before and then during view retrieval until the view is completely retrieved then the view will reflect the documents correctly at that time.  If there is any form of concurrency between the documents and the views then there cannot be guarantees unless CouchDB introduced a transactioning system.&lt;br/&gt;
&lt;br/&gt;
I do see how the append only btree/mvcc format makes the view retrieval code easier to write, but users of CouchDB do not care how hard the code is to write :-)</comment>
                    <comment id="12799891" author="paul.joseph.davis" created="Wed, 13 Jan 2010 19:28:39 +0000 (UTC)"  >The consistency guarantee refers to the file format used guarantees on disk consistency the same as is done for the main database file (ie, tail append MVCC style). Its not a reference to figuring out the sync between the main db and the view. As you point out doing things like querying with stale=ok can give you a view result that does not reflect the most recent changes to the database or reflects changes from other clients etc etc.</comment>
                    <comment id="12799896" author="kocolosk" created="Wed, 13 Jan 2010 19:33:37 +0000 (UTC)"  >I believe by &amp;quot;consistency guarantees&amp;quot; Chris meant that a view request uses a single snapshot of the view index for the entire response.  Even if documents are changed in the interim, and even if someone else has triggered a view update, your response will still accurately reflect the state of the DB at a single moment in time.</comment>
                    <comment id="12799902" author="damienkatz" created="Wed, 13 Jan 2010 19:52:45 +0000 (UTC)"  >Closing as Invalid this has no objective criteria for being resolved.</comment>
                    <comment id="12799916" author="rogerbinns" created="Wed, 13 Jan 2010 20:37:06 +0000 (UTC)"  >Not again Damien :-)&lt;br/&gt;
&lt;br/&gt;
Simple criteria - the size of the view file should be proportionate to the data in a view on initial generation.  If you want raw numbers, the view file should be no larger than double the sum of JSON encoded key, value and _id for each row.&lt;br/&gt;
&lt;br/&gt;
The current multiplier is 15 to 27 times as much which is ludicrous.  Even post compactation the file is a little on the large side.  And because the view results are not replicated, the overhead has to be incurred on every machine that replication happens to.&lt;br/&gt;
&lt;br/&gt;
Or put another way, if people are planning on deploying CouchDB how much space would you advise them to provision?  &lt;br/&gt;
&lt;br/&gt;
When I started, the answer for 10million documents/2.5GB of raw JSON is 72GB:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;23GB for DB, another 21GB for the compacted version, 27+GB for view file, another 1+GB for compacted view file&lt;br/&gt;
&lt;br/&gt;
By shortening ids to 4 bytes instead of 16 we get:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;4GB for DB, another 4GB for compacted, 27GB for view file, another 1GB for compacted view file&lt;br/&gt;
&lt;br/&gt;
By being able to sort my documents to be ordered by the most commonly emitted view key:&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;4GB for DB, another 4GB for compacted, 15GB for view file, another 1GB for compacted view file&lt;br/&gt;
&lt;br/&gt;
Since the view/DB coexists at the same time as the compaction you need space for both simultaneously. 10 million documents/2GB of data is not something that makes any existing database system sweat.</comment>
                    <comment id="12799965" author="rogerbinns" created="Wed, 13 Jan 2010 22:10:27 +0000 (UTC)"  >The view consistency stuff is a red herring.  If you are not making changes to the DB then any file format will work and give &amp;quot;consistent&amp;quot; results.&lt;br/&gt;
&lt;br/&gt;
If you are making changes to the docs then no scheme short of transactions/locking will ensure that the view is consistent with the documents.  It will always be possible for documents to be referenced by the view that are not in the DB and for documents to be in the DB that are not in the view.  I see no point in trying to even make the view &amp;quot;consistent&amp;quot; with a point in time while DB changes are happening since it gives no performance efficiency nor any space efficiency - in fact the extreme opposites.&lt;br/&gt;
&lt;br/&gt;
The point of views is to give me information fast that I could only otherwise obtain by visiting all the documents.  That is what they should be optimized for.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 13 Jan 2010 19:52:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 13 Jan 2010 18:44:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-622] erlview sandboxing via parse transform</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-622</link>

                    <description>I&apos;m just adding this ticket so I don&apos;t forget about it.&lt;br/&gt;
&lt;br/&gt;
It&apos;s possible to improve the safety of the native erlang view server, just by doing a simple walk of the parsed abstract form. I think all we need to do is forbid calls to functions in all external modules m:f(), except for whitelisted modules (e.g. io_lib, lists) or specific functions. We also need a whitelist of BIFs.&lt;br/&gt;
&lt;br/&gt;
Some care may be needed for imported functions - check if they are already expanded to m:f() in the abstract form, or remain as f().&lt;br/&gt;
&lt;br/&gt;
My main concern is preventing things like os:cmd(). There are also many possible DoS attacks, like atom exhaustion or spawning infinite numbers of processes. However, most view definitions aren&apos;t going to need spawn() or list_to_atom(). A configurable whitelist could be very tight by default, but still allow admins to allow any specific functions they need.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12445381">COUCHDB-622</key>
        <summary>erlview sandboxing via parse transform</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Wed, 13 Jan 2010 06:04:36 +0000 (UTC)</created>
    <updated>Wed, 13 Jan 2010 06:04:36 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-621] configure script doesn&apos;t allow overriding localdocdir</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-621</link>

                    <description>&amp;nbsp;* econf: updating apache-couchdb-0.10.1/build-aux/config.guess with /usr/share/gnuconfig/config.guess&lt;br/&gt;
&amp;nbsp;* econf: updating apache-couchdb-0.10.1/build-aux/config.sub with /usr/share/gnuconfig/config.sub&lt;br/&gt;
./configure --prefix=/usr --build=x86_64-pc-linux-gnu --host=x86_64-pc-linux-gnu --mandir=/usr/share/man --infodir=/usr/share/info --datadir=/usr/share --sysconfdir=/etc --localstatedir=/var/lib --libdir=/usr/lib64 --with-erlang=/usr/lib/erlang/usr/include --localstatedir=/var --localdocdir=/usr/share/doc/couchdb-0.10.1&lt;br/&gt;
configure: error: unrecognized option: `--localdocdir=/usr/share/doc/couchdb-0.10.1&apos;</description>
                <environment>Gentoo Linux</environment>
            <key id="12445348">COUCHDB-621</key>
        <summary>configure script doesn&apos;t allow overriding localdocdir</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Tue, 12 Jan 2010 20:17:08 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 22:00:22 +0000 (UTC)</updated>

                        <version>0.10.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-620] Generating views is extremely slow - makes CouchDB hard to use with non-trivial number of docs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-620</link>

                    <description>Generating views is extremely slow.  For example adding 10 million documents takes less than 10 minutes but generating some simple views on the same docs takes over 4 hours.&lt;br/&gt;
&lt;br/&gt;
Using top you can see that CouchDB (erlang) and couchjs between them cannot even saturate a single CPU let alone the I/O system.  Under ideal conditions performance should be limited by cpu, disk or memory.  This implies that the processes are doing simple things in lockstep accumulating latencies in each process as well as the communication between them which when multiplied by the number of documents can amount to a lot.&lt;br/&gt;
&lt;br/&gt;
Some suggestions:&lt;br/&gt;
&lt;br/&gt;
* Run as many couchjs instances as there are processor cores and scatter work amongst them&lt;br/&gt;
&lt;br/&gt;
* Have some sort of pipelining in the erlang so that the moment the first byte of response is received from couchjs the data is sent for the next request (the JSON conversion, HTTP headers etc should all have been assembled already) to reduce latencies.  Do whatever is most similar in couchjs (eg use separate threads to read requests, process them and write responses).&lt;br/&gt;
&lt;br/&gt;
* Use the equivalent of HTTP pipelining when talking to couchjs so that it always has a doc ready to work on rather than having to transmit an entire response and then wait for erlang to think and provide an entire new request&lt;br/&gt;
&lt;br/&gt;
A simple test of success is to have a database with a million or so documents with a trivial view and have view creation max out the CPU,. memory or disk.&lt;br/&gt;
&lt;br/&gt;
Some things in CouchDB make this a particularly nasty problem.  View data is not replicated so replicating documents can lead the view data by a large margin on the recipient database.  This can lead to inconsistencies.  You also can&apos;t expect users to then wait minutes (or hours) for a request to complete because the view generation got that far behind.  (My own plans now are to not use replication and instead create the database file on another couchdb instance and then rsync the binary database file over instead!)&lt;br/&gt;
&lt;br/&gt;
Although stale=ok is available, you still have no idea if the response will be quick or take however long view generation does.  (Sure I could add some sort of timeout and complicate the code but then what value do I pick?  If I have a user waiting I want an answer ASAP or I have to give them some horrible error message.  Taking a long wait and then giving a timeout is even worse!)</description>
                <environment>Ubuntu 9.10 64 bit, CouchDB 0.10</environment>
            <key id="12445158">COUCHDB-620</key>
        <summary>Generating views is extremely slow - makes CouchDB hard to use with non-trivial number of docs</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="rogerbinns">Roger Binns</reporter>
            
    <created>Mon, 11 Jan 2010 05:27:49 +0000 (UTC)</created>
    <updated>Thu, 21 Jan 2010 00:42:55 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12798602" author="djc" created="Mon, 11 Jan 2010 07:43:28 +0000 (UTC)"  >I was recently thinking about this and was wondering if CouchDB tries to parallellize view indexing to different CPU&apos;s at all. It seems the whole map-reduce paradigm was invented exactly to make it easy to run concurrently.</comment>
                    <comment id="12798612" author="rogerbinns" created="Mon, 11 Jan 2010 08:09:17 +0000 (UTC)"  >There is no parallelizing at all.  My comment does say that :-)&lt;br/&gt;
&lt;br/&gt;
Although doing it in parallel (or by number of CPU cores) will improve things, there is still lots more to be done.  (Going from 4 hours to 2 hours is still far too long.)  The various latencies add up a lot.  While CouchDB is considering which document to get view info for next, the couchjs process is sitting there idle.  While couchjs is processing a doc, CouchDB sits there idle.  Each side doing work while the other side is also working will significantly reduce the latencies and increase document processing throughput.</comment>
                    <comment id="12798691" author="kocolosk" created="Mon, 11 Jan 2010 15:29:37 +0000 (UTC)"  >Hi Roger, some of this work has already been implemented in trunk.  In particular, the next release uses separate work queues for mapping and reducing documents, so couchjs spends much less time idle.&lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure adding extra couchjs instances will be much of a win in general, as for many simple views couchjs can more than keep up with what the DB feeds it, and JS engines are only getting faster.  There&apos;s also a balancing act between handing cores to beam.smp and handing them to couchjs.  Erlang can certainly make use of multiple cores when the DB is experiencing a bunch of concurrent requests, and I worry that all the context switches involved with 1 couchjs/core might actually hurt performance.  I&apos;d love to see a patch and some benchmarks, though.&lt;br/&gt;
&lt;br/&gt;
See &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-495&quot; title=&quot;Make views twice as fast&quot;&gt;&lt;strike&gt;COUCHDB-495&lt;/strike&gt;&lt;/a&gt; for some of the view server performance work.</comment>
                    <comment id="12798711" author="rogerbinns" created="Mon, 11 Jan 2010 16:34:16 +0000 (UTC)"  >I currently have a 4 core machine (and 2 cores until a few weeks ago).  Less than one core in total is used between couchjs and beam.smp (erlang).  Even if the changes in 495 make it go twice as fast, the performance is still abysmal - I&apos;d still be measuring view generation time in hours and I&apos;d still have mostly idle CPU and I/O.  Even having there be one less couchjs than cores would be fine if you are that worried.  (The ideal number would depend on division  of labour during the view generation between erlang and couchjs.)&lt;br/&gt;
&lt;br/&gt;
In summary please saturate something - CPU, RAM or I/O when doing view generation.  Anything less than that means that the full resources of the machine are not being used and there is extra unnecessary wait for the view generation completion.  I&apos;d really like to stop measuring the time taken in hours.</comment>
                    <comment id="12798734" author="paul.joseph.davis" created="Mon, 11 Jan 2010 17:11:44 +0000 (UTC)"  >Much of CouchDB is written specifically so it does not saturate a single server&apos;s resources. That was done quite on purpose so as to not ping an entire server that may be serving clients. Granted view generation is still slowish, though getting better.&lt;br/&gt;
&lt;br/&gt;
I&apos;m becoming more convinced that to get to the truly fast view generation that everyone wants we&apos;re going to need to change some pretty fundamental things in view storage and generation. I don&apos;t think that&apos;s necessarily bad if it can be done simply, but its just not something anyone&apos;s gone and tried AFAIK. I was looking at a couple different storage things but nothing was stable enough for me to even do the work to try integrating.&lt;br/&gt;
&lt;br/&gt;
Also, patches welcome.</comment>
                    <comment id="12798736" author="kocolosk" created="Mon, 11 Jan 2010 17:20:12 +0000 (UTC)"  >So, when a public version of sharding lands oversharding (hosting multiple partitions of a DB on a single server) is a useful way to keep servers busy.  I&apos;ve seen view builds on oversharded Cloudant machines push EC2 ephemeral disk utilization above 95% and CPU utilization (including IOwait) above 180% on an m1.large.</comment>
                    <comment id="12798852" author="damienkatz" created="Mon, 11 Jan 2010 20:38:31 +0000 (UTC)"  >Closing as invalid this as it has no objective criteria for ever being closed, and the current trunk already implements most of the suggestions proposed.</comment>
                    <comment id="12798962" author="rogerbinns" created="Tue, 12 Jan 2010 00:45:15 +0000 (UTC)"  >The objective criteria is that the CPU and/or I/O is saturated, or at least close to saturation.  (Doing anything less is effectively adding gratuitous delays.  Operating systems have the ability to prioritize tasks easily once saturation has been achieved and is a better way of dealing with the issue.  For example would you add gratuitous delays to a C compiler so it has less impact on a machine?)&lt;br/&gt;
&lt;br/&gt;
I tried current svn trunk to see what the state is with my data set (10 million documents).&lt;br/&gt;
&lt;br/&gt;
Generating the view now takes about 75 minutes, whereas before it took 4 hours.  (The machine was also upgraded this weekend from two to four cores, 2.8GHz speed to 3.6GHz and double the disk bandwidth - new drives and striping, so the numbers are not strictly comparable.)&lt;br/&gt;
&lt;br/&gt;
During the view generation the CouchDB process took between 70% and 130% of a CPU, usually in the 110% range.  The couchjs process was hovering around 25% of a CPU.  Using iostat I could see between 5 and 30% of disk utilization, usually closer to 30%.  (iostat showed there was still plenty of disk access available.)&lt;br/&gt;
&lt;br/&gt;
Quite simply the view generation is still a very long time but somewhat more tolerable, 2 1/2 cores of my machine sat idle during this time while the disk was idle 66% of the time.  Trunk is consequently an improvement but nowhere near as good as it could be. &lt;br/&gt;
&lt;br/&gt;
I think this ticket should be re-opened, with the word &apos;extremely&apos; removed.&lt;br/&gt;
&lt;br/&gt;
To understand why I care so much, my views are my document access.  That is how the documents are found - look for strings in the view.  If the string is not found then the document may as well not exist.  Except the documents do reference each other so while view generation is happening it is possible to have inconsistencies - the view claiming a document doesn&apos;t exist while another linked one saying the first one does.&lt;br/&gt;
&lt;br/&gt;
And since views are generated on each machine after replication I can&apos;t incur the generation overhead on one machine and then replicate the results.&lt;br/&gt;
</comment>
                    <comment id="12799129" author="candlerb" created="Tue, 12 Jan 2010 09:24:29 +0000 (UTC)"  >&amp;quot;the CouchDB process took between 70% and 130% of a CPU, usually in the 110% range&amp;quot;&lt;br/&gt;
&lt;br/&gt;
That looks like one CPU fully used for CouchDB (with afterburners to get to 110% :-)&lt;br/&gt;
&lt;br/&gt;
&amp;quot;The couchjs process was hovering around 25% of a CPU&amp;quot; - which suggests that couchjs is waiting on couchdb to issue it with more work, so parallelising couchjs wouldn&apos;t help.&lt;br/&gt;
&lt;br/&gt;
For comparison, have you tried the erlang view server? That would eliminate JSON serialisation/deserialisation overhead, plus much of the message-passing overhead. It would be very useful to have this comparison on your large dataset.&lt;br/&gt;
&lt;br/&gt;
If measurement shows that the json serialisation overhead is large, maybe there&apos;s a fairly simple improvement: in couch_os_process.erl, make writejson and readjson execute in separate erlang processes, so they can execute on another core. You would need to pipeline requests to the view server to get the full benefit though.&lt;br/&gt;
</comment>
                    <comment id="12799251" author="kocolosk" created="Tue, 12 Jan 2010 16:24:44 +0000 (UTC)"  >Brian is spot-on here regarding the next steps.  I haven&apos;t checked -- does couchjs support pipelining?</comment>
                    <comment id="12799400" author="paul.joseph.davis" created="Tue, 12 Jan 2010 21:39:52 +0000 (UTC)"  >Chris responded on dev@ with:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; The couchjs view server protocol is strictly line based. Each line is&lt;br/&gt;
&amp;gt; parsed to JSON after it is received. Then the computation is done, and&lt;br/&gt;
&amp;gt; a line of JSON is returned.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; Since the couchjs server is single threaded it hasn&apos;t made much sense&lt;br/&gt;
&amp;gt; to make the protocol more complex.&lt;br/&gt;
&lt;br/&gt;
I&apos;d just point out that pipelining is not the same as threading. I&apos;m pretty certain we could pipeline from the Erlang side without affecting the protocol (assuming that responses are yielded in exactly the same order as requests were provided). All pipelining does is allow for streaming data through the process.&lt;br/&gt;
&lt;br/&gt;
A picture can probably explain lots better than any wording so I&apos;m attaching a whiteboard diagram.</comment>
                    <comment id="12799411" author="rogerbinns" created="Tue, 12 Jan 2010 22:00:12 +0000 (UTC)"  >The latency in a non-pipelined implementation really adds up.  For example an additional 1 millisecond latency adds almost 3 minutes to generation time with a 10 million document database.  Have a millisecond here, a millisecond there and pretty soon you are measuring generation times in hours  :-)&lt;br/&gt;
&lt;br/&gt;
Since couchjs is not threaded I don&apos;t see any way for it to answer requests in a different order than sent.  (Ok you can do it with some sort of some internal state machine and non-blocking I/O like Python&apos;s Twisted but I&apos;m pretty sure couchjs is not doing that either.)&lt;br/&gt;
&lt;br/&gt;
The only complication with pipelining is error handling.  For example there may be 5 requests in the pipeline when the couchjs processes crashes.  Any unanswered requests would then need to be resubmitted to a freshly spawned couchjs.&lt;br/&gt;
&lt;br/&gt;
(BTW Brian 110% CPU consumption has nothing to do with afterburners.  Strictly speaking I meant core not CPU.  It just means multiple threads at the OS level were running and aggregate consumption between them amounted to 110% of a single core.  Or in other words CouchDB/beam.smp consumed 27.5% of the total compute resources that were available - 4 cores in one CPU.  CouchDB also seems to avoid using more than 3% of my available RAM.)</comment>
                    <comment id="12799586" author="candlerb" created="Wed, 13 Jan 2010 05:38:44 +0000 (UTC)"  >Like Paul says: I am not proposing any change to the couchjs protocol, nor to allow out-of-order returning of responses from couchjs.&lt;br/&gt;
&lt;br/&gt;
Just this: that the core takes the next 3 (say) documents to be processed, stuffs them down the socket to couchjs, then sends another one each time a whole document response is received.&lt;br/&gt;
&lt;br/&gt;
The couchjs view server is completely unaware of this, since it runs lock-step (read a request, emit response, read request, emit response). It&apos;s just that when it next comes to read a request, there will be one waiting for it already.&lt;br/&gt;
&lt;br/&gt;
The same as HTTP pipelining, in other words.&lt;br/&gt;
&lt;br/&gt;
I don&apos;t see any particular problem with error handling. If you&apos;ve not received a complete response for document X, then you don&apos;t update the view pointer so you&apos;ll try again next time.</comment>
                    <comment id="12799769" author="paul.joseph.davis" created="Wed, 13 Jan 2010 14:39:40 +0000 (UTC)"  >The error reporting issue is that if you&apos;ve got four docs in the pipeline, and the process dies, then its hard to tell which document caused the error. And generally retrying will just cause another error.</comment>
                    <comment id="12800145" author="candlerb" created="Thu, 14 Jan 2010 08:13:10 +0000 (UTC)"  >&amp;gt;The error reporting issue is that if you&apos;ve got four docs in the pipeline, and the process dies, then its hard to tell which document caused the error.&lt;br/&gt;
&lt;br/&gt;
Well, I guess it is on the &apos;push&apos; side. But if you update your pointers on the &apos;pull&apos; side, and you&apos;ve had two documents back, then the error must be in the third.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; And generally retrying will just cause another error.&lt;br/&gt;
&lt;br/&gt;
If the view server *crashes* when fed document X, then I think document X should be retried - i.e. this was probably an intermittent server error.&lt;br/&gt;
&lt;br/&gt;
But if processing document X raised an *exception* (i.e. map function cannot handle the content) then I&apos;d have thought that couchjs should catch, serialise and return the exception. That would allow the document to be skipped cleanly.&lt;br/&gt;
</comment>
                    <comment id="12803089" author="jmarca" created="Thu, 21 Jan 2010 00:42:55 +0000 (UTC)"  >I too am interested in getting view generation to go faster.  I have 2 databases, one with 20 million documents, another with around 10 million.  The documents are large (hourly raw data dumps) and the view is tedious (5 minute averages of raw data), but generation is taking way too long.  I&apos;ve been running the process for a few days and am only at 20% done on the smaller, and 10% on the larger one.  &lt;br/&gt;
&lt;br/&gt;
In testing things, I set up the 10 million document db at 12 smaller dbs, one per month.  There the performance was slow, but it took a weekend as I recall, not more.  At the time I was generating the views on all dbs at once.&lt;br/&gt;
&lt;br/&gt;
I am running a very recent git version of couchdb.&lt;br/&gt;
&lt;br/&gt;
Sorry, I don&apos;t know erlang at all so I can&apos;t submit patches.  I would be willing to learn enough erlang to recode my view, but haven&apos;t had time yet.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12430046" name="pipelining.jpg" size="89984" author="paul.joseph.davis" created="Tue, 12 Jan 2010 21:39:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 11 Jan 2010 20:38:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 11 Jan 2010 07:43:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-619] Don&apos;t keep looping when couchjs fails to start</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-619</link>

                    <description>Ubuntu just sent out a new version of xulrunner (1.9.1.6 -&amp;gt; 1.9.1.7)&lt;br/&gt;
&lt;br/&gt;
As a result, couchjs no longer worked, as it was linked against 1.9.1.6 in a specific directory, and that directory had been removed.&lt;br/&gt;
&lt;br/&gt;
However it took me a bit to work out what was going on. When I ran the test suite, it just got stuck at &amp;quot;&amp;gt; Basic &amp;gt; Running...&amp;quot;.  A curl &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt; was fine, but any attempt to make a query just hung. Eventually I found that loads of these were being logged:&lt;br/&gt;
&lt;br/&gt;
[Sat, 09 Jan 2010 12:07:43 GMT] [error] [&amp;lt;0.129.0&amp;gt;] OS Process Error &amp;lt;0.1918.0&amp;gt; :: {os_process_error,{exit_status,127}}&lt;br/&gt;
[Sat, 09 Jan 2010 12:07:43 GMT] [error] [&amp;lt;0.129.0&amp;gt;] OS Process Error &amp;lt;0.1921.0&amp;gt; :: {os_process_error,{exit_status,127}}&lt;br/&gt;
[Sat, 09 Jan 2010 12:07:43 GMT] [error] [&amp;lt;0.129.0&amp;gt;] OS Process Error &amp;lt;0.1924.0&amp;gt; :: {os_process_error,{exit_status,127}}&lt;br/&gt;
[Sat, 09 Jan 2010 12:07:43 GMT] [error] [&amp;lt;0.129.0&amp;gt;] OS Process Error &amp;lt;0.1927.0&amp;gt; :: {os_process_error,{exit_status,127}}&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
(over 3MB by the time I&apos;d realised).&lt;br/&gt;
&lt;br/&gt;
I wonder if couchdb could handle this a bit more gracefully? For example, if couchjs starts and dies before even a single request has been sent to it, then disable it for a few minutes and/or log a more specific error message?&lt;br/&gt;
&lt;br/&gt;
Returning an error to the view client would be good too, rather than hanging waiting for a view update which can never complete. Just a thought.&lt;br/&gt;
</description>
                <environment>couchdb trunk&lt;br/&gt;
ubuntu karmic x64</environment>
            <key id="12445103">COUCHDB-619</key>
        <summary>Don&apos;t keep looping when couchjs fails to start</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Sat, 9 Jan 2010 12:16:07 +0000 (UTC)</created>
    <updated>Sat, 9 Jan 2010 18:47:33 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12798380" author="jchris" created="Sat, 9 Jan 2010 17:29:19 +0000 (UTC)"  >I agree, this would be a nice fix. Maybe the way to fix it is to config couch to have a bad crasher as it&apos;s view server, and work to make the error&apos;s graceful.&lt;br/&gt;
&lt;br/&gt;
maybe config the query server to be `grep` because without any args I think that will just crash.</comment>
                    <comment id="12798390" author="candlerb" created="Sat, 9 Jan 2010 18:47:33 +0000 (UTC)"  >Or just config the query server as couchjs without main.js&lt;br/&gt;
&lt;br/&gt;
$ /usr/local/bin/couchjs &lt;br/&gt;
You must specify a FILE.&lt;br/&gt;
&lt;br/&gt;
Try `couchjs -h&apos; for more information.&lt;br/&gt;
$ echo $?&lt;br/&gt;
1&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 9 Jan 2010 17:29:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-618] Content-Type of 304 responses are not negotiated.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-618</link>

                    <description>304 responses are always text/plain even if you Accept: application/json&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12445068">COUCHDB-618</key>
        <summary>Content-Type of 304 responses are not negotiated.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Fri, 8 Jan 2010 20:21:35 +0000 (UTC)</created>
    <updated>Fri, 8 Jan 2010 20:40:55 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12798167" author="rnewson" created="Fri, 8 Jan 2010 20:22:52 +0000 (UTC)"  >Negotiate content-type of response for 304 (Not modified) path.</comment>
                    <comment id="12798172" author="rnewson" created="Fri, 8 Jan 2010 20:40:55 +0000 (UTC)"  >Further reading of http 1.1 RFC, we shouldn&apos;t include a Content-Type header at all for this, so the paths that do (and with text/plain) are &amp;quot;wrong&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
This bug, therefore, is to fix the 304 response so that it doesn&apos;t return a Content-Type header.</comment>
                </comments>
    
    <attachments>
            <attachment id="12429781" name="304-etag-response.diff" size="608" author="rnewson" created="Fri, 8 Jan 2010 20:22:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-617] Large integers being turned into floats</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-617</link>

                    <description>Somewhere between the view server and the client, large integer values are having .0 appended to make them look like floats.&lt;br/&gt;
&lt;br/&gt;
This is OK:&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emit(2000000000,null); }&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_temp_view&quot;&gt;http://127.0.0.1:5984/test_suite_db/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:3,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;bar&amp;quot;,&amp;quot;key&amp;quot;:2000000000,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;baz&amp;quot;,&amp;quot;key&amp;quot;:2000000000,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;key&amp;quot;:2000000000,&amp;quot;value&amp;quot;:null}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
But here&apos;s a large integer getting the .0 appended:&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emit(1262958680124,null); }&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_temp_view&quot;&gt;http://127.0.0.1:5984/test_suite_db/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:3,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;bar&amp;quot;,&amp;quot;key&amp;quot;:1262958680124.0,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;baz&amp;quot;,&amp;quot;key&amp;quot;:1262958680124.0,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;key&amp;quot;:1262958680124.0,&amp;quot;value&amp;quot;:null}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
And some values are getting turned into exponential format:&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emit(3000000000,null); }&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_temp_view&quot;&gt;http://127.0.0.1:5984/test_suite_db/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:3,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;bar&amp;quot;,&amp;quot;key&amp;quot;:3.0e+9,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;baz&amp;quot;,&amp;quot;key&amp;quot;:3.0e+9,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;key&amp;quot;:3.0e+9,&amp;quot;value&amp;quot;:null}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
It appears to affect integers larger than 2^31, but these are still much smaller than the 2^48 mantissa of IEEE double precision (which Javascript uses). Hence they should be accurately represented as integers, not floats.&lt;br/&gt;
&lt;br/&gt;
If I run the view server by itself from the command line, all works properly:&lt;br/&gt;
&lt;br/&gt;
$ bin/couchjs share/server/main.js &lt;br/&gt;
[&amp;quot;reset&amp;quot;]&lt;br/&gt;
true&lt;br/&gt;
[&amp;quot;add_fun&amp;quot;,&amp;quot;function(doc) { emit(1262958680124,null); }&amp;quot;]&lt;br/&gt;
true&lt;br/&gt;
[&amp;quot;add_fun&amp;quot;,&amp;quot;function(doc) { emit(3000000000,null); }&amp;quot;]&lt;br/&gt;
true&lt;br/&gt;
[&amp;quot;map_doc&amp;quot;,{}]&lt;br/&gt;
[[[1262958680124,null]], [[3000000000,null]]]&lt;br/&gt;
&lt;br/&gt;
Therefore it looks like the problem is in the Erlang JSON deserialisation side. i.e. it&apos;s not keeping these values as large integers, when it could be.&lt;br/&gt;
&lt;br/&gt;
NOTE: I have another machine, running a similar recent couchdb trunk (0.11.0b894828) plus Ubuntu Karmic Server Edition built against libmozjs 1.8.1.16 (not xulrunner). This exhibits the same behaviour as above.&lt;br/&gt;
&lt;br/&gt;
But the problem *doesn&apos;t* appear on another, older CouchDB installation I have. This is 0.11.0a813819 running under Ubuntu Hardy, with erlang 12.b.5 and libmozjs 1.8.1.18&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;person&amp;quot;,&amp;quot;key&amp;quot;:3000000000,&amp;quot;value&amp;quot;:null}&lt;br/&gt;
]}&lt;br/&gt;
</description>
                <environment>0.11.0b894112&lt;br/&gt;
Ubuntu Karmic&lt;br/&gt;
standard erlang 13.b.1 package&lt;br/&gt;
xulrunner 1.9.1.6&lt;br/&gt;
</environment>
            <key id="12445042">COUCHDB-617</key>
        <summary>Large integers being turned into floats</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Fri, 8 Jan 2010 14:30:35 +0000 (UTC)</created>
    <updated>Sat, 9 Jan 2010 17:12:49 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12798034" author="candlerb" created="Fri, 8 Jan 2010 14:44:43 +0000 (UTC)"  >Actually, the same is happening just when saving and retrieving documents (so not touching the view server at all).&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT -d &apos;{&amp;quot;v&amp;quot;:3000000000}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/xyzzy&quot;&gt;http://127.0.0.1:5984/test_suite_db/xyzzy&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;xyzzy&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-05551cfd0e8e3f5dc99054be3b105483&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/xyzzy&quot;&gt;http://127.0.0.1:5984/test_suite_db/xyzzy&lt;/a&gt;&lt;br/&gt;
{&amp;quot;_id&amp;quot;:&amp;quot;xyzzy&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;1-05551cfd0e8e3f5dc99054be3b105483&amp;quot;,&amp;quot;v&amp;quot;:3.0e+9}&lt;br/&gt;
</comment>
                    <comment id="12798039" author="kocolosk" created="Fri, 8 Jan 2010 15:09:39 +0000 (UTC)"  >If memory serves mochijson2 did change its behavior when we switched from r97 to r113 to only support integers up to 2^31.</comment>
                    <comment id="12798041" author="kocolosk" created="Fri, 8 Jan 2010 15:17:27 +0000 (UTC)"  >Hmm, here&apos;s the mochiweb revision which specifies the behavior you&apos;re seeing, but it&apos;s much earlier than r97:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mochiweb/source/detail?r=43&quot;&gt;http://code.google.com/p/mochiweb/source/detail?r=43&lt;/a&gt;</comment>
                    <comment id="12798073" author="candlerb" created="Fri, 8 Jan 2010 17:06:09 +0000 (UTC)"  >On the older machine (r97):&lt;br/&gt;
&lt;br/&gt;
$ erl +Bc -pa /usr/local/lib/couchdb/erlang/lib/mochiweb-r97/ebin&lt;br/&gt;
Erlang (BEAM) emulator version 5.6.5 [source] [async-threads:0] [kernel-poll:false]&lt;br/&gt;
&lt;br/&gt;
Eshell V5.6.5  (abort with ^G)&lt;br/&gt;
1&amp;gt; D = mochijson2:decode(&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;v\&amp;quot;:3000000000}&amp;quot;&amp;gt;&amp;gt;).&lt;br/&gt;
{[{&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,3000000000}]}&lt;br/&gt;
2&amp;gt; mochijson2:encode(D).&lt;br/&gt;
[123,[34,&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,34],58,&amp;quot;3000000000&amp;quot;,125]&lt;br/&gt;
&lt;br/&gt;
On the newer machine (r113):&lt;br/&gt;
&lt;br/&gt;
$ erl +Bc -pa /usr/local/lib/couchdb/erlang/lib/mochiweb-r113/ebin&lt;br/&gt;
Erlang R13B01 (erts-5.7.2) [source] [64-bit] [smp:2:2] [rq:2] [async-threads:0] [kernel-poll:false]&lt;br/&gt;
&lt;br/&gt;
Eshell V5.7.2  (abort with ^G)&lt;br/&gt;
1&amp;gt; D = mochijson2:decode(&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;v\&amp;quot;:3000000000}&amp;quot;&amp;gt;&amp;gt;).&lt;br/&gt;
{struct,[{&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,3000000000}]}&lt;br/&gt;
2&amp;gt; mochijson2:encode(D).&lt;br/&gt;
[123,[34,&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,34],58,&amp;quot;3.0e+9&amp;quot;,125]&lt;br/&gt;
&lt;br/&gt;
Something has definitely changed, either with mochiweb or with the underlying erlang platform.&lt;br/&gt;
&lt;br/&gt;
Incidentally, the newer machine is Ubuntu 64-bi. Doesn&apos;t really explain why a 32-bit machine gets it right though :-)&lt;br/&gt;
</comment>
                    <comment id="12798075" author="candlerb" created="Fri, 8 Jan 2010 17:10:10 +0000 (UTC)"  >mochijson2.erl appears to be completely self-contained, so I just copied it (the r97 version) across onto the newer machine and compiled it locally:&lt;br/&gt;
&lt;br/&gt;
$ erl +Bc&lt;br/&gt;
Erlang R13B01 (erts-5.7.2) [source] [64-bit] [smp:2:2] [rq:2] [async-threads:0] [kernel-poll:false]&lt;br/&gt;
&lt;br/&gt;
Eshell V5.7.2  (abort with ^G)&lt;br/&gt;
1&amp;gt; c(mochijson2).&lt;br/&gt;
{ok,mochijson2}&lt;br/&gt;
2&amp;gt; D = mochijson2:decode(&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;v\&amp;quot;:3000000000}&amp;quot;&amp;gt;&amp;gt;).&lt;br/&gt;
{[{&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,3000000000}]}&lt;br/&gt;
3&amp;gt; mochijson2:encode(D).&lt;br/&gt;
[123,[34,&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,34],58,&amp;quot;3000000000&amp;quot;,125]&lt;br/&gt;
4&amp;gt; &lt;br/&gt;
&lt;br/&gt;
As you can see, it works fine.&lt;br/&gt;
</comment>
                    <comment id="12798076" author="kocolosk" created="Fri, 8 Jan 2010 17:12:35 +0000 (UTC)"  >Right, we weren&apos;t using stock mochiweb in r97, so it&apos;s possible that our custom fork also changed this behavior.  Also note that trunk uses couch_util:json_(de|en)code/1 to strip off the {struct, } part of the default mochijson2 format.</comment>
                    <comment id="12798079" author="kocolosk" created="Fri, 8 Jan 2010 17:15:26 +0000 (UTC)"  >Ok, confirmed -- our forked version of mochijson2 did not have this guard that limits integers to 2^31.  I don&apos;t know if this was a conscious decision on our part, or if we simply neglected to apply a patch from upstream.</comment>
                    <comment id="12798081" author="candlerb" created="Fri, 8 Jan 2010 17:21:59 +0000 (UTC)"  >&amp;gt; our forked version of mochijson2 did not have this guard that limits integers to 2^31&lt;br/&gt;
&lt;br/&gt;
Yes, I just checked out r97 directly from google code to check:&lt;br/&gt;
&lt;br/&gt;
$ erl +Bc&lt;br/&gt;
Erlang R13B01 (erts-5.7.2) [source] [64-bit] [smp:2:2] [rq:2] [async-threads:0] [kernel-poll:false]&lt;br/&gt;
&lt;br/&gt;
Eshell V5.7.2  (abort with ^G)&lt;br/&gt;
1&amp;gt; c(mochijson2).&lt;br/&gt;
{ok,mochijson2}&lt;br/&gt;
2&amp;gt; D = mochijson2:decode(&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;v\&amp;quot;:3000000000}&amp;quot;&amp;gt;&amp;gt;).&lt;br/&gt;
{struct,[{&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,3000000000}]}&lt;br/&gt;
3&amp;gt; mochijson2:encode(D). &lt;br/&gt;
** exception error: undefined function mochinum:digits/1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;in function  mochijson2:&apos;-json_encode_proplist/2-fun-0-&apos;/3&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;in call from lists:foldl/3&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;in call from mochijson2:json_encode_proplist/2&lt;br/&gt;
4&amp;gt; &lt;br/&gt;
4&amp;gt; c(mochinum).&lt;br/&gt;
{ok,mochinum}&lt;br/&gt;
5&amp;gt; mochijson2:encode(D).                           &lt;br/&gt;
[123,[34,&amp;lt;&amp;lt;&amp;quot;v&amp;quot;&amp;gt;&amp;gt;,34],58,&amp;quot;3.0e+9&amp;quot;,125]&lt;br/&gt;
6&amp;gt; &lt;br/&gt;
</comment>
                    <comment id="12798100" author="jchris" created="Fri, 8 Jan 2010 17:55:40 +0000 (UTC)"  >I removed this guard when upgrading mochijson at one point because it caused a regression with regard to large number handing.&lt;br/&gt;
&lt;br/&gt;
As per the JSON spec we can pretty much do whatever we want here. We should decide what behavior we like and then add a test to keep it proper. (This stuff is hard to test from the browser.)</comment>
                    <comment id="12798336" author="candlerb" created="Sat, 9 Jan 2010 11:59:28 +0000 (UTC)"  >The behaviour I&apos;d like is for huge ints to remain as huge ints. Does anyone object?&lt;br/&gt;
&lt;br/&gt;
I imagine it should be OK to test from the browser, as long as you can examine the raw text response before it has been JSON-parsed, but I am not an expert in javascript-in-browser programming.&lt;br/&gt;
</comment>
                    <comment id="12798378" author="candlerb" created="Sat, 9 Jan 2010 17:12:49 +0000 (UTC)"  >Here is a simple test case for the JSON round-trip</comment>
                </comments>
    
    <attachments>
            <attachment id="12429825" name="couchdb-test-json.diff" size="2123" author="candlerb" created="Sat, 9 Jan 2010 17:12:48 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 8 Jan 2010 15:09:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-616] 0.9-&gt;0.10 upgrade rebuilds views rather than just updating headers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-616</link>

                    <description>It looks like there is code that is supposed to upgrade the headers of 0.9 views to 0.10 style when a 0.10 couch reads a 0.9 view to avoid having to rebuild them (see &lt;a href=&quot;http://github.com/halorgium/couchdb/blob/v0.10.1/src/couchdb/couch_view_group.erl#L379)&quot;&gt;http://github.com/halorgium/couchdb/blob/v0.10.1/src/couchdb/couch_view_group.erl#L379)&lt;/a&gt;. However, they are indeed getting rebuilt.&lt;br/&gt;
&lt;br/&gt;
I have a test environment set up where I can trigger this behavior. I&apos;ve added the debug output at &lt;a href=&quot;http://paste.pocoo.org/show/163023/&quot;&gt;http://paste.pocoo.org/show/163023/&lt;/a&gt; and here is what&apos;s getting printed:&lt;br/&gt;
&lt;br/&gt;
before upgrade_old_header&lt;br/&gt;
after upgrade_old_header&lt;br/&gt;
Pos: 0&lt;br/&gt;
Error: {&apos;EXIT&apos;,{{badmatch,eof},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_file,load_header,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_file,find_header,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_file,handle_call,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}}&lt;br/&gt;
read_header: no_valid_header&lt;br/&gt;
calling reset_file&lt;br/&gt;
truncating&lt;br/&gt;
&lt;br/&gt;
For some reason the file:position(Fd, eof) call is return 0, indicating a 0-length file, but the view file in question is 188M.&lt;br/&gt;
&lt;br/&gt;
I spent a while debugging this with Jan in #couchdb today but we couldn&apos;t find the fix.</description>
                <environment>Linux melkjug-xen 2.6.30.1-pv #1 SMP Thu Jul 9 08:12:56 EDT 2009 x86_64 Intel(R) Xeon(R) CPU E5430 @ 2.66GHz GenuineIntel GNU/Linux&lt;br/&gt;
Erlang (BEAM) emulator version 5.6.5 [source] [64-bit] [smp:2] [async-threads:0] [hipe]</environment>
            <key id="12444952">COUCHDB-616</key>
        <summary>0.9-&gt;0.10 upgrade rebuilds views rather than just updating headers</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Thu, 7 Jan 2010 19:23:05 +0000 (UTC)</created>
    <updated>Thu, 7 Jan 2010 19:23:05 +0000 (UTC)</updated>

                        <version>0.10.1</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-615] Role, ACL and Ownership Checks</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-615</link>

                    <description>It would be nice if CouchDB had a comprehensive offering for varying levels of access to documents and databases.&lt;br/&gt;
&lt;br/&gt;
Here are some ideas:&lt;br/&gt;
&lt;br/&gt;
o User lists are stored in the database, per database.&lt;br/&gt;
o Roles and role membership are stored in the database, per database.&lt;br/&gt;
o ACLs are stored in the database, per database.&lt;br/&gt;
o CouchDB can use ACLs to store and simplify permissions for internal functionality (manage the db, manage users, add roles, add users to roles, etc...)&lt;br/&gt;
o CouchApps can take advantage of the ACLs to support login/logout and arbitrary business rules as needed.&lt;br/&gt;
o A simple API can be made to conduct role, ACL and ownership checks.&lt;br/&gt;
&lt;br/&gt;
I suppose there is some theory and discussion behind determining whether users, roles or both are stored in ACL rules.  Also, something worth discussing is whether the checks are automatically performed by couchdb, or if views are to be performing checks prior to emitting data.  Or both...&lt;br/&gt;
&lt;br/&gt;
Building all this into CouchDB would mean that it has a mechanism for complex applications to be developed.  Ones that mandate privacy and other visibility concerns.</description>
                <environment>Ubuntu 9.10 64bit</environment>
            <key id="12444795">COUCHDB-615</key>
        <summary>Role, ACL and Ownership Checks</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="omega">Alexander Trauzzi</reporter>
            
    <created>Wed, 6 Jan 2010 15:06:04 +0000 (UTC)</created>
    <updated>Wed, 13 Jan 2010 01:06:57 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12797237" author="jchris" created="Wed, 6 Jan 2010 18:43:35 +0000 (UTC)"  >The current update authorization model is very solid, and probably won&apos;t be changing. &lt;br/&gt;
&lt;br/&gt;
There are some good ideas in the ticket regarding read authorization.&lt;br/&gt;
&lt;br/&gt;
Our big missing piece is per-database reader ACLs. It&apos;s not clear if these should be stored in local docs (non-replicating) or normal docs (so they replicate.)&lt;br/&gt;
&lt;br/&gt;
My guess is that we want them to replicate, as many app installations will span nodes.&lt;br/&gt;
&lt;br/&gt;
We probably want them in a document that only admins can edit, and I don&apos;t think we want the ACLs in _design documents. So maybe we need a new type of document. How does _security/foo sound?&lt;br/&gt;
&lt;br/&gt;
Currently the db_admins role list is checked against the userCtx roles as well as username. Which means we are dealing with a flat namespace. I&apos;ve got some notes about the account branch that deal with this stuff that I&apos;ll be post soon as well.&lt;br/&gt;
</comment>
                    <comment id="12797609" author="sprocketonline" created="Thu, 7 Jan 2010 12:56:46 +0000 (UTC)"  >I&apos;d like to see authorization based replication - i.e. only being able to replicate parts of the database for which the user is authorized.</comment>
                    <comment id="12797683" author="jchris" created="Thu, 7 Jan 2010 16:55:01 +0000 (UTC)"  >We already have this, in the sense that replication uses the normal HTTP API. So if a user is not and admin, they will not be able to replicate _design documents to the target. &lt;br/&gt;
&lt;br/&gt;
Similarly, if the target has a validation function that says all docs must have a foo field, than any docs that are missing a foo field will not be replicated.&lt;br/&gt;
&lt;br/&gt;
Because CouchDB has not read-authorization model, there isn&apos;t the same thing for reads. When we add the ability to control read-access to databases, users will only be able to replicate from databases they can read.</comment>
                    <comment id="12799506" author="omega" created="Wed, 13 Jan 2010 01:06:57 +0000 (UTC)"  >The first part of this note is an aside which could be separated out into another discussion or issue if desired...&lt;br/&gt;
&lt;br/&gt;
It&apos;s important not to conflate the functionality of reading the DB from an application point of view (JSON request coming from a browser) and reading the DB as a function of infrastructure (a scheduled replication).&lt;br/&gt;
&lt;br/&gt;
I should note that I see the use in allowing replications to happen in the context of a user per database, but *not per server*.  This allows for local copies of DB for higher availability, but they are only populated with data the user can see.&lt;br/&gt;
Ultimately, replications and DBs will have to function in different contexts.  Control over what replications a server performs is still a system-wide administrative task to be done with absolute authority.&lt;br/&gt;
&lt;br/&gt;
Example:&lt;br/&gt;
1. &lt;a href=&quot;http://www.giantsocialcdcollectionsite.net&quot;&gt;http://www.giantsocialcdcollectionsite.net&lt;/a&gt; is running couchdb.&lt;br/&gt;
2. I make a user there.&lt;br/&gt;
3. I start to populate my CD collection and share information with others.\&lt;br/&gt;
4. I&apos;m going on a plane and want my CD collection list with me.&lt;br/&gt;
5. I install CouchDB on my favorite OS via my favorite means.&lt;br/&gt;
6. As I am an administrator on my laptop, I elect to replicate &lt;a href=&quot;http://www.giantsocialcdcollectionsite.net&quot;&gt;http://www.giantsocialcdcollectionsite.net&lt;/a&gt;.&lt;br/&gt;
7. &lt;a href=&quot;http://www.giantsocialcdcollectionsite.net&quot;&gt;http://www.giantsocialcdcollectionsite.net&lt;/a&gt; requires that I authenticate so that it can filter my replication.&lt;br/&gt;
&lt;br/&gt;
I think you can see how incredibly neat that ends up being...Of course then some people will want ways to obfuscate the _design docs... But that&apos;s getting into the nitty gritties.&lt;br/&gt;
&lt;br/&gt;
Replication should function with indifference towards the DBs, users and CouchApps being replicated and have little to nothing to do with them.  It should function behind the scenes as part of a broader, more general systems design.&lt;br/&gt;
That&apos;s why things like per-DB roles and users may be nessecary to prevent the server and the databases from bleeding into each other.&lt;br/&gt;
&lt;br/&gt;
To me, replication is not something my users should even have to know about.  You write one app and if you need to scale out, you simply set up replication.&lt;br/&gt;
&lt;br/&gt;
-=-&lt;br/&gt;
&lt;br/&gt;
Anyway...&lt;br/&gt;
This issue that I have made here is over the permissions of authenticated users of the DB and what data they can and cannot read:&lt;br/&gt;
&lt;br/&gt;
Right now, there is no way to secure a request to &lt;a href=&quot;http://mycouchdb/mydb/myprivatedata&quot;&gt;http://mycouchdb/mydb/myprivatedata&lt;/a&gt; on CouchDB without involving cumbersome workarounds.  I am loathe to think of the impact on the project if this is not addressed.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 6 Jan 2010 18:43:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-614] password hash shouldn&apos;t be displayed in _config display</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-614</link>

                    <description>password hash shouldn&apos;t be displayed in _config display.</description>
                <environment></environment>
            <key id="12444720">COUCHDB-614</key>
        <summary>password hash shouldn&apos;t be displayed in _config display</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 5 Jan 2010 16:02:27 +0000 (UTC)</created>
    <updated>Wed, 6 Jan 2010 18:53:11 +0000 (UTC)</updated>

                        <version>0.10.1</version>
                    <version>0.10.2</version>
                    <version>0.11</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12796771" author="jchris" created="Tue, 5 Jan 2010 17:19:18 +0000 (UTC)"  >Why not? This is useful for eg: manually copying admin config to a new node.&lt;br/&gt;
&lt;br/&gt;
Since only admins can see the config anyway, and it&apos;s nothing they couldn&apos;t get from the config API or the local.ini, I see no reason to be modest about it in Futon.</comment>
                    <comment id="12797008" author="benoitc" created="Wed, 6 Jan 2010 06:41:53 +0000 (UTC)"  >Well page could be opened by an admin but visible by everyone, it could be a security problem.</comment>
                    <comment id="12797141" author="kocolosk" created="Wed, 6 Jan 2010 15:43:33 +0000 (UTC)"  >Hi Benoit, the _config display is only readable by admins already, right?</comment>
                    <comment id="12797159" author="jchris" created="Wed, 6 Jan 2010 16:12:05 +0000 (UTC)"  >could make sense to do an ajax &amp;quot;click to show&amp;quot; for the hashed password. like aws does. if you think it&apos;s important.</comment>
                    <comment id="12797162" author="benoitc" created="Wed, 6 Jan 2010 16:23:20 +0000 (UTC)"  >@adam yes, but you can let your computer open behind you. &lt;br/&gt;
&lt;br/&gt;
I think that we should make really hard for people to show hashes. The click for show and asking a second time for the password is good but I wonder if it&apos;s useful if they can just request the _config. </comment>
                    <comment id="12797165" author="swehner" created="Wed, 6 Jan 2010 16:27:29 +0000 (UTC)"  >Could the page with the password hash be accessed by an admin through http (not encrypted)?&lt;br/&gt;
&lt;br/&gt;
(Do I understand this right that no salt is involved in password hashing?)&lt;br/&gt;
&lt;br/&gt;
Stephan</comment>
                    <comment id="12797173" author="jchris" created="Wed, 6 Jan 2010 16:44:38 +0000 (UTC)"  >maybe are real solution to this is to make it simpler for users to pick which system roles they&apos;d like to apply to given operations.&lt;br/&gt;
&lt;br/&gt;
Just because my user account has an admin role, doesn&apos;t mean I want all my operations should to have admin privileges. Maybe a way to say &amp;quot;treat me like a normal user&amp;quot; would add some protection.</comment>
                    <comment id="12797174" author="jchris" created="Wed, 6 Jan 2010 16:45:11 +0000 (UTC)"  >@Stephan&lt;br/&gt;
&lt;br/&gt;
The hashed passwords are salted.</comment>
                    <comment id="12797242" author="swehner" created="Wed, 6 Jan 2010 18:52:15 +0000 (UTC)"  >Thanks Chris!&lt;br/&gt;
&lt;br/&gt;
Since the passwords are salted, is there any use in displaying the hash (assuming the salt is not also displayed) ?&lt;br/&gt;
&lt;br/&gt;
Stephan</comment>
                    <comment id="12797243" author="jchris" created="Wed, 6 Jan 2010 18:53:11 +0000 (UTC)"  >on #couchdb ravidgemole and davidc and I were discussing an configuration option: require_https which would solve this for people who need the extra security.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 5 Jan 2010 17:19:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-613] Compaction tasks crash</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-613</link>

                    <description>I&apos;m running repeated tests where I create multiple databases on multiple machines and then compact them all in parallel. &lt;br/&gt;
&lt;br/&gt;
This almost always works but sometimes does not. Specifically, I have one machine where each .compact file is about 50% complete (I know this because I see successfully compacted versions of the same data on the other machines in my set) and this in the log;&lt;br/&gt;
&lt;br/&gt;
[Mon, 04 Jan 2010 19:50:23 GMT] [error] [&amp;lt;0.17793.28&amp;gt;] Uncaught error in HTTP request: {exit,noproc}&lt;br/&gt;
&lt;br/&gt;
[Mon, 04 Jan 2010 19:50:26 GMT] [error] [&amp;lt;0.17801.28&amp;gt;] Uncaught error in HTTP request: {exit,noproc}&lt;br/&gt;
&lt;br/&gt;
[Mon, 04 Jan 2010 19:50:26 GMT] [error] [&amp;lt;0.17753.28&amp;gt;] Uncaught error in HTTP request: {exit,noproc}&lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure it&apos;s related to the compact process crash but my http client also received an error while polling _active_tasks for compaction to complete;&lt;br/&gt;
&lt;br/&gt;
Waiting for compaction to complete.&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; org.apache.http.conn.HttpHostConnectException: Connection to &lt;a href=&quot;http://machine_name:5984&quot;&gt;http://machine_name:5984&lt;/a&gt; refused&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>debian 5.0, amd64, couchdb from git.apache.org at dd15c8ed5bf5873aec08a99a0687849f1d29f4c3</environment>
            <key id="12444673">COUCHDB-613</key>
        <summary>Compaction tasks crash</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Tue, 5 Jan 2010 07:59:58 +0000 (UTC)</created>
    <updated>Tue, 5 Jan 2010 15:20:17 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12796691" author="kocolosk" created="Tue, 5 Jan 2010 15:13:38 +0000 (UTC)"  >Hi Bob, I think we&apos;ll need a bit more to figure out exactly what crashed here.  Is it just _active_tasks that&apos;s inaccessible when this happens, or did the whole couch_httpd process shut down?  Even if the couch_task_status server died (which would cause the noproc errors when you query _active_tasks), that by itself should not kill the compactor process, since it only uses fire-n-forget gen_server:cast calls to update its task status.</comment>
                    <comment id="12796697" author="rnewson" created="Tue, 5 Jan 2010 15:19:38 +0000 (UTC)"  >Hi,&lt;br/&gt;
&lt;br/&gt;
Sorry, I don&apos;t currently have any more information than this. I wanted to report it while I still had what little information I had on screen. CouchDB is responsive after this event without restarting it but since this happens in my automated overnight tests I can&apos;t say how immediately it recovers.&lt;br/&gt;
&lt;br/&gt;
All I know is that I was left with an incomplete .compact file for every single database (a dozen or so) on each of the three servers I tested this on and no active tasks on any of them. I figured that was pretty extraordinary. I agree that it&apos;s not likely that the client issuing the _compact calls or the one calling _active_tasks is the cause of the crash.&lt;br/&gt;
&lt;br/&gt;
Sorry I don&apos;t have more information at this time, I&apos;ll be on IRC after I conduct an interview today and perhaps we can chat about this?</comment>
                    <comment id="12796699" author="rnewson" created="Tue, 5 Jan 2010 15:20:17 +0000 (UTC)"  >My bad, it was just one of the three boxes that was left in this state. The other two completed fine. They&apos;re identical hardware, OS, and couchdb build and configuration.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 5 Jan 2010 15:13:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-612] Add Bulk Deletion to jquery.couch.js</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-612</link>

                    <description>Add a method for bulk deleting documents.&lt;br/&gt;
&lt;br/&gt;
It&apos;s already done here, though not tested: &lt;br/&gt;
see &lt;a href=&quot;http://lenaherrmann.net/2009/12/22/bulk-deletion-of-documents-in-couchdb&quot;&gt;http://lenaherrmann.net/2009/12/22/bulk-deletion-of-documents-in-couchdb&lt;/a&gt;&lt;br/&gt;
and &lt;a href=&quot;http://github.com/lenalena/couchdb/blob/trunk/share/www/script/jquery.couch.js&quot;&gt;http://github.com/lenalena/couchdb/blob/trunk/share/www/script/jquery.couch.js&lt;/a&gt; - line 241&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12444584">COUCHDB-612</key>
        <summary>Add Bulk Deletion to jquery.couch.js</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kilaulena">Lena Herrmann</reporter>
            
    <created>Mon, 4 Jan 2010 13:22:29 +0000 (UTC)</created>
    <updated>Mon, 4 Jan 2010 13:34:15 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
            <attachment id="12429340" name="bulk-deletion.patch" size="955" author="kilaulena" created="Mon, 4 Jan 2010 13:34:15 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-611] Double-escaping of ampersands when editing in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-611</link>

                    <description>To reproduce, create a new document in Futon and add a test field with the value [&amp;quot;&amp;amp;&amp;quot;]. Click the green tick button to apply and then edit the value again, and now it will show [&amp;quot;&amp;amp;amp;&amp;quot;].</description>
                <environment>Safari 4.0.4 or Firefox 3.6b5</environment>
            <key id="12444518">COUCHDB-611</key>
        <summary>Double-escaping of ampersands when editing in Futon</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Sat, 2 Jan 2010 23:51:25 +0000 (UTC)</created>
    <updated>Sat, 2 Jan 2010 23:51:25 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-610] [PATCH]: View Cleanup Button</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-610</link>

                    <description>This patch adds a button to the database view that allows the user to run view cleanup.  This feature is important to me since I often modify views on a reporting server and like the ability to easily reclaim disk space.</description>
                <environment>Debian 5.0 (Lenny)</environment>
            <key id="12444489">COUCHDB-610</key>
        <summary>[PATCH]: View Cleanup Button</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="icheishvili">Ilia Cheishvili</reporter>
            
    <created>Fri, 1 Jan 2010 23:21:47 +0000 (UTC)</created>
    <updated>Sat, 2 Jan 2010 19:04:24 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="0">0h</timeoriginalestimate>        <timeestimate seconds="0">0h</timeestimate>                    

            <comments>
                    <comment id="12795802" author="icheishvili" created="Fri, 1 Jan 2010 23:22:29 +0000 (UTC)"  >The actual patch.</comment>
                    <comment id="12795899" author="jchris" created="Sat, 2 Jan 2010 19:04:24 +0000 (UTC)"  >applied in r895262&lt;br/&gt;
&lt;br/&gt;
thanks</comment>
                </comments>
    
    <attachments>
            <attachment id="12429263" name="diff" size="4821" author="icheishvili" created="Fri, 1 Jan 2010 23:22:29 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 2 Jan 2010 19:04:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 2 Jan 2010 19:04:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-609] Don&apos;t re-index design document when existing views are unchanged</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-609</link>

                    <description>When I delete a single view from the ddoc but the others are unchanged, it shouldn&apos;t re-index.</description>
                <environment></environment>
            <key id="12444428">COUCHDB-609</key>
        <summary>Don&apos;t re-index design document when existing views are unchanged</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Thu, 31 Dec 2009 13:15:38 +0000 (UTC)</created>
    <updated>Thu, 31 Dec 2009 17:54:46 +0000 (UTC)</updated>

                        <version>0.10.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12795627" author="jchris" created="Thu, 31 Dec 2009 17:54:46 +0000 (UTC)"  >Sorry, but in order to make this change we&apos;d have to completely rewrite the view indexer to be less efficient.&lt;br/&gt;
&lt;br/&gt;
We batch updates to view indexes so that all the views in a ddoc are indexed together. This makes indexing many times faster as well as shrinking file sizes by a lot.&lt;br/&gt;
&lt;br/&gt;
If you need this behavior you can keep views in separate ddocs. Beware that this will increase disk and CPU usage.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 31 Dec 2009 17:54:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 31 Dec 2009 17:54:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-608] 404 on missing view *before* trying to re-index the ddoc</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-608</link>

                    <description>Apparently a 404 error (&apos;not_found&apos;, &apos;missing_named_view&apos;) will currently only be thrown after indexing of the design doc has been completed. It would be nice if it could check if the view exists first. Fail fast!</description>
                <environment></environment>
            <key id="12444427">COUCHDB-608</key>
        <summary>404 on missing view *before* trying to re-index the ddoc</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Thu, 31 Dec 2009 13:05:26 +0000 (UTC)</created>
    <updated>Thu, 31 Dec 2009 13:05:26 +0000 (UTC)</updated>

                        <version>0.10.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-607] Wiki: &quot;How_to_replicate_a_database&quot;  Startup command wrong</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-607</link>

                    <description>The command listed to start up the databases is listed:&lt;br/&gt;
; Start using:&lt;br/&gt;
;   couchdb -c /usr/local/etc/couchdb/default.ini -c local1.ini&lt;br/&gt;
&lt;br/&gt;
It should be: &lt;br/&gt;
; Start using:&lt;br/&gt;
;   couchdb -a /usr/local/etc/couchdb/default.ini -a local1.ini&lt;br/&gt;
&lt;br/&gt;
Seems minor, but it can be a show stopper! I could fix this if I had rights to the Wiki</description>
                <environment>Ubuntu Karmic</environment>
            <key id="12444413">COUCHDB-607</key>
        <summary>Wiki: &quot;How_to_replicate_a_database&quot;  Startup command wrong</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="steveolyo">Steven Olson</reporter>
            
    <created>Thu, 31 Dec 2009 03:53:37 +0000 (UTC)</created>
    <updated>Thu, 31 Dec 2009 04:34:10 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="900">0.25h</timeoriginalestimate>        <timeestimate seconds="900">0.25h</timeestimate>                    

            <comments>
                    <comment id="12795533" author="steveolyo" created="Thu, 31 Dec 2009 04:34:10 +0000 (UTC)"  >I didn&apos;t realize that I could make the change to the wiki myself. </comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 31 Dec 2009 04:34:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-606] specifying a [Update_Notification] block in local.ini causes crashes (looping)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-606</link>

                    <description>When the [Update_Notification] block in the INI file is commeted out, everything works.&lt;br/&gt;
&lt;br/&gt;
As soon as something is specified. e.g. db_update=/usr/local/etc/couchdb/dummy couchdb spits out hundreds of crash dumps:&lt;br/&gt;
&lt;br/&gt;
[Tue, 22 Dec 2009 20:32:53 GMT] [info] [&amp;lt;0.1.0&amp;gt;] Apache CouchDB has started on &lt;a href=&quot;http://0.0.0.0:5984/&quot;&gt;http://0.0.0.0:5984/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
[Tue, 22 Dec 2009 20:32:53 GMT] [error] [&amp;lt;0.55.0&amp;gt;] OS Process died with status: 0&lt;br/&gt;
&lt;br/&gt;
[Tue, 22 Dec 2009 20:32:53 GMT] [error] [&amp;lt;0.55.0&amp;gt;] ** Generic server &amp;lt;0.55.0&amp;gt; terminating &lt;br/&gt;
** Last message in was {#Port&amp;lt;0.1157&amp;gt;,{exit_status,0}}&lt;br/&gt;
** When Server state == {os_proc,&amp;quot;/usr/local/etc/couchdb/dummy&amp;quot;,#Port&amp;lt;0.1157&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_os_process.0.4707866&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_os_process.1.68874858&amp;gt;,5000}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {exit_status,0}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Tue, 22 Dec 2009 20:32:53 GMT] [error] [&amp;lt;0.55.0&amp;gt;] {error_report,&amp;lt;0.21.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.55.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.55.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,{exit,{exit_status,0},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{couch_os_process,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_db_update,couch_primary_services,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.49.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,377},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,273}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 22 Dec 2009 20:32:53 GMT] [error] [&amp;lt;0.49.0&amp;gt;] Update notification process &amp;lt;0.55.0&amp;gt; died: {exit_status,0}&lt;br/&gt;
&lt;br/&gt;
[Tue, 22 Dec 2009 20:32:53 GMT] [error] [&amp;lt;0.53.0&amp;gt;] {error_report,&amp;lt;0.21.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.53.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_db_update_notifier_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,normal},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.54.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;db_update&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_update_notifier,start_link,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;/usr/local/etc/couchdb/dummy&amp;quot;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}</description>
                <environment>Centos5.4, Erlang R13 (otp_src_R13B03.tar.gz), All other dependencies installed via YUM</environment>
            <key id="12444042">COUCHDB-606</key>
        <summary>specifying a [Update_Notification] block in local.ini causes crashes (looping)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ollieeillo">Ollie</reporter>
            
    <created>Tue, 22 Dec 2009 20:50:29 +0000 (UTC)</created>
    <updated>Tue, 22 Dec 2009 21:43:46 +0000 (UTC)</updated>

                        <version>0.10.1</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="1209600">336h</timeoriginalestimate>        <timeestimate seconds="1209600">336h</timeestimate>                    

            <comments>
                    <comment id="12793783" author="ollieeillo" created="Tue, 22 Dec 2009 20:56:33 +0000 (UTC)"  >I should say that I had a go at applying patch mentioned in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-206&quot; title=&quot;exiting update_notification process crashes view_manager&quot;&gt;&lt;strike&gt;COUCHDB-206&lt;/strike&gt;&lt;/a&gt; (patch -p1 &amp;lt; update_notification.diff), then runing make and make install again, for couchdb. This does not help in my case. Same problem.&lt;br/&gt;
&lt;br/&gt;
patching file src/couchdb/couch_db_update_notifier.erl&lt;br/&gt;
Hunk #1 FAILED at 63.&lt;br/&gt;
1 out of 1 hunk FAILED -- saving rejects to file src/couchdb/couch_db_update_notifier.erl.rej&lt;br/&gt;
patching file src/couchdb/couch_os_process.erl&lt;br/&gt;
Reversed (or previously applied) patch detected!  Assume -R? [n]</comment>
                    <comment id="12793788" author="rnewson" created="Tue, 22 Dec 2009 21:03:36 +0000 (UTC)"  >An update_notification process is supposed to loop while reading stdin (that is, not exit). I&apos;m guessing that your function exits immediately, which couchdb reports as a crash, then relaunches your process, which exists (crashes), ad infinitum.&lt;br/&gt;
&lt;br/&gt;
I think there was a patch to behave better if a script exists with a return code of 0 (to allow the script to be upgraded, say), but I don&apos;t think it&apos;s a bug that a broken update_notification script causes crash reports.</comment>
                    <comment id="12793801" author="ollieeillo" created="Tue, 22 Dec 2009 21:43:45 +0000 (UTC)"  >Thanks for the pointer, it&apos;s working now. I agree it&apos;s not really a bug. Some articles I had read lead me to believe that couchdb ran the script as a one-off every time a modification was made. Perhaps this was the case in previous versions. Good point on the upgrade path.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 22 Dec 2009 21:03:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-605] _update handler doesn&apos;t conflict for existing document</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-605</link>

                    <description>design doc:&lt;br/&gt;
&amp;quot;updates&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;hello&amp;quot;: &amp;quot;function(doc, req) { doc.value = 100500; return [doc, &apos;foo bar&apos;]; }&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT --data-binary @- &lt;a href=&quot;http://localhost:5984/shkaf/client:foo&quot;&gt;http://localhost:5984/shkaf/client:foo&lt;/a&gt; &amp;lt;&amp;lt; EOF&lt;br/&gt;
&amp;gt; {&amp;quot;_id&amp;quot;:&amp;quot;client:foo&amp;quot;}&lt;br/&gt;
&amp;gt; EOF&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;client:foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
$ curl -X PUT --data-binary @- &lt;a href=&quot;http://localhost:5984/shkaf/_design/client/_update/hello/client:foo?A=B&quot;&gt;http://localhost:5984/shkaf/_design/client/_update/hello/client:foo?A=B&lt;/a&gt; &amp;lt;&amp;lt; EOF&lt;br/&gt;
&amp;gt; {&amp;quot;_id&amp;quot;: &amp;quot;client:foo&amp;quot;}&lt;br/&gt;
&amp;gt; EOF&lt;br/&gt;
foo bar&lt;br/&gt;
&lt;br/&gt;
And it really updated the document.&lt;br/&gt;
&lt;br/&gt;
What i expected here is error: conflict because document with such _id already existed and i didn&apos;t provide _rev to _update handler.</description>
                <environment>Ubuntu Karmic, in particular it&apos;s CouchDB version 0.10.0-0ubuntu3</environment>
            <key id="12444009">COUCHDB-605</key>
        <summary>_update handler doesn&apos;t conflict for existing document</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="temoto">Sergey Shepelev</reporter>
            
    <created>Tue, 22 Dec 2009 13:15:46 +0000 (UTC)</created>
    <updated>Wed, 23 Dec 2009 15:15:49 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-604] _changes feed with ?feed=continuous does not return valid JSON</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-604</link>

                    <description>When using the _changes interface via ?feed=continuous the JSON returned is rather &lt;br/&gt;
&lt;br/&gt;
a stream of JSON documents than a valid JSON file itself:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;seq&amp;quot;:38,&amp;quot;id&amp;quot;:&amp;quot;f473fe61a8a53778d91c38b23ed6e20f&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;9-d3e71c7f5f991b26fe014d884a27087f&amp;quot;}]}&lt;br/&gt;
{&amp;quot;seq&amp;quot;:68,&amp;quot;id&amp;quot;:&amp;quot;2a574814d61d9ec8a0ebbf43fa03d75b&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;6-67179f215e42d63092dc6b2199a3bf51&amp;quot;}],&amp;quot;deleted&amp;quot;:true}&lt;br/&gt;
{&amp;quot;seq&amp;quot;:70,&amp;quot;id&amp;quot;:&amp;quot;75dbdacca8e475f5909e3cc298905ef8&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-0dee261a2bd4c7fb7f2abd811974d3f8&amp;quot;}]}&lt;br/&gt;
{&amp;quot;seq&amp;quot;:71,&amp;quot;id&amp;quot;:&amp;quot;09fb03236f80ea0680a3909c2d788e43&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-a9646389608c13a5c26f4c14c6863753&amp;quot;}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
to be valid there needs to be a root element (and then an array with commata) like in the non-continuous feed:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;results&amp;quot;:[&lt;br/&gt;
{&amp;quot;seq&amp;quot;:38,&amp;quot;id&amp;quot;:&amp;quot;f473fe61a8a53778d91c38b23ed6e20f&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;9-d3e71c7f5f991b26fe014d884a27087f&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:68,&amp;quot;id&amp;quot;:&amp;quot;2a574814d61d9ec8a0ebbf43fa03d75b&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;6-67179f215e42d63092dc6b2199a3bf51&amp;quot;}],&amp;quot;deleted&amp;quot;:true},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:70,&amp;quot;id&amp;quot;:&amp;quot;75dbdacca8e475f5909e3cc298905ef8&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-0dee261a2bd4c7fb7f2abd811974d3f8&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:71,&amp;quot;id&amp;quot;:&amp;quot;09fb03236f80ea0680a3909c2d788e43&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-a9646389608c13a5c26f4c14c6863753&amp;quot;}]},&lt;br/&gt;
&lt;br/&gt;
in short this means that if someone does not parse the change events in an object like manner (e.g. waiting for a line-ending and then parsing the line), but using a SAX-like parser (throwing events of each new object, etc.) and expecting the response to be JSON (which it is not, because its not {x:[{},{},{}]} but {}{}{} which is not valid) there is an error thrown.&lt;br/&gt;
&lt;br/&gt;
I can see, that people doing this line by line might be okay with the above approach, but the response is not valid JSON and it would be nice if there were a flag to make the response valid JSON.</description>
                <environment></environment>
            <key id="12443904">COUCHDB-604</key>
        <summary>_changes feed with ?feed=continuous does not return valid JSON</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="joscha">Joscha Feth</reporter>
            
    <created>Mon, 21 Dec 2009 09:48:30 +0000 (UTC)</created>
    <updated>Fri, 29 Jan 2010 11:49:02 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12793140" author="benoitc" created="Mon, 21 Dec 2009 10:09:50 +0000 (UTC)"  >I&apos;m not sure to follow, each line is a valid json. Purpose of continuous feed is to get changes line by line, so where is the problem?</comment>
                    <comment id="12793146" author="joscha" created="Mon, 21 Dec 2009 10:24:01 +0000 (UTC)"  >Exactly. Each line is valid JSON, but the response itself is not valid JSON.&lt;br/&gt;
&lt;br/&gt;
Now to read the response line by line, a method is needed which reads (from the never ending feed) until a newline comes and then parses the JSON object. Now to do this, the reading method needs to block (as it does not know whether the next character is a new line or not). Now if you take JSON as a structured format, it is much more easy and suitable (because there is no additional information about newlines, etc. needed) if such a feed is read in a SAX-like manner, which throws events whenever there are new elements within the feed:&lt;br/&gt;
&lt;br/&gt;
Starting seq&lt;br/&gt;
Starting id&lt;br/&gt;
Starting changes&lt;br/&gt;
Starting rev&lt;br/&gt;
Closing rev&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
but such a parser needs the document (or better the stream) to be valid JSON, which the current ouptut of the cont. feed is not.</comment>
                    <comment id="12793177" author="rnewson" created="Mon, 21 Dec 2009 12:35:08 +0000 (UTC)"  >&lt;br/&gt;
The feed format used to be as you wish it, and still is for non-continuous mode. Consider the uses of continuous mode, though, and this makes sense. Continuous mode is for continuous replication and for external indexers (e.g, couchdb-lucene but also many others). If the response is a single JSON object, then those users would have to wait for the end of the response before they can parse the result, and there is no end to a continuous feed in general.&lt;br/&gt;
&lt;br/&gt;
If there exists a SAX-style json parser, then that might be another approach, but I&apos;m not aware of one.&lt;br/&gt;
&lt;br/&gt;
This programming model seems so trivial that even if one did exist, I can&apos;t imagine it would be easier;&lt;br/&gt;
&lt;br/&gt;
while (read(line) != EOF) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;change=parse(line);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;apply(change);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12793179" author="rnewson" created="Mon, 21 Dec 2009 12:35:53 +0000 (UTC)"  >Also, since the continuous format is deliberately not &amp;quot;valid JSON&amp;quot; in the manner described, this is not a bug but a feature request.</comment>
                    <comment id="12793180" author="benoitc" created="Mon, 21 Dec 2009 12:40:32 +0000 (UTC)"  >You want to use feed=longpoll if you want a full json response. For continuous mode, on application side yiou just need to wait data recv on the socket. Some example in python here :&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://bitbucket.org/benoitc/couchdbkit/src/tip/couchdbkit/consumer.py&quot;&gt;http://bitbucket.org/benoitc/couchdbkit/src/tip/couchdbkit/consumer.py&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
As you see this is just a select on the socket waiting its state change (ie get data). You could do the same for any language. Then any line you get is a perfect valid json.</comment>
                    <comment id="12793182" author="joscha" created="Mon, 21 Dec 2009 12:48:57 +0000 (UTC)"  >The programming paradigm you propose (while(read(line)) has a blocking problem, e.g. the read call never returns if there is no new data on the stream.&lt;br/&gt;
Think of the following scenario:&lt;br/&gt;
&lt;br/&gt;
You have a _changes feed with a filter applied which lets changes from specific documents pass, e.g.&lt;br/&gt;
&lt;br/&gt;
_changes?feed=continuous&amp;amp;listenOnly=f473fe61a8a53778d91c38b23ed6e20f&lt;br/&gt;
&lt;br/&gt;
now what if your application is interested in different IDs over the time&lt;br/&gt;
&lt;br/&gt;
_changes?feed=continuous&amp;amp;listenOnly=abc,xyz&lt;br/&gt;
&lt;br/&gt;
The answer is: you can&apos;t change the source while still reading on it (as the first option to cleanly exit the while loop is returning/breaking within its body).&lt;br/&gt;
Now to solve this problem in Java for example you can use java.nio which allows you to have a selector on the socket which will return once there is data to read available.</comment>
                    <comment id="12793184" author="rnewson" created="Mon, 21 Dec 2009 12:54:04 +0000 (UTC)"  >I use _changes?heartbeat=5000&amp;amp;feed=continuous, so I get a response at least every 5 seconds, even if no documents change.&lt;br/&gt;
&lt;br/&gt;
See &lt;a href=&quot;http://github.com/rnewson/couchdb-lucene/blob/master/src/main/java/com/github/rnewson/couchdb/lucene/ViewIndexer.java&quot;&gt;http://github.com/rnewson/couchdb-lucene/blob/master/src/main/java/com/github/rnewson/couchdb/lucene/ViewIndexer.java&lt;/a&gt; handleResponse() method for a working code example.&lt;br/&gt;
</comment>
                    <comment id="12793186" author="benoitc" created="Mon, 21 Dec 2009 12:54:33 +0000 (UTC)"  >2 solutions :&lt;br/&gt;
&lt;br/&gt;
1) Use select on the socket which return the answer which is what I do for consumer, and just stop listening on this socket when you don&apos;t need it anymore &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
2) or wait for each line and make a a new request each time an answer is coming which is basically longpolling.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12793187" author="rnewson" created="Mon, 21 Dec 2009 12:55:06 +0000 (UTC)"  >Again, though, the typical use of _changes is to keep some other system up to date with all changes (another database for replication, a full-text index for couchdb-lucene, etc).</comment>
                    <comment id="12793189" author="joscha" created="Mon, 21 Dec 2009 12:58:50 +0000 (UTC)"  >Regarding the&lt;br/&gt;
&lt;br/&gt;
&amp;quot;If there exists a SAX-style json parser, then that might be another approach, but I&apos;m not aware of one.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
just that it does not exist &amp;quot;in the wild&amp;quot; it does not neccessarily mean there isn&apos;t one - we have a JSON Push Parser which can be compared to a SAX-like parser - it does not get a reader, but uses a writer - and once data is written on that writer, the parser will do it&apos;s work (and emit the above named events).&lt;br/&gt;
This Push Parser has now an extension to handle continous writes of distinct JSON objects ({}{}{}...) like the _changes feed delivers in continuous mode, but it might be different with a different parser out there, which expects the feed to return valid JSON data.&lt;br/&gt;
That there is no end does not mean, that there might not be a parser which can not work with the data.&lt;br/&gt;
&lt;br/&gt;
Start Document&lt;br/&gt;
Starting seq&lt;br/&gt;
Starting id&lt;br/&gt;
Starting changes&lt;br/&gt;
Starting rev&lt;br/&gt;
Closing rev&lt;br/&gt;
...&lt;br/&gt;
... &amp;lt;-- lots of changes &lt;br/&gt;
...&lt;br/&gt;
long time later&lt;br/&gt;
End Document &amp;lt;-- timeout of _changes feed happens here &lt;br/&gt;
&lt;br/&gt;
By the way, XMPP works the same - it basically has an infinitely long stream of XML elements flowing - but still starts with a root node and ends with a closing one to be valid XML.&lt;br/&gt;
&lt;br/&gt;
You might call it a feature request, but I think either the output should be valid JSON or not. If you tell me the output is not valid JSON, okay, but I couldn&apos;t read this from the docs, as all other _changes interfaces return valid JSON.</comment>
                    <comment id="12793190" author="joscha" created="Mon, 21 Dec 2009 13:00:18 +0000 (UTC)"  >Using &amp;amp;heartbeat=1000 was also my first approach, but it just is not as performant to send a newline every 1000ms just to keep a while loop running.</comment>
                    <comment id="12793191" author="benoitc" created="Mon, 21 Dec 2009 13:06:32 +0000 (UTC)"  >Obviously you can&apos;t have a valid json response on a continuous feed if you don&apos;t read line by line.  Again what you want is using longpolling which send a valid response: wait until there is a change, close connection. &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
For long timeout you can use heartbeat=true, when send an empty line regurlaly (default timeout). You can also use timeout option instead of heartbeat.</comment>
                    <comment id="12793196" author="joscha" created="Mon, 21 Dec 2009 13:19:17 +0000 (UTC)"  >Thats exactly what I am talking about: the response is not valid JSON.&lt;br/&gt;
&lt;br/&gt;
It is: &lt;br/&gt;
&lt;br/&gt;
{}&lt;br/&gt;
{}&lt;br/&gt;
{}&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
(not valid JSON)&lt;br/&gt;
where it should be&lt;br/&gt;
&lt;br/&gt;
{root:[&lt;br/&gt;
{},&lt;br/&gt;
{},&lt;br/&gt;
{},&lt;br/&gt;
...&lt;br/&gt;
]} &amp;lt;-- timeout happens here&lt;br/&gt;
&lt;br/&gt;
(valid JSON)&lt;br/&gt;
&lt;br/&gt;
And I don&apos;t want to use longpolling, as this means I need to reconnect after every change.&lt;br/&gt;
What I want to use is ?feed=continuous (so I can track multiple changes with one HTTP request) with &amp;amp;timeout=X (and NOT heartbeat=Y, which would just waste bandwidth) AND a valid JSON response which is parseable.&lt;br/&gt;
&lt;br/&gt;
So if you think parsing line by line is okay, thats fine, but for a SAX-based parser a newline outside an element is just white space - let me change this into a feature request for an additional REST parameter on the _changes interface - let&apos;s say&lt;br/&gt;
&amp;amp;encapsulated=true|false&lt;br/&gt;
which is false by default and if true wraps the response into a &lt;br/&gt;
&lt;br/&gt;
{&amp;quot;results&amp;quot;:[&lt;br/&gt;
...&lt;br/&gt;
],&amp;quot;last_seq&amp;quot;:0}}&lt;br/&gt;
&lt;br/&gt;
and delimits the different changes elements by comma.</comment>
                    <comment id="12793198" author="benoitc" created="Mon, 21 Dec 2009 13:28:29 +0000 (UTC)"  >if you listen the changes why not making a valid json while you listening ie : save line, add comma, continue .  &lt;br/&gt;
&lt;br/&gt;
I prefer to have a valid json line by line rather than having to remove ending coma each time i want to use this line. </comment>
                    <comment id="12793200" author="joscha" created="Mon, 21 Dec 2009 13:37:29 +0000 (UTC)"  >I am not reading in lines, I am reading whatever gets returned into the buffer and then writing it to the Push Parser, and yes, indeed, my first fix for this was writing a {&amp;quot;results&amp;quot;:[ on the Parser and the transforming every \n into a comma. But it just does not seem right - CouchDB should return (or at least should be able to return) a valid JSON document itself.&lt;br/&gt;
Anyways I am noticing you are not with me here and it seems odd that I need to argue about adding a flag to make a return valid which is currently coming back invalid.&lt;br/&gt;
We have written enough, so I am sure someone having the same issues will find this conversation and may reopen this defect. Then he or she can try convincng you again.</comment>
                    <comment id="12793202" author="candlerb" created="Mon, 21 Dec 2009 13:43:38 +0000 (UTC)"  >&amp;gt; By the way, XMPP works the same - it basically has an infinitely long stream of XML elements&lt;br/&gt;
&amp;gt; flowing - but still starts with a root node and ends with a closing one to be valid XML. &lt;br/&gt;
&lt;br/&gt;
Stream parsing is much more common in the XML world; unfortunately JSON stream parsers are not (yet?) widespread.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; You might call it a feature request, but I think either the output should be valid JSON or not.&lt;br/&gt;
&amp;gt; If you tell me the output is not valid JSON, okay, but I couldn&apos;t read this from the docs, as all&lt;br/&gt;
&amp;gt; other _changes interfaces return valid JSON.&lt;br/&gt;
&lt;br/&gt;
It&apos;s not valid JSON, and I would agree it&apos;s a bug if you&apos;re referring to the Content-Type header which is returned:&lt;br/&gt;
&lt;br/&gt;
$ curl -v -H &amp;quot;Accept: application/json&amp;quot; &lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_changes?feed=continuous&quot;&gt;http://127.0.0.1:5984/test_suite_db/_changes?feed=continuous&lt;/a&gt;&lt;br/&gt;
...&lt;br/&gt;
&amp;lt; HTTP/1.1 200 OK&lt;br/&gt;
&amp;lt; Transfer-Encoding: chunked&lt;br/&gt;
&amp;lt; Server: CouchDB/0.11.0a813819 (Erlang OTP/R12B)&lt;br/&gt;
&amp;lt; Date: Mon, 21 Dec 2009 13:35:52 GMT&lt;br/&gt;
&amp;lt; Content-Type: application/json&lt;br/&gt;
&amp;lt; Cache-Control: must-revalidate&lt;br/&gt;
&amp;lt; &lt;br/&gt;
&lt;br/&gt;
I would also agree that it&apos;s inconsistent with the way a view is returned. Views are complete JSON docs, but have newlines in magic places to make it possible to parse them line-at-a-time.&lt;br/&gt;
&lt;br/&gt;
$ curl -H &amp;quot;Accept: application/json&amp;quot; &lt;a href=&quot;http://127.0.0.1:5984/test_suite_db_a/_all_docs&quot;&gt;http://127.0.0.1:5984/test_suite_db_a/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:5,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;6d85c1ca41bd9eb4435b2fcac3670b84&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;6d85c1ca41bd9eb4435b2fcac3670b84&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-d4388236888cf366f37777e888221968&amp;quot;}},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;927c96f86e2fdebbcae3520ac2054fbd&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;927c96f86e2fdebbcae3520ac2054fbd&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-d4388236888cf366f37777e888221968&amp;quot;}},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;bar&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;bar&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;6-7c014f6deb5cd9935625a8f411f8db08&amp;quot;}},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;c134ca85221694a28f9ad8953b3087a7&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;c134ca85221694a28f9ad8953b3087a7&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-d4388236888cf366f37777e888221968&amp;quot;}},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;21-b94c260d79b638231eb14b3de8458c2f&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
It would have been possible for feed=continuous to work this way too.&lt;br/&gt;
&lt;br/&gt;
In that case I&apos;d have thought the comma should appear at the *start* of each line (apart from the first, obviously), otherwise you need a dummy record at the end to close the stream cleanly. And if you want the heartbeat feature you&apos;ll still need a dummy record.&lt;br/&gt;
</comment>
                    <comment id="12793203" author="candlerb" created="Mon, 21 Dec 2009 13:49:56 +0000 (UTC)"  >&amp;gt; if you want the heartbeat feature you&apos;ll still need a dummy record. &lt;br/&gt;
&lt;br/&gt;
A simple newline would still be fine as a heartbeat for &apos;gets&apos; readers of course. What I meant was, if you are using a stream parser you probably won&apos;t get an event for just reading a newline, so heartbeat would have to send some real content to be useful in that case.&lt;br/&gt;
</comment>
                    <comment id="12793205" author="joscha" created="Mon, 21 Dec 2009 13:53:52 +0000 (UTC)"  >I don&apos;t need the heartbeat feature, as I use a non-blocking method to read the stream - what I want is simply an option to make CouchDB return valid JSON on the _changes continuous feed ;-)&lt;br/&gt;
I agree with the commata by the way - they definitely need to be at the beginning of the next element.</comment>
                    <comment id="12793219" author="rnewson" created="Mon, 21 Dec 2009 14:47:44 +0000 (UTC)"  >continuous mode used to return valid JSON, and clients were expected to clip out valid lines (using the newline hints) if they wanted to parse each change as it happened. It was deliberately changed to this behavior to allow clients to more easily handle _changes, since all consumers of _changes at that time needed to do the same logic.&lt;br/&gt;
&lt;br/&gt;
Changing it back will make it &amp;quot;correct&amp;quot; but harder to use (every consumer will have to add hackish logic to parse part of the response). Since the request format is predicated on &amp;quot;Sax-style json parsers&amp;quot; which apparently don&apos;t exist, it feels like purism for its own sake, practicality taking a step down.&lt;br/&gt;
&lt;br/&gt;
Perhaps it suffices to change the returned content-type to multipart/related where each part is a valid JSON response?&lt;br/&gt;
&lt;br/&gt;
That said, I would hope it suffices to document the returned format for continuous mode with the expectation that it will be the preferred format for developers that write external indexers (which is the reason it was changed to the current format in the first place).</comment>
                    <comment id="12793221" author="joscha" created="Mon, 21 Dec 2009 14:56:36 +0000 (UTC)"  >OK, look, just because you never saw a Yeti, this doesn&apos;t mean it does not exist ;-)&lt;br/&gt;
I have a SAX-Style JSON parser at my hands here, which is way more efficient than any of the Bean-based parsers out there - but thats really not the point here.&lt;br/&gt;
&lt;br/&gt;
I think if the response says it is JSON, it should obey to the standard, whether it is harder to use or not. This is not purism, but simply a well-defined interface. Everything else is just a dirty hack which noone should rely on.&lt;br/&gt;
A multipart-response might work, but might as well be an overkill for this, as I agree Benoit is right - most people will be fine using the line-by-line interface.&lt;br/&gt;
Documenting the deviation from the JSON format is a good start I think, but whats the reason for not just having a flag which makes the ouptut valid JSON?</comment>
                    <comment id="12793222" author="benoitc" created="Mon, 21 Dec 2009 14:57:20 +0000 (UTC)"  >What you describe is by the way the old behavior of _changes continuous feed. I agree that we fail on validation in timeout scenario (though it&apos;s easy to solve it on client side). The one problem with old behaviour  I see with it is the extra time you have when you really want continuous changes ie :&lt;br/&gt;
&lt;br/&gt;
1) test if lines start with {&apos;results&lt;br/&gt;
2) test if line is {}&lt;br/&gt;
3) remove the &amp;quot;,&amp;quot;&lt;br/&gt;
4) finally deserialize.&lt;br/&gt;
&lt;br/&gt;
Actually you just have to listen changes, get the line, handle it which is a way easier, faster. And you still can create a valid json parser at the end. We need to choose what is the best here, validation or fast handling.&lt;br/&gt;
</comment>
                    <comment id="12793225" author="joscha" created="Mon, 21 Dec 2009 15:03:42 +0000 (UTC)"  >I know I am the &amp;quot;outsider&amp;quot; here, but I disagree - having a clean and valid interface is as much important as speed. +1 Vote for the flag (as this is both speedy and valid used with a SAX style parser).</comment>
                    <comment id="12793227" author="benoitc" created="Mon, 21 Dec 2009 15:09:53 +0000 (UTC)"  >I just propose a choice. Will see what others will say ...&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;I still fail to see how a sax style parser and json could work together but that&apos;s another story. Anyway your response will never be valid if it timeout your parser will still need to complete the response. Maybe indeed sending a multipart response is more valid here.</comment>
                    <comment id="12793232" author="joscha" created="Mon, 21 Dec 2009 15:28:20 +0000 (UTC)"  >As for the SAX style parser:&lt;br/&gt;
&lt;br/&gt;
{ x: &amp;quot;abc&amp;quot;, y: &amp;quot;xyz&amp;quot; }&lt;br/&gt;
&lt;br/&gt;
would be:&lt;br/&gt;
&lt;br/&gt;
startDocument&lt;br/&gt;
startElement x&lt;br/&gt;
value abc&lt;br/&gt;
endElement&lt;br/&gt;
startElement y&lt;br/&gt;
value xyz&lt;br/&gt;
endElement&lt;br/&gt;
endDocument&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
If the client is closing the connection it will most likely close it, when all data needed is read --&amp;gt; valid state&lt;br/&gt;
When the timeout occurs, the server (CouchDB) will send the closing  ],&amp;quot;last_seq&amp;quot;:XYZ}, just like it does now --&amp;gt; valid state&lt;br/&gt;
</comment>
                    <comment id="12793235" author="benoitc" created="Mon, 21 Dec 2009 15:46:27 +0000 (UTC)"  >I see though timeout could occur on client side -&amp;gt; no valid response also valid state != valid json in case you close the connection. &lt;br/&gt;
&lt;br/&gt;
Anyway I understand your position. Not sure what need to be done yet though :)&lt;br/&gt;
</comment>
                    <comment id="12793237" author="paul.joseph.davis" created="Mon, 21 Dec 2009 15:50:43 +0000 (UTC)"  >I&apos;ve met the Yeti. His name is Yajl. He&apos;s quite friendly, but no one ever really mentions the SAX thing much. Cause no one ever really produces partial JSON documents. Cause there really aren&apos;t that many SAX parsers. Cause as it turns out, SAX is a huge friggin pain in the butt. Granted this &apos;push parser&apos; sounds more like a pull-dom parser. Either way, this discussion on commas is pretty weird for being about commas.&lt;br/&gt;
&lt;br/&gt;
The validity of that response with that content-type is debatable. AFAIK theres nothing in the specification that says you can&apos;t repeat values in a JSON stream. And there are parsers that allow for parsing multiple values. The XMPP &apos;infinite document&apos; is just a clever hack around a format that explicitly denies repeated documents.&lt;br/&gt;
&lt;br/&gt;
If someone wants commas in that stream, then they should feel free to write a patch. But comma&apos;s have nothing to do with non-blocking i/o or other such things.&lt;br/&gt;
&lt;br/&gt;
Cheerio!</comment>
                    <comment id="12793245" author="joscha" created="Mon, 21 Dec 2009 16:08:19 +0000 (UTC)"  >Haha, I didn&apos;t even know Yajl existed ;-) Glad you met the Yeti!&lt;br/&gt;
With the partial JSON documents: you are right, it&apos;s a rare case, but in general I would call such an endless changes feed a partial JSON document.&lt;br/&gt;
You are right about the (non-)blocking - I just wanted to make sure that you understand why I am not eager to search for newlines in the feed - for me it&apos;s not a standard response with single JSON documents per line, but one giant stream of JSON. I don&apos;t care whether there are any white spaces between elements - may it be newlines or something else.</comment>
                    <comment id="12793253" author="jchris" created="Mon, 21 Dec 2009 16:34:03 +0000 (UTC)"  >When we made the change away from commas I was a little concerned about validity. Now that you are bringing it up, I find myself thinking that a query option to provide valid JSON would be great.&lt;br/&gt;
&lt;br/&gt;
I think the general sentiment is that it would&apos;t hurt to give an option. The next step is for someone to write a patch for this. If the patch is clean I&apos;d have no objections to including it.</comment>
                    <comment id="12793257" author="damienkatz" created="Mon, 21 Dec 2009 16:44:53 +0000 (UTC)"  >Wow, lots of comments on this one.&lt;br/&gt;
&lt;br/&gt;
I originally implemented this as a single JSON stream, it was switched to newline separated json objects for ease parsing by clients. I don&apos;t have an opinion one way or the other, but the thing starts to bothers me is the culture offering more options so that everyone can have it exactly as they want it.&lt;br/&gt;
&lt;br/&gt;
The stems from the increasing &amp;quot;texture&amp;quot; of the API, and what must get documented and tested, and the burden of what must get implemented for those who want to make compatible CouchDB implementations. I tend to favor simpler APIs to the point of occasionally pushing some of the complexity to the client to ensure the server itself isn&apos;t completely overloaded with complexity and options.</comment>
                    <comment id="12793264" author="joscha" created="Mon, 21 Dec 2009 17:04:41 +0000 (UTC)"  >The more options, the more possible errors, yes - but making the client fixing the validity of the response still seems a little weird.&lt;br/&gt;
&lt;br/&gt;
A client which parses line-by-line can still strip the JSON header (which is always the first line and the same length btw.) and disregard any leading commas easily, because such a client interpretes each changes entry anyways - whereas a different parser working on the overall stream or a client which just wants all changes in the last X seconds and waits for the timeout has more problems making the response valid afterwards.&lt;br/&gt;
&lt;br/&gt;
But I agree it simplifies the process for some if it is readable line-by-line, so this might just be one of the cases where an option just is necessary (don&apos;t understand me wrong, I would also be fine if valid JSON output is the only default).</comment>
                    <comment id="12806314" author="djc" created="Fri, 29 Jan 2010 11:49:02 +0000 (UTC)"  >For me, the non-valid-JSON (e.g. object-per-line without exceptions) is fine (and probably more useful than the alternative), EXCEPT that the Content-Type: application/json seems wrong for that case. I think &amp;quot;Content-Type: application/json&amp;quot; should only be provided on content that may easily (trivially) be parsed by a conforming JSON parser, which is definitely not true for the current feed=continuous feed.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 21 Dec 2009 10:09:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-603] init script needlessly &apos;su&apos;s, and non-superuser use fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-603</link>

                    <description>The init script runs &apos;su&apos; if the COUCHDB_USER variable is set, but it doesn&apos;t need to if the script is already running as that user.  Add an additional condition on that test, so that normal role users can start and stop the server.&lt;br/&gt;
&lt;br/&gt;
--- couchdb/etc/init/couchdb.tpl.in	2009-10-02 07:10:18.475913699 -0400&lt;br/&gt;
+++ couchdb/etc/init/couchdb.tpl.in	2009-10-02 07:22:22.711911041 -0400&lt;br/&gt;
@@ -77,7 +77,7 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;command=&amp;quot;$command $COUCHDB_OPTIONS&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fi&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;mkdir -p &amp;quot;$RUN_DIR&amp;quot;&lt;br/&gt;
-    if test -n &amp;quot;$COUCHDB_USER&amp;quot;; then&lt;br/&gt;
+    if test -n &amp;quot;$COUCHDB_USER&amp;quot; -a &amp;quot;`id -u \&amp;quot;$COUCHDB_USER\&amp;quot; 2&amp;gt;&amp;amp;1`&amp;quot; != &amp;quot;`id -u`&amp;quot;; then&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;chown $COUCHDB_USER &amp;quot;$RUN_DIR&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if su $COUCHDB_USER -c &amp;quot;$command&amp;quot; &amp;gt; /dev/null; then&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return $SCRIPT_OK&lt;br/&gt;
&lt;br/&gt;
(Reported as bug at &lt;a href=&quot;https://bugs.launchpad.net/ubuntu/+source/couchdb/+bug/435484&quot;&gt;https://bugs.launchpad.net/ubuntu/+source/couchdb/+bug/435484&lt;/a&gt;  )</description>
                <environment>Unix</environment>
            <key id="12443781">COUCHDB-603</key>
        <summary>init script needlessly &apos;su&apos;s, and non-superuser use fails</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="cmiller">Chad MILLER</reporter>
            
    <created>Fri, 18 Dec 2009 17:08:16 +0000 (UTC)</created>
    <updated>Fri, 18 Dec 2009 17:08:16 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-602] Cannot use NFS for storage</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-602</link>

                    <description>Our hosting provider claims they cannot upgrade our CouchDB installation from version 0.9.1 to 0.10 as the test suite for 0.10 is failing.&lt;br/&gt;
&lt;br/&gt;
This is a translation from their report:&lt;br/&gt;
&lt;br/&gt;
----&lt;br/&gt;
CouchDB can&apos;t handle having its data directory on NFS.&lt;br/&gt;
&lt;br/&gt;
It seems CouchDB tries to do this:&lt;br/&gt;
1 mkdir test&lt;br/&gt;
2 start process X with fd under test/foo&lt;br/&gt;
3 do the work&lt;br/&gt;
4 rm test/foo&lt;br/&gt;
5 rmdir test&lt;br/&gt;
6 kill process X&lt;br/&gt;
&lt;br/&gt;
When test/ is on NFS:&lt;br/&gt;
In step 4 an open file is being removed. NFS doesn&apos;t really support this &lt;br/&gt;
and the workaround is that the client implementation does&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;mv file .nfsXXXXXXX&lt;br/&gt;
&lt;br/&gt;
However, the &apos;rmdir test&apos; in step 5 then cannot succeed anymore, since &lt;br/&gt;
the directory is not empty. This eventually causes CouchDB to crash.&lt;br/&gt;
&lt;br/&gt;
In earlier versions of CouchDB the open/rm/rmdir/kill order may have &lt;br/&gt;
been different, for instance open/rm/kill/rmdir.&lt;br/&gt;
----</description>
                <environment></environment>
            <key id="12443543">COUCHDB-602</key>
        <summary>Cannot use NFS for storage</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="breun">Nils Breunese</reporter>
            
    <created>Wed, 16 Dec 2009 15:50:13 +0000 (UTC)</created>
    <updated>Tue, 19 Jan 2010 11:59:58 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12791430" author="paul.joseph.davis" created="Wed, 16 Dec 2009 16:15:25 +0000 (UTC)"  >Can you get the error traceback? I&apos;m still intrigued as to what possibly changed between 0.9.1 and 0.10.0 that changed. I find it more likely that we just weren&apos;t testing something in 0.9.1</comment>
                    <comment id="12802213" author="breun" created="Tue, 19 Jan 2010 11:59:15 +0000 (UTC)"  >I got this message from the hosting company:&lt;br/&gt;
&lt;br/&gt;
----&lt;br/&gt;
when doing &amp;quot;Run All&amp;quot; in the test suite, the first test that fails is &amp;quot;compact&amp;quot; the error log is attached.&lt;br/&gt;
from time to time I can see quie a few .nfs files in the couchdb datastore directory:&lt;br/&gt;
find . | grep nfs&lt;br/&gt;
./.test_suite_db_design/.nfs00000000019000890039f45d&lt;br/&gt;
./.test_suite_db_design/.nfs00000000019000880039f45e&lt;br/&gt;
./.test_suite_db_design/.nfs000000000190008b0039f460&lt;br/&gt;
./.test_suite_db_design/.nfs000000000190008a0039f461&lt;br/&gt;
./.nfs00000000006800880039f45c&lt;br/&gt;
./.nfs000000000068008a0039f45f&lt;br/&gt;
----&lt;br/&gt;
&lt;br/&gt;
I&apos;ll attach the error log.</comment>
                    <comment id="12802214" author="breun" created="Tue, 19 Jan 2010 11:59:58 +0000 (UTC)"  >Compressed error log.</comment>
                </comments>
    
    <attachments>
            <attachment id="12430734" name="error.gz" size="20912" author="breun" created="Tue, 19 Jan 2010 11:59:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 16 Dec 2009 16:15:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-601] Ephemeral network hiccups cause punctuated existence for couch_task_status server.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-601</link>

                    <description>Errors causing couch_task_status to die because of probable network errors.&lt;br/&gt;
&lt;br/&gt;
davisp thinks it&apos;s because of couch_httpd.erl:163&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 16-Dec-2009::03:10:08 ===&lt;br/&gt;
{mochiweb_socket_server,235,{child_error,{case_clause,{error,enotconn}}}}&lt;br/&gt;
[error] [&amp;lt;0.17349.67&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.17349.67&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{mochiweb_socket_server,acceptor_loop,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.17349.67&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{case_clause,{error,enotconn}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request,get,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_httpd,couch_secondary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.3303.67&amp;gt;,#Port&amp;lt;0.1071837&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[{mochiweb_request_qs,[]},{jsonp,undefined}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,2584},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,76082}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
[error] [&amp;lt;0.3303.67&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.3303.67&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,235,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,{case_clause,{error,enotconn}}}}}}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Solaris 10u7, erlang-R13B01, apache-couchdb-0.10.x-r888268</environment>
            <key id="12443500">COUCHDB-601</key>
        <summary>Ephemeral network hiccups cause punctuated existence for couch_task_status server.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="slyphon">Jonathan Simms</reporter>
            
    <created>Wed, 16 Dec 2009 07:00:47 +0000 (UTC)</created>
    <updated>Wed, 16 Dec 2009 07:11:01 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12791240" author="paul.joseph.davis" created="Wed, 16 Dec 2009 07:11:01 +0000 (UTC)"  >Fairly certain this is caused by couch_httpd.erl line 163 when we try and get peer info only to find the peer has left us high and dry. I attempted to shift things into the try catch a couple lines down, but the object being instantiated that calls MochiReq:get(peer) is referenced in the catch clauses and I didn&apos;t feel like reformatting everything to nest in an outer try/catch.&lt;br/&gt;
&lt;br/&gt;
Seems to be the same problem causing task_status to die too. This is just the top of a really long traceback that I went through. Either way I think this deserves its own ticket even though it might be tickling the other bug as well.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 16 Dec 2009 07:11:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-600] _list does not accept POST when view is in separate design doc</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-600</link>

                    <description>When POSTing to a _list view where the view function is in a separate design doc, a 405 is returned despite claiming to accept POST requests. The attached patch and test seems to work for me.</description>
                <environment></environment>
            <key id="12443412">COUCHDB-600</key>
        <summary>_list does not accept POST when view is in separate design doc</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="strattg">Gordon Stratton</reporter>
            
    <created>Tue, 15 Dec 2009 16:39:32 +0000 (UTC)</created>
    <updated>Tue, 22 Dec 2009 22:58:57 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12790898" author="jchris" created="Tue, 15 Dec 2009 19:11:27 +0000 (UTC)"  >thanks for the patch and test. I&apos;ve added the test to my in-progress refactor of the query-server protocol, which I think will also solve this issue. If it doesn&apos;t solve it &amp;quot;organically&amp;quot; I&apos;ve added the test, so I&apos;ll make sure it passes before I merge the branch.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12793830" author="strattg" created="Tue, 22 Dec 2009 22:55:41 +0000 (UTC)"  >I figured I&apos;d follow up on this since the branch merge happened. I&apos;m still running a similar patch locally on trunk because I think the functionality for POST with keys for _list views where the view function is in a separate design document is still missing.</comment>
                    <comment id="12793832" author="strattg" created="Tue, 22 Dec 2009 22:58:57 +0000 (UTC)"  >I&apos;m an idiot. This is completely resolved, I was going off of the previous &amp;quot;merge&amp;quot;, not the one that happened today. Seriously, thanks for all your hard work.</comment>
                </comments>
    
    <attachments>
            <attachment id="12428054" name="multikey_post_view_list_different_ddocs.patch" size="2363" author="strattg" created="Tue, 15 Dec 2009 16:39:57 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Dec 2009 19:11:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-599] `head.total_rows` returns empty in a _list function</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-599</link>

                    <description>In a _list function defined like this:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;function (head, req) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return &apos;Total: &apos; + head.total_rows;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
the `head.total_rows` is undefined. &lt;br/&gt;
&lt;br/&gt;
I have created a test case for the issue in this patch (against Git repo at github.com/apache/couchdb):&lt;br/&gt;
&lt;br/&gt;
--&amp;gt; &lt;a href=&quot;http://gist.github.com/255972#file_couchdb_head_total_rows_in_list__fail.diff&quot;&gt;http://gist.github.com/255972#file_couchdb_head_total_rows_in_list__fail.diff&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
See the map/reduce and list function definition in the gist, also the full db dump is included.&lt;br/&gt;
&lt;br/&gt;
This fails for me on CouchDB 0.10.0 and 0.11.0b77473d79-git.&lt;br/&gt;
&lt;br/&gt;
There are tests for `head.total_rows` commented out in the test cases (list_views.js, see &lt;a href=&quot;http://github.com/apache/couchdb/blob/trunk/share/www/script/test/list_views.js#L65-68&quot;&gt;http://github.com/apache/couchdb/blob/trunk/share/www/script/test/list_views.js#L65-68&lt;/a&gt; and &lt;a href=&quot;http://github.com/apache/couchdb/blob/trunk/share/www/script/test/list_views.js#L265)&quot;&gt;http://github.com/apache/couchdb/blob/trunk/share/www/script/test/list_views.js#L265)&lt;/a&gt;&lt;br/&gt;
</description>
                <environment>Mac OS X 10.5.8, Mac Book Air, CouchDB 0.10.0 (mac ports) and trunk</environment>
            <key id="12443255">COUCHDB-599</key>
        <summary>`head.total_rows` returns empty in a _list function</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="karmi">Karel Mina&#345;&#237;k</reporter>
            
    <created>Mon, 14 Dec 2009 11:30:33 +0000 (UTC)</created>
    <updated>Thu, 17 Dec 2009 12:48:55 +0000 (UTC)</updated>

                        <version>0.10</version>
                    <version>0.11</version>
            
                
                        <component>Database Core</component>
                    <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12791906" author="karmi" created="Thu, 17 Dec 2009 12:48:44 +0000 (UTC)"  >This issue is INVALID: &lt;br/&gt;
&lt;br/&gt;
head.total_rows is available only for views without reduce() function OR when `?reduce=false` is specified. (#couchdb&amp;gt; rnewson: We don&apos;t know up-front how many rows will remain after a reduce.) &lt;br/&gt;
&lt;br/&gt;
The attached test fails because a list function needs to execute both send() AND return. &lt;br/&gt;
&lt;br/&gt;
(I think it would be helpful to un-comment the tests for `head.total_rows` in test suite (list_views.js), so it&apos;s transparent for other who may be hit by this.) &lt;br/&gt;
&lt;br/&gt;
Thanks to Robert Newson for helping me to figure and sort this out! </comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 17 Dec 2009 12:48:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-598] _show without docid returns 500 instead of 404</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-598</link>

                    <description>See also the thread on the mailing list::&lt;a href=&quot;http://www.mail-archive.com/user@couchdb.apache.org/msg05633.html&quot;&gt;http://www.mail-archive.com/user@couchdb.apache.org/msg05633.html&lt;/a&gt; and especially the following quote from Chris Anderson :&amp;quot; The change would be simple, just remove a catch clause on couch_httpd_show.erl line 81.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Original message below:&lt;br/&gt;
------&lt;br/&gt;
&lt;br/&gt;
According to&lt;br/&gt;
&lt;a href=&quot;http://books.couchdb.org/relax/design-documents/shows#Querying%20Show%&quot;&gt;http://books.couchdb.org/relax/design-documents/shows#Querying%20Show%&lt;/a&gt;&lt;br/&gt;
20Functions i should receive an HTTP 404 Not Found response, instead i&lt;br/&gt;
get a HTTP 500 Internal Server Error. I am unsure as of yet whether i am&lt;br/&gt;
doing something wrong or if i should file a bug report for this one.&lt;br/&gt;
&lt;br/&gt;
Here are my two documents in my test database named shows:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_id&amp;quot;: &amp;quot;_design/test&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_rev&amp;quot;: &amp;quot;1-21a6d69070ae4bec3e9f14fbb7f93201&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;shows&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;summary&amp;quot;: &amp;quot;function (doc, req) { return &lt;br/&gt;
&apos;&amp;lt;h1&amp;gt;&apos;+doc.title+&apos;&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;&apos;+doc.body+&apos;&amp;lt;/p&amp;gt;&apos;; } &amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
and&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_id&amp;quot;: &amp;quot;bd108c433aedaa1bd2def0ec85e59a0d&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_rev&amp;quot;: &amp;quot;3-5a031adf97aabe4888b9bfb94ba28d13&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;title&amp;quot;: &amp;quot;title&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;body&amp;quot;: &amp;quot;body text&amp;quot;&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I receive proper results using the following HTTP GET request&lt;br/&gt;
&lt;a href=&quot;http://zealand:5984/shows/_design/test/_show/summary/bd108c433aedaa1bd2def0ec85e59a0d&quot;&gt;http://zealand:5984/shows/_design/test/_show/summary/bd108c433aedaa1bd2def0ec85e59a0d&lt;/a&gt;&lt;br/&gt;
- code : 200&lt;br/&gt;
- body : &amp;lt;h1&amp;gt;title&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;body text&amp;lt;/p&amp;gt;&lt;br/&gt;
&lt;br/&gt;
Now consider querying the same show function with a non-existing&lt;br/&gt;
document id &lt;br/&gt;
&lt;a href=&quot;http://zealand:5984/shows/_design/test/_show/summary/404&quot;&gt;http://zealand:5984/shows/_design/test/_show/summary/404&lt;/a&gt;&lt;br/&gt;
- code 500&lt;br/&gt;
- body {&amp;quot;error&amp;quot;:&amp;quot;normal&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{gen_server,call,\n&lt;br/&gt;
[couch_query_servers,\n             {ret_proc,{proc,&amp;lt;0.1481.0&amp;gt;,&amp;lt;&amp;lt;&lt;br/&gt;
\&amp;quot;javascript\&amp;quot;&amp;gt;&amp;gt;,\n&lt;br/&gt;
{couch_os_process,prompt},\n&lt;br/&gt;
{couch_os_process,set_timeout},\n&lt;br/&gt;
{couch_os_process,stop}}}]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Here is the output in the couch.log file:&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [debug] [&amp;lt;0.1594.0&amp;gt;] OAuth Params: []&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [info] [&amp;lt;0.1726.0&amp;gt;] OS Process ::&lt;br/&gt;
function raised error: TypeError: doc is null&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [info] [&amp;lt;0.1726.0&amp;gt;] OS Process ::&lt;br/&gt;
stacktrace: (null,[object Object])@:0&lt;br/&gt;
runShow(function (doc, req) {return &amp;quot;&amp;lt;h1&amp;gt;&amp;quot; + doc.title + &amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;&amp;quot; +&lt;br/&gt;
doc.body + &amp;quot;&amp;lt;/p&amp;gt;&amp;quot;;},null,[object Object],&amp;quot;function (doc, req) { return&lt;br/&gt;
&apos;&amp;lt;h1&amp;gt;&apos;+doc.title+&apos;&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;&apos;+doc.body+&apos;&amp;lt;/p&amp;gt;&apos;; }&lt;br/&gt;
&amp;quot;)@/usr/share/couchdb/server/main.js:388&lt;br/&gt;
(&amp;quot;function (doc, req) { return &apos;&amp;lt;h1&amp;gt;&apos;+doc.title+&apos;&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;&apos;+doc.body&lt;br/&gt;
+&apos;&amp;lt;/p&amp;gt;&apos;; } &amp;quot;,null,[object Object])@/usr/share/couchdb/server/main.js:358&lt;br/&gt;
@/usr/share/couchdb/server/main.js:842&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [error] [&amp;lt;0.1594.0&amp;gt;] OS Process Error ::&lt;br/&gt;
{render_error,{[{&amp;lt;&amp;lt;&amp;quot;body&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;h1&amp;gt;Render&lt;br/&gt;
Error&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;JavaScript function raised error: TypeError: doc is&lt;br/&gt;
null&amp;lt;/p&amp;gt;&amp;lt;h2&amp;gt;Stacktrace:&amp;lt;/h2&amp;gt;&amp;lt;code&amp;gt;&amp;lt;pre&amp;gt;(null,[object Object])@:0&lt;br/&gt;
\nrunShow(function (doc, req) {return \&amp;quot;&amp;amp;lt;h1&amp;amp;gt;\&amp;quot; + doc.title +&lt;br/&gt;
\&amp;quot;&amp;amp;lt;/h1&amp;amp;gt;&amp;amp;lt;p&amp;amp;gt;\&amp;quot; + doc.body + \&amp;quot;&amp;amp;lt;/p&amp;amp;gt;\&amp;quot;;},null,[object&lt;br/&gt;
Object],\&amp;quot;function (doc, req) { return &apos;&amp;amp;lt;h1&amp;amp;gt;&apos;+doc.title&lt;br/&gt;
+&apos;&amp;amp;lt;/h1&amp;amp;gt;&amp;amp;lt;p&amp;amp;gt;&apos;+doc.body+&apos;&amp;amp;lt;/p&amp;amp;gt;&apos;; }&lt;br/&gt;
\&amp;quot;)@/usr/share/couchdb/server/main.js:388\n(\&amp;quot;function (doc, req)&lt;br/&gt;
{ return &apos;&amp;amp;lt;h1&amp;amp;gt;&apos;+doc.title+&apos;&amp;amp;lt;/h1&amp;amp;gt;&amp;amp;lt;p&amp;amp;gt;&apos;+doc.body&lt;br/&gt;
+&apos;&amp;amp;lt;/p&amp;amp;gt;&apos;; } \&amp;quot;,null,[object&lt;br/&gt;
Object])@/usr/share/couchdb/server/main.js:358&lt;br/&gt;
\n@/usr/share/couchdb/server/main.js:842\n&amp;lt;/pre&amp;gt;&amp;lt;/code&amp;gt;&amp;lt;h2&amp;gt;Function&lt;br/&gt;
source:&amp;lt;/h2&amp;gt;&amp;lt;code&amp;gt;&amp;lt;pre&amp;gt;function (doc, req) { return&lt;br/&gt;
&apos;&amp;amp;lt;h1&amp;amp;gt;&apos;+doc.title+&apos;&amp;amp;lt;/h1&amp;amp;gt;&amp;amp;lt;p&amp;amp;gt;&apos;+doc.body+&apos;&amp;amp;lt;/p&amp;amp;gt;&apos;; }&lt;br/&gt;
&amp;lt;/pre&amp;gt;&amp;lt;/code&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&amp;quot;&amp;gt;&amp;gt;}]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [debug] [&amp;lt;0.1628.0&amp;gt;] Unknown linked&lt;br/&gt;
process died: &amp;lt;0.1726.0&amp;gt; (reason: normal)&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [error] [&amp;lt;0.53.0&amp;gt;]&lt;br/&gt;
{error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.53.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_secondary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,normal},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.1628.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,query_servers},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_query_servers,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [error] [&amp;lt;0.1594.0&amp;gt;] Uncaught error in&lt;br/&gt;
HTTP request: {exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{normal,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_query_servers,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ret_proc,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc,&amp;lt;0.1726.0&amp;gt;,&amp;lt;&amp;lt;&amp;quot;javascript&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,prompt},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,set_timeout},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,stop}}}]}}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [info] [&amp;lt;0.1594.0&amp;gt;] Stacktrace:&lt;br/&gt;
[{gen_server,call,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_query_servers,ret_os_process,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_query_servers,render_doc_show,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_show,&apos;-send_doc_show_response/6-fun-0-&apos;,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [debug] [&amp;lt;0.1594.0&amp;gt;] httpd 500 error&lt;br/&gt;
response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;normal&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{gen_server,call,\n&lt;br/&gt;
[couch_query_servers,\n             {ret_proc,{proc,&amp;lt;0.1726.0&amp;gt;,&amp;lt;&amp;lt;&lt;br/&gt;
\&amp;quot;javascript\&amp;quot;&amp;gt;&amp;gt;,\n&lt;br/&gt;
{couch_os_process,prompt},\n&lt;br/&gt;
{couch_os_process,set_timeout},\n&lt;br/&gt;
{couch_os_process,stop}}}]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Dec 2009 10:31:37 GMT] [info] [&amp;lt;0.1594.0&amp;gt;] 192.168.218.87 - -&lt;br/&gt;
&apos;GET&apos; /shows/_design/test/_show/summary/404 50&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I am using CouchDB 0.10.0 from Ubuntu Karmic&apos;s repository. Any&lt;br/&gt;
assistance is much appreciated.&lt;br/&gt;
</description>
                <environment>Ubuntu Karmic</environment>
            <key id="12443220">COUCHDB-598</key>
        <summary>_show without docid returns 500 instead of 404</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="markus17">Markus</reporter>
            
    <created>Sun, 13 Dec 2009 22:44:23 +0000 (UTC)</created>
    <updated>Tue, 22 Dec 2009 16:54:00 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12790250" author="jasondd" created="Mon, 14 Dec 2009 17:33:09 +0000 (UTC)"  >I think this is the expected behaviour, and the example in the book is probably at fault.&lt;br/&gt;
&lt;br/&gt;
We used to return a 404 when the document didn&apos;t exist, but we needed the ability to define a custom response for non-existent docs e.g. a custom 404 page, or a 302 redirect, so now we pass null to the show function instead.  As your show function doesn&apos;t handle the case when doc === null, it is raising an exception and causing a 500 error.  Your code should test for doc === null and return {code: 404, ...} to avoid the 500 error.&lt;br/&gt;
&lt;br/&gt;
I propose marking this as wontfix, any objections?</comment>
                    <comment id="12793587" author="markus17" created="Tue, 22 Dec 2009 10:54:49 +0000 (UTC)"  >Agreed.</comment>
                    <comment id="12793670" author="jchris" created="Tue, 22 Dec 2009 16:54:00 +0000 (UTC)"  >I believe I actually &amp;quot;fixed&amp;quot; this in my ddoc-qs branch I plan to merge (maybe today).&lt;br/&gt;
&lt;br/&gt;
I am not strongly opinionated here, but I&apos;m leaning toward thinking we should handle 404 properly when people call a show function with a document id that doesn&apos;t exist.&lt;br/&gt;
&lt;br/&gt;
I have not changed the behavior at all regarding calling show functions without a docid (still runs the function).&lt;br/&gt;
&lt;br/&gt;
My reasoning for this fix is that custom error pages (for the small percentage of users who want them) are not worth handing nasty 500 errors to everyone who didn&apos;t consider this corner case.&lt;br/&gt;
&lt;br/&gt;
I consider this a minor detail in the ddoc-qs patch, and am open for discussion / changing it back to the current behavior.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 18 Dec 2009 12:31:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Dec 2009 17:33:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-597] Replication tasks crash.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-597</link>

                    <description>&lt;br/&gt;
If I kick off 10 replication tasks in quick succession, occasionally one or two of the replication tasks will die and not be resumed. It seems that the stat tracking is a little buggy, and under stress can eventually cause a permanent failure of the supervised replication task;&lt;br/&gt;
&lt;br/&gt;
[Fri, 11 Dec 2009 19:00:08 GMT] [error] [&amp;lt;0.80.0&amp;gt;] {error_report,&amp;lt;0.30.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.80.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_rep_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,shutdown_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,killed},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.6700.11&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;fcbb13200a1618cf983b347f4d2c9835+create_target&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,start_link,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_rep,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;fcbb13200a1618cf983b347f4d2c9835&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[{&amp;lt;&amp;lt;&amp;quot;create_target&amp;quot;&amp;gt;&amp;gt;,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;source&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://node:5984/perf-p2&quot;&gt;http://node:5984/perf-p2&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;target&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;perf-p2&amp;quot;&amp;gt;&amp;gt;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,temporary},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Fri, 11 Dec 2009 19:00:08 GMT] [error] [emulator] Error in process &amp;lt;0.6705.11&amp;gt; with exit value: {badarg,[{ets,insert,[stats_hit_table,{{couchdb,open_os_files},-1}]},{couch_stats_collector,decrement,1}]}</description>
                <environment></environment>
            <key id="12443194">COUCHDB-597</key>
        <summary>Replication tasks crash.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Sat, 12 Dec 2009 23:39:04 +0000 (UTC)</created>
    <updated>Sun, 20 Dec 2009 03:07:39 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12790760" author="rnewson" created="Tue, 15 Dec 2009 14:37:00 +0000 (UTC)"  >Replication tasks are failing even if executed serially as long as databases are large enough (1.3 gb in this case). The fourth replication task has crashed.&lt;br/&gt;
&lt;br/&gt;
Stack traces from the end of my log while a replication tasks is hung/crashed;&lt;br/&gt;
&lt;br/&gt;
Tue, 15 Dec 2009 07:08:44 GMT] [error] [&amp;lt;0.49.0&amp;gt;] ** Generic server couch_task_status terminating &lt;br/&gt;
** Last message in was {#Ref&amp;lt;0.0.1832.61391&amp;gt;,3}&lt;br/&gt;
** When Server state == nil&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_info,[{#Ref&amp;lt;0.0.1832.61391&amp;gt;,3},nil]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}&lt;br/&gt;
&lt;br/&gt;
Tue, 15 Dec 2009 07:08:44 GMT] [error] [&amp;lt;0.45.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_primary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_info,[{#Ref&amp;lt;0.0.1832.61391&amp;gt;,3},nil]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.49.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_task_status,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:08:51 GMT] [error] [&amp;lt;0.2720.204&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.2720.204&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{couch_task_status,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.2720.204&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,{exit,{{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_primary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.45.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,377},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,127}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:08:51 GMT] [error] [&amp;lt;0.45.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_primary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,{{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.2720.204&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_task_status,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:08:57 GMT] [error] [&amp;lt;0.4889.204&amp;gt;] ** Generic server couch_task_status terminating &lt;br/&gt;
** Last message in was {&apos;$gen_cast&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{update_status,&amp;lt;0.9558.169&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;Copied 146001 of 271595 changes (53%)&amp;quot;&amp;gt;&amp;gt;}}&lt;br/&gt;
** When Server state == nil&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:08:57 GMT] [error] [&amp;lt;0.4889.204&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.4889.204&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{couch_task_status,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.4889.204&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,{exit,{{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_primary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.45.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,377},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,127}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:08:57 GMT] [error] [&amp;lt;0.45.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_primary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,{{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.4889.204&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_task_status,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:09:02 GMT] [error] [&amp;lt;0.45.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_primary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,shutdown},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,reached_max_restart_intensity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.6117.204&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_task_status,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:09:02 GMT] [error] [&amp;lt;0.60.0&amp;gt;] Exit on non-updater process: killed&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:09:02 GMT] [error] [&amp;lt;0.60.0&amp;gt;] ** Generic server couch_view terminating &lt;br/&gt;
** Last message in was {&apos;EXIT&apos;,&amp;lt;0.61.0&amp;gt;,killed}&lt;br/&gt;
** When Server state == {server,&amp;quot;/var/lib/couchdb/0.10.0&amp;quot;}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** killed&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:09:02 GMT] [error] [&amp;lt;0.60.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.60.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{couch_view,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.60.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,couch_view},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,{exit,killed,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_secondary_services,couch_server_sup,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.52.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,2584},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,5320}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:09:02 GMT] [error] [&amp;lt;0.52.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.52.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_secondary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,killed},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.60.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,view_manager},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_view,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Tue, 15 Dec 2009 07:08:44 GMT] [error] [&amp;lt;0.49.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.49.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{couch_task_status,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.49.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{#Ref&amp;lt;0.0.1832.61391&amp;gt;,3},nil]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_primary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.45.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,2584},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,191624}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12790853" author="kocolosk" created="Tue, 15 Dec 2009 18:03:19 +0000 (UTC)"  >The origin of this {#Ref&amp;lt;0.0.1832.61391&amp;gt;,3} message is a total mystery to me, but I know slyphon on IRC also saw this.  We could guard against it by adding a catchall clause to couch_task_status:handle_info</comment>
                    <comment id="12790894" author="paul.joseph.davis" created="Tue, 15 Dec 2009 19:04:03 +0000 (UTC)"  >I&apos;m pretty sure that this is a message leaking from couch_ref_counter. The #Ref&amp;lt;...&amp;gt; variable is the same type of response from a call to erlang:monitor(process, Pid). And couch_ref_counter.erl stores refs like this with a tuple of {Ref, Count} which fits the message that&apos;s killing couch_task_status. That said, I don&apos;t have any idea how such a message is leaking out of the ref counter. My only guess is that there&apos;s a piece of code somewhere that&apos;s trying to catch exceptions and strips a badmatch or other error making this look like a message that was sent instead of an error propagation.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12792700" author="rnewson" created="Fri, 18 Dec 2009 23:46:11 +0000 (UTC)"  >I can reproduce at least one problem with replication with the script below. If executed serially, the tasks complete, but if issued in parallel, they do not;&lt;br/&gt;
&lt;br/&gt;
#!/bin/sh&lt;br/&gt;
&lt;br/&gt;
URL=&lt;a href=&quot;http://localhost:5984&quot;&gt;http://localhost:5984&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
dd if=/dev/zero of=att bs=60k count=1&lt;br/&gt;
&lt;br/&gt;
curl -X DELETE $URL/db1&lt;br/&gt;
curl -X DELETE $URL/db2&lt;br/&gt;
curl -X DELETE $URL/db3&lt;br/&gt;
curl -X DELETE $URL/db4&lt;br/&gt;
curl -X DELETE $URL/db5&lt;br/&gt;
curl -X PUT $URL/db1&lt;br/&gt;
&lt;br/&gt;
for COUNT in {0..100000}&lt;br/&gt;
do&lt;br/&gt;
&amp;nbsp;&amp;nbsp;curl -s -X PUT -d &apos;{&amp;quot;text&amp;quot;:&amp;quot;some text goes here, oh yes.&amp;quot;}&apos; $URL/db1/doc$((COUNT * 2)) &amp;gt; /dev/null&lt;br/&gt;
&amp;nbsp;&amp;nbsp;curl -s -H &amp;quot;Expect: &amp;quot; -X PUT --data-binary @att $URL/db1/doc$((COUNT * 2 + 1))/att &amp;gt; /dev/null&lt;br/&gt;
done&lt;br/&gt;
&lt;br/&gt;
# At least one of these tasks will fail.&lt;br/&gt;
curl &lt;a href=&quot;http://localhost:5984/_replicate&quot;&gt;http://localhost:5984/_replicate&lt;/a&gt; -d &amp;quot;{\&amp;quot;source\&amp;quot;:\&amp;quot;$URL/db1\&amp;quot;,\&amp;quot;target\&amp;quot;:\&amp;quot;db2\&amp;quot;,\&amp;quot;create_target\&amp;quot;:true}&amp;quot; &amp;amp;&lt;br/&gt;
curl &lt;a href=&quot;http://localhost:5984/_replicate&quot;&gt;http://localhost:5984/_replicate&lt;/a&gt; -d &amp;quot;{\&amp;quot;source\&amp;quot;:\&amp;quot;$URL/db1\&amp;quot;,\&amp;quot;target\&amp;quot;:\&amp;quot;db3\&amp;quot;,\&amp;quot;create_target\&amp;quot;:true}&amp;quot; &amp;amp;&lt;br/&gt;
curl &lt;a href=&quot;http://localhost:5984/_replicate&quot;&gt;http://localhost:5984/_replicate&lt;/a&gt; -d &amp;quot;{\&amp;quot;source\&amp;quot;:\&amp;quot;$URL/db1\&amp;quot;,\&amp;quot;target\&amp;quot;:\&amp;quot;db4\&amp;quot;,\&amp;quot;create_target\&amp;quot;:true}&amp;quot; &amp;amp;&lt;br/&gt;
curl &lt;a href=&quot;http://localhost:5984/_replicate&quot;&gt;http://localhost:5984/_replicate&lt;/a&gt; -d &amp;quot;{\&amp;quot;source\&amp;quot;:\&amp;quot;$URL/db1\&amp;quot;,\&amp;quot;target\&amp;quot;:\&amp;quot;db5\&amp;quot;,\&amp;quot;create_target\&amp;quot;:true}&amp;quot; &amp;amp;&lt;br/&gt;
wait&lt;br/&gt;
</comment>
                    <comment id="12792702" author="rnewson" created="Fri, 18 Dec 2009 23:46:42 +0000 (UTC)"  >fy: current trunk fails with;&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;req_timedout&amp;quot;}&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;req_timedout&amp;quot;}&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;req_timedout&amp;quot;}&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;req_timedout&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12792705" author="paul.joseph.davis" created="Fri, 18 Dec 2009 23:52:19 +0000 (UTC)"  >Does this produce the {#Ref&amp;lt;...&amp;gt;, 3} error messages as well?</comment>
                    <comment id="12792709" author="rnewson" created="Sat, 19 Dec 2009 00:02:35 +0000 (UTC)"  >&lt;br/&gt;
It doesn&apos;t seem to, no.</comment>
                    <comment id="12792710" author="rnewson" created="Sat, 19 Dec 2009 00:03:22 +0000 (UTC)"  >well, on my production class server, the same test causes this in the log output;&lt;br/&gt;
&lt;br/&gt;
[Fri, 18 Dec 2009 17:14:43 GMT] [error] [&amp;lt;0.30357.50&amp;gt;] ** Generic server &amp;lt;0.30357.50&amp;gt; terminating &lt;br/&gt;
** Last message in was {#Ref&amp;lt;0.0.370.222135&amp;gt;,3}&lt;br/&gt;
** When Server state == {state,&amp;lt;0.30968.50&amp;gt;,&amp;lt;0.31048.50&amp;gt;,&amp;lt;0.31067.50&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.31124.50&amp;gt;,&lt;br/&gt;
&lt;br/&gt;
So is &amp;quot;{#Ref&amp;lt;0.0.370.222135&amp;gt;,3}&amp;quot; evidence of the same phenomenon?</comment>
                    <comment id="12792717" author="paul.joseph.davis" created="Sat, 19 Dec 2009 00:20:12 +0000 (UTC)"  >No idea. I&apos;ll try and reproduce when I get home in a bit.</comment>
                    <comment id="12792943" author="kocolosk" created="Sun, 20 Dec 2009 02:59:28 +0000 (UTC)"  >Hi Robert, I can reproduce the crashes locally and I&apos;ve discovered why they happen independently of the {ref(), integer()} problem.  The basic issue is that attachment downloads do not employ the same retry checks that we do for regular document GETs.  For instance, the attachment receiver process associated with a replication would be waiting an infinite amount for response headers, when in fact it had an error message in its mailbox informing it that the request had failed.  Eventually the changes feed times out and the replication crashes.&lt;br/&gt;
&lt;br/&gt;
If I apply &lt;a href=&quot;http://friendpaste.com/5IA5MlRx0OZhKmsLNPMeJe,&quot;&gt;http://friendpaste.com/5IA5MlRx0OZhKmsLNPMeJe,&lt;/a&gt; crank up the changes feed timeout, and add the catchall handle_infos we&apos;ve talked about before I can successfully run the script you posted here.  We have more work to do, though, namely&lt;br/&gt;
&lt;br/&gt;
1) Reworking the changes feed timeout.  Currently it will trigger if there is no activity for X milliseconds on the connection handling the _changes feed.  There are situations where this is actually normal, since the changes feed consumer is responsible for controlling the socket, and if the target is _really_ slow (or the documents are huge) it&apos;s quite possible that the changes feed will not be consulted for a long time.  I think the solution is to handle inactivity timeouts in couch_rep_changes_feed.erl instead of in the underlying ibrowse system.&lt;br/&gt;
&lt;br/&gt;
2a) Attachment retry logic that handles redirects and limits the number of retries.  Basically, the same code as we have in couch_rep_httpc, but only applied until we receive the response headers.  My friendpaste above is a primitive form of what I&apos;d ultimately like to see here.&lt;br/&gt;
&lt;br/&gt;
2b) When an attachment body download has started and then fails, we can&apos;t simply retry it.  We need to do a Range request or find another way to skip the first N bytes of the retry.  Currently we just give up on the entire replication if an attachment request ever fails mid-download.</comment>
                    <comment id="12792944" author="kocolosk" created="Sun, 20 Dec 2009 03:07:39 +0000 (UTC)"  >Also, I don&apos;t really understand why the &amp;quot;after&amp;quot; clause is necessary in that paste.  I tried adding a connect_timeout to ibrowse but didn&apos;t get any conn_failed messages.  It really does seem like a connection is made but then the request just stalls.  I suppose it&apos;s possible that a connection took 9 seconds (e.g. 3 consecutive TCP retransmits), and then CouchDB took more than 1 second to respond with the headers.  Seems unlikely, though.  It makes me think we need to add this &amp;quot;after&apos; clause to couch_rep_httpc too.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Dec 2009 18:03:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-596] Replication tasks sometimes never complete</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-596</link>

                    <description>&lt;br/&gt;
In my recent testing with trunk, I kick off around 10 replication tasks in quick succession, each for databases with at least a few thousand documents. More often than not, one or two of these replication tasks never completes; the response is never returned to the calling thread and the tasks remain present in _active_tasks until the server is rebooted.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12443193">COUCHDB-596</key>
        <summary>Replication tasks sometimes never complete</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Sat, 12 Dec 2009 23:37:26 +0000 (UTC)</created>
    <updated>Sun, 20 Dec 2009 03:12:04 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12792945" author="kocolosk" created="Sun, 20 Dec 2009 03:12:04 +0000 (UTC)"  >It&apos;s possible that the issues I described in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-597&quot; title=&quot;Replication tasks crash.&quot;&gt;COUCHDB-597&lt;/a&gt; could cause this too, if the changes feed had been fully downloaded.  That&apos;s the only timeout we have; everyone else is content to wait forever while the attachment receiver is stuck waiting for a message that will never come.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 20 Dec 2009 03:12:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-595] Expect/Continue support broken for non-chunked transfer uploads</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-595</link>

                    <description>&lt;br/&gt;
CouchDB does not send the &amp;quot;HTTP/1.1 100 CONTINUE\r\n&amp;quot; line in response to a request with header &amp;quot;Expect: 100-continue&amp;quot;. It does do so for chunked transfer mode, so correct expect/continue behavior can be achieved by forcing chunked mode, even when the exact length of the body is known.&lt;br/&gt;
&lt;br/&gt;
mochiweb_request.erl&apos;s recv/1 method does not send the header, but stream_body/4 does.</description>
                <environment></environment>
            <key id="12443192">COUCHDB-595</key>
        <summary>Expect/Continue support broken for non-chunked transfer uploads</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Sat, 12 Dec 2009 23:33:50 +0000 (UTC)</created>
    <updated>Tue, 2 Feb 2010 15:12:23 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12790763" author="benoitc" created="Tue, 15 Dec 2009 14:49:25 +0000 (UTC)"  >Testing here with a non chunked Transfer-Encoding and can&apos;t reproduce the problem on latest trunk :&lt;br/&gt;
&lt;br/&gt;
send: &apos;PUT /testdb/testingpurpose HTTP/1.1\r\nHost: 127.0.0.1:5984\r\nAccept-Encoding: identity\r\ncontent-length: 42\r\ncontent-type: application/octet-stream\r\nexpect: 100-continue\r\nuser-agent: restkit/0.9.2\r\n\r\n&apos;&lt;br/&gt;
send: &apos;{&amp;quot;essai&amp;quot;: &amp;quot;ahah&amp;quot;, &amp;quot;_id&amp;quot;: &amp;quot;testingpurpose&amp;quot;}&apos;&lt;br/&gt;
send: &apos;PUT /testdb/testingpurpose HTTP/1.1\r\nHost: 127.0.0.1:5984\r\nAccept-Encoding: identity\r\ncontent-length: 42\r\ncontent-type: application/octet-stream\r\nexpect: 100-continue\r\nuser-agent: restkit/0.9.2\r\n\r\n&apos;&lt;br/&gt;
send: &apos;{&amp;quot;essai&amp;quot;: &amp;quot;ahah&amp;quot;, &amp;quot;_id&amp;quot;: &amp;quot;testingpurpose&amp;quot;}&apos;&lt;br/&gt;
reply: &apos;HTTP/1.1 100 Continue\r\n&apos;&lt;br/&gt;
reply: &apos;HTTP/1.1 409 Conflict\r\n&apos;&lt;br/&gt;
header: Server: CouchDB/0.11.0bd3745d1e-git (Erlang OTP/R13B)&lt;br/&gt;
header: Date: Tue, 15 Dec 2009 14:43:51 GMT&lt;br/&gt;
header: Content-Type: text/plain;charset=utf-8&lt;br/&gt;
header: Content-Length: 58&lt;br/&gt;
header: Cache-Control: must-revalidate</comment>
                    <comment id="12790968" author="rnewson" created="Tue, 15 Dec 2009 21:35:19 +0000 (UTC)"  >&lt;br/&gt;
Further testing reveals couchdb works as desired. Will attempt to reproduce the problem but independent tests have passed.</comment>
                    <comment id="12792630" author="rnewson" created="Fri, 18 Dec 2009 20:30:13 +0000 (UTC)"  >Below is a script to reproduce the problem. &lt;br/&gt;
&lt;br/&gt;
Curl sends this;&lt;br/&gt;
&lt;br/&gt;
&amp;gt; PUT /db1/doc1/att HTTP/1.1&lt;br/&gt;
&amp;gt; User-Agent: curl/7.19.4 (universal-apple-darwin10.0) libcurl/7.19.4 OpenSSL/0.9.8k zlib/1.2.3&lt;br/&gt;
&amp;gt; Host: localhost:5984&lt;br/&gt;
&amp;gt; Accept: */*&lt;br/&gt;
&amp;gt; Content-Length: 61440&lt;br/&gt;
&amp;gt; Content-Type: application/x-www-form-urlencoded&lt;br/&gt;
&amp;gt; Expect: 100-continue&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&lt;br/&gt;
at this point, curl waits for COUCHDB to send;&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 100 CONTINUE&lt;br/&gt;
&lt;br/&gt;
But couchdb never sends this.&lt;br/&gt;
&lt;br/&gt;
Curl, after a couple of seconds, gives up waiting and sends the body anyway. Once this is sent, CouchDB responds with;&lt;br/&gt;
&lt;br/&gt;
* Done waiting for 100-continue&lt;br/&gt;
&amp;lt; HTTP/1.1 201 Created&lt;br/&gt;
&amp;lt; Server: CouchDB/0.11.0b22c551bb-git (Erlang OTP/R13B)&lt;br/&gt;
&amp;lt; Location: &lt;a href=&quot;http://localhost:5984/db1/doc1/att&quot;&gt;http://localhost:5984/db1/doc1/att&lt;/a&gt;&lt;br/&gt;
&amp;lt; Date: Fri, 18 Dec 2009 20:26:38 GMT&lt;br/&gt;
&amp;lt; Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&amp;lt; Content-Length: 67&lt;br/&gt;
&amp;lt; Cache-Control: must-revalidate&lt;br/&gt;
&amp;lt; &lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;doc1&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-a58ec7b4f38399400e6e9bcd9e87f2a1&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
The fix is to immediately return &amp;quot;HTTP/1.1 100 CONTINUE&amp;quot; on receipt of the end of headers (the \r\n\r\n sequence) or a final error code, if the client included an Expect: 100-continue header&lt;br/&gt;
&lt;br/&gt;
#!/bin/sh&lt;br/&gt;
&lt;br/&gt;
URL=&lt;a href=&quot;http://localhost:5984&quot;&gt;http://localhost:5984&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
dd if=/dev/zero of=att bs=60k count=1&lt;br/&gt;
&lt;br/&gt;
curl -X DELETE $URL/db1&lt;br/&gt;
curl -X PUT $URL/db1&lt;br/&gt;
&lt;br/&gt;
for COUNT in {0..100000}&lt;br/&gt;
do&lt;br/&gt;
&amp;nbsp;&amp;nbsp;curl -X PUT -d &apos;{&amp;quot;text&amp;quot;:&amp;quot;some text goes here, oh yes.&amp;quot;}&apos; $URL/db1/doc$((COUNT * 2))&lt;br/&gt;
&amp;nbsp;&amp;nbsp;curl -v -X PUT --data-binary @att $URL/db1/doc$((COUNT * 2 + 1))/att&lt;br/&gt;
done</comment>
                    <comment id="12792639" author="benoitc" created="Fri, 18 Dec 2009 20:58:33 +0000 (UTC)"  >Closer look on it using raw socket calls :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://friendpaste.com/4dbdw6pscRwNHoxpswklUH&quot;&gt;http://friendpaste.com/4dbdw6pscRwNHoxpswklUH&lt;/a&gt; (paste below) &lt;br/&gt;
&lt;br/&gt;
So it appears the problem happen only on attachment sending. Also I notice there me another problem here. When you send a conflicted doc the first time you get a connection reset per peer :&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock = socket.create_connection((&amp;quot;127.0.0.1&amp;quot;, 5984))&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.send(&apos;PUT /testdb/hum1 HTTP/1.1\r\nHost: 127.0.0.1:5984\r\nAccept-Encoding: identity\r\nContent-Length: 2\r\nContent-Type: application/octet-stream\r\nExpect: 100-continue\r\nUser-Agent: restkit/0.9.2\r\n\r\n&apos;)&lt;br/&gt;
186&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.recv(4096)&apos;HTTP/1.1 100 Continue\r\n\r\n&apos;&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.send(&amp;quot;{}&amp;quot;)2&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.recv(4096)&apos;HTTP/1.1 201 Created\r\nServer: CouchDB/0.11.0b22c551bb-git (Erlang OTP/R13B)\r\nLocation: &lt;a href=&quot;http://127.0.0.1:5984/testdb/hum1&quot;&gt;http://127.0.0.1:5984/testdb/hum1&lt;/a&gt;\r\nEtag: &amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;\r\nDate: Fri, 18 Dec 2009 20:49:48 GMT\r\nContent-Type: text/plain;charset=utf-8\r\nContent-Length: 67\r\nCache-Control: must-revalidate\r\n\r\n{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;hum1&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}\n&apos;&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock = socket.create_connection((&amp;quot;127.0.0.1&amp;quot;, 5984))&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.send(&apos;PUT /testdb/hum1/att1 HTTP/1.1\r\nHost: 127.0.0.1:5984\r\nAccept-Encoding: identity\r\nContent-Length: 2\r\nContent-Type: application/octet-stream\r\nExpect: 100-continue\r\nUser-Agent: restkit/0.9.2\r\n\r\n&apos;)&lt;br/&gt;
191&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.recv(4096)&lt;br/&gt;
&apos;HTTP/1.1 409 Conflict\r\nServer: CouchDB/0.11.0b22c551bb-git (Erlang OTP/R13B)\r\nDate: Fri, 18 Dec 2009 20:50:22 GMT\r\nContent-Type: text/plain;charset=utf-8\r\nContent-Length: 58\r\nCache-Control: must-revalidate\r\n\r\n{&amp;quot;error&amp;quot;:&amp;quot;conflict&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Document update conflict.&amp;quot;}\n&apos;&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock = socket.create_connection((&amp;quot;127.0.0.1&amp;quot;, 5984))&amp;gt;&amp;gt;&amp;gt; sock.send(&apos;PUT /testdb/hum1/att1?rev=1-967a00dff5e02add41819138abb3284d HTTP/1.1\r\nHost: 127.0.0.1:5984\r\nAccept-Encoding: identity\r\nContent-Length: 2\r\nContent-Type: application/octet-stream\r\nExpect: 100-continue\r\nUser-Agent: restkit/0.9.2\r\n\r\n&apos;)&lt;br/&gt;
230&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.recv(4096)&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
&amp;nbsp;&amp;nbsp;File &amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;, line 1, in &amp;lt;module&amp;gt;&lt;br/&gt;
socket.error: [Errno 54] Connection reset by peer&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock = socket.create_connection((&amp;quot;127.0.0.1&amp;quot;, 5984), 2)&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.send(&apos;PUT /testdb/hum1/att1?rev=1-967a00dff5e02add41819138abb3284d HTTP/1.1\r\nHost: 127.0.0.1:5984\r\nAccept-Encoding: identity\r\nContent-Length: 2\r\nContent-Type: application/octet-stream\r\nExpect: 100-continue\r\nUser-Agent: restkit/0.9.2\r\n\r\n&apos;)&lt;br/&gt;
230&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; sock.recv(4096)&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
&amp;nbsp;&amp;nbsp;File &amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;, line 1, in &amp;lt;module&amp;gt;&lt;br/&gt;
socket.timeout: timed out</comment>
                    <comment id="12792650" author="benoitc" created="Fri, 18 Dec 2009 21:22:57 +0000 (UTC)"  >Patch that seem to fix the issue. To put attachments, CouchDB use its own functions to receive the body and don&apos;t send the expect header back. I haven&apos;t tested yet against chunked encoding. </comment>
                    <comment id="12792653" author="benoitc" created="Fri, 18 Dec 2009 21:33:06 +0000 (UTC)"  >chunked send use stream_body which already send the Expect header. This patch send expect header only for non chunked solution.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Maybe we should use MochiReq:recv_body(MaxLen) so we don&apos;t need to add this code here. Is there any reason actually why we use recv ?</comment>
                    <comment id="12792655" author="benoitc" created="Fri, 18 Dec 2009 21:38:19 +0000 (UTC)"  >answering myself, using recv(0) allow us to get any size of attachment. If we limit the size we could use recv_body though.</comment>
                    <comment id="12828639" author="rnewson" created="Tue, 2 Feb 2010 15:12:23 +0000 (UTC)"  >Confirmed that couchdb_att_100_continue2.patch fixes the problem with expect/continue delays for non-chunked PUT&apos;s.&lt;br/&gt;
&lt;br/&gt;
Thanks.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12428484" name="couchdb_att_100_continue.patch" size="1377" author="benoitc" created="Fri, 18 Dec 2009 21:22:57 +0000 (UTC)" />
            <attachment id="12428487" name="couchdb_att_100_continue2.patch" size="1645" author="benoitc" created="Fri, 18 Dec 2009 21:33:06 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Dec 2009 14:49:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-594] Replicator does not release old Fd of compacted DB</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-594</link>

                    <description>If you compact a local DB while a replication using that DB is running, the replicator will hang onto the Fd of the old file forever.  Patch is on the way.</description>
                <environment></environment>
            <key id="12442699">COUCHDB-594</key>
        <summary>Replicator does not release old Fd of compacted DB</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 8 Dec 2009 05:24:16 +0000 (UTC)</created>
    <updated>Tue, 8 Dec 2009 05:24:57 +0000 (UTC)</updated>

                        <version>0.10.1</version>
                    <version>0.11</version>
            
                        <fixVersion>0.10.2</fixVersion>
                    <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12787324" author="kocolosk" created="Tue, 8 Dec 2009 05:24:57 +0000 (UTC)"  >fixed in r888267 (trunk), r888268 (0.10.x)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 8 Dec 2009 05:24:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-593] Show returning zero length string results in scary errors</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-593</link>

                    <description>If your show function returns a zero length string then several scary things happen.  Arguably the empty length string should just be returned to the browser.&lt;br/&gt;
&lt;br/&gt;
function (doc,req) { return &amp;quot;&amp;quot;;}&lt;br/&gt;
&lt;br/&gt;
On returning the zero length string, the following is displayed in the browser:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ret_proc,{proc,&amp;lt;0.79.0&amp;gt;,&amp;lt;&amp;lt;\&amp;quot;javascript\&amp;quot;&amp;gt;&amp;gt;,\n                             {couch_os_process,prompt},\n                             {couch_os_process,set_timeout},\n                             {couch_os_process,stop}}}]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
The following is in the CouchDB log:&lt;br/&gt;
&lt;br/&gt;
[Sun, 06 Dec 2009 22:10:15 GMT] [error] [&amp;lt;0.64.0&amp;gt;] OS Process Error :: {render_error,&amp;lt;&amp;lt;&amp;quot;undefined response from show function&amp;quot;&amp;gt;&amp;gt;}&lt;br/&gt;
&lt;br/&gt;
[Sun, 06 Dec 2009 22:10:15 GMT] [error] [&amp;lt;0.53.0&amp;gt;] {error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.53.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_secondary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,normal},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.58.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,query_servers},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_query_servers,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Sun, 06 Dec 2009 22:10:15 GMT] [error] [&amp;lt;0.64.0&amp;gt;] Uncaught error in HTTP request: {exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{normal,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_query_servers,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ret_proc,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc,&amp;lt;0.79.0&amp;gt;,&amp;lt;&amp;lt;&amp;quot;javascript&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,prompt},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,set_timeout},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,stop}}}]}}}&lt;br/&gt;
&lt;br/&gt;
[Sun, 06 Dec 2009 22:10:15 GMT] [info] [&amp;lt;0.64.0&amp;gt;] Stacktrace: [{gen_server,call,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_query_servers,ret_os_process,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_query_servers,render_doc_show,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_show,&apos;-send_doc_show_response/6-fun-0-&apos;,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]&lt;br/&gt;
&lt;br/&gt;
[Sun, 06 Dec 2009 22:10:15 GMT] [info] [&amp;lt;0.64.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /r/_design/rofroks/_show/index 500&lt;br/&gt;
</description>
                <environment>Ubuntu 9.10</environment>
            <key id="12442587">COUCHDB-593</key>
        <summary>Show returning zero length string results in scary errors</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="rogerbinns">Roger Binns</reporter>
            
    <created>Sun, 6 Dec 2009 22:16:45 +0000 (UTC)</created>
    <updated>Sun, 6 Dec 2009 22:58:05 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12786731" author="jchris" created="Sun, 6 Dec 2009 22:58:05 +0000 (UTC)"  >fixed in r887791,&lt;br/&gt;
&lt;br/&gt;
thanks Roger for the ticket!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 6 Dec 2009 22:58:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 6 Dec 2009 22:58:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-592] Build and configure without the js library</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-592</link>

                    <description>I am trying to use couchdb without the requirements of the js library. I will not be accessing couch (nor do I want access) through an http interface, but an erlang client library. &lt;br/&gt;
&lt;br/&gt;
Thanks</description>
                <environment>Any?</environment>
            <key id="12442489">COUCHDB-592</key>
        <summary>Build and configure without the js library</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="auser">Ari Lerner</reporter>
            
    <created>Fri, 4 Dec 2009 18:44:52 +0000 (UTC)</created>
    <updated>Sat, 5 Dec 2009 02:13:57 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12786082" author="nslater" created="Fri, 4 Dec 2009 19:09:28 +0000 (UTC)"  >I&apos;m not sure what you want.&lt;br/&gt;
&lt;br/&gt;
Do you want to be able to disable the building of any JS component at all? Why?&lt;br/&gt;
&lt;br/&gt;
What has that to do with HTTP? There is no way to use CouchDB without using HTTP at the emoment.</comment>
                    <comment id="12786088" author="auser" created="Fri, 4 Dec 2009 19:18:34 +0000 (UTC)"  >I don&apos;t want to have to require the SpiderMonkey javascript library when building couch.</comment>
                    <comment id="12786121" author="paul.joseph.davis" created="Fri, 4 Dec 2009 20:04:28 +0000 (UTC)"  >The quickest thing to do would be to delete the relevant sections from configure.ac and src/couchdb/priv/Makefile to avoid that. Though be aware that at some time in the nearish future JS might be a test time dependency so you won&apos;t be able to run the test suite from make check.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12786150" author="grempe" created="Fri, 4 Dec 2009 20:47:31 +0000 (UTC)"  >Noah,&lt;br/&gt;
&lt;br/&gt;
I believe you can use CouchDB without http access if you use the Hovercraft Erlang library.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/jchris/hovercraft&quot;&gt;http://github.com/jchris/hovercraft&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://github.com/grempe/hovercraft&quot;&gt;http://github.com/grempe/hovercraft&lt;/a&gt; (Includes fixes for trunk couchdb pending merge to jchris master)&lt;br/&gt;
&lt;br/&gt;
If you mixed that with Erlang views wouldn&apos;t that be a reason to want to eliminate any external build time dependencies other than Erlang?  CouchDB should optimally be able to operate in pure erlang mode. No?  This is something the couchdb team should encourage imho.</comment>
                    <comment id="12786155" author="auser" created="Fri, 4 Dec 2009 20:51:41 +0000 (UTC)"  >That&apos;s exactly what I want Glenn.&lt;br/&gt;
&lt;br/&gt;
The extra dependency of the JS library is limiting and somewhat of a deal-breaker for the project I&apos;m working on (in an environment where every dependency is a hurdle for implementation)</comment>
                    <comment id="12786156" author="paul.joseph.davis" created="Fri, 4 Dec 2009 20:53:25 +0000 (UTC)"  >Don&apos;t forget the ICU dependency that you&apos;d have to remove as well then.</comment>
                    <comment id="12786157" author="paul.joseph.davis" created="Fri, 4 Dec 2009 20:55:01 +0000 (UTC)"  >Also, I should mention that I don&apos;t really foresee providing this as part of any official distribution. Its pretty core to CouchDB to provide these things, and removing them should be considered a private modification. It really shouldn&apos;t be too hard though.</comment>
                    <comment id="12786159" author="auser" created="Fri, 4 Dec 2009 20:57:38 +0000 (UTC)"  >Perhaps I&apos;m mistaken, but I don&apos;t see the downsides to providing a --without-js-libs option to the configure script...</comment>
                    <comment id="12786243" author="paul.joseph.davis" created="Fri, 4 Dec 2009 23:39:57 +0000 (UTC)"  >The downside is on the theoretical side and for me its a hold the line type of position. I wouldn&apos;t veto a patch for it but I&apos;m not about to write it.&lt;br/&gt;
&lt;br/&gt;
The issue is that once we start doing allowing the official releases to have all sorts of conditional compilation options we have to officially support each permutation of those options. Spending extra time tracking down weird compilation configurations is not something I would enjoy.&lt;br/&gt;
&lt;br/&gt;
And there&apos;s also the fact that this is a pretty easy hack to remove all parts of the build system that&apos;d require JS, cURL, and ICU. And the build system doesn&apos;t change *that* often so it wouldn&apos;t be hard too hard to keep in sync outside of trunk.</comment>
                    <comment id="12786312" author="nslater" created="Sat, 5 Dec 2009 02:13:57 +0000 (UTC)"  >I am happy to review and apply a patch that adds this as an option to configure, as long as the actual build is taken care of properly.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 4 Dec 2009 19:09:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-591] _rewrite handler</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-591</link>

                    <description>Find attached a patch providing simple url rewritig in CouchDB. You can also find it in my github repo :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/benoitc/couchdb/tree/rewrite&quot;&gt;http://github.com/benoitc/couchdb/tree/rewrite&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The design is very simple. Everything is managed via a simple javascript function that return a path or throw &apos;forbidden&apos;, &apos;unauthorized&apos; and &amp;quot;not found&amp;quot; errors. The request object is passed to the function and then depending on the path, verb or userCtx you could decide how to rewrite the path. All relatives path are relative to design doc.&lt;br/&gt;
&lt;br/&gt;
The _rewriter is available at db or _design level :&lt;br/&gt;
&lt;br/&gt;
/db/_rewrite/designname/path&lt;br/&gt;
&lt;br/&gt;
or&lt;br/&gt;
&lt;br/&gt;
/db/_design/designame/_rewrite/path.&lt;br/&gt;
&lt;br/&gt;
Then _rewrite handler look in design doc if `rewrite` member exists and load the function.  A snippet is avalaible here :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://markmail.org/message/4alwtb2zzgwu7iz7&quot;&gt;http://markmail.org/message/4alwtb2zzgwu7iz7&lt;/a&gt;</description>
                <environment></environment>
            <key id="12442473">COUCHDB-591</key>
        <summary>_rewrite handler</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Fri, 4 Dec 2009 17:23:08 +0000 (UTC)</created>
    <updated>Sun, 31 Jan 2010 23:27:06 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12806250" author="benoitc" created="Fri, 29 Jan 2010 06:31:45 +0000 (UTC)"  >This new patch is a complete rewrite. Now rewriting is fully handled in Erlang :&lt;br/&gt;
&lt;br/&gt;
The rewriting root is the&lt;br/&gt;
the design doc :&lt;br/&gt;
&lt;br/&gt;
/yourdb/_design/ddocname/_rewrite/....&lt;br/&gt;
&lt;br/&gt;
ddocname should contain a &amp;quot;rewrites&amp;quot; member which a list of rewriting&lt;br/&gt;
rules. If not it will return a 404.&lt;br/&gt;
&lt;br/&gt;
ex :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;....&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;rewrite&amp;quot;: [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;from&amp;quot;: &amp;quot;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;to&amp;quot;: &amp;quot;index.html&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;method&amp;quot;: &amp;quot;GET&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;query&amp;quot;: {}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
Urls are relative to ddoc :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_show/test/...&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/_show/test/....&lt;br/&gt;
give same results: /somedb/ddoc/_design/_show/test/...&lt;br/&gt;
&lt;br/&gt;
However it&apos;s also possible  to do :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;../../_changes -&amp;gt; /somedb/_changes&lt;br/&gt;
and :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;../../../somedb -&amp;gt; /somedb&lt;br/&gt;
or :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;../../../_utils -&amp;gt; _utils&lt;br/&gt;
&lt;br/&gt;
Rewriting can use variables. Variables in path are prefixed by &amp;quot;:&amp;quot;.&lt;br/&gt;
For example the following rule:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ &amp;quot;from&amp;quot;: &amp;quot;show/:id&amp;quot;, &amp;quot;to&amp;quot;: &amp;quot;_show/mydoc/:id&amp;quot; }&lt;br/&gt;
&lt;br/&gt;
will rewrite  &amp;quot;/mydb/_design/test/_rewrite/show/someid&amp;quot; to &amp;quot;/mydb/_design/test/_show/someid&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
or &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ &amp;quot;from&amp;quot;: &amp;quot;view/:type&amp;quot;, &amp;quot;to&amp;quot;: &amp;quot;_list/types/by_types&amp;quot;, query: {&lt;br/&gt;
&amp;quot;key&amp;quot;: &amp;quot;type&amp;quot; }&lt;br/&gt;
&lt;br/&gt;
will rewrite  &amp;quot;/mydb/_design/test/_rewrite/view/sometype&amp;quot; to&lt;br/&gt;
&amp;quot;/mydb/_design/test/_list/types/by_types?key=sometype&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
&amp;quot;*&amp;quot; is a special variable and should be the last. It means &amp;quot;all remaining in path&amp;quot;. Ex if for from we have  /test/*, *, * Will mean &amp;quot;someurl&amp;quot; in /test/url . &amp;quot;*&amp;quot; could be used in the rewritten url or query too. Ex:&lt;br/&gt;
&lt;br/&gt;
{ &amp;quot;from&amp;quot;: &amp;quot;show/*&amp;quot;, &amp;quot;to&amp;quot;: &amp;quot;_show/mydoc/* }&lt;br/&gt;
&lt;br/&gt;
will rewrite  &amp;quot;/mydb/_design/test/_rewrite/show/someid&amp;quot; to &amp;quot;/mydb/_design/test/_show/someid&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
</comment>
                    <comment id="12806552" author="jchris" created="Fri, 29 Jan 2010 23:09:53 +0000 (UTC)"  >I think this is close, however, it&apos;d be nice to see a broader test suite.&lt;br/&gt;
&lt;br/&gt;
Eg, can I rewrite the query string parameters? Can I rewrite to 2 different endpoints depending on the verb?&lt;br/&gt;
&lt;br/&gt;
These tests are the best documentation, so having a fuller set would help a lot.</comment>
                    <comment id="12806847" author="benoitc" created="Sun, 31 Jan 2010 17:09:59 +0000 (UTC)"  >Yes depending on the verb you can have 2 different rules. It first bind the method and then try to bind path. Query arguments may be rewritten. I will add new tests also just documented the code.</comment>
                    <comment id="12806864" author="janl" created="Sun, 31 Jan 2010 21:02:56 +0000 (UTC)"  >Benoit, this patch looks solid. I like code &amp;amp; concept. If you feel it is ready, I&apos;d support merging it into trunk.&lt;br/&gt;
&lt;br/&gt;
Two nit-picks: There&apos;s some trailing whitespace sprinkled in that you could clean up and the LOG_INFO() that is triggered when a rewrite happens should be a LOG_DEBUG(). otherwise LOG_INFO is getting pretty noisy pretty quickly.&lt;br/&gt;
&lt;br/&gt;
Good job so far!</comment>
                    <comment id="12806875" author="benoitc" created="Sun, 31 Jan 2010 23:27:06 +0000 (UTC)"  >commited in trunk. Some doc here : &lt;a href=&quot;http://wiki.apache.org/couchdb/Rewriting_urls&quot;&gt;http://wiki.apache.org/couchdb/Rewriting_urls&lt;/a&gt; also tests.</comment>
                </comments>
    
    <attachments>
            <attachment id="12431751" name="couch_httpd_rewriter2.diff" size="18026" author="benoitc" created="Fri, 29 Jan 2010 06:31:45 +0000 (UTC)" />
            <attachment id="12426919" name="couchdb_rewrite.patch" size="14234" author="benoitc" created="Fri, 4 Dec 2009 17:23:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 31 Jan 2010 23:27:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 29 Jan 2010 23:09:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-590] Support resource limit configuration in the init scripts</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-590</link>

                    <description>It would be nice to specify some resource limits when spawning couchdb from the init scripts.&lt;br/&gt;
I&apos;ve seen high load result in mochiweb accept errors, for example, and increasing the file descriptor limit solved the problem.&lt;br/&gt;
I&apos;m attaching a patch that allows any options to be passed to ulimit via /etc/defaults/couchdb</description>
                <environment></environment>
            <key id="12442286">COUCHDB-590</key>
        <summary>Support resource limit configuration in the init scripts</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="tilgovi">Randall Leeds</reporter>
            
    <created>Thu, 3 Dec 2009 00:00:41 +0000 (UTC)</created>
    <updated>Thu, 3 Dec 2009 01:22:50 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="0">0h</timeoriginalestimate>        <timeestimate seconds="0">0h</timeestimate>                    

            <comments>
                    <comment id="12785071" author="tilgovi" created="Thu, 3 Dec 2009 00:06:53 +0000 (UTC)"  >Patch as described.</comment>
                    <comment id="12785113" author="jchris" created="Thu, 3 Dec 2009 01:22:50 +0000 (UTC)"  >sounds like a plan to me</comment>
                </comments>
    
    <attachments>
            <attachment id="12426719" name="ulimit.patch" size="767" author="tilgovi" created="Thu, 3 Dec 2009 00:06:53 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 3 Dec 2009 01:22:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-589] Simplify Query Server interface and Design Handlers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-589</link>

                    <description>This patch refactors list, show, update, filter, and view handling to have a unified interface for loading the design document and functions from it. It is a step on the path to removing a lot of function src passing overhead from the view server protocol.&lt;br/&gt;
&lt;br/&gt;
The patch also removes some old part of the API while improving other parts of the API.&lt;br/&gt;
&lt;br/&gt;
The big changes:&lt;br/&gt;
&lt;br/&gt;
Load the design document before handing it to the design document handlers. This removes a lot of duplicated code.&lt;br/&gt;
&lt;br/&gt;
Remove /db/_view handler. I think it&apos;s in our interest to remove the last bits of the old-style API before 0.11.&lt;br/&gt;
&lt;br/&gt;
I also clean up some rough edges in the API.&lt;br/&gt;
&lt;br/&gt;
I plan to commit this patch soon, but want to give people an opportunity to look it over.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12442282">COUCHDB-589</key>
        <summary>Simplify Query Server interface and Design Handlers</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 2 Dec 2009 23:34:57 +0000 (UTC)</created>
    <updated>Thu, 28 Jan 2010 18:02:44 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12785082" author="kocolosk" created="Thu, 3 Dec 2009 00:37:35 +0000 (UTC)"  >Hi Chris, why the flip-flop from &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-404&quot; title=&quot;restfull and shorter urls for lists and shows&quot;&gt;&lt;strike&gt;COUCHDB-404&lt;/strike&gt;&lt;/a&gt;?  We just got done re-adding /db/_view URLs in 0.10, now we&apos;re removing them again in 0.11?</comment>
                    <comment id="12785111" author="jchris" created="Thu, 3 Dec 2009 01:20:05 +0000 (UTC)"  >Adam,&lt;br/&gt;
&lt;br/&gt;
Thanks for finding &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-404&quot; title=&quot;restfull and shorter urls for lists and shows&quot;&gt;&lt;strike&gt;COUCHDB-404&lt;/strike&gt;&lt;/a&gt;, I think it&apos;s important people see that I&apos;m removing the legacy /db/_view API in this patch.&lt;br/&gt;
&lt;br/&gt;
It was easier to delete that code than maintain it as I was working on the refactor, so I deleted it.&lt;br/&gt;
&lt;br/&gt;
I don&apos;t like maintaining API surface area that doesn&apos;t add functionality, and now is a good time to fix this. &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-404&quot; title=&quot;restfull and shorter urls for lists and shows&quot;&gt;&lt;strike&gt;COUCHDB-404&lt;/strike&gt;&lt;/a&gt; showed that we can support the legacy view API if we need to. But that&apos;s a lot of code-weight for backwards compatibility with our alpha APIs.&lt;br/&gt;
&lt;br/&gt;
There are lots of other little fixes in here as well, I think this patch fixes the issue discussed recently on user@ about _show responses and missing documents [1], as well as doing a general clean-up in the interest of making the query server code easier to understand, as well as prepping for my function-hashing optimization.&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-user/200912.mbox/%3c1259663713.7371.37.camel@zelda.buyways.nl%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-user/200912.mbox/%3c1259663713.7371.37.camel@zelda.buyways.nl%3e&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
If there are lots of people still hitting /db/_view/ on 0.10.x of course I&apos;m open to discussion, but I think this API isn&apos;t needed in 0.11.&lt;br/&gt;
&lt;br/&gt;
Chris</comment>
                    <comment id="12789767" author="janl" created="Sat, 12 Dec 2009 17:22:47 +0000 (UTC)"  >+1 on the flip-flop.</comment>
                    <comment id="12793073" author="jchris" created="Mon, 21 Dec 2009 03:55:37 +0000 (UTC)"  >This patch reflects the current state of:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/jchris/couchdb/tree/ddoc-qs&quot;&gt;http://github.com/jchris/couchdb/tree/ddoc-qs&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I plan to commit this code soon, so I&apos;m putting it in Jira to round out this ticket before I close it.&lt;br/&gt;
&lt;br/&gt;
There is a dev@ thread about the &amp;quot;ddoc protocol for query server&amp;quot; which discusses the change.</comment>
                    <comment id="12793698" author="jchris" created="Tue, 22 Dec 2009 18:06:22 +0000 (UTC)"  >this branch has been merged to trunk in r893249.&lt;br/&gt;
&lt;br/&gt;
if you implement an alternate query server that does more than map reduce, you should begin upgrading. query_server_spec.rb is the best resource for that.</comment>
                    <comment id="12805945" author="janl" created="Thu, 28 Jan 2010 15:15:27 +0000 (UTC)"  >This commit reverted r749852 (&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;revision=749852&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=749852&lt;/a&gt;). Why?&lt;br/&gt;
&lt;br/&gt;
I think 404 handling in _show functions is useful.</comment>
                    <comment id="12806005" author="jchris" created="Thu, 28 Jan 2010 18:02:43 +0000 (UTC)"  >The problem with executing the _show function even when there is no document with the corresponding ID, is that unless users code for the potential that doc is null, they will likely raise an (expensive, uncacheable) 500 error, instead of a hand-crafting a 404.&lt;br/&gt;
&lt;br/&gt;
I understand there are apps that want to handle the 404 in the show.&lt;br/&gt;
&lt;br/&gt;
Maybe this needs to be an option -- it&apos;s a nasty surprise to have a null doc for 80% of users, and a necessity to handle 404s in a custom way for the other 20%</comment>
                </comments>
    
    <attachments>
            <attachment id="12428595" name="ddoc_qs.patch" size="136834" author="jchris" created="Mon, 21 Dec 2009 03:55:37 +0000 (UTC)" />
            <attachment id="12426714" name="design_handlers.patch" size="34371" author="jchris" created="Wed, 2 Dec 2009 23:35:42 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 3 Dec 2009 00:37:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-588] don&apos;t make log noise when an OS process chooses to terminate normally</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-588</link>

                    <description>If an &amp;quot;os process&amp;quot; itself chooses to terminate normally (ie, with an exit code of zero), couchdb logs a fair bit of noise, including a stack-trace.  This noise can cause well-meaning users to report a bug when infact the exit was expected.  This is particularly useful for &amp;quot;externals&amp;quot; - if the implementation of the external changes, it can decide to terminate normally so the next request causes the new implementation to be picked up.&lt;br/&gt;
&lt;br/&gt;
The attached patch causes an OS process terminating with a non-zero exit code to be treated as before (ie, lots of log information written) while an exit code of zero emits a couple of &amp;quot;info&amp;quot; records about the termination with no stack-traces etc.&lt;br/&gt;
&lt;br/&gt;
Assigning to Adam for review - please assign back if it looks OK and I&apos;ll check it in (and thanks for your pointers - they helped immensely)</description>
                <environment></environment>
            <key id="12442197">COUCHDB-588</key>
        <summary>don&apos;t make log noise when an OS process chooses to terminate normally</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="mhammond">Mark Hammond</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Wed, 2 Dec 2009 08:55:16 +0000 (UTC)</created>
    <updated>Wed, 2 Dec 2009 21:45:26 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12784883" author="kocolosk" created="Wed, 2 Dec 2009 16:02:27 +0000 (UTC)"  >Hi Mark, looks good to me.  Thanks!</comment>
                    <comment id="12785015" author="mhammond" created="Wed, 2 Dec 2009 21:45:26 +0000 (UTC)"  >Thanks!  Checked in as  r886319.</comment>
                </comments>
    
    <attachments>
            <attachment id="12426645" name="bug-588.patch" size="2613" author="mhammond" created="Wed, 2 Dec 2009 08:56:10 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Dec 2009 21:45:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Dec 2009 16:02:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-587] provide peer port information to externals</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-587</link>

                    <description>When requests are made to an external, couch DB provides a &apos;peer&apos; item in the request info with the address of the couchdb instance (eg, 127.0.0.1).  CouchDB should also provide the port on this address, so externals can reliably make requests back to couch.&lt;br/&gt;
&lt;br/&gt;
The comments in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-393&quot; title=&quot;Cannot discover currently running http port if ini file specifies port 0&quot;&gt;COUCHDB-393&lt;/a&gt; imply this might not be trivial.</description>
                <environment></environment>
            <key id="12442054">COUCHDB-587</key>
        <summary>provide peer port information to externals</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Tue, 1 Dec 2009 06:20:53 +0000 (UTC)</created>
    <updated>Tue, 1 Dec 2009 06:28:52 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12784082" author="paul.joseph.davis" created="Tue, 1 Dec 2009 06:26:17 +0000 (UTC)"  >I think the &amp;quot;external script&amp;quot; refernece in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-393&quot; title=&quot;Cannot discover currently running http port if ini file specifies port 0&quot;&gt;COUCHDB-393&lt;/a&gt; is misleading. That was meant as &amp;quot;a script not under CouchDB&apos;s control.&amp;quot; Passing port info along to the _external handlers should be cake. There should be an example of grabbing that port info in couch_httpd.erl somewhere after the loop starts as it writes that to the log.&lt;br/&gt;
&lt;br/&gt;
Also 393 would&apos;ve been trivial had a -S option not been vetoed.</comment>
                    <comment id="12784083" author="mhammond" created="Tue, 1 Dec 2009 06:28:52 +0000 (UTC)"  >Oh sorry - I misunderstood the comments in 393 to imply couchdb doesn&apos;t actually *know* the port anywhere convenient.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 1 Dec 2009 06:26:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-586] POSTing to reduce _view or map _list ignores Keys when generating ETag</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-586</link>

                    <description></description>
                <environment></environment>
            <key id="12441978">COUCHDB-586</key>
        <summary>POSTing to reduce _view or map _list ignores Keys when generating ETag</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 30 Nov 2009 18:09:17 +0000 (UTC)</created>
    <updated>Mon, 30 Nov 2009 18:35:08 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12783779" author="kocolosk" created="Mon, 30 Nov 2009 18:35:08 +0000 (UTC)"  >Fixed in r885529</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 30 Nov 2009 18:35:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-585] couchdb 0.10.0 with erlang 12b does not properly support replication from https:// couchdb</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-585</link>

                    <description>While trying to get desktopcouch sync to work with ubuntuone, I ran into a problem.&lt;br/&gt;
&lt;br/&gt;
After lots of debugging, and trying manual replication requests with curl, it seems that:&lt;br/&gt;
&lt;br/&gt;
- pushing (replicating a local db to &lt;a href=&quot;https://couchdb.one.ubuntu.com/)&quot;&gt;https://couchdb.one.ubuntu.com/)&lt;/a&gt; works fine&lt;br/&gt;
- pulling (replicating a remote db on &lt;a href=&quot;https://couchdb.one.ubuntu.com/)&quot;&gt;https://couchdb.one.ubuntu.com/)&lt;/a&gt; fails&lt;br/&gt;
&lt;br/&gt;
I managed to reproduce this on a &apos;standard&apos; couchdb run from the 0.10.x branch&lt;br/&gt;
&lt;br/&gt;
Here is the log on a pull request:&lt;br/&gt;
&lt;br/&gt;
[debug] [&amp;lt;0.59.0&amp;gt;] &apos;POST&apos; /_replicate {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Authorization&apos;,&amp;quot;Basic dGhvbWFzOnBhc3M=&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;328&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;otto:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;curl/7.19.6 (x86_64-redhat-linux-gnu) libcurl/7.19.6 NSS/3.12.4.1 Beta zlib/1.2.3 libidn/1.9 libssh2/1.0&amp;quot;}]&lt;br/&gt;
[debug] [&amp;lt;0.59.0&amp;gt;] OAuth Params: []&lt;br/&gt;
[debug] [&amp;lt;0.68.0&amp;gt;] didn&apos;t find a replication log for &lt;a href=&quot;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&quot;&gt;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&lt;/a&gt;&lt;br/&gt;
[debug] [&amp;lt;0.68.0&amp;gt;] didn&apos;t find a replication log for contacts&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 0.5 seconds due to {error, conn_failed}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 1.0 seconds due to {error, worker_is_dead}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 2.0 seconds due to {error, conn_failed}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 4.0 seconds due to {error, worker_is_dead}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 8.0 seconds due to {error, conn_failed}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 16.0 seconds due to {error, worker_is_dead}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 32.0 seconds due to {error, conn_failed}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 64.0 seconds due to {error, worker_is_dead}&lt;br/&gt;
[debug] [&amp;lt;0.86.0&amp;gt;] retrying couch_rep_httpc get request in 128.0 seconds due to {error, conn_failed}&lt;br/&gt;
^C&lt;br/&gt;
&lt;br/&gt;
(this typically goes on up to 512 seconds, at which time it finally gives up; meanwhile the curl POST request hangs)&lt;br/&gt;
&lt;br/&gt;
To nail down the problem further, I then rebuilt Fedora 12&apos;s erlang package (which has 0.13b instead of 0.12b) and tried exactly the same; see the log:&lt;br/&gt;
&lt;br/&gt;
[&lt;a href=&apos;mailto:thomas@otto&apos;&gt;thomas@otto&lt;/a&gt; 0.10.x]$ utils/run &lt;br/&gt;
Apache CouchDB 0.10.0 (LogLevel=debug) is starting.&lt;br/&gt;
Configuration Settings [&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/etc/couchdb/default_dev.ini&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/etc/couchdb/local_dev.ini&amp;quot;]:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[admins] thomas=&amp;quot;-hashed-9d17d1c1b6968c2d1cd7e71c24c831b563b3974f,e613da727f909f1aa2a5fd0080ad9a06&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couch_httpd_auth] authentication_db=&amp;quot;users&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couch_httpd_auth] require_valid_user=&amp;quot;false&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couch_httpd_auth] secret=&amp;quot;replace this with a real secret in your local.ini file&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] batch_save_interval=&amp;quot;1000&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] batch_save_size=&amp;quot;1000&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] database_dir=&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/tmp/lib&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] delayed_commits=&amp;quot;true&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] max_attachment_chunk_size=&amp;quot;4294967296&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] max_dbs_open=&amp;quot;100&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] max_document_size=&amp;quot;4294967296&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] os_process_timeout=&amp;quot;5000&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] util_driver_dir=&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/src/couchdb/.libs&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] view_index_dir=&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/tmp/lib&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] batch_save=&amp;quot;{couch_batch_save_sup, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] db_update_notifier=&amp;quot;{couch_db_update_notifier_sup, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] external_manager=&amp;quot;{couch_external_manager, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] httpd=&amp;quot;{couch_httpd, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] query_servers=&amp;quot;{couch_query_servers, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] stats_aggregator=&amp;quot;{couch_stats_aggregator, start, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] stats_collector=&amp;quot;{couch_stats_collector, start, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] view_manager=&amp;quot;{couch_view, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] WWW-Authenticate=&amp;quot;Basic realm=\&amp;quot;administrator\&amp;quot;&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] authentication_handlers=&amp;quot;{couch_httpd_oauth, oauth_authentication_handler}, {couch_httpd_auth, default_authentication_handler}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] bind_address=&amp;quot;0.0.0.0&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] default_handler=&amp;quot;{couch_httpd_db, handle_request}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] port=&amp;quot;5984&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _changes=&amp;quot;{couch_httpd_db, handle_changes_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _compact=&amp;quot;{couch_httpd_db, handle_compact_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _design=&amp;quot;{couch_httpd_db, handle_design_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _temp_view=&amp;quot;{couch_httpd_view, handle_temp_view_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _view=&amp;quot;{couch_httpd_view, handle_db_view_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _view_cleanup=&amp;quot;{couch_httpd_db, handle_view_cleanup_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _info=&amp;quot;{couch_httpd_db,   handle_design_info_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _list=&amp;quot;{couch_httpd_show, handle_view_list_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _show=&amp;quot;{couch_httpd_show, handle_doc_show_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _update=&amp;quot;{couch_httpd_show, handle_doc_update_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _view=&amp;quot;{couch_httpd_view, handle_view_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] /=&amp;quot;{couch_httpd_misc_handlers, handle_welcome_req, &amp;lt;&amp;lt;\&amp;quot;Welcome\&amp;quot;&amp;gt;&amp;gt;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _active_tasks=&amp;quot;{couch_httpd_misc_handlers, handle_task_status_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _all_dbs=&amp;quot;{couch_httpd_misc_handlers, handle_all_dbs_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _config=&amp;quot;{couch_httpd_misc_handlers, handle_config_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _log=&amp;quot;{couch_httpd_misc_handlers, handle_log_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _oauth=&amp;quot;{couch_httpd_oauth, handle_oauth_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _replicate=&amp;quot;{couch_httpd_misc_handlers, handle_replicate_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _restart=&amp;quot;{couch_httpd_misc_handlers, handle_restart_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _session=&amp;quot;{couch_httpd_auth, handle_session_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _sleep=&amp;quot;{couch_httpd_misc_handlers, handle_sleep_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _stats=&amp;quot;{couch_httpd_stats_handlers, handle_stats_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _user=&amp;quot;{couch_httpd_auth, handle_user_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _utils=&amp;quot;{couch_httpd_misc_handlers, handle_utils_dir_req, \&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/share/www\&amp;quot;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _uuids=&amp;quot;{couch_httpd_misc_handlers, handle_uuids_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] favicon.ico=&amp;quot;{couch_httpd_misc_handlers, handle_favicon_req, \&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/share/www\&amp;quot;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[log] file=&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/tmp/log/couch.log&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[log] level=&amp;quot;debug&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[query_server_config] reduce_limit=&amp;quot;true&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[query_servers] javascript=&amp;quot;/home/thomas/tmp/couchdb/couchdb/branches/0.10.x/bin/couchjs_dev /home/thomas/tmp/couchdb/couchdb/branches/0.10.x/share/server/main.js&amp;quot;&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
[info] [&amp;lt;0.1.0&amp;gt;] Apache CouchDB has started on &lt;a href=&quot;http://0.0.0.0:5984/&quot;&gt;http://0.0.0.0:5984/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[debug] [&amp;lt;0.63.0&amp;gt;] &apos;POST&apos; /_replicate {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Authorization&apos;,&amp;quot;Basic dGhvbWFzOnBhc3M=&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;328&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;otto:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;curl/7.19.6 (x86_64-redhat-linux-gnu) libcurl/7.19.6 NSS/3.12.4.1 Beta zlib/1.2.3 libidn/1.9 libssh2/1.0&amp;quot;}]&lt;br/&gt;
[debug] [&amp;lt;0.63.0&amp;gt;] OAuth Params: []&lt;br/&gt;
[debug] [&amp;lt;0.70.0&amp;gt;] didn&apos;t find a replication log for &lt;a href=&quot;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&quot;&gt;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&lt;/a&gt;&lt;br/&gt;
[debug] [&amp;lt;0.70.0&amp;gt;] didn&apos;t find a replication log for contacts&lt;br/&gt;
[info] [&amp;lt;0.88.0&amp;gt;] source doesn&apos;t have _changes, trying _all_docs_by_seq&lt;br/&gt;
[debug] [&amp;lt;0.88.0&amp;gt;] unexpected message at changes_feed {ibrowse_async_response,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1259,582920,243218},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,closing_on_request}}&lt;br/&gt;
[debug] [&amp;lt;0.88.0&amp;gt;] unexpected message at changes_feed {&apos;EXIT&apos;,&amp;lt;0.89.0&amp;gt;,normal}&lt;br/&gt;
[info] [&amp;lt;0.63.0&amp;gt;] starting new replication &amp;quot;743520107dc25678800df59476e4140b&amp;quot; at &amp;lt;0.70.0&amp;gt;&lt;br/&gt;
[debug] [&amp;lt;0.49.0&amp;gt;] New task status for 743520: &lt;a href=&quot;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&quot;&gt;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&lt;/a&gt; -&amp;gt; contacts: W Processed source update #1&lt;br/&gt;
[debug] [&amp;lt;0.49.0&amp;gt;] New task status for 743520: &lt;a href=&quot;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&quot;&gt;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&lt;/a&gt; -&amp;gt; contacts: W Processed source update #6&lt;br/&gt;
[info] [&amp;lt;0.70.0&amp;gt;] recording a checkpoint at source update_seq 6&lt;br/&gt;
[debug] [&amp;lt;0.70.0&amp;gt;] replication doesn&apos;t need a full commit&lt;br/&gt;
[debug] [&amp;lt;0.49.0&amp;gt;] New task status for 743520: &lt;a href=&quot;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&quot;&gt;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&lt;/a&gt; -&amp;gt; contacts: Finishing&lt;br/&gt;
[info] [&amp;lt;0.63.0&amp;gt;] 192.168.1.12 - - &apos;POST&apos; /_replicate 200&lt;br/&gt;
[debug] [&amp;lt;0.69.0&amp;gt;] &apos;GET&apos; /_utils/database.html?contacts {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Charset&apos;,&amp;quot;ISO-8859-1,utf-8;q=0.7,*;q=0.7&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip,deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Language&apos;,&amp;quot;en-us,nl-be;q=0.8,en;q=0.6,ca;q=0.4,es;q=0.2&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cache-Control&apos;,&amp;quot;max-age=0&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;keep-alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cookie&apos;,&amp;quot;recent=contacts%2Cnotes%2Cgtd%2Cmanagement%2Cbookmarks%2C; management.view=_design/paired_servers/_view/paired_servers&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;If-Modified-Since&apos;,&amp;quot;Fri, 23 Oct 2009 19:42:00 GMT&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Keep-Alive&apos;,&amp;quot;300&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Referer&apos;,&amp;quot;&lt;a href=&quot;http://localhost:5984/_utils/index.html&quot;&gt;http://localhost:5984/_utils/index.html&lt;/a&gt;&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.1.5) Gecko/20091105 Fedora/3.5.5-1.fc11 Firefox/3.5.5&amp;quot;}]&lt;br/&gt;
[debug] [&amp;lt;0.69.0&amp;gt;] OAuth Params: [{&amp;quot;contacts&amp;quot;,[]}]&lt;br/&gt;
[info] [&amp;lt;0.69.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /_utils/database.html?contacts 304&lt;br/&gt;
&lt;br/&gt;
This time it did work.&lt;br/&gt;
&lt;br/&gt;
My conclusion is that for this feature to work, couchdb needs erlang 0.13b&lt;br/&gt;
&lt;br/&gt;
With erlang 0.12b, it fails non-intuitively and there is no way for desktopcouch to figure out that erlang has a bug internally.</description>
                <environment>Fedora 11, couchdb 0.10.0, erlang 0.12b</environment>
            <key id="12441952">COUCHDB-585</key>
        <summary>couchdb 0.10.0 with erlang 12b does not properly support replication from https:// couchdb</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thomasvs">Thomas Vander Stichele</reporter>
            
    <created>Mon, 30 Nov 2009 12:18:02 +0000 (UTC)</created>
    <updated>Mon, 30 Nov 2009 15:37:55 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12783655" author="kocolosk" created="Mon, 30 Nov 2009 13:41:27 +0000 (UTC)"  >Hi Thomas, what release of R12B were you running?  CouchDB requires the latest one, R12B-5.</comment>
                    <comment id="12783659" author="thomasvs" created="Mon, 30 Nov 2009 13:49:27 +0000 (UTC)"  >Hi Adam,&lt;br/&gt;
&lt;br/&gt;
from rpm&apos;s database:&lt;br/&gt;
[&lt;a href=&apos;mailto:thomas@level&apos;&gt;thomas@level&lt;/a&gt; ~]$ rpm -qi erlang&lt;br/&gt;
Name        : erlang                       Relocations: (not relocatable)&lt;br/&gt;
Version     : R12B                              Vendor: Fedora Project&lt;br/&gt;
Release     : 5.7.fc11                      Build Date: Tue 21 Apr 2009 08:10:00 PM CEST&lt;br/&gt;
Install Date: Mon 02 Nov 2009 04:51:28 PM CET      Build Host: xenbuilder2.fedora.redhat.com&lt;br/&gt;
Group       : Development/Languages         Source RPM: erlang-R12B-5.7.fc11.src.rpm&lt;br/&gt;
Size        : 96568283                         License: ERPL&lt;br/&gt;
Signature   : RSA/8, Wed 22 Apr 2009 08:09:53 PM CEST, Key ID 1dc5c758d22e77f2&lt;br/&gt;
Packager    : Fedora Project&lt;br/&gt;
URL         : &lt;a href=&quot;http://www.erlang.org&quot;&gt;http://www.erlang.org&lt;/a&gt;&lt;br/&gt;
Summary     : General-purpose programming language and runtime environment&lt;br/&gt;
Description :&lt;br/&gt;
Erlang is a general-purpose programming language and runtime&lt;br/&gt;
environment. Erlang has built-in support for concurrency, distribution&lt;br/&gt;
and fault tolerance. Erlang is used in several large telecommunication&lt;br/&gt;
systems from Ericsson.&lt;br/&gt;
&lt;br/&gt;
[&lt;a href=&apos;mailto:thomas@level&apos;&gt;thomas@level&lt;/a&gt; ~]$ rpm -q --changelog erlang&lt;br/&gt;
* Tue Apr 21 2009 Debarshi Ray &amp;lt;&lt;a href=&apos;mailto:rishi@fedoraproject.org&apos;&gt;rishi@fedoraproject.org&lt;/a&gt;&amp;gt; R12B-5.7&lt;br/&gt;
- Updated rpath patch.&lt;br/&gt;
- Fixed configure to respect $RPM_OPT_FLAGS.&lt;br/&gt;
&lt;br/&gt;
* Sun Mar 01 2009 Gerard Milmeister &amp;lt;&lt;a href=&apos;mailto:gemi@bluewin.ch&apos;&gt;gemi@bluewin.ch&lt;/a&gt;&amp;gt; - R12B-5.6&lt;br/&gt;
- new release R12B-5&lt;br/&gt;
- link escript and dialyzer to /usr/bin&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
So it looks like I am running the version required.&lt;br/&gt;
</comment>
                    <comment id="12783686" author="kocolosk" created="Mon, 30 Nov 2009 15:09:38 +0000 (UTC)"  >Thanks, Thomas.  The curious thing is that your R12B-5 attempt was able to make one successful request using SSL to ubuntuone, as indicated by the message&lt;br/&gt;
&lt;br/&gt;
[debug] [&amp;lt;0.68.0&amp;gt;] didn&apos;t find a replication log for &lt;a href=&quot;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&quot;&gt;https://couchdb.one.ubuntu.com/u%2F0a4%2F330%2F97870%2Fcontacts/&lt;/a&gt; &lt;br/&gt;
&lt;br/&gt;
So the SSL/R12B-5 combo isn&apos;t totally busted.  But then the next request for _changes (which uses a new connection and tries to stream the response body) fails at the connection stage.  Curious.  I&apos;ll be working to reproduce this when I have the time.</comment>
                    <comment id="12783700" author="kocolosk" created="Mon, 30 Nov 2009 15:37:55 +0000 (UTC)"  >Hi Thomas, I believe Fedora 12 has R13B01 (correct me if I&apos;m wrong).  I had a look at changelog for the Erlang ssl app (&lt;a href=&quot;http://erlang.org/download/otp_src_R13B01.readme&quot;&gt;http://erlang.org/download/otp_src_R13B01.readme&lt;/a&gt;) and found the rather ominous&lt;br/&gt;
&lt;br/&gt;
&amp;gt; OTP-8011  Packet handling was not implemented correctly.&lt;br/&gt;
&lt;br/&gt;
If you&apos;re interested in doing some debugging, can you try using the R12B5 emulator but the ssl app from R13B01?  You could do this any number of ways, for instance by copying the ssl-3.10.3 directory from the R13B install into the erlang/lib directory for CouchDB.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 30 Nov 2009 13:41:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-584] Remote Replication with HTTP Auth fails on design docs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-584</link>

                    <description>I try to replicate a database with design documents. It fails on it. Here&apos;s the log from the server&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.4462.0&amp;gt;] 195.226.16.50 - - &apos;GET&apos; /mydatabase/_changes?style=all_docs&amp;amp;heartbeat=true&amp;amp;since=0&amp;amp;feed=normal 200&lt;br/&gt;
[info] [&amp;lt;0.4463.0&amp;gt;] 195.226.16.50 - - &apos;GET&apos; /mydatabase/_design%2Fmydesign?open_revs=[&amp;quot;3-ce4179d8efd6132c211d95e858619051&amp;quot;]&amp;amp;revs=true&amp;amp;latest=true 301&lt;br/&gt;
[info] [&amp;lt;0.4465.0&amp;gt;] 195.226.16.50 - - &apos;GET&apos; /mydatabase/_design/mydesign?open_revs=[&amp;quot;3-ce4179d8efd6132c211d95e858619051&amp;quot;]&amp;amp;revs=true&amp;amp;latest=true_design%2Fmydesign?open_revs=[&amp;quot;3-ce4179d8efd6132c211d95e858619051&amp;quot;]&amp;amp;revs=true&amp;amp;latest=true 401&lt;br/&gt;
&lt;br/&gt;
Looks like the redirect doesn&apos;t  send the auth parameters on the second attempt (and the URL looks fishy too, but it works from the browser with the correct auth parameters)&lt;br/&gt;
&lt;br/&gt;
I start the replication with&lt;br/&gt;
&lt;br/&gt;
curl -X POST &lt;a href=&quot;http://127.0.0.1:5984/_replicate&quot;&gt;http://127.0.0.1:5984/_replicate&lt;/a&gt;   -d &apos;{&amp;quot;source&amp;quot;:&amp;quot;&lt;a href=&quot;http://admin:*****@example.org:5984/mydatabase/&quot;&gt;http://admin:*****@example.org:5984/mydatabase/&lt;/a&gt;&amp;quot;, &amp;quot;target&amp;quot;:&amp;quot;mydatabase_rep&amp;quot;}&apos;&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12441931">COUCHDB-584</key>
        <summary>Remote Replication with HTTP Auth fails on design docs</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="chregu">Christian Stocker</reporter>
            
    <created>Mon, 30 Nov 2009 09:49:26 +0000 (UTC)</created>
    <updated>Mon, 30 Nov 2009 19:45:47 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12783755" author="kocolosk" created="Mon, 30 Nov 2009 17:31:01 +0000 (UTC)"  >Thanks, Christian.  The bit with the mangled query-string parameters on the redirection is fixed in 0.10.1, but I think I now see the problem with the credentials.  The replicator simply follows the URL in the Location response header, and that URL won&apos;t include the auth info.  Patching this will require the replicator to decode &lt;a href=&quot;http://user:&quot;&gt;http://user:&lt;/a&gt;&lt;a href=&apos;mailto:pass@host&apos;&gt;pass@host&lt;/a&gt;:port URLs instead of relying on the ibrowse HTTP client library to do that for us.&lt;br/&gt;
&lt;br/&gt;
A temporary workaround would be to construct the Authorization header yourself and include that in the POST to _replicate, for example&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;source&amp;quot;:{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;url&amp;quot;:&amp;quot;&lt;a href=&quot;http://example.org:5984/mydatabase&quot;&gt;http://example.org:5984/mydatabase&lt;/a&gt;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;headers&amp;quot;:{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Authorization&amp;quot;:&amp;quot;Basic ...=&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;target&amp;quot;:&amp;quot;mydatabase_rep&amp;quot;&lt;br/&gt;
}&lt;br/&gt;
</comment>
                    <comment id="12783816" author="chregu" created="Mon, 30 Nov 2009 19:45:47 +0000 (UTC)"  >Thanks for the prompt answer. The workaround with the header parameter seems to work.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 30 Nov 2009 17:31:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-583] storing attachments in compressed form and serving them in compressed form if accepted by the client</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-583</link>

                    <description>This feature allows Couch to gzip compress attachments as they are being received and store them in compressed form.&lt;br/&gt;
&lt;br/&gt;
When a client asks for downloading an attachment (e.g. GET somedb/somedoc/attachment.txt), the attachment is sent in compressed form if the client&apos;s http request has gzip specified as a valid transfer encoding for the response (using the http header &amp;quot;Accept-Encoding&amp;quot;). Otherwise couch decompresses the attachment before sending it back to the client.&lt;br/&gt;
&lt;br/&gt;
Attachments are compressed only if their MIME type matches one of those listed in a separate config file. Compression level is also configurable in the default.ini file.&lt;br/&gt;
&lt;br/&gt;
This follows Damien&apos;s suggestion from 30 November:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Perhaps we need a separate user editable ini file to specify compressable or non-compressable files (would probably be too big for the regular ini file). What do other web servers do?&lt;br/&gt;
&lt;br/&gt;
Also, a potential optimization is to compress the file while writing to disk, and serve the compressed bytes directly to clients that can handle it, and decompressed for those that can&apos;t. For compressable types, it&apos;s a win for both disk IO for reads and writes, and CPU on read.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Patch attached.</description>
                <environment>CouchDB trunk</environment>
            <key id="12441889">COUCHDB-583</key>
        <summary>storing attachments in compressed form and serving them in compressed form if accepted by the client</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="fdmanana">Filipe Manana</reporter>
            
    <created>Sun, 29 Nov 2009 15:42:27 +0000 (UTC)</created>
    <updated>Fri, 29 Jan 2010 22:44:00 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12783415" author="fdmanana" created="Sun, 29 Nov 2009 15:47:07 +0000 (UTC)"  >This patch also fixes a potential issue in Mochiweb.&lt;br/&gt;
&lt;br/&gt;
mochiweb_response:write_chunk/1 has a potential problem when the given chunk contains itself a chunk separator (CRLF). This patch splits the chunk into &amp;quot;subchunks&amp;quot; if necessary.&lt;br/&gt;
&lt;br/&gt;
Feedback on this is welcome.&lt;br/&gt;
&lt;br/&gt;
best regards,&lt;br/&gt;
Filipe Manana</comment>
                    <comment id="12783418" author="tisba" created="Sun, 29 Nov 2009 16:07:37 +0000 (UTC)"  >One question:&lt;br/&gt;
&lt;br/&gt;
Why not use Content-Encoding Headers? or is there a particular reason to expose this to the GET-request? see &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3&lt;/a&gt;</comment>
                    <comment id="12783419" author="fdmanana" created="Sun, 29 Nov 2009 16:09:38 +0000 (UTC)"  >Just fixed some misspelled words and bad sentences in the comments :)</comment>
                    <comment id="12783423" author="kocolosk" created="Sun, 29 Nov 2009 16:24:53 +0000 (UTC)"  >I second Sebastian on this -- Accept-Encoding is probably the right way for the client to indicate a preference that the response be compressed/gzipped.</comment>
                    <comment id="12783453" author="paul.joseph.davis" created="Sun, 29 Nov 2009 19:19:18 +0000 (UTC)"  >Filipe,&lt;br/&gt;
&lt;br/&gt;
Good work once again, this is another vote for the accept-encoding. Also, your comment on the necessary evil of buffering responses to send a content-length after compression is in conflict with the HTTP spec:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.4&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.4&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
2.If a Transfer-Encoding header field (section 14.41) is present and has any value other than &amp;quot;identity&amp;quot;, then the transfer-length is defined by use of the &amp;quot;chunked&amp;quot; transfer-coding (section 3.6), unless the message is terminated by closing the connection.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12783456" author="paul.joseph.davis" created="Sun, 29 Nov 2009 19:35:21 +0000 (UTC)"  >Oh, and reading the next bullet point makes things more explicit:&lt;br/&gt;
&lt;br/&gt;
The Content-Length header field MUST NOT be sent if these two lengths are different (i.e., if a Transfer-Encoding header field is present). If a message is received with both a Transfer-Encoding header field and a Content-Length header field, the latter MUST be ignored.</comment>
                    <comment id="12783469" author="fdmanana" created="Sun, 29 Nov 2009 20:35:04 +0000 (UTC)"  >Alright,&lt;br/&gt;
&lt;br/&gt;
I&apos;ll be working on it (Accept-Encoding header).&lt;br/&gt;
&lt;br/&gt;
I must admit I was not familiar with those sections of the http 1.1 rfc.&lt;br/&gt;
&lt;br/&gt;
:)&lt;br/&gt;
&lt;br/&gt;
thanks for your feedback.&lt;br/&gt;
</comment>
                    <comment id="12783495" author="grempe" created="Sun, 29 Nov 2009 22:39:26 +0000 (UTC)"  >As a side note (this should probably be a discussion of its own though).  Has any thought been given to bolting WebMachine onto CouchDB as the primary HTTP interface?  I&apos;m not sure how difficult it would be to retrofit, or if there are use cases that would preclude this, but doing so would seem to eliminate a lot of uncertainty (and possible errors) in making sure that the complexities of HTTP are properly handled?&lt;br/&gt;
&lt;br/&gt;
I comment on it here since webmachine could in theory &apos;do the right thing&apos; regarding handling content encoding, HTTP response codes, etc.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://bitbucket.org/justin/webmachine/wiki/Home&quot;&gt;http://bitbucket.org/justin/webmachine/wiki/Home&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Just a thought.  I&apos;m curious if this has been discussed before.</comment>
                    <comment id="12783497" author="kocolosk" created="Sun, 29 Nov 2009 22:43:48 +0000 (UTC)"  >Yes, it&apos;s been discussed, although I&apos;m not aware of any efforts that have gone further than discussion.  I&apos;d be keen to try it out someday, but it&apos;s a lower-priority issue for me.</comment>
                    <comment id="12783498" author="paul.joseph.davis" created="Sun, 29 Nov 2009 22:49:08 +0000 (UTC)"  >As Adam says, discussion is about as far as things have gone. It would indeed be a very good fit for CouchDB.&lt;br/&gt;
&lt;br/&gt;
The last remaining issue though is how it does streaming of entity bodies. Right now it expects CouchDB to be able to have a call back mechanism which is a huge impedance mismatch for the control flow of iterating views.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve been working on a python port of webmachine the last couple days and as part I&apos;ve been trying to think how to patch webmachine to return a write-callable that could be passed to our streaming output. I haven&apos;t gone through the lower end bits of where its handling streaming output, but at the moment it looks like a fairly big patch to the body handling facilities in webmachine. If I get time I&apos;ll try and code a patch that doesn&apos;t affect the status quo, and then we can start to seriously think about tacking webmachine onto CouchDB.</comment>
                    <comment id="12783529" author="justinsheehy" created="Mon, 30 Nov 2009 03:58:17 +0000 (UTC)"  >If someone would like to point me at the relevant part of the CouchDB source that generates the view body (so that I can see the shape of the impedance mismatch) I&apos;d be happy to see if I can help.  I am only minimally familiar with the CouchDB sources, but might be able to suggest an approach that would fit well once I see the last remaining issue from your point of view.&lt;br/&gt;
&lt;br/&gt;
If you discuss it on couchdb-dev instead of here or the webmachine list, just CC me if you want me to notice as I don&apos;t always catch every thread there.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12783531" author="paul.joseph.davis" created="Mon, 30 Nov 2009 04:26:16 +0000 (UTC)"  >Justin,&lt;br/&gt;
&lt;br/&gt;
In a nutshell, the impedance mismatch is that webmachine wants to have control of the logic. Ie, webmachine wants a callable that it can call at its leisure. When CouchDB writes view output to a socket, its basically executing a lists:foldl style callback function. In terms of webmachine, this would be akin to a streaming body where webmachine provides a fun that CouchDB could call to write to the client socket.&lt;br/&gt;
&lt;br/&gt;
The relevant code is at [1]. Its not the most centralized, but that&apos;s the fold function defined that does the view output.&lt;br/&gt;
&lt;br/&gt;
I haven&apos;t quite pieced together how webmachine is streaming to the socket. I&apos;ve read the response handling code a few times and near as I can tell its not actually streaming the body over the socket, just consuming an iterator before charset and encoding functions are applied.&lt;br/&gt;
&lt;br/&gt;
Either way, bottom line is that to fit neatly into CouchDB code, webmachine would handle a response like {writer, fun Write/1} where the argument to the Write fun was a callable that writes bytes to the socket. The charset and transfer encodings would then be required to be streamable writers. Without that behavior the nearest thing I can think of would be to do alot of message passing to invert flow control which while possible seems ungood.&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://github.com/apache/couchdb/blob/trunk/src/couchdb/couch_httpd_view.erl#L390&quot;&gt;http://github.com/apache/couchdb/blob/trunk/src/couchdb/couch_httpd_view.erl#L390&lt;/a&gt;</comment>
                    <comment id="12783732" author="damienkatz" created="Mon, 30 Nov 2009 16:35:52 +0000 (UTC)"  >One problem I think I see with the patch is that we are compressing regardless of mime type. For already compressed files (image, music and video), it does nothing but add CPU overhead.&lt;br/&gt;
&lt;br/&gt;
Perhaps we need a separate user editable ini file to specify compressable or non-compressable files (would probably be too big for the regular ini file). What do other web servers do?&lt;br/&gt;
&lt;br/&gt;
Also, a potential optimization is to compress the file while writing to disk, and serve the compressed bytes directly to clients that can handle it, and decompressed for those that can&apos;t. For compressable types, it&apos;s a win for both disk IO for reads and writes, and CPU on read.</comment>
                    <comment id="12783744" author="fdmanana" created="Mon, 30 Nov 2009 17:07:35 +0000 (UTC)"  >Using a filter like mime type for deciding whether or not to store the attachments in the &amp;quot;gziped&amp;quot; form seems a good idea to me. mod_gzip has that kind of filter for deciding whether a response is gziped or not. An example of mod_gzip config:&lt;br/&gt;
&lt;br/&gt;
mod_gzip_item_include         mime       ^text/html$&lt;br/&gt;
mod_gzip_item_include         mime       ^text/plain$&lt;br/&gt;
mod_gzip_item_include         mime       ^httpd/unix-directory$&lt;br/&gt;
&lt;br/&gt;
I do like that approach, but since I am a newbie with Couch&apos;s code/implementation, I don&apos;t know if storing the attachments directly in gziped form will break anything else. couch_stream could compress attachment data when receiving it and write each compressed block to disk.&lt;br/&gt;
&lt;br/&gt;
Then, when requesting an attachment download, the client would have to send the header &amp;quot;Accept-Encoding: gzip&amp;quot; in order to get the compressed data. If it doesn&apos;t send that header, we would send him the attachment in the uncompressed form.&lt;br/&gt;
&lt;br/&gt;
I volunteer for implementing it if you agree. &lt;br/&gt;
&lt;br/&gt;
cheers&lt;br/&gt;
</comment>
                    <comment id="12787730" author="fdmanana" created="Tue, 8 Dec 2009 20:34:32 +0000 (UTC)"  >Hello,&lt;br/&gt;
&lt;br/&gt;
Here follows the patch implementing Damien&apos;s suggestion.&lt;br/&gt;
&lt;br/&gt;
A new key under the httpd section is added to the config file. Its value is the name of a file that lists which MIME types are worth compressing (text based types for e.g.).&lt;br/&gt;
&lt;br/&gt;
When an attachment is uploaded (using the standalone attachment API), if its type matches one of the MIME types listed in the former file, the attachment is stored with gzip compression.&lt;br/&gt;
&lt;br/&gt;
When a client requests the download of an attachment:&lt;br/&gt;
&lt;br/&gt;
1) if the HTTP request message has an Accept-Encoding header listing gzip as an acceptable response body encoding method, the attachment is sent unmodified to the client (in gzip form and in a chunked HTTP message)&lt;br/&gt;
&lt;br/&gt;
2) if the HTTP request doesn&apos;t include that header, or if it includes but it mentions gzip as not acceptable, the attachment is uncompressed (on the fly) and sent to the client (in a chunked HTTP response)&lt;br/&gt;
&lt;br/&gt;
An Etap test, covering 7 scenarios, is included.&lt;br/&gt;
Note that it breaks some other tests (for example, tests that upload a text attachment and then downloaded it to check its content). I&apos;ll fix those tests after your feedback. This is a preliminary version.&lt;br/&gt;
&lt;br/&gt;
Feedback (specially from the commiters) regarding the implementation is very welcome.&lt;br/&gt;
&lt;br/&gt;
cheers,&lt;br/&gt;
Filipe Manana (fdmanana)</comment>
                    <comment id="12788090" author="fdmanana" created="Wed, 9 Dec 2009 13:49:25 +0000 (UTC)"  >Forgot to mention that in point 1), couchdb sends the response with the header &amp;quot;Content-Encoding: gzip&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
For case 2) this header is missing (therefore the content encoding is identity - the attachment is sent in uncompressed form) if the request accepts identity encoding (either explicitly or by not having &amp;quot;*; q=0&amp;quot; or &amp;quot;identity; q=0&amp;quot; as part of the Accept-Encoding header value). Otherwise an HTTP error 406 is sent (as rfc 2616 recommends) - none of the specified encoding methods requested by the client are supported by the server.</comment>
                    <comment id="12792981" author="fdmanana" created="Sun, 20 Dec 2009 10:52:28 +0000 (UTC)"  >Here follows an updated patch.&lt;br/&gt;
&lt;br/&gt;
relatively to the previous one:&lt;br/&gt;
&lt;br/&gt;
+ works with ticket 558 (attachment upload md5 integrity check)&lt;br/&gt;
+ adds gzip compression level configuration option&lt;br/&gt;
+ no longer breaks 2 Etap tests and 2 JavaScript tests :)&lt;br/&gt;
&lt;br/&gt;
All tests, except for the Etap ICU test (which is broken for some other reason), are working with this patch.&lt;br/&gt;
Etap test included for the new feature is included.&lt;br/&gt;
&lt;br/&gt;
The feature of this patch seems to be the same that is requested in ticket 437 =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-437&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-437&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Feedback please&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12793147" author="fdmanana" created="Mon, 21 Dec 2009 10:36:35 +0000 (UTC)"  >Updated the Etap test suite to include 8 more tests that cover:&lt;br/&gt;
&lt;br/&gt;
+ attachment compression when using the non-standalone attachment upload API&lt;br/&gt;
+ attachment decompression when getting an attachment by getting its doc with &amp;quot;?attachments=true&amp;quot;&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12793438" author="fdmanana" created="Tue, 22 Dec 2009 00:35:17 +0000 (UTC)"  >Added httpd misc handler for uri _compressible_type/ and corrected misspelled word &amp;quot;compressable&amp;quot; to compressible.</comment>
                    <comment id="12793490" author="kocolosk" created="Tue, 22 Dec 2009 03:48:35 +0000 (UTC)"  >Hi Filipe, &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-437&quot; title=&quot;Make compression level configurable, and allow attachments to be compressed&quot;&gt;COUCHDB-437&lt;/a&gt; is more about compressing the documents on disk than it is the attachments.  To compress Erlang terms on disk, one only needs to replace&lt;br/&gt;
&lt;br/&gt;
term_to_binary(Term)&lt;br/&gt;
&lt;br/&gt;
with&lt;br/&gt;
&lt;br/&gt;
term_to_binary(Term, [compressed])&lt;br/&gt;
&lt;br/&gt;
The two issues are definitely linked, though.</comment>
                    <comment id="12793569" author="fdmanana" created="Tue, 22 Dec 2009 09:51:26 +0000 (UTC)"  >Hi Adam,&lt;br/&gt;
&lt;br/&gt;
I see. I am just thinking about how to do it without causing backward incompatibility.&lt;br/&gt;
&lt;br/&gt;
Currently couch_file:append_term[_md5]/2 calls term_to_binary and precedes it with a 32 bits header and an optional md5 digest. Then the 32bits header + optional term md5 + term_to_binary(Term) is appended to the end of the DB file. &lt;br/&gt;
&lt;br/&gt;
The high order bit of this header indicates whether an md5 hash follows the header (and preceding the serialized term).&lt;br/&gt;
Without looking deeply into the code, I think about adding an extra bit to the header which indicates if the term is compressed or not.&lt;br/&gt;
&lt;br/&gt;
Of course this implies adding a new DB header version value, etc. Not so straightforward as attachment compression.&lt;br/&gt;
&lt;br/&gt;
An (ugly) alternative I see is not adding a new header bit and when reading a serialized term from the DB file, always gunzip it and catch an exception:&lt;br/&gt;
&lt;br/&gt;
3&amp;gt; catch(zlib:gunzip(&amp;lt;&amp;lt;&amp;quot;hello world&amp;quot;&amp;gt;&amp;gt;)).&lt;br/&gt;
{&apos;EXIT&apos;,{data_error,[{zlib,call,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{zlib,inflate,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{zlib,gunzip,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{erl_eval,do_apply,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{erl_eval,expr,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shell,exprs,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shell,eval_exprs,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shell,eval_loop,3}]}}&lt;br/&gt;
&lt;br/&gt;
The issue is that the data_error exception might not mean that the data is not gzip compressed.&lt;br/&gt;
&lt;br/&gt;
If using an extra header bit, than why not add a few more bits that will be reserved for future features. A little bit like most protocol RFCs do, they reserve a few bits in an header for future usage :)&lt;br/&gt;
&lt;br/&gt;
What&apos;s your opinion?&lt;br/&gt;
&lt;br/&gt;
cheers&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12793593" author="paul.joseph.davis" created="Tue, 22 Dec 2009 12:01:55 +0000 (UTC)"  >@Filipe,&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Note that using non chunked compressed body responses requires&lt;br/&gt;
&amp;gt; storing all the compressed blocks in memory and then sending each&lt;br/&gt;
&amp;gt; one to the client. This is a necessary &amp;quot;evil&amp;quot;, as we only know the length&lt;br/&gt;
&amp;gt; of the compressed body after compressing all the body, and we need&lt;br/&gt;
&amp;gt; to set the &amp;quot;Content-Length&amp;quot; header for non chunked responses.&lt;br/&gt;
&lt;br/&gt;
You can&apos;t buffer attachments in RAM. That&apos;s just a no-no.&lt;br/&gt;
&lt;br/&gt;
Going back to the RFC, I don&apos;t really see a good place where it&apos;s spelled out what to do about Content-Encoding headers and their correspondence with Content-Length. I&apos;m fairly certain you&apos;ve got this backwards though. The Content-Length needs to be the number of bytes of gzip data used to represent the message body. Content-Length is used to delineate messages, so having them mismatched would be bad.&lt;br/&gt;
&lt;br/&gt;
Though, this does mean that you&apos;ll need to store the number of bytes before and after compression when you stream the attachment to disk.&lt;br/&gt;
&lt;br/&gt;
Also, the compression algorithm must be specified by the Accept-Encoding header, not a URL parameter.&lt;br/&gt;
&lt;br/&gt;
The &amp;quot;treshold_for_chunking_comp_responses&amp;quot; is a bit of a weird threshold. You might want to change that to something like &amp;quot;min_compression_length&amp;quot; and just have it say &amp;quot;files shorter than this will not be compressed&amp;quot;. And then leave the claims on chunked vs. not to the HTTP content negotiation algorithms.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll be out of town for the next couple weeks so forgive me if my responses are a tad slow.</comment>
                    <comment id="12793615" author="fdmanana" created="Tue, 22 Dec 2009 13:25:36 +0000 (UTC)"  >Paul,&lt;br/&gt;
&lt;br/&gt;
you&apos;re comments refer to the first 3 patches&apos; implementation. The 4th and latest follow Damien&apos;s idea (comment from the 30th November).&lt;br/&gt;
&lt;br/&gt;
Check the last patch:  	couchdb-583-trunk-6th-try.patch&lt;br/&gt;
&lt;br/&gt;
The approach is completely different. There&apos;s no use of the query parameter ?compression=(gzip|deflate) and no longer that block buffering thing for compression / decompression :) With the latest ones the attachment are compressed and stored in compressed form (if their mime type matches one of those in the config file).&lt;br/&gt;
&lt;br/&gt;
As soon as a data chunk is received from the client, it is compressed with a zlib stream and written to disk. Decompression follows the same idea - 1 block is read from the disk, compressed and a chunk sent to the client. No need to buffer things. I figured out how to use zlib for incremental gzip compression/decompression.&lt;br/&gt;
&lt;br/&gt;
The &amp;quot;reshold_for_chunking_comp_responses&amp;quot; is completely gone also. HTTP content-encoding is now negotiated.&lt;br/&gt;
&lt;br/&gt;
After analying the patch, let me know if the implementation is ok and how to simplify it further.&lt;br/&gt;
&lt;br/&gt;
cheers&lt;br/&gt;
</comment>
                    <comment id="12793674" author="fdmanana" created="Tue, 22 Dec 2009 17:05:45 +0000 (UTC)"  >7th patch. Does some code cleanup and avoids exporting 2 unnecessary functions.</comment>
                    <comment id="12797843" author="fdmanana" created="Fri, 8 Jan 2010 00:02:25 +0000 (UTC)"  >+ Updated patch to gracefully merge with the latest trunk revision.&lt;br/&gt;
&lt;br/&gt;
+ Fixed small regression where the value of the length field of an attachment stub was the length of the compressed form of the attachment&lt;br/&gt;
&lt;br/&gt;
+ simplified some of the attachment compression code</comment>
                    <comment id="12799482" author="fdmanana" created="Wed, 13 Jan 2010 00:09:17 +0000 (UTC)"  >9th patch&lt;br/&gt;
&lt;br/&gt;
+ simplified code in couch_httpd_db.erl (nested case expressions), thanks davidc_ for pointing the mess&lt;br/&gt;
+ gracefully merges with trunk svn rev 898552</comment>
                    <comment id="12799829" author="paul.joseph.davis" created="Wed, 13 Jan 2010 17:00:02 +0000 (UTC)"  >Just some quick thoughts reading through the diff:&lt;br/&gt;
&lt;br/&gt;
I&apos;m not a fan of the file containing a list of compressible types. There are too many types that will just make that configuration hard. Not to mention exposing an entirely new API endpoint to work with those types is also needlessly complex.&lt;br/&gt;
&lt;br/&gt;
I&apos;d prefer to see an automatic test trying to compress the first 4K or so of an attachment and use a heuristic to determine whether it compressed enough to justify compressing the entire attachment. If that&apos;s not doable, the compressible type system should be integrated into the current configuration mechanism.&lt;br/&gt;
&lt;br/&gt;
For testing from FireFox it might be best to expose a &amp;quot;attachment is stored in compressed form&amp;quot; attribute in the _attachments member.&lt;br/&gt;
&lt;br/&gt;
Passing around the &amp;lt;&amp;lt;&amp;quot;Y&amp;quot;&amp;gt;&amp;gt; and &amp;lt;&amp;lt;&amp;quot;N&amp;quot;&amp;gt;&amp;gt; binaries as a flag for an attachment being compressed is un-erlangy. true and false atoms would be better.&lt;br/&gt;
&lt;br/&gt;
Test code does not belong in couch_httpd.erl.&lt;br/&gt;
&lt;br/&gt;
Is there something I&apos;m missing on why we need to leak couch_util:gzip* functions into couch_httpd_db.erl instead of putting all of that logic into couch_stream.erl?&lt;br/&gt;
&lt;br/&gt;
Is there nothing in mochiweb to handle accept-encoding parsing?&lt;br/&gt;
&lt;br/&gt;
Instead of naming tests test1 -&amp;gt; test17 and comments above each test, just use a descriptive test name. It might help to group related tests as well so that tests are easier to find.&lt;br/&gt;
&lt;br/&gt;
Data in the etap tests shouldn&apos;t be stored inline when its that big. Create data files and use the test helpers to reference the filenames and read from disk.</comment>
                    <comment id="12799922" author="fdmanana" created="Wed, 13 Jan 2010 20:42:00 +0000 (UTC)"  >Hi Paul,&lt;br/&gt;
&lt;br/&gt;
thanks for you&apos;re feedback.&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Passing around the &amp;lt;&amp;lt;&amp;quot;Y&amp;quot;&amp;gt;&amp;gt; and &amp;lt;&amp;lt;&amp;quot;N&amp;quot;&amp;gt;&amp;gt; binaries as a flag for an attachment being compressed is un-erlangy. true and false atoms would be better. &amp;quot;&lt;br/&gt;
&lt;br/&gt;
Well, this was mostly because I read somewhere in Armstrong&apos;s book that binaries are preferred (more efficient) for IO operations (network, disk storage). But I agree, using true / false atoms is more readable.&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Is there nothing in mochiweb to handle accept-encoding parsing? &amp;quot;&lt;br/&gt;
&lt;br/&gt;
I don&apos;t think so, at least in the mochiweb included with couch. It&apos;s probably better to move this accept-encoding parsing functions, and the respective test functions, into the mochiweb sources.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll get back to work and enhance the patch following your remarks.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12799937" author="damienkatz" created="Wed, 13 Jan 2010 21:20:36 +0000 (UTC)"  >I haven&apos;t looked at the patch, but I agree with most of Paul comments, except for figuring out when to compress files. Lots of compressed files might have uncompressed headers in the file, leading to unnecessary compression. MP3s with id3v2 tags immediately come to mind.</comment>
                    <comment id="12799947" author="fdmanana" created="Wed, 13 Jan 2010 21:42:01 +0000 (UTC)"  >Hum, &lt;br/&gt;
&lt;br/&gt;
Lets open a votation :)&lt;br/&gt;
&lt;br/&gt;
1) use an heuristic, as suggested by Paul&lt;br/&gt;
&lt;br/&gt;
2) or a file listing the mime types worth compressing&lt;br/&gt;
&lt;br/&gt;
3) some other alternative?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12799948" author="paul.joseph.davis" created="Wed, 13 Jan 2010 21:44:21 +0000 (UTC)"  >Hrm, 4KiB of headers even? That is a good point though. But I&apos;d still be quite hesitant to make it a whitelist of of content types to compress. Unless maybe we allowed text/* or similar. Or perhaps is should be a blacklist that could do the * match?</comment>
                    <comment id="12801176" author="fdmanana" created="Sat, 16 Jan 2010 14:12:27 +0000 (UTC)"  >@Paul&lt;br/&gt;
&lt;br/&gt;
This patch uses the white list allowing * wildcards, so we can specify text/* as you suggested.&lt;br/&gt;
&lt;br/&gt;
I also followed your previous comments.&lt;br/&gt;
&lt;br/&gt;
Currently the decision of whether or not to compress an attachment is made by couch_db:with_stream/3, which passes the compression level to couch_stream. I&apos;m not sure what&apos;s the best place to take that decision. I also thought about being couch_stream the one who decides that, but that would imply dependency on couch_config. &lt;br/&gt;
&lt;br/&gt;
Later I&apos;ll submit a patch for mochiweb (for parsing the accept-encoding header).&lt;br/&gt;
&lt;br/&gt;
Let me know your opinions.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12801259" author="fdmanana" created="Sat, 16 Jan 2010 19:28:48 +0000 (UTC)"  >Just for the record, the patch submitted for mochiweb (Accept-Encoding header parsing) has just been accepted:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mochiweb/source/detail?r=133&quot;&gt;http://code.google.com/p/mochiweb/source/detail?r=133&lt;/a&gt;</comment>
                    <comment id="12801309" author="paul.joseph.davis" created="Sun, 17 Jan 2010 02:40:27 +0000 (UTC)"  >Awesome that the patch was accepted. With the other one that&apos;s probably enough reason to pull the latest mochiweb. Only glanced through the patch on my phone but it looks quite better. The config stuff is still too specific though. Is there something that requires a separate file? I was thinking that a multiline config value patch might be beneficial for this. &lt;br/&gt;
&lt;br/&gt;
I&apos;ll take a closer look when I get home but minus the config stuff I think this is gonna be pretty close to good. &lt;br/&gt;
&lt;br/&gt;
Also I&apos;m a bit concerned about the 0.9 upgrade code on terms of testing. I wonder if we can find a 0.9 db file to use in testing these sorts of things. &lt;br/&gt;
&lt;br/&gt;
Good work once again Filipe!</comment>
                    <comment id="12801337" author="fdmanana" created="Sun, 17 Jan 2010 07:26:59 +0000 (UTC)"  >Well, I went for the separate file because of 2 reasons:&lt;br/&gt;
&lt;br/&gt;
1) the list of mime types might be big (probably no longer valid as we can use the * wildcard)&lt;br/&gt;
&lt;br/&gt;
2) if by some reason we need to specify also Mime type parameters, the ini file is problematic since the semicolon character marks noth the beginning of mime parameters and it&apos;s also the start of comment for ini files&lt;br/&gt;
&lt;br/&gt;
Well, I haven&apos;t figured out why we might need mime parameters, so probably it&apos;s not a valid reason :)&lt;br/&gt;
&lt;br/&gt;
Having a 0.9 db file would be nice. I am not 100% sure if we need to provide more clauses of couch_doc:att_foldl_unzip to ressemble those of couch_doc:att_foldl for example :(&lt;br/&gt;
&lt;br/&gt;
Thanks Paul</comment>
                    <comment id="12801436" author="paul.joseph.davis" created="Sun, 17 Jan 2010 16:53:45 +0000 (UTC)"  >For the long list I think we should just patch the config parser to do the multiple line thing that most INI style configs have which will alleviate the concerns for length.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve never seen the list of content-negotiation types use media type parameters so I don&apos;t think that&apos;s a problem for the INI either.&lt;br/&gt;
&lt;br/&gt;
I don&apos;t think the 0.9 stuff is a blocker for this patch. Just musing that it would be nice for this patch and the other upgrade code because I don&apos;t think we explicitly test that stuff anywhere.</comment>
                    <comment id="12801916" author="fdmanana" created="Mon, 18 Jan 2010 19:34:40 +0000 (UTC)"  >@Paul&lt;br/&gt;
&lt;br/&gt;
This time the mime type expressions are listed in the .ini config file :)&lt;br/&gt;
&lt;br/&gt;
couch_httpd_misc_handlers.erl  had some small adaptations since the config.js test was failing after adding support for multi value .ini parameters.&lt;br/&gt;
&lt;br/&gt;
Let me know if this patch is fully ok.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12801974" author="fdmanana" created="Mon, 18 Jan 2010 22:03:41 +0000 (UTC)"  >@Paul&lt;br/&gt;
&lt;br/&gt;
Forget the previous patch, it added unneeded complexity for parsing and dealing with multivalue (line) ini file  config parameters.&lt;br/&gt;
&lt;br/&gt;
Let me know if everything seems ok.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12802420" author="fdmanana" created="Tue, 19 Jan 2010 18:57:26 +0000 (UTC)"  >Just removed a useless function in couch_config that I added previously.</comment>
                    <comment id="12803418" author="fdmanana" created="Thu, 21 Jan 2010 18:53:18 +0000 (UTC)"  >Sorry for yet another patch upload, but forgot to generate the previous one with the --binary option of &amp;quot;git diff&amp;quot;. The new binary file test/etap/test_140_file.png is necessary for the test case.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12804311" author="fdmanana" created="Sun, 24 Jan 2010 22:17:10 +0000 (UTC)"  >Just added a missing caseless option to the regexp match done in couch_util:compressible_att_type/1</comment>
                    <comment id="12804915" author="fdmanana" created="Tue, 26 Jan 2010 06:44:20 +0000 (UTC)"  >@Paul&lt;br/&gt;
&lt;br/&gt;
any news on this?</comment>
                    <comment id="12804917" author="paul.joseph.davis" created="Tue, 26 Jan 2010 06:46:01 +0000 (UTC)"  >Filipe,&lt;br/&gt;
&lt;br/&gt;
Sorry, got distracted by a weekend project. I&apos;ll try and do a thorough review tomorrow before the big news day on Wednesday.</comment>
                    <comment id="12804919" author="jchris" created="Tue, 26 Jan 2010 06:58:01 +0000 (UTC)"  >I haven&apos;t really been tuned into the full discussion of this patch -- I think the biggest questions for something that digs this deep into the file format are:&lt;br/&gt;
&lt;br/&gt;
How does it impact stability? (looks fine at my cursory glance, aside from cross compatibility with older versions of the file format, which I&apos;d have to look more closely at)&lt;br/&gt;
&lt;br/&gt;
What is the payoff? How much space does this save in practice? (say, with email messages as attachments, vs with pngs or minified js) I&apos;m not asking you to do all that work, just think that real numbers are a selling point.&lt;br/&gt;
&lt;br/&gt;
If it&apos;s a big payoff then this becomes a priority. We might also want to add options for compressing the views.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12804946" author="fdmanana" created="Tue, 26 Jan 2010 08:01:56 +0000 (UTC)"  >@Chris&lt;br/&gt;
&lt;br/&gt;
Good point, I totally agree.&lt;br/&gt;
It would be interesting to test with real couchapps, real data and see how worth it really is.&lt;br/&gt;
&lt;br/&gt;
A 10Mb text file, for instance, was compressed to about 100Kb in one of my tests.&lt;br/&gt;
&lt;br/&gt;
Also, as for the minified JavaScript files for example, it&apos;s still worth compressing them. For example, the minified Ext JS lib file (&lt;a href=&quot;http://www.extjs.com,&quot;&gt;http://www.extjs.com,&lt;/a&gt;  ext-all.js) is about 630Kb big. Compressed with gzip stays at about 170Kb, therefore a reasonably good size reduction.&lt;br/&gt;
&lt;br/&gt;
As Damien said in a previous comment, not only saves disk space but also reduces disk IO (attachment download requests, compaction).&lt;br/&gt;
&lt;br/&gt;
I also look forward to see the impact on real, production level, applications.</comment>
                    <comment id="12805379" author="jchris" created="Wed, 27 Jan 2010 06:16:27 +0000 (UTC)"  >I ran the etap test (don&apos;t forget to make it executable)&lt;br/&gt;
&lt;br/&gt;
And got this output:&lt;br/&gt;
&lt;br/&gt;
$ ./test/etap/run ./test/etap/140-attachment-comp.t &lt;br/&gt;
# Current time local 2010-01-26 21:57:12&lt;br/&gt;
# Using etap version &amp;quot;0.3.4&amp;quot;&lt;br/&gt;
1..57&lt;br/&gt;
Apache CouchDB 0.0.0 (LogLevel=info) is starting.&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
[info] [&amp;lt;0.2.0&amp;gt;] Apache CouchDB has started on &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
# Test died abnormally: {&apos;EXIT&apos;,{{badmatch,{error,enoent}},[{erl_eval,expr,3}]}}&lt;br/&gt;
[error] [&amp;lt;0.31.0&amp;gt;] {error_report,&amp;lt;0.23.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;{&amp;lt;0.31.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[[{initial_call,{etap,start_etap_server,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.31.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,etap_server},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{badarg,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{io,format,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.23.0&amp;gt;,&amp;quot;~s~n&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[66,97,105,108,32,111,117,116,33,32|&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;EXIT&apos;,{{badmatch,{error,enoent}},[{erl_eval,expr,3}]}}]]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{etap,test_server,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{io,o_request,3},{etap,test_server,1},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[&amp;lt;0.2.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[done]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,377},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,451}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
On the other hand, the Futon tests pass, and I browsed to an old database file and was able to load attachments from it so that&apos;s some good news.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12805383" author="jchris" created="Wed, 27 Jan 2010 06:48:42 +0000 (UTC)"  >Reading the the source code this looks solid. The only thing I&apos;m not in a position to understand just by reading and testing, is how this new code will interact with old files.&lt;br/&gt;
&lt;br/&gt;
I see references to backwards compatibility in the comments and some changes in the right parts of the code. I feel we are lacking a way to definitively test this.&lt;br/&gt;
&lt;br/&gt;
On the whole, I think this is good code and worth further review. Hopefully we&apos;ll be able to get it polished and in soon.</comment>
                    <comment id="12805410" author="fdmanana" created="Wed, 27 Jan 2010 08:21:17 +0000 (UTC)"  >@Chris,&lt;br/&gt;
&lt;br/&gt;
thanks for looking at it :)&lt;br/&gt;
&lt;br/&gt;
That&apos;s weird, in my machine I have no problems running the etap test.&lt;br/&gt;
I&apos;ll do a checkout of the latest revision (trunk) and re-run it.&lt;br/&gt;
&lt;br/&gt;
Or maybe (unlikely), you did not do a &amp;quot;git apply&amp;quot; with the --binary option?&lt;br/&gt;
&lt;br/&gt;
The stack trace seems to be related with a bad arg passed to io:format, which is strange. I just grepped the patch and there&apos;s no call to io:format there. Did you apply it to some local branch where you have io:format calls for debugging for instance? Or you applied a patch other than  couchdb-583-trunk-15th-try-git.patch&lt;br/&gt;
&lt;br/&gt;
I&apos;ll re-run it when I get home in the evening. I&apos;ll let you know something.&lt;br/&gt;
&lt;br/&gt;
@Paul have you runned the erap test and had the same problem as Chris?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12805468" author="fdmanana" created="Wed, 27 Jan 2010 10:57:14 +0000 (UTC)"  >@Chris&lt;br/&gt;
&lt;br/&gt;
just a quick thought. You invoked the test like:&lt;br/&gt;
&lt;br/&gt;
$ ./test/etap/run ./test/etap/140-attachment-comp.t&lt;br/&gt;
&lt;br/&gt;
The test, in the very beginning, does the call: &lt;br/&gt;
&lt;br/&gt;
{ok, Data} = file:read_file(&amp;quot;test_140_file.txt&amp;quot;),&lt;br/&gt;
&lt;br/&gt;
At that moment the current working dir is not test/etap. That .txt test file is found in test/etap/, so... :)&lt;br/&gt;
&lt;br/&gt;
If you cd into test/etap and do&lt;br/&gt;
&lt;br/&gt;
$ ./140-attachment-comp.t&lt;br/&gt;
&lt;br/&gt;
does it work?</comment>
                    <comment id="12805518" author="paul.joseph.davis" created="Wed, 27 Jan 2010 14:39:18 +0000 (UTC)"  >It was probably the directory permissions.&lt;br/&gt;
&lt;br/&gt;
All file access needs to go through the test_util.erl functions so that make distcheck works. Its a long and complicated story, but if you read from or write to the file system you need to figure out the paths based on a couple envirionment variables. the utils stuff should make that work easily.&lt;br/&gt;
</comment>
                    <comment id="12805526" author="paul.joseph.davis" created="Wed, 27 Jan 2010 14:58:55 +0000 (UTC)"  >s/directory permissions/file paths/&lt;br/&gt;
&lt;br/&gt;
Haven&apos;t had my coffee yet.</comment>
                    <comment id="12805533" author="fdmanana" created="Wed, 27 Jan 2010 15:20:19 +0000 (UTC)"  >Yep,&lt;br/&gt;
&lt;br/&gt;
I should have used &lt;br/&gt;
&lt;br/&gt;
{ok, Data} = file:read_file(test_util:build_file(&amp;quot;test/etap/test_140_file.txt&amp;quot;)),&lt;br/&gt;
&lt;br/&gt;
instead of&lt;br/&gt;
&lt;br/&gt;
{ok, Data} = file:read_file(&amp;quot;test_140_file.txt&amp;quot;),&lt;br/&gt;
&lt;br/&gt;
Stupid mistake of mine, as I always run the tests when I&apos;m in test/etap/.&lt;br/&gt;
I can submit a patch (yet another) with that correction (same goes for the loading of the test png file) when I get back home tonight.</comment>
                    <comment id="12805539" author="paul.joseph.davis" created="Wed, 27 Jan 2010 15:33:59 +0000 (UTC)"  >@Filipe,&lt;br/&gt;
&lt;br/&gt;
Actually you want to use test_util:src_file(Path).&lt;br/&gt;
&lt;br/&gt;
The way to double check that you have everything down pat is to run:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ make distcheck&lt;br/&gt;
&lt;br/&gt;
And that&apos;ll go through the full set of checks to see if your code is distribution ready.&lt;br/&gt;
&lt;br/&gt;
For a brief explanation, autotools has a feature called vbuilds that allows people to expand the source on a read-only mount, and then build to a writable location. So you have two directories (srcdir and builddir) and srcdir must be treated as read-only. This means that if you want to touch a file that was part of the release tarball (not all files in SVN are part of this, touching files during a build that aren&apos;t part of a release also causes errors) you use srcdir. If the file of interest is a file that&apos;s being written to, or was generated as part of a make rule, then it&apos;s in builddir.&lt;br/&gt;
&lt;br/&gt;
The relevant autotools docs are:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.gnu.org/software/hello/manual/automake/VPATH-Builds.html&quot;&gt;http://www.gnu.org/software/hello/manual/automake/VPATH-Builds.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.gnu.org/software/make/manual/html_node/General-Search.html&quot;&gt;http://www.gnu.org/software/make/manual/html_node/General-Search.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.gnu.org/software/make/manual/html_node/Commands_002fSearch.html#Commands_002fSearch&quot;&gt;http://www.gnu.org/software/make/manual/html_node/Commands_002fSearch.html#Commands_002fSearch&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Those all go over the weirdness to some extent. I&apos;m remembering another helpful page vaguely but can&apos;t figure out what it was.</comment>
                    <comment id="12805589" author="fdmanana" created="Wed, 27 Jan 2010 17:47:24 +0000 (UTC)"  >So, here it follows the correction.&lt;br/&gt;
&lt;br/&gt;
Now using:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, Data} = file:read_file(&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;test_util:source_file(&amp;quot;test/etap/test_140_file.txt&amp;quot;)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;)&lt;br/&gt;
&lt;br/&gt;
@Chris, @Paul,&lt;br/&gt;
Now you should be to run the etap test without cd to test/etap/&lt;br/&gt;
&lt;br/&gt;
And Paul thanks for the explanation on autotools and the links</comment>
                    <comment id="12806216" author="jchris" created="Fri, 29 Jan 2010 03:48:08 +0000 (UTC)"  >I think this patch is pretty much ready. In IRC I asked about renaming identity_len and len to raw_len and stored_len to make it more clear what they are referring to.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve looked through the disk and storage parts of the patch and they seem solid and ready to go. &lt;br/&gt;
&lt;br/&gt;
I&apos;ve just noticed something else:&lt;br/&gt;
&lt;br/&gt;
The changes in mochiweb for accepted_encodings. Did this patch go back to mochi yet?&lt;br/&gt;
&lt;br/&gt;
There is an Erlang Mimeparse library that should handle the q values etc, and it&apos;s heavily tested. Our JavaScript side uses a JS port of the original Mimeparse library. I think it&apos;d be better to patch Mochiweb to use Mimeparse than to write a new one that&apos;s not under they scrutiny the original Mimeparse is.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mimeparse/&quot;&gt;http://code.google.com/p/mimeparse/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Is there a reason not to use Mimeparse here? Can I persuade you to make that change? Maybe there&apos;s a way we can use Mimeparse to avoid having to patch Mochiweb at all?&lt;br/&gt;
&lt;br/&gt;
Thanks for working so hard at this. You&apos;ve picked probably one of the more challenging features in all of Couch.</comment>
                    <comment id="12806217" author="jchris" created="Fri, 29 Jan 2010 03:54:28 +0000 (UTC)"  >Looking at Mimeparse and your Mochiweb patches, it looks like you are covering parts of HTTP that Mimeparse doesn&apos;t handle yet. So disregard my last comment about using it instead. And I see that the accept stuff is in Mochi also. Rad.&lt;br/&gt;
&lt;br/&gt;
So it looks like we can commit this. I&apos;d sure appreciate anyone&apos;s help upgrading Mochi from upstream (properly).&lt;br/&gt;
&lt;br/&gt;
Filipe, the Mimeparse lib might appreciate your contribution.</comment>
                    <comment id="12806283" author="fdmanana" created="Fri, 29 Jan 2010 08:35:34 +0000 (UTC)"  >Hi Chris,&lt;br/&gt;
&lt;br/&gt;
For the Mochiweb stuff I submitted a patch sometime ago (with exactly the same code), which got accepted:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mochiweb/source/detail?r=133&quot;&gt;http://code.google.com/p/mochiweb/source/detail?r=133&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I was not aware of that Mimeparse lib. Sure I&apos;ll take a look into it and give my contribution :)&lt;br/&gt;
&lt;br/&gt;
Thank you (and Paul) for reviewing the patch and help me refining it.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12806524" author="fdmanana" created="Fri, 29 Jan 2010 21:48:49 +0000 (UTC)"  >Following the previous suggestion in this thread and in the irc channel:&lt;br/&gt;
&lt;br/&gt;
renamed:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;#att.len   to   #att.att_len&lt;br/&gt;
&lt;br/&gt;
and&lt;br/&gt;
&lt;br/&gt;
#att.identity_len   to   #att.disk_len&lt;br/&gt;
&lt;br/&gt;
Hopefully the meaning will be more clear to everybody :)&lt;br/&gt;
&lt;br/&gt;
ps: use git apply --binary</comment>
                    <comment id="12806535" author="fdmanana" created="Fri, 29 Jan 2010 22:21:05 +0000 (UTC)"  >18th&lt;br/&gt;
&lt;br/&gt;
removed the test_140_* files, since they are a copy of README and share/www/images/logo.png.&lt;br/&gt;
The test case now uses those 2 files directly.</comment>
                    <comment id="12806541" author="jchris" created="Fri, 29 Jan 2010 22:44:00 +0000 (UTC)"  >committed in r904650&lt;br/&gt;
&lt;br/&gt;
Thanks for the hard work everyone!</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12431532">COUCHDB-437</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12430509" name="couchdb-583-trunk-10th-try.patch" size="82116" author="fdmanana" created="Sat, 16 Jan 2010 14:12:27 +0000 (UTC)" />
            <attachment id="12430665" name="couchdb-583-trunk-11th-try.patch" size="84028" author="fdmanana" created="Mon, 18 Jan 2010 19:34:40 +0000 (UTC)" />
            <attachment id="12430677" name="couchdb-583-trunk-12th-try.patch" size="80463" author="fdmanana" created="Mon, 18 Jan 2010 22:03:41 +0000 (UTC)" />
            <attachment id="12430781" name="couchdb-583-trunk-13th-try.patch" size="79674" author="fdmanana" created="Tue, 19 Jan 2010 18:57:26 +0000 (UTC)" />
            <attachment id="12431053" name="couchdb-583-trunk-14th-try-git.patch" size="83628" author="fdmanana" created="Thu, 21 Jan 2010 18:53:18 +0000 (UTC)" />
            <attachment id="12431253" name="couchdb-583-trunk-15th-try-git.patch" size="83640" author="fdmanana" created="Sun, 24 Jan 2010 22:17:09 +0000 (UTC)" />
            <attachment id="12431581" name="couchdb-583-trunk-16th-try-git.patch" size="83702" author="fdmanana" created="Wed, 27 Jan 2010 17:47:24 +0000 (UTC)" />
            <attachment id="12431824" name="couchdb-583-trunk-17th-try-git.patch" size="87171" author="fdmanana" created="Fri, 29 Jan 2010 21:48:49 +0000 (UTC)" />
            <attachment id="12431828" name="couchdb-583-trunk-18th-try-git.patch" size="66475" author="fdmanana" created="Fri, 29 Jan 2010 22:21:05 +0000 (UTC)" />
            <attachment id="12427384" name="couchdb-583-trunk-3rd-try.patch" size="47600" author="fdmanana" created="Tue, 8 Dec 2009 20:34:32 +0000 (UTC)" />
            <attachment id="12428566" name="couchdb-583-trunk-4th-try-trunk.patch" size="62831" author="fdmanana" created="Sun, 20 Dec 2009 10:52:28 +0000 (UTC)" />
            <attachment id="12428618" name="couchdb-583-trunk-5th-try.patch" size="69519" author="fdmanana" created="Mon, 21 Dec 2009 10:36:35 +0000 (UTC)" />
            <attachment id="12428674" name="couchdb-583-trunk-6th-try.patch" size="74067" author="fdmanana" created="Tue, 22 Dec 2009 00:35:17 +0000 (UTC)" />
            <attachment id="12428740" name="couchdb-583-trunk-7th-try.patch" size="75410" author="fdmanana" created="Tue, 22 Dec 2009 17:05:45 +0000 (UTC)" />
            <attachment id="12429693" name="couchdb-583-trunk-8th-try.patch" size="78144" author="fdmanana" created="Fri, 8 Jan 2010 00:02:25 +0000 (UTC)" />
            <attachment id="12430068" name="couchdb-583-trunk-9th-try.patch" size="77706" author="fdmanana" created="Wed, 13 Jan 2010 00:09:17 +0000 (UTC)" />
            <attachment id="12426359" name="jira-couchdb-583-1st-try-trunk.patch" size="29404" author="fdmanana" created="Sun, 29 Nov 2009 15:47:07 +0000 (UTC)" />
            <attachment id="12426360" name="jira-couchdb-583-2nd-try-trunk.patch" size="29421" author="fdmanana" created="Sun, 29 Nov 2009 16:09:38 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 29 Jan 2010 22:44:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 29 Nov 2009 16:07:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-582] _changes filter missing updates</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-582</link>

                    <description>reported on the user mailing list: &lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-user/200911.mbox/%3c4B10BD2C.5070200@rogerbinns.com%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-user/200911.mbox/%3c4B10BD2C.5070200@rogerbinns.com%3e&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I know there is work to be done on the filter mechanism (specifically around process reuse and concurrency)&lt;br/&gt;
&lt;br/&gt;
The current implementation requires a process per connected user. This should be not that hard to patch.</description>
                <environment></environment>
            <key id="12441871">COUCHDB-582</key>
        <summary>_changes filter missing updates</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Sat, 28 Nov 2009 23:02:55 +0000 (UTC)</created>
    <updated>Tue, 1 Dec 2009 04:11:20 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12783316" author="paul.joseph.davis" created="Sat, 28 Nov 2009 23:14:51 +0000 (UTC)"  >Is there something wrong with a process per connected user? Each connected socket already uses a process per user. Or is this a second process per user?</comment>
                    <comment id="12783318" author="jchris" created="Sat, 28 Nov 2009 23:20:19 +0000 (UTC)"  >It&apos;s one couchjs process per connected user, so that&apos;s not so hot. There&apos;s no reason they can&apos;t be shared. Or maybe I haven&apos;t looked at the code in a while and this optimization is already done.&lt;br/&gt;
&lt;br/&gt;
In any case, what we really need is some failing tests.</comment>
                    <comment id="12783355" author="rogerbinns" created="Sun, 29 Nov 2009 03:53:29 +0000 (UTC)"  >Not quite as good as tests, but here is an exact description of what they should do.&lt;br/&gt;
&lt;br/&gt;
Create a filter function:&lt;br/&gt;
&lt;br/&gt;
function(doc, req) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// log(&amp;quot;filter &amp;quot;+toJSON(doc));  -- useful for debugging and confirming filter was even called&lt;br/&gt;
&amp;nbsp;return doc.type==&amp;quot;A&amp;quot; || doc._deleted;&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
Now watch _changes with that filter function.  You should verify that there is always at least one row returned.  Create several docs in a row with doc.type=&amp;quot;A&amp;quot;.  Delete them.  There should always be at least one row returned.  (Bonus points for matching up returned rows with creation/deletion activity.)&lt;br/&gt;
&lt;br/&gt;
A related issue is that _changes requests return based on if there was data before filtering.  Consequently running the above will return no rows if you create doc.type=&amp;quot;B&amp;quot;.  It would be more efficient to only return if there are rows *after* filtering in which the above test can continue to run and should not return if you create doc.type=&amp;quot;B&amp;quot;.</comment>
                    <comment id="12784039" author="rogerbinns" created="Tue, 1 Dec 2009 04:03:49 +0000 (UTC)"  >Python code to reproduce the problem.</comment>
                    <comment id="12784043" author="rogerbinns" created="Tue, 1 Dec 2009 04:11:20 +0000 (UTC)"  >The code I attached reproduces the problem.  The important thing is that not only should be there changes happening but those changes must also be part of the view and the view must be accessed.  The reproduction code includes comments at the top.  Briefly a background thread monitors the changes printing them out and posting to a message queue.  A foreground thread waits a few seconds for a message queue item - if there is one then it reads the view, else it makes a change.&lt;br/&gt;
&lt;br/&gt;
Output is shown below.  If you comment out the two lines accessing the view at the bottom of the file then the output is always correct.  Each changes line shows what the changes call returned.  Since the filter always returns true and we made an appropriate change there should always be an item listed.  The bug is that some of the time no changed item is given (as though the filter returned false).  Here is one run where every alternate change did not give an item:&lt;br/&gt;
&lt;br/&gt;
$ python bug582.py&lt;br/&gt;
+one&lt;br/&gt;
changes {&apos;last_seq&apos;: 2, &apos;results&apos;: [{&apos;changes&apos;: [{&apos;rev&apos;: &apos;1-cc2a517fa3e1a5b6ae9e3fbea460b9b8&apos;}], &apos;id&apos;: &apos;one&apos;, &apos;seq&apos;: 2}]}&lt;br/&gt;
+two&lt;br/&gt;
changes {&apos;last_seq&apos;: 3, &apos;results&apos;: []}&lt;br/&gt;
&amp;nbsp;two&lt;br/&gt;
changes {&apos;last_seq&apos;: 4, &apos;results&apos;: [{&apos;changes&apos;: [{&apos;rev&apos;: &apos;2-a197bfde810e37b0a88f74a4ae038565&apos;}], &apos;id&apos;: &apos;two&apos;, &apos;seq&apos;: 4}]}&lt;br/&gt;
&amp;nbsp;two&lt;br/&gt;
changes {&apos;last_seq&apos;: 5, &apos;results&apos;: []}&lt;br/&gt;
&amp;nbsp;one&lt;br/&gt;
changes {&apos;last_seq&apos;: 6, &apos;results&apos;: [{&apos;changes&apos;: [{&apos;rev&apos;: &apos;2-39ea5c560504b84520606003e3d991f6&apos;}], &apos;id&apos;: &apos;one&apos;, &apos;seq&apos;: 6}]}&lt;br/&gt;
-one&lt;br/&gt;
changes {&apos;last_seq&apos;: 7, &apos;results&apos;: []}&lt;br/&gt;
-two&lt;br/&gt;
changes {&apos;last_seq&apos;: 8, &apos;results&apos;: [{&apos;deleted&apos;: True, &apos;changes&apos;: [{&apos;rev&apos;: &apos;4-be0fbd62ef4241c2b45693002a808fbb&apos;}], &apos;id&apos;: &apos;two&apos;, &apos;seq&apos;: 8}]}&lt;br/&gt;
&lt;br/&gt;
I then did another run a few seconds later (exact same parameters) where there is only one &amp;quot;failure&amp;quot;:&lt;br/&gt;
&lt;br/&gt;
$ python bug582.py&lt;br/&gt;
+one&lt;br/&gt;
changes {&apos;last_seq&apos;: 2, &apos;results&apos;: [{&apos;changes&apos;: [{&apos;rev&apos;: &apos;1-cc2a517fa3e1a5b6ae9e3fbea460b9b8&apos;}], &apos;id&apos;: &apos;one&apos;, &apos;seq&apos;: 2}]}&lt;br/&gt;
+two&lt;br/&gt;
changes {&apos;last_seq&apos;: 3, &apos;results&apos;: [{&apos;changes&apos;: [{&apos;rev&apos;: &apos;1-3ca2f01d11f16acffd9bfc740e4c963b&apos;}], &apos;id&apos;: &apos;two&apos;, &apos;seq&apos;: 3}]}&lt;br/&gt;
&amp;nbsp;two&lt;br/&gt;
changes {&apos;last_seq&apos;: 4, &apos;results&apos;: [{&apos;changes&apos;: [{&apos;rev&apos;: &apos;2-7faeecd5faa47385c730933f13fb7872&apos;}], &apos;id&apos;: &apos;two&apos;, &apos;seq&apos;: 4}]}&lt;br/&gt;
&amp;nbsp;two&lt;br/&gt;
changes {&apos;last_seq&apos;: 5, &apos;results&apos;: []}&lt;br/&gt;
&amp;nbsp;one&lt;br/&gt;
changes {&apos;last_seq&apos;: 6, &apos;results&apos;: [{&apos;changes&apos;: [{&apos;rev&apos;: &apos;2-625ac20a7b3813db296c2e6cec6337bf&apos;}], &apos;id&apos;: &apos;one&apos;, &apos;seq&apos;: 6}]}&lt;br/&gt;
-one&lt;br/&gt;
changes {&apos;last_seq&apos;: 7, &apos;results&apos;: [{&apos;deleted&apos;: True, &apos;changes&apos;: [{&apos;rev&apos;: &apos;3-4d6a3081511d2f8e7daec512afca1c11&apos;}], &apos;id&apos;: &apos;one&apos;, &apos;seq&apos;: 7}]}&lt;br/&gt;
-two&lt;br/&gt;
changes {&apos;last_seq&apos;: 8, &apos;results&apos;: [{&apos;deleted&apos;: True, &apos;changes&apos;: [{&apos;rev&apos;: &apos;4-d47e864a9fbb905fdd86c84a04bacebb&apos;}], &apos;id&apos;: &apos;two&apos;, &apos;seq&apos;: 8}]}&lt;br/&gt;
&lt;br/&gt;
In general each run gives different results.</comment>
                </comments>
    
    <attachments>
            <attachment id="12426496" name="bug582.py" size="4143" author="rogerbinns" created="Tue, 1 Dec 2009 04:03:49 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 28 Nov 2009 23:14:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-581] dead code in couch_db.erl</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-581</link>

                    <description>couch_db:register_update_notifier  seems to be no longer used, according to distel:who_calls&lt;br/&gt;
removing it has not impact on any tests, etaps or Futon</description>
                <environment>OS X 10.6</environment>
            <key id="12441842">COUCHDB-581</key>
        <summary>dead code in couch_db.erl</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Fri, 27 Nov 2009 18:17:46 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 22:12:59 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12783146" author="dionne" created="Fri, 27 Nov 2009 18:18:55 +0000 (UTC)"  >removes unused function</comment>
                    <comment id="12828301" author="janl" created="Mon, 1 Feb 2010 22:12:59 +0000 (UTC)"  >Applied in r905429.</comment>
                </comments>
    
    <attachments>
            <attachment id="12426291" name="couch_db.erl.patch" size="1065" author="dionne" created="Fri, 27 Nov 2009 18:18:55 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 22:12:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 22:12:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-580] Continuous feed closes connection after certain time</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-580</link>

                    <description>When listening for changes using the continuous feed, e.g.:&lt;br/&gt;
spreadsheets/_changes?feed=continuous&lt;br/&gt;
&lt;br/&gt;
it seems as if contrary to what is described here (&lt;a href=&quot;http://books.couchdb.org/relax/reference/change-notifications),&quot;&gt;http://books.couchdb.org/relax/reference/change-notifications),&lt;/a&gt; the connections gets closed after a certain time by couchdb and a&lt;br/&gt;
{&amp;quot;last_seq&amp;quot;:XYZ}&lt;br/&gt;
gets sent.&lt;br/&gt;
For sample code, please have a look here: &lt;a href=&quot;http://stackoverflow.com/questions/1640653/how-do-you-use-couchdb-change-notifications-continuous-changes-from-java/&quot;&gt;http://stackoverflow.com/questions/1640653/how-do-you-use-couchdb-change-notifications-continuous-changes-from-java/&lt;/a&gt; or use curl.</description>
                <environment>Mac OSX</environment>
            <key id="12441768">COUCHDB-580</key>
        <summary>Continuous feed closes connection after certain time</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="joscha">Joscha Feth</reporter>
            
    <created>Thu, 26 Nov 2009 11:47:55 +0000 (UTC)</created>
    <updated>Thu, 26 Nov 2009 13:34:42 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12782885" author="emgee" created="Thu, 26 Nov 2009 13:03:01 +0000 (UTC)"  >There&apos;s a default timeout of 60s. See &lt;a href=&quot;http://wiki.apache.org/couchdb/HTTP_database_API#Changes&quot;&gt;http://wiki.apache.org/couchdb/HTTP_database_API#Changes&lt;/a&gt;.</comment>
                    <comment id="12782886" author="joscha" created="Thu, 26 Nov 2009 13:12:54 +0000 (UTC)"  >Hi Matt,&lt;br/&gt;
&lt;br/&gt;
I see  - Thanks for your hint - sorry I missed that - I added a comment to the book chapter, hopefully it will also be reflected there, soon.&lt;br/&gt;
So as I can see from the options available, I can either set the timeout incredibly high (setting it to zero does not seem possible, I&apos;d have expected if I give a zero timeout it will stay open forever?!) or I can use the heartbeat, which has the overhead of sending data (even though it is only a newline) over the wire every X ms.&lt;br/&gt;
&lt;br/&gt;
Is it planned to support &amp;amp;timeout=0 in future?</comment>
                    <comment id="12782892" author="emgee" created="Thu, 26 Nov 2009 13:31:39 +0000 (UTC)"  >Sorry, cannot comment on future plans but I doubt a timeout=0 will be supported as it could cause CouchDB to accumulate an endless list of dead connections.&lt;br/&gt;
&lt;br/&gt;
Basically, both ends of the connection need to know if the socket is closed for whatever reason- CouchDB needs to clean up so it&apos;s not wasting time; clients need to reconnect. The TCP stack alone is typically not good enough so most protocols resort to sending some sort of ping packet.&lt;br/&gt;
&lt;br/&gt;
By default CouchDB will simply close the connection after a period of time (the default 60s) presumably to ensure (potentially) dead sockets are removed from its _changes list. A live but quiet client can simply reopen the connection, no big deal.&lt;br/&gt;
&lt;br/&gt;
As soon as the client specifies a heartbeat then the client is saying, &amp;quot;I&apos;m expecting a newline every x seconds and will close or recycle the connection if I don&apos;t see it&amp;quot;.  In addition, CouchDB should eventually see a failure trying to send the heartbeat newline and can use that to clean up dead connections. Failure detection at both ends ... perfect.&lt;br/&gt;
&lt;br/&gt;
If you set the timeout &amp;quot;incredibly high&amp;quot; all you&apos;re doing is delaying when the client and CouchDB can detect a dead socket, and therefore delaying when you decide to recover from that condition.</comment>
                    <comment id="12782894" author="joscha" created="Thu, 26 Nov 2009 13:34:22 +0000 (UTC)"  >Agreed. I will close this issue then. Thanks for the clarification!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 26 Nov 2009 13:34:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 26 Nov 2009 13:03:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-579] Using filters on continuous feeds fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-579</link>

                    <description>When using continuous feeds, such as for example:&lt;br/&gt;
&lt;br/&gt;
/mydb/_changes?feed=continuous&amp;amp;heartbeat=1000&amp;amp;id=myId&amp;amp;since=428&amp;amp;filter=complete/example&lt;br/&gt;
&lt;br/&gt;
CouchDB fails with a status code of 500 after putting a new document into the database.&lt;br/&gt;
&lt;br/&gt;
test filter for this issue:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;example&amp;quot;: &amp;quot;function(doc, req) { return true; }&amp;quot;&lt;br/&gt;
&lt;br/&gt;
sysout from couchdb:&lt;br/&gt;
&lt;br/&gt;
....PUT here....&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.644.0&amp;gt;] OS Process :: Error converting object to JSON: TypeError: toJSON.dispatcher[val.constructor.name] is not a function&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.642.0&amp;gt;] 192.168.178.45 - - &apos;GET&apos; /mydb/f3cacfc2bfbf1aa0b0c8313fc7b181ec?revs_info=true 200&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.1045.0&amp;gt;] 192.168.178.45 - - &apos;GET&apos; / 200&lt;br/&gt;
1&amp;gt; [error] [&amp;lt;0.1039.0&amp;gt;] OS Process Error :: {os_process_error,&amp;quot;OS process timed out.&amp;quot;}&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.1039.0&amp;gt;] 192.168.178.45 - - &apos;GET&apos;&lt;br/&gt;
&lt;br/&gt;
Can be reproduced - as soon as feed is not filtered, the issue goes away.</description>
                <environment>Mac OSX 10.6</environment>
            <key id="12441730">COUCHDB-579</key>
        <summary>Using filters on continuous feeds fails</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="joscha">Joscha Feth</reporter>
            
    <created>Thu, 26 Nov 2009 01:46:01 +0000 (UTC)</created>
    <updated>Mon, 30 Nov 2009 18:54:23 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12783681" author="joscha" created="Mon, 30 Nov 2009 15:01:44 +0000 (UTC)"  >More information:&lt;br/&gt;
&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.5917.0&amp;gt;] OS Process :: Error converting object to JSON: TypeError: toJSON.dispatcher[val.constructor.name] is not a function&lt;br/&gt;
1&amp;gt; [error] [&amp;lt;0.5771.0&amp;gt;] OS Process Error :: {os_process_error,&amp;quot;OS process timed out.&amp;quot;}&lt;br/&gt;
1&amp;gt; [error] [&amp;lt;0.5771.0&amp;gt;] Uncaught error in HTTP request: {exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{normal,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_query_servers,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ret_proc,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc,&amp;lt;0.5917.0&amp;gt;,&amp;lt;&amp;lt;&amp;quot;javascript&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,prompt},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,set_timeout},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_os_process,stop}}}]}}}&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.5771.0&amp;gt;] Stacktrace: [{gen_server,call,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_query_servers,ret_os_process,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_query_servers,end_filter,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,send_changes,8},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,handle_changes_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5}]&lt;br/&gt;
1&amp;gt; [error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_secondary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,normal},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.5779.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,query_servers},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_query_servers,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.5771.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /whatever/_changes?filter=filters/byId 500</comment>
                    <comment id="12783790" author="jchris" created="Mon, 30 Nov 2009 18:54:23 +0000 (UTC)"  >I&apos;ve committed a test for this in r885533. &lt;br/&gt;
&lt;br/&gt;
The test passes out of the gate, so I think the bug is not related.&lt;br/&gt;
&lt;br/&gt;
It looks like your stack trace indicates some issues with your javascript function (although it looks simple). Perhaps you can try again with a different set of documents. (or look at the changes.js test for the filtered continuous call and see if it&apos;s doing what you&apos;re trying.)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 30 Nov 2009 18:54:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 30 Nov 2009 18:54:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-578] Every statistic description is truncated</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-578</link>

                    <description>src/couchdb/priv/stat_descriptions.cfg.in &lt;br/&gt;
&lt;br/&gt;
Every line is missing the final character (s, e, s, n, b, in these examples).&lt;br/&gt;
&lt;br/&gt;
{couchdb, database_writes, &amp;quot;number of times a database was change&amp;quot;}.&lt;br/&gt;
{couchdb, database_reads, &amp;quot;number of times a document was read from a databas&amp;quot;}.&lt;br/&gt;
{couchdb, open_databases, &amp;quot;number of open database&amp;quot;}.&lt;br/&gt;
{couchdb, open_os_files, &amp;quot;number of file descriptors CouchDB has ope&amp;quot;}.&lt;br/&gt;
{couchdb, request_time, &amp;quot;length of a request inside CouchDB without MochiWe&amp;quot;}.&lt;br/&gt;
....</description>
                <environment></environment>
            <key id="12441598">COUCHDB-578</key>
        <summary>Every statistic description is truncated</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Tue, 24 Nov 2009 19:12:53 +0000 (UTC)</created>
    <updated>Tue, 24 Nov 2009 20:21:34 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12782143" author="paul.joseph.davis" created="Tue, 24 Nov 2009 20:21:34 +0000 (UTC)"  >Fixed as of r883850.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Nov 2009 20:21:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Nov 2009 20:21:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-577] couchdb @ winxp: Simple RegExp&apos;s can not be executed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-577</link>

                    <description>This show function failed on WinXP but pass on Linux:&lt;br/&gt;
&lt;br/&gt;
function (doc, req) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var rr2 = new RegExp(&amp;quot;\n&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;rr2.exec(&amp;quot;fafdadsds&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var rr = /\n/;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;rr.exec(&amp;quot;fafdadsds&amp;quot;);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;return &amp;quot;ok&amp;quot;;&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
The first RegExp is ok, but the second one (simple form) can not be executed.&lt;br/&gt;
&lt;br/&gt;
1&amp;gt; [debug] [&amp;lt;0.73.0&amp;gt;] &apos;GET&apos; /c2/_design/dash/_show/overview {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Charset&apos;,&amp;quot;ISO-8859-1,utf-8;q=0.7,*;q=0.7&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip,deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Language&apos;,&amp;quot;de-de,de;q=0.8,en-us;q=0.5,en;q=0.3&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cache-Control&apos;,&amp;quot;max-age=0&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;keep-alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Keep-Alive&apos;,&amp;quot;300&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR&lt;br/&gt;
&amp;nbsp;3.5.30729)&amp;quot;}]&lt;br/&gt;
1&amp;gt; [debug] [&amp;lt;0.73.0&amp;gt;] OAuth Params: []&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.98.0&amp;gt;] OS Process :: function raised error: TypeError: rr.exec is not a function&lt;br/&gt;
1&amp;gt; [info] [&amp;lt;0.98.0&amp;gt;] OS Process :: stacktrace: (null,[object Object])@:4&lt;br/&gt;
runShow(function (doc, req) {var rr2 = new RegExp(&amp;quot;\n&amp;quot;);rr2.exec(&amp;quot;fafdadsds&amp;quot;);var rr = /\n/;rr.exec(&amp;quot;fafdadsds&amp;quot;);return&lt;br/&gt;
&amp;quot;ok&amp;quot;;},null,[object Object],&amp;quot;function (doc, req) {\n  var rr2 = new RegExp(\&amp;quot;\\n\&amp;quot;);\n  rr2.exec(\&amp;quot;fafdadsds\&amp;quot;);\n  var&lt;br/&gt;
rr = /\\n/;\n  rr.exec(\&amp;quot;fafdadsds\&amp;quot;);\n\n  return \&amp;quot;ok\&amp;quot;;\n}\n\n&amp;quot;)@../share/couchdb/server/main.js:388&lt;br/&gt;
(&amp;quot;function (doc, req) {\n  var rr2 = new RegExp(\&amp;quot;\\n\&amp;quot;);\n  rr2.exec(\&amp;quot;fafdadsds\&amp;quot;);\n  var rr = /\\n/;\n  rr.exec(\&amp;quot;fa&lt;br/&gt;
fdadsds\&amp;quot;);\n\n  return \&amp;quot;ok\&amp;quot;;\n}\n\n&amp;quot;,null,[object Object])@../share/couchdb/server/main.js:358&lt;br/&gt;
@../share/couchdb/server/main.js:842</description>
                <environment>WinXP, setup-couchdb-0.11.0b880589.exe, setup-couchdb-0.10.0.exe</environment>
            <key id="12441551">COUCHDB-577</key>
        <summary>couchdb @ winxp: Simple RegExp&apos;s can not be executed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thomo1969">Thomas Mohaupt</reporter>
            
    <created>Tue, 24 Nov 2009 07:17:08 +0000 (UTC)</created>
    <updated>Mon, 28 Dec 2009 06:31:44 +0000 (UTC)</updated>

                        <version>0.10</version>
                    <version>0.11</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12782192" author="mhammond" created="Tue, 24 Nov 2009 21:43:28 +0000 (UTC)"  >I can only guess this is due to a difference in spidermonkey versions used by the Linux and Windows builds.</comment>
                    <comment id="12794771" author="rogerbinns" created="Mon, 28 Dec 2009 06:31:44 +0000 (UTC)"  >I get exactly the same problem with the stock CouchDB 0.10 as shipped on Ubuntu 9.10.  At least now I know I am not going mad.  Even more perplexing the issue does no appear if I invoke CouchJS directly on my code and test data but does occur when using as view/list/show function.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Nov 2009 21:43:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-576] Require current update_seq when deleting a database for extra safety.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-576</link>

                    <description>Require the current update_seq before deleting a database to prevent accidental deletion.&lt;br/&gt;
&lt;br/&gt;
DELETE /db2?seq=12</description>
                <environment></environment>
            <key id="12441532">COUCHDB-576</key>
        <summary>Require current update_seq when deleting a database for extra safety.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Tue, 24 Nov 2009 00:11:21 +0000 (UTC)</created>
    <updated>Tue, 24 Nov 2009 11:47:23 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12781715" author="rnewson" created="Tue, 24 Nov 2009 00:26:18 +0000 (UTC)"  >seq is optional to preserve compatibility. Leaving off ?seq=N will drop the database unilaterally. If it is present, it must match the current update_seq to succeed.</comment>
                    <comment id="12781881" author="rnewson" created="Tue, 24 Nov 2009 11:46:44 +0000 (UTC)"  >&lt;br/&gt;
changed seq= to update_seq= and added tests.</comment>
                </comments>
    
    <attachments>
            <attachment id="12425954" name="delete-db-safety-with-tests.patch" size="2668" author="rnewson" created="Tue, 24 Nov 2009 11:46:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-575] CouchDB crashes and restarts when multiple databases are being compacted at once</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-575</link>

                    <description>When I run compaction on multiple databases at once, CouchDB will crash and restart.  &lt;br/&gt;
&lt;br/&gt;
This happens on views and databases.  &lt;br/&gt;
&lt;br/&gt;
When compacting DBs, I had definite crashes when compacting just two databases.  When compacting views, I haven&apos;t yet seen a crash with just two views running, but have with at few as 5 views being compacted.&lt;br/&gt;
&lt;br/&gt;
My DBs and views are large, but not unreasonable.  The databases run around 23G each (after compaction).  The views are similarly sized:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&apos;mailto:james@lysithia&apos;&gt;james@lysithia&lt;/a&gt; ~ $ ls -lrth /var/lib/couchdb/.d12_2007_02morehash_design/ &lt;br/&gt;
total 74G&lt;br/&gt;
-rw-r--r-- 1 couchdb couchdb  25G 2009-11-18 11:29 172235a8f385d7dc0e0818e5d003aad2.view&lt;br/&gt;
-rw-r--r-- 1 couchdb couchdb  13G 2009-11-19 19:30 2657851bc558aef6b89d05361193fc5e.view&lt;br/&gt;
-rw-r--r-- 1 couchdb couchdb  44M 2009-11-23 14:18 172235a8f385d7dc0e0818e5d003aad2.compact.view&lt;br/&gt;
-rw-r--r-- 1 couchdb couchdb 3.9M 2009-11-23 14:18 2657851bc558aef6b89d05361193fc5e.compact.view&lt;br/&gt;
-rw-r--r-- 1 couchdb couchdb  37G 2009-11-23 14:34 433c5bd5313e5509b96b67a6eb3d1145.view&lt;br/&gt;
-rw-r--r-- 1 couchdb couchdb  57M 2009-11-23 14:43 433c5bd5313e5509b96b67a6eb3d1145.compact.view&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:46 GMT] [debug] [&amp;lt;0.92.0&amp;gt;] Spawning new group server for view group _design/summary in database d12_2007_06morehash.&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:46 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_05morehash/summary3: Copied 20000 of 909614 Ids (2%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:48 GMT] [info] [&amp;lt;0.479.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /d12_2007_06morehash/_compact/summary 202&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:48 GMT] [info] [&amp;lt;0.520.0&amp;gt;] View index compaction starting for d12_2007_06morehash _design/summary&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:49 GMT] [debug] [&amp;lt;0.520.0&amp;gt;] Resetting group index &amp;quot;_design/summary&amp;quot; in db d12_2007_06morehash&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:49 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_06morehash _design/summary: Processed 0 of 23 changes (0%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:49 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_06morehash/summary: Copied 0 of 901450 Ids (0%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:49 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_06morehash _design/summary: Processed 12 of 23 changes (52%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:50 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_06morehash _design/summary: Processed 18 of 23 changes (78%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:50 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_06morehash _design/summary: Finishing.&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:50 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_05morehash/summary3: Copied 30000 of 909614 Ids (3%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:52 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_05morehash/summary3: Copied 40000 of 909614 Ids (4%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:53 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_02morehash/summary3: Copied 110000 of 874175 Ids (12%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:53 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_05morehash/summary3: Copied 50000 of 909614 Ids (5%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:07:54 GMT] [info] [&amp;lt;0.520.0&amp;gt;] checkpointing view update at seq 1156739 for d12_2007_06morehash _design/summary&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_04morehash/summary3: Copied 90000 of 983989 Ids (9%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [debug] [&amp;lt;0.80.0&amp;gt;] New task status for d12_2007_02morehash/summary2: Copied 50000 of 874175 Ids (5%)&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.80.0&amp;gt;] ** Generic server couch_task_status terminating &lt;br/&gt;
** Last message in was {#Ref&amp;lt;0.0.3.46775&amp;gt;,1}&lt;br/&gt;
** When Server state == nil&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_info,[{#Ref&amp;lt;0.0.3.46775&amp;gt;,1},nil]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.80.0&amp;gt;] {error_report,&amp;lt;0.29.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.80.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{couch_task_status,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.80.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{#Ref&amp;lt;0.0.3.46775&amp;gt;,1},nil]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_primary_services,couch_server_sup,&amp;lt;0.30.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.76.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,1597},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,3059}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.76.0&amp;gt;] {error_report,&amp;lt;0.29.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.76.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_primary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_info,[{#Ref&amp;lt;0.0.3.46775&amp;gt;,1},nil]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.80.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_task_status,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.19.0&amp;gt;] {error_report,&amp;lt;0.7.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.19.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;File operation error: eacces. Target: ./lib.beam. Function: get_file. Process: code_server.&amp;quot;}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.19.0&amp;gt;] {error_report,&amp;lt;0.7.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.19.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;File operation error: eacces. Target: ./erl_internal.beam. Function: get_file. Process: code_server.&amp;quot;}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.553.0&amp;gt;] ** Generic server couch_task_status terminating &lt;br/&gt;
** Last message in was {&apos;$gen_cast&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{update_status,&amp;lt;0.494.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;Copied 60000 of 909614 Ids (6%)&amp;quot;&amp;gt;&amp;gt;}}&lt;br/&gt;
** When Server state == nil&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.553.0&amp;gt;] {error_report,&amp;lt;0.29.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.553.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{couch_task_status,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.553.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,{exit,{{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_primary_services,couch_server_sup,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.30.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.76.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,377},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,127}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:05 GMT] [error] [&amp;lt;0.76.0&amp;gt;] {error_report,&amp;lt;0.29.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.76.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_primary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,{{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.553.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,couch_task_status},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_task_status,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 23 Nov 2009 23:08:07 GMT] [error] [&amp;lt;0.555.0&amp;gt;] ** Generic server couch_task_status terminating &lt;br/&gt;
** Last message in was {&apos;$gen_cast&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{update_status,&amp;lt;0.458.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;Copied 100000 of 983989 Ids (10%)&amp;quot;&amp;gt;&amp;gt;}}&lt;br/&gt;
** When Server state == nil&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {{badmatch,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_task_status,handle_cast,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}&lt;br/&gt;
&lt;br/&gt;
and so on.  I can post more but I don&apos;t know what I&apos;m looking at or what is helpful&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.11.0b1e2a54d1-git&amp;quot;}&lt;br/&gt;
Gentoo 10.1, rebuilt as of Nov 12, 64-bit, linux kernel version 2.6.30&lt;br/&gt;
Erlang built from source file otp_src_R13B02-1.tar.gz (Gentoo calls it 13.2.2)</environment>
            <key id="12441530">COUCHDB-575</key>
        <summary>CouchDB crashes and restarts when multiple databases are being compacted at once</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jmarca">James Marca</reporter>
            
    <created>Mon, 23 Nov 2009 23:14:52 +0000 (UTC)</created>
    <updated>Tue, 24 Nov 2009 04:21:11 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12781765" author="kocolosk" created="Tue, 24 Nov 2009 04:21:11 +0000 (UTC)"  >Hi James, thanks -- I think that&apos;s enough to go on.&lt;br/&gt;
&lt;br/&gt;
Devs -- I don&apos;t know where that {Ref,1} message is coming from, but it crashes couch_task_status because handle_info doesn&apos;t have a catchall clause.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Nov 2009 04:21:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-574] couchdb.bat: change to erlang dir failed if user profile is on a different drive (patch contained)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-574</link>

                    <description>In couchdb.bat the first thing done is to change to the erlang directory&lt;br/&gt;
&lt;br/&gt;
------ couchdb.bat line 14 - 15 ----------&lt;br/&gt;
setlocal&lt;br/&gt;
rem First change to the erlang bin directory&lt;br/&gt;
cd %~dp0&lt;br/&gt;
----------------------------&lt;br/&gt;
&lt;br/&gt;
this failed if the batch file is called by &amp;quot;start menu&amp;quot; and the start menu is on a different drive than the couchdb erlang dir. &lt;br/&gt;
-----------------------------&lt;br/&gt;
e:\home\mot&amp;gt;&amp;quot;d:\Program Files\CouchDB\bin\couchdb.bat&amp;quot;&lt;br/&gt;
CouchDB 0.10.0 - prepare to relax...&lt;br/&gt;
&apos;erl.exe&apos; is not recognized as an internal or external command,&lt;br/&gt;
operable program or batch file.&lt;br/&gt;
-----------------------------&lt;br/&gt;
&lt;br/&gt;
To fix this include &amp;quot;%~d0&amp;quot; after &amp;quot;setlocal&amp;quot;&lt;br/&gt;
&lt;br/&gt;
------ couchdb.bat line 14 - 15 ----------&lt;br/&gt;
setlocal&lt;br/&gt;
rem First change to the erlang bin directory&lt;br/&gt;
%~d0                               &amp;lt;&amp;lt;&amp;lt;&amp;lt; new - will change the drive&lt;br/&gt;
cd %~dp0&lt;br/&gt;
----------------------------&lt;br/&gt;
</description>
                <environment>WinXP, install package: setup-couchdb-0.10.0.exe and setup-couchdb-0.11.0b819947.exe</environment>
            <key id="12441409">COUCHDB-574</key>
        <summary>couchdb.bat: change to erlang dir failed if user profile is on a different drive (patch contained)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="mhammond">Mark Hammond</assignee>
            
                        <reporter username="thomo1969">Thomas Mohaupt</reporter>
            
    <created>Sun, 22 Nov 2009 22:41:45 +0000 (UTC)</created>
    <updated>Tue, 24 Nov 2009 06:54:58 +0000 (UTC)</updated>

                        <version>0.10</version>
                    <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="60">0.02h</timeoriginalestimate>        <timeestimate seconds="60">0.02h</timeestimate>                    

            <comments>
                    <comment id="12781801" author="mhammond" created="Tue, 24 Nov 2009 06:54:58 +0000 (UTC)"  >Thanks - fixed in r883606.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Nov 2009 06:54:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Nov 2009 06:54:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-573] Regex capture problem in emit functions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-573</link>

                    <description>The capture variables $0, $1, $2... don&apos;t get instantiated in regex expressions placed in emit functions.&lt;br/&gt;
&lt;br/&gt;
Example:&lt;br/&gt;
function(doc) { if (doc.EntityType != null) { emit(doc.ID.Value + &apos;.&apos; + doc.EntityType, { Type: doc.EntityType.replace(/[A-Z]/g, &apos; $0&apos;), ....&lt;br/&gt;
&lt;br/&gt;
EntityType: TestTwo &lt;br/&gt;
Returns:&lt;br/&gt;
Type: &amp;quot; $0est $0wo&amp;quot; &lt;br/&gt;
&lt;br/&gt;
Instead of:&lt;br/&gt;
Type: &amp;quot; Test Two&amp;quot; &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Linux</environment>
            <key id="12441268">COUCHDB-573</key>
        <summary>Regex capture problem in emit functions</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ericdes">Eric Desgranges</reporter>
            
    <created>Fri, 20 Nov 2009 06:37:23 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 11:31:04 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12780927" author="candlerb" created="Sat, 21 Nov 2009 07:39:03 +0000 (UTC)"  >There is no $0 in Javascript, but $&amp;amp; gives the whole substring which matches the regexp. You can try it out using &apos;js&apos; at the command line (under Ubuntu: install the &apos;spidermonkey-bin&apos; package)&lt;br/&gt;
&lt;br/&gt;
js&amp;gt; &apos;TestTwo&apos;.replace(/[A-Z]/g, &apos; $&amp;amp;&apos;)&lt;br/&gt;
&amp;nbsp;Test Two&lt;br/&gt;
&lt;br/&gt;
Incidentally, Ruby is the same. $0 is the name of the running script and is nothing to do with regexp captures.&lt;br/&gt;
&lt;br/&gt;
~$ irb --simple-prompt&lt;br/&gt;
&amp;gt;&amp;gt; $0&lt;br/&gt;
=&amp;gt; &amp;quot;irb&amp;quot;&lt;br/&gt;
&amp;gt;&amp;gt; &amp;quot;TestTwo&amp;quot;.gsub!(/[A-Z]/) { &amp;quot; #{$&amp;amp;}&amp;quot; }&lt;br/&gt;
=&amp;gt; &amp;quot; Test Two&amp;quot;&lt;br/&gt;
&amp;gt;&amp;gt; &lt;br/&gt;
</comment>
                    <comment id="12780929" author="candlerb" created="Sat, 21 Nov 2009 07:40:32 +0000 (UTC)"  >BTW I got an &amp;quot;Internal Server Error&amp;quot; from JIRA when adding that comment, although the comment does seem to have attached itself successfully.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 11:31:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 07:39:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-572] replication fails when a proxy gzips attachments</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-572</link>

                    <description>The replicators declares an Accept-Encoding:gzip for attachment requests,  but that&apos;s not actually true.  As a result it cannot work when talking to a proxy server that gzips responses from CouchDB.</description>
                <environment></environment>
            <key id="12441226">COUCHDB-572</key>
        <summary>replication fails when a proxy gzips attachments</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Thu, 19 Nov 2009 21:09:44 +0000 (UTC)</created>
    <updated>Thu, 19 Nov 2009 21:11:26 +0000 (UTC)</updated>

                        <version>0.10</version>
                    <version>0.10.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12780268" author="kocolosk" created="Thu, 19 Nov 2009 21:11:26 +0000 (UTC)"  >Fixed in &lt;a href=&quot;http://svn.apache.org/viewvc?revision=882295&amp;view=revision&quot;&gt;http://svn.apache.org/viewvc?revision=882295&amp;amp;view=revision&lt;/a&gt;&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 19 Nov 2009 21:11:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-571] Not Able To Use Compact (getting Error)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-571</link>

                    <description>hi,&lt;br/&gt;
i am trying to use compact option  from futon..&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;E.g. &lt;a href=&quot;http://localhost:5984/compacttest/_compact&quot;&gt;http://localhost:5984/compacttest/_compact&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Response : {&amp;quot;ok&amp;quot;:true} &lt;br/&gt;
..but nothing happens..when i look into erlang log i saw this error&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.13864.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /compacttest/_compact 202&lt;br/&gt;
[info] [&amp;lt;0.14340.0&amp;gt;] Starting compaction for db &amp;quot;compacttest&amp;quot;&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.14359.0&amp;gt; with exit value: {{badmatch,{ok,{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;16 bytes&amp;gt;&amp;gt;,&amp;lt;0.14360.0&amp;gt;,&amp;lt;0.14362.0&amp;gt;,{db_header,1,3,{4118,9978},{14413,{2,0}},{14297,2},nil,0,nil,nil,1000},{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},{btree,&amp;lt;0.14360.0&amp;gt;,{14413,{2,0}},#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},{btree,&amp;lt;0.14360.0&amp;gt;,{14297,2},#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},{btree,&amp;lt;0.14360.0&amp;gt;,nil,#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},3,&amp;lt;&amp;lt;11 bytes&amp;gt;&amp;gt;,&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,[],[],nil,{user_ctx,null,[]},nil... &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 18-Nov-2009::21:26:05 ===&lt;br/&gt;
Error in process &amp;lt;0.14359.0&amp;gt; with exit value: {{badmatch,{ok,{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;16 bytes&amp;gt;&amp;gt;,&amp;lt;0.14360.0&amp;gt;,&amp;lt;0.14362.0&amp;gt;,{db_header,1,3,{4118,9978},{14413,{2,0}},{14297,2},nil,0,nil,nil,1000},{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},{btree,&amp;lt;0.14360.0&amp;gt;,{14413,{2,0}},#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},{btree,&amp;lt;0.14360.0&amp;gt;,{14297,2},#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},{btree,&amp;lt;0.14360.0&amp;gt;,nil,#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},3,&amp;lt;&amp;lt;11 bytes&amp;gt;&amp;gt;,&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,[],[],nil,{user_ctx,null,[]},nil... &lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.14360.0&amp;gt;] ** Generic server &amp;lt;0.14360.0&amp;gt; terminating &lt;br/&gt;
** Last message in was {&apos;EXIT&apos;,&amp;lt;0.14359.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;&amp;quot;1258559765390001&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.14360.0&amp;gt;,&amp;lt;0.14362.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,1,3,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{4118,9978},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,&amp;lt;&amp;lt;&amp;quot;compacttest&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],0}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,copy_compact,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,start_copy_compact,1}]}}&lt;br/&gt;
** When Server state == {file_descriptor,prim_file,{#Port&amp;lt;0.5969&amp;gt;,1496}}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {{badmatch,{ok,{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;&amp;quot;1258559765390001&amp;quot;&amp;gt;&amp;gt;,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.14362.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,1,3,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{4118,9978},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,nil,#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,&amp;lt;&amp;lt;&amp;quot;compacttest&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],0}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,copy_compact,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,start_copy_compact,1}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 18-Nov-2009::21:26:05 ===&lt;br/&gt;
** Generic server &amp;lt;0.14360.0&amp;gt; terminating &lt;br/&gt;
** Last message in was {&apos;EXIT&apos;,&amp;lt;0.14359.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;&amp;quot;1258559765390001&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.14360.0&amp;gt;,&amp;lt;0.14362.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,1,3,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{4118,9978},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,&amp;lt;&amp;lt;&amp;quot;compacttest&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],0}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,copy_compact,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,start_copy_compact,1}]}}&lt;br/&gt;
** When Server state == {file_descriptor,prim_file,{#Port&amp;lt;0.5969&amp;gt;,1496}}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {{badmatch,{ok,{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;&amp;quot;1258559765390001&amp;quot;&amp;gt;&amp;gt;,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.14362.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,1,3,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{4118,9978},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,nil,#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,&amp;lt;&amp;lt;&amp;quot;compacttest&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],0}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,copy_compact,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,start_copy_compact,1}]}&lt;br/&gt;
[error] [&amp;lt;0.14360.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.14360.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.14360.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok,{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;&amp;quot;1258559765390001&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.14360.0&amp;gt;,&amp;lt;0.14362.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,1,3,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{4118,9978},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,&amp;lt;&amp;lt;&amp;quot;compacttest&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],0}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,copy_compact,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,start_copy_compact,1}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{couch_file,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[&amp;lt;0.14359.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[#Port&amp;lt;0.5969&amp;gt;,&amp;lt;0.14362.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,987},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,763}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{neighbour,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.14362.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{couch_ref_counter,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{current_function,{gen_server,loop,6}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[&amp;lt;0.14359.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&apos;DOWN&apos;,#Ref&amp;lt;0.0.0.63591&amp;gt;,process,&amp;lt;0.14359.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok,{{db,nil,&amp;lt;0.14359.0&amp;gt;,nil,&amp;lt;&amp;lt;&amp;quot;1258559765390001&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.14360.0&amp;gt;,&amp;lt;0.14362.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,1,3,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{4118,9978},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.14361.0&amp;gt;,&amp;lt;0.14360.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14413,{2,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.65324130&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.128706042&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.93235209&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.66861196&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{14297,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.123705295&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.30133661&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.51444615&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.14360.0&amp;gt;,nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,&amp;lt;&amp;lt;&amp;quot;compacttest&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;../usr/couch_data/compacttest.couch.compact&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,1000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],0}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,copy_compact,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,start_copy_compact,1}]}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.14360.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,runnable},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,233},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,9},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,54}]}]]}}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Microsoft windows Xp Professional version 2002 Service Pack 2 </environment>
            <key id="12441061">COUCHDB-571</key>
        <summary>Not Able To Use Compact (getting Error)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ajaypawaskar">Ajay jagdish Pawaskar</reporter>
            
    <created>Wed, 18 Nov 2009 16:00:39 +0000 (UTC)</created>
    <updated>Wed, 18 Nov 2009 16:00:39 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-570] CouchDB code improvements</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-570</link>

                    <description>Finally I&apos;ve found the time today to sign up to jira (username: kostis).&lt;br/&gt;
&lt;br/&gt;
I have a whole bunch of changes to the CouchDB code which were produced by &apos;tidier&apos; (Jan Lehnard knows about this).&lt;br/&gt;
I am wondering what&apos;s the best way of contributing them? Create an issue and attach a patch/diff file? (I&apos;ve done so)&lt;br/&gt;
Or maybe you prefer some other way?&lt;br/&gt;
&lt;br/&gt;
Also, I&apos;ve noticed that function couch_httpd:find_partial/4 returns either &apos;not_found&apos; or {partial, N, K} but the place where this result is used (couch_httpd:673 or so) checks for matching against &apos;not_found&apos; or {partial, Skip}.  Somebody needs to fix that.&lt;br/&gt;
&lt;br/&gt;
Best,&lt;br/&gt;
Kostis</description>
                <environment></environment>
            <key id="12440952">COUCHDB-570</key>
        <summary>CouchDB code improvements</summary>

            <type id="11" iconUrl="http://issues.apache.org/jira/images/icons/genericissue.gif">Question</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kostis">Kostis Sagonas</reporter>
            
    <created>Tue, 17 Nov 2009 15:58:27 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 14:06:07 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12778963" author="kocolosk" created="Tue, 17 Nov 2009 16:15:25 +0000 (UTC)"  >Thanks Kostis, in general the diff looks just fine.  Personally, I prefer not to bind too many variables in the argument list of a function and instead reserve that space for pattern matching, but in the simple cases that you/tidier chose to do this it seems fine.  I can take a closer look and apply this in the next day or two if no one beats me to it.&lt;br/&gt;
&lt;br/&gt;
Thanks for the note about the partial_find/4 function, too.  That&apos;s very fresh code from Damien, perhaps he has a chance to double-check it.</comment>
                    <comment id="12778965" author="janl" created="Tue, 17 Nov 2009 16:16:21 +0000 (UTC)"  >Thanks Kostis, this is great!&lt;br/&gt;
&lt;br/&gt;
The way of submission here is sufficient :)&lt;br/&gt;
&lt;br/&gt;
Can you add a link for other to read up on tidier?</comment>
                    <comment id="12778967" author="dionne" created="Tue, 17 Nov 2009 16:19:24 +0000 (UTC)"  >Interesting, I&apos;d like to read up on this tool also.&lt;br/&gt;
&lt;br/&gt;
couch_btree:chunkify(Bt...)  has a variable, Bt, that is never used and can be discarded. How hard would it be for tidier to detect that?</comment>
                    <comment id="12778979" author="janl" created="Tue, 17 Nov 2009 16:38:16 +0000 (UTC)"  >Bob, unused variables are usually reported by erlc.</comment>
                    <comment id="12778982" author="kocolosk" created="Tue, 17 Nov 2009 16:42:39 +0000 (UTC)"  >Yes, but not in this case because the &amp;quot;unused&amp;quot; variable is passed on to other recursive calls to chunkify.  Trouble is, none of the clauses actually use it, and the ones that don&apos;t make recursive calls bind it as _Bt.  A bit tricky to catch.</comment>
                    <comment id="12778985" author="janl" created="Tue, 17 Nov 2009 16:45:30 +0000 (UTC)"  >note to self: look at code before smart-assing.</comment>
                    <comment id="12780975" author="kocolosk" created="Sat, 21 Nov 2009 14:06:07 +0000 (UTC)"  >Thanks again, Kostis -- applied this patch as r882903</comment>
                </comments>
    
    <attachments>
            <attachment id="12425230" name="DIFFS" size="35643" author="kostis" created="Tue, 17 Nov 2009 16:02:50 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 14:06:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 17 Nov 2009 16:15:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-569] Typo when requesting a type of group that is invalid</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-569</link>

                    <description>If you go to some design document you created and pass a wrong group={arg} argument, you get the message:&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;query_parse_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Invalid value for boolean paramter: \&amp;quot;True\&amp;quot;&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Obviously the paramter word is typo&apos;ed.</description>
                <environment>OS X</environment>
            <key id="12440854">COUCHDB-569</key>
        <summary>Typo when requesting a type of group that is invalid</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="davidcoallier">David Coallier</reporter>
            
    <created>Mon, 16 Nov 2009 20:15:41 +0000 (UTC)</created>
    <updated>Mon, 16 Nov 2009 20:42:57 +0000 (UTC)</updated>

                        <version>0.10.1</version>
                    <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="60">0.02h</timeoriginalestimate>        <timeestimate seconds="60">0.02h</timeestimate>                    

            <comments>
                    <comment id="12778501" author="davidcoallier" created="Mon, 16 Nov 2009 20:16:30 +0000 (UTC)"  >Simply fix it in 2 places.</comment>
                    <comment id="12778517" author="paul.joseph.davis" created="Mon, 16 Nov 2009 20:42:57 +0000 (UTC)"  >Applied in 880951.</comment>
                </comments>
    
    <attachments>
            <attachment id="12425130" name="COUCHDB-569.patch" size="959" author="davidcoallier" created="Mon, 16 Nov 2009 20:16:30 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Nov 2009 20:42:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Nov 2009 20:42:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-568] When delayed_commits = true, keep updated btree nodes in memory until the commit</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-568</link>

                    <description>rnewson reported on IRC that the new batch=ok implementation results in significantly larger overhead in the .couch files.  This makes sense; the old batch mode waited 1 second before saving, but the new implementation just updates the doc asynchronously.  With fast hardware and moderate write rates it&apos;s likely that each document is being written separately.&lt;br/&gt;
&lt;br/&gt;
The overhead presumably arises from frequently updated btree inner nodes being written to disk many times over.  I&apos;m interested in exploring a modification of the delayed_commits mode whereby the updated btree nodes are not actually written to disk immediately, but are instead held in memory until the commit.  I&apos;d like to think that this will result in more compact files without any decrease in durability.  New read requests would still be able to access these in-memory nodes.&lt;br/&gt;
&lt;br/&gt;
I realize the notion that updates go directly to disk is baked pretty deeply into couch_btree, but I still thought this was worth bringing up to a wider audience.</description>
                <environment></environment>
            <key id="12440423">COUCHDB-568</key>
        <summary>When delayed_commits = true, keep updated btree nodes in memory until the commit</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Wed, 11 Nov 2009 16:08:33 +0000 (UTC)</created>
    <updated>Wed, 11 Nov 2009 20:44:21 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12776593" author="paul.joseph.davis" created="Wed, 11 Nov 2009 19:25:41 +0000 (UTC)"  >Definitely an interesting idea. In the thread on parallelized b~trees I was basically thinking that we could take Damien&apos;s modifications to couch_db_updater.erl and push all that logic down into couch_btree.erl which would allow multiple mappers to make more efficient use of btree updates in view generation.&lt;br/&gt;
&lt;br/&gt;
Allowing a b~tree to hold new nodes in RAM for some duration before being synced should allow for similar speedups in the  condensed tree writes like batch docs did.&lt;br/&gt;
&lt;br/&gt;
Though, this could allow for readers to see a database in a state that was never on disk. With batch writes we never allowed readers to see the docs in the write buffer, so the progression of db state was unidirectional. With pending writes viewable, an error could make the btree state go backwards. If that makes sense.&lt;br/&gt;
&lt;br/&gt;
Much to contemplate.</comment>
                    <comment id="12776597" author="kocolosk" created="Wed, 11 Nov 2009 19:31:30 +0000 (UTC)"  >Yes, an error could make the state go backwords, just like killing couch before the fsync.</comment>
                    <comment id="12776603" author="paul.joseph.davis" created="Wed, 11 Nov 2009 19:40:04 +0000 (UTC)"  >Oh, good point. I might have to focus on trying to write that code for the b~tree updater. It definitely sounds fun.</comment>
                    <comment id="12776617" author="damienkatz" created="Wed, 11 Nov 2009 19:53:45 +0000 (UTC)"  >I&apos;m not sure how much parallelizing the writes buys you much with an append only architecture. Right now with complex keys, it&apos;s possible to make the CPU the bottleneck (as we saw with the Raindrop Megaview problem), but typically the bottleneck is how fast we can stream the writes to disk. I think it would be more fruitful to optimize the current architecture for CPU and memory IO until we make the disk the bottleneck.&lt;br/&gt;
&lt;br/&gt;
Another possible optimization would be to have a bunch of uncommitted actions that stay in memory, and as you read-query the btrees, the actions are applied on the fly into the nodes at the appropriate time. I&apos;ve wanted to do this a long time, just never got around to it as it&apos;s fairly complex and would need to be applied to most every btree operation. Reductions would be trickiest.&lt;br/&gt;
&lt;br/&gt;
But with this optimization its possible to do 2 things:&lt;br/&gt;
1. virtually insert/remove stuff into the btree but not to disk.&lt;br/&gt;
2. write these actions to disk but not to the btrees, batching them up for more efficient btree inserts, and still committing them to disk. The batch amount would need to be tuned for optimal performance.</comment>
                    <comment id="12776635" author="paul.joseph.davis" created="Wed, 11 Nov 2009 20:22:49 +0000 (UTC)"  >My current idea is to have each b~tree use a pid between btree actions and the disk. This would allow writes to be collected and flushed simultaneously thus saving rewrites of the upper nodes, as well as having transparent &amp;quot;memory-only&amp;quot; edits to the tree that will be flushed some time in the future.&lt;br/&gt;
&lt;br/&gt;
Then for parallel writers, we allow them to traverse the tree and &apos;prepare writes&apos; that can be merged into the current memory state and eventually flushed. This has the benefit of releasing all of the key collation from being bound to a single core in a fairly intuitive way.&lt;br/&gt;
&lt;br/&gt;
This would also allow a mapping onto the current database delayed_commits with a write causing the nodes in RAM to all be flushed or not as well as saving on the upper node duplications.&lt;br/&gt;
&lt;br/&gt;
Or something to that effect.&lt;br/&gt;
</comment>
                    <comment id="12776646" author="damienkatz" created="Wed, 11 Nov 2009 20:44:21 +0000 (UTC)"  >I know this isn&apos;t what you are trying to achieve with the batching, but I just remembered something.&lt;br/&gt;
&lt;br/&gt;
Any easy way to parallelized actions and use more CPUs is to spawn_link a process to query/modify a sub node with a matching batch of key/actions, then move on to the next sub node and matching key/actions and do the same, etc, etc. Then you wait for your sub-pids to return back their result. The maximal # of recursive sub-processes active at any time would K*Log(N), where K is the number of keys we are query/modifying and N is the total number of entries in the index. In practice it wouldn&apos;t be that many processes, but it might want to limit the number of processses spawned anyway, depending on tuning.&lt;br/&gt;
&lt;br/&gt;
I think that actually would be a pretty good way to use more of the CPUs while updating an index, assuming you are CPU bound on writes. For reads of multiple keys, it likely would also be a performance win.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Nov 2009 19:25:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-567] Erlang View with Reduce Fails on Large Number of documents</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-567</link>

                    <description>I have been having a problem with running Erlang views over a large dataset.  Whenever the indexer goes to checkpoint it&apos;s process the following error occurs:&lt;br/&gt;
&lt;br/&gt;
** Last message in was {&apos;EXIT&apos;,&amp;lt;0.2220.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_view_updater,view_insert_doc_query_results,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{doc,&amp;lt;&amp;lt;&amp;quot;73956fdca62c384849a3313e6c48b7ed&amp;quot;&amp;gt;&amp;gt;,...&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{{view,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;&amp;lt;&amp;quot;_temp&amp;quot;&amp;gt;&amp;gt;],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;...&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.2218.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1565615,{341,[0]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.3.83553141&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.4.30790806&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_view.less_json_keys.2&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_view_group.11.46347864&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&amp;lt;&amp;lt;&amp;quot;_temp&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;...&amp;quot;&amp;gt;&amp;gt;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_view_updater,view_insert_query_results,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_view_updater,process_doc,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_view_updater,&apos;-update/2-fun-0-&apos;,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,stream_kv_node2,7},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,stream_kp_node,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,fold,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_view_updater,update,2}]]},&lt;br/&gt;
&lt;br/&gt;
This problem occurs regardless of the functionality of the map and reduce functions, it seems to based on the time it takes to generate, or whatever causes the checkpoints to get written out.&lt;br/&gt;
&lt;br/&gt;
I did some investigation into the problem by adding alot of LOG_INFO statements throughout the code.  I was able to determine the following:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;* the Erlang View process is being held on to by the view updater for the entire duration of the indexing, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;* however after the first checkpoint is hit and the progress is written out, a reduce call is made to the erlang view server, once this completes the view server is released back to the cache using ret_os_process. &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;* when the next reduce cycle occurs the same erlang view server is returned by get_os_process but it is first sent a reset message which clears all the functions in the view servers state.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;* when the next map cycles starts the view updater uses the same handle to the erlang view server it had in the beginning. It assumes that the servers state is the same however it has been reset so there are no view functions in the view server.  This causes the above error when it then attempts to write out the result of a view function which doesn&apos;t exist in the server.&lt;br/&gt;
&lt;br/&gt;
I was able to fix this problem by modifying line 139 of couch_view_updater.erl from this:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;{[], Group2, ViewEmptyKeyValues, []}&lt;br/&gt;
&lt;br/&gt;
to this:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;{[], Group2#group{query_server=nil}, ViewEmptyKeyValues, []}&lt;br/&gt;
&lt;br/&gt;
Which removes the view updater&apos;s handle to the erlang server proc, forcing it to get/create a new one for each map cycle and setting up the view functions within the server.  I don&apos;t know if this is the right way to do it, or if it has any bad side-effects, but it does prevent the crash at least, and allow the indexing to complete correctly.</description>
                <environment></environment>
            <key id="12440381">COUCHDB-567</key>
        <summary>Erlang View with Reduce Fails on Large Number of documents</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="seangeo">Sean Geoghegan</reporter>
            
    <created>Wed, 11 Nov 2009 05:07:27 +0000 (UTC)</created>
    <updated>Thu, 12 Nov 2009 07:38:43 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10.1</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12776297" author="seangeo" created="Wed, 11 Nov 2009 05:59:18 +0000 (UTC)"  >Actually, my fix breaks when the reduce function is removed.&lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure how to go about fixing this though.  I can probably provide a test case if needed though.</comment>
                    <comment id="12776332" author="paul.joseph.davis" created="Wed, 11 Nov 2009 07:09:44 +0000 (UTC)"  >Sean,&lt;br/&gt;
&lt;br/&gt;
Good detective work. If you can provide script to reproduce that&apos;d be most helpful. Hopefully I can dig into this tomorrow or Thursday.</comment>
                    <comment id="12776762" author="seangeo" created="Thu, 12 Nov 2009 00:25:19 +0000 (UTC)"  >I&apos;ve attached a Ruby script that generates some test data and a of map and reduce function for that data which triggers this error.</comment>
                    <comment id="12776798" author="paul.joseph.davis" created="Thu, 12 Nov 2009 02:19:19 +0000 (UTC)"  >Sean,&lt;br/&gt;
&lt;br/&gt;
I added a port of your Ruby test to the erlang_views.js test in Futon and can&apos;t get trunk to reproduce this error you&apos;re having. Can you try svn up&apos;ing and seeing if the error is triggered? I also did some logging and locally the process exchange with couch_query_servers goes as it should.</comment>
                    <comment id="12776810" author="seangeo" created="Thu, 12 Nov 2009 03:16:26 +0000 (UTC)"  >Thanks Paul, I&apos;ll try that out.  Note that I only experienced the error on version 0.1.0, (on both Linux and Windows).  I&apos;ll confirm that it doesn&apos;t occur on the trunk version.</comment>
                    <comment id="12776811" author="seangeo" created="Thu, 12 Nov 2009 03:16:49 +0000 (UTC)"  >Sorry, that should be 0.10.0 of course.</comment>
                    <comment id="12776817" author="paul.joseph.davis" created="Thu, 12 Nov 2009 03:30:18 +0000 (UTC)"  >Sean,&lt;br/&gt;
&lt;br/&gt;
I don&apos;t see anything in the SVN logs that affected couch_os_process.erl, couch_native_process.erl or couch_query_servers.erl that&apos;s not in the about to be released 0.10.1. And I&apos;m pretty sure that all of these commits were in 0.10.0. If you can&apos;t reproduce on trunk, you should be able to just copy that js test file to your Futon directory and see if it can be triggered on 0.10.0 though that would be most odd.</comment>
                    <comment id="12776831" author="seangeo" created="Thu, 12 Nov 2009 04:30:52 +0000 (UTC)"  >Paul,&lt;br/&gt;
&lt;br/&gt;
I tried your test case on 0.10.0 and it passed, until I increased the number of words in each document to 1000 (at 100 checkpoints weren&apos;t triggered so the error didn&apos;t occur).  So you might want to increase that number.&lt;br/&gt;
&lt;br/&gt;
I also tried with trunk and it works fine, no errors with either amount of words in each document. So that is good.  I think the fix might have been in couch_view_updater.erl. That is where I had to make my initial change to get it working.  There looks like there are a lot of changes in this file between 0.10.0 and trunk.  So backporting is probably not realistic.&lt;br/&gt;
&lt;br/&gt;
Thanks for your help with this.</comment>
                    <comment id="12776861" author="paul.joseph.davis" created="Thu, 12 Nov 2009 05:56:24 +0000 (UTC)"  >I didn&apos;t realize the number of checkpoints was important. I ported your test over directly, and then reduced the numbers to make it not take so long to run. I&apos;m testing on the 0.10.1 branch now to see if I can spot the fix.&lt;br/&gt;
&lt;br/&gt;
You&apos;re right that we can&apos;t backport all of the changes to 0.10.x, but hopefully the cause isn&apos;t too deep. I had it in my head to check couch_view_updater this afternoon but somewhere along the lines I blanked on that.&lt;br/&gt;
&lt;br/&gt;
More info shortly.</comment>
                    <comment id="12776870" author="seangeo" created="Thu, 12 Nov 2009 06:35:34 +0000 (UTC)"  >I don&apos;t know if the number of check points are important, but with only 100 elements in the words array I wasn&apos;t getting any checkpoints triggered, so there error wasn&apos;t happening.  There might be some number under 1000 that fails, I can find it if needed.</comment>
                    <comment id="12776886" author="paul.joseph.davis" created="Thu, 12 Nov 2009 07:38:43 +0000 (UTC)"  >Fixed as of 835281.&lt;br/&gt;
&lt;br/&gt;
Sean, can you try this on for size? This is only in the 0.10.x branch so you&apos;ll have to pull that form SVN and build. The 0.10.1 release will be in a day or two so this is mostly just a remote check that it&apos;s fixed.&lt;br/&gt;
&lt;br/&gt;
Too tired to write anything of interest, so here&apos;s the commit message:&lt;br/&gt;
&lt;br/&gt;
Fixes &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-567&quot; title=&quot;Erlang View with Reduce Fails on Large Number of documents&quot;&gt;&lt;strike&gt;COUCHDB-567&lt;/strike&gt;&lt;/a&gt; error with ErlView reduces.&lt;br/&gt;
&lt;br/&gt;
Apparently we never tested ErlView reductions on 0.10.x? As far as I can tell   they never should have worked. It was exactly as Sean Geoghegan described in    that the interleaved calls to reduce where trouncing the mapper state.&lt;br/&gt;
&lt;br/&gt;
Trunk uses the two process update scheme so wouldn&apos;t be affected by this        trouncing. This patch is a stop gap to make ErlViews work. I&apos;ve tested with the Futon test patch and an updated query_server_spec.rb to revalidate things are working.&lt;br/&gt;
&lt;br/&gt;
Fixing this bug has made it quite apparent that the query server specs need to be drastically rethought. I spent quite a bit of time tracking down that the specs were actually testing that the subprocess died. ErlViews causing the host process to die would be very bad. In the future I&apos;d like to see script/response sets and file stuctures for function definitions.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12424679" name="generate-data.rb" size="588" author="seangeo" created="Thu, 12 Nov 2009 00:25:19 +0000 (UTC)" />
            <attachment id="12424680" name="view.erl" size="360" author="seangeo" created="Thu, 12 Nov 2009 00:25:19 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 12 Nov 2009 07:38:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Nov 2009 07:09:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-566] Invalid database name gives 500 response</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-566</link>

                    <description>Attempting to create a database with an invalid name gives a 500 (server failed) HTTP response. IMO this should be 400 (bad request). Perhaps worth checking for other instances like this.&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/mirrorAgent1&quot;&gt;http://127.0.0.1:5984/mirrorAgent1&lt;/a&gt;  &lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;illegal_database_name&amp;quot;} &lt;br/&gt;
$ curl -v -X PUT &lt;a href=&quot;http://127.0.0.1:5984/mirrorAgent1&quot;&gt;http://127.0.0.1:5984/mirrorAgent1&lt;/a&gt;&lt;br/&gt;
* About to connect() to 127.0.0.1 port 5984 (#0)&lt;br/&gt;
*   Trying 127.0.0.1... connected&lt;br/&gt;
* Connected to 127.0.0.1 (127.0.0.1) port 5984 (#0)&lt;br/&gt;
&amp;gt; PUT /mirrorAgent1 HTTP/1.1&lt;br/&gt;
&amp;gt; User-Agent: curl/7.18.0 (i486-pc-linux-gnu) libcurl/7.18.0 OpenSSL/0.9.8g zli&lt;br/&gt;
&amp;gt; Host: 127.0.0.1:5984&lt;br/&gt;
&amp;gt; Accept: */*&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;lt; HTTP/1.1 500 Internal Server Error&lt;br/&gt;
&amp;lt; Server: CouchDB/0.11.0b831082 (Erlang OTP/R12B)&lt;br/&gt;
&amp;lt; Date: Mon, 09 Nov 2009 19:51:28 GMT   &lt;br/&gt;
&amp;lt; Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&amp;lt; Content-Length: 51&lt;br/&gt;
&amp;lt; Cache-Control: must-revalidate&lt;br/&gt;
&amp;lt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;illegal_database_name&amp;quot;}&lt;br/&gt;
* Connection #0 to host 127.0.0.1 left intact&lt;br/&gt;
* Closing connection #0&lt;br/&gt;
</description>
                <environment>0.11.0b831082</environment>
            <key id="12440205">COUCHDB-566</key>
        <summary>Invalid database name gives 500 response</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Mon, 9 Nov 2009 19:57:06 +0000 (UTC)</created>
    <updated>Mon, 9 Nov 2009 20:10:34 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12775108" author="kocolosk" created="Mon, 9 Nov 2009 20:10:33 +0000 (UTC)"  >Now we have&lt;br/&gt;
&lt;br/&gt;
$ curl localhost:5984/Foo -X PUT -i&lt;br/&gt;
HTTP/1.1 400 Bad Request&lt;br/&gt;
Server: CouchDB/0.11.0b832988 (Erlang OTP/R13B)&lt;br/&gt;
Date: Mon, 09 Nov 2009 20:07:38 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Content-Length: 154&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;illegal_database_name&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Only lowercase characters (a-z), digits (0-9), and any of the characters _, $, (, ), +, -, and / are allowed&amp;quot;}&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 9 Nov 2009 20:10:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 9 Nov 2009 20:10:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-565] docids not validated when the document is created implicitly</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-565</link>

                    <description>This query creates a document with id _reserved/id.&lt;br/&gt;
&lt;br/&gt;
curl -X PUT &lt;a href=&quot;http://localhost:5984/test/_reserved%2Fid/foo&quot;&gt;http://localhost:5984/test/_reserved%2Fid/foo&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
It seems the validation is not run, when the document is created implicitly by an attachment.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12440154">COUCHDB-565</key>
        <summary>docids not validated when the document is created implicitly</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kassens">Jan Kassens</reporter>
            
    <created>Sun, 8 Nov 2009 20:27:26 +0000 (UTC)</created>
    <updated>Tue, 10 Nov 2009 11:43:17 +0000 (UTC)</updated>

                
                        <fixVersion>0.10.1</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12774818" author="rnewson" created="Sun, 8 Nov 2009 20:30:36 +0000 (UTC)"  >Umbrage:couchdb-lucene robertnewson$ curl -X PUT &lt;a href=&quot;http://localhost:5984/db1/_reserved%2Fid/foo&quot;&gt;http://localhost:5984/db1/_reserved%2Fid/foo&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;_reserved/id&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-b0e34971cb6a0459d1fdacc81bc7c401&amp;quot;}&lt;br/&gt;
</comment>
                    <comment id="12774819" author="paul.joseph.davis" created="Sun, 8 Nov 2009 20:32:49 +0000 (UTC)"  >Ouch. Good catch. That should be easy enough to fix.</comment>
                    <comment id="12775378" author="janl" created="Tue, 10 Nov 2009 11:43:16 +0000 (UTC)"  >fixed in trunk / 0.11 (r834436) and 0.10.x (r834437)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 10 Nov 2009 11:43:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 8 Nov 2009 20:30:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-564] view_collation and view_collation_raw tests hang Chrome (Dev Channel, OS X) browser</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-564</link>

                    <description>When running the test suite in the Chrome browser on OS X all tests pass until the view_collation test is reached.  It begins running but hangs the browser and pegs the CPU.  Eventually the specific browser process (specific tab) will need to be killed.&lt;br/&gt;
&lt;br/&gt;
This also happens if either the view_collation or view_collation_raw tests are run individually.&lt;br/&gt;
&lt;br/&gt;
All of the tests after view_collation and view_collation_raw run cleanly when run manually later so it appears that only these two cause trouble.&lt;br/&gt;
&lt;br/&gt;
Nothing is shown in the developer tools console in Chrome.&lt;br/&gt;
&lt;br/&gt;
The same test suite runs clean all the way through when run immediately after in a Safari 4.0.3 browser without any restart of CouchDB required.</description>
                <environment>OS X 10.6.1, Macbook Pro, 64 bit, Core2Duo; Google Chrome Dev Channel Release 4.0.229.1; CouchDB &lt;a href=&apos;mailto:trunk@833219&apos;&gt;trunk@833219&lt;/a&gt;</environment>
            <key id="12440060">COUCHDB-564</key>
        <summary>view_collation and view_collation_raw tests hang Chrome (Dev Channel, OS X) browser</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Fri, 6 Nov 2009 21:06:08 +0000 (UTC)</created>
    <updated>Thu, 28 Jan 2010 12:44:30 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12805896" author="samstokes" created="Thu, 28 Jan 2010 12:44:30 +0000 (UTC)"  >I have the same issue in Chrome on Linux (x86_64) - test suite runs fine up until view_collation, then hangs indefinitely.  (The Chrome process for the tab running the tests also seems to gobble up around a GB of RAM.)  All tests run fine in Firefox 3.5 on the same OS.&lt;br/&gt;
&lt;br/&gt;
CouchDB version: 0.10.1 release tarball.&lt;br/&gt;
Chrome version: 4.0.302.2 dev&lt;br/&gt;
OS version: Ubuntu 9.04 x86_64&lt;br/&gt;
&lt;br/&gt;
I compiled CouchDB from the tarball using the Javascript library from XULRunner 1.9.1.7.  I used the following commands:&lt;br/&gt;
&lt;br/&gt;
LD_RUN_PATH=/usr/lib/xulrunner-1.9.1.7 ./configure --with-js-lib=/usr/lib/xulrunner-devel-1.9.1.7/lib/ --with-js-include=/usr/lib/xulrunner-devel-1.9.1.7/include --prefix=/home/sam/packages/apache-couchdb-0.10.1&lt;br/&gt;
&lt;br/&gt;
LD_RUN_PATH=/usr/lib/xulrunner-1.9.1.7 make -j3</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 28 Jan 2010 12:44:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-563] Typo in couch_view_updater.erl</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-563</link>

                    <description>There is a typo on three lines in couch_view_updater.erl where the Var name &apos;IntitalBuild&apos; should be &apos;InitialBuild&apos;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
diff --git a/src/couchdb/couch_view_updater.erl&lt;br/&gt;
b/src/couchdb/couch_view_updater.erl&lt;br/&gt;
index 6f04d93..475f59a 100644&lt;br/&gt;
--- a/src/couchdb/couch_view_updater.erl&lt;br/&gt;
+++ b/src/couchdb/couch_view_updater.erl&lt;br/&gt;
@@ -137,7 +137,7 @@ do_maps(Group, MapQueue, WriteQueue, ViewEmptyKVs) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;do_maps(Group1, MapQueue, WriteQueue, ViewEmptyKVs)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end.&lt;br/&gt;
&lt;br/&gt;
-do_writes(Parent, Owner, Group, WriteQueue, IntitalBuild) -&amp;gt;&lt;br/&gt;
+do_writes(Parent, Owner, Group, WriteQueue, InitialBuild) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case couch_work_queue:dequeue(WriteQueue) of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;closed -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Parent ! {new_group, Group};&lt;br/&gt;
@@ -155,12 +155,12 @@ do_writes(Parent, Owner, Group, WriteQueue,&lt;br/&gt;
IntitalBuild) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;AccViewKVs2, DocIdViewIdKeys ++ AccDocIdViewIdKeys}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end, nil, Queue),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Group2 = write_changes(Group, ViewKeyValues, DocIdViewIdKeys, NewSeq,&lt;br/&gt;
-                IntitalBuild),&lt;br/&gt;
+                InitialBuild),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case Owner of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil -&amp;gt; ok;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_ -&amp;gt; ok = gen_server:cast(Owner, {partial_update, Parent, Group2})&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end,&lt;br/&gt;
-        do_writes(Parent, Owner, Group2, WriteQueue, IntitalBuild)&lt;br/&gt;
+        do_writes(Parent, Owner, Group2, WriteQueue, InitialBuild)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;view_insert_query_results([], [], ViewKVs, DocIdViewIdKeysAcc) -&amp;gt;&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12439968">COUCHDB-563</key>
        <summary>Typo in couch_view_updater.erl</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Thu, 5 Nov 2009 20:17:40 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 17:22:16 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12781013" author="kocolosk" created="Sat, 21 Nov 2009 17:22:16 +0000 (UTC)"  >fixed by davisp in r880951</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:22:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:22:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-562] link couchjs with bound libmozjs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-562</link>

                    <description>If you build the couchdb from the source with a prefix set and --with-js-[lib|include] option the resulting couchjs programm in &amp;lt;prefix&amp;gt;/lib/couchdb/bin/couchjs does not know where to find the specified libmozjs.so which was specified in with-js-lib. This causes that quite all test will fail. &lt;br/&gt;
&lt;br/&gt;
To fix this the rpath has to setup during the compile. I don&apos;t had a look where to do this.&lt;br/&gt;
&lt;br/&gt;
but a small shell wrapper fix it also&lt;br/&gt;
#!/bin/sh&lt;br/&gt;
LD_LIBRARY_PATH=...  exec $0.orig $@</description>
                <environment>linux, ubuntu,debian</environment>
            <key id="12439919">COUCHDB-562</key>
        <summary>link couchjs with bound libmozjs</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="menoabels">Meno Abels</reporter>
            
    <created>Thu, 5 Nov 2009 07:58:46 +0000 (UTC)</created>
    <updated>Tue, 2 Feb 2010 00:58:32 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12773956" author="kocolosk" created="Thu, 5 Nov 2009 15:59:18 +0000 (UTC)"  >I&apos;d like to avoid LD_LIBRARY_PATH if at all possible.  It seems to have so many side-effects on OS X when a user has a fairly large MacPorts install.&lt;br/&gt;
&lt;br/&gt;
Definitely in favor of the rpath solution, though.</comment>
                    <comment id="12773958" author="menoabels" created="Thu, 5 Nov 2009 16:03:55 +0000 (UTC)"  >LD_LIBRARY_PATH is not a solution, it&apos;s just a hotfix. I make all js stuff slower and has side effects.</comment>
                    <comment id="12774931" author="candlerb" created="Mon, 9 Nov 2009 10:32:07 +0000 (UTC)"  >I belive that setting rpath is done using LD_RUN_PATH at compile time.&lt;br/&gt;
&lt;br/&gt;
The following works for me:&lt;br/&gt;
&lt;br/&gt;
$ ./bootstrap&lt;br/&gt;
$ LD_RUN_PATH=/usr/lib/xulrunner-1.9.1.4 ./configure --with-js-lib=/usr/lib/xulrunner-1.9.1.4 --with-js-include=/usr/lib/xulrunner-devel-1.9.1.4/include&lt;br/&gt;
$ LD_RUN_PATH=/usr/lib/xulrunner-1.9.1.4 make &amp;amp;&amp;amp; sudo make install&lt;br/&gt;
&lt;br/&gt;
You can confirm that the binary has the library location coded into it:&lt;br/&gt;
&lt;br/&gt;
$ ldd /usr/local/lib/couchdb/bin/couchjs | grep moz&lt;br/&gt;
	libmozjs.so =&amp;gt; /usr/lib/xulrunner-1.9.1.4/libmozjs.so (0x0031e000)&lt;br/&gt;
&lt;br/&gt;
So the solution might be just to include the above in the documentation. It would be nice if ./configure could carry the LD_RUN_PATH setting forward. And/or, it could append the --with-js-lib value onto any existing LD_RUN_PATH.&lt;br/&gt;
</comment>
                    <comment id="12828378" author="janl" created="Tue, 2 Feb 2010 00:58:32 +0000 (UTC)"  >Bump to 0.11.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 5 Nov 2009 15:59:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-561] JSLint errors in jquery.couch.js</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-561</link>

                    <description>This patch fixes the jslint errors in jquery.couch.js</description>
                <environment></environment>
            <key id="12439798">COUCHDB-561</key>
        <summary>JSLint errors in jquery.couch.js</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kassens">Jan Kassens</reporter>
            
    <created>Tue, 3 Nov 2009 23:02:00 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 23:02:44 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
            <attachment id="12423966" name="jslintErrors.patch" size="1825" author="kassens" created="Tue, 3 Nov 2009 23:02:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-560] uuidCache should not be a global variable</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-560</link>

                    <description>uuidCache in jquery.couch.js is global, but should be a private variable.</description>
                <environment></environment>
            <key id="12439795">COUCHDB-560</key>
        <summary>uuidCache should not be a global variable</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kassens">Jan Kassens</reporter>
            
    <created>Tue, 3 Nov 2009 22:35:11 +0000 (UTC)</created>
    <updated>Tue, 2 Feb 2010 00:54:06 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12773253" author="kassens" created="Tue, 3 Nov 2009 22:36:48 +0000 (UTC)"  >fix</comment>
                    <comment id="12828376" author="janl" created="Tue, 2 Feb 2010 00:54:06 +0000 (UTC)"  >Applied in r905483.</comment>
                </comments>
    
    <attachments>
            <attachment id="12423962" name="uuidCache.patch" size="519" author="kassens" created="Tue, 3 Nov 2009 22:36:48 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 2 Feb 2010 00:54:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 2 Feb 2010 00:54:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-559] 0.9.1 pushing to 0.10.0 fails b/c of list_to_existing_atom(&quot;disk_format_version&quot;).</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-559</link>

                    <description>The atom disk_format_version doesn&apos;t appear in 0.9.1, but in 0.10.0 it&apos;s part of the info returned by GET /dbname.  If an 0.9.1 server tries to push to 0.10.0, it&apos;ll fail trying to decode &amp;quot;disk_format_version&amp;quot; into an existing atom.&lt;br/&gt;
&lt;br/&gt;
Not sure at this point about the best workaround.</description>
                <environment></environment>
            <key id="12439790">COUCHDB-559</key>
        <summary>0.9.1 pushing to 0.10.0 fails b/c of list_to_existing_atom(&quot;disk_format_version&quot;).</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 3 Nov 2009 21:43:38 +0000 (UTC)</created>
    <updated>Wed, 4 Nov 2009 17:34:38 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.9.2</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12773562" author="janl" created="Wed, 4 Nov 2009 17:03:52 +0000 (UTC)"  >Can we look at the user agent string and have 0.10 omit disk_format_version if the agent reports a 0.9.x couch?</comment>
                    <comment id="12773571" author="janl" created="Wed, 4 Nov 2009 17:18:58 +0000 (UTC)"  >0.9 doesn&apos;t send a user agent string. nevermind.</comment>
                    <comment id="12773577" author="kocolosk" created="Wed, 4 Nov 2009 17:34:38 +0000 (UTC)"  >Patched the 0.9.x branch to fix the list_to_existing_atom error.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Nov 2009 17:34:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Nov 2009 17:03:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-558] Validate Content-MD5 request headers on uploads</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-558</link>

                    <description>We could detect in-flight data corruption if a client sends a Content-MD5 header along with the data and Couch validates the MD5 on arrival.&lt;br/&gt;
&lt;br/&gt;
RFC1864 - The Content-MD5 Header Field&lt;br/&gt;
&lt;a href=&quot;http://www.faqs.org/rfcs/rfc1864.html&quot;&gt;http://www.faqs.org/rfcs/rfc1864.html&lt;/a&gt;</description>
                <environment></environment>
            <key id="12439698">COUCHDB-558</key>
        <summary>Validate Content-MD5 request headers on uploads</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 2 Nov 2009 19:53:44 +0000 (UTC)</created>
    <updated>Fri, 15 Jan 2010 15:38:13 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772685" author="rnewson" created="Mon, 2 Nov 2009 20:58:07 +0000 (UTC)"  >This would be very useful but I think there will be pushback for choosing MD5 (Yes, it&apos;s not broken for this usage but try educating PHB&apos;s). A database creation time configuration for other digest algorithms would be cool, though I appreciate Erlang is limited in its choice (the only other choice is sha1, iirc?)</comment>
                    <comment id="12772694" author="kocolosk" created="Mon, 2 Nov 2009 21:10:00 +0000 (UTC)"  >Bah, what a shame.  I think we ought to go ahead and implement Content-MD5 anyway -- we can always add other algorithms in addition to it.  And I believe you&apos;re right, sha1 is the only other choice in the crypto module.</comment>
                    <comment id="12772725" author="rnewson" created="Mon, 2 Nov 2009 22:29:10 +0000 (UTC)"  >MD5 is fine for guarding against transmission errors and checking against corruption. That is, the current uses are just fine, imo. I do expect to have to convince my PHB that using MD5 is fine (we currently use SHA256 for essentially the same thing), but that&apos;s my sorrow, not yours. :)&lt;br/&gt;
&lt;br/&gt;
IIRC, I believe S3 uses this header (and therefore MD5) for the same purpose.</comment>
                    <comment id="12772742" author="damienkatz" created="Mon, 2 Nov 2009 23:07:57 +0000 (UTC)"  >Robert is correct, MD5 is fine for validating integrity, and as far as I know, it&apos;s the only hash function that&apos;s standardized in HTTP.&lt;br/&gt;
&lt;br/&gt;
For fully secure, unspoofable transmission, SSL is the way to go anyway.</comment>
                    <comment id="12778001" author="fdmanana" created="Sat, 14 Nov 2009 22:06:49 +0000 (UTC)"  >Hello,&lt;br/&gt;
&lt;br/&gt;
I would like to have some feedback about this patch. I am learning Erlang, as well as CouchDB&apos;s implementation, so this is a good exercise for me and, hopefully, a good contribution to CouchDB.&lt;br/&gt;
&lt;br/&gt;
JavaScript test case is included.&lt;br/&gt;
&lt;br/&gt;
A suggestion:&lt;br/&gt;
&lt;br/&gt;
Don&apos;t you agree it would be also interesting to have a config option for CouchDB to include MD5 digests for GET replies? This way the client side could validate the integrity of the messages received from CouchDB.&lt;br/&gt;
&lt;br/&gt;
best regards,&lt;br/&gt;
Filipe Manana</comment>
                    <comment id="12778012" author="fdmanana" created="Sat, 14 Nov 2009 22:55:23 +0000 (UTC)"  >Removed some debug log statements from the first patch as well as minor garbage used for my own debugging.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12778031" author="paul.joseph.davis" created="Sun, 15 Nov 2009 00:41:47 +0000 (UTC)"  >Filipe,&lt;br/&gt;
&lt;br/&gt;
Overall it looks pretty good, but a couple points:&lt;br/&gt;
&lt;br/&gt;
* We should probably be checking the Content-MD5 before we process the request.&lt;br/&gt;
* check_integrity should probably throw an error or return the body&lt;br/&gt;
* You should still be recording stats even when validation fails&lt;br/&gt;
* There are alot of variable assignments where they aren&apos;t necessary.&lt;br/&gt;
* keep lines less than 80 characters&lt;br/&gt;
* The perl in the JS test is ungood. Either paste it here, or better, use an Erlang test to check.&lt;br/&gt;
* really_long_function_names_are_hard_to_read - The functions for trailers could be made more generic.&lt;br/&gt;
* The check for Content-MD5 appears to be case sensitive&lt;br/&gt;
* get_has_from_trailer is weird... oh its an rstrip. There&apos;s probably a better way to do that. Try referencing how Mochiweb parses its headers.&lt;br/&gt;
&lt;br/&gt;
I think the idea is pretty solid. The only thing I&apos;m a bit concerned about is the trailier parsing. The current bits are a bit awkard. In a perfect world id prefer to see that as a patch to mochiweb, but having it in CouchDB is fine if they rejected that patch or during the time it takes to get into upstream.&lt;br/&gt;
&lt;br/&gt;
Also, if you take the approach of having your hash matching function just throw an error that will get caught by the try/catch around the HandleReq() call, it should simplify a whole lot of this.&lt;br/&gt;
&lt;br/&gt;
If none of that makes any sense let me know and I&apos;ll refactor the patch locally to try and explain things more concretely.</comment>
                    <comment id="12778084" author="fdmanana" created="Sun, 15 Nov 2009 10:36:19 +0000 (UTC)"  >Hi Paul,&lt;br/&gt;
&lt;br/&gt;
I do agree.&lt;br/&gt;
&lt;br/&gt;
Regarding the comment of fhe first bullet point &amp;quot;We should probably be checking the Content-MD5 before we process the request&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
Isn&apos;t this the case? I mean, HandlerFun(Req) is invoked only if check_integrity() returns {ok, _}. Also, if the check is successful, check_integrity returns a new #httpd record with the req_body field set, therefore any subsequent calls to body() will use that new #httpd record.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll change my code to follow your suggestions.&lt;br/&gt;
I&apos;ll submit another patch in a few days.&lt;br/&gt;
&lt;br/&gt;
Thanks for the feedback</comment>
                    <comment id="12778107" author="fdmanana" created="Sun, 15 Nov 2009 14:40:57 +0000 (UTC)"  >Hi again Paul,&lt;br/&gt;
&lt;br/&gt;
I already improved on some of the points you made:&lt;br/&gt;
&lt;br/&gt;
* check_integrity should probably throw an error or return the body -&amp;gt; DONE&lt;br/&gt;
* You should still be recording stats even when validation fails -&amp;gt; DONE&lt;br/&gt;
* There are alot of variable assignments where they aren&apos;t necessary -&amp;gt; DONE&lt;br/&gt;
* keep lines less than 80 characters -&amp;gt; DONE&lt;br/&gt;
* really_long_function_names_are_hard_to_read - The functions for trailers could be made more generic. -&amp;gt; DONE&lt;br/&gt;
* The check for Content-MD5 appears to be case sensitive -&amp;gt; DONE&lt;br/&gt;
* ...having your hash matching function just throw an error that will get caught by the try/catch around the HandleReq() call -&amp;gt; DONE&lt;br/&gt;
&lt;br/&gt;
* &amp;quot;the only thing I&apos;m a bit concerned about is the trailier parsing. The current bits are a bit awkard. In a perfect world id prefer to see that as a patch to mochiweb, but having it in CouchDB is fine if they rejected that patch or during the time it takes to get into upstream.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Well, the read_length(0) function from mochiweb_request.erl is awkard, as it gives us the trailer as a list of binaries. In mochiweb_headers.erl, we can create a Mochiweb Headers structure only from [ {key(), value()} ] lists.&lt;br/&gt;
Therefore, in this patch, I added this little function to couch_httpd.erl:&lt;br/&gt;
&lt;br/&gt;
%% @spec to_mochiweb_headers([binary()]) -&amp;gt; headers()&lt;br/&gt;
%%&lt;br/&gt;
%% Transforms the given binary list into a Mochiweb&lt;br/&gt;
%% headers structure. Each binary is a raw HTTP header&lt;br/&gt;
%% line (e.g. &amp;lt;&amp;lt;&amp;quot;Content-Lengh: 345\r\n&amp;quot;&amp;gt;&amp;gt;).&lt;br/&gt;
%%&lt;br/&gt;
to_mochiweb_headers(BinaryList) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, R} = re:compile(&amp;quot;^(.*?):\s+(.*?)\r\n$&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;F = fun(Bin, Acc) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{match, [_, H, V]} = re:run(Bin, R, [{capture, all, list}]),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[ {H, V} | Acc ]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;mochiweb_headers:make(lists:foldr(F, [], BinaryList)).&lt;br/&gt;
&lt;br/&gt;
Then I can get values from it like a normal header: &amp;quot;mochiweb_headers:get_value(&amp;quot;Content-MD5&amp;quot;, Trailer)&amp;quot;.&lt;br/&gt;
This is case insensitive.&lt;br/&gt;
&lt;br/&gt;
I would like to know you point of views for:&lt;br/&gt;
&lt;br/&gt;
1) I think I&apos;ll submit a patch to Mochiweb, where I add that little function to mochiweb_utils.erl or mochiweb_headers.erl.&lt;br/&gt;
&lt;br/&gt;
2) Look into the self explanatory comment of the function update_req/2 that I added. What do you think?&lt;br/&gt;
&lt;br/&gt;
I will write the Erlang test suite soon :)&lt;br/&gt;
&lt;br/&gt;
thanks&lt;br/&gt;
&lt;br/&gt;
Best regards,&lt;br/&gt;
Filipe Manana&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12778136" author="paul.joseph.davis" created="Sun, 15 Nov 2009 18:12:41 +0000 (UTC)"  >Filipe,&lt;br/&gt;
&lt;br/&gt;
This is looking much better. I dunno what I was thinking about the HandleReq earlier.&lt;br/&gt;
&lt;br/&gt;
I definitely like the new approach to handling the trailiers and so on. Though, this feels like it should be part of mochiweb_request.erl and this code would just call a single function that would automatically do the trailer detection and parsing. Ideally it&apos;d be mostly transparent to something like Req:body() as well.&lt;br/&gt;
&lt;br/&gt;
The to_mochiweb_headers should probably use an existing mochiweb function for header parsing so that we can blame someone when its not right. I&apos;m pretty sure that regexp would break with white space left of the colon and leaves whitespace after the value.&lt;br/&gt;
&lt;br/&gt;
The update_req function looks pretty good at first pass. One of the benefits of pushing this upstream is that they&apos;ll review it as well to make sure we&apos;re not missing anything.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Hmmm. I just thought, if an attachment request comes in with a content-md5 header, this patch is going to try and buffer that in RAM. That&apos;s obviously not good. To overcome that you&apos;ll need to push almost all of that logic into mochiweb_request.erl to do this properly. This means delaying md5 on chunked transfers until the trailers are read. Then as soon as you can check the md5, just throw that same exception.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12778142" author="paul.joseph.davis" created="Sun, 15 Nov 2009 18:23:50 +0000 (UTC)"  >Oh my bad, I haven&apos;t had my required intake of chemicals to think clearly, but I don&apos;t think this going to be completely doable directly in mochiweb_request.erl. Which means that this might have to spider into the individual handler functions.&lt;br/&gt;
&lt;br/&gt;
Basically, I can&apos;t think of a good place where we differentiate between attachment requests that are streamed to disk and requests that are buffered. Preferably this patch would just work regardless, but I&apos;m having a hard time to come up with a method that wouldn&apos;t require putting guards on each handler function which is obviously less than ideal.</comment>
                    <comment id="12778194" author="fdmanana" created="Sun, 15 Nov 2009 23:42:17 +0000 (UTC)"  >Thanks again for your feedback and point of view Paul,&lt;br/&gt;
&lt;br/&gt;
regarding the remark:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;The to_mochiweb_headers should probably use an existing mochiweb function for header parsing so that we can blame someone when its not right. I&apos;m pretty sure that regexp would break with white space left of the colon and leaves whitespace after the value.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Well, mochiweb obtains an header&apos;s name and value directly from a call to gen_tcp:recv() for a socket configured with:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet:setopts(Socket, [{packet, http}])    (mochiweb_http.erl)&lt;br/&gt;
&lt;br/&gt;
Example in mochiweb_http.erl:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case gen_tcp:recv(Socket, 0, ?IDLE_TIMEOUT) of&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, {http_header, _, Name, _, Value}} -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;headers(Socket, Request, [{Name, Value} | Headers], Body,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1 + HeaderCount);&lt;br/&gt;
&lt;br/&gt;
I couldn&apos;t find any function in mochiweb for parsing an header&apos;s name and value from a raw http header line string/binary :(&lt;br/&gt;
&lt;br/&gt;
In the meanwhile I&apos;am improving my regex to something like: &amp;quot;^\s*(.*?)\s*:\s*(.*?)\s*\r\n$&amp;quot;&lt;br/&gt;
I haven&apos;t looked yet into the source code of gen_tcp:recv().. Maybe there&apos;s a regex there I can take :)&lt;br/&gt;
&lt;br/&gt;
Yes, this RAM buffering might be problematic. With the statement &amp;quot;This means delaying md5 on chunked transfers until the trailers are read&amp;quot;, what do you mean exactly? That instead of buffering in couch_httpd, to do the buffering in mochiweb&apos;s code? If so, is it only for a better design cause or do you have something else in mind?&lt;br/&gt;
&lt;br/&gt;
Also, while I am looking into how to write the Erlang tests with ETAP, I found a small issue with test/etap/run.tpl.&lt;br/&gt;
The attached patch fixes the problem.&lt;br/&gt;
&lt;br/&gt;
cheers&lt;br/&gt;
</comment>
                    <comment id="12778197" author="paul.joseph.davis" created="Mon, 16 Nov 2009 00:10:48 +0000 (UTC)"  >Filipe, &lt;br/&gt;
&lt;br/&gt;
I see what you mean about the gen_tcp:recv() call. Though there are functions in mochiweb_multipart.erl that&apos;ll parse the headers. They might need a bit of generalization though. The most important part is the call to mochiweb_util:parse_header(Value). Although, looking at it, I don&apos;t detect how they do multiple line values which is most odd. I&apos;d have to go back to the mime RFCs to figure out what&apos;s what on that end.&lt;br/&gt;
&lt;br/&gt;
The comment on delaying the check aimed at the attachment API which streams data from the socket to disk. This patch will have to figure out how to make that streaming check the MD5 in a trailer without buffering requests. I&apos;m not sure if there&apos;s a good way to sneak this into the mochiweb_request code, or if there&apos;s a way to sneak into the couchdb code for reading bodies or what. Ideally, it wouldn&apos;t require changing the attachment handling code because that&apos;d mean we&apos;re probably doing it wrong. Ideally it should be part of the request interface so that we don&apos;t have to sprinkle MD5 validation throughout all request handlers.&lt;br/&gt;
&lt;br/&gt;
That ETAP error is because the script isn&apos;t marked as executable. I&apos;m pretty sure that won&apos;t pass through an SVN diff so I&apos;ll make that change with the -v flag which is generally why you want to run a single test at a time.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12778336" author="fdmanana" created="Mon, 16 Nov 2009 13:22:41 +0000 (UTC)"  >Hum,&lt;br/&gt;
&lt;br/&gt;
The mochiweb_multipart:parse_headers function will call mochiweb_utils:parse_header which expects the header values to be of the form &amp;quot;X; Y=Z&amp;quot; as far as I understood from the source and the test method:&lt;br/&gt;
&lt;br/&gt;
test_parse_header() -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;multipart/form-data&amp;quot;, [{&amp;quot;boundary&amp;quot;, &amp;quot;AaB03x&amp;quot;}]} =&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;parse_header(&amp;quot;multipart/form-data; boundary=AaB03x&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve just discovered this now: &lt;a href=&quot;http://www.erlang.org/doc/man/erlang.html#decode_packet-3&quot;&gt;http://www.erlang.org/doc/man/erlang.html#decode_packet-3&lt;/a&gt;&lt;br/&gt;
Maybe if we pass the full trailer binary, it will be able to decode it as an http header. To be tested.&lt;br/&gt;
&lt;br/&gt;
Regarding the integrity checks of chunked requests, I just had an idea (but complicated, with a poor performance and incomplete):&lt;br/&gt;
&lt;br/&gt;
1) In the ChunksFun, as soon as the amount of data (sum of the length of the chunks received so far) reaches a certain value X, we start putting the chunks in a temporary file. The name of the file is put in the current state #httpd{} record.&lt;br/&gt;
&lt;br/&gt;
2) After receiving the whole request, compute the MD5 digest and compare it to the given digest. If they do not match, remove the tmp file and the file name entry in #httpd{}.&lt;br/&gt;
&lt;br/&gt;
3) The update_req/2 function will no longer replace the chunked http request with a non-chunked http request.&lt;br/&gt;
&lt;br/&gt;
4) Modify the recv_chunked function (couch_httpd.erl) to check if the given #httpd record as a tmp file name in it. If so, it will read each chunk from it and pass it to given ChunkFun callback.&lt;br/&gt;
&lt;br/&gt;
Major obvious problems:&lt;br/&gt;
&lt;br/&gt;
1) too complicated solution&lt;br/&gt;
2) poor disk performance if we have large requests and many in parallel&lt;br/&gt;
3) after crashes, we risk having useless tmp files lying around on disk&lt;br/&gt;
4) to compute the md5 digest, we still need to read the whole content (&amp;quot;unchunked&amp;quot;) into memory. Do you now of any &amp;quot;incremental&amp;quot; MD5 digest implementation? I&apos;ve never heard about it.&lt;br/&gt;
&lt;br/&gt;
Have you come up with any idea of this sort?&lt;br/&gt;
&lt;br/&gt;
Possibly it might be interesting to check how httpd servers like Apache deal with this situation (if they do, or they just buffer all the chunks in memory).&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12778449" author="paul.joseph.davis" created="Mon, 16 Nov 2009 18:53:23 +0000 (UTC)"  >Filipe,&lt;br/&gt;
&lt;br/&gt;
decode_packet looks like it&apos;s what we want. But I&apos;d have to play with it some to see for certain.&lt;br/&gt;
&lt;br/&gt;
Also, sorry to not mention this earlier, but attachments already calculate their MD5 as they&apos;re streamed to disk. Every MD5 implementation I&apos;ve ever seen has an incremental implementation with a one call shortcut. Hashing algorithms like these are generally designed for exactly this reason of avoiding an entire copy of the dataset in RAM.&lt;br/&gt;
&lt;br/&gt;
The temp file solution is far too complex, but we already have access to a computed MD5 so it shouldn&apos;t be necessary. All that should be necessary is adding the code to parse out footers when they&apos;re reached.</comment>
                    <comment id="12778587" author="fdmanana" created="Mon, 16 Nov 2009 22:07:04 +0000 (UTC)"  >Definitely, erlang:decode_packet/3 works fine, so now the trailer function is:&lt;br/&gt;
&lt;br/&gt;
%% @spec to_mochiweb_headers([binary()]) -&amp;gt; headers()&lt;br/&gt;
%%&lt;br/&gt;
%% Transforms the given binary list into a Mochiweb&lt;br/&gt;
%% headers structure. Each binary is a raw HTTP header&lt;br/&gt;
%% line (e.g. &amp;lt;&amp;lt;&amp;quot;Content-Lengh: 345\r\n&amp;quot;&amp;gt;&amp;gt;).&lt;br/&gt;
%%&lt;br/&gt;
to_mochiweb_headers(BinaryList) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;F = fun(Bin, Acc) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ ok, {http_header, _, H, _, V}, _ } =&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;erlang:decode_packet(httph, list_to_binary([Bin,&amp;quot;\r\n&amp;quot;]), []),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[ {H, V} | Acc ]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;mochiweb_headers:make(lists:foldr(F, [], BinaryList)).&lt;br/&gt;
&lt;br/&gt;
Works fine as long as mochiweb returns the trailer as a list of binaries having the format &amp;lt;&amp;lt;&amp;quot;Header: value\r\n&amp;quot;&amp;gt;&amp;gt;.&lt;br/&gt;
&lt;br/&gt;
Hum, I was not aware that the attachment handling code already calculate MD5 digests and neither that it was possible to calculate MD5 digests incrementally&lt;br/&gt;
&lt;br/&gt;
I am looking into couch_db.erl, flush_att() function, where the trailer (named footer there) is ignored. I&apos;ll take some time to have a good understanding of how the doc attachment works. This is a completely unfamiliar territory for me.&lt;br/&gt;
&lt;br/&gt;
I see that whenever a chunk is received, it is immediately written to an output stream, and an incremental MD5 is calculated. Is this MD5 currently used for something?&lt;br/&gt;
When receiving the trailer, if it contains a Content-MD5 header and the value doesn&apos;t match the one calculated by couchdb, what would be the action to take? Just report an error? Or something more radical like deleting the attachment or mark it as corrupted?&lt;br/&gt;
&lt;br/&gt;
Thanks for the tip.&lt;br/&gt;
&lt;br/&gt;
best regards</comment>
                    <comment id="12778630" author="paul.joseph.davis" created="Mon, 16 Nov 2009 23:05:18 +0000 (UTC)"  >That header parsing makes me feel a lot better. If that decode_packet can take a whole binary and return a list of headers, we might want to avoid the header function in mochiweb_multipart.erl as I don&apos;t think it was accounting for multi-line headers which I&apos;m pretty sure are valid.&lt;br/&gt;
&lt;br/&gt;
As to attachment handling, basically if you get to the trailer and the MD5&apos;s don&apos;t match, just throw an error when they don&apos;t match and let the normal error handling code take over. Assuming that code works out all right, I think we could end up just patching mochiweb_request.erl to check MD5&apos;s when reading the body to protect all other handlers.</comment>
                    <comment id="12778746" author="fdmanana" created="Tue, 17 Nov 2009 07:17:24 +0000 (UTC)"  >I even prefer:&lt;br/&gt;
&lt;br/&gt;
%% @spec to_mochiweb_headers(binary()) -&amp;gt; headers() &lt;br/&gt;
%% &lt;br/&gt;
%% Transforms the given binary, which represents a full raw&lt;br/&gt;
%% HTTP header (ending with double CRLF) into a mochiweb headers&lt;br/&gt;
%% structure.&lt;br/&gt;
%% &lt;br/&gt;
to_mochiweb_headers(RawHttpHeader) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;to_mochiweb_headers(RawHttpHeader, []).&lt;br/&gt;
&lt;br/&gt;
to_mochiweb_headers(RawHttpHeader, Acc) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ ok, {http_header, _, H, _, V}, Rest } =&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;erlang:decode_packet(httph, RawHttpHeader, []),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case Rest of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;\r\n&amp;quot;&amp;gt;&amp;gt; -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;mochiweb_headers:make([{H, V} | Acc]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;R -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;to_mochiweb_headers(R, [{H, V} | Acc])&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end.&lt;br/&gt;
&lt;br/&gt;
This way we just pass an entire raw header, e.g.  to_mochiweb_headers( ?l2b( [TrailerFromMochiweb, &amp;quot;\r\n&amp;quot;] ) ).&lt;br/&gt;
In this case, it should go to mochiweb_header.erl or mochiweb_util.erl.&lt;br/&gt;
&lt;br/&gt;
Everything seems more clear now.&lt;br/&gt;
&lt;br/&gt;
Does couchdb has custom code in the mochiweb lib found in its source repository? Or it&apos;s just the plain, standard mochiweb lib duplicated from googlecode?&lt;br/&gt;
</comment>
                    <comment id="12778795" author="fdmanana" created="Tue, 17 Nov 2009 09:49:15 +0000 (UTC)"  >I&apos;ve just submitted a patch for mochiweb:  &lt;a href=&quot;http://mochiweb.googlecode.com/issues/attachment?aid=-3623435624803196521&amp;name=useful_functions.patch&quot;&gt;http://mochiweb.googlecode.com/issues/attachment?aid=-3623435624803196521&amp;amp;name=useful_functions.patch&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12780898" author="fdmanana" created="Sat, 21 Nov 2009 03:00:07 +0000 (UTC)"  >Hello,&lt;br/&gt;
&lt;br/&gt;
Paul, I took some time to go further from couch_httpd/couch_httpd_db and explore couch_db  and couch_stream as well.&lt;br/&gt;
This patch has a completely different approach from the previous ones, as it checks only for the integrity of incoming attachments&apos; requests, including the Content-MD5 field either in the http header or in the footer when having chunked http encodings.&lt;br/&gt;
&lt;br/&gt;
I also added an Etap test case.&lt;br/&gt;
&lt;br/&gt;
Can you provide some feedback on it?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12780943" author="fdmanana" created="Sat, 21 Nov 2009 10:26:45 +0000 (UTC)"  >This 5th patch no longer breaks the 050-stream.t test case. The break was caused by base64:decode/1 calls on non base64 encoded data (resulting in an exception).&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12781023" author="fdmanana" created="Sat, 21 Nov 2009 18:33:57 +0000 (UTC)"  >Relatively to the 4th/5th patch:&lt;br/&gt;
&lt;br/&gt;
+ simplified a few statements&lt;br/&gt;
+ formated case statements to have the same indentation style as the remaining code of couchdb</comment>
                    <comment id="12781105" author="fdmanana" created="Sun, 22 Nov 2009 09:12:41 +0000 (UTC)"  >I was doing an error in the previous patches: doing base64 decoding of the received chunks in couch_stream. &lt;br/&gt;
&lt;br/&gt;
As RFC 2616 (&lt;a href=&quot;http://tools.ietf.org/html/rfc2616#section-14.15&quot;&gt;http://tools.ietf.org/html/rfc2616#section-14.15&lt;/a&gt;) says, the MD5 digest is calculated after any content encoding is applied to the body. In Couch&apos;s case, the content encoding is base64 for the attachments, which is implicit in case the &amp;quot;Content-Encoding: base64&amp;quot; header is missing in the attachment upload request.&lt;br/&gt;
&lt;br/&gt;
Therefore, this patch no longer modifies couch_stream.erl and is more minimalistic now.&lt;br/&gt;
&lt;br/&gt;
Feedback is welcome.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12781120" author="paul.joseph.davis" created="Sun, 22 Nov 2009 13:05:48 +0000 (UTC)"  >Filipe,&lt;br/&gt;
&lt;br/&gt;
Apologies for being quiet the last couple days. I was on a trip down to NYC.&lt;br/&gt;
&lt;br/&gt;
The patch is definitely starting to look much better, but there are a couple things. When using the standalone attachment API like you are in the tests, the data isn&apos;t supposed to be base64 encoded. The base64 encoding only applies when including attachment data directly in the JSON documents.&lt;br/&gt;
&lt;br/&gt;
I think this is getting much closer to being good to go. Can you check and see if there&apos;s more to the diff though? I&apos;m not seeing a definition of the check_md5 function. Once I have that I&apos;ll apply and check it out locally, then it should be pretty quick to get in.&lt;br/&gt;
&lt;br/&gt;
Thanks for all your work on this ticket.</comment>
                    <comment id="12781130" author="fdmanana" created="Sun, 22 Nov 2009 14:21:16 +0000 (UTC)"  >Hello Paul,&lt;br/&gt;
&lt;br/&gt;
no problem.&lt;br/&gt;
&lt;br/&gt;
I though attachments were always base64 encoded. Never mind, the test case is now corrected. I have to start reading the online book.&lt;br/&gt;
&lt;br/&gt;
The check_md5/2 function was not written by me. It&apos;s in couch_db.erl line 685-687. It never threw an exception before since the md5 filed of an #att{} record was always the empty binary &amp;lt;&amp;lt;&amp;gt;&amp;gt;. I suppose this field and function were added with md5 integrity check in mind for the future.&lt;br/&gt;
&lt;br/&gt;
I also simplified the mochiweb_headers.erl header parsing function and added more tests to its test/0 function. I submitted a patch with this addition to the mochiweb project, but so far I had no awnser ( &lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=48&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=48&lt;/a&gt; ).&lt;br/&gt;
&lt;br/&gt;
I do have a question. In couch_util I noticed the declaration of some custom base64 encoding/decoding functions. Why do they exist? Is there any problem with Erlang&apos;s base64 module?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12781132" author="fdmanana" created="Sun, 22 Nov 2009 14:41:05 +0000 (UTC)"  >Forgot in the previous patch to remove the unnecessary call to MochiReq:get_header_value/1, I noticed afterwards that we have couch_httpd:header_value/2, therefore avoiding changing one line.</comment>
                    <comment id="12782114" author="fdmanana" created="Tue, 24 Nov 2009 19:30:28 +0000 (UTC)"  >Any news on this?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12782119" author="paul.joseph.davis" created="Tue, 24 Nov 2009 19:40:30 +0000 (UTC)"  >Filipe,&lt;br/&gt;
&lt;br/&gt;
I&apos;ve put it on the todo list for this weekend to apply and test and probably commit if everything passes.&lt;br/&gt;
&lt;br/&gt;
Paul</comment>
                    <comment id="12783172" author="fdmanana" created="Fri, 27 Nov 2009 21:21:19 +0000 (UTC)"  >Nothing new in this new patch.&lt;br/&gt;
&lt;br/&gt;
Only modification is the use of couch_util:decode_json/1 instead of mochijson2:decode/1 in the test case.&lt;br/&gt;
&lt;br/&gt;
Just did a git svn rebase today and got the surprise that ?JSON_DECODE is now a shortcut for the new couch_util:decode_json/1 and no longer a shortcut to mochijson2:decode/1, which returns a slightly different shapped tuple. This was causing the test case to fail.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12783254" author="kocolosk" created="Sat, 28 Nov 2009 17:35:48 +0000 (UTC)"  >Thanks for keeping this patch up-to-date, Filipe.  I changed ?JSON_DECODE because some folks prefer to use CouchDB with their own versions of MochiWeb instead of the one bundled with our source.  We had been using a forked MochiWeb with a different Erlang JSON decoding, but now those differences are bundled into couch_util and the MochiWeb we ship is functionally identical to the stock one from their repository.</comment>
                    <comment id="12783374" author="fdmanana" created="Sun, 29 Nov 2009 09:17:31 +0000 (UTC)"  >Hi Adam,&lt;br/&gt;
&lt;br/&gt;
I see. Thanks for the info.&lt;br/&gt;
cheers</comment>
                    <comment id="12790901" author="fdmanana" created="Tue, 15 Dec 2009 19:24:28 +0000 (UTC)"  >Any news on this?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12791067" author="paul.joseph.davis" created="Wed, 16 Dec 2009 00:10:04 +0000 (UTC)"  >Applied as of 891077</comment>
                    <comment id="12791795" author="paul.joseph.davis" created="Thu, 17 Dec 2009 05:41:11 +0000 (UTC)"  >Just reminding myself that the mochiweb patch that this introduced has been submitted upstream:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=48&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=48&lt;/a&gt;</comment>
                    <comment id="12800713" author="fdmanana" created="Fri, 15 Jan 2010 14:37:06 +0000 (UTC)"  >The mochiweb patch was merged on the 02 January 2010, revision 114, without any difference regarding the couch&apos;s version:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mochiweb/source/diff?spec=svn114&amp;r=114&amp;format=side&amp;path=/trunk/src/mochiweb_headers.erl&quot;&gt;http://code.google.com/p/mochiweb/source/diff?spec=svn114&amp;amp;r=114&amp;amp;format=side&amp;amp;path=/trunk/src/mochiweb_headers.erl&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
:)</comment>
                    <comment id="12800725" author="paul.joseph.davis" created="Fri, 15 Jan 2010 15:38:13 +0000 (UTC)"  >Awesome. Thanks for following up on that.</comment>
                </comments>
    
    <attachments>
            <attachment id="12426302" name="jira-couchdb-558-10th-try-trunk.patch" size="14846" author="fdmanana" created="Fri, 27 Nov 2009 21:21:19 +0000 (UTC)" />
            <attachment id="12425701" name="jira-couchdb-558-4th-try.patch" size="15489" author="fdmanana" created="Sat, 21 Nov 2009 03:00:07 +0000 (UTC)" />
            <attachment id="12425713" name="jira-couchdb-558-5th-try.patch" size="17329" author="fdmanana" created="Sat, 21 Nov 2009 10:26:45 +0000 (UTC)" />
            <attachment id="12425733" name="jira-couchdb-558-6th-try-trunk.patch" size="17078" author="fdmanana" created="Sat, 21 Nov 2009 18:33:57 +0000 (UTC)" />
            <attachment id="12425753" name="jira-couchdb-558-7th-try-trunk.patch" size="14042" author="fdmanana" created="Sun, 22 Nov 2009 09:12:41 +0000 (UTC)" />
            <attachment id="12425761" name="jira-couchdb-558-8th-try-trunk.patch" size="15115" author="fdmanana" created="Sun, 22 Nov 2009 14:21:16 +0000 (UTC)" />
            <attachment id="12425762" name="jira-couchdb-558-9th-try-trunk.patch" size="14782" author="fdmanana" created="Sun, 22 Nov 2009 14:41:05 +0000 (UTC)" />
            <attachment id="12424979" name="jira-couchdb-558-for-trunk-2nd-try.patch" size="9853" author="fdmanana" created="Sat, 14 Nov 2009 22:55:23 +0000 (UTC)" />
            <attachment id="12425001" name="jira-couchdb-558-for-trunk-3rd-try.patch" size="10138" author="fdmanana" created="Sun, 15 Nov 2009 14:40:57 +0000 (UTC)" />
            <attachment id="12424975" name="jira-couchdb-558-for-trunk.patch" size="10054" author="fdmanana" created="Sat, 14 Nov 2009 22:06:49 +0000 (UTC)" />
            <attachment id="12425034" name="run.tpl.patch" size="303" author="fdmanana" created="Sun, 15 Nov 2009 23:42:17 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 16 Dec 2009 00:10:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:58:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-557] update query strings in urls to static resources in futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-557</link>

                    <description>(split out of &lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-547)&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-547)&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Urls to static resources in couchdb 0.10&apos;s futon still have query strings like ?0.9.0. I assume these should have been updated to 0.10.0 when the new release was made. Probably there should be a script that does this automatically which would be run at release-cutting time, as davisp proposes in #547.</description>
                <environment></environment>
            <key id="12439695">COUCHDB-557</key>
        <summary>update query strings in urls to static resources in futon</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Mon, 2 Nov 2009 19:32:33 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 19:32:33 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-556] filtered replication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-556</link>

                    <description>This really just means getting the replicator to read from a filtered _changes feed.</description>
                <environment></environment>
            <key id="12439693">COUCHDB-556</key>
        <summary>filtered replication</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 2 Nov 2009 18:48:15 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 19:29:47 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                            <outwardlinks description="duplicates">
                            <issuelink>
            <issuekey id="12396895">COUCHDB-64</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 19:29:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-555] replication configuration DB</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-555</link>

                    <description>Discussion from dev@&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200908.mbox/%3C85615F74-7518-4AA3-AD9C-56046B2D38F2@apache.org%3E&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200908.mbox/%3C85615F74-7518-4AA3-AD9C-56046B2D38F2@apache.org%3E&lt;/a&gt;</description>
                <environment></environment>
            <key id="12439692">COUCHDB-555</key>
        <summary>replication configuration DB</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 2 Nov 2009 18:46:17 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 18:46:17 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-554] RFC3284 support for delta-based attachment updates</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-554</link>

                    <description>I was thinking about being to update an attachment with a binary diff instead of a full upload (in those cases where the diff would be much smaller, of course). RFC3284 (&lt;a href=&quot;http://www.faqs.org/rfcs/rfc3284.html&quot;&gt;http://www.faqs.org/rfcs/rfc3284.html&lt;/a&gt;) seems to document a generic syntax for describing a patch.&lt;br/&gt;
&lt;br/&gt;
The idea is that you would PUT an encoded diff as the body instead of sending the full bytes. If the attachment&apos;s revision matches your PUT&apos;s revision, then CouchDB will apply the delta to its locally stored version to make the new version. As a further option, CouchDB could store the delta itself and apply it on fetch. This might complicate compaction, though.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12439688">COUCHDB-554</key>
        <summary>RFC3284 support for delta-based attachment updates</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Mon, 2 Nov 2009 18:23:57 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 18:23:57 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-553] Add KD-Tree or R-Tree index</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-553</link>

                    <description>Add the ability to have k-dimensional queries. This would prove invaluable both for latitude/longitude type searches, but also for any other question which requires confining the data in multiple dimensions.</description>
                <environment>All</environment>
            <key id="12439638">COUCHDB-553</key>
        <summary>Add KD-Tree or R-Tree index</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="whiteside">Christopher O&apos;Connell</reporter>
            
    <created>Mon, 2 Nov 2009 00:33:43 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 11:20:43 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772475" author="janl" created="Mon, 2 Nov 2009 09:30:10 +0000 (UTC)"  >Also see &lt;a href=&quot;http://vmx.cx/cgi-bin/blog/index.cgi/geocouch-new-release-0.10.0%3A2009-09-19%3Aen%2CCouchDB%2CPython%2Cgeo&quot;&gt;http://vmx.cx/cgi-bin/blog/index.cgi/geocouch-new-release-0.10.0%3A2009-09-19%3Aen%2CCouchDB%2CPython%2Cgeo&lt;/a&gt; </comment>
                    <comment id="12772494" author="vmx" created="Mon, 2 Nov 2009 11:20:43 +0000 (UTC)"  >I&apos;d like to see r-trees for geospatial queries, &lt;a href=&quot;http://github.com/cchandler/RTreeCouchDB&quot;&gt;http://github.com/cchandler/RTreeCouchDB&lt;/a&gt; looks like a good start.&lt;br/&gt;
But for multiple range queries (like lat/lon searches) I&apos;d propose an range tree (which is a b-tree with other dimensions as b-trees in tree nodes).</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 09:30:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-552] &quot;content-type&quot; header behavior from external processes is poorly defined</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-552</link>

                    <description>When returning headers from an external process, the behavior depends on capitalization, and is radically different in each case.&lt;br/&gt;
&lt;br/&gt;
Consider the external process return&lt;br/&gt;
&lt;br/&gt;
a: { &amp;quot;code&amp;quot;:200, &amp;quot;json&amp;quot;: { &amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot; }, &amp;quot;headers&amp;quot;: {} }.&lt;br/&gt;
&lt;br/&gt;
If returned as (a), the server serves { &amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot; } with header &amp;quot;Content-Type: application/json&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
If the json is modified to &lt;br/&gt;
&lt;br/&gt;
b: { &amp;quot;code&amp;quot;:200, &amp;quot;json&amp;quot;: { &amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot; }, &amp;quot;headers&amp;quot;:  {&amp;quot;Content-type&amp;quot;:&amp;quot;text/plain&amp;quot;} }&lt;br/&gt;
c: { &amp;quot;code&amp;quot;:200, &amp;quot;json&amp;quot;: { &amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot; }, &amp;quot;headers&amp;quot;:  {&amp;quot;content-type&amp;quot;:&amp;quot;text/plain&amp;quot;} }&lt;br/&gt;
&lt;br/&gt;
If returned as (b) or (c), the server serves { &amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot; } with header &amp;quot;Content-Type: text/plain, application/json&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
If the json is modified to&lt;br/&gt;
&lt;br/&gt;
d: c: { &amp;quot;code&amp;quot;:200, &amp;quot;json&amp;quot;: { &amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot; }, &amp;quot;headers&amp;quot;:  {&amp;quot;Content-Type&amp;quot;:&amp;quot;text/plain&amp;quot;} }&lt;br/&gt;
&lt;br/&gt;
If returned as (d), the server serves { &amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot; } with header &amp;quot;Content-Type: text/plain&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
There should be one well defined behavior when a &amp;quot;content-type&amp;quot; header is returned from an external process.&lt;br/&gt;
&lt;br/&gt;
To reproduce this error, setup an external process and return json strings as specified above.</description>
                <environment>CentOS5.3, Erlang R12</environment>
            <key id="12439637">COUCHDB-552</key>
        <summary>&quot;content-type&quot; header behavior from external processes is poorly defined</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="whiteside">Christopher O&apos;Connell</reporter>
            
    <created>Mon, 2 Nov 2009 00:28:34 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:10:25 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772394" author="kocolosk" created="Mon, 2 Nov 2009 00:33:48 +0000 (UTC)"  >Hi Christopher, this should already be fixed in trunk.  If you&apos;re building from source can you svn up and try again?&lt;br/&gt;
&lt;br/&gt;
I didn&apos;t backport the fix to the 0.10 branch.  If folks think the bug is serious enough we can certainly include the fix in 0.10.1.</comment>
                    <comment id="12772401" author="whiteside" created="Mon, 2 Nov 2009 01:28:42 +0000 (UTC)"  >I&apos;ll try a build and let you know.&lt;br/&gt;
&lt;br/&gt;
It&apos;s probably not necessary to push it to 0.10.1, but a note on the wiki would be nice.</comment>
                    <comment id="12772402" author="whiteside" created="Mon, 2 Nov 2009 01:29:20 +0000 (UTC)"  >Here&apos;s the external process wiki page with relevant edits.</comment>
                    <comment id="12772635" author="kocolosk" created="Mon, 2 Nov 2009 20:10:25 +0000 (UTC)"  >Thanks, I updated the wiki with something similar.  The wiki is publicly editable, too -- no need to wait for a committer in that case!  Best,&lt;br/&gt;
&lt;br/&gt;
Adam</comment>
                </comments>
    
    <attachments>
            <attachment id="12423789" name="ExternalProcesses.txt" size="4402" author="whiteside" created="Mon, 2 Nov 2009 01:29:20 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:10:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 00:33:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-551] couch_log crashes when external process returns status code as string</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-551</link>

                    <description>When an external process returns a value, the couch_log process crashes.&lt;br/&gt;
&lt;br/&gt;
A couchdb external process is created which returns well formed json as identified below. Whenever the process&apos; url is accessed, couchdb correctly returns the result, however, the couch_log process crashes (log below).&lt;br/&gt;
&lt;br/&gt;
To replicate this, setup an external process and make a call to it using the mapped url.&lt;br/&gt;
&lt;br/&gt;
This has been observed on CentOS 5.3 with the most recent version of the 0.10 branch, using a java external process as described below. Similar behavior has also been observed on Ubuntu 9.10 using a php external process (log not included).&lt;br/&gt;
&lt;br/&gt;
External Program Input: { &amp;quot;path&amp;quot;:[],&amp;quot;query&amp;quot;:{&amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot;,&amp;quot;abc&amp;quot;:123},&amp;quot;verb&amp;quot;:&amp;quot;GET&amp;quot; }&lt;br/&gt;
External Program Output: {&amp;quot;headers&amp;quot;:{&amp;quot;content-type&amp;quot;:&amp;quot;text/plain&amp;quot;},&amp;quot;json&amp;quot;:{&amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot;,&amp;quot;abc&amp;quot;:123},&amp;quot;code&amp;quot;:&amp;quot;200&amp;quot;}&lt;br/&gt;
Couchdb URL: .../_exj?hello=world&amp;amp;abc=123&lt;br/&gt;
Couchdb Response: {&amp;quot;hello&amp;quot;:&amp;quot;world&amp;quot;,&amp;quot;abc&amp;quot;:&amp;quot;123&amp;quot;}&lt;br/&gt;
***** Log *****&lt;br/&gt;
Apache CouchDB 0.10.0 (LogLevel=info) is starting.&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
[info] [&amp;lt;0.1.0&amp;gt;] Apache CouchDB has started on &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
[info] [&amp;lt;0.73.0&amp;gt;] EXTERNAL: Starting process for: exj&lt;br/&gt;
[info] [&amp;lt;0.73.0&amp;gt;] COMMAND: /usr/bin/java -cp /root/geoc externalj&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 1-Nov-2009::23:44:24 ===&lt;br/&gt;
** gen_event handler couch_log crashed.&lt;br/&gt;
** Was installed in error_logger&lt;br/&gt;
** Last event was: {info_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.60.0&amp;gt;,couch_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;~s - - ~p ~s ~B&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;72.211.148.58&amp;quot;,&apos;GET&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/airport_data/_exj?hello=world&amp;amp;abc=123&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;200&amp;quot;&amp;gt;&amp;gt;]}}}&lt;br/&gt;
** When handler state == {&amp;lt;0.46.0&amp;gt;,2}&lt;br/&gt;
** Reason == {badarg,[{io_lib,format,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;~s - - ~p ~s ~B&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;72.211.148.58&amp;quot;,&apos;GET&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/airport_data/_exj?hello=world&amp;amp;abc=123&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;200&amp;quot;&amp;gt;&amp;gt;]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_log,log,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_log,handle_event,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,server_update,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,server_notify,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 1-Nov-2009::23:44:24 ===&lt;br/&gt;
** Generic server couch_log terminating&lt;br/&gt;
** Last message in was {gen_event_EXIT,couch_log,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;EXIT&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{badarg,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{io_lib,format,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;~s - - ~p ~s ~B&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;72.211.148.58&amp;quot;,&apos;GET&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/airport_data/_exj?hello=world&amp;amp;abc=123&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;200&amp;quot;&amp;gt;&amp;gt;]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_log,log,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_log,handle_event,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,server_update,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,server_notify,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}}}&lt;br/&gt;
** When Server state == {error_logger,couch_log}&lt;br/&gt;
** Reason for termination ==&lt;br/&gt;
** {&apos;EXIT&apos;,{badarg,[{io_lib,format,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;~s - - ~p ~s ~B&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;72.211.148.58&amp;quot;,&apos;GET&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/airport_data/_exj?hello=world&amp;amp;abc=123&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;200&amp;quot;&amp;gt;&amp;gt;]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_log,log,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_log,handle_event,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,server_update,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,server_notify,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_event,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}}</description>
                <environment>CentOS 5.3, Erlang R12</environment>
            <key id="12439636">COUCHDB-551</key>
        <summary>couch_log crashes when external process returns status code as string</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="whiteside">Christopher O&apos;Connell</reporter>
            
    <created>Mon, 2 Nov 2009 00:05:58 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:32:29 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772392" author="kocolosk" created="Mon, 2 Nov 2009 00:25:58 +0000 (UTC)"  >Hi Christopher, can you confirm that the crash does not occur if the external returns the status code as an integer instead of a string?  Regardless, we should do a patch to cast the status code as appropriate for logging purposes.</comment>
                    <comment id="12772393" author="kocolosk" created="Mon, 2 Nov 2009 00:29:08 +0000 (UTC)"  >I don&apos;t think _external logging is in 0.10.0</comment>
                    <comment id="12772400" author="whiteside" created="Mon, 2 Nov 2009 01:22:05 +0000 (UTC)"  >Adam, my bad, it does NOT occur if the external returns the status code as a number. I&apos;ll add a note to the ExternalProcess wiki page</comment>
                    <comment id="12772403" author="whiteside" created="Mon, 2 Nov 2009 01:30:55 +0000 (UTC)"  >ExternalProcess wiki page with edits. Same as my wiki page on &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-552&quot; title=&quot;&amp;quot;content-type&amp;quot; header behavior from external processes is poorly defined&quot;&gt;&lt;strike&gt;COUCHDB-552&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
            <attachment id="12423790" name="ExternalProcesses.txt" size="4402" author="whiteside" created="Mon, 2 Nov 2009 01:30:55 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:32:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 00:25:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-550] Provide Futon UI option that would use &apos;stale=ok&apos; when browsing DB views in Futon, useful for write-heavy DB&apos;s</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-550</link>

                    <description>If a CouchDB has continuous writes, as in the case of a log capturing system, it becomes very difficult to use Futon to browse the views in a design document.  If writes are continuous in the background, and the admin chooses a view to browse in Futon, CouchDB will force an update to the view index and will block Futon on trying to browse that design document.   This makes it almost impossible to be able to browse the view results as the indexing may never catch up with the writes.&lt;br/&gt;
&lt;br/&gt;
A possible solution to this is to provide a UI option (Checkbox) in Futon which would append the &amp;quot;stale=&apos;ok&apos;&amp;quot; onto all Futon view requests allowing for instantaneous browsing of the current state of the DB view indexes.  This option would be off by default (current behavior).</description>
                <environment>All</environment>
            <key id="12439632">COUCHDB-550</key>
        <summary>Provide Futon UI option that would use &apos;stale=ok&apos; when browsing DB views in Futon, useful for write-heavy DB&apos;s</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Sun, 1 Nov 2009 21:36:21 +0000 (UTC)</created>
    <updated>Fri, 27 Nov 2009 21:52:46 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12773637" author="fdmanana" created="Wed, 4 Nov 2009 20:57:46 +0000 (UTC)"  >Hello,&lt;br/&gt;
&lt;br/&gt;
This is my first submitted patch for CouchDB.&lt;br/&gt;
&lt;br/&gt;
Hope it meets your quality standards.&lt;br/&gt;
Feedback is welcome.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12783177" author="fdmanana" created="Fri, 27 Nov 2009 21:52:46 +0000 (UTC)"  >No new on this?&lt;br/&gt;
&lt;br/&gt;
No patch feedback?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                </comments>
    
    <attachments>
            <attachment id="12424052" name="jira-couchdb-550-trunk.patch" size="2544" author="fdmanana" created="Wed, 4 Nov 2009 20:57:46 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Nov 2009 20:57:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-549] include_docs=true doesn&apos;t honour conflicts=true</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-549</link>

                    <description>When you read a view and use the option &apos;include_docs=true&apos; to get the source document in each result row, the option &apos;conflicts=true&apos; is not honoured. You do not see a _conflicts member in the document, even if it is in a conflicting state.&lt;br/&gt;
&lt;br/&gt;
This feature request could be expanded in a couple of directions:&lt;br/&gt;
&lt;br/&gt;
1. Make include_docs=true honour *all* options which a straightforward GET would honour - e.g. revs, revs_info, open_revs. Maybe this would be straightforward if they shared the same code path and options processing.&lt;br/&gt;
&lt;br/&gt;
2. It has been suggested that &apos;conflicts=true&apos; could be the default anyway. That is, whenever you retrieve a document, you get a _conflicts member if it is in a conflicting state, without having to ask for it. This would be unlikely to break things, but would make it less likely that conflicts would go unnoticed, and it would simplify the API a little.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12439630">COUCHDB-549</key>
        <summary>include_docs=true doesn&apos;t honour conflicts=true</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Sun, 1 Nov 2009 21:07:28 +0000 (UTC)</created>
    <updated>Sun, 1 Nov 2009 21:07:28 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-548] Limitations of open_revs=all</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-548</link>

                    <description>The GET option ?open_revs=all would be useful for retrieving all conflicting versions of a document in one go, but has the following problems.&lt;br/&gt;
&lt;br/&gt;
1. The documents are returned in an arbitrary order which is unrelated to the conflict-winning algorithm. For example, you can&apos;t rely on the first revision returned being the one which a plain GET would return.&lt;br/&gt;
&lt;br/&gt;
2. It includes tips of branches which are no longer live (i.e. the tip document has been deleted). Although these can be filtered out client-side by looking for a &amp;quot;_deleted&amp;quot;:true member, it transfers unnecessary revs, potentially a large number of them.&lt;br/&gt;
&lt;br/&gt;
3. It is somewhat inconvenient that it returns an array of {&amp;quot;ok&amp;quot;:{..doc..}} or &amp;quot;missing&amp;quot;:&amp;quot;rev&amp;quot;, rather than just an array of docs. Again, this can be normalized client-side. But I observe that if only live branches were returned, then they would always be &amp;quot;ok&amp;quot; and so this layer wouldn&apos;t be needed.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12439629">COUCHDB-548</key>
        <summary>Limitations of open_revs=all</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Sun, 1 Nov 2009 21:01:17 +0000 (UTC)</created>
    <updated>Sun, 1 Nov 2009 21:01:17 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-547] add &quot;compact view&quot; button to futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-547</link>

                    <description>The attached patch, created via &amp;quot;git diff --binary 1b2855063bc6ddccb6a7003a7243930678673ba7... &amp;gt; compactviewbutton.diff&amp;quot; from within a clone of &lt;a href=&quot;git://github.com/jab/couchdb.git&quot;&gt;git://github.com/jab/couchdb.git&lt;/a&gt; (see &lt;a href=&quot;http://github.com/jab/couchdb),&quot;&gt;http://github.com/jab/couchdb),&lt;/a&gt; adds a &amp;quot;compact view&amp;quot; button to futon when browsing a view.</description>
                <environment></environment>
            <key id="12439423">COUCHDB-547</key>
        <summary>add &quot;compact view&quot; button to futon</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Thu, 29 Oct 2009 16:32:34 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 19:33:54 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12771539" author="jab" created="Thu, 29 Oct 2009 18:35:05 +0000 (UTC)"  >Also, I noticed that throughout futon the &amp;lt;script...&amp;gt; tags still point to .js files with a query string of ?0.9.0. I didn&apos;t change any of these in my patch, but I take it these should all have been changed to ?0.10.0 with the 0.10 release?</comment>
                    <comment id="12771560" author="paul.joseph.davis" created="Thu, 29 Oct 2009 18:56:26 +0000 (UTC)"  >The &apos;correct&apos; thing would probably be to have that version number inserted by the build system which is easy enough in theory except that it has the effect of requiring two files, and then hacking on Futon gets a bit weird. Perhaps we could do that as part of an install hook or something to have them replaced inline as part of a `make install`?&lt;br/&gt;
&lt;br/&gt;
Its bugged me for a bit but I can&apos;t think of a decent solution. And just s/0.9/0.10/ seemed to not address the underlying issue.&lt;br/&gt;
&lt;br/&gt;
Does anyone have a decent solution for this in projects outside of Futon?</comment>
                    <comment id="12771751" author="paul.joseph.davis" created="Fri, 30 Oct 2009 03:25:31 +0000 (UTC)"  >Joshua,&lt;br/&gt;
&lt;br/&gt;
Patch looks mostly good. Couple things:&lt;br/&gt;
&lt;br/&gt;
1. When you&apos;re not on a design doc the disabled &amp;quot;Compact View&amp;quot; button shouldn&apos;t be visible.&lt;br/&gt;
2. The compact view should probably be to the right of &amp;quot;Delete Database&amp;quot; to make sure that DB operations are grouped. Plus it&apos;ll help as &amp;quot;Compact View&amp;quot; isn&apos;t always visible, thus lessening confusion if buttons moved.&lt;br/&gt;
3. The dialog box text needs a bit of work:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Compacting a view removes deleted documents and previous revisions. It is an irreversible operation and may take a while to complete for large views.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Should read something like:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;View compaction will affect all views in this design document. This operation may take some time to complete. Your views will still operate normally during compaction.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Or some such. Deleting and removing and revisions and irreversible are all things that people shouldn&apos;t be forced to consider when doing view compaction because none of those are remotely related.&lt;br/&gt;
&lt;br/&gt;
Other than those minor tweaks, it looks good to me.</comment>
                    <comment id="12771753" author="jab" created="Fri, 30 Oct 2009 03:36:34 +0000 (UTC)"  >&amp;gt; Patch looks mostly good&lt;br/&gt;
glad to hear it!&lt;br/&gt;
&lt;br/&gt;
&amp;gt; 1. When you&apos;re not on a design doc the disabled &amp;quot;Compact View&amp;quot; button shouldn&apos;t be visible. &lt;br/&gt;
Oh, I brought it up in the channel today and kocolosk said it should be grayed out rather than hidden, so I added the &amp;quot;button.disabled&amp;quot; stuff you&apos;ll notice in layout.css and database.html. Also, I added a fourth sprite to the bottom of compact.png so the button would look disabled; did this make it through when you applied the attached patch? I noticed it says &amp;quot;GIT binary patch&amp;quot; in the attached where it gives the hunk(?) for compact.png, wonder whether that means you have to use git-apply to get this part of the patch to work?&lt;br/&gt;
&lt;br/&gt;
&amp;gt; 2. The compact view should probably be to the right of &amp;quot;Delete Database&amp;quot; to make sure that DB operations are grouped. Plus it&apos;ll help as &amp;quot;Compact View&amp;quot; isn&apos;t always visible, thus lessening confusion if buttons moved. &lt;br/&gt;
&amp;gt; 3. The dialog box text needs a bit of work:&lt;br/&gt;
&amp;lt;snip/&amp;gt;&lt;br/&gt;
&lt;br/&gt;
Both 2 and 3 sound good to me. Want me to make the changes and resubmit the patch?</comment>
                    <comment id="12771757" author="paul.joseph.davis" created="Fri, 30 Oct 2009 03:45:50 +0000 (UTC)"  >I&apos;d rather see hidden out as it seems like it&apos;d have more visual weight appearing only for the view stuff so that people aren&apos;t wondering how to enable it.&lt;br/&gt;
&lt;br/&gt;
The patch seems to work out. The binary bit threw me for a second till I realized the file name. I didn&apos;t notice a difference because the grayed out style made the entire icon disappear.&lt;br/&gt;
&lt;br/&gt;
Yep yep, go ahead and make those fixes and we&apos;ll get this committed. Feel free to flip a quarter on grayed vs hidden.</comment>
                    <comment id="12771759" author="kocolosk" created="Fri, 30 Oct 2009 03:53:25 +0000 (UTC)"  >Hiding &amp;quot;Compact View&amp;quot; is fine by me, too.  Sorry if I made you go through extra work, Joshua.</comment>
                    <comment id="12771815" author="jab" created="Fri, 30 Oct 2009 05:54:39 +0000 (UTC)"  >&amp;gt; I didn&apos;t notice a difference because the grayed out style made the entire icon disappear. &lt;br/&gt;
&lt;br/&gt;
Yikes, that&apos;s no good. Are you able to see the fourth icon from the top when you view &lt;a href=&quot;http://github.com/jab/couchdb/blob/master/share/www/image/compact.png?&quot;&gt;http://github.com/jab/couchdb/blob/master/share/www/image/compact.png?&lt;/a&gt; If not, maybe it&apos;s your monitor&apos;s brightness/contrast settings; if so, maybe your browser was using a cached copy of that image? This would explain your not seeing the icon, as the old version of the image was only 96 pixels high, and the new button.disabled style sets a vertical background-position of -94px. I&apos;ll append a ?0.10.0 to the url for that background-image in the css file to make sure this doesn&apos;t happen.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&amp;gt; go ahead and make those fixes and we&apos;ll get this committed.&lt;br/&gt;
&lt;br/&gt;
I pushed the fixes to &lt;a href=&quot;http://github.com/jab/couchdb&quot;&gt;http://github.com/jab/couchdb&lt;/a&gt;. I&apos;ll have a new patched attached to this ticket tomorrow.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Feel free to flip a quarter on grayed vs hidden.&lt;br/&gt;
&lt;br/&gt;
I&apos;m inclined to leave it grayed out, and not just because it was extra work! (It was fun anyway:) My theory is that graying it out actually does communicate its state better than not showing it at all. Maybe your not seeing the icon properly screwed up that communication. And also your eyes and mousing hand like it better when widgets stay where they are; sometimes having them disappear violates the principle of least astonishment[1]. I can get the opinion of one of the designers in my office tomorrow. Or maybe just give it another look once I submit the new patch and you can see the grayed out icon, and let me know if you still prefer it hidden!&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://en.wikipedia.org/wiki/Principle_of_least_astonishment&quot;&gt;http://en.wikipedia.org/wiki/Principle_of_least_astonishment&lt;/a&gt; :)</comment>
                    <comment id="12771828" author="paul.joseph.davis" created="Fri, 30 Oct 2009 06:12:14 +0000 (UTC)"  >Thinking idly before bed, I&apos;m inclined to think that having it grayed out on a page that isn&apos;t a view seems more astonishing that hidden. To me its the same argument as not having a grayed out &amp;quot;Delete Database&amp;quot; button when viewing the list of databases page. The intent of the button doesn&apos;t have a valid meaning in that context. Plus, I can&apos;t think of any other button that does the grayed out status, so having a special status indication for a single button also seems more astonishing than hiding it.&lt;br/&gt;
</comment>
                    <comment id="12771990" author="jab" created="Fri, 30 Oct 2009 16:43:31 +0000 (UTC)"  >Thought about it some more and I think it should be hidden too. I should know better by now than to trust my 2AM logic. Attaching a new patch which hides rather than grays out, changes instances of ?0.9.0 to ?0.10.1 (on the theory that trunk should stay ahead of the latest release yeah?), and with the other fixes above.&lt;br/&gt;
&lt;br/&gt;
A truly complete patch would include a test, but I have to leave that for the future for now.&lt;br/&gt;
&lt;br/&gt;
Let me know how it looks.</comment>
                    <comment id="12772163" author="paul.joseph.davis" created="Fri, 30 Oct 2009 23:14:46 +0000 (UTC)"  >Joshua,&lt;br/&gt;
&lt;br/&gt;
Thanks for the patch. Applied as of r831485.&lt;br/&gt;
&lt;br/&gt;
I ixnayed all the s/0.9.0/0.10.1/ changes as they&apos;re quite orthogonal to the patch. Also, trunk is referred to as a minor revision after the current release, ie, as soon as 0.10.x was branched, trunk effectively became 0.11.x. Feel free to attach just the version updates to a new ticket and I&apos;ll apply them. I&apos;m not gonna do this myself because I&apos;m still convinced that we should be doing this differently, I just don&apos;t know how exactly. I&apos;m starting to lean towards writing a script that we&apos;ll run after we branch a version that will go through and update version numbers. That&apos;d allow us to update them for the revision versions as well. A project for another day anyway.&lt;br/&gt;
&lt;br/&gt;
I did let the linking of the database in though because its generally useful and I was too lazy to split up the patch for a one line diff. Knowing Git has subfile commits just makes me sad when using SVN.</comment>
                    <comment id="12772614" author="jab" created="Mon, 2 Nov 2009 19:33:54 +0000 (UTC)"  >&amp;gt; Thanks for the patch. Applied as of r831485. &lt;br/&gt;
&lt;br/&gt;
Sweet, and my pleasure.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; I ixnayed all the s/0.9.0/0.10.1/ changes as they&apos;re quite orthogonal to the patch. Also, trunk is referred to as a minor revision after the current release, ie, as soon as 0.10.x was branched, trunk effectively became 0.11.x. Feel free to attach just the version updates to a new ticket and I&apos;ll apply them. I&apos;m not gonna do this myself because I&apos;m still convinced that we should be doing this differently, I just don&apos;t know how exactly. I&apos;m starting to lean towards writing a script that we&apos;ll run after we branch a version that will go through and update version numbers. That&apos;d allow us to update them for the revision versions as well. A project for another day anyway.&lt;br/&gt;
&lt;br/&gt;
Cool, I split off a new issue for this at &lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-557&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-557&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; I did let the linking of the database in though because its generally useful and I was too lazy to split up the patch for a one line diff. Knowing Git has subfile commits just makes me sad when using SVN.&lt;br/&gt;
&lt;br/&gt;
=)</comment>
                </comments>
    
    <attachments>
            <attachment id="12423590" name="compactviewbutton.diff" size="47506" author="jab" created="Thu, 29 Oct 2009 16:32:54 +0000 (UTC)" />
            <attachment id="12423692" name="compactviewbutton.take2.diff" size="16299" author="jab" created="Fri, 30 Oct 2009 16:43:59 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Oct 2009 23:14:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 29 Oct 2009 18:56:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-546] cookie_auth test fails when the client doesn&apos;t send cookies</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-546</link>

                    <description>I noticed this when working on refactoring couchjs&apos;s curl bindings. It doesn&apos;t send cookies by default, which means its authenticated no matter what as cookie auth fail falls back to normal auth which isn&apos;t setup by the test.&lt;br/&gt;
&lt;br/&gt;
I tried adding an admin to the run_on_modified_server settings but there are quite a few calls that required auth being set so it broke and I left it after adding cookie support to the client.&lt;br/&gt;
&lt;br/&gt;
Note to future self to figure out how to test this. Might need a &amp;quot;don&apos;t send cookies&amp;quot; flag to the CouchHTTP XHR object I wrote that would only be set when run from make check as I&apos;m not sure what browsers have in the way of support here.</description>
                <environment></environment>
            <key id="12439334">COUCHDB-546</key>
        <summary>cookie_auth test fails when the client doesn&apos;t send cookies</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Wed, 28 Oct 2009 21:30:26 +0000 (UTC)</created>
    <updated>Wed, 28 Oct 2009 21:30:26 +0000 (UTC)</updated>

                
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-545] speed of couch_config_writer.erl O(n^2) with size of local.ini</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-545</link>

                    <description>PUT requests to _config slow down dramatically as the size of local.ini grows.&lt;br/&gt;
&lt;br/&gt;
Attached version of  couch_config_writer.erl (written by Gustavo Niemeyer) takes the write time to the config file from  O(n**2) to O(n) resulting in dramatic speedups when the size of local.ini grows to non trivial sizes. (change from 5 minutes to 2 seconds observed on our server.)</description>
                <environment></environment>
            <key id="12439328">COUCHDB-545</key>
        <summary>speed of couch_config_writer.erl O(n^2) with size of local.ini</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Wed, 28 Oct 2009 20:22:28 +0000 (UTC)</created>
    <updated>Thu, 29 Oct 2009 03:22:24 +0000 (UTC)</updated>

                        <version>0.10</version>
                    <version>0.10.1</version>
                    <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12771269" author="kocolosk" created="Thu, 29 Oct 2009 03:22:24 +0000 (UTC)"  >I&apos;m impressed.  This is a very clean, well-written patch, and it&apos;s fast to boot!  I&apos;ve committed it with only cosmetic changes.&lt;br/&gt;
&lt;br/&gt;
I set the Fix Version to 0.11.  Even though it is a major speed boost, I&apos;m not sure that by itself warrants inclusion in 0.10.1, as it&apos;s not really a bugfix.</comment>
                </comments>
    
    <attachments>
            <attachment id="12423488" name="couch_config_writer.erl" size="2756" author="thisfred" created="Wed, 28 Oct 2009 20:23:32 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 29 Oct 2009 03:22:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 29 Oct 2009 03:22:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-544] Make CouchDB View server take use of GPU capabilities (// computing)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-544</link>

                    <description>Nowadays, GPUs provide a considerable amount of power in parallel computing of shaders... in screen rendering. For example, a standard GPU like ATI&apos;s HD 2900 XT gives 500 Gflops power whereas a classic CPU gives only 8 Gflops.&lt;br/&gt;
&lt;br/&gt;
nVidia CUDA, OpenCL... it is underway.&lt;br/&gt;
&lt;br/&gt;
It is a computing mode that permits massive parallel computing on isolated data.&lt;br/&gt;
&lt;br/&gt;
o_O That sounds like docs in view building ?&lt;br/&gt;
Yeah, exactly.&lt;br/&gt;
&lt;br/&gt;
The main idea is to make CouchDB View engine use these GPU (if available).&lt;br/&gt;
Can you imagine the power of view building on a super CouchDB server with 4 PCI-Express GPU cards ?&lt;br/&gt;
&lt;br/&gt;
Some infos (for example) :&lt;br/&gt;
- &lt;a href=&quot;http://en.wikipedia.org/wiki/GPGPU&quot;&gt;http://en.wikipedia.org/wiki/GPGPU&lt;/a&gt;&lt;br/&gt;
(for FR : &lt;a href=&quot;http://fr.wikipedia.org/wiki/General-Purpose_Processing_on_Graphics_Processing_Units&quot;&gt;http://fr.wikipedia.org/wiki/General-Purpose_Processing_on_Graphics_Processing_Units&lt;/a&gt; )&lt;br/&gt;
- &lt;a href=&quot;http://www.behardware.com/articles/744-1/opencl-democracy-for-gpu-computing.html&quot;&gt;http://www.behardware.com/articles/744-1/opencl-democracy-for-gpu-computing.html&lt;/a&gt;&lt;br/&gt;
(for FR : &lt;a href=&quot;http://www.hardware.fr/articles/744-1/opencl-gpu-computing-enfin-democratise.html&quot;&gt;http://www.hardware.fr/articles/744-1/opencl-gpu-computing-enfin-democratise.html&lt;/a&gt; )&lt;br/&gt;
&lt;br/&gt;
PS : This issue is submitted to make discussions happen on this crazy idea. Relax.&lt;br/&gt;
I don&apos;t know how, but i think this could be a great improvement in the world of database, and the Couch fits perfectly.&lt;br/&gt;
&lt;br/&gt;
What do you think about ?</description>
                <environment>All</environment>
            <key id="12439153">COUCHDB-544</key>
        <summary>Make CouchDB View server take use of GPU capabilities (// computing)</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="maxime">Maxime Garcia</reporter>
            
    <created>Tue, 27 Oct 2009 11:00:18 +0000 (UTC)</created>
    <updated>Tue, 27 Oct 2009 14:45:07 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
                    <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12770529" author="kocolosk" created="Tue, 27 Oct 2009 14:45:07 +0000 (UTC)"  >So, in my limited experience with GPGPU-style programming it really shines if you have a &amp;quot;small data, big computation&amp;quot; problem.  Matrix manipulations, stuff like that.  CouchDB&apos;s view functions are much heavier on the I/O side; I doubt there is much to be gained from shipping the data out to the GPU and back.  But hey, I could certainly be wrong, don&apos;t let me discourage someone who wants to give this a shot.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 27 Oct 2009 14:45:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-543] Set cache headers for favicon.ico</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-543</link>

                    <description>favicon.ico is requested alot from the browser. We should think about cache headers and what not.</description>
                <environment></environment>
            <key id="12439135">COUCHDB-543</key>
        <summary>Set cache headers for favicon.ico</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 27 Oct 2009 04:13:36 +0000 (UTC)</created>
    <updated>Thu, 10 Dec 2009 20:10:57 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12788604" author="mwhooker" created="Thu, 10 Dec 2009 09:01:26 +0000 (UTC)"  >This patch adds a far-future expire time to the favicon response. &lt;br/&gt;
&lt;br/&gt;
Also attached is a survey of cache-related headers served with a request to the favicon.ico of various popular sites. This shows that the proposed solution is in practice across the web.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12788885" author="jchris" created="Thu, 10 Dec 2009 20:10:57 +0000 (UTC)"  >applied in r889402</comment>
                </comments>
    
    <attachments>
            <attachment id="12427591" name="COUCHDB-543_02.diff" size="2342" author="mwhooker" created="Thu, 10 Dec 2009 09:01:26 +0000 (UTC)" />
            <attachment id="12427590" name="favicon_cache_comparison.txt" size="1082" author="mwhooker" created="Thu, 10 Dec 2009 09:01:26 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 10 Dec 2009 20:10:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 10 Dec 2009 09:01:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-542] Fix for COUCHDB-288 makes JS_MaybeGC not called</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-542</link>

                    <description>The fix for &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-288&quot; title=&quot;couch_js.c:1217: error: &apos;JSOPTION_NATIVE_BRANCH_CALLBACK&apos; with spidermonkey tip&quot;&gt;&lt;strike&gt;COUCHDB-288&lt;/strike&gt;&lt;/a&gt; only basically replaces JS_SetBranchCallback with JS_SetOperationCallback, which is not enough for the callback to be triggered. The problem is that basically, the operation callback API has now nothing to do with the previous branch callback API, and is not called at each branch call at the JS level. Actually, it is not called at all, except if JS_TriggerOperationCallback is used. Typically, this needs to be done either from a signal handler or a watchdog thread, in which case the test inside the callback is pretty pointless.&lt;br/&gt;
&lt;br/&gt;
See &lt;a href=&quot;http://groups.google.com/group/mozilla.dev.tech.js-engine/browse_thread/thread/a4d1fe147761aacb/e61d2592faf4ef72?lnk=gst&amp;q=js_setoperationcallback#e61d2592faf4ef72&quot;&gt;http://groups.google.com/group/mozilla.dev.tech.js-engine/browse_thread/thread/a4d1fe147761aacb/e61d2592faf4ef72?lnk=gst&amp;amp;q=js_setoperationcallback#e61d2592faf4ef72&lt;/a&gt; for reference.</description>
                <environment></environment>
            <key id="12438996">COUCHDB-542</key>
        <summary>Fix for COUCHDB-288 makes JS_MaybeGC not called</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="glandium">Mike Hommey</reporter>
            
    <created>Sat, 24 Oct 2009 13:56:44 +0000 (UTC)</created>
    <updated>Sun, 25 Oct 2009 17:23:46 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12769726" author="paul.joseph.davis" created="Sat, 24 Oct 2009 22:27:18 +0000 (UTC)"  >Mike,&lt;br/&gt;
&lt;br/&gt;
Good catch on that. When I wrote the patches that ended up with what we have now I was more worried about getting the thing to compile properly for all the different versions of Spidermonkey than anything else. I didn&apos;t even dig deep enough to see that I was supposed to be setting up a signal handler to call that periodically.&lt;br/&gt;
&lt;br/&gt;
The more than I read about this the more I think the proper fix is to just ixnay the whole callback situation and forget that it ever existed. For reference, my knowledge of that callback is that it&apos;s used to prevent infinite loop scripts as well as trigger garbage collection periodically.&lt;br/&gt;
&lt;br/&gt;
CouchDB solves the runaway script issue by requiring that all communication to external servers complete in a defined set of time (default of 5 seconds). When a script exceeds this threshold its forcibly terminated by the Erlang VM and eventually replaced when needed.&lt;br/&gt;
&lt;br/&gt;
As to garbage collection, the current protocol runs the &amp;quot;reset&amp;quot; command each time an OS process is retrieved from the pool. At this point JS_GC() is called forcing collection. JS_MaybeGC is also called for every line of input which will save us with long checkouts during things like view building and _changes filtering.&lt;br/&gt;
&lt;br/&gt;
So, yeah, I think I just convinced myself that we should probably just delete the whole thing. Unless of course I&apos;m missing a case where having JS_MaybeGC calls are required and not being called. What do you think?</comment>
                    <comment id="12769768" author="glandium" created="Sun, 25 Oct 2009 08:42:32 +0000 (UTC)"  >This sounds reasonable, though I&apos;d have a comment to add to what you describe as the current behaviour for runaway scripts. Disclaimer: I don&apos;t know the couchdb code, nor spidermonkey deep internals. I&apos;m afraid there could be some subtle memory leaks if you forcibly terminate the javascript engine without going through the operationcallback, which could be used to gracefully terminate the engine. The latter would be better, I think, except if what you mean by forcibly terminating by the Erlang VM is that a separate process, handling javascript, is killed, in which case, there&apos;s no cleanup to do.</comment>
                    <comment id="12769836" author="paul.joseph.davis" created="Sun, 25 Oct 2009 17:23:46 +0000 (UTC)"  >The view servers are run in their own OS level process and communicated with over stdio. Thus when we kill the process its up to the kernel to make sure all is well. I&apos;m toying around with refactoring couchjs so that I can work on the command line tests. I&apos;ll look at making those changes as well and see how things go.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Oct 2009 22:27:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-541] Multiple instances stomp on each other.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-541</link>

                    <description>&lt;br/&gt;
&amp;gt;  And, just now, I realized that it is wanting to create databases&lt;br/&gt;
&amp;gt;  in whatever directory I start from. (I do not understand why&lt;br/&gt;
&amp;gt;  it wasn&apos;t trying to create them in /usr/local/var/lib but rather&lt;br/&gt;
&amp;gt;  /usr/local/var/lib/couchdb before).&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;  I start PAT in /usr/local/var/lib/couchdb_pat&lt;br/&gt;
&amp;gt;  and start&lt;br/&gt;
&amp;gt;  MIKE in /usr/local/var/lib/couchdb_mike&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;  and I can run separate test suites and create databases with&lt;br/&gt;
&amp;gt;  each invocation that the other invocation does not see.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;  The trivial workaround to have it function as I want is to&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;  cd path/to/invocation/database/directory &amp;amp;&amp;amp; couchdb -n -a ...&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;  Of course, not a long-term strategy but will work for now.&lt;br/&gt;
&lt;br/&gt;
I blame Adam. :) Sounds like it should be a quick one. I&apos;ll get to it tomorrow hopefully.&lt;br/&gt;
</description>
                <environment>trunk</environment>
            <key id="12438978">COUCHDB-541</key>
        <summary>Multiple instances stomp on each other.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sat, 24 Oct 2009 06:20:30 +0000 (UTC)</created>
    <updated>Sat, 24 Oct 2009 06:20:30 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-540] oauth_token_users seems to be in the wrong place</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-540</link>

                    <description>If one has many users, the oath_token_users section of /etc/couchdb/local.ini becomes quite large. This:&lt;br/&gt;
&lt;br/&gt;
a) makes legitimate configuration of the server less friendly&lt;br/&gt;
b) makes the file extremely hard to manage via version control&lt;br/&gt;
c) is probably a violation of the FHS.</description>
                <environment>Ubuntu Linux</environment>
            <key id="12438929">COUCHDB-540</key>
        <summary>oauth_token_users seems to be in the wrong place</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="cmsj">Chris Jones</reporter>
            
    <created>Fri, 23 Oct 2009 14:54:19 +0000 (UTC)</created>
    <updated>Fri, 23 Oct 2009 17:28:22 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12769249" author="thisfred" created="Fri, 23 Oct 2009 15:11:55 +0000 (UTC)"  >I can confirm this is problematic for large numbers of users. The same goes for oauth_token_secrets.</comment>
                    <comment id="12769255" author="paul.joseph.davis" created="Fri, 23 Oct 2009 15:24:18 +0000 (UTC)"  >Definitely a valid point. Does the _users database not do what you&apos;re needing? Or is there another method you&apos;d prefer? At one point someone mentioned writing an ldap connector but I&apos;ve never heard what happened to that. I&apos;m not sure I follow about an FHS violation.&lt;br/&gt;
&lt;br/&gt;
Another possibility that was discussed was giving the config writer more smarts so that it&apos;d remember the last file that defined a section and use that as the write back target for each section. This would allow you to have a local_users.ini that would receive updates via config API and not get appended to some other random file that happened to sort last.</comment>
                    <comment id="12769261" author="cmsj" created="Fri, 23 Oct 2009 15:36:23 +0000 (UTC)"  >Paul: The FHS gives guidance as to which directories it&apos;s appropriate to store which kinds of data.&lt;br/&gt;
&lt;a href=&quot;http://www.pathname.com/fhs/pub/fhs-2.3.html#PURPOSE31&quot;&gt;http://www.pathname.com/fhs/pub/fhs-2.3.html#PURPOSE31&lt;/a&gt; talks about /var, which I would think would typically be the most correct place for this kind of data to be written, specifically /var/lib/ &lt;br/&gt;
(in the same way that mysql&apos;s daemon config lives in /etc/mysql/, but it writes the raw datafiles containing its databases in /var/lib/mysql)&lt;br/&gt;
&lt;br/&gt;
I don&apos;t particularly mind how the data is stored (although LDAP seems like overkill for simple one key/one value user data), and if there is already an alternative option we can use I would definitely investigate that, I just care as a sysadmin about /etc/ being easy to manage :)</comment>
                    <comment id="12769262" author="thisfred" created="Fri, 23 Oct 2009 15:38:12 +0000 (UTC)"  >The /users database would be an excellent place to store these, but the current implementation does not do that yet. A separate local_users.ini would be an improvement, but a minor one IMO.</comment>
                    <comment id="12769315" author="paul.joseph.davis" created="Fri, 23 Oct 2009 17:28:21 +0000 (UTC)"  >@Chris&lt;br/&gt;
&lt;br/&gt;
Ahh, we&apos;re just classifying differently. I still consider the user auth bits config data, but I don&apos;t work with systems that have lots and lots of users. Moving the user config data and treating it differently than the config data would probably include writing a whole new system for dealing with it. Not out of the question, but I think the current plan is to run with the _users database method.&lt;br/&gt;
&lt;br/&gt;
@Eric,&lt;br/&gt;
&lt;br/&gt;
Does it not? I haven&apos;t kept up as closely as I should on Jason&apos;s work with the different bits. I&apos;m pretty sure that&apos;s the direction he&apos;s going though so I think this will be solved as work progresses. I&apos;d agree that the local_users.ini is a much less elegant solution.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Oct 2009 15:11:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-539] couchdb spawns too many processes when system/laptop comes back from sleep.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-539</link>

                    <description>I&apos;ve installed couchdb from source and also from ports, when the system goes to sleep and is resumed, After a few moments I see:&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 23-Oct-2009::18:23:38 ===&lt;br/&gt;
Too many processes&lt;br/&gt;
&lt;br/&gt;
[error] [emulator] Too many processes&lt;br/&gt;
&lt;br/&gt;
Scrolling thousands of times in the window, unfortunately it doesn&apos;t happen every time, but the scrollback buffer would need to be huge to catch the original problem (if it was at all visible).&lt;br/&gt;
&lt;br/&gt;
# couchdb -V&lt;br/&gt;
couchdb - Apache CouchDB 0.9.1&lt;br/&gt;
&lt;br/&gt;
I&apos;m usually available on freenode as wmealing if you ahve any questions.</description>
                <environment>Mac OSX snow leopard, Fedora 12.</environment>
            <key id="12438925">COUCHDB-539</key>
        <summary>couchdb spawns too many processes when system/laptop comes back from sleep.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="wmealing">Wade Mealing</reporter>
            
    <created>Fri, 23 Oct 2009 14:21:03 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 17:10:09 +0000 (UTC)</updated>

                
                        <fixVersion>0.10.1</fixVersion>
                    <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12769252" author="paul.joseph.davis" created="Fri, 23 Oct 2009 15:18:31 +0000 (UTC)"  >If I&apos;m not mistaken, this comes from one of the timers. When the system wakes up it freaks out and tries to overcompensate. Last I heard this was just a &amp;quot;ignore the error&amp;quot; sort of thing but I haven&apos;t looked at it lately.</comment>
                    <comment id="12773040" author="rnewson" created="Tue, 3 Nov 2009 12:44:19 +0000 (UTC)"  >Is this the cause of the 100% cpu usage when resuming from sleep? I think this is more than &amp;quot;minor&amp;quot; if we&apos;re getting millions of Ubuntu users soon. :)</comment>
                    <comment id="12781006" author="kocolosk" created="Sat, 21 Nov 2009 17:10:09 +0000 (UTC)"  >Just closing it out, fix landed a while ago.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                            <outwardlinks description="duplicates">
                            <issuelink>
            <issuekey id="12412111">COUCHDB-204</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:10:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Oct 2009 15:18:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-538] Erlang crashing when log file cannot be written</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-538</link>

                    <description>When couchdb cannot write to its log file erlang just crashes without any hint what is going wrong. This happens for instance if the log file directory path does not exists.&lt;br/&gt;
&lt;br/&gt;
In some older releases (0.9) it seemed to have created the missing directories automatically (if permissions are ok). 0.10 does not even try to create the directories. The log path needs to exist.&lt;br/&gt;
&lt;br/&gt;
At least a proper error message should be added to make clear that there is a problem writing the log file.</description>
                <environment>Linux Ubuntu 32bit and 64bit</environment>
            <key id="12438444">COUCHDB-538</key>
        <summary>Erlang crashing when log file cannot be written</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="longsleep">Simon Eisenmann</reporter>
            
    <created>Mon, 19 Oct 2009 12:49:04 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:50:04 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12767353" author="nslater" created="Mon, 19 Oct 2009 15:34:15 +0000 (UTC)"  >The directories are created as part of the &amp;quot;make install&amp;quot; command. Make sure you are running it as root, or installing into a user directory.</comment>
                    <comment id="12767378" author="longsleep" created="Mon, 19 Oct 2009 16:52:44 +0000 (UTC)"  >Thats true yes. But still if for whatever reason they do not exist any more or if the paths are changed in the configuration file, the user will never guess what the problem is, as there is no helping error message.&lt;br/&gt;
&lt;br/&gt;
I am not saything that it should not crash or something. Just catch the error and bail with a meaningful exception.</comment>
                    <comment id="12767381" author="kocolosk" created="Mon, 19 Oct 2009 16:58:29 +0000 (UTC)"  >Agreed -- you&apos;re not the first to bring this up, and it&apos;s an easy thing to do.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12407814">COUCHDB-153</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 19 Oct 2009 15:34:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-537] reduce string</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-537</link>

                    <description>For a simple reduce as _sum if i add a space after _sum it crashes.&lt;br/&gt;
Don&apos;t know how likely it is to add a space by mistake maybe the input could be trimed ?</description>
                <environment>ubuntu from source 0.10</environment>
            <key id="12438443">COUCHDB-537</key>
        <summary>reduce string</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="coulix">greg tappero</reporter>
            
    <created>Mon, 19 Oct 2009 12:42:17 +0000 (UTC)</created>
    <updated>Mon, 19 Oct 2009 12:42:54 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-536] CouchDB HTTP server stops accepting connections</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-536</link>

                    <description>Having 3 Couches all replicating a couple of databases to each other (pull replication with a update notification process) the HTTP service on any of the Couches stops working at some point (when running for a couple of ours with constant changes on all databases and servers).&lt;br/&gt;
&lt;br/&gt;
This is the error when a new HTTP request comes in:&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 19-Oct-2009::10:18:55 ===&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;application: mochiweb&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Accept failed error&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;{error,enfile}&amp;quot;&lt;br/&gt;
[error] [&amp;lt;0.21619.12&amp;gt;] {error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.21619.12&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{mochiweb_socket_server,acceptor_loop,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.21619.12&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,accept_failed},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_socket_server,acceptor_loop,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_httpd,couch_secondary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.66.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,233},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,202}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
[error] [&amp;lt;0.66.0&amp;gt;] {error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.66.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,225,{acceptor_error,{error,accept_failed}}}}}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
To me this seems like it runs out of threads or sockets to handle the new connection or somewhat like this.&lt;br/&gt;
&lt;br/&gt;
Also i see in this setup that if i put lots of changes in a short time at some point the replication process hangs (never finishes) and when trying to restart the same replication once again is not possible and resulting in a timeout.</description>
                <environment>Ubuntu Linux 8.04 32bit and 64bit with Erlang R13B01</environment>
            <key id="12438422">COUCHDB-536</key>
        <summary>CouchDB HTTP server stops accepting connections</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="longsleep">Simon Eisenmann</reporter>
            
    <created>Mon, 19 Oct 2009 08:30:27 +0000 (UTC)</created>
    <updated>Mon, 19 Oct 2009 08:30:27 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-535] Configure issue with icu4c-4.3.2 on Mac OS 10.6</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-535</link>

                    <description>For some unknown reason `icu-config --version` outputs &amp;quot;-n 4.3.2&amp;quot; when run from configure. Running `icu-config --version` normally works as expected.&lt;br/&gt;
&lt;br/&gt;
Below the line that sets ICU_VERSION:&lt;br/&gt;
ICU_VERSION=`$ICU_CONFIG --version`&lt;br/&gt;
&lt;br/&gt;
I added these lines:&lt;br/&gt;
# Fix bug in -n showing up in version string&lt;br/&gt;
ICU_VERSION=${ICU_VERSION#* }&lt;br/&gt;
&lt;br/&gt;
And this works around the issue for me.&lt;br/&gt;
&lt;br/&gt;
I can attach either a diff of the .m4 or the .m4.gz</description>
                <environment>Mac OS 10.6 with icu4c-4.3.2&lt;br/&gt;
aclocal --version == 1.10&lt;br/&gt;
autoconfig --version == 2.61</environment>
            <key id="12438411">COUCHDB-535</key>
        <summary>Configure issue with icu4c-4.3.2 on Mac OS 10.6</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="mikeal">mikeal</reporter>
            
    <created>Sun, 18 Oct 2009 22:42:34 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 22:03:15 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-534] Futon&apos;s status page, when polling to show current status, is sometimes out of sync with server.  Full page refresh can bring it back in sync.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-534</link>

                    <description>I have seen the &apos;status&apos; page in Futon get out of sync with the tasks actually running on the server on several occasions when relying on the automatic polling feature which polls the server via background request every N seconds.  Doing a full browser page refresh seems to resolve the issue.&lt;br/&gt;
&lt;br/&gt;
When I have seen this issue it shows, ever after period page refreshes, the same status items which seem frozen, leading the user to believe that the processes of interest may be frozen.  This is likely erroneous.&lt;br/&gt;
&lt;br/&gt;
So its seems there is a problem with the API used to retrieve background ajax info.&lt;br/&gt;
&lt;br/&gt;
Expected behavior : The polling based status page, should always show exactly the same info as the status page after a full page refresh.</description>
                <environment></environment>
            <key id="12438374">COUCHDB-534</key>
        <summary>Futon&apos;s status page, when polling to show current status, is sometimes out of sync with server.  Full page refresh can bring it back in sync.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Sat, 17 Oct 2009 20:20:45 +0000 (UTC)</created>
    <updated>Sat, 17 Oct 2009 20:20:45 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-533] When multiple futon views are open, pointing at different couchdb&apos;s running on different ports, the &apos;recent databases&apos; section erroneously shows DB&apos;s across all futons.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-533</link>

                    <description>I am running a local CouchDB on localhost:5984.  I am also running a production CouchDB on a remote host that I am doing SSH port forwarding for which I have mapped to localhost:5994.  I am accessing their futon instances via:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/_utils/status.html&quot;&gt;http://localhost:5984/_utils/status.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://localhost:5994/_utils/status.html&quot;&gt;http://localhost:5994/_utils/status.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Viewing the futon for both shows all databases in the &apos;Recent Databases&apos; section, across both instances, in both futons.  This is incorrect as each futon should only show the subset of DB&apos;s that it actually contains.&lt;br/&gt;
&lt;br/&gt;
e.g.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/_utils/status.html&quot;&gt;http://localhost:5984/_utils/status.html&lt;/a&gt; - should only show &apos;foo_dev&apos;&lt;br/&gt;
&lt;a href=&quot;http://localhost:5994/_utils/status.html&quot;&gt;http://localhost:5994/_utils/status.html&lt;/a&gt; - should only show &apos;foo_production&apos;&lt;br/&gt;
&lt;br/&gt;
Clicking on a database that doesn&apos;t actually exist results in two javascript alerts.  The first of which says &apos;An error occurred retrieving a list of all documents: no_db_file&apos;&lt;br/&gt;
&lt;br/&gt;
Expected behavior:&lt;br/&gt;
&lt;br/&gt;
Futon should only show databases that exist on the instance being monitored in the &apos;Recent Databases&apos; section.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12438372">COUCHDB-533</key>
        <summary>When multiple futon views are open, pointing at different couchdb&apos;s running on different ports, the &apos;recent databases&apos; section erroneously shows DB&apos;s across all futons.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Sat, 17 Oct 2009 20:13:06 +0000 (UTC)</created>
    <updated>Wed, 20 Jan 2010 22:43:34 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12774679" author="fdmanana" created="Sat, 7 Nov 2009 22:24:07 +0000 (UTC)"  >Hello,&lt;br/&gt;
&lt;br/&gt;
This patch fixes the problem.&lt;br/&gt;
&lt;br/&gt;
The name of the cookie containing the list of the recent databases now depends on the server&apos;s hostname and port.&lt;br/&gt;
(Only the port info is actually necessary to avoid the cookie sharing, but...&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12803031" author="cmlenz" created="Wed, 20 Jan 2010 22:43:34 +0000 (UTC)"  >Wow, HTTP cookies and ports don&apos;t really like each other, it seems.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve checked in a fix based on your idea to include the port in the cookie name in r901413.</comment>
                </comments>
    
    <attachments>
            <attachment id="12424270" name="jira-couchdb-533-patch-for-trunk.patch" size="2823" author="fdmanana" created="Sat, 7 Nov 2009 22:24:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 20 Jan 2010 22:43:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 7 Nov 2009 22:24:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-532] Have requests for views that use &apos;stale=ok&apos; return whats in the index immediately, but still kickoff background indexing process.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-532</link>

                    <description>Currently a common use case for querying indexes from external applications is to pass in the optional parameter &apos;stale=ok&apos; which instructs the view to return what is has in its index immediately without waiting for the index to first catch up.&lt;br/&gt;
&lt;br/&gt;
This is a *very* important feature as it allows applications to eliminate the poor user experience of potential HTTP client timeouts or long&apos;ish waits for a query to return while the index is updated.&lt;br/&gt;
&lt;br/&gt;
However, applications that make extensive (or in my case exlusive) use of this feature are now essentially *required* to build some kind of script which will do the indexing in the background since no user requests will *ever* initiate indexing.  This would be for example a cron script that makes an HTTP call to the view every N hours.  This becomes an operational issue as you now have to write, maintain and schedule an external script which calls each view in each of your DBs periodically.&lt;br/&gt;
&lt;br/&gt;
I propose to the team, after some discussion with Paul Joseph Davis, that view requests with the &apos;stale=ok&apos; param continue to return results in the as-is index to users immediately, but *also* kick off the background indexing process.  This would have the effect of removing the need for any external maintenance scripts (aside from DB/View compaction which is a related but separate issue).&lt;br/&gt;
&lt;br/&gt;
In some use cases it might be true that indexing *must* occur outside of &apos;normal business hours&apos; due to processing load.  If this is a requirement the behavior of view indexing on &apos;stale&apos; requests could be configurable (e.g. as a boolean to always/never do this additional background indexing, or force BG indexing every N requests/minutes using &apos;stale&apos;).&lt;br/&gt;
&lt;br/&gt;
Cheers.</description>
                <environment>All</environment>
            <key id="12438348">COUCHDB-532</key>
        <summary>Have requests for views that use &apos;stale=ok&apos; return whats in the index immediately, but still kickoff background indexing process.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Fri, 16 Oct 2009 22:48:56 +0000 (UTC)</created>
    <updated>Sun, 18 Oct 2009 22:41:43 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12766904" author="janl" created="Sat, 17 Oct 2009 13:03:22 +0000 (UTC)"  >I think we have plans for a facility that fixes the underlying issue here without the proposed way of solving it. Adam and I are dreaming up a &amp;quot;task manager&amp;quot; sorta like cron, that lets you define arbitrary actions to be run on events, they could be time related, based on stats counters or just continuous. for example continuous replication that is supposed to survive a server restart is one of these things. or scheduling compaction to run each night at 2am. another part is keeping views up to date asynchronously, so clients can use stale=ok all the time. I&apos;m pretty sure we a ticket for this, but I couldn&apos;t find it just now.</comment>
                    <comment id="12766938" author="grempe" created="Sat, 17 Oct 2009 16:46:48 +0000 (UTC)"  >Jan,  This would, in my opinion, be an excellent new facility to have.  Based on your description it would indeed solve the issue at hand nicely if it were time and event based.  Allowing for cron-like control over all of the major aspects of CouchDB would be powerful.&lt;br/&gt;
&lt;br/&gt;
Would you say this is a long term feature plan that is early in its design, or one that is close to reaching fruition?  If its a longer term feature plan,  perhaps the enhancement to do background indexing on stale=ok could be implemented as a stop-gap measure in the interim if its easy to add (and just as easy to remove later)?  Speaking for myself I could use this feature yesterday. :-)</comment>
                    <comment id="12766941" author="janl" created="Sat, 17 Oct 2009 17:09:57 +0000 (UTC)"  >I want this for 0.11 ;)&lt;br/&gt;
&lt;br/&gt;
I don&apos;t like adding stopgap cruft to the already complex view engine code.</comment>
                    <comment id="12767151" author="kocolosk" created="Sun, 18 Oct 2009 22:41:43 +0000 (UTC)"  >I can certainly add the automatic async view updating in time for 0.11 if no one else does.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 17 Oct 2009 13:03:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-531] Reduce error messages are broken,</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-531</link>

                    <description>This should just be a list_to_binary call on the JSON parsed from the view server.</description>
                <environment></environment>
            <key id="12438255">COUCHDB-531</key>
        <summary>Reduce error messages are broken,</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Thu, 15 Oct 2009 21:52:26 +0000 (UTC)</created>
    <updated>Fri, 16 Oct 2009 00:24:10 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12766344" author="paul.joseph.davis" created="Fri, 16 Oct 2009 00:24:10 +0000 (UTC)"  >I&apos;m a moron. The output I thought was a serialized list is actually just an array output. But that also means I&apos;m so good I fixed this bug without writing any code. PEBUK.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 16 Oct 2009 00:24:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-530] reduce_overflow_error on a view without reduce</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-530</link>

                    <description>This view used to work on 0.9.1, I&apos;ve installed 0.10.0 and migrated some data.&lt;br/&gt;
When running the view I get the following error:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(env2.5)[11:47] admin $curl &apos;localhost:5985/stats/_design/stats/_view/active&apos;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;reduce_overflow_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Reduce output must shrink more rapidly: Current output: &apos;[[25,17,117,25,93,17,13,13,12,24,14,13,10,15,20,12,14,14,17,36,38,83,18,11,1058,12,10,29,13,12,10,14&apos;... (first 100 of 1395 bytes)&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
What&apos;s interesting is that this view does not have a reduce function. The map function is:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function (doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (doc.Type == &apos;max active&apos;) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;emit(doc.Time, doc.Count);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
A typical document looks like:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;_id&amp;quot;:&amp;quot;02c94bea2900686a01ebbf8829aabfa2&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;1-cccb3b5eb382bf609bd41feb85af063b&amp;quot;,&amp;quot;Count&amp;quot;:2,&amp;quot;Type&amp;quot;:&amp;quot;max active&amp;quot;,&amp;quot;Time&amp;quot;:1254362400.0}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Ubuntu 9.04</environment>
            <key id="12438232">COUCHDB-530</key>
        <summary>reduce_overflow_error on a view without reduce</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="tebeka">Miki Tebeka</reporter>
            
    <created>Thu, 15 Oct 2009 18:54:03 +0000 (UTC)</created>
    <updated>Thu, 15 Oct 2009 21:51:28 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12766172" author="paul.joseph.davis" created="Thu, 15 Oct 2009 18:57:23 +0000 (UTC)"  >Is there another view in the same design doc that does have a reduce function? I&apos;ve never seen a report of that error being triggered accidentally and your view doesn&apos;t do anything that should cause it.</comment>
                    <comment id="12766208" author="tebeka" created="Thu, 15 Oct 2009 20:09:00 +0000 (UTC)"  >Yes, there are other views in the same design who do use reduce. I&apos;m attaching the design.&lt;br/&gt;
Come to think of it, the problem started when trying to access another view in this design, can&apos;t remember exactly which.</comment>
                    <comment id="12766210" author="tebeka" created="Thu, 15 Oct 2009 20:10:04 +0000 (UTC)"  >The design who&apos;s causing the problem.</comment>
                    <comment id="12766216" author="paul.joseph.davis" created="Thu, 15 Oct 2009 20:18:31 +0000 (UTC)"  >Can anyone download that attachment? JIRA is being weird about it.</comment>
                    <comment id="12766229" author="kocolosk" created="Thu, 15 Oct 2009 20:30:34 +0000 (UTC)"  >worked for me in Safari</comment>
                    <comment id="12766258" author="paul.joseph.davis" created="Thu, 15 Oct 2009 21:11:17 +0000 (UTC)"  >Oh there it is.&lt;br/&gt;
&lt;br/&gt;
In the &amp;quot;duration_by_day&amp;quot; view the reduce function is doing &amp;quot;return Array.concat.apply(Array, values);&amp;quot; which will most assuredly break the reduce limit. Remember that when you build a view CouchDB is building all views in the same design doc, so the errors will be reported for any of the views in that doc.&lt;br/&gt;
</comment>
                    <comment id="12766259" author="tebeka" created="Thu, 15 Oct 2009 21:13:10 +0000 (UTC)"  >Paul, I&apos;ve emailed you the file.</comment>
                    <comment id="12766265" author="tebeka" created="Thu, 15 Oct 2009 21:30:24 +0000 (UTC)"  >Just saw your comment.&lt;br/&gt;
&lt;br/&gt;
1. I think the error can be more helpful.&lt;br/&gt;
2. I still don&apos;t understand how it works with 0.9.1 on the same data.</comment>
                    <comment id="12766267" author="paul.joseph.davis" created="Thu, 15 Oct 2009 21:35:51 +0000 (UTC)"  >I don&apos;t think it was an error in 0.9.1 and its possible to disable that check in the config.&lt;br/&gt;
&lt;br/&gt;
One thing that we have said before is the ability to make views return errors and warnings to the user from view building but the current setup makes that somewhat difficult currently.&lt;br/&gt;
&lt;br/&gt;
Also, that error is a bit wonky with the list vs binary confusion. I&apos;ll put it on the list to fix.</comment>
                    <comment id="12766273" author="tebeka" created="Thu, 15 Oct 2009 21:45:53 +0000 (UTC)"  >Thanks Paul. I&apos;ll update my view or change the config. Should I close this bug then?</comment>
                    <comment id="12766279" author="paul.joseph.davis" created="Thu, 15 Oct 2009 21:51:28 +0000 (UTC)"  >No prob. I resolved it earlier when I saw return Array.concat ;)</comment>
                </comments>
    
    <attachments>
            <attachment id="12422270" name="stats.view" size="3773" author="tebeka" created="Thu, 15 Oct 2009 20:10:04 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 15 Oct 2009 21:11:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 15 Oct 2009 18:57:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-529] Avoiding updating a doc&apos;s _rev if nothing changed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-529</link>

                    <description>Would it be possible for CouchDB to use its deterministic rev algorithm to avoid writing changes to the database if nothing has actually changed in the doc that is sent for update.&lt;br/&gt;
&lt;br/&gt;
The most obvious use case is the user who clicks an HTML form&apos;s submit button, instead of using the back button, when they haven&apos;t changed anything. I suspect most applications do not check if the user made any changes and therefore end up sending exactly the same data back as an update ... unnecessarily creating a new document rev, growing the database, invalidating views, triggering _changes updates, etc.&lt;br/&gt;
&lt;br/&gt;
If CouchDB could determine that the new document is the same as the old document then it could avoid writing to disc and return the current _rev in the response.</description>
                <environment></environment>
            <key id="12438216">COUCHDB-529</key>
        <summary>Avoiding updating a doc&apos;s _rev if nothing changed</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="emgee">Matt Goodall</reporter>
            
    <created>Thu, 15 Oct 2009 15:37:29 +0000 (UTC)</created>
    <updated>Thu, 15 Oct 2009 15:46:46 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12766103" author="emgee" created="Thu, 15 Oct 2009 15:46:46 +0000 (UTC)"  >Relevant comments from the mailing list:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;the old revision of the document is part of the content used to generate the hash that becomes the new revision.&amp;quot;,  Adam Kocoloski.&lt;br/&gt;
&lt;br/&gt;
&amp;quot;If you don&apos;t include the previous document&apos;s revision, then your hashes are unidirected and don&apos;t form a Merkle tree.&amp;quot;, Paul Davis.&lt;br/&gt;
&lt;br/&gt;
So, it may not be possible without the overhead of re-calculating the old hash or something similar.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-528] Views and keyed access</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-528</link>

                    <description>If you try eg.&lt;br/&gt;
&lt;br/&gt;
curl -v -d &apos;{&amp;quot;keys&amp;quot;:[&amp;quot;srp_WPG&amp;quot;,&amp;quot;srp_WLUX&amp;quot;]}&apos; &lt;a href=&quot;http://localhost:5984/booking_reverseidxes/_design/Booking::ReverseIdx-0aab4fe0eb7bdb4ac59f67c4e9453b52/_view/all&quot;&gt;http://localhost:5984/booking_reverseidxes/_design/Booking::ReverseIdx-0aab4fe0eb7bdb4ac59f67c4e9453b52/_view/all&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
you will except in the best case a answer of two rows. If the two key rows exists. If I use _all_docs it works like excepted. If I use a view the answer is a empty rows array. &lt;br/&gt;
&lt;br/&gt;
I had a in depth look to the source in ./src/couchdb/couch_httpd_view.erl&lt;br/&gt;
but I am just to new with erlang, to find the problem and fix it. &lt;br/&gt;
It is still possible that I make a usage error, than feel free to blame me.&lt;br/&gt;
&lt;br/&gt;
I expect the problem in&lt;br/&gt;
output_map_view(Req, View, Group, Db, QueryArgs, Keys) -&amp;gt;&lt;br/&gt;
....&lt;br/&gt;
FoldlFun = make_view_fold_fun(Req,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;QueryArgs#view_query_args{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;start_key = Key,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end_key = Key&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}, CurrentEtag, Db, RowCount,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#view_fold_helper_funs{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;reduce_count = fun couch_view:reduce_to_count/1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;})&lt;br/&gt;
&lt;br/&gt;
which is the only differend code part between keyed and none keyed access.&lt;br/&gt;
&lt;br/&gt;
My map method in the view looks like this which should be harmless and not depend to the problem.&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;all&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;map&amp;quot;: &amp;quot;function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (doc[&apos;couchrest-type&apos;] == &apos;Booking::ReverseIdx&apos;) { emit(null,null); } &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
thx in advance&lt;br/&gt;
&lt;br/&gt;
meno</description>
                <environment>linux</environment>
            <key id="12438135">COUCHDB-528</key>
        <summary>Views and keyed access</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="menoabels">Meno Abels</reporter>
            
    <created>Wed, 14 Oct 2009 22:36:55 +0000 (UTC)</created>
    <updated>Thu, 15 Oct 2009 05:10:09 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12765800" author="paul.joseph.davis" created="Wed, 14 Oct 2009 22:56:58 +0000 (UTC)"  >Meno,&lt;br/&gt;
&lt;br/&gt;
The keys in the POST&apos;ed body should refer to the key that was emitted by the view. If that request works with _all_docs and you&apos;re wanting to use that with a view, your emit statement should be emit(doc._id, null).&lt;br/&gt;
&lt;br/&gt;
Paul</comment>
                    <comment id="12765898" author="menoabels" created="Thu, 15 Oct 2009 04:36:57 +0000 (UTC)"  >Thx,&lt;br/&gt;
&lt;br/&gt;
for the fast help, now it works but i don&apos;t get why the emit has to be doc._id in that case? &lt;br/&gt;
</comment>
                    <comment id="12765900" author="paul.joseph.davis" created="Thu, 15 Oct 2009 04:43:42 +0000 (UTC)"  >Meno,&lt;br/&gt;
&lt;br/&gt;
Don&apos;t think of it as &amp;quot;has to be&amp;quot;. Think of it as &amp;quot;can be&amp;quot;. Because the current behavior allows you to emit anything from your document to use for multi-get. For instance you could do &amp;quot;emit(doc.tag, null)&amp;quot; and then POST {&amp;quot;keys&amp;quot;: [&amp;quot;tag1&amp;quot;, &amp;quot;tag2&amp;quot;]} to get all docs with either tag1 or tag2 which you couldn&apos;t do otherwise.&lt;br/&gt;
&lt;br/&gt;
Paul</comment>
                    <comment id="12765905" author="menoabels" created="Thu, 15 Oct 2009 05:10:09 +0000 (UTC)"  >The seams to be clear to me, but i though that emit(null,null) will take every thing which is mapped. &lt;br/&gt;
So I dont need to specify a key. &lt;br/&gt;
In fact if I query without key-ranges and use emit(null,null) i get all documents, so why I has the emit&lt;br/&gt;
be different if I query with a key-range. &lt;br/&gt;
I now know there is no difference between emit(doc._id,null) in result without a key-range.&lt;br/&gt;
If hust looks for me a bit disurbing, of course in the key-range query i need the doc.xxxx as the first &lt;br/&gt;
emit parameter to get results and without key-range i dont need. &lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 15 Oct 2009 04:36:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 14 Oct 2009 22:56:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-527] add a check to see that the driver directory exists</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-527</link>

                    <description>Adding ticket as reminder per Paul Davis.  Should be assigned to him.&lt;br/&gt;
&lt;br/&gt;
add a check to see that the driver directory exists &apos;Eh, $PREFIX/lib/couchdb-$(VERSION/priv/lib&apos;&lt;br/&gt;
&lt;br/&gt;
and mention in couch_server_sup.erl just before couch_util:start_driver()&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12438134">COUCHDB-527</key>
        <summary>add a check to see that the driver directory exists</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Wed, 14 Oct 2009 22:32:37 +0000 (UTC)</created>
    <updated>Wed, 14 Oct 2009 22:33:59 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12765795" author="paul.joseph.davis" created="Wed, 14 Oct 2009 22:33:59 +0000 (UTC)"  >Add a check that the driver directory exists. Other wise there&apos;s an error that made me waste a good bit of time thinking it was permissions related.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 14 Oct 2009 22:33:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-526] Add missing NEWS items to 0.11 NEWS</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-526</link>

                    <description>we need to keep track of stuff that happened in NEWS.</description>
                <environment></environment>
            <key id="12438024">COUCHDB-526</key>
        <summary>Add missing NEWS items to 0.11 NEWS</summary>

            <type id="3" iconUrl="http://issues.apache.org/jira/images/icons/task.gif">Task</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 13 Oct 2009 23:45:30 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:36:38 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12828279" author="janl" created="Mon, 1 Feb 2010 21:36:38 +0000 (UTC)"  >done</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 21:36:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-525] create_target replication option should work with OAuth</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-525</link>

                    <description>The new create_target option makes an HTTP request with an OAuth signature that assumes HEAD rather than PUT.</description>
                <environment></environment>
            <key id="12437869">COUCHDB-525</key>
        <summary>create_target replication option should work with OAuth</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jasondd">Jason Davies</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 12 Oct 2009 15:01:47 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:24:57 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12764809" author="janl" created="Mon, 12 Oct 2009 20:04:39 +0000 (UTC)"  >Adam, good call. This should do the trick:&lt;br/&gt;
&lt;br/&gt;
diff --git a/src/couchdb/couch_rep_httpc.erl b/src/couchdb/couch_rep_httpc.erl&lt;br/&gt;
index ba86374..69c640c 100644&lt;br/&gt;
--- a/src/couchdb/couch_rep_httpc.erl&lt;br/&gt;
+++ b/src/couchdb/couch_rep_httpc.erl&lt;br/&gt;
@@ -78,7 +78,11 @@ db_exists(Req, CanonicalUrl, CreateDB) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Headers0;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{OAuthProps} -&amp;gt;&lt;br/&gt;
-        [oauth_header(Url, [], head, OAuthProps) | Headers0]&lt;br/&gt;
+        Method = case CreateDB of&lt;br/&gt;
+            true -&amp;gt; put;&lt;br/&gt;
+            _False -&amp;gt; head&lt;br/&gt;
+        end,&lt;br/&gt;
+        [oauth_header(Url, [], Method, OAuthProps) | Headers0]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case CreateDB of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;true -&amp;gt;&lt;br/&gt;
&lt;br/&gt;
Do we have a test for that?</comment>
                    <comment id="12764865" author="jasondd" created="Mon, 12 Oct 2009 22:01:01 +0000 (UTC)"  >Jan: I think that would result in an invalid signature for the second (HEAD) request.  This patch covers both the HEAD and PUT requests.  Yes, a test would be nice :-)</comment>
                    <comment id="12765279" author="jasondd" created="Tue, 13 Oct 2009 22:20:21 +0000 (UTC)"  >Fixed in r824954.  Leaving this open for now as I need to add a test for this.</comment>
                </comments>
    
    <attachments>
            <attachment id="12421917" name="COUCHDB-525.patch" size="1156" author="jasondd" created="Mon, 12 Oct 2009 22:01:01 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 12 Oct 2009 20:04:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-524] make check should not use the default CouchDB port when starting its server</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-524</link>

                    <description>make check fails. https tests are ok. Here are trace of tests :&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
* freebsd :&lt;br/&gt;
est/etap/070-couch-db....................&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/070-couch-db....................dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-4&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 4/4 tests, 0.00% okay&lt;br/&gt;
test/etap/080-config-get-set..............ok&lt;br/&gt;
test/etap/081-config-override.............ok&lt;br/&gt;
test/etap/082-config-register.............ok&lt;br/&gt;
test/etap/083-config-no-files.............ok&lt;br/&gt;
test/etap/090-task-status.................ok&lt;br/&gt;
test/etap/100-ref-counter.................ok&lt;br/&gt;
test/etap/110-replication-httpc...........&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/110-replication-httpc...........dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-6&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 6/6 tests, 0.00% okay&lt;br/&gt;
test/etap/111-replication-changes-feed....&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/111-replication-changes-feed....dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-13&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 13/13 tests, 0.00% okay&lt;br/&gt;
test/etap/112-replication-missing-revs....&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/112-replication-missing-revs....dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-12&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 12/12 tests, 0.00% okay&lt;br/&gt;
Failed Test                              Stat Wstat Total Fail  List of Failed&lt;br/&gt;
-------------------------------------------------------------------------------&lt;br/&gt;
test/etap/070-couch-db.t                    1   256     4    8  1-4&lt;br/&gt;
test/etap/110-replication-httpc.t           1   256     6   12  1-6&lt;br/&gt;
test/etap/111-replication-changes-feed.t    1   256    13   26  1-13&lt;br/&gt;
test/etap/112-replication-missing-revs.t    1   256    12   24  1-12&lt;br/&gt;
Failed 4/25 test scripts. 35/331 subtests failed.&lt;br/&gt;
Files=25, Tests=331, 20 wallclock secs (16.91 cusr +  2.88 csys = 19.79 CPU)&lt;br/&gt;
Failed 4/25 test programs. 35/331 subtests failed.&lt;br/&gt;
&lt;br/&gt;
* macosx&lt;br/&gt;
&lt;br/&gt;
test/etap/001-load........................ok&lt;br/&gt;
test/etap/010-file-basics.................ok&lt;br/&gt;
test/etap/011-file-headers................ok&lt;br/&gt;
test/etap/020-btree-basics................ok&lt;br/&gt;
test/etap/021-btree-reductions............ok&lt;br/&gt;
test/etap/030-doc-from-json...............ok&lt;br/&gt;
test/etap/031-doc-to-json.................ok&lt;br/&gt;
test/etap/040-util........................ok&lt;br/&gt;
test/etap/050-stream......................ok&lt;br/&gt;
test/etap/060-kt-merging..................ok&lt;br/&gt;
test/etap/061-kt-missing-leaves...........ok&lt;br/&gt;
test/etap/062-kt-remove-leaves............ok&lt;br/&gt;
test/etap/063-kt-get-leaves...............ok&lt;br/&gt;
test/etap/064-kt-counting.................ok&lt;br/&gt;
test/etap/065-kt-stemming.................ok&lt;br/&gt;
test/etap/070-couch-db....................&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/070-couch-db....................dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-4&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 4/4 tests, 0.00% okay&lt;br/&gt;
test/etap/080-config-get-set..............ok&lt;br/&gt;
test/etap/081-config-override.............ok&lt;br/&gt;
test/etap/082-config-register.............ok&lt;br/&gt;
test/etap/083-config-no-files.............ok&lt;br/&gt;
test/etap/090-task-status.................ok&lt;br/&gt;
test/etap/100-ref-counter.................ok&lt;br/&gt;
test/etap/110-replication-httpc...........&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/110-replication-httpc...........dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-6&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 6/6 tests, 0.00% okay&lt;br/&gt;
test/etap/111-replication-changes-feed....&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/111-replication-changes-feed....dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-13&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 13/13 tests, 0.00% okay&lt;br/&gt;
test/etap/112-replication-missing-revs....&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (killed)&lt;br/&gt;
test/etap/112-replication-missing-revs....dubious&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 1 (wstat 256, 0x100)&lt;br/&gt;
DIED. FAILED tests 1-12&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Failed 12/12 tests, 0.00% okay&lt;br/&gt;
Failed Test                              Stat Wstat Total Fail  List of Failed&lt;br/&gt;
-------------------------------------------------------------------------------&lt;br/&gt;
test/etap/070-couch-db.t                    1   256     4    8  1-4&lt;br/&gt;
test/etap/110-replication-httpc.t           1   256     6   12  1-6&lt;br/&gt;
test/etap/111-replication-changes-feed.t    1   256    13   26  1-13&lt;br/&gt;
test/etap/112-replication-missing-revs.t    1   256    12   24  1-12&lt;br/&gt;
Failed 4/25 test scripts. 35/331 subtests failed.&lt;br/&gt;
Files=25, Tests=331, 33 wallclock secs (11.73 cusr +  5.51 csys = 17.24 CPU)&lt;br/&gt;
Failed 4/25 test programs. 35/331 subtests failed.&lt;br/&gt;
make: *** [check] Error 1</description>
                <environment>&lt;br/&gt;
Erlang R13B02 (erts-5.7.3) [source] [64-bit] [smp:2:2] [rq:2]&lt;br/&gt;
[async-threads:0] [hipe] [kernel-poll:false]&lt;br/&gt;
&lt;br/&gt;
FreeBSD node0.couchdbhub.com 7.2-RELEASE-p2 FreeBSD 7.2-RELEASE-p2 #0:&lt;br/&gt;
Wed Jun 24 00:14:35 UTC 2009     &lt;a href=&apos;mailto:root@amd64-builder.da&apos;&gt;root@amd64-builder.da&lt;/a&gt;&lt;br/&gt;
emonology.net:/usr/obj/usr/src/sys/GENERIC  amd64&lt;br/&gt;
&lt;br/&gt;
Erlang R13B01 (erts-5.7.2) [source] [64-bit] [smp:2:2] [rq:2]&lt;br/&gt;
[async-threads:0] [kernel-poll:false]&lt;br/&gt;
&lt;br/&gt;
Darwin enlil-2.local 10.0.0 Darwin Kernel Version 10.0.0: Fri Jul 31&lt;br/&gt;
22:47:34 PDT 2009; root:xnu-1456.1.25~1/RELEASE_I386 i386</environment>
            <key id="12437699">COUCHDB-524</key>
        <summary>make check should not use the default CouchDB port when starting its server</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Fri, 9 Oct 2009 11:55:18 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 04:45:22 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12764039" author="benoitc" created="Fri, 9 Oct 2009 14:40:48 +0000 (UTC)"  >error is due to port conflict. I let it open since I think tests should be done on an available port not something fixed.</comment>
                    <comment id="12772849" author="paul.joseph.davis" created="Tue, 3 Nov 2009 02:49:37 +0000 (UTC)"  >Me and benoit chatted briefly about this the other night in IRC. Are there any examples of projects that write a .port file similar to a .pid file when booting? Ie, something like $PREFIX/var/run/couchdb/couchdb.port or .host that lists where its listening?&lt;br/&gt;
&lt;br/&gt;
Adding that and a helper function in utils could solve this pretty easily.</comment>
                    <comment id="12772876" author="benoitc" created="Tue, 3 Nov 2009 04:45:22 +0000 (UTC)"  >Here is a patch that return current port on whitch couchdb is listening. So for example, starting couchdb with command :&lt;br/&gt;
&lt;br/&gt;
env ERL_FLAGS=&amp;quot;-name &lt;a href=&apos;mailto:couchdb@enlil.local&apos;&gt;couchdb@enlil.local&lt;/a&gt;&amp;quot; ./utils/run -b&lt;br/&gt;
&lt;br/&gt;
allow us to get port from shell with this other command:&lt;br/&gt;
&lt;br/&gt;
erl -noshell -name &lt;a href=&apos;mailto:test@enlil.local&apos;&gt;test@enlil.local&lt;/a&gt; -pa src/couchdb -pa src/mochiweb -pa src/ibrowse -pa src/erlang-oauth -eval &amp;quot;error_logger:tty(false), io:format(\&amp;quot;~p~n\&amp;quot;,[rpc:call(&lt;a href=&apos;mailto:couchdb@enlil.local&apos;&gt;couchdb@enlil.local&lt;/a&gt;, couch_server, get_port, [])])&amp;quot; -run init stop&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12423890" name="couchdb-src_couch_server.erl.patch" size="922" author="benoitc" created="Tue, 3 Nov 2009 04:45:22 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Nov 2009 02:49:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-523] View API POST keys to retrieve multiple docs by key could also allow for multiple &apos;range&apos; queries, i.e. an array of { startkey: .., endkey: ... } params in the POST</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-523</link>

                    <description>It would be useful if I could do a single POST to a view to retrieve multiple ranges specified by startkey, endkey.&lt;br/&gt;
&lt;br/&gt;
The format could be as follows:&lt;br/&gt;
&lt;br/&gt;
{ &amp;quot;ranges&amp;quot;: [ { &amp;quot;startkey&amp;quot;: &amp;quot;a&amp;quot;, &amp;quot;endkey&amp;quot;: &amp;quot;c&amp;quot; }, { &amp;quot;startkey&amp;quot;:&amp;quot;g&amp;quot;, &amp;quot;endkey&amp;quot;:&amp;quot;z&amp;quot; } ] }&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12437621">COUCHDB-523</key>
        <summary>View API POST keys to retrieve multiple docs by key could also allow for multiple &apos;range&apos; queries, i.e. an array of { startkey: .., endkey: ... } params in the POST</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nrstott">Nathan Stott</reporter>
            
    <created>Thu, 8 Oct 2009 17:09:00 +0000 (UTC)</created>
    <updated>Thu, 8 Oct 2009 17:09:00 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-522] supplying a bad TokenSecret causes a 500 error response</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-522</link>

                    <description>It seems that if a user tries to authenticate with OAuth using a token secret that CouchDB doesn&apos;t know about, the result will be an Internal Server Error and a traceback that looks like&lt;br/&gt;
&lt;br/&gt;
[Thu, 08 Oct 2009 14:44:19 GMT] [info] [&amp;lt;0.1103.24&amp;gt;] Stacktrace: [{oauth_uri,encode,[undefined,[]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{oauth_uri,&apos;-calate/2-lc$^0/1-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{oauth_uri,&apos;-calate/2-lc$^0/1-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{oauth_uri,calate,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{oauth_hmac_sha1,signature,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{oauth_hmac_sha1,verify,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_oauth,&apos;-oauth_authentication_handler/1-fun-0-&apos;,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,authenticate_request,2}]&lt;br/&gt;
&lt;br/&gt;
I think we could fix this by replacing&lt;br/&gt;
&lt;br/&gt;
TokenSecret = couch_config:get(&amp;quot;oauth_token_secrets&amp;quot;, AccessToken),&lt;br/&gt;
&lt;br/&gt;
with &lt;br/&gt;
&lt;br/&gt;
TokenSecret = couch_config:get(&amp;quot;oauth_token_secrets&amp;quot;, AccessToken, &amp;quot;&amp;quot;),&lt;br/&gt;
&lt;br/&gt;
or some other more appropriate default string.</description>
                <environment></environment>
            <key id="12437615">COUCHDB-522</key>
        <summary>supplying a bad TokenSecret causes a 500 error response</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jasondd">Jason Davies</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Thu, 8 Oct 2009 16:48:53 +0000 (UTC)</created>
    <updated>Mon, 12 Oct 2009 10:28:53 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12764642" author="jasondd" created="Mon, 12 Oct 2009 10:28:53 +0000 (UTC)"  >Fixed in r824290.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 12 Oct 2009 10:28:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 12 Oct 2009 10:28:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-521] negotiate_content_type does not detect application/json in HTTP Accept header if it includes a qvakue</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-521</link>

                    <description>If I request a document from CouchDB with an Accept header like this:&lt;br/&gt;
&lt;br/&gt;
Accept: application/json&lt;br/&gt;
Accept: text/html,application/xhtml+xml,application/json,application/xml;q=0.9,*/*;q=0.8&lt;br/&gt;
&lt;br/&gt;
CouchDB will serve back the response with the &amp;quot;application/json&amp;quot; content type.&lt;br/&gt;
&lt;br/&gt;
However, if my Accept header looks like:&lt;br/&gt;
Accept: text/html,application/xhtml+xml,application/json;q=0.9,application/xml;q=0.9,*/*;q=0.8&lt;br/&gt;
&lt;br/&gt;
CouchDB responds with text/plain.&lt;br/&gt;
&lt;br/&gt;
This seems to be because in src/couchdb/couch_httpd.erl, in negotiate_content_type, the Accept header is split on &amp;quot;,&amp;quot; and then searched for &amp;quot;application/json&amp;quot;. It should really discard anything after &amp;quot;;&amp;quot; when searching.</description>
                <environment></environment>
            <key id="12437568">COUCHDB-521</key>
        <summary>negotiate_content_type does not detect application/json in HTTP Accept header if it includes a qvakue</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="bhollis">Ben Hollis</reporter>
            
    <created>Thu, 8 Oct 2009 04:31:42 +0000 (UTC)</created>
    <updated>Thu, 8 Oct 2009 14:03:19 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12763354" author="bhollis" created="Thu, 8 Oct 2009 04:32:51 +0000 (UTC)"  >The patch from &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-234&quot; title=&quot;[PATCH] Improved Accept/Content-Type negotiation&quot;&gt;COUCHDB-234&lt;/a&gt; would fix this (actually, even just line 31 of that patch would fix it).</comment>
                    <comment id="12763499" author="kocolosk" created="Thu, 8 Oct 2009 14:03:19 +0000 (UTC)"  >Should we be ignoring the q value?  What if a user sends&lt;br/&gt;
&lt;br/&gt;
Accept: application/json; q=0, text/plain&lt;br/&gt;
&lt;br/&gt;
Admittedly, we need to do something to fix the current behavior.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10032">
            <name>Blocker</name>
                            <outwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12413936">COUCHDB-234</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 8 Oct 2009 14:03:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-520] Make view indexing commit checkpoints more often</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-520</link>

                    <description>Add commit headers to indexes when they are huge. This will make indexing huge databases from scratch suck less.</description>
                <environment></environment>
            <key id="12437451">COUCHDB-520</key>
        <summary>Make view indexing commit checkpoints more often</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Wed, 7 Oct 2009 01:48:05 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 21:14:26 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12763076" author="kocolosk" created="Wed, 7 Oct 2009 14:44:08 +0000 (UTC)"  >Can you say more about this, Paul?  We&apos;re already doing checkpoints every time we flush the view results to disk.  What sucks about indexing huge databases from scratch?</comment>
                    <comment id="12763186" author="paul.joseph.davis" created="Wed, 7 Oct 2009 18:46:57 +0000 (UTC)"  >Huh. I read through this code again this morning and you&apos;re right. I completely missed that partial_update was doing a send back for delayed_commit.&lt;br/&gt;
&lt;br/&gt;
The weird error with timeouts on trying to read a header from these index files worries me though. If Glenn&apos;s indexing fails again I&apos;ll try seek through that file to figure out what&apos;s going on.</comment>
                    <comment id="12763193" author="kocolosk" created="Wed, 7 Oct 2009 19:00:26 +0000 (UTC)"  >Good idea.  Now I really wish I had saved my .view file when it happened to me, but it was ~10 GB and built using a funky branch of couch so I didn&apos;t.</comment>
                    <comment id="12763206" author="paul.joseph.davis" created="Wed, 7 Oct 2009 19:26:17 +0000 (UTC)"  >I&apos;ll try and reproduce later by &apos;kill -KILL&apos;ing CouchDB durring an initial view write to see what happens. If my theory is right, I&apos;ll either get a no header error, or a header with 0 updates if we write one at the top of the file.</comment>
                    <comment id="12763235" author="kocolosk" created="Wed, 7 Oct 2009 20:04:43 +0000 (UTC)"  >I tried playing those games, but Couch is pretty resilient.  Every time it pops back up with a valid header.</comment>
                    <comment id="12772697" author="kocolosk" created="Mon, 2 Nov 2009 21:14:26 +0000 (UTC)"  >Paul found and fixed a regression on the view index checkpoints in r824968</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 21:14:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Oct 2009 14:44:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-519] Continous Integration links on website</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-519</link>

                    <description>Add links to the buildbot CI to the website.&lt;br/&gt;
&lt;br/&gt;
Links of interest:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/waterfall?show_events=false&amp;branch=&amp;builder=couchdb-trunk&amp;builder=couchdb-coverage&amp;reload=60&quot;&gt;http://ci.apache.org/waterfall?show_events=false&amp;amp;branch=&amp;amp;builder=couchdb-trunk&amp;amp;builder=couchdb-coverage&amp;amp;reload=60&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/waterfall/help&quot;&gt;http://ci.apache.org/waterfall/help&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/projects/couchdb/cover/index.html&quot;&gt;http://ci.apache.org/projects/couchdb/cover/index.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12437340">COUCHDB-519</key>
        <summary>Continous Integration links on website</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 6 Oct 2009 03:08:56 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:29:14 +0000 (UTC)</updated>

                
                
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12762490" author="paul.joseph.davis" created="Tue, 6 Oct 2009 03:13:33 +0000 (UTC)"  >Couple more for good measure:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/projects/&quot;&gt;http://ci.apache.org/projects/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/buildbot.html&quot;&gt;http://ci.apache.org/buildbot.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/&quot;&gt;http://ci.apache.org/&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-518] Startupscript fails im there are *.ini files in the current directory</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-518</link>

                    <description>Line 123 of /usr/local/bin/couchdb  reads:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for file in `find &amp;quot;$1&amp;quot; -mindepth 1 -maxdepth 1 -type f -name *.ini`; do&lt;br/&gt;
&lt;br/&gt;
&amp;quot;*.ini&amp;quot; will get expanded to filenames if there in a *.ini file in the current directory.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for file in `find &amp;quot;$1&amp;quot; -mindepth 1 -maxdepth 1 -type f -name &apos;*.ini&apos;`; do&lt;br/&gt;
&lt;br/&gt;
(note the quouting) works regardless of the current directory.</description>
                <environment>r821494, FreeBSD</environment>
            <key id="12437230">COUCHDB-518</key>
        <summary>Startupscript fails im there are *.ini files in the current directory</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Sun, 4 Oct 2009 11:49:27 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:41:12 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12762023" author="janl" created="Sun, 4 Oct 2009 12:42:28 +0000 (UTC)"  >Fixed in r821534.</comment>
                    <comment id="12772844" author="kocolosk" created="Tue, 3 Nov 2009 02:41:12 +0000 (UTC)"  >Strange ... this issue shows up as &amp;quot;open&amp;quot; when browsing but &amp;quot;resolved&amp;quot; on the issue page itself.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 4 Oct 2009 12:42:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 4 Oct 2009 12:42:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-517] changing uuid algorithm causes client errors</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-517</link>

                    <description>When changing the uuid configuration (by PUT to _config/uuids/algorithm), a client attempting an operation at the same time experiences a transitory connection refused problem.&lt;br/&gt;
&lt;br/&gt;
Attached is a patch that changes couch_uuid.erl so that it changes its internal state when the configuration changes rather than the current behavior of stopping and then being restarted by the supervisor.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12437189">COUCHDB-517</key>
        <summary>changing uuid algorithm causes client errors</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Sat, 3 Oct 2009 14:30:29 +0000 (UTC)</created>
    <updated>Sat, 3 Oct 2009 19:53:39 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12761891" author="rnewson" created="Sat, 3 Oct 2009 14:31:43 +0000 (UTC)"  >&lt;br/&gt;
Change uuid algorithm without restarting the couch_uuids gen_server process.&lt;br/&gt;
</comment>
                    <comment id="12761906" author="damienkatz" created="Sat, 3 Oct 2009 16:24:47 +0000 (UTC)"  >I&apos;ve reviewed the patch and it looks good. I&apos;d commit it myself but I&apos;m not sure of the patch flags I need for this diff.</comment>
                    <comment id="12761932" author="rnewson" created="Sat, 3 Oct 2009 18:01:58 +0000 (UTC)"  >&lt;br/&gt;
Formatted by &apos;git format-patch trunk&apos; from a local branch with my fix applied, hopefully easier to apply.&lt;br/&gt;
</comment>
                    <comment id="12761948" author="paul.joseph.davis" created="Sat, 3 Oct 2009 19:53:39 +0000 (UTC)"  >Applied in r821402.</comment>
                </comments>
    
    <attachments>
            <attachment id="12421208" name="0001-fix-couchdb-517.patch" size="1961" author="rnewson" created="Sat, 3 Oct 2009 18:01:58 +0000 (UTC)" />
            <attachment id="12421201" name="couchdb-517.patch" size="1637" author="rnewson" created="Sat, 3 Oct 2009 14:31:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 3 Oct 2009 19:53:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 3 Oct 2009 16:24:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-516] Replication: _replicate does not finish replication in one pass and has to be invoked repeatedly</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-516</link>

                    <description>When we replicate between a remote database and a local one (pulling from remote into local), we are observing partial replications, meaning that we have to issue repeated _replicate calls for the replication to complete. For a database with 17,000 documents, for example, it could take up to 7 calls for the entire database to replicate into an empty one. Each time, the number of documents replicated over seemed random.&lt;br/&gt;
&lt;br/&gt;
The use case is very simple--replicating a database into an empty one with no concurrent writes, no additional load or i/o, etc. The databases involved are a mixture of the 10.0.x code base natively built on Ubuntu and Mac.&lt;br/&gt;
&lt;br/&gt;
It seems to me that every (not all) partial replication process is associated with a corresponding entry in the log that says &amp;quot;recording a checkpoint at source update_seq .....&amp;quot;. (i.e. you can match the recorded_seq number in the replication response with the checkpoint update_seq numbers in the log).&lt;br/&gt;
&lt;br/&gt;
Futon vs. curl doesn&apos;t make a difference.</description>
                <environment>Mac OS X 10.5 w/ CouchDB 0.10.x multiple revisions (latest is 820436)&lt;br/&gt;
Ubuntu Desktop 9.04 w/ CouchDB 0.10.x multiple revisions (latest is 818247)</environment>
            <key id="12437038">COUCHDB-516</key>
        <summary>Replication: _replicate does not finish replication in one pass and has to be invoked repeatedly</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="ningtan">Ning Tan</reporter>
            
    <created>Thu, 1 Oct 2009 16:34:52 +0000 (UTC)</created>
    <updated>Fri, 2 Oct 2009 16:34:23 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12761260" author="ningtan" created="Thu, 1 Oct 2009 16:37:43 +0000 (UTC)"  >Replication records and corresponding server logs.</comment>
                    <comment id="12761268" author="emgee" created="Thu, 1 Oct 2009 16:55:31 +0000 (UTC)"  >Also seen replicating between two Ubuntu machines (one Jaunty, one Karmic) both running exactly the same version of CouchDB (git 9dfbf2ca3a9028262dff8e21637e41108701e9c3 from the 0.10.x branch, 820498 from svn 0.10.x branch). Both machines on same network with no proxy, firewall, etc in between. Replication was not continuous.&lt;br/&gt;
&lt;br/&gt;
In my case the replication process did not end and I had to restart the CouchDB server to continue.</comment>
                    <comment id="12761428" author="kocolosk" created="Fri, 2 Oct 2009 00:32:16 +0000 (UTC)"  >Hi Ning, Matt, this should be fixed now (in trunk and 0.10.x).  Can you confirm?</comment>
                    <comment id="12761514" author="emgee" created="Fri, 2 Oct 2009 09:28:42 +0000 (UTC)"  >For reference, the problem did not occur for me when using continuous replication.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve upgraded both machines to svn r 820852 and can confirm replication now runs to completion for non-continuous and continuous replication.&lt;br/&gt;
&lt;br/&gt;
Thanks Adam.&lt;br/&gt;
</comment>
                    <comment id="12761636" author="kocolosk" created="Fri, 2 Oct 2009 16:34:23 +0000 (UTC)"  >Ning Tan replied on dev@ that the bug is resolved, so we can close this out.</comment>
                </comments>
    
    <attachments>
            <attachment id="12421034" name="replication.txt" size="4937" author="ningtan" created="Thu, 1 Oct 2009 16:37:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 2 Oct 2009 00:32:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 1 Oct 2009 16:55:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-515]  040-util fail on freebsd 7.2 </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-515</link>

                    <description>make check block on 040-util step 4 however http tests works and it don&apos;t seem to affect work on it (like friendpaste). prove -v display nothing more, the tests just block on it and I had to kill it (ctrl-c).&lt;br/&gt;
&lt;br/&gt;
uname -a : &lt;br/&gt;
FreeBSD node0.somedomain.com 7.2-RELEASE-p2 FreeBSD 7.2-RELEASE-p2 #0: Wed Jun 24 00:14:35 UTC 2009     &lt;a href=&apos;mailto:root@amd64-builder.daemonology.net&apos;&gt;root@amd64-builder.daemonology.net&lt;/a&gt;:/usr/obj/usr/src/sys/GENERIC  amd64&lt;br/&gt;
&lt;br/&gt;
erlang :&lt;br/&gt;
Erlang R13B02 (erts-5.7.3) [source] [64-bit] [smp:2:2] [rq:2] [async-threads:0] [hipe] [kernel-poll:false]&lt;br/&gt;
</description>
                <environment>freebsd 7.2, erlang R13B02, </environment>
            <key id="12436902">COUCHDB-515</key>
        <summary> 040-util fail on freebsd 7.2 </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Wed, 30 Sep 2009 09:20:04 +0000 (UTC)</created>
    <updated>Wed, 30 Sep 2009 16:08:09 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12760943" author="paul.joseph.davis" created="Wed, 30 Sep 2009 16:08:09 +0000 (UTC)"  >I fixed this as part of the work on getting buildbot up and running and didn&apos;t think to backport it. Its a bug in the test not what&apos;s being tested so it doesn&apos;t concern me too much. Though it does point at interestingness of Erlang scheduling being different in different scenarios. It wasn&apos;t even noticed until trying to run the tests in coverage mode on an Ubuntu VM.&lt;br/&gt;
&lt;br/&gt;
Here&apos;s the diff:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/couchdb/trunk/test/etap/040-util.t?r1=819263&amp;r2=819341&quot;&gt;http://svn.apache.org/viewvc/couchdb/trunk/test/etap/040-util.t?r1=819263&amp;amp;r2=819341&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
There was an odd race condition when the terminate_linked call executed before the linked process started. This patch just adds a receive for a message from the new PID before executing terminate_linked.&lt;br/&gt;
&lt;br/&gt;
There&apos;s also another patch that updates the plan count to 11, so this will still break prove (because it runs one more test than expected).</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 30 Sep 2009 16:08:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 30 Sep 2009 16:08:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-514] Redirect from _list using view rows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-514</link>

                    <description>There is no way to redirect from a _list function after calling the getRow() API function.&lt;br/&gt;
&lt;br/&gt;
Here&apos;s a link to the discussion on the dev mailing list:&lt;br/&gt;
&lt;a href=&quot;http://is.gd/3KZRg&quot;&gt;http://is.gd/3KZRg&lt;/a&gt;&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12436771">COUCHDB-514</key>
        <summary>Redirect from _list using view rows</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="zdzolton">Zachary Zolton</reporter>
            
    <created>Mon, 28 Sep 2009 18:20:16 +0000 (UTC)</created>
    <updated>Tue, 26 Jan 2010 07:04:20 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12760367" author="zdzolton" created="Mon, 28 Sep 2009 20:13:32 +0000 (UTC)"  >This patch (from a reasonably current HEAD on github) shows how I was attempting to get the JavaScript view server to defer sending the headers until after the first time send() is called.&lt;br/&gt;
&lt;br/&gt;
Unfortunately, this code doesn&apos;t work, but I&apos;m attaching it here to encourage some dialog... :^D</comment>
                    <comment id="12776457" author="yssk22" created="Wed, 11 Nov 2009 13:51:49 +0000 (UTC)"  >I&apos;m troubled with the similar problem to this issue. &lt;br/&gt;
&lt;br/&gt;
I attached a patch(for svn:rev834436) for adding javascript test case(share/www/test/list_views.js). &lt;br/&gt;
This test case would be passed when Erlang side is fixed.&lt;br/&gt;
</comment>
                    <comment id="12776596" author="paul.joseph.davis" created="Wed, 11 Nov 2009 19:27:01 +0000 (UTC)"  >Hmm, Zachary looks like he&apos;s going in the right direction with his patch. I&apos;ll try and get to this tonight or tomorrow to see if we can get something worked out.&lt;br/&gt;
&lt;br/&gt;
Yohei, thanks for the failing test case. That should be most useful in fixing this.</comment>
                    <comment id="12776802" author="paul.joseph.davis" created="Thu, 12 Nov 2009 02:38:00 +0000 (UTC)"  >Ohhhh.&lt;br/&gt;
&lt;br/&gt;
The reason that Zachary&apos;s patch won&apos;t work is that the Erlang side is waiting for the start before sending the first row. The &amp;quot;getRow()&amp;quot; style API in JavaScript is still bound by the serialized enforcement that the Erlang side does. Sadly that means the patch is more involved than I had initially thought.&lt;br/&gt;
&lt;br/&gt;
For interested parties, the fix for this is in reworking how couch_httpd_show.erl uses the btree fold function. Basically, in couch_httpd_show:start_list_resp/5 the proper thing would be to just send the head info and defer the response building till later in the iteration process when render_list_row is called.</comment>
                    <comment id="12804730" author="joscha" created="Mon, 25 Jan 2010 21:30:00 +0000 (UTC)"  >Added render.diff which enables the list render function to disable/enable automatic flushing and fixes the problem with start() being sent automatically when getRow() gets called. Needs readline() to be fixed first to also return if there is no header sent, yet.</comment>
                    <comment id="12804920" author="jchris" created="Tue, 26 Jan 2010 07:04:09 +0000 (UTC)"  >Joscha,&lt;br/&gt;
&lt;br/&gt;
If you can provide just the bug fix (not _stylistic changes) I&apos;ll be glad to help you finish it.&lt;br/&gt;
&lt;br/&gt;
I do think this will require an Erlang fix. I won&apos;t let it slip past 1.0 but I don&apos;t have time to write it before 0.11&lt;br/&gt;
&lt;br/&gt;
Chris&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12420726" name="list-redir.diff" size="3181" author="zdzolton" created="Mon, 28 Sep 2009 20:13:32 +0000 (UTC)" />
            <attachment id="12424604" name="list_views.diff" size="1375" author="yssk22" created="Wed, 11 Nov 2009 13:51:49 +0000 (UTC)" />
            <attachment id="12431361" name="render.diff" size="10060" author="joscha" created="Mon, 25 Jan 2010 21:29:59 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Nov 2009 13:51:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-513] Unable to redirect from _list function</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-513</link>

                    <description>Define this _list function:&lt;br/&gt;
&lt;br/&gt;
function(head, req) {&lt;br/&gt;
&amp;nbsp;return {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;code&apos;: 301,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;headers&apos;: { &apos;Location&apos;: &apos;&lt;a href=&quot;http://www.google.com/&quot;&gt;http://www.google.com/&lt;/a&gt;&apos; }&lt;br/&gt;
&amp;nbsp;};&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
Try to curl it:&lt;br/&gt;
&lt;br/&gt;
$ curl -i &apos;&lt;a href=&quot;http://localhost:5984/db/_design/ddoc/_list/test-redirect/some-view?key=%22foo%22&quot;&gt;http://localhost:5984/db/_design/ddoc/_list/test-redirect/some-view?key=%22foo%22&lt;/a&gt;&apos;&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
Vary: Accept&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: CouchDB/0.11.0a9fd42dc1-git (Erlang OTP/R12B)&lt;br/&gt;
Etag: &amp;quot;46014W5JDRLKZF5SECP2D44YH&amp;quot;&lt;br/&gt;
Date: Thu, 24 Sep 2009 22:23:14 GMT&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
&lt;br/&gt;
curl: (56) Received problem 2 in the chunky parser&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Here is Jan&apos;s take on the user mailing list:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-user/200909.mbox/%3c6678E46D-A113-4052-9F44-E061582D2799@apache.org%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-user/200909.mbox/%3c6678E46D-A113-4052-9F44-E061582D2799@apache.org%3e&lt;/a&gt;</description>
                <environment>Mac OS X 10.5.8, Erlang OTP/R12B, CouchDB/0.11.0a9fd42dc1</environment>
            <key id="12436608">COUCHDB-513</key>
        <summary>Unable to redirect from _list function</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="zdzolton">Zachary Zolton</reporter>
            
    <created>Fri, 25 Sep 2009 15:10:59 +0000 (UTC)</created>
    <updated>Fri, 25 Sep 2009 15:13:46 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12759565" author="jasondd" created="Fri, 25 Sep 2009 15:13:46 +0000 (UTC)"  >To send headers you need to use the start() function for _list, e.g.&lt;br/&gt;
&lt;br/&gt;
function(head, req) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;start({code:301, headers:  { &apos;Location&apos;: &apos;&lt;a href=&quot;http://www.google.com/&quot;&gt;http://www.google.com/&lt;/a&gt;&apos; }});&lt;br/&gt;
}</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 25 Sep 2009 15:13:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 25 Sep 2009 15:13:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-512] Per-DB Authorization and ACL</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-512</link>

                    <description>Following discussions on the mailing list, this is for tracking work and comments surrounding an implementation of per-db authorization and ACL.</description>
                <environment></environment>
            <key id="12436465">COUCHDB-512</key>
        <summary>Per-DB Authorization and ACL</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jasondd">Jason Davies</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Wed, 23 Sep 2009 22:22:59 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 23:07:15 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12758900" author="jasondd" created="Wed, 23 Sep 2009 22:26:12 +0000 (UTC)"  >Initial patch adding per-db auth using an ACL rule list defined in the &amp;quot;_local/_acl&amp;quot; in the users db (&amp;quot;users&amp;quot; by default).  We can look at extending this and allow a similar document to exist per database too in the future.  The ACL document looks like:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;_id&amp;quot;: &amp;quot;_local/_acl&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;rules&amp;quot;: [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;db&amp;quot;: &amp;quot;*&amp;quot;, &amp;quot;role&amp;quot;: &amp;quot;*&amp;quot;, &amp;quot;deny&amp;quot;: &amp;quot;*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;db&amp;quot;: &amp;quot;*&amp;quot;, &amp;quot;role&amp;quot;: &amp;quot;test&amp;quot;, &amp;quot;allow&amp;quot;: &amp;quot;read&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
The last matching rule wins.</comment>
                    <comment id="12759035" author="benoitc" created="Thu, 24 Sep 2009 06:17:50 +0000 (UTC)"  >So you set acls in a global user db ? Wouldn&apos;t it be better if acl were set in the db rather than an external db ? So acls + users are replicated ?</comment>
                    <comment id="12759080" author="janl" created="Thu, 24 Sep 2009 10:02:18 +0000 (UTC)"  >I believe replicatable ACLs are useful, but not generally. I think we can punt on this for this first iteration that helps us to get more familiar with the code required for that matter. I don&apos;t see a reason to not have per db _acls in the future (unless there are technical issues preventing that :)</comment>
                    <comment id="12759093" author="kocolosk" created="Thu, 24 Sep 2009 11:49:29 +0000 (UTC)"  >Hi Jason, I think &amp;quot;first matching rule wins&amp;quot; is more common, e.g. in firewall rulesets.  Any reason why you chose to go with last match? </comment>
                    <comment id="12759096" author="jasondd" created="Thu, 24 Sep 2009 11:57:12 +0000 (UTC)"  >Hi Adam, it seems I was mistakenly under the impression firewall rules work in the &amp;quot;last match&amp;quot; fashion, I think I will update the patch, thanks :-)</comment>
                    <comment id="12759098" author="benoitc" created="Thu, 24 Sep 2009 12:06:54 +0000 (UTC)"  >@janl i&apos;m agree, was just asking. Even if I think having auth per db in one db sound more natural : since you replicate per db not having auth replicated with it, is weird.&lt;br/&gt;
&lt;br/&gt;
Per db we could have an _acl doc + _user/id docs containing users, _users and _acl could be only changed by the owner of the db.&lt;br/&gt;
&lt;br/&gt;
Speaking about replication maybe the right to replicate was forgotten ? Maybe someone could read, write but not replicate and vice-versa ?&lt;br/&gt;
&lt;br/&gt;
Thinking about db matching I wonder why not puting acls in different docs and having a view matching dbs ? Since matching is already handled by couchdb. It won&apos;t match * though or maybe there could be a special match for that ? At least for auths per db in one generic db. Also thinking about that what if the number of db is big ? having acl per db splitted in differents docs may help.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12759099" author="jasondd" created="Thu, 24 Sep 2009 12:08:25 +0000 (UTC)"  >Benoit, I think we will definitely add per-db ACLs in the future, it shouldn&apos;t be hard to do.  As for replicating ACLs I think that should probably be off by default as it could cause complications, but it would be needed for a cluster configuration so we would need to support it at some point.</comment>
                    <comment id="12759274" author="jasondd" created="Thu, 24 Sep 2009 21:33:44 +0000 (UTC)"  >Fix for error when ACL doc is missing.</comment>
                    <comment id="12772669" author="kocolosk" created="Mon, 2 Nov 2009 20:39:58 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12828323" author="jchris" created="Mon, 1 Feb 2010 23:07:15 +0000 (UTC)"  >I just committed a similar feature (with a different implementation). Closing this as fixed.</comment>
                </comments>
    
    <attachments>
            <attachment id="12420495" name="per_db_auth.1.patch" size="8219" author="jasondd" created="Thu, 24 Sep 2009 21:33:44 +0000 (UTC)" />
            <attachment id="12420411" name="per_db_auth.patch" size="8058" author="jasondd" created="Wed, 23 Sep 2009 22:26:12 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 23:07:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 24 Sep 2009 06:17:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-511] Revision referencing via something like Git&apos;s RefLog Shortnames</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-511</link>

                    <description>Accessing earlier revisions isn&apos;t hard, but it would be very handy to reference them via a short hand notation similar to Git&apos;s RefLog Shortnames. Perhaps something very similar:&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/db/doc?rev=&quot;&gt;http://localhost:5984/db/doc?rev=&lt;/a&gt;^&lt;br/&gt;
&amp;nbsp;- this would get the previous revision&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/db/doc?rev=&quot;&gt;http://localhost:5984/db/doc?rev=&lt;/a&gt;^3&lt;br/&gt;
&amp;nbsp;- this would get the revision 3 submissions ago&lt;br/&gt;
&lt;br/&gt;
Just an idea.</description>
                <environment></environment>
            <key id="12436456">COUCHDB-511</key>
        <summary>Revision referencing via something like Git&apos;s RefLog Shortnames</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="bigbluehat">Benjamin Young</reporter>
            
    <created>Wed, 23 Sep 2009 21:06:48 +0000 (UTC)</created>
    <updated>Thu, 24 Sep 2009 10:05:55 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12759082" author="janl" created="Thu, 24 Sep 2009 10:05:55 +0000 (UTC)"  >Retrieving old revs is a feature that is for internal use only (e.g. the replicator uses it). Applications should not use it. Improving usability will send the wrong message :) This might change when we get to support for persistent history, but we have a ticket for that already.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 24 Sep 2009 10:05:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 24 Sep 2009 10:05:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-510] build windows installer as part of &apos;make dist&apos; on windows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-510</link>

                    <description>Attaching a patch which creates an installer using &apos;inno&apos; when &apos; make dist&apos; is run on windows.  Uploading in the hope of getting a quick review from nslater.</description>
                <environment></environment>
            <key id="12436412">COUCHDB-510</key>
        <summary>build windows installer as part of &apos;make dist&apos; on windows</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="mhammond">Mark Hammond</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Wed, 23 Sep 2009 13:02:07 +0000 (UTC)</created>
    <updated>Sat, 17 Oct 2009 03:31:34 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12766827" author="mhammond" created="Sat, 17 Oct 2009 03:31:34 +0000 (UTC)"  >r826173.</comment>
                </comments>
    
    <attachments>
            <attachment id="12420371" name="win_installer.patch" size="10649" author="mhammond" created="Wed, 23 Sep 2009 13:02:40 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 17 Oct 2009 03:31:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-509] RFE: make futon show view execution timings</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-509</link>

                    <description>Please add view execution/generation time in the Futon web interface. Something like:&lt;br/&gt;
... results ...&lt;br/&gt;
&lt;br/&gt;
page generated in 1.234 ms&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12436293">COUCHDB-509</key>
        <summary>RFE: make futon show view execution timings</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="atodorov">Alexander Todorov</reporter>
            
    <created>Tue, 22 Sep 2009 11:22:59 +0000 (UTC)</created>
    <updated>Sun, 8 Nov 2009 13:47:23 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12774777" author="fdmanana" created="Sun, 8 Nov 2009 13:47:23 +0000 (UTC)"  >This patch adds a little message under the results table with the following format:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;View had a request duration of 00:00:02.141&amp;quot;</comment>
                </comments>
    
    <attachments>
            <attachment id="12424306" name="jira-couchdb-509-patch-for-trunk.patch" size="4147" author="fdmanana" created="Sun, 8 Nov 2009 13:47:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 8 Nov 2009 13:47:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-508] handle deleted db event for db</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-508</link>

                    <description>Currently when a db is deleted and someone is listenning on _changes feed (continuous or longpoll), couchdb don&apos;t close the connection (sending last chunk) and instead send an error status. This patch fix this and ad db_deleted:true  on the last line. Spotted by kocolosk on irc.</description>
                <environment></environment>
            <key id="12436237">COUCHDB-508</key>
        <summary>handle deleted db event for db</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 21 Sep 2009 18:50:55 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</updated>

                        <version>0.10</version>
                    <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772657" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
            <attachment id="12420210" name="fix_changes.patch" size="4529" author="benoitc" created="Mon, 21 Sep 2009 18:51:10 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-507] 	add modified time to db header</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-507</link>

                    <description>Patch that add modified date to teh db header in view of geeting last time a db was updated which would allow in case of a global db handler to get all changes since this date, or just get all new dbs created. Patch is attached and could be found in my repo :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://bitbucket.org/benoitc/couchdb/src/9733d08fc7b0/&quot;&gt;http://bitbucket.org/benoitc/couchdb/src/9733d08fc7b0/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
It works and I can get db infos :&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;db_name&amp;quot;:&amp;quot;testdb&amp;quot;,&amp;quot;doc_count&amp;quot;:0,&amp;quot;doc_del_count&amp;quot;:1,&amp;quot;update_seq&amp;quot;:3,&amp;quot;modified&amp;quot;:&amp;quot;1253540241479553&amp;quot;,&amp;quot;purge_seq&amp;quot;:0,&amp;quot;compact_running&amp;quot;:false,&amp;quot;disk_size&amp;quot;:12398,&amp;quot;instance_start_time&amp;quot;:&amp;quot;1253540874651249&amp;quot;,&amp;quot;disk_format_version&amp;quot;:5}&lt;br/&gt;
&lt;br/&gt;
Main problem actually is that it doesn&apos;t handle old dbs since header should be upgraded. I&apos;ve read the code in couch_file but fail for now to understand the logic to read/rewrite header. I think I should first test if header is on version &amp;lt; 0.9 then 0.10 but... Any help would be appreciated.</description>
                <environment></environment>
            <key id="12436206">COUCHDB-507</key>
        <summary>	add modified time to db header</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 21 Sep 2009 15:41:45 +0000 (UTC)</created>
    <updated>Mon, 21 Sep 2009 15:42:00 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
            <attachment id="12420201" name="modified.patch" size="6907" author="benoitc" created="Mon, 21 Sep 2009 15:42:00 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-506] error when source is down with continuous replication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-506</link>

                    <description>When source of continuous replication hangs or is down  I get this error in lofs :&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.46.0&amp;gt;] {error_report,&amp;lt;0.21.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.46.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_rep_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,shutdown_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,{error,connection_closed}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.100.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;1b64e359f0f62e0921c6569e13907689+continuous&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,start_link,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_rep,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;1b64e359f0f62e0921c6569e13907689&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[{&amp;lt;&amp;lt;&amp;quot;source&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://192.168.1.3:5984/db0&quot;&gt;http://192.168.1.3:5984/db0&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;continuous&amp;quot;&amp;gt;&amp;gt;,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;target&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;db0&amp;quot;&amp;gt;&amp;gt;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
Seem like couchdb continue to work but imo this should be an expected error. </description>
                <environment></environment>
            <key id="12436155">COUCHDB-506</key>
        <summary>error when source is down with continuous replication</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sun, 20 Sep 2009 13:31:47 +0000 (UTC)</created>
    <updated>Mon, 21 Sep 2009 20:50:15 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12757822" author="benoitc" created="Mon, 21 Sep 2009 05:03:37 +0000 (UTC)"  >I&apos;ve an error too when I delete a database on source :&lt;br/&gt;
&lt;br/&gt;
** Last message in was {tcp,#Port&amp;lt;0.3307&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;HTTP/1.1 500 Internal Server Error\r\nServer: CouchDB/0.10.0a (Erlang OTP/R12B)\r\nDate: Mon, 21 Sep 2009 05:00:14 GMT\r\nContent-Type: application/json\r\nContent-Length: 55\r\nCache-Control: must-revalidate\r\n\r\n&amp;quot;&amp;gt;&amp;gt;}&lt;br/&gt;
** When Server state == {state,&amp;quot;192.168.1.4&amp;quot;,5984,false,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{ssl_imp,new}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;false,#Port&amp;lt;0.3307&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[{request,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{url,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;&lt;a href=&quot;http://192.168.1.4:5984/test_db379/_changes?style=all_docs&amp;heartbeat=true&amp;since=0&amp;feed=continuous&quot;&gt;http://192.168.1.4:5984/test_db379/_changes?style=all_docs&amp;amp;heartbeat=true&amp;amp;since=0&amp;amp;feed=continuous&lt;/a&gt;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;192.168.1.4&amp;quot;,5984,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/test_db379/_changes?style=all_docs&amp;amp;heartbeat=true&amp;amp;since=0&amp;amp;feed=continuous&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;http},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;get,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{stream_to,{&amp;lt;0.6128.0&amp;gt;,once}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{response_format,binary}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.6128.0&amp;gt;,#Ref&amp;lt;0.0.0.19258&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.6128.0&amp;gt;,true,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1253,464652,783192},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1048576,false,undefined,undefined,binary}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{request,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{url,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;&lt;a href=&quot;http://192.168.1.4:5984/test_db379/_changes?style=all_docs&amp;heartbeat=true&amp;since=0&amp;feed=continuous&quot;&gt;http://192.168.1.4:5984/test_db379/_changes?style=all_docs&amp;amp;heartbeat=true&amp;amp;since=0&amp;amp;feed=continuous&lt;/a&gt;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;192.168.1.4&amp;quot;,5984,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/test_db379/_changes?style=all_docs&amp;amp;heartbeat=true&amp;amp;since=0&amp;amp;feed=continuous&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;http},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;get,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{stream_to,{&amp;lt;0.6128.0&amp;gt;,once}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{response_format,binary}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.6128.0&amp;gt;,#Ref&amp;lt;0.0.0.19258&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.6128.0&amp;gt;,true,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1253,464652,783192},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1048576,false,undefined,undefined,binary},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;get_body,&amp;quot;200&amp;quot;,&amp;lt;&amp;lt;&amp;gt;&amp;gt;,0,955,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&amp;quot;Transfer-Encoding&amp;quot;,&amp;quot;chunked&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Server&amp;quot;,&amp;quot;CouchDB/0.10.0a (Erlang OTP/R12B)&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Date&amp;quot;,&amp;quot;Sun, 20 Sep 2009 16:37:32 GMT&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Content-Type&amp;quot;,&amp;quot;application/json&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Cache-Control&amp;quot;,&amp;quot;must-revalidate&amp;quot;}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;false,undefined,undefined,true,chunked,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;chunk_start,&amp;lt;&amp;lt;&amp;gt;&amp;gt;,0,undefined,1,undefined}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {function_clause,[{ibrowse_http_client,to_ascii,&amp;quot;r&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ibrowse_http_client,hexlist_to_integer,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ibrowse_http_client,parse_11_response,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ibrowse_http_client,handle_sock_data,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}&lt;br/&gt;
[error] [&amp;lt;0.6129.0&amp;gt;] {error_report,&amp;lt;0.21.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.6129.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.6129.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{ibrowse_http_client,to_ascii,&amp;quot;r&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ibrowse_http_client,hexlist_to_integer,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ibrowse_http_client,parse_11_response,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ibrowse_http_client,handle_sock_data,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{ibrowse_http_client,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.6128.0&amp;gt;,&amp;lt;0.6121.0&amp;gt;,couch_rep_sup,couch_primary_services,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.6128.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{my_trace_flag,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ibrowse_trace_token,[&amp;quot;192.168.1.4&amp;quot;,58,&amp;quot;5984&amp;quot;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{http_prot_vsn,&amp;quot;HTTP/1.1&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{conn_close,&amp;quot;false&amp;quot;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,2584},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,62703}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
</comment>
                    <comment id="12757892" author="kocolosk" created="Mon, 21 Sep 2009 13:43:40 +0000 (UTC)"  >So, what _should_ happen in this case is the couch_rep supervisor should restart the replication, and it will pick up near where it left off.  Are you not seeing that behavior?&lt;br/&gt;
&lt;br/&gt;
I don&apos;t think we want to suppress this error message.  I could see reformatting it into something much less verbose, but then the same argument could be made for almost any Erlang error report.</comment>
                    <comment id="12757893" author="kocolosk" created="Mon, 21 Sep 2009 13:48:14 +0000 (UTC)"  >Ah, I commented before reading your 2nd comment.  I&apos;ll take a look at the deleted-DB-on-source case and see if there&apos;s a more intelligent way to handle it.</comment>
                    <comment id="12757919" author="kocolosk" created="Mon, 21 Sep 2009 15:18:32 +0000 (UTC)"  >The second case looks like a bug in _changes ... if a DB is deleted in the middle of a continuous _changes feed we get an extra set of headers in the response:&lt;br/&gt;
&lt;br/&gt;
GET /test_suite_db_b/_changes?style=all_docs&amp;amp;heartbeat=true&amp;amp;since=0&amp;amp;feed=continuous HTTP/1.1&lt;br/&gt;
Accept: application/json&lt;br/&gt;
User-Agent: CouchDB/0.11.0a817251&lt;br/&gt;
Host: 127.0.0.1:5984&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: CouchDB/0.11.0a817251 (Erlang OTP/R13B)&lt;br/&gt;
Date: Mon, 21 Sep 2009 15:12:59 GMT&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 500 Internal Server Error&lt;br/&gt;
Server: CouchDB/0.11.0a817251 (Erlang OTP/R13B)&lt;br/&gt;
Date: Mon, 21 Sep 2009 15:13:10 GMT&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Content-Length: 55&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{not_found,no_db_file}&amp;quot;}</comment>
                    <comment id="12758022" author="kocolosk" created="Mon, 21 Sep 2009 20:50:15 +0000 (UTC)"  >The broken _changes feed when a DB was deleted mid-response was fixed in r817398.  The replicator will quietly start a new connection if the changes feed goes down as of r817400.  I also tried to put in some code to slim down the error messages when one of the DBs in a replica pair is deleted, but it could still use some more work.&lt;br/&gt;
&lt;br/&gt;
All of this has been merged to the 0.10 release branch.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 21 Sep 2009 20:50:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 21 Sep 2009 13:43:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-505] Erlang code path prefers older versions of CouchDB</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-505</link>

                    <description>We&apos;re using ERL_LIBS to add PREFIX/lib/couchdb/erlang/lib to the code path on CouchDB startup.  If multiple versions of CouchDB have been installed,  that directory might look something like&lt;br/&gt;
&lt;br/&gt;
mochiweb-r97&lt;br/&gt;
ibrowse-1.5.2&lt;br/&gt;
couch-0.9.0&lt;br/&gt;
couch-0.10.0a&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
In this case, we want the system to use beams from couch-0.10.0a, but apparently Erlang&apos;s code loader sorts couch-0.9.0 higher.  &lt;br/&gt;
&lt;br/&gt;
One solution would be to fall back to explicitly adding specific app directories to the code path using -pa.&lt;br/&gt;
&lt;br/&gt;
An elegant solution would be to make sure that our app directories are named in such a way that they automatically sort correctly in the code loader.  I&apos;m not sure this is really possible, though, particularly when a user is installing development versions built from source next to released versions.</description>
                <environment>any system where different minor versions of CouchDB have been installed to the same --prefix</environment>
            <key id="12435841">COUCHDB-505</key>
        <summary>Erlang code path prefers older versions of CouchDB</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Wed, 16 Sep 2009 15:35:28 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:41:04 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12828280" author="janl" created="Mon, 1 Feb 2010 21:41:04 +0000 (UTC)"  >unblock</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 21:41:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-504] HTTP/1.1 keep alive fails with AB</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-504</link>

                    <description>Reported on dev@&lt;br/&gt;
&lt;br/&gt;
On Tue, Sep 15, 2009 at 3:33 PM, thomas hallaran &amp;lt;&lt;a href=&apos;mailto:thallaran@gmail.com&apos;&gt;thallaran@gmail.com&lt;/a&gt;&amp;gt; wrote:&lt;br/&gt;
&amp;gt; Hi all,&lt;br/&gt;
&amp;gt; We are using couchdb in production and have come across what appears to be a&lt;br/&gt;
&amp;gt; bug in the HTTP implementation. Apparently http keep alive requests are not&lt;br/&gt;
&amp;gt; correctly supported by couchdb.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; This problem has been verified for both couchdb .10 a running on  ubuntu&lt;br/&gt;
&amp;gt; with erlang 13.b1 and couchdb .91 running on osx.  We have also reproduced&lt;br/&gt;
&amp;gt; it with multiple http clients, the apache hc java client, curl and ab.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; To Reproduce: ab -v 4 -k -n1&lt;br/&gt;
&amp;gt; &lt;a href=&quot;http://localhost:5984/&quot;&gt;http://localhost:5984/&lt;/a&gt;{COUCHDB_GET_ENDPOINT}&amp;lt;&lt;a href=&quot;http://localhost:5984/%7BCOUCHDB_GET_ENDPOINT%7D&amp;gt;times&quot;&gt;http://localhost:5984/%7BCOUCHDB_GET_ENDPOINT%7D&amp;amp;gt;times&lt;/a&gt;&lt;br/&gt;
&amp;gt; out. If you add more requests for ab to do (-n4 or something) you will&lt;br/&gt;
&amp;gt; see that rather than reusing the connection, each keepalive request times&lt;br/&gt;
&amp;gt; out and then the connection is reopened and the request made.&lt;br/&gt;
&lt;br/&gt;
And I&apos;ve verified:&lt;br/&gt;
&lt;br/&gt;
$ svn up&lt;br/&gt;
#snipped&lt;br/&gt;
Updated to revision 815457.&lt;br/&gt;
$ ./bootstrap &amp;amp;&amp;amp; ./configure &amp;amp;&amp;amp; make dev&lt;br/&gt;
#snipped&lt;br/&gt;
$ ./utils/run&lt;br/&gt;
Apache CouchDB 0.11.0a815457 (LogLevel=info) is starting.&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
&lt;br/&gt;
# In second terminal&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/test_fu&quot;&gt;http://127.0.0.1:5984/test_fu&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X PUT -d &apos;{&amp;quot;stuff&amp;quot;: &amp;quot;here&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test_fu/beer&quot;&gt;http://127.0.0.1:5984/test_fu/beer&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;beer&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-9782357dd8b8d18d94843686e510ec92&amp;quot;}&lt;br/&gt;
$ ab -v 4 -k -n1 &lt;a href=&quot;http://127.0.0.1:5984/test_fu/beer&quot;&gt;http://127.0.0.1:5984/test_fu/beer&lt;/a&gt;&lt;br/&gt;
This is ApacheBench, Version 2.3 &amp;lt;$Revision: 655654 $&amp;gt;&lt;br/&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, &lt;a href=&quot;http://www.zeustech.net/&quot;&gt;http://www.zeustech.net/&lt;/a&gt;&lt;br/&gt;
Licensed to The Apache Software Foundation, &lt;a href=&quot;http://www.apache.org/&quot;&gt;http://www.apache.org/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Benchmarking 127.0.0.1 (be patient)...INFO: POST header == &lt;br/&gt;
---&lt;br/&gt;
GET /test_fu/beer HTTP/1.0&lt;br/&gt;
Connection: Keep-Alive&lt;br/&gt;
Host: 127.0.0.1:5984&lt;br/&gt;
User-Agent: ApacheBench/2.3&lt;br/&gt;
Accept: */*&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
---&lt;br/&gt;
LOG: header received:&lt;br/&gt;
HTTP/1.0 200 OK&lt;br/&gt;
Server: CouchDB/0.11.0a815457 (Erlang OTP/R13B)&lt;br/&gt;
Etag: &amp;quot;1-9782357dd8b8d18d94843686e510ec92&amp;quot;&lt;br/&gt;
Date: Tue, 15 Sep 2009 19:44:36 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Content-Length: 74&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;_id&amp;quot;:&amp;quot;beer&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;1-9782357dd8b8d18d94843686e510ec92&amp;quot;,&amp;quot;stuff&amp;quot;:&amp;quot;here&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
LOG: Response code = 200&lt;br/&gt;
apr_poll: The timeout specified has expired (70007)&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Trunk</environment>
            <key id="12435751">COUCHDB-504</key>
        <summary>HTTP/1.1 keep alive fails with AB</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 15 Sep 2009 19:49:40 +0000 (UTC)</created>
    <updated>Thu, 17 Sep 2009 04:14:23 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12755734" author="paul.joseph.davis" created="Tue, 15 Sep 2009 22:10:46 +0000 (UTC)"  >&lt;a href=&quot;http://code.google.com/p/couchdb-python/issues/detail?id=85&quot;&gt;http://code.google.com/p/couchdb-python/issues/detail?id=85&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Looks like this could be related.</comment>
                    <comment id="12755834" author="dionne" created="Wed, 16 Sep 2009 01:32:13 +0000 (UTC)"  >this patch to send_json puts &amp;quot;Connection : Keep-Alive&amp;quot; into the response header, if it exists in the request. This isn&apos;t likely the best solution but it solves the problem and all the tests run. </comment>
                    <comment id="12755872" author="paul.joseph.davis" created="Wed, 16 Sep 2009 04:26:53 +0000 (UTC)"  >This version is a bit cleaner and fairly more specific than Bob&apos;s. After having it narrowed down to including the Connection: Keep-Alive in the response I just whittled the earlier link down into booleans. I&apos;d commit this but I want other people to double check the sanity of the logic in there.</comment>
                    <comment id="12755887" author="benoitc" created="Wed, 16 Sep 2009 05:22:28 +0000 (UTC)"  >patch like davisp one but using mochiweb_request:should_close. It fix error and all tests pass.</comment>
                    <comment id="12756348" author="paul.joseph.davis" created="Thu, 17 Sep 2009 03:29:05 +0000 (UTC)"  >Fixed as of r816033.&lt;br/&gt;
&lt;br/&gt;
Someone tell me whether I should backport. I want to say yes but I also want someone else to share the blame if it hits the fan.</comment>
                    <comment id="12756360" author="paul.joseph.davis" created="Thu, 17 Sep 2009 04:14:23 +0000 (UTC)"  >Doh, I forgot the origin of the ticket. Back porting now.</comment>
                </comments>
    
    <attachments>
            <attachment id="12419718" name="couch_httpd_hack.patch" size="1185" author="dionne" created="Wed, 16 Sep 2009 01:32:13 +0000 (UTC)" />
            <attachment id="12419723" name="COUCHDB-504.patch" size="2352" author="paul.joseph.davis" created="Wed, 16 Sep 2009 04:26:52 +0000 (UTC)" />
            <attachment id="12419727" name="couchdb_httpd_504.patch" size="1725" author="benoitc" created="Wed, 16 Sep 2009 05:22:28 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 17 Sep 2009 03:29:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 16 Sep 2009 01:32:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-503] update etap to reflect new code in couch_btree</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-503</link>

                    <description>updated etap/021-btree-reductions.t to reflect new code in couch_btree</description>
                <environment></environment>
            <key id="12435668">COUCHDB-503</key>
        <summary>update etap to reflect new code in couch_btree</summary>

            <type id="6" iconUrl="http://issues.apache.org/jira/images/icons/test.gif">Test</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Tue, 15 Sep 2009 00:56:21 +0000 (UTC)</created>
    <updated>Tue, 15 Sep 2009 10:41:06 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12755450" author="janl" created="Tue, 15 Sep 2009 10:41:06 +0000 (UTC)"  >Applied in r815266.</comment>
                </comments>
    
    <attachments>
            <attachment id="12419596" name="021-btree-reductions.t.patch" size="3191" author="dionne" created="Tue, 15 Sep 2009 00:57:20 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Sep 2009 10:41:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Sep 2009 10:41:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-502] Large objects/text crash Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-502</link>

                    <description>Any sufficiently large JSON object will cause script time outs in firefox/safari. The example object I used had 500 individual keys, whose values were hashes with 20 individual keys.&lt;br/&gt;
&lt;br/&gt;
Storing that same JSON ***AS STRING*** made firefox issue the following error on the console, stopping rendering altogether: script stack space quota is exhausted.&lt;br/&gt;
Statement executed is: var match = quickExpr.exec( selector );\n from jquery.js?1.3.1 (line 50)</description>
                <environment>Futon on Apache CouchDB  0.9.1, ubuntu</environment>
            <key id="12435588">COUCHDB-502</key>
        <summary>Large objects/text crash Futon</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kane">Jos Boumans</reporter>
            
    <created>Mon, 14 Sep 2009 12:30:51 +0000 (UTC)</created>
    <updated>Tue, 15 Sep 2009 22:50:17 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12754957" author="paul.joseph.davis" created="Mon, 14 Sep 2009 12:37:27 +0000 (UTC)"  >Is this a CouchDB problem?&lt;br/&gt;
&lt;br/&gt;
I&apos;m not a jquery expert so I&apos;m not exactly certain what that call is. Anyone know if there&apos;s a way to avoid it?</comment>
                    <comment id="12754982" author="jasondd" created="Mon, 14 Sep 2009 13:46:03 +0000 (UTC)"  >I *think* it&apos;s a Futon issue.  I would need to look into it to be sure though, perhaps it can be solved using some kind of lazy loading/rendering.&lt;br/&gt;
&lt;br/&gt;
We should also upgrade to jQuery 1.3.2, see &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-432&quot; title=&quot;Upgrade Futon&apos;s json2.js and jquery.js&quot;&gt;&lt;strike&gt;COUCHDB-432&lt;/strike&gt;&lt;/a&gt;.  1.3.2 has performance improvements related to :visible/:hidden selectors which may affect us, and it should improve performance generally.</comment>
                    <comment id="12754984" author="paul.joseph.davis" created="Mon, 14 Sep 2009 13:49:32 +0000 (UTC)"  >Faster... Faster! Faster would be better!</comment>
                    <comment id="12755769" author="jasondd" created="Tue, 15 Sep 2009 22:48:25 +0000 (UTC)"  >Verified in Futon on trunk. Large JSON strings cause Futon to be very slow, not CouchDB itself.</comment>
                    <comment id="12755771" author="jasondd" created="Tue, 15 Sep 2009 22:49:27 +0000 (UTC)"  >Test JSON data.  To reproduce, copy and paste its contents into a field in a document in Futon.</comment>
                    <comment id="12755773" author="jasondd" created="Tue, 15 Sep 2009 22:50:11 +0000 (UTC)"  >Easier to copy-and-paste from a .txt.</comment>
                </comments>
    
    <attachments>
            <attachment id="12419705" name="test.json.txt" size="54390" author="jasondd" created="Tue, 15 Sep 2009 22:50:11 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Sep 2009 12:37:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-501] launchd plist for Mac OS X needs cleanup</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-501</link>

                    <description>The provided org.apache.couchdb.plist for launchd contains the flag OnDemand set to true, as well as KeepAlive. OnDemand was deprecated in 10.4 and replaced by KeepAlive which is much more powerful. As a result, launchd will NOT restart CouchDB on Snow Leopard after it has been stopped with launchctl stop org.apache.couchdb, as is stated in the README. A manual start or reboot is needed.&lt;br/&gt;
&lt;br/&gt;
Solution: just remove the OnDemand tag from the plist and all is happy happy again.&lt;br/&gt;
&lt;br/&gt;
As a side note: if on-demand loading is really what&apos;s wanted, launchd needs more information. There must be information about which socket launchd should monitor, and keeping that in sync with the port number people choose for couchdb seems just way too much work.</description>
                <environment>Mac OS X 10.6, Snow Leopard</environment>
            <key id="12435580">COUCHDB-501</key>
        <summary>launchd plist for Mac OS X needs cleanup</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ejeklint">Per Ejeklint</reporter>
            
    <created>Mon, 14 Sep 2009 10:59:14 +0000 (UTC)</created>
    <updated>Mon, 14 Sep 2009 11:09:38 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="300">0.08h</timeoriginalestimate>        <timeestimate seconds="300">0.08h</timeestimate>                    

            <comments>
                    <comment id="12754925" author="janl" created="Mon, 14 Sep 2009 11:09:37 +0000 (UTC)"  >fixed in r814578 and 0.10.x</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Sep 2009 11:09:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-500] _list ignores endkey parameter</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-500</link>

                    <description>endkey isn&apos;t tested at all in list_views.js at the moment, patch to follow...</description>
                <environment></environment>
            <key id="12435505">COUCHDB-500</key>
        <summary>_list ignores endkey parameter</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Sat, 12 Sep 2009 11:58:58 +0000 (UTC)</created>
    <updated>Mon, 14 Sep 2009 23:16:31 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12754514" author="jasondd" created="Sat, 12 Sep 2009 11:59:37 +0000 (UTC)"  >Simple patch demonstrating the problem.</comment>
                    <comment id="12755239" author="jasondd" created="Mon, 14 Sep 2009 23:16:31 +0000 (UTC)"  >Fixed in r814893, test case added in r814912.</comment>
                </comments>
    
    <attachments>
            <attachment id="12419378" name="endkey.test.patch" size="1402" author="jasondd" created="Sat, 12 Sep 2009 11:59:37 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Sep 2009 23:16:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-499] allow /etc/default/couchdb to control whether couchdb is started by default</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-499</link>

                    <description>couchdb starts by default when installed on Ubuntu (or any debian derivative).&lt;br/&gt;
In Ubuntu, we are including couchdb in the default desktop install.&lt;br/&gt;
however, we are not using the system couchdb, we are starting a per-user couchdb instance on-demand.&lt;br/&gt;
&lt;br/&gt;
separately, ubuntu is working on minimizing boot times.&lt;br/&gt;
it would be nice if laptops and netbooks did not have couchdb startup time included in a normal system boot unless the user really wanted to have the system couchdb starting up. this is the Ubuntu bug number for reference: &lt;a href=&quot;https://code.edge.launchpad.net/bugs/427036&quot;&gt;https://code.edge.launchpad.net/bugs/427036&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
One way to fix this would be to use a variable in /etc/default/couchdb to determine whether or not to start the system couchdb instance. This is the approach that is taken by pulseaudio, fetchmail, and monit. I&apos;m discussing this fix with Ubuntu core-devs now: &lt;a href=&quot;https://code.edge.launchpad.net/~statik/ubuntu/karmic/couchdb/fix-bug427036/+merge/11543&quot;&gt;https://code.edge.launchpad.net/~statik/ubuntu/karmic/couchdb/fix-bug427036/+merge/11543&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;m also attaching a patch which changes the init script and /etc/couchdb/default in the way I&apos;ve just described.</description>
                <environment>Ubuntu 9.10 (Karmic)</environment>
            <key id="12435346">COUCHDB-499</key>
        <summary>allow /etc/default/couchdb to control whether couchdb is started by default</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="statik">Elliot Murphy</reporter>
            
    <created>Thu, 10 Sep 2009 18:03:22 +0000 (UTC)</created>
    <updated>Sat, 12 Sep 2009 12:40:05 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12753741" author="paul.joseph.davis" created="Thu, 10 Sep 2009 18:11:48 +0000 (UTC)"  >I think principle of least surprise would be to have a system CouchDB start by default and then let the Debian package override this behavior. Other than that I think the patch would be fine.</comment>
                    <comment id="12753752" author="statik" created="Thu, 10 Sep 2009 18:28:06 +0000 (UTC)"  >Is /etc/default/couchdb used by anything other than the debian package? I guess perhaps a locally built install/make install would use it?&lt;br/&gt;
&lt;br/&gt;
the other way of solving this that has been proposed is to move the init script into a separate binary package, for example couchdb-server. Then it&apos;s possible to install couchdb without getting any system couchdb started, and if you install couchdb-server you get the init script and a system couchdb.&lt;br/&gt;
&lt;br/&gt;
This would require also going and communicating the change to all the packages which depend on couchdb so that they could change their dependency to couchdb-server if desired. Currently I think that list is pretty short, but it&apos;s worth considering.&lt;br/&gt;
&lt;br/&gt;
Thanks for the quick feedback, I&apos;m trying to discuss this issue with all the interested communities so that the fix we put into ubuntu is the best possible one, and compatible with debian and anywhere else that uses /etc/default/couchdb.</comment>
                    <comment id="12753757" author="paul.joseph.davis" created="Thu, 10 Sep 2009 18:33:59 +0000 (UTC)"  >Oh good point. I&apos;m not sure exactly who does use the /etc/default/ system.&lt;br/&gt;
&lt;br/&gt;
I think the couchdb-server idea isn&apos;t too bad, but once again, principle of least suprise. People installing couchdb would probably just default to `apt-get install couchdb` and then get confused by it not starting. Though, to the same effect, you could instead add a couchdb-core package that doesn&apos;t install the system scripts, and then the couchdb package does. That&apos;d solve the downstream packagers from the possible trip up.</comment>
                    <comment id="12753952" author="nslater" created="Fri, 11 Sep 2009 02:26:55 +0000 (UTC)"  >Yes, /etc/default/couchdb is used by every single system that uses the init.d script as the init.d script sources this file before it does anything. The idea behind the patch is cool, but I&apos;m not willing to accept it until you change the name to &amp;quot;COUCHDB_ENABLED=1&amp;quot; and have it default to being enabled. If Ubuntu wants to then use this to disable it by default, you can do that by patching this file. Make sense? How you split your server package is of no concern for us, but this option has general use I think. Only, again, default on.</comment>
                    <comment id="12754133" author="statik" created="Fri, 11 Sep 2009 13:56:29 +0000 (UTC)"  >Thanks for the discussion! After talking about this here and with the other Ubuntu developers, we&apos;re going to solve this by splitting the couchdb package into couchb and couchb-bin. Then the desktopcouch stuff we are building can simply depend on couchdb-bin, and get all the bits needed to start per-user couchdb instances, and the behavior isn&apos;t changed for other people or packages who were used to simply installing the couchdb package.</comment>
                    <comment id="12754492" author="candlerb" created="Sat, 12 Sep 2009 08:07:59 +0000 (UTC)"  >&lt;br/&gt;
On my Ubuntu Hardy desktop:&lt;br/&gt;
&lt;br/&gt;
$ ls /etc/default/&lt;br/&gt;
acpid               ddclient                         pcmcia&lt;br/&gt;
acpi-support        devpts                           pmi&lt;br/&gt;
alsa                exim4                            portmap&lt;br/&gt;
apache2             fetchmail                        pound&lt;br/&gt;
apache2.dpkg-old    hal                              powernowd&lt;br/&gt;
apmd                halt                             pulseaudio&lt;br/&gt;
apport              iodine                           rcS&lt;br/&gt;
avahi-daemon        klogd                            rsync&lt;br/&gt;
bittorrent          linux-restricted-modules-common  slapd&lt;br/&gt;
bluetooth           lvm-common                       smartmontools&lt;br/&gt;
bluetooth.dpkg-new  mdadm                            ssh&lt;br/&gt;
bootlogd            nfs-common                       syslogd&lt;br/&gt;
brltty              nfs-kernel-server                tmpfs&lt;br/&gt;
console-setup       ntp                              ufw&lt;br/&gt;
cupsys              ntpdate                          useradd&lt;br/&gt;
dbus                nvidia-kernel&lt;br/&gt;
&lt;br/&gt;
In most cases these files aren&apos;t used for deciding whether the server is&lt;br/&gt;
stopped or started. e.g.&lt;br/&gt;
&lt;br/&gt;
$ cat /etc/default/ntp&lt;br/&gt;
NTPD_OPTS=&apos;-g&apos;&lt;br/&gt;
$ &lt;br/&gt;
&lt;br/&gt;
If you want that package installed but not running, you&apos;d use update-rc.d&lt;br/&gt;
&lt;br/&gt;
However perhaps a better example is exim4, which has a number of options&lt;br/&gt;
including no daemon, or a daemon which is just a queue runner, or a daemon&lt;br/&gt;
which is both queue runner or smtp listener. This is configured in&lt;br/&gt;
/etc/default/exim4 and so the user can select it using dpkg-reconfigure&lt;br/&gt;
&lt;br/&gt;
# /etc/default/exim4&lt;br/&gt;
EX4DEF_VERSION=&apos;&apos;&lt;br/&gt;
&lt;br/&gt;
# &apos;combined&apos; -	 one daemon running queue and listening on SMTP port&lt;br/&gt;
# &apos;no&apos;       -	 no daemon running the queue&lt;br/&gt;
# &apos;separate&apos; -	 two separate daemons&lt;br/&gt;
# &apos;ppp&apos;      -   only run queue with /etc/ppp/ip-up.d/exim4.&lt;br/&gt;
# &apos;nodaemon&apos; - no daemon is started at all.&lt;br/&gt;
# &apos;queueonly&apos; - only a queue running daemon is started, no SMTP listener.&lt;br/&gt;
# setting this to &apos;no&apos; will also disable queueruns from&lt;br/&gt;
# /etc/ppp/ip-up.d/exim4&lt;br/&gt;
QUEUERUNNER=&apos;combined&apos;&lt;br/&gt;
# how often should we run the queue&lt;br/&gt;
QUEUEINTERVAL=&apos;30m&apos;&lt;br/&gt;
# options common to quez-runner and listening daemon&lt;br/&gt;
COMMONOPTIONS=&apos;&apos;&lt;br/&gt;
# more options for the daemon/process running the queue (applies to the one&lt;br/&gt;
# started in /etc/ppp/ip-up.d/exim4, too.&lt;br/&gt;
QUEUERUNNEROPTIONS=&apos;&apos;&lt;br/&gt;
# special flags given to exim directly after the -q. See exim(8)&lt;br/&gt;
QFLAGS=&apos;&apos;&lt;br/&gt;
# options for daemon listening on port 25&lt;br/&gt;
SMTPLISTENEROPTIONS=&apos;&apos;&lt;br/&gt;
&lt;br/&gt;
Regards,&lt;br/&gt;
&lt;br/&gt;
Brian.&lt;br/&gt;
</comment>
                    <comment id="12754522" author="nslater@apache.org" created="Sat, 12 Sep 2009 12:40:04 +0000 (UTC)"  >&lt;br/&gt;
No, this is false.&lt;br/&gt;
&lt;br/&gt;
Users should generally not be running update-rc.d.&lt;br/&gt;
&lt;br/&gt;
The use of /etc/default files are standard for disabling services.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Right, this is an example of how to use this file properly. There are other&lt;br/&gt;
packages which will use this file to disable the service entirely. And the use&lt;br/&gt;
of dpkg-reconfigure good, but orthogonal to this discussion.&lt;br/&gt;
&lt;br/&gt;
Thanks,&lt;br/&gt;
&lt;br/&gt;
-- &lt;br/&gt;
Noah Slater, &lt;a href=&quot;http://tumbolia.org/nslater&quot;&gt;http://tumbolia.org/nslater&lt;/a&gt;&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12419200" name="control-service-start.patch" size="911" author="statik" created="Thu, 10 Sep 2009 18:04:10 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 11 Sep 2009 13:56:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 10 Sep 2009 18:11:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-498] .ini file chaining not properly reset by -n switch</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-498</link>

                    <description>I&apos;ve added as line 220 in /usr/bin/couchdb:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;echo &amp;quot;startarguments: $start_arguments&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Now, when I do:&lt;br/&gt;
&lt;br/&gt;
/usr/bin/couchdb -n -a /tmp/tmp871WkT/xdg_config/desktop-couch/desktop-couchdb.ini -p /tmp/tmp871WkT/xdg_cache/desktop-couch/desktop-couchdb.pid -o /tmp/tmp871WkT/xdg_cache/desktop-couch/desktop-couchdb.stdout -e /tmp/tmp871WkT/xdg_cache/desktop-couch/desktop-couchdb.stderr -b&lt;br/&gt;
&lt;br/&gt;
I get:&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB has started, time to relax.&lt;br/&gt;
&lt;a href=&apos;mailto:eric@thelog&apos;&gt;eric@thelog&lt;/a&gt;:~$ startarguments:  \&amp;quot;/etc/couchdb/default.ini\&amp;quot;, \&amp;quot;/etc/couchdb/local.ini\&amp;quot;,  \&amp;quot;&amp;quot;/etc/couchdb/default.ini&amp;quot;\&amp;quot;, \&amp;quot;&amp;quot;/tmp/tmp871WkT/xdg_config/desktop-couch/desktop-couchdb.ini&amp;quot;\&amp;quot;&lt;br/&gt;
&lt;br/&gt;
which suggests to me that the -n switch in this case does not actually reset the .ini chain.&lt;br/&gt;
&lt;br/&gt;
This came to light when I noticed that any admin users I added in my system CouchDB also affected any other CouchDB I ran on the same machine. Which seems logical if my analysis of the bug is correct, since the admin users would be stored in /etc/couchdb/local.ini which is always picked up.</description>
                <environment>Ubuntu Linux 09.10 (karmic) unreleased</environment>
            <key id="12435127">COUCHDB-498</key>
        <summary>.ini file chaining not properly reset by -n switch</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Tue, 8 Sep 2009 16:14:57 +0000 (UTC)</created>
    <updated>Thu, 10 Sep 2009 01:00:48 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12752596" author="kocolosk" created="Tue, 8 Sep 2009 16:35:03 +0000 (UTC)"  >Hi Eric, can you add version and platform information here?</comment>
                    <comment id="12752597" author="kocolosk" created="Tue, 8 Sep 2009 16:36:01 +0000 (UTC)"  >Sorry, I see Karmic and 0.10 above.  What Erlang/OTP version are you running?</comment>
                    <comment id="12752599" author="nslater" created="Tue, 8 Sep 2009 16:43:39 +0000 (UTC)"  >My last comment was so hilariously wrong, I just deleted it. Pretend I said nothing.</comment>
                    <comment id="12752600" author="kocolosk" created="Tue, 8 Sep 2009 16:44:11 +0000 (UTC)"  >Eric, I can confirm the bug when running CouchDB as a background process.  Will fix.</comment>
                    <comment id="12752605" author="kocolosk" created="Tue, 8 Sep 2009 17:03:30 +0000 (UTC)"  >I think all we needed to do was add a -n in the config chain, but I also dropped the quoting of the background start args, to be consistent with the behavior for interactive startup.&lt;br/&gt;
&lt;br/&gt;
Eric, care to check that this fixes things for you?</comment>
                    <comment id="12752607" author="kocolosk" created="Tue, 8 Sep 2009 17:04:46 +0000 (UTC)"  >mmm, note that patch was against trunk, so it may not apply cleanly to 0.10</comment>
                    <comment id="12752724" author="thisfred" created="Tue, 8 Sep 2009 20:28:46 +0000 (UTC)"  >I manually applied the two changes it as best I could against my installed couch (by editing /usr/bin/couchdb directly, probably not the smartest idea) but that showed zero difference. Can you confirm that &amp;quot;-n -a some.ini&amp;quot; really completely bypasses all the .ini files in /etc/couchdb/ ?</comment>
                    <comment id="12752856" author="kocolosk" created="Wed, 9 Sep 2009 01:35:02 +0000 (UTC)"  >Hi Eric, I just double-checked.  In the SVN 0.10.x branch, the -n option works correctly interactively and fails to reset the chain in batch mode.  If I change line 141 of bin/couchdb to&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;background_start_arguments=&amp;quot;-n&amp;quot;&lt;br/&gt;
&lt;br/&gt;
-n works in background mode, too.  I stuck &amp;quot;this_is_default&amp;quot;, &amp;quot;this_is_local&amp;quot;, and &amp;quot;this_is_foo&amp;quot; configuration blocks in the 3 files to be sure.  I only tested it on OS X 10.6.</comment>
                    <comment id="12752859" author="kocolosk" created="Wed, 9 Sep 2009 01:49:52 +0000 (UTC)"  >Hi Eric, I committed this patch to 0.10.x and trunk.  Can you let us know if it doesn&apos;t work for you?</comment>
                    <comment id="12753322" author="thisfred" created="Wed, 9 Sep 2009 23:11:28 +0000 (UTC)"  >This fixes the issue for me on the 0.10 branch, thanks so much, Adam!</comment>
                    <comment id="12753352" author="kocolosk" created="Thu, 10 Sep 2009 01:00:48 +0000 (UTC)"  >Thanks for confirming the fix.  Cheers, Adam</comment>
                </comments>
    
    <attachments>
            <attachment id="12418938" name="background_start_config_reset.patch" size="604" author="kocolosk" created="Tue, 8 Sep 2009 17:03:30 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 9 Sep 2009 01:49:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 8 Sep 2009 16:35:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-497] fix attachments with an undefined Content-Length  header and no TE</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-497</link>

                    <description>&amp;nbsp;When you push an empty attachments with an undefined Content-Length  header and no TE, couchdb raises following error :&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.27660.52&amp;gt;] function_clause error in HTTP request&lt;br/&gt;
[info] [&amp;lt;0.27660.52&amp;gt;] Stacktrace: [{couch_db,flush_att,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.27653.52&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{att,&amp;lt;&amp;lt;&amp;quot;test&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;application/octet-stream&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,&amp;lt;&amp;lt;&amp;gt;&amp;gt;,2,undefined}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-doc_flush_atts/2-lc$^0/1-0-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,doc_flush_atts,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-update_docs/4-lc$^7/1-7-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-update_docs/4-lc$^6/1-6-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,update_docs,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,update_doc,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,db_attachment_req,4}]&lt;br/&gt;
[debug] [&amp;lt;0.27660.52&amp;gt;] httpd 500 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;function_clause&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
attached patch fix this error.</description>
                <environment></environment>
            <key id="12434944">COUCHDB-497</key>
        <summary>fix attachments with an undefined Content-Length  header and no TE</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sun, 6 Sep 2009 14:40:26 +0000 (UTC)</created>
    <updated>Tue, 15 Sep 2009 13:19:23 +0000 (UTC)</updated>

                        <version>0.10</version>
                    <version>0.11</version>
            
                        <fixVersion>0.10</fixVersion>
                    <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12755461" author="benoitc" created="Tue, 15 Sep 2009 11:43:50 +0000 (UTC)"  >attachment with test for empty attachment. I can&apos;t test the undefined clause with undefined content since the browser always add a Content-Length. Howerver following test in python allow you to reproduce it :&lt;br/&gt;
&lt;br/&gt;
before patch&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; h.request(&amp;quot;PUT&amp;quot;, &amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/bin_doc5/empty.txt?rev=3-112f7d0e2ecfab9b1601560c80e9d9b1&quot;&gt;http://127.0.0.1:5984/test_suite_db/bin_doc5/empty.txt?rev=3-112f7d0e2ecfab9b1601560c80e9d9b1&lt;/a&gt;&amp;quot;)&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; r = h.getresponse()&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; r.read()&lt;br/&gt;
&apos;{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;function_clause&amp;quot;}\n&apos;&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; h.close()&lt;br/&gt;
&lt;br/&gt;
after patch :&lt;br/&gt;
&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; h.request(&amp;quot;PUT&amp;quot;, &amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/bin_doc5/empty.txt?rev=3-112f7d0e2ecfab9b1601560c80e9d9b1&quot;&gt;http://127.0.0.1:5984/test_suite_db/bin_doc5/empty.txt?rev=3-112f7d0e2ecfab9b1601560c80e9d9b1&lt;/a&gt;&amp;quot;)&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; r = h.getresponse()&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; r.read()&lt;br/&gt;
&apos;{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;bin_doc5&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;4-3a4c408e867e6ed4068d5e55bdf6f048&amp;quot;}\n&apos;&lt;br/&gt;
</comment>
                    <comment id="12755476" author="janl" created="Tue, 15 Sep 2009 13:19:23 +0000 (UTC)"  >Fixed in trunk in r815308 and in 0.10.0</comment>
                </comments>
    
    <attachments>
            <attachment id="12419623" name="fix_put_attachment2.patch" size="1958" author="benoitc" created="Tue, 15 Sep 2009 11:43:50 +0000 (UTC)" />
            <attachment id="12418754" name="fix_put_attachments.patch" size="904" author="benoitc" created="Sun, 6 Sep 2009 14:40:49 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Sep 2009 13:19:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Sep 2009 13:19:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-496] Remove &quot;Reader Access&quot; section from overview</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-496</link>

                    <description>&lt;br/&gt;
The &amp;quot;Reader Access&amp;quot; section on the overview page describes a feature that couchdb does not currently supply and is unlikely to supply in the stated form in the near future (or possibly ever)&lt;br/&gt;
&lt;br/&gt;
This patch removes the section entirely.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12434941">COUCHDB-496</key>
        <summary>Remove &quot;Reader Access&quot; section from overview</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Sun, 6 Sep 2009 12:02:33 +0000 (UTC)</created>
    <updated>Thu, 17 Dec 2009 22:26:31 +0000 (UTC)</updated>

                
                
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12792177" author="steveolyo" created="Thu, 17 Dec 2009 22:26:31 +0000 (UTC)"  >If Reader Access is to be removed, what will replace it? What architecture will allow for roles/security in couchdb?</comment>
                </comments>
    
    <attachments>
            <attachment id="12418752" name="remove-reader-access.patch" size="2643" author="rnewson" created="Sun, 6 Sep 2009 12:02:55 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 17 Dec 2009 22:26:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-495] Make views twice as fast</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-495</link>

                    <description>Devs,&lt;br/&gt;
&lt;br/&gt;
Damien&apos;s identified view collation as the most significant bottleneck for the view generation. We&apos;ve done some testing, and some preliminary patches, and the upshot seems to be that even removing ICU from the collator is not a significant boost. What does speed things up greatly is using raw Erlang term comparison. Eg, instead of using couch_view:less_json, using fun(A,B) A &amp;lt; B end. provides a roughly 2x speedup.&lt;br/&gt;
&lt;br/&gt;
However, the patch is challenging for a few reasons: Making the collation strategy switchable at all is tough. It&apos;s actually quite easy to get an alternate less function into the btree writer (all you&apos;ve got to do is set it in couch_view_group:init_group). The hard part is propagating the same less function to the PassedEndFun. There&apos;s a secondary problem that when you use raw term comparison, a lot of terms turn out to come before nil, and after {}, which we use as artificial first and last terms in the less_json function. So just switching to raw collation alone will leave you with a view with unreachable rows.&lt;br/&gt;
&lt;br/&gt;
I tried two different approaches to the problem last night, and both of them led to (instructive) dead ends. I&apos;ll attach them for illustration purposes.&lt;br/&gt;
&lt;br/&gt;
The next line of attack we think should be tried is this:&lt;br/&gt;
&lt;br/&gt;
First - remove _all_docs_by_seq, as it is just adding complexity to the problem, and has been deprecated by _changes anyway. Along the same lines, _all_docs should no longer use couch_httpd_view:make_view_fold_fun as it has completely different collation needs than make_view_fold_fun. We&apos;ll end up duplicating a little code in the _all_docs implementation, but it should be worth it because it will make the other work much simpler.&lt;br/&gt;
&lt;br/&gt;
Once those changes have laid the groundwork, the next step is to change make_view_fold_fun and couch_view:fold, so that rather than make_view_fold_fun being responsible for detecting when we&apos;ve passed the endkey. That means make_passed_end_fun and all references to PassedEnd and PassedEnd fun will be stripped from couch_httpd_view and moved to couch_btree.&lt;br/&gt;
&lt;br/&gt;
couch_view:fold (and the underlying btree) will need to accept not just a start, but also an endkey. This will make it much easier to use the less fun that is stored on View#view.btree#btree.less to determine PassedEnd funs. This will move some complexity to the btree code from the view code, but will keep the concerns more aligned. This also means that the btree will need to accept not only an endkey for folds, but also an inclusive_end parameter.&lt;br/&gt;
&lt;br/&gt;
Once we have all these refactorings done, it will be easy to make the less fun for an index configurable, as both the index writer and the index reader will look for it in the same place (on the #btree record).&lt;br/&gt;
&lt;br/&gt;
My aim is to start a discussion and get someone excited to work on this patch. Think of all the fast-views glory you&apos;ll get! Please ask questions and otherwise force me to clarify the above discussion.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12434790">COUCHDB-495</key>
        <summary>Make views twice as fast</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Thu, 3 Sep 2009 22:33:34 +0000 (UTC)</created>
    <updated>Mon, 14 Sep 2009 23:59:25 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12751202" author="jchris" created="Thu, 3 Sep 2009 22:38:17 +0000 (UTC)"  >This patch (binary_collate.diff) provides an option to skip ICU for string comparisons in view collation. Instead you can use &amp;quot;raw&amp;quot; collation which just compares strings using Erlang&apos;s built in &amp;lt; operator. The rest of JSON collation is untouched by the patch.&lt;br/&gt;
&lt;br/&gt;
It&apos;s decently clean, and works. It&apos;s a bit incomplete (only 100% implemented for temp_views) but what matters is that it&apos;s not much faster. So there&apos;s no point in proceeding down this road.&lt;br/&gt;
&lt;br/&gt;
Attached for illustration purposes.</comment>
                    <comment id="12751204" author="jchris" created="Thu, 3 Sep 2009 22:44:23 +0000 (UTC)"  >This patch (term_collate.diff) gives an option to use raw Erlang term comparisons for the entire collation function. It is much faster than ICU collation (about 2x) and removes the single largest view generation bottleneck. It significantly changes view collation behavior (when the option is used) but that is to be expected.&lt;br/&gt;
&lt;br/&gt;
However, it is not very clean, and it is incomplete. I&apos;ve noted most of the shortcomings in the ticket description so I won&apos;t restate them.&lt;br/&gt;
&lt;br/&gt;
If you plan to work on the bug, I&apos;d suggest you NOT start by applying this patch, but rather, read and understand it, so you can see why I suggest the refactorings listed in the ticket. This patch is basically a dead end, but a good learning experience...</comment>
                    <comment id="12751207" author="paul.joseph.davis" created="Thu, 3 Sep 2009 22:54:11 +0000 (UTC)"  >Good sleuthing Chris. Can you upload the script you were using to test view performance so we have a common method for measuring performance improvements?</comment>
                    <comment id="12751209" author="jchris" created="Thu, 3 Sep 2009 22:59:13 +0000 (UTC)"  >We&apos;ll have to ask Damien for that. I let him handle the benchmarks, I just tried to find a decent way to implement the raw collation after he found the bottleneck. &lt;br/&gt;
&lt;br/&gt;
If you feel like it, ways to optimize less_json while maintaing behavior would be generally useful.</comment>
                    <comment id="12751215" author="damienkatz" created="Thu, 3 Sep 2009 23:19:48 +0000 (UTC)"  >I&apos;ve attach the file I&apos;m using for performance benchmarking couch_perf.py. In my tests, the majority of the time was spent inside the &amp;quot;less&amp;quot; comparator function. Part of the problem is the expense of the callout the ICU for collation, which is copying the strings to buffers before comparing them. That can be fixed by using a more efficient method of sending data to Erlang native ports, which is something I&apos;m working on.&lt;br/&gt;
&lt;br/&gt;
However, our json comparison function is also far more expensive than the built-in Erlang term comparison operators.&lt;br/&gt;
&lt;br/&gt;
So the &amp;quot;easy&amp;quot; solution is to just do a native Erlang term collation option. This is the option used by views that don&apos;t need collation, just performance.&lt;br/&gt;
&lt;br/&gt;
A better, but not really possible yet solution, is to code our own comparison function in C, to be on par with Erlangs built-in comparison. I think this isn&apos;t yet possible with Erlang and C code without hacking the core VM.</comment>
                    <comment id="12751262" author="jchris" created="Fri, 4 Sep 2009 01:31:00 +0000 (UTC)"  >two refinements:&lt;br/&gt;
&lt;br/&gt;
inclusive_end - making this a query parameter may be unnecessary. But without a parameter we&apos;d need to switch the default to be false, for more precise reductions. Your choice if you implement. I don&apos;t think inclusive_end would be missed, but we have to switch to open intervals, so that endkey=3 gives you 2.99 but not 3.0 -- doing this would also save a lot of use of the skip=1 parameter for pagination.&lt;br/&gt;
&lt;br/&gt;
also re Damien&apos;s:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; A better, but not really possible yet solution, is to code our own comparison function in C, to be on par with &lt;br/&gt;
&amp;gt; Erlang&apos;s built-in comparison. I think this isn&apos;t yet possible with Erlang and C code without hacking the core VM.&lt;br/&gt;
&lt;br/&gt;
I thought I heard something at Erlang factory about a new way to write what would have to be builtin functions, but as extensions. This could potentially allow us to write a small C library that runs inside the Erlang VM, but is loaded at runtime. I wish I could remember a search term for it.</comment>
                    <comment id="12751281" author="paul.joseph.davis" created="Fri, 4 Sep 2009 03:27:43 +0000 (UTC)"  >Damien suggested trying to use the outputv driver callback instead of the control callback to avoid copying binaries in and out of the VM. So I did. Its made things dog slow.&lt;br/&gt;
&lt;br/&gt;
Hand wavy explanation, maybe too many strings are &amp;lt; 64bytes and thus encause memcpy wrath? No idea.</comment>
                    <comment id="12751284" author="paul.joseph.davis" created="Fri, 4 Sep 2009 03:35:20 +0000 (UTC)"  >An optimization for less_json to minimize the number of calls required. Uses traditional -1, 0, -1 internally so we don&apos;t have to call &amp;quot;A &amp;lt; B ? -1 : (B &amp;lt; A ? 1 : 0)&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Improved runtime on the perf test from 14 minutes -&amp;gt; ~12</comment>
                    <comment id="12751452" author="janl" created="Fri, 4 Sep 2009 13:07:45 +0000 (UTC)"  >Chris, I think you remember Kenneth Lundin (Erlang&apos;s dev tea lead)</comment>
                    <comment id="12751453" author="janl" created="Fri, 4 Sep 2009 13:08:33 +0000 (UTC)"  >Chris, I think you remember Kenneth Lundin (Erlang&apos;s dev tea lead) commenting on my incorporating eep0018 at the London Factory. They want to go towards a more pluggable BiF system but it is not there yet.</comment>
                    <comment id="12751949" author="kocolosk" created="Sun, 6 Sep 2009 19:14:38 +0000 (UTC)"  >I think Paul&apos;s less_json.patch should be applied, although I&apos;d probably change&lt;br/&gt;
&lt;br/&gt;
case foo() of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Res when Res == 0 -&amp;gt;&lt;br/&gt;
&lt;br/&gt;
to&lt;br/&gt;
&lt;br/&gt;
case foo() of&lt;br/&gt;
0 -&amp;gt;</comment>
                    <comment id="12751952" author="paul.joseph.davis" created="Sun, 6 Sep 2009 19:18:47 +0000 (UTC)"  >You know, I have absolutely no idea why I used Res when Res == 0 there. +1 for 0 -&amp;gt;</comment>
                    <comment id="12752013" author="paul.joseph.davis" created="Mon, 7 Sep 2009 05:14:26 +0000 (UTC)"  >A new perf test script. Uses couchdbkit because couchdb-python is broken.</comment>
                    <comment id="12752289" author="paul.joseph.davis" created="Tue, 8 Sep 2009 00:31:04 +0000 (UTC)"  >I implemented a BIF for the UCA algorithm to see how much that would give us in terms of a speed boost. As it turns out, not a whole lot. The numbers I collected are attached as a file.&lt;br/&gt;
&lt;br/&gt;
The three tests I did were for the current method that uses couch_erl_driver, using the UCA collation bif, and just using &amp;lt; for binaries (all three without changing anything else about less_json).&lt;br/&gt;
&lt;br/&gt;
That is all.</comment>
                    <comment id="12752309" author="jchris" created="Tue, 8 Sep 2009 02:42:29 +0000 (UTC)"  >All these optimizations seem to be hitting on the same performance ceiling. Maybe it&apos;s a sign that the bigger refactoring needs to be done, so we can at least have native &amp;lt; instead of less_json for users who need performance more than correct collation.</comment>
                    <comment id="12752356" author="paul.joseph.davis" created="Tue, 8 Sep 2009 05:57:56 +0000 (UTC)"  >I&apos;m still toying a bit. I ran numbers on a larger dataset and they spread out a bit with the BIF tracking the term collation closer than couch_erl_driver. Bumping from 2K docs to 11K and I got numbers like this:&lt;br/&gt;
&lt;br/&gt;
couch_erl_driver: 136.80s&lt;br/&gt;
UCA BIF: 91.76s&lt;br/&gt;
term collation: 85.14s&lt;br/&gt;
&lt;br/&gt;
A complete random aside, I&apos;ve noticed that the work queue nicely segregates computation so that the couchjs and beam processes get assigned to two cores now, but the beam process appears to be the bottleneck. My initial guesses were that it was i/o bound. Though the collation appears to also be a big factor. It might be an interesting hack to move the map sort into the couchjs PID instead of the writer PID and refactor the btree to accept a sorted list to grease the wheels on the write side.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12755257" author="damienkatz" created="Mon, 14 Sep 2009 23:59:25 +0000 (UTC)"  >We now have a raw collation option, and regular json collation is much faster too.</comment>
                </comments>
    
    <attachments>
            <attachment id="12418553" name="binary_collate.diff" size="10087" author="jchris" created="Thu, 3 Sep 2009 22:38:17 +0000 (UTC)" />
            <attachment id="12418557" name="couch_perf.py" size="14597" author="damienkatz" created="Thu, 3 Sep 2009 23:09:02 +0000 (UTC)" />
            <attachment id="12418579" name="less_json.patch" size="2393" author="paul.joseph.davis" created="Fri, 4 Sep 2009 03:35:20 +0000 (UTC)" />
            <attachment id="12418865" name="numbers-davisp.txt" size="388" author="paul.joseph.davis" created="Tue, 8 Sep 2009 00:31:04 +0000 (UTC)" />
            <attachment id="12418578" name="outputv.patch" size="6327" author="paul.joseph.davis" created="Fri, 4 Sep 2009 03:27:43 +0000 (UTC)" />
            <attachment id="12418864" name="perf.py" size="5823" author="paul.joseph.davis" created="Tue, 8 Sep 2009 00:31:04 +0000 (UTC)" />
            <attachment id="12418863" name="R13B1-uca-bif.patch" size="3930" author="paul.joseph.davis" created="Tue, 8 Sep 2009 00:31:04 +0000 (UTC)" />
            <attachment id="12418555" name="term_collate.diff" size="12643" author="jchris" created="Thu, 3 Sep 2009 22:44:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Sep 2009 23:59:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 3 Sep 2009 22:54:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-494] Add include_seqs=true option to _all_dbs to allow efficient bootstrapping of external indexes.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-494</link>

                    <description>&lt;br/&gt;
External indexers need an efficient way to detect changes across all databases when they boot up. The _all_dbs endpoint only lists the names. We propose adding include_seqs=true which would return this style output instead;&lt;br/&gt;
&lt;br/&gt;
[ {&amp;quot;name&amp;quot;:&amp;quot;db1&amp;quot;,&amp;quot;update_seq&amp;quot;,5000}, {&amp;quot;name&amp;quot;:&amp;quot;db2&amp;quot;,&amp;quot;update_seq&amp;quot;,2500} ]&lt;br/&gt;
&lt;br/&gt;
this would allow an external indexer to skip any database that has not changed.&lt;br/&gt;
&lt;br/&gt;
As external indexers often store their configuration changes inside design documents, it might also be helpful if the update_seq of the latest change to any design document was also included. This will allow external indexers to skip even databases with changes as long as those changes are not to design documents;&lt;br/&gt;
&lt;br/&gt;
[ {&amp;quot;name&amp;quot;:&amp;quot;db1&amp;quot;,&amp;quot;update_seq&amp;quot;,5000, &amp;quot;ddoc_update_seq&amp;quot;:23}, {&amp;quot;name&amp;quot;:&amp;quot;db2&amp;quot;,&amp;quot;update_seq&amp;quot;,2500, &amp;quot;ddoc_update_seq&amp;quot;:2500} ]&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12434649">COUCHDB-494</key>
        <summary>Add include_seqs=true option to _all_dbs to allow efficient bootstrapping of external indexes.</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Wed, 2 Sep 2009 15:54:32 +0000 (UTC)</created>
    <updated>Wed, 2 Sep 2009 21:48:13 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12750495" author="rnewson" created="Wed, 2 Sep 2009 15:55:42 +0000 (UTC)"  >&lt;br/&gt;
Also consider feed=continuous and feed=longpoll support</comment>
                    <comment id="12750687" author="antonyblakey" created="Wed, 2 Sep 2009 21:48:13 +0000 (UTC)"  >This should include the db&apos;s UUID, which has recently been added as a more reliable way to identify a database.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12426311">COUCHDB-360</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Sep 2009 21:48:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-493] tweaked etaps to support new startup</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-493</link>

                    <description>couch_server:start(...  has gone away, changed etaps to use couch_server_sup:start_link</description>
                <environment></environment>
            <key id="12434617">COUCHDB-493</key>
        <summary>tweaked etaps to support new startup</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Wed, 2 Sep 2009 11:28:06 +0000 (UTC)</created>
    <updated>Wed, 2 Sep 2009 12:43:13 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12750401" author="dionne" created="Wed, 2 Sep 2009 11:29:09 +0000 (UTC)"  >tweaks to fix etaps</comment>
                    <comment id="12750421" author="janl" created="Wed, 2 Sep 2009 12:43:13 +0000 (UTC)"  >Applied in r810485.</comment>
                </comments>
    
    <attachments>
            <attachment id="12418370" name="etaps.patch" size="1605" author="dionne" created="Wed, 2 Sep 2009 11:29:09 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Sep 2009 12:43:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Sep 2009 12:43:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-492] cascading auth + _session</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-492</link>

                    <description>Actually when you log your user via _session handler it looks only for user in userdb and ignore admins set in local.ini file . Which give some problem if users are set manually (without using _user handler), 2 users could have the same login, or when the user don&apos;t exist in userdb but only in local.ini it won&apos;t be found and authentifaction will fail.</description>
                <environment></environment>
            <key id="12434580">COUCHDB-492</key>
        <summary>cascading auth + _session</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Wed, 2 Sep 2009 03:36:59 +0000 (UTC)</created>
    <updated>Wed, 2 Sep 2009 09:39:36 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12750263" author="benoitc" created="Wed, 2 Sep 2009 04:32:30 +0000 (UTC)"  >`couch_httpd_auth:create_user_req` and `couch_server:hash_password_admin` use a different algo to create the hashed password in current CouchDB. So even even if the _session handler use allready get_user,  wich test first local.ini then users db, auth will fail because expected password hash is different. &lt;br/&gt;
&lt;br/&gt;
Here is a patch that solve it by using same algorihm to make the hash. It don&apos;t change the way hash are calculated in local.ini but only in couch_httpd_auth which is more recent.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12750270" author="benoitc" created="Wed, 2 Sep 2009 04:52:17 +0000 (UTC)"  >new patch that fix tests. All tests pass.</comment>
                    <comment id="12750271" author="benoitc" created="Wed, 2 Sep 2009 04:56:25 +0000 (UTC)"  >I think this should be a blocker for 0.10 since password hash homogeneity is needed for the use of couchdb on the long term.</comment>
                    <comment id="12750357" author="janl" created="Wed, 2 Sep 2009 09:39:36 +0000 (UTC)"  >applied in r810435 and 0.10.x</comment>
                </comments>
    
    <attachments>
            <attachment id="12418333" name="couch_server.diff" size="2987" author="benoitc" created="Wed, 2 Sep 2009 04:32:30 +0000 (UTC)" />
            <attachment id="12418334" name="couch_server2.patch" size="3349" author="benoitc" created="Wed, 2 Sep 2009 04:52:16 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Sep 2009 09:39:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Sep 2009 09:39:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-491] Support replication over SSL</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-491</link>

                    <description>CouchDB currently does not support replication over SSL which is a problem when replicating non public databases between two CouchDB servers over the internet.&lt;br/&gt;
&lt;br/&gt;
It seems SSL support is almost there, though:&lt;br/&gt;
&lt;br/&gt;
If ssl is started from bin/couchdb, push replication to a couchdb that is behind an SSL proxy works (i.e. to an https:// url), but pull replication from same fails, because apparently the request is not encrypted at all. (At least nginx seemed to think it wasn&apos;t.)</description>
                <environment></environment>
            <key id="12434438">COUCHDB-491</key>
        <summary>Support replication over SSL</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Mon, 31 Aug 2009 18:07:10 +0000 (UTC)</created>
    <updated>Wed, 2 Sep 2009 04:32:20 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12750262" author="kocolosk" created="Wed, 2 Sep 2009 04:32:20 +0000 (UTC)"  >Resolved and merged to the 0.10.x branch</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Sep 2009 04:32:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Sep 2009 04:32:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-490] couchdb execution fail on osx snow leopard</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-490</link>

                    <description>With a fresh install of macosx snow leopard on a formarted hard disk I can&apos;t get latest trunk of couchdb running. I get this error :&lt;br/&gt;
&lt;br/&gt;
Trace/BPT trap&lt;br/&gt;
&lt;br/&gt;
Full trace of error is here :&lt;br/&gt;
&lt;a href=&quot;http://friendpaste.com/3qXyIIHhrd8N3fObiDgPcx&quot;&gt;http://friendpaste.com/3qXyIIHhrd8N3fObiDgPcx&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
icu, nspr, spidermonkey and erlang have been built for 64bits.</description>
                <environment>macosx snow leopard : Darwin enlil.local 10.0.0 Darwin Kernel Version 10.0.0: Fri Jul 31 22:47:34 PDT 2009; root:xnu-1456.1.25~1/RELEASE_I386 i386&lt;br/&gt;
</environment>
            <key id="12434402">COUCHDB-490</key>
        <summary>couchdb execution fail on osx snow leopard</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 31 Aug 2009 07:17:26 +0000 (UTC)</created>
    <updated>Sun, 6 Sep 2009 21:56:58 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12749425" author="benoitc" created="Mon, 31 Aug 2009 08:37:44 +0000 (UTC)"  >Got success by reinstalling libs with process described on the wiki &lt;a href=&quot;http://wiki.apache.org/couchdb/Installing_on_OSX&quot;&gt;http://wiki.apache.org/couchdb/Installing_on_OSX&lt;/a&gt; . macports install don&apos;t works on SL, some dependancies are missing and same error happend.</comment>
                    <comment id="12749518" author="janl" created="Mon, 31 Aug 2009 14:58:14 +0000 (UTC)"  >This is a problem with MacPorts, not CouchDB.</comment>
                    <comment id="12751553" author="kocolosk" created="Fri, 4 Sep 2009 18:09:46 +0000 (UTC)"  >Reopening because at the very least our README is wrong,&lt;br/&gt;
&lt;br/&gt;
You can install the dependencies using MacPorts by running:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;port install icu erlang spidermonkey curl&lt;br/&gt;
&lt;br/&gt;
This is not true for Snow Leopard at the moment.</comment>
                    <comment id="12751554" author="paul.joseph.davis" created="Fri, 4 Sep 2009 18:12:36 +0000 (UTC)"  >According to the interweb I should be getting 10.6 today. As I go through the install I&apos;ll be sure and make notes to fix up the README and wiki pages.</comment>
                    <comment id="12751828" author="paul.joseph.davis" created="Sun, 6 Sep 2009 05:32:31 +0000 (UTC)"  >Been tearing my hair out over this one. Tried writing bits for Homebrew right off and ended up where people are at with the segfault. it comes from loading couch_erl_driver. Using GDB to check the traceback points at some OS X internals that are ungoogleable. Replaced with MacPorts and same thing. Moved MacPorts out of the path and tried with local installs of spidermonkey and icu and had sucess. Moved macports back into the path and got an error. &amp;quot;port uninstall spidermonkey&amp;quot; and tried again and met with success. (Custom spidermonkey in /usr/local/...)&lt;br/&gt;
&lt;br/&gt;
So it looks like it&apos;s the spidermonkey (or nspr) build causing issues. I&apos;m still investigatoring.</comment>
                    <comment id="12751832" author="paul.joseph.davis" created="Sun, 6 Sep 2009 06:33:12 +0000 (UTC)"  >Yay fix!</comment>
                    <comment id="12751849" author="janl" created="Sun, 6 Sep 2009 08:52:06 +0000 (UTC)"  >Paul, great job! commit?</comment>
                    <comment id="12751959" author="paul.joseph.davis" created="Sun, 6 Sep 2009 21:56:58 +0000 (UTC)"  >Applied in r811910.</comment>
                </comments>
    
    <attachments>
            <attachment id="12418738" name="no-js-for-driver.patch" size="1475" author="paul.joseph.davis" created="Sun, 6 Sep 2009 06:33:12 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 6 Sep 2009 21:56:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 31 Aug 2009 14:58:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-489] Ability to set continous replication from Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-489</link>

                    <description>This patch gives you the ability to set continous replication from Futon when replicating to another server. There are 2 typeof(undefined) that you can see in the code which are there to make sure that adding a new parameter to CouchDB.replicate doesn&apos;t break legacy code and other parts of the system that may be using it.</description>
                <environment>Mac OS 10</environment>
            <key id="12434305">COUCHDB-489</key>
        <summary>Ability to set continous replication from Futon</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="davidcoallier">David Coallier</reporter>
            
    <created>Fri, 28 Aug 2009 16:55:34 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 22:12:24 +0000 (UTC)</updated>

                        <version>0.12</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
                    <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>        <timeestimate seconds="3600">1h</timeestimate>                    

            <comments>
                    <comment id="12755561" author="davidcoallier" created="Tue, 15 Sep 2009 16:28:55 +0000 (UTC)"  >Has anyone had time to look into that? </comment>
                    <comment id="12765818" author="davidcoallier" created="Wed, 14 Oct 2009 23:44:42 +0000 (UTC)"  >Of course I had left some previous parts of my patches in there. Sorry about that.</comment>
                    <comment id="12765887" author="paul.joseph.davis" created="Thu, 15 Oct 2009 03:22:11 +0000 (UTC)"  >my version. After I hoodwink someone into applying and validating I&apos;ll push it into trunk.</comment>
                    <comment id="12766088" author="kocolosk" created="Thu, 15 Oct 2009 15:24:51 +0000 (UTC)"  >I&apos;d prefer it if the alert that popped up said something like, &amp;quot;Continuous replication started.  Progress reports will be posted to _local/ad4e...&amp;quot;, that is, the value of _local_id in the POST response.</comment>
                    <comment id="12766093" author="paul.joseph.davis" created="Thu, 15 Oct 2009 15:35:49 +0000 (UTC)"  >Does that id come back in the POST response? That should be quite doable either way. Though I think instead of an alert putting it in the table would be better so that the DocID can be a clickable link.</comment>
                    <comment id="12766099" author="davidcoallier" created="Thu, 15 Oct 2009 15:40:59 +0000 (UTC)"  >Yes it comes back from the response. </comment>
                    <comment id="12766342" author="paul.joseph.davis" created="Fri, 16 Oct 2009 00:15:02 +0000 (UTC)"  >Can someone fix this patch for me? I got the thing so it tries to throw up a link in the table after replication starts but the damn thing fails when loading the local doc regardless of the URL I use. Ie, when I make it use %2F in the _local/foo part, it fails, and fixing to / manually in the url makes it work. And the other way around when I try and do / in the source. That right there is a recipe for a broken keyboard and monitor so I&apos;m gonna let a better web dev figure that one out.</comment>
                    <comment id="12772653" author="kocolosk" created="Mon, 2 Nov 2009 20:39:56 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12828299" author="davidcoallier" created="Mon, 1 Feb 2010 22:11:58 +0000 (UTC)"  >Bumping this to after 0.11. there&apos;s some usuability work to be done in order to make it not only geek-friendly but generally user-friendly. I&apos;ll re-assign this to me and get it done correctly instead of pushing for this version. </comment>
                </comments>
    
    <attachments>
            <attachment id="12422176" name="COUCHDB-489.2.patch" size="3472" author="paul.joseph.davis" created="Thu, 15 Oct 2009 03:22:10 +0000 (UTC)" />
            <attachment id="12422308" name="COUCHDB-489.3.patch" size="4483" author="paul.joseph.davis" created="Fri, 16 Oct 2009 00:15:02 +0000 (UTC)" />
            <attachment id="12422163" name="COUCHDB-489.patch" size="3463" author="davidcoallier" created="Wed, 14 Oct 2009 23:44:42 +0000 (UTC)" />
            <attachment id="12418007" name="COUCHDB-489.patch" size="4120" author="davidcoallier" created="Fri, 28 Aug 2009 16:56:29 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 15 Oct 2009 03:22:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-488] Library not loaded: /opt/local/lib/libnspr4.dylib</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-488</link>

                    <description>After install, I try to start couchdb and get this error:&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB 0.9.1 (LogLevel=info) is starting.&lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,&amp;quot;dlopen(/usr/local/lib/couchdb/erlang/lib/couch-0.9.1/priv/lib/couch_erl_driver.so, 2): Library not loaded: /opt/local/lib/libnspr4.dylib\n  Referenced from: /opt/local/lib/nspr/libplds4.dylib\n  Reason: image not found&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (dlopen(/usr/local/lib/couchdb/erlang/lib/couch-0.9.1/priv/lib/couch_erl_driver.so, 2): Library not loaded: /opt/local/lib/libnspr4.dylib&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Referenced from: /opt/local/li&lt;br/&gt;
&lt;br/&gt;
This error occurring into 0.9.0, 0.9.1 and the version of subversion.</description>
                <environment>Macbook PRO 13&apos;&lt;br/&gt;
Mac OS X 10.5.8&lt;br/&gt;
&lt;br/&gt;
Dependencies: &lt;br/&gt;
- automake version: 1.11_0&lt;br/&gt;
- autoconf version: 2.64_2&lt;br/&gt;
- libtool version: 2.2.6a_0 &lt;br/&gt;
- help2man version: 1.36.4_1&lt;br/&gt;
- icu version: 4.3.1_0&lt;br/&gt;
- spidermonkey version: 1.7.0_4&lt;br/&gt;
- curl version: 7.19.6_0&lt;br/&gt;
- erlang version: R13B01_0</environment>
            <key id="12434272">COUCHDB-488</key>
        <summary>Library not loaded: /opt/local/lib/libnspr4.dylib</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ozeias">Oz&#233;ias Sant&apos;ana</reporter>
            
    <created>Fri, 28 Aug 2009 12:46:10 +0000 (UTC)</created>
    <updated>Fri, 28 Aug 2009 18:22:19 +0000 (UTC)</updated>

                        <version>0.9</version>
                    <version>0.9.1</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12748929" author="janl" created="Fri, 28 Aug 2009 18:22:19 +0000 (UTC)"  >This is a MacPorts fail. Try updating MacPorts and recompiling all CouchDB dependencies and then CouchDB. Somebody more knowledgeable might know the proper fix. But this is a MacPorts problem, not CouchDB&apos;s.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 28 Aug 2009 18:22:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 28 Aug 2009 18:22:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-487] Pause write requests to allow compaction to complete</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-487</link>

                    <description>Continuous writes will currently indefinitely prevent the compaction process from flipping over to the .compact file.&lt;br/&gt;
&lt;br/&gt;
Here&apos;s a small patch that adds a new db flag called &apos;write_available&apos; which becomes false the first time compaction completes but fails to flip over because of concurrent writes. Subsequent calls to update_docs then sleep for 1/2 a second and throw retry.&lt;br/&gt;
&lt;br/&gt;
I ran &apos;ab -p json -n 1000000 &lt;a href=&quot;http://localhost:5984/db1&apos;&quot;&gt;http://localhost:5984/db1&apos;&lt;/a&gt; in one window. Without this patch, I get a long sequence of;&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.64.0&amp;gt;] Compaction file still behind main file (update seq=1848. compact update seq=1845). Retrying.&lt;br/&gt;
&lt;br/&gt;
and compaction never completes.&lt;br/&gt;
&lt;br/&gt;
With the patch, I get this;&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.369.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /db1 201&lt;br/&gt;
[info] [&amp;lt;0.65.0&amp;gt;] Compaction file still behind main file (update seq=2140. compact update seq=2092). Retrying.&lt;br/&gt;
[info] [&amp;lt;0.65.0&amp;gt;] Blocking writes to complete compaction.&lt;br/&gt;
[info] [&amp;lt;0.65.0&amp;gt;] Compaction for db &amp;quot;db1&amp;quot; completed.&lt;br/&gt;
[info] [&amp;lt;0.370.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /db1 201&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12434136">COUCHDB-487</key>
        <summary>Pause write requests to allow compaction to complete</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Thu, 27 Aug 2009 08:50:12 +0000 (UTC)</created>
    <updated>Thu, 27 Aug 2009 13:23:36 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12748304" author="rnewson" created="Thu, 27 Aug 2009 08:50:42 +0000 (UTC)"  >&lt;br/&gt;
block writes at compaction completion.</comment>
                    <comment id="12748320" author="rnewson" created="Thu, 27 Aug 2009 09:58:54 +0000 (UTC)"  >&lt;br/&gt;
A better version of the same idea.&lt;br/&gt;
</comment>
                    <comment id="12748362" author="kocolosk" created="Thu, 27 Aug 2009 13:16:52 +0000 (UTC)"  >I don&apos;t think we want to be that aggressive about blocking incoming writes.  This algorithm would cause a large DB to be unavailable for writes for several minutes, even if the write load is not so large as to prevent compaction from finishing without blocking.  The reason is that each compaction iteration works with a single MVCC snapshot; any updates to the DB that occur during that iteration are compacted in the next pass.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve seen several cases where compaction finishes in 3-4 passes, with the first one taking several hours, the next one several minutes, the next one several seconds, and then it&apos;s done.&lt;br/&gt;
&lt;br/&gt;
I think if we&apos;re going to block writes we should only do it when we have some expectation that the non-blocking approach isn&apos;t working; e.g. we could track (update_seq - compact_update_seq) and if that difference grows between iterations, block until compaction is finished.&lt;br/&gt;
&lt;br/&gt;
Thanks for kicking off this ticket with some code, though!</comment>
                    <comment id="12748365" author="rnewson" created="Thu, 27 Aug 2009 13:23:36 +0000 (UTC)"  >That&apos;s a fair concern. My preferred fix is to use multiple files that can be compacted/obsoleted separately, which makes it non-blocking even under heavy nd continuous writing. &lt;br/&gt;
&lt;br/&gt;
I was aware of the multi-pass nature of compaction when I wrote the patch, which is why it doesn&apos;t kick in at all unless it tries and fails to switch over to the compact file. I can modify the patch to only make write_available=false if the seq delta is below a configurable threshold, which is a nice change anyway, and the default can be 0, which is today&apos;s behavior.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12417867" name="block_writes_after_end_of_compaction.patch" size="1854" author="rnewson" created="Thu, 27 Aug 2009 09:58:54 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 27 Aug 2009 13:16:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-486] Better separation between httpd and core through api layer</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-486</link>

                    <description>I&apos;m attaching a patch that routes non-purely-functional calls into core CouchDB modules through a new couch_api module.  I also went ahead and wrote down dialyzer specs for everything in couch_api.  I think this will be a useful reference, will make the codebase a bit more accessible to newcomers, and will help us maintain better separation between the purely functional httpd layer and the core (useful in e.g. partitioning work).</description>
                <environment></environment>
            <key id="12433974">COUCHDB-486</key>
        <summary>Better separation between httpd and core through api layer</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 25 Aug 2009 20:09:48 +0000 (UTC)</created>
    <updated>Wed, 26 Aug 2009 18:24:16 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12747694" author="janl" created="Tue, 25 Aug 2009 22:32:34 +0000 (UTC)"  >I&apos;m still undecided on the patch, but I noticed +-compile(export_all) on top. while this is an api module, I&apos;d probably still suggest using explicit exports. but then, I should make up my mind if I like the general idea :)</comment>
                    <comment id="12747945" author="kocolosk" created="Wed, 26 Aug 2009 13:51:26 +0000 (UTC)"  >Explicit exports are fine by me, the export_all was just a nice shorthand as I was figuring out what needed to be added.&lt;br/&gt;
&lt;br/&gt;
What do you see as the downsides of the patch, Jan?</comment>
                    <comment id="12747962" author="kocolosk" created="Wed, 26 Aug 2009 14:44:42 +0000 (UTC)"  >forgot to use api for replication.  Thanks bitdiddle for checking.</comment>
                    <comment id="12748016" author="kocolosk" created="Wed, 26 Aug 2009 16:31:45 +0000 (UTC)"  >found a few more stragglers, updating the patch</comment>
                    <comment id="12748022" author="damienkatz" created="Wed, 26 Aug 2009 16:46:37 +0000 (UTC)"  >I like the ideas behind this patch, but I think I don&apos;t like everything dumped into a single module. I think I&apos;d prefer instead to have the same module names and the wrapper calls in the same modules, with the implementation code in a new file. So the public wrapper calls for couch_db would remain in couch_db, but the code is now moved to couch_db_imp or couch_db_priv.&lt;br/&gt;
&lt;br/&gt;
I think export_all is fine if everything is going to be exported anyway.</comment>
                    <comment id="12748027" author="kocolosk" created="Wed, 26 Aug 2009 17:04:14 +0000 (UTC)"  >That could work.  I think it&apos;s important in that case to clearly identify the modules that expose the public API; Paul&apos;s work to reorganize the source tree could help in that regard..</comment>
                    <comment id="12748034" author="paul.joseph.davis" created="Wed, 26 Aug 2009 17:12:24 +0000 (UTC)"  >I think Jan has a good point. Though I&apos;m not sure I&apos;d execute it quite like that. If we go through with the source tree reorganization then having a couch_db_client.erl, couch_view_client.erl etc etc is what I&apos;ve seen in other projects.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12748066" author="paul.joseph.davis" created="Wed, 26 Aug 2009 18:24:15 +0000 (UTC)"  >s/Jan/Damien/</comment>
                </comments>
    
    <attachments>
            <attachment id="12417750" name="couch_api.patch" size="41792" author="kocolosk" created="Wed, 26 Aug 2009 16:31:45 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 25 Aug 2009 22:32:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-485] &apos;startkey_docid&apos; should function like &apos;startkey&apos;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-485</link>

                    <description>The &apos;startkey_docid&apos; and &apos;endkey_docid&apos; parameters provide a way of sub-selecting rows for pagination when a view emits many rows with identical key values.  However, it seems both confusing and unintentionally limiting that &apos;startkey_docid&apos; does not function the same as &apos;startkey&apos; with regard to how included documents are identified.&lt;br/&gt;
&lt;br/&gt;
By this I mean, that if a a group of data is emitted with ISO 8601 timestamps as keys (e.g. &amp;quot;2009-08-25T12:00:00Z&amp;quot;) then its possible to specify &apos;startkey=&amp;quot;2009-08&amp;quot;&apos; and include that example data, because it is collated after &apos;startkey&apos;.  However, it those timestamps were emitted as doc ids instead of keys, &apos;startkey_docid&apos;  will only act to filter the data if it _exactly_ matches a doc id.  Specifying &apos;startkey_docid=&amp;quot;2009-08&amp;quot;&apos; would not filter the data at all, even if every selected row has the same key.&lt;br/&gt;
&lt;br/&gt;
The benefit of implementing this change is that views which emit many identical keys could be sub-filtered based on document id.  In the case of my application, the first portion of a document&apos;s id is a timestamp, so I would be able to select a chronological subset of rows after they had been filtered by key.  Another possible use case is where doc ids are slugs--this would make it possible to select an alphabetical range after specifying a category as a key parameter.&lt;br/&gt;
&lt;br/&gt;
I haven&apos;t looked under the hood and I have never written Erlang, so I have no way of accurately estimating how significant this change would be.  Unless I&apos;m misunderstanding something, this change should not break existing code.&lt;br/&gt;
&lt;br/&gt;
Looking forward to reading any feedback/comments/alternatives.&lt;br/&gt;
&lt;br/&gt;
Thanks,&lt;br/&gt;
Chris</description>
                <environment>N/A</environment>
            <key id="12433966">COUCHDB-485</key>
        <summary>&apos;startkey_docid&apos; should function like &apos;startkey&apos;</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="bouvard">Christopher Groskopf</reporter>
            
    <created>Tue, 25 Aug 2009 18:23:54 +0000 (UTC)</created>
    <updated>Thu, 27 Aug 2009 18:30:21 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12748479" author="jchris" created="Thu, 27 Aug 2009 17:55:52 +0000 (UTC)"  >this patch should be not that hard, and I don&apos;t see it breaking anything either. It&apos;d be an ideal patch for someone new to the codebase to dig into.</comment>
                    <comment id="12748492" author="paul.joseph.davis" created="Thu, 27 Aug 2009 18:30:21 +0000 (UTC)"  >I&apos;m highly doubt that I would be a fan of a patch for this. Unless I&apos;m missing a way to do this efficiently, I&apos;m pretty sure that this would be the same logic that would be required to use an array filter.&lt;br/&gt;
&lt;br/&gt;
For instance, consider the worst case scenario. You have a view that emits the same key for every document. Then, your query is a startkey that collates before the key, and startkey_docid collates to the last document id. The query would then have to seek through the entire view set which is unbounded. It could be argued that allowing for skip=N provides the same sinkhole in terms of efficiency, but that seems a bit more of an obvious user choice to me.&lt;br/&gt;
&lt;br/&gt;
startkey_docid can definitely be confusing until you learn that btree&apos;s are sorted by (Key, DocId). And its the same confusion that pops up with sorting arrays. However, its not artificially limiting, its just a limit of slicing a collated list.&lt;br/&gt;
&lt;br/&gt;
Also, re-reading the ticket, I think there&apos;s some confusion. If you select an identical key range, then startkey_docid will select a range of documents as necessary. For instance, in the slug case, if you emit(doc.category, null) then ?startkey=category&amp;amp;startkey_docid=first_docid&amp;amp;endkey=category&amp;amp;endkey_docid=last_docid, you will get back just the range of docids.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 27 Aug 2009 17:55:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-484] validate_doc_update returns an HTTP 500 if validation fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-484</link>

                    <description>If a validate_doc_update method throws an exception to indicate that the proposed update is unacceptable, the http interface will return an 500 status code which indicates that the server is behaving unexpectedly.  However, this situation is an error on the client side and should return a 4xx.  To me, looks like 403 would be the appropriate status code.  From &lt;a href=&quot;http://www.ietf.org/rfc/rfc2616.txt:&quot;&gt;http://www.ietf.org/rfc/rfc2616.txt:&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
10.4.4 403 Forbidden&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;The server understood the request, but is refusing to fulfill it.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Authorization will not help and the request SHOULD NOT be repeated.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;If the request method was not HEAD and the server wishes to make&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;public why the request has not been fulfilled, it SHOULD describe the&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;reason for the refusal in the entity.  If the server does not wish to&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;make this information available to the client, the status code 404&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;(Not Found) can be used instead.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12433880">COUCHDB-484</key>
        <summary>validate_doc_update returns an HTTP 500 if validation fails</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="8">Not A Problem</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="carnold@apache.org">Curt Arnold</reporter>
            
    <created>Mon, 24 Aug 2009 20:24:04 +0000 (UTC)</created>
    <updated>Mon, 4 Jan 2010 02:47:23 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12780963" author="dipthegeezer" created="Sat, 21 Nov 2009 12:37:06 +0000 (UTC)"  >Hi&lt;br/&gt;
&lt;br/&gt;
I&apos;ve created a test for this issue. I hope I&apos;m on the right lines with the test. If not let me know. I&apos;m working on a fix but as I do this in my spare time if someone else beats me to it thats fine.&lt;br/&gt;
&lt;br/&gt;
Dip</comment>
                    <comment id="12795778" author="dipthegeezer" created="Fri, 1 Jan 2010 17:55:04 +0000 (UTC)"  >Hi&lt;br/&gt;
&lt;br/&gt;
The patch submitted contains the tests and the fix. I hope I&apos;m on the right lines. Please give some feedback if you feel its wrong or where I need to improve it. I&apos;m not too sure on procedure in terms of committing to the repo. Once people are happy if they could let me know how I go about this that would be great too.&lt;br/&gt;
&lt;br/&gt;
Thanks&lt;br/&gt;
&lt;br/&gt;
Dip</comment>
                    <comment id="12795782" author="jchris" created="Fri, 1 Jan 2010 18:32:04 +0000 (UTC)"  >Dipesh,&lt;br/&gt;
&lt;br/&gt;
I&apos;m inclined to think the current behavior is not a bug. The current api allows you to throw errors with 2 structures:&lt;br/&gt;
&lt;br/&gt;
throw({forbidden: &amp;quot;message&amp;quot;}) is for when the operation is not allowed by the currently logged in user and reauthenticating is unlikely to help. This is appropriate when eg: a timestamp format is invalid or if a document is required to have a title field. It results in a 403 status code.&lt;br/&gt;
&lt;br/&gt;
throw({unauthorized : &amp;quot;message&amp;quot;}) is for when the current user is not allowed to proceed but reauthenticating might help. Eg when a document may only be updated by the original author. Or if only editors are allowed to mark documents as ready for publication. It results in a 401 status code.&lt;br/&gt;
&lt;br/&gt;
throw({foo : &amp;quot;bar&amp;quot;}) will result in a 500 (server) error which is appropriate given that it doesn&apos;t match the API.&lt;br/&gt;
&lt;br/&gt;
Of course this is open source and if lots of people agree with the patch then I&apos;m likely to change my mind. On reason I can see is if there are common 3rd party libraries that throw structured errors and we&apos;d like to accommodate them.&lt;br/&gt;
&lt;br/&gt;
One other comment. Your patch looks really solid and ready to apply. So I&apos;d be upset if you were discouraged from contributing to CouchDB based on this one experience. You&apos;ve got the code chops, so hopefully we see more patches from you.&lt;br/&gt;
&lt;br/&gt;
Thanks,&lt;br/&gt;
Chris</comment>
                    <comment id="12796067" author="carnold@apache.org" created="Mon, 4 Jan 2010 02:47:23 +0000 (UTC)"  >I have no recollection of seeing &amp;quot;throw({forbidden:&amp;quot;message&amp;quot;})&amp;quot; or anything similar in the wiki documentation at the time that I logged the bug.  I don&apos;t know if this is an issue of CouchDB evolving and addressing this issue independently or if the code was there but undocumented.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/couchdb/Security_Features_Overview&quot;&gt;http://wiki.apache.org/couchdb/Security_Features_Overview&lt;/a&gt; doesn&apos;t describe using forbidden: or unauthorized: to control the HTTP status code.  books.couchdb.org does describe the use, but I don&apos;t think it was published at the time the bug was filed.&lt;br/&gt;
</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12430144">COUCHDB-410</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12429255" name="validate_update.patch" size="3114" author="dipthegeezer" created="Fri, 1 Jan 2010 17:55:04 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 1 Jan 2010 20:32:12 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 12:37:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-483] changes-Test does not run on webkit-based browsers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-483</link>

                    <description>The changes-test fails, because of a strange, or maybe broken, behaviour of webkit-based browsers (testet on Safari Version 4.0.3 (5531.9) and Webkit nightly-build #47686). The asynchronous requests is only completed correctly, if no other JavaScript is running. So it is not possible at the moment to &amp;quot;wait&amp;quot; for new content from the &amp;quot;_changes?feed=continuous&amp;quot;-request.&lt;br/&gt;
&lt;br/&gt;
The only solution to this issue I see is to skip this test on Webkit/Safari.</description>
                <environment>OS X 10.5.7, using CouchDBX-0.10.0a-R13B01-pl3-UNSTABLE.app</environment>
            <key id="12433804">COUCHDB-483</key>
        <summary>changes-Test does not run on webkit-based browsers</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="tisba">Sebastian Cohnen</reporter>
            
    <created>Sun, 23 Aug 2009 19:24:33 +0000 (UTC)</created>
    <updated>Tue, 1 Sep 2009 13:34:21 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12746663" author="tisba" created="Sun, 23 Aug 2009 19:31:17 +0000 (UTC)"  >I&apos;ll attach a patch disabling the affected parts of the changes-test shortly.</comment>
                    <comment id="12746666" author="tisba" created="Sun, 23 Aug 2009 19:42:04 +0000 (UTC)"  >This patch simply disables some parts of this test to make it run properly on webkit.</comment>
                    <comment id="12749909" author="janl" created="Tue, 1 Sep 2009 13:34:21 +0000 (UTC)"  >Applied in r810028 and 0.10.x.</comment>
                </comments>
    
    <attachments>
            <attachment id="12417414" name="0001-Fixed-changes-test.-webkit-currently-does-not-comple.patch" size="1132" author="tisba" created="Sun, 23 Aug 2009 19:42:04 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 1 Sep 2009 13:34:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 1 Sep 2009 13:34:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-482] batch_save-Test is failing on webkit-based browsers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-482</link>

                    <description>The batch_save is failing, because webkit does always set the http statusText to &amp;quot;OK&amp;quot;. This at least on OS X the case. See &lt;a href=&quot;http://trac.webkit.org/browser/trunk/WebCore/platform/network/mac/ResourceResponseMac.mm#L82&quot;&gt;http://trac.webkit.org/browser/trunk/WebCore/platform/network/mac/ResourceResponseMac.mm#L82&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;m going to attach a patch to this issue. The patch does a simple user-agend-based exception. Not pretty, but it works until the webkit-guys fixed their problem.</description>
                <environment>OS X 10.5.7, using CouchDBX-0.10.0a-R13B01-pl3-UNSTABLE.app</environment>
            <key id="12433803">COUCHDB-482</key>
        <summary>batch_save-Test is failing on webkit-based browsers</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="tisba">Sebastian Cohnen</reporter>
            
    <created>Sun, 23 Aug 2009 19:08:13 +0000 (UTC)</created>
    <updated>Tue, 1 Sep 2009 13:12:08 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12746660" author="rnewson" created="Sun, 23 Aug 2009 19:22:34 +0000 (UTC)"  >&lt;br/&gt;
Don&apos;t test the reason phrase (it&apos;s for people). the status code test is sufficient.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12746661" author="rnewson" created="Sun, 23 Aug 2009 19:23:59 +0000 (UTC)"  >Additionally, from the HTTP spec;&lt;br/&gt;
&lt;br/&gt;
6.1.1&lt;br/&gt;
&lt;br/&gt;
&amp;quot;The Reason-Phrase is intended to give a short textual description of the Status-Code. The Status-Code is intended for use by automata and the Reason-Phrase is intended for the human user.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
&amp;quot;The reason phrases listed here are only recommendations -- they MAY be replaced by local equivalents without affecting the protocol.&amp;quot;</comment>
                    <comment id="12749903" author="janl" created="Tue, 1 Sep 2009 13:12:08 +0000 (UTC)"  >Applied Robert&apos;s patch in r810015 and 0.10.x.</comment>
                </comments>
    
    <attachments>
            <attachment id="12417410" name="0001-Fixed-batch_save-test.-Added-a-browser-based-excepti.patch" size="1607" author="tisba" created="Sun, 23 Aug 2009 19:09:10 +0000 (UTC)" />
            <attachment id="12417411" name="dont-test-reason-phrase.patch" size="1109" author="rnewson" created="Sun, 23 Aug 2009 19:22:34 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 1 Sep 2009 13:12:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 23 Aug 2009 19:22:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-481] Continuous replication stability issues</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-481</link>

                    <description>I&apos;ve been trying continuous replication with a different combinations of push/pull with 2, 3 and 4 nodes. I&apos;ve hit several problems and discussed them on IRC with jan___ and kocolosk.&lt;br/&gt;
&lt;br/&gt;
Firstly, the status page in Futon (and the output of _active_tasks) becomes inaccurate sometimes (and does not recover). This complicates investigation of the more serious problems.&lt;br/&gt;
&lt;br/&gt;
I configured a circle of four nodes with continuous pull replication and used &apos;ab&apos; to write documents to the first one. Success is for all documents to appear at all nodes. For small batches of documents, this works. It fails, every time, with large numbers. I use batch=ok on all requests and have not successfully run a 100k run. &lt;br/&gt;
&lt;br/&gt;
The replication task at some point in the circle eventually dumps a huge stacktrace (which kocolosk has seen and I would need to sanitize private server names from before I could post) and dies, and is not restarted. Worse, the client process injecting the documents also dies sometimes.&lt;br/&gt;
&lt;br/&gt;
I have had perfect replication runs with 2 and 3 nodes in a circle, and no successful replication runs with 4 nodes. Using a star pattern (where each node pulls or pushes to the remaining three) fails even more rapidly.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12433800">COUCHDB-481</key>
        <summary>Continuous replication stability issues</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Sun, 23 Aug 2009 17:20:48 +0000 (UTC)</created>
    <updated>Tue, 25 Aug 2009 20:12:08 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12746649" author="rnewson" created="Sun, 23 Aug 2009 18:03:36 +0000 (UTC)"  >&lt;br/&gt;
Non-continuous pull replication also appears to have suffered a regression. I switch to issuing a non-continous replication request once a minute via cron. Again, with four nodes configured in a replication circle. I&apos;ve written 100k documents to one node and the node using pull replication from it is barely moving. The task shows in futon, but it&apos;s updating very, very slowly. It&apos;s currently stuck at #915 after ten minutes or more.&lt;br/&gt;
&lt;br/&gt;
Needless to say that the other two nodes are even further behind.</comment>
                    <comment id="12746669" author="rnewson" created="Sun, 23 Aug 2009 20:12:23 +0000 (UTC)"  >&lt;br/&gt;
Hope it&apos;s appropriate for me to set &apos;fix for version&apos; but kocolosk and jan___ are seeing this (and related) issue, so I think it should appear on the 0.10 release page.</comment>
                    <comment id="12747211" author="kocolosk" created="Tue, 25 Aug 2009 03:42:22 +0000 (UTC)"  >I haven&apos;t been tagging commits with this ticket number, but here&apos;s a list so far&lt;br/&gt;
&lt;br/&gt;
one flat-out bugfix,&lt;br/&gt;
r807308, r807354: more precise and accurate calculation of replication progress&lt;br/&gt;
&lt;br/&gt;
one new feature that could be classified as a bugfix depending on your point-of-view,&lt;br/&gt;
r807342, r807345: follow 302 redirects during replication&lt;br/&gt;
&lt;br/&gt;
and two significant performance improvements (thanks rnewson for all the stress testing):&lt;br/&gt;
r807320, r807360: checkpoint at most once per 5 seconds&lt;br/&gt;
r807208, r807459, r807461: minimize the number of full commit operations&lt;br/&gt;
</comment>
                    <comment id="12747617" author="kocolosk" created="Tue, 25 Aug 2009 20:12:08 +0000 (UTC)"  >New code looks much better according to rnewson.  Everything is committed and merged into 0.10.x, so its time to close this out.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 25 Aug 2009 20:12:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 25 Aug 2009 03:42:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-480] Using filter with _changes throws errors if the filter sees a deleted document</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-480</link>

                    <description>The following error seems to happen if _changes is called with a filter function, and a doc that should be in _changes has been deleted. It looks like the error happens when the original rev that was deleted is processed.&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.9124.0&amp;gt;] Uncaught error in HTTP request: {error,{badmatch,{not_found,deleted}}}&lt;br/&gt;
[info] [&amp;lt;0.9124.0&amp;gt;] Stacktrace: [{couch_httpd_db,&apos;-make_filter_funs/2-fun-2-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,&apos;-changes_enumerator/2-lc$^2/1-0-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,changes_enumerator,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,stream_kv_node2,7},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,fold,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,send_changes,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,handle_changes_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2}]&lt;br/&gt;
[debug] [&amp;lt;0.9124.0&amp;gt;] httpd 500 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{not_found,deleted}&amp;quot;}&lt;br/&gt;
</description>
                <environment>OS X 10.5.5, Erlang R13B01 (5.7.2)</environment>
            <key id="12433743">COUCHDB-480</key>
        <summary>Using filter with _changes throws errors if the filter sees a deleted document</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="jkocherhans">Joseph Kocherhans</reporter>
            
    <created>Fri, 21 Aug 2009 22:44:31 +0000 (UTC)</created>
    <updated>Wed, 9 Sep 2009 16:13:26 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12746321" author="jkocherhans" created="Fri, 21 Aug 2009 22:45:41 +0000 (UTC)"  >Test to show the failure when a _changes filter hits a deleted document</comment>
                    <comment id="12748902" author="jkocherhans" created="Fri, 28 Aug 2009 17:03:51 +0000 (UTC)"  >This was resolved in r808574</comment>
                    <comment id="12748921" author="kocolosk" created="Fri, 28 Aug 2009 17:54:58 +0000 (UTC)"  >Thanks Joseph, sorry I didn&apos;t see this ticket earlier.  I&apos;ll look into incorporating the tests you wrote.</comment>
                </comments>
    
    <attachments>
            <attachment id="12417335" name="change-filter-test.js" size="1977" author="jkocherhans" created="Fri, 21 Aug 2009 22:45:41 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 28 Aug 2009 17:03:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 28 Aug 2009 17:54:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-479] HEAD requests fail with OAuth</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-479</link>

                    <description>Patch and test to follow...</description>
                <environment></environment>
            <key id="12433666">COUCHDB-479</key>
        <summary>HEAD requests fail with OAuth</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Fri, 21 Aug 2009 10:16:25 +0000 (UTC)</created>
    <updated>Sun, 23 Aug 2009 15:04:42 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12745885" author="jasondd" created="Fri, 21 Aug 2009 10:25:09 +0000 (UTC)"  >I hereby grant license to ASF for inclusion in ASF works (as per the Apache License &amp;#xA7;5) for my patch at &lt;a href=&quot;http://friendpaste.com/2eZFpLM2byb1DtwijQxC3t&quot;&gt;http://friendpaste.com/2eZFpLM2byb1DtwijQxC3t&lt;/a&gt; . I have no idea why JIRA is timing out when I attempt to attach it to this ticket.</comment>
                    <comment id="12746615" author="janl" created="Sun, 23 Aug 2009 15:04:42 +0000 (UTC)"  >Applied in r806983 and 0.10.x.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 23 Aug 2009 15:04:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 23 Aug 2009 15:04:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-478] Modify couch_httpd_auth:get_user to read from [admins] in .ini config and fall back to using database</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-478</link>

                    <description>In the future we will make this pluggable (and orderable) but for now I think it is a sensible default to make oauth and cookie auth respect [admins] in the .ini as well as reading users from the database.</description>
                <environment></environment>
            <key id="12433565">COUCHDB-478</key>
        <summary>Modify couch_httpd_auth:get_user to read from [admins] in .ini config and fall back to using database</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Thu, 20 Aug 2009 12:15:10 +0000 (UTC)</created>
    <updated>Sat, 29 Aug 2009 13:47:52 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12745420" author="jasondd" created="Thu, 20 Aug 2009 12:16:37 +0000 (UTC)"  >This patch makes couch_httpd_auth:get_user check for the user in the .ini [admins] section first before falling back to querying the database.  I&apos;ve also modified the oauth test to check that this works.</comment>
                    <comment id="12745594" author="statik" created="Thu, 20 Aug 2009 19:47:48 +0000 (UTC)"  >I think this patch has a typo:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;+     {section: &amp;quot;oauth_token_users&amp;quot;,&lt;br/&gt;
&amp;nbsp;+      key: &amp;quot;bar&amp;quot;, value: &amp;quot;testamdmin&amp;quot;},&lt;br/&gt;
&amp;nbsp;amdmin instead of admin</comment>
                    <comment id="12745604" author="statik" created="Thu, 20 Aug 2009 20:01:30 +0000 (UTC)"  >When running tests in futon against this patch applied to an svn snapshot of svn rev 805910 on ubuntu karmic I get two test failures:&lt;br/&gt;
&lt;br/&gt;
in the replication tests:&lt;br/&gt;
{&amp;quot;message&amp;quot;:&amp;quot;docB is null&amp;quot;,&amp;quot;fileName&amp;quot;:&amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/_utils/script/couch_test_runner.js&quot;&gt;http://127.0.0.1:5984/_utils/script/couch_test_runner.js&lt;/a&gt;&amp;quot;,&amp;quot;lineNumber&amp;quot;:53,&amp;quot;stack&amp;quot;:&amp;quot;([object Object],[object Object])@&lt;a href=&quot;http://127.0.0.1:5984/_utils/script/couch_test_runner.js:53&quot;&gt;http://127.0.0.1:5984/_utils/script/couch_test_runner.js:53&lt;/a&gt;\u000a((void 0))@&lt;a href=&quot;http://127.0.0.1:5984/_utils/script/couch_test_runner.js:66&quot;&gt;http://127.0.0.1:5984/_utils/script/couch_test_runner.js:66&lt;/a&gt;\u000arun(-1)@&lt;a href=&quot;http://127.0.0.1:5984/_utils/script/couch_test_runner.js:78&quot;&gt;http://127.0.0.1:5984/_utils/script/couch_test_runner.js:78&lt;/a&gt;\u000a&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
and in the oauth tests:&lt;br/&gt;
&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode&lt;br/&gt;
# Assertion failed: xhr.status == expectedCode</comment>
                    <comment id="12745966" author="jasondd" created="Fri, 21 Aug 2009 13:32:43 +0000 (UTC)"  >Fixed typo and test in previous patch.</comment>
                    <comment id="12746021" author="jasondd" created="Fri, 21 Aug 2009 15:34:36 +0000 (UTC)"  >Forgot to add X-Couch-Persist: false when deleting a config value.  This also includes my fix for &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-479&quot; title=&quot;HEAD requests fail with OAuth&quot;&gt;&lt;strike&gt;COUCHDB-479&lt;/strike&gt;&lt;/a&gt;.</comment>
                    <comment id="12749136" author="janl" created="Sat, 29 Aug 2009 13:47:52 +0000 (UTC)"  >Applied a fixed version of the patch in r809134 and 0.10.x. </comment>
                </comments>
    
    <attachments>
            <attachment id="12417272" name="oauth_ini_users.2.patch" size="5375" author="jasondd" created="Fri, 21 Aug 2009 13:32:43 +0000 (UTC)" />
            <attachment id="12417279" name="oauth_ini_users.3.patch" size="7292" author="jasondd" created="Fri, 21 Aug 2009 15:34:36 +0000 (UTC)" />
            <attachment id="12417134" name="oauth_ini_users.patch" size="5218" author="jasondd" created="Thu, 20 Aug 2009 12:16:37 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 29 Aug 2009 13:47:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 20 Aug 2009 19:47:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-477] Add database uuid&apos;s</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-477</link>

                    <description>Add a uuid to db_header to distinguish different databases that have the same name (for example, by deleting and creating the same named database).&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12433553">COUCHDB-477</key>
        <summary>Add database uuid&apos;s</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Thu, 20 Aug 2009 09:44:03 +0000 (UTC)</created>
    <updated>Tue, 2 Feb 2010 08:09:12 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12745364" author="rnewson" created="Thu, 20 Aug 2009 09:45:32 +0000 (UTC)"  >&lt;br/&gt;
Add uuid=nil to #db_header, initialize it to a random uuid on creation, return it in db_info blob.&lt;br/&gt;
</comment>
                    <comment id="12745425" author="kocolosk" created="Thu, 20 Aug 2009 12:27:41 +0000 (UTC)"  >This could be quite useful for replication, too, as a way to short-circuit the metadata check between copies of .couch files.</comment>
                    <comment id="12745620" author="jchris" created="Thu, 20 Aug 2009 20:34:20 +0000 (UTC)"  >this patch looks good to me.&lt;br/&gt;
&lt;br/&gt;
+1 on applying it.</comment>
                    <comment id="12828529" author="tilgovi" created="Tue, 2 Feb 2010 08:09:12 +0000 (UTC)"  >New patch and tests.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12406995">COUCHDB-141</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12417120" name="0001-add-uuid-to-database-on-creation-return-it-in-db_in.patch" size="2163" author="rnewson" created="Thu, 20 Aug 2009 09:45:32 +0000 (UTC)" />
            <attachment id="12434511" name="db_uuids.patch" size="4579" author="tilgovi" created="Tue, 2 Feb 2010 08:08:30 +0000 (UTC)" />
            <attachment id="12434510" name="db_uuids.patch" size="4579" author="tilgovi" created="Tue, 2 Feb 2010 08:08:10 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 20 Aug 2009 12:27:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-476] Futon needs to remember rows per page.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-476</link>

                    <description>It would be nice if futon remembered the &amp;quot;rows per page&amp;quot; selection for every time you used it.&lt;br/&gt;
&lt;br/&gt;
This would be trivial to do, by using a cookie.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll look into it after work.</description>
                <environment>*</environment>
            <key id="12433434">COUCHDB-476</key>
        <summary>Futon needs to remember rows per page.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="sthulbourn">Simon Thulbourn</reporter>
            
    <created>Wed, 19 Aug 2009 09:34:47 +0000 (UTC)</created>
    <updated>Wed, 19 Aug 2009 15:32:44 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>        <timeestimate seconds="172800">48h</timeestimate>                    

            <comments>
                    <comment id="12744965" author="djc" created="Wed, 19 Aug 2009 09:39:38 +0000 (UTC)"  >I think we already keep a cookie for recently used databases, so we could just add it to that.</comment>
                    <comment id="12744975" author="sthulbourn" created="Wed, 19 Aug 2009 10:00:47 +0000 (UTC)"  >Yeah, there&apos;s also a cookie for the active design view.</comment>
                    <comment id="12745081" author="sthulbourn" created="Wed, 19 Aug 2009 15:32:44 +0000 (UTC)"  >Here&apos;s a patch that changes it globally for 30 days, but I&apos;m unsure if it&apos;s needed, I found out that futon does this already for a database during a session. I guess I&apos;ve just never noticed it.</comment>
                </comments>
    
    <attachments>
            <attachment id="12417028" name="cookie.diff" size="869" author="sthulbourn" created="Wed, 19 Aug 2009 15:32:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 19 Aug 2009 09:39:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-475] make http.js test Host independant</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-475</link>

                    <description>Currently http.js test Location result based on 127.0.0.1:5984 host rather than using CouchDB.host variable (my bad). Here is a patch to fix it.</description>
                <environment></environment>
            <key id="12433426">COUCHDB-475</key>
        <summary>make http.js test Host independant</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Wed, 19 Aug 2009 07:39:09 +0000 (UTC)</created>
    <updated>Wed, 19 Aug 2009 17:10:00 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12745132" author="janl" created="Wed, 19 Aug 2009 17:10:00 +0000 (UTC)"  >Fixed in r805883.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416991" name="couchdb-share_www_script_test_http_js.patch" size="548" author="benoitc" created="Wed, 19 Aug 2009 07:39:26 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 19 Aug 2009 17:10:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 19 Aug 2009 17:10:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-474] Upgrade MochiWeb dependency</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-474</link>

                    <description>Upgrade the MochiWeb dependency to the latest version in the google code repository.</description>
                <environment></environment>
            <key id="12433342">COUCHDB-474</key>
        <summary>Upgrade MochiWeb dependency</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 18 Aug 2009 16:08:05 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 17:04:02 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12772420" author="sendtopms" created="Mon, 2 Nov 2009 04:57:01 +0000 (UTC)"  >I wanted to use my mochiweb based app along with couchdb (embedded) mode. Since my app depend on r110 mochiweb but couchdb is broken on r110. Is it possible to push is it soon or do you have workaround or patch?</comment>
                    <comment id="12781004" author="kocolosk" created="Sat, 21 Nov 2009 17:04:02 +0000 (UTC)"  >Upgraded to mochiweb r113 in r882941.  That commit also allows us to work with stock mochijson2, which provides hooks that let us translate Objects from the {struct, proplist()} format to our own {proplist()} format.  Yay for fewer forks!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:04:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 04:57:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-473] erlang_views.js (and other tests) not installed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-473</link>

                    <description>erlang_views.js test is not installed, and it looks like two others are missing too.&lt;br/&gt;
&lt;br/&gt;
$ sudo make install | grep erlang_view&lt;br/&gt;
$ ls /usr/local/share/couchdb/www/script/test | wc -l&lt;br/&gt;
53&lt;br/&gt;
$ ls share/www/script/test | wc -l&lt;br/&gt;
56&lt;br/&gt;
$ ls share/www/script/test &amp;gt;/tmp/a&lt;br/&gt;
$ ls /usr/local/share/couchdb/www/script/test &amp;gt;/tmp/b&lt;br/&gt;
$ diff -u /tmp/a /tmp/b&lt;br/&gt;
--- /tmp/a	2009-08-18 14:30:00.000000000 +0100&lt;br/&gt;
+++ /tmp/b	2009-08-18 14:30:10.000000000 +0100&lt;br/&gt;
@@ -17,10 +17,8 @@&lt;br/&gt;
&amp;nbsp;design_docs.js&lt;br/&gt;
&amp;nbsp;design_options.js&lt;br/&gt;
&amp;nbsp;design_paths.js&lt;br/&gt;
-erlang_views.js&lt;br/&gt;
&amp;nbsp;etags_head.js&lt;br/&gt;
&amp;nbsp;etags_views.js&lt;br/&gt;
-form_submit.js&lt;br/&gt;
&amp;nbsp;invalid_docids.js&lt;br/&gt;
&amp;nbsp;jsonp.js&lt;br/&gt;
&amp;nbsp;large_docs.js&lt;br/&gt;
@@ -32,7 +30,6 @@&lt;br/&gt;
&amp;nbsp;oauth.js&lt;br/&gt;
&amp;nbsp;purge.js&lt;br/&gt;
&amp;nbsp;recreate_doc.js&lt;br/&gt;
-reduce_builtin.js&lt;br/&gt;
&amp;nbsp;reduce_false.js&lt;br/&gt;
&amp;nbsp;reduce.js&lt;br/&gt;
&amp;nbsp;replication.js&lt;br/&gt;
&lt;br/&gt;
I think this problem has occurred before. Ideally it would be good if loadScript() were able to raise an error, but I don&apos;t know if that&apos;s possible.&lt;br/&gt;
&lt;br/&gt;
Furthermore: even after fixing this, &amp;quot;form_submit&amp;quot; doesn&apos;t appear in the test suite, but there is a &amp;quot;form_upload&amp;quot; test. This appears to be just a naming inconsistency.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>git f6c359e412ae3793de363ce23fdf34a09fd7107d&lt;br/&gt;
git-svn-id: &lt;a href=&quot;http://svn.apache.org/repos/asf/couchdb/trunk@805340&quot;&gt;http://svn.apache.org/repos/asf/couchdb/trunk@805340&lt;/a&gt; 13f79535-47bb-0310-9956-ffa450edef68</environment>
            <key id="12433331">COUCHDB-473</key>
        <summary>erlang_views.js (and other tests) not installed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Tue, 18 Aug 2009 13:42:08 +0000 (UTC)</created>
    <updated>Tue, 18 Aug 2009 13:58:55 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12744510" author="janl" created="Tue, 18 Aug 2009 13:58:55 +0000 (UTC)"  >closed in r805416 and r805417.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416874" name="add_missing_tests.diff" size="428" author="candlerb" created="Tue, 18 Aug 2009 13:42:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 13:58:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 13:58:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-472] handle custom CouchdDB welcome page</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-472</link>

                    <description>This change modify behaviour of Welcome handler by allowing admin to customize the welcome page. If content is &amp;quot;application/json&amp;quot; it will send current json object, if not, it will send an html page or redirect to another path.  &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This patch change the confugration string to a tupple {WelcomeMsg, WelcomePage}. WelcomePage could be a string for DocumentRoot where it will find welcome.html page or a tupple {redirect, Url}&lt;br/&gt;
&lt;br/&gt;
Ex if in config you have:&lt;br/&gt;
/ = {couch_httpd_misc_handlers, handle_welcome_req, {&amp;lt;&amp;lt;&amp;quot;Welcome&amp;quot;&amp;gt;&amp;gt;, &amp;quot;/usr/local/share/couchdb/www&amp;quot;}}&lt;br/&gt;
&lt;br/&gt;
If Accept content is application/json Couchdb will send :&lt;br/&gt;
&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
If other it will send welcome.html.&lt;br/&gt;
&lt;br/&gt;
if you replace &amp;quot;/usr/local/share/couchdb/www&amp;quot; by {redirect, &amp;lt;&amp;lt;&amp;quot;/_utils&amp;quot;&amp;gt;&amp;gt;}&amp;#xA0;user will be redirected on futon.</description>
                <environment></environment>
            <key id="12433329">COUCHDB-472</key>
        <summary>handle custom CouchdDB welcome page</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 18 Aug 2009 13:19:12 +0000 (UTC)</created>
    <updated>Thu, 17 Dec 2009 00:41:14 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12744495" author="benoitc" created="Tue, 18 Aug 2009 13:19:44 +0000 (UTC)"  >the patch</comment>
                    <comment id="12744498" author="benoitc" created="Tue, 18 Aug 2009 13:21:18 +0000 (UTC)"  >screenshot of default html welcome page</comment>
                    <comment id="12744502" author="benoitc" created="Tue, 18 Aug 2009 13:43:58 +0000 (UTC)"  >New version of the patch. It put back the old behaviour (json on frontpage) as default while keeping new feature.&lt;br/&gt;
&lt;br/&gt;
So config could be :&lt;br/&gt;
&lt;br/&gt;
/ = {couch_httpd_misc_handlers, handle_welcome_req, &amp;lt;&amp;lt;&amp;quot;Welcome&amp;quot;&amp;gt;&amp;gt;}, the default &lt;br/&gt;
&lt;br/&gt;
or&lt;br/&gt;
&lt;br/&gt;
/ = {couch_httpd_misc_handlers, handle_welcome_req, {&amp;lt;&amp;lt;&amp;quot;Welcome&amp;quot;&amp;gt;&amp;gt;, &amp;quot;/Users/benoitc/work/couchdb/share/www&amp;quot;}} , display an html page when Accept header isn&apos;t &amp;quot;application/json&amp;quot;&lt;br/&gt;
&lt;br/&gt;
or &lt;br/&gt;
&lt;br/&gt;
/ = {couch_httpd_misc_handlers, handle_welcome_req, {&amp;lt;&amp;lt;&amp;quot;Welcome&amp;quot;&amp;gt;&amp;gt;, {redirect &amp;quot;/somepath&amp;quot;}}} , to redirect to /somepath when Accept header isn&apos;t &amp;quot;application/json&amp;quot;</comment>
                    <comment id="12744504" author="benoitc" created="Tue, 18 Aug 2009 13:46:08 +0000 (UTC)"  >mmm better patch. I mixed two changes in last one. sorry.</comment>
                    <comment id="12772670" author="kocolosk" created="Mon, 2 Nov 2009 20:39:58 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12425128">COUCHDB-348</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12416872" name="couchdb_welcome.patch" size="5002" author="benoitc" created="Tue, 18 Aug 2009 13:19:44 +0000 (UTC)" />
            <attachment id="12416875" name="couchdb_welcome2.patch" size="8769" author="benoitc" created="Tue, 18 Aug 2009 13:43:58 +0000 (UTC)" />
            <attachment id="12416876" name="couchdb_welcome3.patch" size="4160" author="benoitc" created="Tue, 18 Aug 2009 13:46:08 +0000 (UTC)" />
            <attachment id="12416873" name="screenshot.png" size="121312" author="benoitc" created="Tue, 18 Aug 2009 13:21:18 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:39:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-471] make distcheck fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-471</link>

                    <description>make[2]: *** No rule to make target `local.ini&apos;, needed by `distdir&apos;.  Stop.&lt;br/&gt;
make[1]: *** [distdir] Error 1&lt;br/&gt;
make: *** [distdir] Error 1&lt;br/&gt;
</description>
                <environment>Mac OS X</environment>
            <key id="12433281">COUCHDB-471</key>
        <summary>make distcheck fails</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 18 Aug 2009 02:08:52 +0000 (UTC)</created>
    <updated>Tue, 18 Aug 2009 23:28:17 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12744354" author="paul.joseph.davis" created="Tue, 18 Aug 2009 04:31:35 +0000 (UTC)"  >Fixed in r805272.&lt;br/&gt;
&lt;br/&gt;
Looking into this [1] I found that the reason that this was failing (after fixing license checks) was due to VPATH builds [2]. Specifically in how a couple of the targets weren&apos;t using magic variables when building targets. See [3] and more specifically [4] for the solutions. Ended up rejiggering a couple things to avoid paths when building targets.&lt;br/&gt;
&lt;br/&gt;
Note to Noah, make distcheck was wanting to call make dev targets and was then failing when trying to create the tmp/ directory structure. I removed the $(top_srcdir) and made the directories local to the current directory. You&apos;ll probably yell at me about this, but it made things work and seemed to fit best with what I read about VPATH builds.&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://www.gnu.org/software/automake/manual/html_node/Checking-the-Distribution.html#Checking-the-Distribution&quot;&gt;http://www.gnu.org/software/automake/manual/html_node/Checking-the-Distribution.html#Checking-the-Distribution&lt;/a&gt;&lt;br/&gt;
[2] &lt;a href=&quot;http://www.gnu.org/software/automake/manual/html_node/VPATH-Builds.html#VPATH-Builds&quot;&gt;http://www.gnu.org/software/automake/manual/html_node/VPATH-Builds.html#VPATH-Builds&lt;/a&gt;&lt;br/&gt;
[3] &lt;a href=&quot;http://www.gnu.org/software/automake/manual/make/General-Search.html#General-Search&quot;&gt;http://www.gnu.org/software/automake/manual/make/General-Search.html#General-Search&lt;/a&gt;&lt;br/&gt;
[4] &lt;a href=&quot;http://www.gnu.org/software/automake/manual/make/Commands_002fSearch.html#Commands_002fSearch&quot;&gt;http://www.gnu.org/software/automake/manual/make/Commands_002fSearch.html#Commands_002fSearch&lt;/a&gt;</comment>
                    <comment id="12744412" author="benoitc" created="Tue, 18 Aug 2009 08:19:15 +0000 (UTC)"  >make distcheck fails on OpenBSD :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://friendpaste.com/7KzkVvIq15fza5xP1iucHf&quot;&gt;http://friendpaste.com/7KzkVvIq15fza5xP1iucHf&lt;/a&gt; </comment>
                    <comment id="12744453" author="benoitc" created="Tue, 18 Aug 2009 10:53:06 +0000 (UTC)"  >attached diff suggested by jan fix previous error. But now I get following error :&lt;br/&gt;
&lt;br/&gt;
gmake[5]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/etc&apos;&lt;br/&gt;
gmake[4]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/etc&apos;&lt;br/&gt;
gmake[3]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/etc&apos;&lt;br/&gt;
gmake[2]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/etc&apos;&lt;br/&gt;
Making install in src/couchdb&lt;br/&gt;
gmake[2]: Entering directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/src/couchdb&apos;&lt;br/&gt;
Making install in priv&lt;br/&gt;
gmake[3]: Entering directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/src/couchdb/priv&apos;&lt;br/&gt;
gmake[4]: Entering directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/src/couchdb/priv&apos;&lt;br/&gt;
gmake[4]: Nothing to be done for `install-exec-am&apos;.&lt;br/&gt;
test -z &amp;quot;/priv&amp;quot; || /bin/sh /home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/build-aux/install-sh -d &amp;quot;/priv&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;/bin/sh ../../../libtool --mode=install /usr/bin/install -c &apos;couchspawnkillable&apos; &apos;/priv/couchspawnkillable&apos;&lt;br/&gt;
/usr/bin/install -c couchspawnkillable /priv/couchspawnkillable&lt;br/&gt;
install: /priv/couchspawnkillable: Permission denied&lt;br/&gt;
gmake[4]: *** [install-couchprivPROGRAMS] Error 1&lt;br/&gt;
gmake[4]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/src/couchdb/priv&apos;&lt;br/&gt;
gmake[3]: *** [install-am] Error 2&lt;br/&gt;
gmake[3]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/src/couchdb/priv&apos;&lt;br/&gt;
gmake[2]: *** [install-recursive] Error 1&lt;br/&gt;
gmake[2]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build/src/couchdb&apos;&lt;br/&gt;
gmake[1]: *** [install-recursive] Error 1&lt;br/&gt;
gmake[1]: Leaving directory `/home/benoitc/tmp/couchdb/apache-couchdb-0.10.0a805351/_build&apos;&lt;br/&gt;
gmake: *** [distcheck] Error 2&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12744503" author="janl" created="Tue, 18 Aug 2009 13:45:17 +0000 (UTC)"  >Fixed again in r805410.</comment>
                    <comment id="12744509" author="nslater" created="Tue, 18 Aug 2009 13:55:42 +0000 (UTC)"  >Paul, please re-add $(top_srcdir) to the Makefile.am as this is required when people are building outside of the source tree.&lt;br/&gt;
&lt;br/&gt;
I was told to add this directly by some gurus on the Automake lists.</comment>
                    <comment id="12744555" author="paul.joseph.davis" created="Tue, 18 Aug 2009 15:29:15 +0000 (UTC)"  >Noah, the thing with $(top_srcdir) is that if you do a VPATH build then you end up creating the tmp directory structure in the src tree and not the build tree. make distcheck adjusts file permissions to prevent writing by the build process and this step fails. So is it possible to use $(top_builddir) or just prevent make dev from running durring distcheck?</comment>
                    <comment id="12744621" author="nslater" created="Tue, 18 Aug 2009 17:56:38 +0000 (UTC)"  >$(top_builddir) should be fine.</comment>
                    <comment id="12744778" author="paul.joseph.davis" created="Tue, 18 Aug 2009 23:28:17 +0000 (UTC)"  >$(top_builddir) added. Done and done.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416860" name="couchdb-licence_skip.patch" size="480" author="benoitc" created="Tue, 18 Aug 2009 10:53:06 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 04:31:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 04:31:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-470] Include peer in req object for lists, shows and updates</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-470</link>

                    <description>Simple one-liner. Useful for statistical tracking or any kind of IP-based switching.</description>
                <environment></environment>
            <key id="12433246">COUCHDB-470</key>
        <summary>Include peer in req object for lists, shows and updates</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Mon, 17 Aug 2009 16:17:00 +0000 (UTC)</created>
    <updated>Wed, 23 Sep 2009 23:17:36 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12758924" author="jasondd" created="Wed, 23 Sep 2009 23:17:36 +0000 (UTC)"  >Fixed in r818316.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416779" name="couch_httpd_external.peer.patch" size="602" author="jasondd" created="Mon, 17 Aug 2009 16:17:28 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 23 Sep 2009 23:17:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-469] INSTALL file missing</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-469</link>

                    <description>&amp;gt; pwd&lt;br/&gt;
~/Work/couchdb/trunk &lt;br/&gt;
&amp;gt; grep INSTALL README&lt;br/&gt;
More options can be found by reading the `INSTALL` file.&lt;br/&gt;
&amp;gt; ls INSTALL&lt;br/&gt;
ls: INSTALL: No such file or directory&lt;br/&gt;
&amp;gt;&lt;br/&gt;
</description>
                <environment>any</environment>
            <key id="12433187">COUCHDB-469</key>
        <summary>INSTALL file missing</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sun, 16 Aug 2009 16:27:30 +0000 (UTC)</created>
    <updated>Sun, 16 Aug 2009 16:27:30 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-468] POST with _id</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-468</link>

                    <description>From -dev:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Is there any reason why, if you POST a document to a database and that document has an &amp;quot;_id&amp;quot; member, why this is ignored and a server-generated _id is used instead?&amp;quot;&lt;br/&gt;
&lt;br/&gt;
To which the general consensus was &amp;quot;no&amp;quot;.  Issue opened so jchris need not worry about &amp;quot;this thread being lost to the sands of time.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12433142">COUCHDB-468</key>
        <summary>POST with _id</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Sat, 15 Aug 2009 07:04:47 +0000 (UTC)</created>
    <updated>Sun, 16 Aug 2009 03:08:01 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12743566" author="jchris" created="Sat, 15 Aug 2009 08:05:43 +0000 (UTC)"  >hehe. thanks Mark.&lt;br/&gt;
&lt;br/&gt;
One of the lessons I&apos;ve learned from Damien is that to get people involved in a project, you have to be willing to let work go undone, so new people have a place to jump in.&lt;br/&gt;
&lt;br/&gt;
That said, implementing this would be a good way to learn hacking on CouchDB, for anyone with an interest in it.&lt;br/&gt;
&lt;br/&gt;
If you are interested, leave a comment here and we can maybe give you guidance on how to proceed.</comment>
                    <comment id="12743803" author="paul.joseph.davis" created="Sun, 16 Aug 2009 03:08:01 +0000 (UTC)"  >Fixed as of r804555.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 16 Aug 2009 03:08:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 15 Aug 2009 08:05:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-467] 500 error when accessing &quot;not found&quot; old revisions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-467</link>

                    <description>The full error is {{not_found,missing}, {&amp;lt;pos&amp;gt;, &amp;lt;revkey&amp;gt;} and a 500 code is returned because there is no pattern in error_info(...) for this.</description>
                <environment></environment>
            <key id="12433062">COUCHDB-467</key>
        <summary>500 error when accessing &quot;not found&quot; old revisions</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Fri, 14 Aug 2009 10:30:04 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 19:58:28 +0000 (UTC)</updated>

                
                        <fixVersion>0.10.1</fixVersion>
                    <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12743166" author="jasondd" created="Fri, 14 Aug 2009 10:31:05 +0000 (UTC)"  >This patch adds a pattern for {{not_found, Reason}, _} to error_info(...) so that a 404 is returned for old revs that are missing.</comment>
                    <comment id="12772627" author="kocolosk" created="Mon, 2 Nov 2009 19:58:28 +0000 (UTC)"  >Fixed in r829919 (trunk/0.11) and r829924 (0.10.1 backport).  Didn&apos;t end up applying the error_info patch, instead changed the format of the thrown error.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416550" name="old_revs_404.patch" size="517" author="jasondd" created="Fri, 14 Aug 2009 10:31:05 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 19:58:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 19:58:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-466] couchdb oauth doesn&apos;t work behind reverse proxy</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-466</link>

                    <description>Currently oauth doesn&apos;t work behind a reverse proxy because signature is based on Host. Reverse proxy like apache, lighttpd pass to the proxied server some header that help him to know which host is forwared. Apache send X-Forwarded-For, Lighttpd X-Host, ....&lt;br/&gt;
&lt;br/&gt;
Patch attached fix this issue by testing if a custom forwarded host header is present and use it as Host. If it isn&apos;t present it will use Host header of fallback on socket detection like it is currently. All tests pass.</description>
                <environment></environment>
            <key id="12433013">COUCHDB-466</key>
        <summary>couchdb oauth doesn&apos;t work behind reverse proxy</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Thu, 13 Aug 2009 17:33:38 +0000 (UTC)</created>
    <updated>Tue, 18 Aug 2009 17:11:23 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12744314" author="janl" created="Tue, 18 Aug 2009 00:58:27 +0000 (UTC)"  >I want to apply this before 0.10, but not tonight. Set to blocking.</comment>
                    <comment id="12744547" author="janl" created="Tue, 18 Aug 2009 15:24:56 +0000 (UTC)"  >Benoit, can you add a javascript test?</comment>
                    <comment id="12744582" author="benoitc" created="Tue, 18 Aug 2009 16:19:23 +0000 (UTC)"  >patch with typo fixed and js test.</comment>
                    <comment id="12744605" author="janl" created="Tue, 18 Aug 2009 17:11:23 +0000 (UTC)"  >fixed the tests:&lt;br/&gt;
&amp;nbsp;- wrapped config changes in run_on_modified_server&lt;br/&gt;
&amp;nbsp;- wrap lines at 80 chars&lt;br/&gt;
&amp;nbsp;- use TEquals() instead of T()&lt;br/&gt;
&lt;br/&gt;
Applied in r805500.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416883" name="forwarded_for2.patch" size="3773" author="benoitc" created="Tue, 18 Aug 2009 16:19:23 +0000 (UTC)" />
            <attachment id="12416466" name="x_forwarded_host.diff" size="1047" author="benoitc" created="Thu, 13 Aug 2009 17:34:18 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 17:11:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 00:58:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-465] Produce sequential, but unique, document id&apos;s</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-465</link>

                    <description>Currently, if the client does not specify an id (POST&apos;ing a single document or using _bulk_docs) a random 16 byte value is created. This kind of key is particularly brutal on b+tree updates and the append-only nature of couchdb files.&lt;br/&gt;
&lt;br/&gt;
Attached is a patch to change this to a two-part identifier. The first part is a random 12 byte value and the remainder is a counter. The random prefix is rerandomized when the counter reaches its maximum. The rollover in the patch is at 16 million but can obviously be changed. The upshot is that the b+tree is updated in a better fashion, which should lead to performance benefits.</description>
                <environment></environment>
            <key id="12433005">COUCHDB-465</key>
        <summary>Produce sequential, but unique, document id&apos;s</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Thu, 13 Aug 2009 16:04:25 +0000 (UTC)</created>
    <updated>Wed, 9 Sep 2009 17:00:40 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742907" author="kocolosk" created="Thu, 13 Aug 2009 18:02:09 +0000 (UTC)"  >Nice work, Robert!  I&apos;m +1 on this patch.&lt;br/&gt;
&lt;br/&gt;
One concern is the guessability of IDs, but if users are really concerned about that they can always generate their own.</comment>
                    <comment id="12742911" author="rnewson" created="Thu, 13 Aug 2009 18:10:31 +0000 (UTC)"  >Thanks!&lt;br/&gt;
&lt;br/&gt;
Guessability is a concern, which means this might need to be switchable. Perhaps couch_seq_generator becomes couch_id_generator and an ini file chooses between the two strategies, defaulting to the safest, but worst-case, new_uuid behavior. To get good keys for b+tree insertion necessarily makes them more guessable as they&apos;d have to be close to existing keys by design.&lt;br/&gt;
&lt;br/&gt;
I do owe some quantitative benchmarking to support the assertions in the description. I did a 10k insertion test with a small document, {content: &amp;quot;hello&amp;quot;}, and average insertion rate per document was 2ms with random and 1ms with the patch. This was more to prove that I&apos;d changed *something* rather than a measure of the actual improvement. I would expect to see improved insertion rates across a lot of scenarios, less difference between uncompacted and compacted size (barring document updates and deletes) as less of the b+tree is rewritten, and a smaller post-compaction size vs random. The exact extent of these improvements should be established by a decent benchmark. &lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12742970" author="candlerb" created="Thu, 13 Aug 2009 21:14:17 +0000 (UTC)"  >&lt;br/&gt;
I&apos;d like to suggest an alternative algorithm for consideration.&lt;br/&gt;
&lt;br/&gt;
- first 48 bits of the UUID is the time, in milliseconds, since 1 Jan 1970&lt;br/&gt;
&lt;br/&gt;
- remaining 80 bits starts as a random value and increments from there,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;for example when doing a _bulk_docs insert (*)&lt;br/&gt;
&lt;br/&gt;
I have been using this algorithm for a while, generated client-side - it&apos;s&lt;br/&gt;
in my &apos;couchtiny&apos; ruby client.&lt;br/&gt;
&lt;br/&gt;
I did it this way so as to get monotonically-increasing doc ids; a view with&lt;br/&gt;
equal keys will sort them in order of insertion into the DB. It also avoids&lt;br/&gt;
having to keep a separate &amp;quot;created_at&amp;quot; timestamp field, because you can just&lt;br/&gt;
get it from the id.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;def created_at&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Time.at(id[0,12].to_i(16) / 1000.0) rescue nil&lt;br/&gt;
&amp;nbsp;&amp;nbsp;end&lt;br/&gt;
&lt;br/&gt;
Of course, the fact I generate uids like this demonstrates that there&apos;s no&lt;br/&gt;
one-size-fits-all solution, but I just thought it was worth mentioning&lt;br/&gt;
because you should get the B-tree insertion boost as a side-effect too.&lt;br/&gt;
&lt;br/&gt;
Regards,&lt;br/&gt;
&lt;br/&gt;
Brian.&lt;br/&gt;
&lt;br/&gt;
(*) It&apos;s your choice whether you want to re-randomize this when the next&lt;br/&gt;
millisecond comes along, or just leave it to increment as a serial number.&lt;br/&gt;
Even if you have multiple servers inserting documents into the same&lt;br/&gt;
database, the chances of them using the same serial number within the same&lt;br/&gt;
millisecond are infinitessimal, as long as they all start from an&lt;br/&gt;
independent random point within the 2^80 possibilities.&lt;br/&gt;
&lt;br/&gt;
Wrapping would be very rare, but what I currently do is re-randomize for&lt;br/&gt;
each bulk insert, and choose a starting random value which is more than 2^32&lt;br/&gt;
away from the ceiling.&lt;br/&gt;
</comment>
                    <comment id="12742982" author="rnewson" created="Thu, 13 Aug 2009 21:28:41 +0000 (UTC)"  >&lt;br/&gt;
Another interesting algorithm. I could change the patch so there&apos;s a couch_id_generator where the algorithm is configurable, defaulting to the current one, if that would move things along?&lt;br/&gt;
</comment>
                    <comment id="12743009" author="rnewson" created="Thu, 13 Aug 2009 22:59:37 +0000 (UTC)"  >&lt;br/&gt;
I renamed couch_seq_generator to couch_uuid_generator. It supports two algorithms; the original random one and the new random+sequential. It defaults to random.&lt;br/&gt;
&lt;br/&gt;
To configure you need a new ini block;&lt;br/&gt;
&lt;br/&gt;
[uuid]&lt;br/&gt;
algorithm=(random|sequence)&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12743029" author="wohali" created="Fri, 14 Aug 2009 00:01:40 +0000 (UTC)"  >This is a great patch, and solves the problem of having to do it in client-side logic. +1 from me too!&lt;br/&gt;
&lt;br/&gt;
It looks like Brian&apos;s solution above is intended to allow _all_docs to return all documents in chronological order, thus getting a time-sorted view &amp;quot;for free,&amp;quot; i.e. without an extra field per document, extra view to maintain and update, extra view storage on the disk, etc. I admit I did the same for myself ;) but it isn&apos;t necessarily a consideration for everyone. For example, in a replication situation, you&apos;d need to be sure your clocks were well synchronized, and that you didn&apos;t have collisions in the prefix portion.&lt;br/&gt;
&lt;br/&gt;
Perhaps providing a mechanism to declare your own algorithm to override one of the two defaults (random, or rnewson&apos;s) would indeed be the best way forward, and the wiki could have a HOWTO with a set of small recipes on alternative approaches?</comment>
                    <comment id="12743049" author="paul.joseph.davis" created="Fri, 14 Aug 2009 01:12:13 +0000 (UTC)"  >Just to throw something out in the interest of complicating things, should we consider a query string override the configured default algorithm as well?</comment>
                    <comment id="12743077" author="jchris" created="Fri, 14 Aug 2009 04:49:23 +0000 (UTC)"  >we may want to add a node identifier if we want to avoid collisions between replicating nodes.&lt;br/&gt;
&lt;br/&gt;
this is starting to sound a lot like UUID v1, which handles all these edge cases.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://en.wikipedia.org/wiki/Universally_Unique_Identifier#Version_1_.28MAC_address.29&quot;&gt;http://en.wikipedia.org/wiki/Universally_Unique_Identifier#Version_1_.28MAC_address.29&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;m generally +1 for this patch and the ideas it&apos;s generating. I&apos;d say let&apos;s not apply until after the 0.10 branch</comment>
                    <comment id="12743144" author="rnewson" created="Fri, 14 Aug 2009 09:09:01 +0000 (UTC)"  >I think the odds of generating the same random 12 byte value preclude collisions with enough probability. A MAC address is 48 bits whereas this prefix is 96 bits. The issue with UUID v1 is that it includes the time. The precision of the system clock could become the limiting factor in id generation. The exact algorithm for v1 is not well-specified either.&lt;br/&gt;
&lt;br/&gt;
To say it another way, the 96 random bits at the front are the (temporary) node identifier. &lt;br/&gt;
</comment>
                    <comment id="12743879" author="rnewson" created="Sun, 16 Aug 2009 19:03:56 +0000 (UTC)"  >&lt;br/&gt;
Updated to match latest trunk. Also increment between id&apos;s is a small random number (rather than always 1) to make identifiers less guessable.</comment>
                    <comment id="12744332" author="jchris" created="Tue, 18 Aug 2009 02:11:00 +0000 (UTC)"  >Good patch, thanks for the work.&lt;br/&gt;
&lt;br/&gt;
Code feedback:&lt;br/&gt;
&lt;br/&gt;
I think couch_util:new_uuid should be pulled into the couch_uuid_generator module&lt;br/&gt;
&lt;br/&gt;
Also, the uuid_generator should use the same config and couch_config:register idioms that are used by other modules. This should be more performant as the couch_config lookup will only happen rarely, instead of on every call.&lt;br/&gt;
&lt;br/&gt;
The randomness algorithm should be fine. As long at it is constantly ascending or descending (even with largish jumps) we should be fine.</comment>
                    <comment id="12744448" author="rnewson" created="Tue, 18 Aug 2009 10:26:59 +0000 (UTC)"  >&lt;br/&gt;
Use couch_config:register and a refactoring of handle_call.&lt;br/&gt;
</comment>
                    <comment id="12744457" author="rnewson" created="Tue, 18 Aug 2009 11:16:01 +0000 (UTC)"  >&lt;br/&gt;
Updated to switch the _uuids misc handler to the server-selected uuid generation algorithm.</comment>
                    <comment id="12744559" author="rnewson" created="Tue, 18 Aug 2009 15:36:52 +0000 (UTC)"  >&lt;br/&gt;
changed [uuid] config to [uuid_generation]&lt;br/&gt;
changed sequence to sequential&lt;br/&gt;
made sequential the default&lt;br/&gt;
fixed rollover to use all bits of counter suffix&lt;br/&gt;
</comment>
                    <comment id="12745323" author="paul.joseph.davis" created="Thu, 20 Aug 2009 06:34:32 +0000 (UTC)"  >Refactored a bit.&lt;br/&gt;
couch_uuid_generator -&amp;gt; couch_uuids&lt;br/&gt;
sequential -&amp;gt; hybrid (this was mostly playing, thoughts?)&lt;br/&gt;
random is back to default and should stay that way&lt;br/&gt;
call to random:uniform() -&amp;gt; crypto:rand_uniform() (someone forgot to call random:seed(), tsk tsk :)&lt;br/&gt;
[uuid_generator] -&amp;gt; [uuids] in config&lt;br/&gt;
added short description of choices next to option&lt;br/&gt;
probably an unneccessary optimization to allow for couch_uuids:new(N) to return N ids.&lt;br/&gt;
added simple checks to the uuids.js Futon tests&lt;br/&gt;
Pulled in a contribution by Bob Dionne for etap tests.&lt;br/&gt;
All calls to couch_util:new_uuid() are replaced with couch_uuuids:random()&lt;br/&gt;
&lt;br/&gt;
We should make the prefix length a configuration parameter I think.&lt;br/&gt;
&lt;br/&gt;
We might also think about adding Brian&apos;s algorithm for more diversity as well.</comment>
                    <comment id="12745347" author="paul.joseph.davis" created="Thu, 20 Aug 2009 08:17:33 +0000 (UTC)"  >Added the utc_random algorithm.&lt;br/&gt;
Updated tests to use it.&lt;br/&gt;
hybrid -&amp;gt; sequential&lt;br/&gt;
unoptimized the calling to return a list for code cleanliness.&lt;br/&gt;
</comment>
                    <comment id="12745352" author="paul.joseph.davis" created="Thu, 20 Aug 2009 08:22:09 +0000 (UTC)"  >Used byte numbers when I mean characters in default.ini.tpl.in</comment>
                    <comment id="12745355" author="paul.joseph.davis" created="Thu, 20 Aug 2009 08:25:37 +0000 (UTC)"  >Chris,&lt;br/&gt;
&lt;br/&gt;
You&apos;re the only person I&apos;ve seen with any wavering on this going in. Is there a reason you want to wait on it? I did push it back so that the default behavior is still the random 128 bits if that was a worry.&lt;br/&gt;
&lt;br/&gt;
Paul</comment>
                    <comment id="12745356" author="antonyblakey" created="Thu, 20 Aug 2009 08:38:53 +0000 (UTC)"  >I remember a discussion about assigning a UUID to a database to allow external view providesr to more reliably associate indexing artifacts with a given db instance (given that names can be duplicated over a create/delete/create boundary). I suggested that this could be used in document ids (and revids) and the response was that this was a privacy risk because the originating database&apos;s identity would leak into the peer group. It seems that this proposal has the same characteristic because you can identify the common source of a set of documents. Is this no longer a concern? If not, then how about revisiting the idea of assigning each database a UUID on creation, and using that UUID as a document identity prefix?</comment>
                    <comment id="12745357" author="paul.joseph.davis" created="Thu, 20 Aug 2009 08:51:30 +0000 (UTC)"  >Antony,&lt;br/&gt;
&lt;br/&gt;
The sequential algorithm uses a 13 byte random prefix coupled with a 3 byte random suffix. Each new uuid is incremented by a small random number. When the three bytes overflows a new random prefix is generated. Now the privacy concern is that two docs could&apos;ve been created by the same node but its not tied directly to a db file.&lt;br/&gt;
&lt;br/&gt;
I&apos;d definitely be +1 for having a UUID in the db header for other reasons though.&lt;br/&gt;
&lt;br/&gt;
Paul</comment>
                    <comment id="12745358" author="rnewson" created="Thu, 20 Aug 2009 08:58:47 +0000 (UTC)"  >&lt;br/&gt;
I like most of Paul&apos;s changes though I thought we&apos;d agreed on IRC to change the default to sequential and I&apos;d still like to see that happen.&lt;br/&gt;
&lt;br/&gt;
I would also like to see a way to detect very quick delete/create scenarios, though I don&apos;t know if database uuids are the only solution there. If a global _changes feed would emit &amp;quot;deleted&amp;quot; and &amp;quot;created&amp;quot; events for databases in the correct order, then couchdb-lucene could work correctly without database uuids.&lt;br/&gt;
&lt;br/&gt;
Antony&apos;s suggestion of a fourth algorithm, where the prefix is completely static, is simple enough to add. This patch allows the deployer to decide how much he cares about predictability and server origin, so I don&apos;t see a reason not to add it. It is distinct from the sequential algorithm, though. The prefix there is only used for around 8000 ids and is then never reused, there is also no correlation between prefix and origin server.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12745396" author="dionne" created="Thu, 20 Aug 2009 11:25:52 +0000 (UTC)"  >I tested this all against a clean checkout of trunk and it looks good. The new algorithm is faster on inserts[1] but interestingly for single inserts is makes for a larger db pre-compact. After compaction the db is smaller by a factor of 3 &lt;br/&gt;
&lt;br/&gt;
I thought we leave the new &amp;quot;sequentially random&amp;quot; as the default? Paul, is the concern just what&apos;s advertised to users? &lt;br/&gt;
&lt;br/&gt;
Algorithms based on the system clock I think can be problematic as they assume all machines have the correct time. &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://gist.github.com/170982&quot;&gt;http://gist.github.com/170982&lt;/a&gt;</comment>
                    <comment id="12745402" author="rnewson" created="Thu, 20 Aug 2009 11:38:53 +0000 (UTC)"  >&lt;br/&gt;
The utc_random has that issue which is why it&apos;s not the default. I don&apos;t think it would make sense to choose utc_random unless you had already planned to keep your clocks pretty accurately synced. Brian&apos;s point, I&apos;m implying, is that since he *can* arrange that, then if the ids used the clock time he&apos;ll get a nice ordering for identifiers for free. Anyone running couchdb in a data center could feasibly arrange for ntp synchronization, so I think it&apos;s a nice option for those that understand the consequences.</comment>
                    <comment id="12745403" author="rnewson" created="Thu, 20 Aug 2009 11:42:17 +0000 (UTC)"  >&lt;br/&gt;
I just noticed that Paul&apos;s implementation is not as Brian described; the suffix is always random with no guarantee the id N+1 is strictly higher than id N;&lt;br/&gt;
&lt;br/&gt;
+    list_to_binary(Prefix ++ couch_util:to_hex(crypto:rand_bytes(9))).&lt;br/&gt;
&lt;br/&gt;
In practise it just means that id&apos;s generated in the same millisecond are randomly ordered. Does that matter?</comment>
                    <comment id="12745429" author="rnewson" created="Thu, 20 Aug 2009 12:39:42 +0000 (UTC)"  >Bob,&lt;br/&gt;
&lt;br/&gt;
I read your gist and the pre-compact size for sequential is smaller than for random (43,144,791 vs 52,517,614) and post-compaction was smaller for sequential too (2,023,522 vs 2,506,850). Perhaps you read the numbers the wrong way around? Or did I? :)&lt;br/&gt;
&lt;br/&gt;
I also note that most of this compaction is from not batching as you&apos;ll have a 4k footer block for each write. With ?batch=ok and sequential (and no deletions) I find compaction to be only a marginal reduction of space.</comment>
                    <comment id="12745438" author="dionne" created="Thu, 20 Aug 2009 13:19:52 +0000 (UTC)"  >Robert,&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;sorry for the confusion, there are 4 tests there, tests 2 and 4 use the old random and the new &amp;quot;sequential random&amp;quot; codes respectively. So I&apos;m comparing:&lt;br/&gt;
&lt;br/&gt;
precompact: 50020852  postcompact: 6099042&lt;br/&gt;
&lt;br/&gt;
to&lt;br/&gt;
&lt;br/&gt;
precompact: 52517614  postcompact: 2506850&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;That&apos;s why I used the phrase &amp;quot;sequentially random&amp;quot;. Sequential in these tests (1 and 3) means 1,2,3....&lt;br/&gt;
&lt;br/&gt;
I agree about the batching, the diffs are almost noise with a batch size of 1000, which is what the compactor uses. &lt;br/&gt;
&lt;br/&gt;
Cheers,&lt;br/&gt;
&lt;br/&gt;
Bob</comment>
                    <comment id="12745458" author="paul.joseph.davis" created="Thu, 20 Aug 2009 15:22:56 +0000 (UTC)"  >For Bob&apos;s comment on times:&lt;br/&gt;
&lt;br/&gt;
The documentation for Erlang&apos;s now() function guarantees that its monotonically increasing so there&apos;s no need for me to force the suffix to be random then +1 as it&apos;ll already be ordered and the extra randomness will help prevent spurious conflicts when replicating.&lt;br/&gt;
&lt;br/&gt;
Yes, clocks can go out of sync but its not critical to have them in sync, and its a non-standard option. And adding a comment in the ini file about time syncing would be just fine.&lt;br/&gt;
&lt;br/&gt;
Regarding the sequential default, I don&apos;t remember anyone convincing me to make it something other than random. Though I may have just forgotten that conversation. I fear that any algorithm beyond completely random is a performance hack and I think that we should force people to consider the consequences when using one.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12745619" author="jchris" created="Thu, 20 Aug 2009 20:32:35 +0000 (UTC)"  >I think the work that has been done has allayed my concerns. I&apos;d suggest making the sequentialish-randomy one  the default.&lt;br/&gt;
&lt;br/&gt;
I think db uuids are their own issue, and are needed for lots of reasons.</comment>
                    <comment id="12745621" author="dionne" created="Thu, 20 Aug 2009 20:36:35 +0000 (UTC)"  >etaps to test the new couch_uuids work of rnewson and davisp. </comment>
                    <comment id="12748196" author="rnewson" created="Wed, 26 Aug 2009 23:08:03 +0000 (UTC)"  >Just capturing that I agree with Paul that random should be the default; his patch adds sufficient documentation for the user to make an informed choice. random uuids generation is the least surprising of the three behaviors, so it heads off interminable &amp;quot;why do my ids look kinda similar?&amp;quot; discussions.&lt;br/&gt;
&lt;br/&gt;
Is this going into 0.11?&lt;br/&gt;
</comment>
                    <comment id="12753146" author="kocolosk" created="Wed, 9 Sep 2009 16:20:38 +0000 (UTC)"  >Yes, this is going into 0.11.  It looks like things have stabilized; is there any reason not to commit it today?</comment>
                    <comment id="12753161" author="kocolosk" created="Wed, 9 Sep 2009 17:00:40 +0000 (UTC)"  >Closing it out.  Nice patch everybody!</comment>
                </comments>
    
    <attachments>
            <attachment id="12417172" name="041-uuid-gen-seq.ini" size="31" author="dionne" created="Thu, 20 Aug 2009 20:36:35 +0000 (UTC)" />
            <attachment id="12417173" name="041-uuid-gen-utc.ini" size="31" author="dionne" created="Thu, 20 Aug 2009 20:36:35 +0000 (UTC)" />
            <attachment id="12417174" name="041-uuid-gen.t" size="3668" author="dionne" created="Thu, 20 Aug 2009 20:36:35 +0000 (UTC)" />
            <attachment id="12417116" name="couch_uuids.patch" size="18003" author="paul.joseph.davis" created="Thu, 20 Aug 2009 08:22:09 +0000 (UTC)" />
            <attachment id="12416881" name="uuid_generator.patch" size="5593" author="rnewson" created="Tue, 18 Aug 2009 15:36:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 9 Sep 2009 17:00:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 13 Aug 2009 18:02:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-464] Allow POST to _log for external processes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-464</link>

                    <description>Add POST support to _log so that external processes can also log to couch.log. This would allow couchdb-lucene (to pick a random example) to log consistently. </description>
                <environment></environment>
            <key id="12432871">COUCHDB-464</key>
        <summary>Allow POST to _log for external processes</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Wed, 12 Aug 2009 12:17:58 +0000 (UTC)</created>
    <updated>Wed, 26 Aug 2009 23:16:51 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742313" author="rnewson" created="Wed, 12 Aug 2009 12:18:39 +0000 (UTC)"  >&lt;br/&gt;
the case clause is remarkably ugly and duplicative. Advice welcome.&lt;br/&gt;
</comment>
                    <comment id="12742317" author="rnewson" created="Wed, 12 Aug 2009 12:30:34 +0000 (UTC)"  >&lt;br/&gt;
Uses 202 (Accepted) instead of 200 and uses 400 with a readable error message if the log level isn&apos;t recognized.</comment>
                    <comment id="12742325" author="rnewson" created="Wed, 12 Aug 2009 12:48:54 +0000 (UTC)"  >&lt;br/&gt;
back to 200 for success. 202 implies an asynchronous handling of the request, and it isn&apos;t quite. While the log message is not fsynced to disk, which means it does happen after the client gets its 200, it&apos;s not that big a deal.</comment>
                    <comment id="12742327" author="rnewson" created="Wed, 12 Aug 2009 12:50:09 +0000 (UTC)"  >&lt;br/&gt;
To log to couch.log you post a JSON object like this;&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;level&amp;quot;:&amp;quot;info|debug|error&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;your message here&amp;quot;}</comment>
                    <comment id="12742341" author="damienkatz" created="Wed, 12 Aug 2009 13:21:03 +0000 (UTC)"  >Why not just write the log messages to a db?</comment>
                    <comment id="12748200" author="rnewson" created="Wed, 26 Aug 2009 23:16:51 +0000 (UTC)"  >&lt;br/&gt;
Because people using couchdb-lucene with couchdb would prefer to read couch.log for the log messages, and I suspect that applies to other externals/addons, etc.&lt;br/&gt;
&lt;br/&gt;
It&apos;s clumsy if all addons are forced to log differently, it reduces the degree that addons can be integrated. Since couchdb has support for grafting external processes (which actually *can* log, I think), it&apos;s a shame that db_update_notification processes cannot.&lt;br/&gt;
&lt;br/&gt;
That said, for couchdb-lucene, I intend to get off db_update_notification entirely and move indexing into the the external searching process instead (typicall mapped to _fti). I think I didn&apos;t do that before because the external was only started on demand? I forget.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416310" name="0001-Add-POST-support-to-_log.patch" size="1440" author="rnewson" created="Wed, 12 Aug 2009 12:48:54 +0000 (UTC)" />
            <attachment id="12416308" name="0001-Add-POST-support-to-_log.patch" size="1440" author="rnewson" created="Wed, 12 Aug 2009 12:30:34 +0000 (UTC)" />
            <attachment id="12416306" name="0001-Add-POST-support-to-_log.patch" size="1369" author="rnewson" created="Wed, 12 Aug 2009 12:18:39 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 12 Aug 2009 13:21:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-463] Allow client to insist on Content-Type: application/json in all responses</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-463</link>

                    <description>The Content-Type of responses is negotiated via Accept (application/json if acceptable, text/plain if not). When the client is the browser, this often fails as the Accept line usually does not include application/json.&lt;br/&gt;
&lt;br/&gt;
Consider a query parameter to force application/json responses even without the Accept header. Couchdb-lucene does this today (it didn&apos;t do it yesterday), described as;&lt;br/&gt;
&lt;br/&gt;
&amp;quot;force_json&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Usually couchdb-lucene determines the Content-Type of its response based on the presence of the Accept header. If Accept contains &amp;quot;application/json&amp;quot;, you get &amp;quot;application/json&amp;quot; in the response, otherwise you get &amp;quot;text/plain;charset=utf8&amp;quot;. Some tools, like JSONView for FireFox, do not send the Accept header but do render &amp;quot;application/json&amp;quot; responses if received. Setting force_json=true forces all response to &amp;quot;application/json&amp;quot; regardless of the Accept header.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
I recognize it duplicates the HTTP content negotiation.</description>
                <environment></environment>
            <key id="12432867">COUCHDB-463</key>
        <summary>Allow client to insist on Content-Type: application/json in all responses</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Wed, 12 Aug 2009 11:36:25 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:27:56 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742456" author="jchris" created="Wed, 12 Aug 2009 17:13:18 +0000 (UTC)"  >It might help motivate the patch to describe a use case where sending text/plain causes issues for clients (who can&apos;t send json headers anyway)&lt;br/&gt;
&lt;br/&gt;
Not saying it&apos;s a bad thing to fix, just looking for a concrete use case.</comment>
                    <comment id="12742463" author="rnewson" created="Wed, 12 Aug 2009 17:22:07 +0000 (UTC)"  >I did;&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Some tools, like JSONView for FireFox, do not send the Accept header but do render &amp;quot;application/json&amp;quot; responses if received.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
That is, there is at least one plugin that can render returned JSON better than text/plain that does not (or cannot? I don&apos;t know firefox plugin API) send the Accept header couchdb expects.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve added force_json=true to couchdb-lucene as the API there is much smaller (you can query the index, that&apos;s about it) so I didn&apos;t have any qualms about adding another parameter for these rare cases. If this parameter lets users work around bugs or deficiencies in their browsers or tools, I&apos;m fine with that. Obviously the Accept header is the way to go if you access couch programatically which is the typical case.&lt;br/&gt;
&lt;br/&gt;
JSONView: &lt;a href=&quot;https://addons.mozilla.org/en-US/firefox/addon/10869&quot;&gt;https://addons.mozilla.org/en-US/firefox/addon/10869&lt;/a&gt;</comment>
                    <comment id="12749352" author="mjgiarlo" created="Mon, 31 Aug 2009 01:41:04 +0000 (UTC)"  >FYI, the JSONovich add-on for Firefox explicitly sends the application/json type in the Accept header as of version 1.1, so it operates as expected with CouchDB.&lt;br/&gt;
&lt;br/&gt;
JSONovich: &lt;a href=&quot;https://addons.mozilla.org/en-US/firefox/10122&quot;&gt;https://addons.mozilla.org/en-US/firefox/10122&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Version 1.1 is in the sandbox, so it&apos;s not yet up on mozilla.org, but it&apos;s available via &lt;a href=&quot;http://lackoftalent.org/michael/blog/json-in-firefox/&quot;&gt;http://lackoftalent.org/michael/blog/json-in-firefox/&lt;/a&gt;&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 12 Aug 2009 17:13:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-462] track conflict count in db_info (was built-in conflicts view)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-462</link>

                    <description>This patch adds a built-in _conflicts view indexed by document ID that looks like&lt;br/&gt;
&lt;br/&gt;
GET /dbname/_conflicts&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;, &amp;quot;rev&amp;quot;:&amp;quot;1-1aa8851c9bb2777e11ba56e0bf768649&amp;quot;, &amp;quot;conflicts&amp;quot;:[&amp;quot;1-bdc15320c0850d4ee90ff43d1d298d5d&amp;quot;]}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
GET /dbname/_conflicts?deleted=true&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;bar&amp;quot;, &amp;quot;rev&amp;quot;:&amp;quot;5-dd31186f5aa11ebd47eb664fb342f1b1&amp;quot;, &amp;quot;conflicts&amp;quot;:[&amp;quot;5-a0efbb1990c961a078dc5308d03b7044&amp;quot;], &amp;quot;deleted_conflicts&amp;quot;:[&amp;quot;3-bdc15320c0850d4ee90ff43d1d298d5d&amp;quot;,&amp;quot;2-cce334eeeb02d04870e37dac6d33198a&amp;quot;]},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;baz&amp;quot;, &amp;quot;rev&amp;quot;:&amp;quot;2-eec205a9d413992850a6e32678485900&amp;quot;, &amp;quot;deleted&amp;quot;:true, &amp;quot;deleted_conflicts&amp;quot;:[&amp;quot;2-10009b36e28478b213e04e71c1e08beb&amp;quot;]}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
As the HTTPd and view layers are a bit outside my specialty I figured I should ask for a Review before Commit.</description>
                <environment></environment>
            <key id="12432840">COUCHDB-462</key>
        <summary>track conflict count in db_info (was built-in conflicts view)</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Wed, 12 Aug 2009 03:08:38 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742284" author="janl" created="Wed, 12 Aug 2009 11:00:58 +0000 (UTC)"  >Updated the patch:&lt;br/&gt;
&amp;nbsp;- fixed whitespace&lt;br/&gt;
&amp;nbsp;- added first round of tests&lt;br/&gt;
&amp;nbsp;- added &apos;key&apos; member to result rows to be consistent with other views&lt;br/&gt;
&lt;br/&gt;
Found open issues:&lt;br/&gt;
&amp;nbsp;- doesn&apos;t accept multi-key-get via POST&lt;br/&gt;
&amp;nbsp;- doesn&apos;t send method not allowed for invalid methods&lt;br/&gt;
&amp;nbsp;&amp;nbsp;- I suggest modelling it after _all_docs where the HTTP handlers are really short and use a helper function to do the heavy lifting&lt;br/&gt;
&lt;br/&gt;
Back to Adam :)</comment>
                    <comment id="12742452" author="kocolosk" created="Wed, 12 Aug 2009 17:02:48 +0000 (UTC)"  >Jan, did you forget the view_builtin.js test in the patch?</comment>
                    <comment id="12742464" author="janl" created="Wed, 12 Aug 2009 17:22:46 +0000 (UTC)"  >add tests file</comment>
                    <comment id="12742508" author="kocolosk" created="Wed, 12 Aug 2009 18:24:03 +0000 (UTC)"  >I don&apos;t think I have the bandwidth to add POST to keys today.  Any objections to punting on that till later?  I&apos;ll attach an updated patch (just some refactoring).</comment>
                    <comment id="12742518" author="janl" created="Wed, 12 Aug 2009 18:49:24 +0000 (UTC)"  >Committed in r803663.</comment>
                    <comment id="12742542" author="damienkatz" created="Wed, 12 Aug 2009 19:38:22 +0000 (UTC)"  >I think we should reconsider this patch.&lt;br/&gt;
&lt;br/&gt;
For one thing, it&apos;s expensive at runtime, it requires doing a linear scan on the full doc index. If you have millions of docs and no conflicts, it will must scan through every doc meta record just to tell you that.&lt;br/&gt;
&lt;br/&gt;
Another problem is you don&apos;t get any filtering or formatting. Using couchdb view, a user can construct a view that shows conflicts by author, customer, area, etc and format the results for display. Using this facility, you get no formatting or collation options.&lt;br/&gt;
&lt;br/&gt;
I favor backing this change out.</comment>
                    <comment id="12742546" author="kocolosk" created="Wed, 12 Aug 2009 19:58:50 +0000 (UTC)"  >Damien objected to this patch on IRC because it&apos;s not performant (it does a full scan over the by_id btree instead of maintaining a separate index) and because it&apos;s not flexible enough (e.g. no way to identify conflicts from a particular document type).  His suggestion was just to let users define a custom view if they need aggregate information on conflicts.&lt;br/&gt;
&lt;br/&gt;
I understand and agree with the performance concerns.  I worry that we aren&apos;t doing a good job of helping users develop conflict-aware applications, but we could probably alleviate that with some extra hand-holding in Futon.</comment>
                    <comment id="12742551" author="kocolosk" created="Wed, 12 Aug 2009 20:08:06 +0000 (UTC)"  >rolled back out in r803690</comment>
                    <comment id="12742563" author="kocolosk" created="Wed, 12 Aug 2009 20:37:06 +0000 (UTC)"  >good suggestion from Paul to just keep a counter of conflicts in the db_info</comment>
                    <comment id="12772662" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                            <outwardlinks description="duplicates">
                            <issuelink>
            <issuekey id="12417363">COUCHDB-296</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12416339" name="462-jan-2.patch" size="6529" author="janl" created="Wed, 12 Aug 2009 17:22:46 +0000 (UTC)" />
            <attachment id="12416281" name="conflicts_view.diff" size="5074" author="kocolosk" created="Wed, 12 Aug 2009 03:08:55 +0000 (UTC)" />
            <attachment id="12416347" name="COUCHDB-462-adam-updated.patch" size="15812" author="kocolosk" created="Wed, 12 Aug 2009 18:25:16 +0000 (UTC)" />
            <attachment id="12416301" name="COUCHDB-462-jan.patch" size="6529" author="janl" created="Wed, 12 Aug 2009 11:00:57 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 12 Aug 2009 11:00:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-461] attachments - handle correctly chunked encoding and Content-Length, send attachments unchunked</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-461</link>

                    <description>This patch allow couchdb to send attachments unchunked, instead, Content-Length is fixed and content is streamed. It also fix attachments PUT by detecting first if encoding is chunked then test the length witch is the standard way to do it. </description>
                <environment></environment>
            <key id="12432821">COUCHDB-461</key>
        <summary>attachments - handle correctly chunked encoding and Content-Length, send attachments unchunked</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 11 Aug 2009 21:07:44 +0000 (UTC)</created>
    <updated>Fri, 14 Aug 2009 06:59:26 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742056" author="benoitc" created="Tue, 11 Aug 2009 21:11:07 +0000 (UTC)"  >fix indentation in previous patch, sorry.</comment>
                    <comment id="12742060" author="benoitc" created="Tue, 11 Aug 2009 21:16:38 +0000 (UTC)"  >patch has been applied to my github branch :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/benoitc/couchdb/commits/chunked&quot;&gt;http://github.com/benoitc/couchdb/commits/chunked&lt;/a&gt;</comment>
                    <comment id="12742946" author="benoitc" created="Thu, 13 Aug 2009 19:57:06 +0000 (UTC)"  >I splitted previous patch to make it easier. First patch allow couchdb to send attachements (GET) whithout chunked encoding. Content-Length is fixed. &lt;br/&gt;
&lt;br/&gt;
Second patch improve the handling of PUT attachments and follow the standard. If transfert encoding is fixed, couchdb wil first look at it and if chunked use it, If no Transfer-Encoding header, Content-Length is used. With this patch CouchDB now react like current HTTP servers which fix problems with some client that give error 500 on couchdb behind a proxy like Apache server.</comment>
                    <comment id="12743047" author="paul.joseph.davis" created="Fri, 14 Aug 2009 01:09:11 +0000 (UTC)"  >Benoit, can you comment on how CouchDB is currently breaking the HTTP spec so we have a record of it? IIRC, it was something that we would expect chunked transfers by default instead of rejecting them but I&apos;d like to have the reason written down.&lt;br/&gt;
&lt;br/&gt;
Also, I&apos;d suggest that for attachments we don&apos;t use chunked transfers because we should never need it. Unless someone can give me a use case that absolutely requires receiving chunked attachments I&apos;d vote to remove them and use a straight up Content-Lenght.</comment>
                    <comment id="12743064" author="benoitc" created="Fri, 14 Aug 2009 03:38:50 +0000 (UTC)"  >well according the spec :&lt;br/&gt;
&lt;br/&gt;
&amp;quot;All HTTP/1.1 applications MUST be able to receive and decode the &amp;quot;chunked&amp;quot; transfer-coding, and MUST ignore chunk-extension extensions they do not understand. &amp;quot;&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Also for the order chunk then content-length, according the spec : &lt;br/&gt;
&lt;br/&gt;
Messages MUST NOT include both a Content-Length header field and a non-identity transfer-coding. If the message does include a non- identity transfer-coding, the Content-Length MUST be ignored. &lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.4&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.4&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I think chunked encoding is still good for some purpose, it allows the client to set buffer dynamically, and ignore bad chunks which could save some bandwidth/time .</comment>
                    <comment id="12743106" author="jchris" created="Fri, 14 Aug 2009 06:59:26 +0000 (UTC)"  >closed in r804087 and r804094&lt;br/&gt;
&lt;br/&gt;
thanks for the patch!</comment>
                </comments>
    
    <attachments>
            <attachment id="12416479" name="attachments_get_length.diff" size="3380" author="benoitc" created="Thu, 13 Aug 2009 19:57:06 +0000 (UTC)" />
            <attachment id="12416480" name="attachments_put_length.diff" size="2843" author="benoitc" created="Thu, 13 Aug 2009 19:57:06 +0000 (UTC)" />
            <attachment id="12416244" name="chunked.diff" size="6578" author="benoitc" created="Tue, 11 Aug 2009 21:08:02 +0000 (UTC)" />
            <attachment id="12416245" name="chunked2.diff" size="6577" author="benoitc" created="Tue, 11 Aug 2009 21:11:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Aug 2009 06:59:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Aug 2009 01:09:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-460] Ensure reduce_limit is turned on for view_errors test</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-460</link>

                    <description>I get a spurious error if I have reduce_limit = false in my local.ini (yes, naughty I know).  This simple patch turns on reduce_limit temporarily when running the view_errors test.</description>
                <environment></environment>
            <key id="12432661">COUCHDB-460</key>
        <summary>Ensure reduce_limit is turned on for view_errors test</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Mon, 10 Aug 2009 08:01:50 +0000 (UTC)</created>
    <updated>Mon, 10 Aug 2009 08:02:21 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12741219" author="jasondd" created="Mon, 10 Aug 2009 08:02:21 +0000 (UTC)"  >Simple patch to turn on reduce_limit when running the view_errors test.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416028" name="view_errors.js.patch" size="598" author="jasondd" created="Mon, 10 Aug 2009 08:02:21 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-459] Licenses for erlang-oauth and ibrowse</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-459</link>

                    <description>Thanks to Curt Arnold for pointing out the missing licenses for erlang-oauth and ibrowse.  See attached patch for the appropriate additions to be made to LICENSE.</description>
                <environment></environment>
            <key id="12432628">COUCHDB-459</key>
        <summary>Licenses for erlang-oauth and ibrowse</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Sun, 9 Aug 2009 17:12:39 +0000 (UTC)</created>
    <updated>Mon, 10 Aug 2009 12:34:33 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12741107" author="jasondd" created="Sun, 9 Aug 2009 17:21:21 +0000 (UTC)"  >Patch with BSD licenses for src/erlang-oauth and src/ibrowse.</comment>
                    <comment id="12741291" author="janl" created="Mon, 10 Aug 2009 12:34:33 +0000 (UTC)"  >Applied in r802763.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416003" name="LICENSE.patch" size="3156" author="jasondd" created="Sun, 9 Aug 2009 17:21:21 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 10 Aug 2009 12:34:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 10 Aug 2009 12:34:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-458] diff for user handler in couch_httpd_auth</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-458</link>

                    <description>Find attached the diff adding user auth to couch_httpd_auth. Requested by jasondavies to solve some licensing issue.</description>
                <environment></environment>
            <key id="12432592">COUCHDB-458</key>
        <summary>diff for user handler in couch_httpd_auth</summary>

            <type id="3" iconUrl="http://issues.apache.org/jira/images/icons/task.gif">Task</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sat, 8 Aug 2009 06:03:07 +0000 (UTC)</created>
    <updated>Mon, 10 Aug 2009 09:34:47 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12740843" author="benoitc" created="Sat, 8 Aug 2009 06:03:46 +0000 (UTC)"  >user http handler diff</comment>
                    <comment id="12741242" author="benoitc" created="Mon, 10 Aug 2009 09:34:47 +0000 (UTC)"  >patch containing all the changes. Should close this issue.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416035" name="benoitc_user_handler.diff" size="22830" author="benoitc" created="Mon, 10 Aug 2009 09:34:47 +0000 (UTC)" />
            <attachment id="12415923" name="user_handler.diff" size="8805" author="benoitc" created="Sat, 8 Aug 2009 06:03:46 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-457] Database crash with possibly non-UTF-8 document content</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-457</link>

                    <description>See the document with the id &amp;quot;&lt;a href=&quot;http://www.stephenfry.com/blog/?feed=rss2&quot;&gt;http://www.stephenfry.com/blog/?feed=rss2&lt;/a&gt;&amp;quot; in the attached db.</description>
                <environment></environment>
            <key id="12432497">COUCHDB-457</key>
        <summary>Database crash with possibly non-UTF-8 document content</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="jameswdumay">James William Dumay</reporter>
            
    <created>Fri, 7 Aug 2009 06:54:47 +0000 (UTC)</created>
    <updated>Wed, 23 Sep 2009 20:51:59 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12740432" author="mhammond" created="Fri, 7 Aug 2009 07:13:19 +0000 (UTC)"  >Sorry I don&apos;t have time to dig more or convert the test-case into JS, but the attached .py file creates a document with invalid UTF8 - which could accepts, but them bombs trying to open it.  The output when run is:&lt;br/&gt;
&lt;br/&gt;
created!&lt;br/&gt;
doc is&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
&amp;nbsp;&amp;nbsp;File &amp;quot;bad_utf.py&amp;quot;, line 14, in &amp;lt;module&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;print &amp;quot;doc is&amp;quot;, db[&amp;quot;test&amp;quot;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;File &amp;quot;couchdb-0.5-py2.6.egg\couchdb\client.py&amp;quot;, line 288, in __getitem__&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;resp, data = self.resource.get(id)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;File &amp;quot;couchdb-0.5-py2.6.egg\couchdb\client.py&amp;quot;, line 837, in get&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return self._request(&apos;GET&apos;, path, headers=headers, **params)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;File &amp;quot;couchdb-0.5-py2.6.egg\couchdb\client.py&amp;quot;, line 895, in _request&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;raise ServerError((status_code, error))&lt;br/&gt;
couchdb.client.ServerError: (500, (&apos;ucs&apos;, &apos;{bad_utf8_character_code}&apos;))</comment>
                    <comment id="12740605" author="carnold@apache.org" created="Fri, 7 Aug 2009 16:05:24 +0000 (UTC)"  >Related &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-345&quot; title=&quot;&amp;quot;High ASCII&amp;quot; can be inserted into db but not retrieved&quot;&gt;&lt;strike&gt;COUCHDB-345&lt;/strike&gt;&lt;/a&gt; where &amp;quot;high ASCII&amp;quot; in interpreted as attempting to interpret ISO-8859-1 as UTF-8.</comment>
                    <comment id="12758875" author="kocolosk" created="Wed, 23 Sep 2009 20:51:59 +0000 (UTC)"  >Fixed in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-345&quot; title=&quot;&amp;quot;High ASCII&amp;quot; can be inserted into db but not retrieved&quot;&gt;&lt;strike&gt;COUCHDB-345&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12424767">COUCHDB-345</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12415826" name="bad_utf.py" size="419" author="mhammond" created="Fri, 7 Aug 2009 07:13:19 +0000 (UTC)" />
            <attachment id="12415825" name="watercooler.couch" size="667801" author="jameswdumay" created="Fri, 7 Aug 2009 06:55:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 23 Sep 2009 20:51:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 7 Aug 2009 07:13:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-456] DB-level configuration system</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-456</link>

                    <description>It would be very useful to have an analog of the _config system for each individual database.  These settings could be changed by users without server admin privileges.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12432416">COUCHDB-456</key>
        <summary>DB-level configuration system</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Thu, 6 Aug 2009 16:19:28 +0000 (UTC)</created>
    <updated>Thu, 6 Aug 2009 16:19:28 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-455] get_result,infinity error when replicating an empty database</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-455</link>

                    <description>We have code that regularly calls for CouchDB nodes to replicate with pairs in our other datacentre. It ocassionally has the follwing error:&lt;br/&gt;
{code}&lt;br/&gt;
INFO bbc.forge.engineering.couchdb.replicatr.ReplicateWorker 371 - Bad replication: [kv103.back.live.telhc.local:5986/tvp_yahoowidgets &amp;lt;- kv103.back.live.telhc.local:5986 (ACE_METADATA_) {&amp;quot;source&amp;quot;:&amp;quot;&lt;a href=&quot;http://kv103.back.live.telhc.local:5986/tvp_yahoowidgets&quot;&gt;http://kv103.back.live.telhc.local:5986/tvp_yahoowidgets&lt;/a&gt;&amp;quot;,&amp;quot;target&amp;quot;:&amp;quot;tvp_yahoowidgets&amp;quot;}]: response:[HTTP/1.1 500 Internal Server Error - {&amp;quot;error&amp;quot;:&amp;quot;noproc&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{gen_server,call,[&amp;lt;0.17199.212&amp;gt;,get_result,infinity]}&amp;quot;}&lt;br/&gt;
{code}&lt;br/&gt;
&lt;br/&gt;
The remote database &amp;quot;&lt;a href=&quot;http://kv103.back.live.telhc.local:5986/tvp_yahoowidgets&quot;&gt;http://kv103.back.live.telhc.local:5986/tvp_yahoowidgets&lt;/a&gt;&amp;quot; is empty:&lt;br/&gt;
{code}curl &lt;a href=&quot;http://kv103.back.live.telhc.local:5986/tvp_yahoowidgets&quot;&gt;http://kv103.back.live.telhc.local:5986/tvp_yahoowidgets&lt;/a&gt;&lt;br/&gt;
{&amp;quot;db_name&amp;quot;:&amp;quot;tvp_yahoowidgets&amp;quot;,&amp;quot;doc_count&amp;quot;:0,&amp;quot;doc_del_count&amp;quot;:0,&amp;quot;update_seq&amp;quot;:0,&amp;quot;purge_seq&amp;quot;:0,&amp;quot;compact_running&amp;quot;:false,&amp;quot;disk_size&amp;quot;:5920,&amp;quot;instance_start_time&amp;quot;:&amp;quot;1249559096646177&amp;quot;}&lt;br/&gt;
{code}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This same &amp;quot;get_result,infinity&amp;quot;, is seen on another empty database:&lt;br/&gt;
{code}&lt;br/&gt;
curl &lt;a href=&quot;http://kv103.back.live.telhc.local:5984/avalanche150k&quot;&gt;http://kv103.back.live.telhc.local:5984/avalanche150k&lt;/a&gt;&lt;br/&gt;
{&amp;quot;db_name&amp;quot;:&amp;quot;avalanche150k&amp;quot;,&amp;quot;doc_count&amp;quot;:0,&amp;quot;doc_del_count&amp;quot;:0,&amp;quot;update_seq&amp;quot;:0,&amp;quot;purge_seq&amp;quot;:0,&amp;quot;compact_running&amp;quot;:false,&amp;quot;disk_size&amp;quot;:250480,&amp;quot;instance_start_time&amp;quot;:&amp;quot;1249559230162131&amp;quot;}&lt;br/&gt;
{code}</description>
                <environment></environment>
            <key id="12432381">COUCHDB-455</key>
        <summary>get_result,infinity error when replicating an empty database</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="enda.farrell">Enda Farrell</reporter>
            
    <created>Thu, 6 Aug 2009 11:49:26 +0000 (UTC)</created>
    <updated>Fri, 7 Aug 2009 10:16:58 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12740132" author="kocolosk" created="Thu, 6 Aug 2009 16:11:20 +0000 (UTC)"  >Hi Enda, thanks for the report.  I have to admit I&apos;m a bit stumped at first.  The error message indicates that the replication gen_server had exited before the call to get_result.  Couch 0.9.0 and higher should protect against that.  Were there any other related error messages?&lt;br/&gt;
&lt;br/&gt;
There is one scenario I can dream up.  Are you triggering that same replication multiple times simultaneously?  That is&lt;br/&gt;
&lt;br/&gt;
A POSTs to _replicate&lt;br/&gt;
B POSTs to _replicate with identical request body&lt;br/&gt;
A receives a response, replicator shuts down&lt;br/&gt;
B gets a noproc error&lt;br/&gt;
&lt;br/&gt;
In this case we try to add B as a listener to the original replication, but it&apos;s technically possible the replication could terminate in between when B gets the process id and when it asks for the result.&lt;br/&gt;
</comment>
                    <comment id="12740490" author="enda.farrell" created="Fri, 7 Aug 2009 10:16:58 +0000 (UTC)"  >Hi Adam - thank you for taking a look at this.&lt;br/&gt;
&lt;br/&gt;
We alas don&apos;t see other related error messages as on a live env, anything other than ERROR causes way too much logging (and until [&lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-412&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-412&lt;/a&gt;] is fixed, we&apos;ll have to keep it this way), so it&apos;s possible that there is more information out there.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll try to make the same situation happen on our testing envs - but as our live envs have (a) a VPN and (b) active use, we often don&apos;t see these same problems until they are on our live envs.&lt;br/&gt;
&lt;br/&gt;
It *may* be possible that the calling multiple times is happening, but it seems unlikely as:&lt;br/&gt;
(1) there&apos;s a list of databases to be replicated,&lt;br/&gt;
(2) we iterate over this list,&lt;br/&gt;
(3) we sleep for a little (one second in the above)&lt;br/&gt;
(4) start over the list again&lt;br/&gt;
&lt;br/&gt;
It is a Java/Spring app, so there may be things going on that I many not be fully aware of. I&apos;ll add more counters and alerts to see if replicator objects have more than once instance at any point in time.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 6 Aug 2009 16:11:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-454] batch=ok buffers indefinitely</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-454</link>

                    <description>It appears that documents written with batch=ok are buffered indefinitely. They don&apos;t appear in the _changes feed, nor in _all_docs, until you POST to _ensure_full_commit. This is despite me running with standard default.ini which has batch_save_interval=1000 (milliseconds)&lt;br/&gt;
&lt;br/&gt;
$ curl -X DELETE &lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/test/_all_docs&quot;&gt;http://127.0.0.1:5984/test/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test?batch=ok&quot;&gt;http://127.0.0.1:5984/test?batch=ok&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;ba37caf17a24236d243e9ab2c4c6daff&amp;quot;}&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test?batch=ok&quot;&gt;http://127.0.0.1:5984/test?batch=ok&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;e5d8bb7c74ca3cca4aabea8107620fad&amp;quot;}&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test?batch=ok&quot;&gt;http://127.0.0.1:5984/test?batch=ok&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;9bb2fb958f9112d79b4f388514c0ba7c&amp;quot;}&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/test/_all_docs&quot;&gt;http://127.0.0.1:5984/test/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
$ sleep 60&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/test/_all_docs&quot;&gt;http://127.0.0.1:5984/test/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
$ curl -X POST &lt;a href=&quot;http://127.0.0.1:5984/test/_ensure_full_commit&quot;&gt;http://127.0.0.1:5984/test/_ensure_full_commit&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;instance_start_time&amp;quot;:&amp;quot;1249546668867264&amp;quot;}&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/test/_all_docs&quot;&gt;http://127.0.0.1:5984/test/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:4,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;1b1337e31c4d9b41119d51db78ffebe3&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;9bb2fb958f9112d79b4f388514c0ba7c&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;9bb2fb958f9112d79b4f388514c0ba7c&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;ba37caf17a24236d243e9ab2c4c6daff&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;ba37caf17a24236d243e9ab2c4c6daff&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;e5d8bb7c74ca3cca4aabea8107620fad&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;e5d8bb7c74ca3cca4aabea8107620fad&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
</description>
                <environment>CouchDB HEAD (commit commit aebdb31001126dab6b579b8cc2e605ef7ec499c6)&lt;br/&gt;
Ubuntu Jaunty, Erlang 12B5</environment>
            <key id="12432363">COUCHDB-454</key>
        <summary>batch=ok buffers indefinitely</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Thu, 6 Aug 2009 08:21:43 +0000 (UTC)</created>
    <updated>Thu, 6 Aug 2009 13:55:27 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12740058" author="kocolosk" created="Thu, 6 Aug 2009 13:35:16 +0000 (UTC)"  >Brian, I noticed this yesterday too.  Committing a patch shortly.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 6 Aug 2009 13:55:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 6 Aug 2009 13:35:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-453] If &quot;Accept: foo&quot; header is sent, server returns a render_error</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-453</link>

                    <description>The full error is: {&amp;quot;error&amp;quot;:&amp;quot;render_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;function raised error: [object Object]&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
This occurs because there is no match for the &amp;quot;foo&amp;quot; mime type.  Simple patch to follow that makes us fall back to sending the first mime type provided.  &amp;quot;Be conservative in what you send, liberal in what you accept&amp;quot;.</description>
                <environment></environment>
            <key id="12432287">COUCHDB-453</key>
        <summary>If &quot;Accept: foo&quot; header is sent, server returns a render_error</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Wed, 5 Aug 2009 14:50:39 +0000 (UTC)</created>
    <updated>Wed, 5 Aug 2009 22:54:29 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12739535" author="jasondd" created="Wed, 5 Aug 2009 14:51:22 +0000 (UTC)"  >Fall back to first mime type provided if we can&apos;t match what is in the Accept header.</comment>
                    <comment id="12739559" author="jasondd" created="Wed, 5 Aug 2009 15:12:52 +0000 (UTC)"  >Updated patch with test case (looks like there was a test case for this but it wasn&apos;t written correctly - fixed).</comment>
                    <comment id="12739661" author="jchris" created="Wed, 5 Aug 2009 18:30:15 +0000 (UTC)"  >fixed in r801345</comment>
                    <comment id="12739742" author="nslater" created="Wed, 5 Aug 2009 20:53:26 +0000 (UTC)"  >What do you mean when you say CouchDB will fall back to the &amp;quot;first mime type provided&amp;quot;? Do you mean the first media type in the configuration, or the first media type provided by the client on the Accept header? If you mean the first, why would we not send back a 406 Not Acceptable header? If a client is specifically requesting a certain media type, that we cannot fulfil, I think it makes more sense to tell them that we cannot fulfil the request. If it is the latter, does Erlang not have any content negotiation libraries we can hook into so that we can properly parse client and server q-values?</comment>
                    <comment id="12739804" author="jasondd" created="Wed, 5 Aug 2009 22:54:29 +0000 (UTC)"  >I meant the first.  However, I didn&apos;t realise that Chris had originally intended to return a 406 response, which upon reflection is the preferred solution as you point out.  It just wasn&apos;t working properly and sent a 500 &amp;quot;render_error&amp;quot; instead.  He has now fixed it and it returns a 406, so I think we are all in agreement now.  Thanks for your attention to detail!</comment>
                </comments>
    
    <attachments>
            <attachment id="12415616" name="render.js.patch" size="1201" author="jasondd" created="Wed, 5 Aug 2009 15:12:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 5 Aug 2009 18:30:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 5 Aug 2009 18:30:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-452] couch logs an [error] record if a client disconnects</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-452</link>

                    <description>If a client makes a request which returns multiple rows (eg, a query) but disconnects before reading the response, couch logs:&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.66.0&amp;gt;] Uncaught error in HTTP request: {exit,normal}&lt;br/&gt;
[info] [&amp;lt;0.66.0&amp;gt;] Stacktrace: [{mochiweb_request,send,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,send_chunk,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_view,send_json_view_row,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_view,&apos;-make_view_fold_fun/6-fun-0-&apos;,12},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_view,fold_fun,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,stream_kv_node2,7},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,stream_kp_node,7},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,fold,5}]&lt;br/&gt;
&lt;br/&gt;
This could lead someone to conclude couch has an error which is not correct.  A simple [info] record recording the premature normal exit is probably more appropriate.&lt;br/&gt;
&lt;br/&gt;
FYI, the easiest way I found to repro this was to execute:&lt;br/&gt;
&lt;br/&gt;
% python -c &amp;quot;import urllib; urllib.urlopen(&apos;&lt;a href=&quot;http://127.0.0.1:5984/your_db/_design/your_design_doc/_view/your_view?reduce=false&apos;).close()&quot;&gt;http://127.0.0.1:5984/your_db/_design/your_design_doc/_view/your_view?reduce=false&apos;).close()&lt;/a&gt;&amp;quot;&lt;br/&gt;
&lt;br/&gt;
which causes Python to open a connection and close it without reading anything.  I&apos;ll attach a patch as suggested generally by jchris.</description>
                <environment></environment>
            <key id="12432232">COUCHDB-452</key>
        <summary>couch logs an [error] record if a client disconnects</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Wed, 5 Aug 2009 01:31:28 +0000 (UTC)</created>
    <updated>Mon, 12 Oct 2009 00:05:03 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12739306" author="mhammond" created="Wed, 5 Aug 2009 01:42:23 +0000 (UTC)"  >Patch which causes a simple:&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.66.0&amp;gt;] remote connection dropped prematurely&lt;br/&gt;
&lt;br/&gt;
record to be written.  jchris also suggested I remove the error:badarg and error:function_clause handlers as these are picked up by the Tag:Error handler - so they have gone too.</comment>
                    <comment id="12739405" author="janl" created="Wed, 5 Aug 2009 10:03:57 +0000 (UTC)"  >Why do we get rid of the badarg &amp;amp; function_clause cases?</comment>
                    <comment id="12739443" author="mhammond" created="Wed, 5 Aug 2009 11:57:43 +0000 (UTC)"  >&amp;gt; Why do we get rid of the badarg &amp;amp; function_clause cases? &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;jchris implies, but I didn&apos;t confirm, the Tag:Error handler will still match these.</comment>
                    <comment id="12739463" author="janl" created="Wed, 5 Aug 2009 12:38:35 +0000 (UTC)"  >It will match, but why don&apos;t we want to keep the special case. maybe the question boils down to why did we have them in the first place. Just wondering about the change.</comment>
                    <comment id="12739516" author="kocolosk" created="Wed, 5 Aug 2009 14:13:02 +0000 (UTC)"  >Thanks for fixing the {exit,normal} stuff, Mark.  I don&apos;t have an opinion about whether to remove the explicit checks for badarg and function_clause errors.</comment>
                    <comment id="12739539" author="carnold@apache.org" created="Wed, 5 Aug 2009 14:55:30 +0000 (UTC)"  >Seems to be a duplicate (or at least similar) to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-394&quot; title=&quot;Intermittent HTTP 500 errors on queries, no useful diagnostics&quot;&gt;COUCHDB-394&lt;/a&gt;.</comment>
                    <comment id="12739543" author="carnold@apache.org" created="Wed, 5 Aug 2009 15:03:10 +0000 (UTC)"  >Raised this issue on the mochiweb project site: &lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=39&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=39&lt;/a&gt; in addition to the &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-394&quot; title=&quot;Intermittent HTTP 500 errors on queries, no useful diagnostics&quot;&gt;COUCHDB-394&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
Mochiweb discards the value returned from gen_tcp:send, so there is not any way to distinguish a premature close from some more significant problem.&lt;br/&gt;
&lt;br/&gt;
I definitely spent some time trying to figure out why I was getting 500 return codes in the logs on what appeared to be normal activities.</comment>
                    <comment id="12740087" author="kocolosk" created="Thu, 6 Aug 2009 14:45:44 +0000 (UTC)"  >Yes, that&apos;s a good point Curt.  Just yesterday Jason needed to add some logging in MochiWeb to find out that a gen_tcp:recv was timing out.  The log just said {exit,normal} there, too.</comment>
                    <comment id="12740117" author="jchris" created="Thu, 6 Aug 2009 15:43:43 +0000 (UTC)"  >The special case matches were added one at a time, because those are two special cases where having a stacktrace in the logs can help with debugging on the ML and IRC.&lt;br/&gt;
&lt;br/&gt;
However, the general matcher now logs a stacktrace just the same as they did, so it&apos;s fine to let the general case handle them. (I guess we finally got few enough errors coming from deep within CouchDB that a stacktrace on any uncaught error works fine.)&lt;br/&gt;
&lt;br/&gt;
Removing the special case matchers just cleans up the code and does not change functionality.</comment>
                    <comment id="12764523" author="mhammond" created="Mon, 12 Oct 2009 00:05:03 +0000 (UTC)"  >Out of date - the trunk now completely ignores that case without even logging an info record.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                            <outwardlinks description="duplicates">
                            <issuelink>
            <issuekey id="12428830">COUCHDB-394</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12415561" name="dont_log_error_on_disconnect.patch" size="1244" author="mhammond" created="Wed, 5 Aug 2009 01:42:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 12 Oct 2009 00:05:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 5 Aug 2009 10:03:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-451] Upgrade to ibrowse 1.5.2</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-451</link>

                    <description>From the commit message:&lt;br/&gt;
&lt;br/&gt;
The ETS table created for load balancing of requests was not being deleted which led to the node not being able to create any more ETS tables if queries were made to many number of webservers. ibrowse now deletes the ETS table it creates once the last connection to a webserver is dropped. (Reported by Seth Falcon.)&lt;br/&gt;
&lt;br/&gt;
Patch to follow...</description>
                <environment></environment>
            <key id="12432208">COUCHDB-451</key>
        <summary>Upgrade to ibrowse 1.5.2</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Tue, 4 Aug 2009 21:57:51 +0000 (UTC)</created>
    <updated>Thu, 6 Aug 2009 14:27:04 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12739200" author="jasondd" created="Tue, 4 Aug 2009 21:58:20 +0000 (UTC)"  >ibrowse 1.5.2.</comment>
                    <comment id="12740080" author="kocolosk" created="Thu, 6 Aug 2009 14:27:04 +0000 (UTC)"  >Thanks Jason.  I applied the patch and also bumped the ibrowse version number in the build system.</comment>
                </comments>
    
    <attachments>
            <attachment id="12415531" name="ibrowse.1.5.2.patch" size="8327" author="jasondd" created="Tue, 4 Aug 2009 21:58:20 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 6 Aug 2009 14:27:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 6 Aug 2009 14:27:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-450] Chunk size bug in ibrowse &lt; v1.5.2 manifesting as {&quot;error&quot;:&quot;replicated_attachment_too_large&quot;} when replicating</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-450</link>

                    <description>Patch to follow...</description>
                <environment></environment>
            <key id="12432191">COUCHDB-450</key>
        <summary>Chunk size bug in ibrowse &lt; v1.5.2 manifesting as {&quot;error&quot;:&quot;replicated_attachment_too_large&quot;} when replicating</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Tue, 4 Aug 2009 19:05:06 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 20:29:51 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12739140" author="kocolosk" created="Tue, 4 Aug 2009 20:29:51 +0000 (UTC)"  >patch applied in r800950</comment>
                </comments>
    
    <attachments>
            <attachment id="12415510" name="ibrowse_chunk_size.patch" size="976" author="jasondd" created="Tue, 4 Aug 2009 19:05:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 20:29:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 20:29:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-449] Turn off delayed commits by default</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-449</link>

                    <description>Delayed commits make CouchDB significantly faster. They also open a one second window for data loss. In 0.9 and trunk, delayed commits are enabled by default and can be overridden with HTTP headers and an explicit API call to flush the write buffer. I suggest to turn off delayed commits by default and use the same overrides to enable it per request. A per-database option is possible, too.&lt;br/&gt;
&lt;br/&gt;
One concern is developer workflow speed. The setting affects the test suite performance significantly. I&apos;d opt to change couch.js to set the appropriate header to enable delayed commits for tests.&lt;br/&gt;
&lt;br/&gt;
CouchDB should guarantee data safety first and speed second, with sensible overrides.</description>
                <environment></environment>
            <key id="12432189">COUCHDB-449</key>
        <summary>Turn off delayed commits by default</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 4 Aug 2009 18:57:58 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:00:21 +0000 (UTC)</updated>

                        <version>0.9</version>
                    <version>0.9.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12739403" author="jasondd" created="Wed, 5 Aug 2009 10:02:35 +0000 (UTC)"  >+1. Can we make this a config setting? delayed_commits = false by default but can be turned on for a node for speed junkies.</comment>
                    <comment id="12739406" author="janl" created="Wed, 5 Aug 2009 10:09:38 +0000 (UTC)"  >good idea Jason. or a new section:&lt;br/&gt;
&lt;br/&gt;
[delayed_commits]&lt;br/&gt;
dbname = true&lt;br/&gt;
dbname2  = false&lt;br/&gt;
...&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
so you can have a &amp;quot;safe&amp;quot; db for your app and a &amp;quot;fast&amp;quot; db for, say, logging.</comment>
                    <comment id="12739430" author="candlerb" created="Wed, 5 Aug 2009 11:05:15 +0000 (UTC)"  >&lt;br/&gt;
Or perhaps you could set a different periodic flush interval for each&lt;br/&gt;
database, with 0 equivalent to no delayed commit.&lt;br/&gt;
&lt;br/&gt;
For me, the question is specifically, what guarantees does CouchDB give to&lt;br/&gt;
clients about your data safety, and when - for example, at the point where&lt;br/&gt;
you get a HTTP response?&lt;br/&gt;
&lt;br/&gt;
There are at least three different scenarios that I&apos;m aware of at the&lt;br/&gt;
moment.&lt;br/&gt;
1. client supplies &apos;batch=ok&apos; URL parameter&lt;br/&gt;
2. client supplies no special parameters&lt;br/&gt;
3. client supplies &apos;X-Couch-Full-Commit: true&apos; header&lt;br/&gt;
&lt;br/&gt;
From the client&apos;s perspective, I can see no difference between (1) and (2).&lt;br/&gt;
After receiving a HTTP response, the data is likely to make it to disk at&lt;br/&gt;
some time in the future, but it could be lost if the plug is pulled in the&lt;br/&gt;
next few seconds.&lt;br/&gt;
&lt;br/&gt;
In case (3), the document is guaranteed to be on disk after the HTTP&lt;br/&gt;
response is returned [as long as drive internal write cache is disabled].&lt;br/&gt;
This is equivalent to &amp;quot;QOS level 1&amp;quot; in the MQTT protocol:&lt;br/&gt;
&lt;a href=&quot;http://publib.boulder.ibm.com/infocenter/wmbhelp/v6r0m0/index.jsp?topic=/com.ibm.etools.mft.doc/ac10850_.htm&quot;&gt;http://publib.boulder.ibm.com/infocenter/wmbhelp/v6r0m0/index.jsp?topic=/com.ibm.etools.mft.doc/ac10850_.htm&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
However, it also forces writes of everything received up to this point, so&lt;br/&gt;
it&apos;s very inefficient if you are doing lots of writes with this header on.&lt;br/&gt;
&lt;br/&gt;
Sometimes, you don&apos;t require data to be written to disk immediately, but you&lt;br/&gt;
do want to be notified *when* it has been written to disk in order to take&lt;br/&gt;
some subsequent action (such as acknowledging the successful save to a&lt;br/&gt;
downstream consumer).&lt;br/&gt;
&lt;br/&gt;
I would like to propose an alternative approach similar to TCP sequence&lt;br/&gt;
numbers. We already have a sequence number which counts documents added to&lt;br/&gt;
the database (update_seq). I suggest we keep a separate watermark which is&lt;br/&gt;
the sequence number when the database was last flushed to disk (say&lt;br/&gt;
flush_seq).&lt;br/&gt;
&lt;br/&gt;
Now:&lt;br/&gt;
&lt;br/&gt;
- when you PUT a document, send the update_seq as part of the response&lt;br/&gt;
&amp;nbsp;&amp;nbsp;(let&apos;s call it doc_seq)&lt;br/&gt;
&lt;br/&gt;
- update_seq may continue to increment as more documents are updated&lt;br/&gt;
&lt;br/&gt;
- at some point in the future, when data is flushed to disk, set&lt;br/&gt;
&amp;nbsp;&amp;nbsp;flush_seq := update_seq&lt;br/&gt;
&lt;br/&gt;
- if the client is interested to know when its document has been flushed&lt;br/&gt;
&amp;nbsp;&amp;nbsp;to disk, it can poll mydb to check for flush_seq &amp;gt;= doc_seq&lt;br/&gt;
&lt;br/&gt;
- it could be an option in the HTTP request to delay the response until&lt;br/&gt;
&amp;nbsp;&amp;nbsp;flush_seq &amp;gt;= doc_seq&lt;br/&gt;
&lt;br/&gt;
That means you would get the benefit of knowing that the document had been&lt;br/&gt;
committed to disk, without the cost of having to commit it. Rather, you wait&lt;br/&gt;
until someone else wants to force a full commit, or the periodic full commit&lt;br/&gt;
takes place.&lt;br/&gt;
&lt;br/&gt;
Then the only per-database tunable you need is the periodic commit interval.&lt;br/&gt;
Set it to 5 seconds for logging databases; 0.2 for RADIUS accounting (where&lt;br/&gt;
you want to generate a response within 200ms); and 0 if you want every&lt;br/&gt;
single document to be committed as soon as it arrives.&lt;br/&gt;
&lt;br/&gt;
Thoughts?&lt;br/&gt;
&lt;br/&gt;
Something like this is doable at present, but requires a buffering proxy.&lt;br/&gt;
For example, you can receive RADIUS accounting updates into a buffer, then&lt;br/&gt;
every 200ms do a POST to _bulk_docs with X-Couch-Full-Commit: true and&lt;br/&gt;
return success to all the clients.&lt;br/&gt;
&lt;br/&gt;
Since CouchDB has to buffer these documents in the VFS cache anyway, it&lt;br/&gt;
would be convenient (and more efficient) to let it handle the periodic&lt;br/&gt;
flushing too.&lt;br/&gt;
&lt;br/&gt;
Regards,&lt;br/&gt;
&lt;br/&gt;
Brian.&lt;br/&gt;
</comment>
                    <comment id="12739462" author="janl" created="Wed, 5 Aug 2009 12:37:27 +0000 (UTC)"  >Brian, thanks for your thoughts :)&lt;br/&gt;
&lt;br/&gt;
The &amp;quot;just write and let me know when things have been committed&amp;quot; can be done with the _changes feed already. No need for a separate sequence id.</comment>
                    <comment id="12739942" author="candlerb" created="Thu, 6 Aug 2009 08:41:20 +0000 (UTC)"  >&lt;br/&gt;
Just to be clear: _changes is supposed only to update after a commit has&lt;br/&gt;
taken place, not after a write?&lt;br/&gt;
&lt;br/&gt;
If so, I cannot demonstrate it. If I write a document and then immediately&lt;br/&gt;
read _changes, it always appears. See below at (*).&lt;br/&gt;
&lt;br/&gt;
Furthermore, the same is true if I run&lt;br/&gt;
&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/test/_changes?feed=continuous&quot;&gt;http://127.0.0.1:5984/test/_changes?feed=continuous&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
in another window. As soon as I add a document in the first window, it&lt;br/&gt;
appears in the _changes feed.&lt;br/&gt;
&lt;br/&gt;
My very rough scan of the source suggests that a delayed commit should take&lt;br/&gt;
place after 1 second:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Delay and (Db#db.waiting_delayed_commit == nil) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Db#db{waiting_delayed_commit=&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;erlang:send_after(1000, self(), delayed_commit)};&lt;br/&gt;
&lt;br/&gt;
So if that&apos;s right, and what you say is true, then I would expect not to see&lt;br/&gt;
the document in _changes for this long.&lt;br/&gt;
&lt;br/&gt;
OTOH, with batch=ok the commit is delayed indefinitely. I have raised this&lt;br/&gt;
as a separate ticket &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-454&quot; title=&quot;batch=ok buffers indefinitely&quot;&gt;&lt;strike&gt;COUCHDB-454&lt;/strike&gt;&lt;/a&gt;)&lt;br/&gt;
&lt;br/&gt;
All tested with HEAD (git commit aebdb31001126dab6b579b8cc2e605ef7ec499c6)&lt;br/&gt;
and 12b5 under Jaunty.&lt;br/&gt;
&lt;br/&gt;
Regards,&lt;br/&gt;
&lt;br/&gt;
Brian.&lt;br/&gt;
&lt;br/&gt;
(*)&lt;br/&gt;
$ curl -X DELETE &lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/test/_changes&quot;&gt;http://127.0.0.1:5984/test/_changes&lt;/a&gt;&lt;br/&gt;
{&amp;quot;results&amp;quot;:[&lt;br/&gt;
&lt;br/&gt;
],&lt;br/&gt;
&amp;quot;last_seq&amp;quot;:0}&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test;&quot;&gt;http://127.0.0.1:5984/test;&lt;/a&gt; curl &lt;a href=&quot;http://127.0.0.1:5984/test/_changes&quot;&gt;http://127.0.0.1:5984/test/_changes&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;70708dcbc24444977b759365f9731f27&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
{&amp;quot;results&amp;quot;:[&lt;br/&gt;
{&amp;quot;seq&amp;quot;:1,&amp;quot;id&amp;quot;:&amp;quot;70708dcbc24444977b759365f9731f27&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]}&lt;br/&gt;
],&lt;br/&gt;
&amp;quot;last_seq&amp;quot;:1}&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test;&quot;&gt;http://127.0.0.1:5984/test;&lt;/a&gt; curl &lt;a href=&quot;http://127.0.0.1:5984/test/_changes&quot;&gt;http://127.0.0.1:5984/test/_changes&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;1d4596c1cb715c0da9f99980fea0a3a2&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
{&amp;quot;results&amp;quot;:[&lt;br/&gt;
{&amp;quot;seq&amp;quot;:1,&amp;quot;id&amp;quot;:&amp;quot;70708dcbc24444977b759365f9731f27&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:2,&amp;quot;id&amp;quot;:&amp;quot;1d4596c1cb715c0da9f99980fea0a3a2&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]}&lt;br/&gt;
],&lt;br/&gt;
&amp;quot;last_seq&amp;quot;:2}&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test;&quot;&gt;http://127.0.0.1:5984/test;&lt;/a&gt; curl &lt;a href=&quot;http://127.0.0.1:5984/test/_changes&quot;&gt;http://127.0.0.1:5984/test/_changes&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;a2feeaaca391446bb7a0f24c359ff79e&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
{&amp;quot;results&amp;quot;:[&lt;br/&gt;
{&amp;quot;seq&amp;quot;:1,&amp;quot;id&amp;quot;:&amp;quot;70708dcbc24444977b759365f9731f27&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:2,&amp;quot;id&amp;quot;:&amp;quot;1d4596c1cb715c0da9f99980fea0a3a2&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:3,&amp;quot;id&amp;quot;:&amp;quot;a2feeaaca391446bb7a0f24c359ff79e&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]}&lt;br/&gt;
],&lt;br/&gt;
&amp;quot;last_seq&amp;quot;:3}&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test;&quot;&gt;http://127.0.0.1:5984/test;&lt;/a&gt; curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test;&quot;&gt;http://127.0.0.1:5984/test;&lt;/a&gt; curl -X POST -d&apos;{}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test;&quot;&gt;http://127.0.0.1:5984/test;&lt;/a&gt; curl &lt;a href=&quot;http://127.0.0.1:5984/test/_changes&quot;&gt;http://127.0.0.1:5984/test/_changes&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;a2262a5904690aec5c64bb61f44903ed&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;26fdac7e139531e0f4352a089d4db7f4&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;f6bb36540484788becd54391dbc6189b&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
{&amp;quot;results&amp;quot;:[&lt;br/&gt;
{&amp;quot;seq&amp;quot;:1,&amp;quot;id&amp;quot;:&amp;quot;70708dcbc24444977b759365f9731f27&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:2,&amp;quot;id&amp;quot;:&amp;quot;1d4596c1cb715c0da9f99980fea0a3a2&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:3,&amp;quot;id&amp;quot;:&amp;quot;a2feeaaca391446bb7a0f24c359ff79e&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:4,&amp;quot;id&amp;quot;:&amp;quot;a2262a5904690aec5c64bb61f44903ed&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:5,&amp;quot;id&amp;quot;:&amp;quot;26fdac7e139531e0f4352a089d4db7f4&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]},&lt;br/&gt;
{&amp;quot;seq&amp;quot;:6,&amp;quot;id&amp;quot;:&amp;quot;f6bb36540484788becd54391dbc6189b&amp;quot;,&amp;quot;changes&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}]}&lt;br/&gt;
],&lt;br/&gt;
&amp;quot;last_seq&amp;quot;:6}&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12740093" author="kocolosk" created="Thu, 6 Aug 2009 15:01:46 +0000 (UTC)"  >+1 on turning off delayed commits by default&lt;br/&gt;
+1 for enabling them on  a per-DB basis&lt;br/&gt;
+0 for making the threshold configurable&lt;br/&gt;
&lt;br/&gt;
We should add a DB-level configuration facility at some point.  It&apos;d be nice to be able to edit this setting (and others, like continuous replication) without server-level admin privileges.</comment>
                    <comment id="12742889" author="kocolosk" created="Thu, 13 Aug 2009 16:48:04 +0000 (UTC)"  >Here&apos;s a patch to make delayed_commits a server-wide config option.  The setting looks like&lt;br/&gt;
&lt;br/&gt;
[couchdb]&lt;br/&gt;
delayed_commits = true&lt;br/&gt;
&lt;br/&gt;
and defaults to false.  If finer-grained control is required users can override the default by setting the X-Couch-Full-Commit header to true or false.&lt;br/&gt;
&lt;br/&gt;
Jan mentioned enabling delayed_commits for the test suite.  I didn&apos;t do this.</comment>
                    <comment id="12743520" author="kocolosk" created="Sat, 15 Aug 2009 02:03:45 +0000 (UTC)"  >we can always add new issues if folks require finer-grained config options like per-DB defaults or custom delays.</comment>
                    <comment id="12743856" author="janl" created="Sun, 16 Aug 2009 17:34:28 +0000 (UTC)"  >For completeness: I turned on delayed commits for the test suite in r804727.</comment>
                    <comment id="12755604" author="jchris" created="Tue, 15 Sep 2009 17:44:58 +0000 (UTC)"  >As we&apos;re currently discussing this on IRC, I should reopen the ticket.&lt;br/&gt;
&lt;br/&gt;
In a simple (naive serial writes) benchmark, I was able to get ~230 docs/sec with delayed_commits and about 5 docs/sec with full commit.&lt;br/&gt;
&lt;br/&gt;
I&apos;m a little concerned that 50x slower is not worth it for correctness, as it puts us in the realm of unusable.</comment>
                    <comment id="12755606" author="jchris" created="Tue, 15 Sep 2009 17:45:38 +0000 (UTC)"  >here&apos;s my benchmark script</comment>
                    <comment id="12772654" author="kocolosk" created="Mon, 2 Nov 2009 20:39:56 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12828268" author="janl" created="Mon, 1 Feb 2010 21:00:21 +0000 (UTC)"  >I call lazy consensus that we keep delayed_commits on by default. Please reopen if you disagree.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416460" name="delayed_commits_v1.patch" size="8389" author="kocolosk" created="Thu, 13 Aug 2009 16:48:04 +0000 (UTC)" />
            <attachment id="12419659" name="slow.rb" size="217" author="jchris" created="Tue, 15 Sep 2009 17:45:38 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 21:00:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 5 Aug 2009 10:02:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-448] Support Gzip encoding for replicating over slow connections</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-448</link>

                    <description>This shouldn&apos;t be too hard to add, we should support it in general for all HTTP requests to the server and also allow it to be enabled in the replicator client for pull/push replication.</description>
                <environment></environment>
            <key id="12432174">COUCHDB-448</key>
        <summary>Support Gzip encoding for replicating over slow connections</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Tue, 4 Aug 2009 16:00:14 +0000 (UTC)</created>
    <updated>Tue, 15 Sep 2009 23:44:33 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12739024" author="kocolosk" created="Tue, 4 Aug 2009 16:35:05 +0000 (UTC)"  >ibrowse does not unzip response bodies, but it&apos;s simple enough to do this ourselves with a call to zlib:gunzip/1</comment>
                    <comment id="12743554" author="kocolosk" created="Sat, 15 Aug 2009 05:17:51 +0000 (UTC)"  >couch_rep_httpc now unzips response bodies</comment>
                    <comment id="12755745" author="jasondd" created="Tue, 15 Sep 2009 22:28:15 +0000 (UTC)"  >This may be of use: &lt;a href=&quot;http://github.com/lgerbarg/couchdb/tree/gzip-support&quot;&gt;http://github.com/lgerbarg/couchdb/tree/gzip-support&lt;/a&gt;</comment>
                    <comment id="12755747" author="jasondd" created="Tue, 15 Sep 2009 22:29:29 +0000 (UTC)"  >Note to self or whoever implements this: the ETag should change depending on what Content-Encoding is used.</comment>
                    <comment id="12755753" author="damienkatz" created="Tue, 15 Sep 2009 22:35:21 +0000 (UTC)"  >Ideally we&apos;ll store attachments gzipped, and then just stream them unchanged for clients that can handle, decompress for clients that can&apos;t.&lt;br/&gt;
&lt;br/&gt;
We&apos;ll probably need a config file to avoid mime types that aren&apos;t compressable, like images and movies.</comment>
                    <comment id="12755798" author="rnewson" created="Tue, 15 Sep 2009 23:44:33 +0000 (UTC)"  >A useful strategy is to compress the first few k and and then either compress the whole thing or not based on the ratio. saves guessing based on mime type.&lt;br/&gt;
&lt;br/&gt;
finally, a naive gzip is vulnerable to zip bombs, so google for that too. :)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 16:35:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-447] autoconf 2.64 throws warnings with configure.ac on ./bootstrap</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-447</link>

                    <description>&amp;gt; autoconf --version &lt;br/&gt;
autoconf (GNU Autoconf) 2.64&lt;br/&gt;
Copyright (C) 2009 Free Software Foundation, Inc.&lt;br/&gt;
License GPLv2+: GNU GPL version 2 or later&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://gnu.org/licenses/old-licenses/gpl-2.0.html&quot;&gt;http://gnu.org/licenses/old-licenses/gpl-2.0.html&lt;/a&gt;&amp;gt;&lt;br/&gt;
This is free software: you are free to change and redistribute it.&lt;br/&gt;
There is NO WARRANTY, to the extent permitted by law.&lt;br/&gt;
&lt;br/&gt;
Written by David J. MacKenzie and Akim Demaille.&lt;br/&gt;
&lt;a href=&apos;mailto:jan@dahlia&apos;&gt;jan@dahlia&lt;/a&gt; ~/Work/couchdb-git (master-288) &lt;br/&gt;
&amp;gt; ./bootstrap &lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
../../lib/autoconf/general.m4:2033: AC_CACHE_VAL is expanded from...&lt;br/&gt;
../../lib/autoconf/general.m4:2046: AC_CACHE_CHECK is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:653: AC_LIBTOOL_COMPILER_OPTION is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:5336: AC_LIBTOOL_PROG_COMPILER_PIC is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:2723: _LT_AC_LANG_C_CONFIG is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:2650: AC_LIBTOOL_LANG_C_CONFIG is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:220: AC_LIBTOOL_SETUP is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:75: _AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:55: AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
configure.ac:31: the top level&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
/usr/share/aclocal/libtool.m4:690: AC_LIBTOOL_LINKER_OPTION is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
/usr/share/aclocal/libtool.m4:3731: _LT_AC_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:2731: AC_LIBTOOL_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:1886: _LT_AC_TAGCONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
/usr/share/aclocal/libtool.m4:3992: _LT_AC_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:3898: AC_LIBTOOL_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
/usr/share/aclocal/libtool.m4:4052: _LT_AC_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
/usr/share/aclocal/libtool.m4:4000: AC_LIBTOOL_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
../../lib/autoconf/general.m4:2033: AC_CACHE_VAL is expanded from...&lt;br/&gt;
../../lib/autoconf/general.m4:2046: AC_CACHE_CHECK is expanded from...&lt;br/&gt;
aclocal.m4:664: AC_LIBTOOL_COMPILER_OPTION is expanded from...&lt;br/&gt;
aclocal.m4:5335: AC_LIBTOOL_PROG_COMPILER_PIC is expanded from...&lt;br/&gt;
aclocal.m4:2730: _LT_AC_LANG_C_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:2661: AC_LIBTOOL_LANG_C_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:231: AC_LIBTOOL_SETUP is expanded from...&lt;br/&gt;
aclocal.m4:86: _AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
aclocal.m4:66: AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
configure.ac:31: the top level&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:701: AC_LIBTOOL_LINKER_OPTION is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:3734: _LT_AC_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:2738: AC_LIBTOOL_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:1897: _LT_AC_TAGCONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:3995: _LT_AC_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:3901: AC_LIBTOOL_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:4051: _LT_AC_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:4003: AC_LIBTOOL_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
../../lib/autoconf/general.m4:2033: AC_CACHE_VAL is expanded from...&lt;br/&gt;
../../lib/autoconf/general.m4:2046: AC_CACHE_CHECK is expanded from...&lt;br/&gt;
aclocal.m4:664: AC_LIBTOOL_COMPILER_OPTION is expanded from...&lt;br/&gt;
aclocal.m4:5335: AC_LIBTOOL_PROG_COMPILER_PIC is expanded from...&lt;br/&gt;
aclocal.m4:2730: _LT_AC_LANG_C_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:2661: AC_LIBTOOL_LANG_C_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:231: AC_LIBTOOL_SETUP is expanded from...&lt;br/&gt;
aclocal.m4:86: _AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
aclocal.m4:66: AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
configure.ac:31: the top level&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:701: AC_LIBTOOL_LINKER_OPTION is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:3734: _LT_AC_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:2738: AC_LIBTOOL_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:1897: _LT_AC_TAGCONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:3995: _LT_AC_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:3901: AC_LIBTOOL_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:4051: _LT_AC_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:4003: AC_LIBTOOL_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
../../lib/autoconf/general.m4:2033: AC_CACHE_VAL is expanded from...&lt;br/&gt;
../../lib/autoconf/general.m4:2046: AC_CACHE_CHECK is expanded from...&lt;br/&gt;
aclocal.m4:664: AC_LIBTOOL_COMPILER_OPTION is expanded from...&lt;br/&gt;
aclocal.m4:5335: AC_LIBTOOL_PROG_COMPILER_PIC is expanded from...&lt;br/&gt;
aclocal.m4:2730: _LT_AC_LANG_C_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:2661: AC_LIBTOOL_LANG_C_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:231: AC_LIBTOOL_SETUP is expanded from...&lt;br/&gt;
aclocal.m4:86: _AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
aclocal.m4:66: AC_PROG_LIBTOOL is expanded from...&lt;br/&gt;
configure.ac:31: the top level&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:701: AC_LIBTOOL_LINKER_OPTION is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:3734: _LT_AC_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:2738: AC_LIBTOOL_LANG_CXX_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:1897: _LT_AC_TAGCONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_CXX, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:3995: _LT_AC_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:3901: AC_LIBTOOL_LANG_F77_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_F77, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_pic_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
aclocal.m4:4051: _LT_AC_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
aclocal.m4:4003: AC_LIBTOOL_LANG_GCJ_CONFIG is expanded from...&lt;br/&gt;
configure.ac:31: warning: AC_CACHE_VAL(lt_prog_compiler_static_works_GCJ, ...): suspicious cache-id, must contain _cv_ to be cached&lt;br/&gt;
You have bootstrapped Apache CouchDB, time to relax.&lt;br/&gt;
&lt;br/&gt;
Run `./configure&apos; to configure the source before you install.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12432144">COUCHDB-447</key>
        <summary>autoconf 2.64 throws warnings with configure.ac on ./bootstrap</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 4 Aug 2009 10:38:12 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 11:58:04 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12738928" author="paul.joseph.davis" created="Tue, 4 Aug 2009 11:18:34 +0000 (UTC)"  >Does that happen everytime and did you just change autoconf or other buildtools versions and if so does it happen on a clean tree?</comment>
                    <comment id="12738935" author="janl" created="Tue, 4 Aug 2009 11:58:04 +0000 (UTC)"  >it happens if I run ./bootstrap on a fresh tree, on a make local-clean&apos;d tree and on a make&apos;d tree&lt;br/&gt;
&lt;br/&gt;
I just updated autoconf</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 11:18:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-446] allow list function and view function to be in different design docs.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-446</link>

                    <description>There has been some discussion on #couchdb how it might be desirable to use a list function where the list and the view are in separate documents.  Among the use-cases is so a list and view can use different languages.&lt;br/&gt;
&lt;br/&gt;
I&apos;m attaching a patch which extends the URL syntax for list views - before my patch, the last portion of the path must be a view name.  My patch allows for the existing behaviour, or for the tail to be 2 elements - another design document name *and* the view name.  Includes a test.</description>
                <environment></environment>
            <key id="12432121">COUCHDB-446</key>
        <summary>allow list function and view function to be in different design docs.</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Tue, 4 Aug 2009 04:40:12 +0000 (UTC)</created>
    <updated>Mon, 17 Aug 2009 23:05:08 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12738818" author="mhammond" created="Tue, 4 Aug 2009 04:41:04 +0000 (UTC)"  >addresses issue, including test.</comment>
                    <comment id="12738954" author="janl" created="Tue, 4 Aug 2009 12:41:28 +0000 (UTC)"  >Mark can you use JSON.parse(xhr.responseText) instead of the regex matching in the tests?&lt;br/&gt;
&lt;br/&gt;
More of a cosmetic remark: TEquals(expected, actual, testName); is preferred over T() (but we&apos;re not strict about that)&lt;br/&gt;
&lt;br/&gt;
Other than that, the patch looks good.</comment>
                    <comment id="12738956" author="paul.joseph.davis" created="Tue, 4 Aug 2009 12:48:35 +0000 (UTC)"  >I agree, we should use T() tests instead of regexp.&lt;br/&gt;
&lt;br/&gt;
I prefer T to TEquals. But TE would be ok. or T.eq(). But don&apos;t consider this a beginning of a &apos;discussion&apos; that ends up with me saying &apos;fine if you want TyesIreallyreallywantthefirstargtobethesameasthesecondarg() then so be it&apos;.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12738958" author="janl" created="Tue, 4 Aug 2009 12:56:43 +0000 (UTC)"  >if a TEquals() (or whatever name) test blows up it is easier to find &amp;amp; debug, hence the preference. maybe I should add that to the coding guide :)</comment>
                    <comment id="12743992" author="mhammond" created="Mon, 17 Aug 2009 08:00:34 +0000 (UTC)"  >Note this test doesn&apos;t use a json response (it is HTML), so it can&apos;t use JSON.parse...</comment>
                    <comment id="12744003" author="janl" created="Mon, 17 Aug 2009 09:20:46 +0000 (UTC)"  >Updated patch to latest trunk. It looks solid. &lt;br/&gt;
&lt;br/&gt;
The one caveat with this is that we will need to special-case in the future when the design docs live on different nodes. Do we want that?</comment>
                    <comment id="12744013" author="jasondd" created="Mon, 17 Aug 2009 10:05:19 +0000 (UTC)"  >Is there another use case for having separate design documents, aside from being able to use different languages for a view and a list?&lt;br/&gt;
&lt;br/&gt;
An alternative solution would be to allow a per-view/list language override, not sure how messy that would be in the query server handling, but it avoids the problem of design docs living on different nodes.  But there may be other use cases that this patch solves too.</comment>
                    <comment id="12744221" author="mhammond" created="Mon, 17 Aug 2009 21:44:15 +0000 (UTC)"  >What is the status of approval for this patch?  It seems to have been approved in principal by Jan back when the patch was uploaded, then yesterday in IRC Jan rejected the concept, but yesterday in this bug appeared to re-approve the concept.  I&apos;m getting somewhat mixed-messages.</comment>
                    <comment id="12744247" author="janl" created="Mon, 17 Aug 2009 22:33:11 +0000 (UTC)"  >@Markh, my comments on that patch were my own, not an official statement.&lt;br/&gt;
&lt;br/&gt;
I didn&apos;t think of the concern I have now when I originally told you the patch looked good and I wanted to discuss the issue with the other developers.&lt;br/&gt;
&lt;br/&gt;
dev@, comments please :)</comment>
                    <comment id="12744257" author="paul.joseph.davis" created="Mon, 17 Aug 2009 22:48:20 +0000 (UTC)"  >I&apos;m ok with this. There was a comment somewhere about just adding a language to each list function, but if we&apos;re gonna do that then I&apos;d say we should make language specifiable for all functions on a design doc individually. But that&apos;d probably be a pretty big effort, so I&apos;d still be ok with putting this in as a stop gap until we decide what to do for any major changes.</comment>
                    <comment id="12744260" author="jchris" created="Mon, 17 Aug 2009 23:03:35 +0000 (UTC)"  >I think this stuff is gonna be messy with options eventually anyway.&lt;br/&gt;
&lt;br/&gt;
Three cheers to anyone who thinks of a nice way to do a unified API.&lt;br/&gt;
&lt;br/&gt;
+1 on putting this patch in.</comment>
                    <comment id="12744262" author="jchris" created="Mon, 17 Aug 2009 23:04:51 +0000 (UTC)"  >crucial to my last comment yet untyped:&lt;br/&gt;
&lt;br/&gt;
It&apos;d be nice to make lists work on built in views like _all_docs and _changes.&lt;br/&gt;
&lt;br/&gt;
not for this patch, but just as long as we are on the topic of unified APIs...&lt;br/&gt;
&lt;br/&gt;
I think this patch is ready to go in.</comment>
                    <comment id="12744264" author="janl" created="Mon, 17 Aug 2009 23:05:08 +0000 (UTC)"  >Applied in r805201.</comment>
                </comments>
    
    <attachments>
            <attachment id="12415453" name="x_doc_list.patch" size="5335" author="mhammond" created="Tue, 4 Aug 2009 04:41:04 +0000 (UTC)" />
            <attachment id="12416758" name="x_doc_list_jan.patch" size="5362" author="janl" created="Mon, 17 Aug 2009 09:20:46 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 17 Aug 2009 23:05:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 12:41:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-445] &apos;--with-js-lib&apos; and &apos;--with-js-include&apos; don&apos;t override a lib named libjs.so|dylib that is part of a standard install with a custom installed libmozjs.so|dylib library</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-445</link>

                    <description>&amp;gt; ls /usr/local/lib/libjs.dylib &lt;br/&gt;
/usr/local/lib/libjs.dylib*&lt;br/&gt;
&lt;br/&gt;
&amp;gt; ls /tmp/lib/&lt;br/&gt;
libjs_static.a*	libmozjs.dylib*&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
./configure --with-js-lib=/tmp/lib/ --with-js-include=/tmp/include/&lt;br/&gt;
...&lt;br/&gt;
checking for JS_NewContext in -ljs... yes&lt;br/&gt;
...&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;^- would have expected:&lt;br/&gt;
&amp;nbsp;...&lt;br/&gt;
&amp;nbsp;checking for JS_NewContext in -ljs... no&lt;br/&gt;
&amp;nbsp;checking for JS_NewContext in -lmozjs... yes&lt;br/&gt;
&amp;nbsp;...</description>
                <environment>Mac OS X 10.5.7</environment>
            <key id="12432007">COUCHDB-445</key>
        <summary>&apos;--with-js-lib&apos; and &apos;--with-js-include&apos; don&apos;t override a lib named libjs.so|dylib that is part of a standard install with a custom installed libmozjs.so|dylib library</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sun, 2 Aug 2009 19:22:54 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 12:31:24 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12738945" author="janl" created="Tue, 4 Aug 2009 12:31:24 +0000 (UTC)"  >Committed with the fix for &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-228&quot; title=&quot;Futon access couchdb&apos;s config&quot;&gt;COUCHDB-228&lt;/a&gt; in r800750.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 12:31:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-444] include_docs does not work with _list functions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-444</link>

                    <description>Row provided to _list functions do not include docs when include_docs is specified.</description>
                <environment>OSX running CouchDBX</environment>
            <key id="12431951">COUCHDB-444</key>
        <summary>include_docs does not work with _list functions</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="codesturgeon">Nick Fisher</reporter>
            
    <created>Sat, 1 Aug 2009 04:35:40 +0000 (UTC)</created>
    <updated>Sat, 1 Aug 2009 11:17:09 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12737837" author="mhammond" created="Sat, 1 Aug 2009 06:11:55 +0000 (UTC)"  >I struck this same issue myself, decided to look into it, then found it was *nearly* supported already.  Attaching a simple patch which fixes this (and also in a list_include_doc branch at my github clone)</comment>
                    <comment id="12737863" author="mhammond" created="Sat, 1 Aug 2009 11:04:11 +0000 (UTC)"  >test case</comment>
                    <comment id="12737866" author="janl" created="Sat, 1 Aug 2009 11:17:09 +0000 (UTC)"  >Patch committed in r799835</comment>
                </comments>
    
    <attachments>
            <attachment id="12415224" name="list_include_docs.patch" size="2617" author="mhammond" created="Sat, 1 Aug 2009 06:11:55 +0000 (UTC)" />
            <attachment id="12415233" name="list_include_docs_test.patch" size="1059" author="mhammond" created="Sat, 1 Aug 2009 11:04:11 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 1 Aug 2009 11:17:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 1 Aug 2009 06:11:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-443] rc.d leaves stderr open causing controlling programs to share</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-443</link>

                    <description>The fix to keep this from hanging chef-client:&lt;br/&gt;
&lt;br/&gt;
testchef:~# diff couchdb.orig couchdb&lt;br/&gt;
88c88&lt;br/&gt;
&amp;lt;         if su $COUCHDB_USER -c &amp;quot;$command&amp;quot; &amp;gt; /dev/null ; then&lt;br/&gt;
---&lt;br/&gt;
&amp;gt;         if su $COUCHDB_USER -c &amp;quot;$command&amp;quot; &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 ; then&lt;br/&gt;
94c94&lt;br/&gt;
&amp;lt;         if $command &amp;gt; /dev/null ; then&lt;br/&gt;
---&lt;br/&gt;
&amp;gt;         if $command &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 ; then&lt;br/&gt;
</description>
                <environment>linux/debian/lenny</environment>
            <key id="12431944">COUCHDB-443</key>
        <summary>rc.d leaves stderr open causing controlling programs to share</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="sigmonsays">Sig L</reporter>
            
    <created>Fri, 31 Jul 2009 22:44:39 +0000 (UTC)</created>
    <updated>Fri, 31 Jul 2009 22:44:39 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="900">0.25h</timeoriginalestimate>        <timeestimate seconds="900">0.25h</timeestimate>                    

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-442] Add a &quot;view&quot; or &quot;format&quot; function to process source doc on query</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-442</link>

                    <description>It is common practice to do emit(key, null) in a map function and then query with ?include_docs=true to retrieve the documents that were responsible for the entries.  However, the full document may include information that is privileged or the full document may be substantially larger than the information needed to be transferred to the client.&lt;br/&gt;
&lt;br/&gt;
The proposed enhancement is to allow defining a &amp;quot;view&amp;quot; function in addition to the existing &amp;quot;map&amp;quot; and &amp;quot;reduce&amp;quot; on a view.  If specified, the view function would take the id, key, value and doc and return a JSON value that would be added as the &amp;quot;view&amp;quot; member to the row in the result set.&lt;br/&gt;
&lt;br/&gt;
One of the use cases on &lt;a href=&quot;http://wiki.apache.org/couchdb/Authentication_and_Authorization&quot;&gt;http://wiki.apache.org/couchdb/Authentication_and_Authorization&lt;/a&gt; is to be able to specify that a user can retrieve the values from a view, but not add include_docs since that may expose information that they are not authorized to view.  Without the &amp;quot;view&amp;quot; function, there would be pressure to start pushing things into the emitted value.&lt;br/&gt;
&lt;br/&gt;
Production of views would be likely controlled using a include_views=true in the query string.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12431711">COUCHDB-442</key>
        <summary>Add a &quot;view&quot; or &quot;format&quot; function to process source doc on query</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="7">Later</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="carnold@apache.org">Curt Arnold</reporter>
            
    <created>Wed, 29 Jul 2009 16:51:02 +0000 (UTC)</created>
    <updated>Fri, 31 Jul 2009 03:44:59 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12736723" author="paul.joseph.davis" created="Wed, 29 Jul 2009 17:37:03 +0000 (UTC)"  >What reason is there for not just putting the extra data in the value? I can understand barring include_docs=true for clients this extra functionality seems quite unnecessary.</comment>
                    <comment id="12736735" author="carnold@apache.org" created="Wed, 29 Jul 2009 18:16:01 +0000 (UTC)"  >Say we have a personnel system where documents contain some confidential info (perhaps Social Security Number) and some less restricted info like education location, phone number, blog entries, etc.  Say the split is only 5% confidential and 95% public.  I want to create views by university, graduation date, phone number, location, department, etc.  On each of the queries, I&apos;d like a class of users to see everything public about the person but not any of the confidential info.&lt;br/&gt;
&lt;br/&gt;
Without the view function, one option would be calling something like:&lt;br/&gt;
&lt;br/&gt;
emit(key, sanitize(doc));&lt;br/&gt;
&lt;br/&gt;
in the map function for each of the views which would be 95% as bad as doing emit(key, doc).  Basically, everything that would motivate you to do emit(key, null) over emit(key, doc) comes into play, but just slightly reduced.&lt;br/&gt;
&lt;br/&gt;
Another workaround would be to grab the ids and just attempt to retrieve all the underlying documents.  Some other part of the authentication system would need to prevent retrieving the confidential info either by rejecting the request for the entire document or sanitizing it.  &lt;br/&gt;
&lt;br/&gt;
Allowing access to a views but disabling include_docs and preventing direct retrievals of doc is my best analogy to authorizing access to SQL views but restricting direct access to the tables.&lt;br/&gt;
&lt;br/&gt;
While the main motivation is preparing for a more beefed up authentication and authorization, it would seem to have some independent usefulness.  Plus it would appear to require any additional resources until serializing the result set and then only if the user added ?include_views=true.&lt;br/&gt;
</comment>
                    <comment id="12736743" author="paul.joseph.davis" created="Wed, 29 Jul 2009 18:39:13 +0000 (UTC)"  >Still not convinced. I&apos;m basically reading this as an argument for adding some special code for making list and show functions not be tied to the underlying document or view which should be more than reasonable. include_docs=true would definitely need to respect ACL&apos;s of any sort, and it should do that with a trivial patch if it doesn&apos;t do it already.&lt;br/&gt;
&lt;br/&gt;
The example for emit(key, sanitize(doc)) is lost on me. If you have a view, and want the user to have access to extra information in the doc when reading that view, just include it in the view and use whatever access control we might have in place for reading views.&lt;br/&gt;
&lt;br/&gt;
And lastly, If you&apos;re data is 95% public then I&apos;d start suggesting that you might want to consider two databases, one for the private and one for public. The only analogy that I can think of is trying to keep water in a colander, you can try and plug every hole or turn off the tap. I&apos;m a turn off the tap kind of guy.</comment>
                    <comment id="12736791" author="carnold@apache.org" created="Wed, 29 Jul 2009 20:16:16 +0000 (UTC)"  >Not sure if I&apos;m understanding the first sentence.  I am specifically suggesting additional code that is part of a view.  A view/format/display function  that would be a peer to the map and reduce function which could be used to process the matched documents so that only the information that is necessary to support the related business function is exposed.  Something analogous to being able to included only certain columns in a SQL view.&lt;br/&gt;
&lt;br/&gt;
The case was a hypothetical and you would definitely need to partition information across documents if users who could not see the SSN could update other parts of the info on an individual.  However, if you start defining 20 different business functions and each has need to see a slightly different subset of the data, then trying to accomplish that through partitioning (either document or database) becomes untenable.  Partitioning sensitive info into a different database then would cost you the ability to do views that combined sensitive and less-sensitive info.&lt;br/&gt;
&lt;br/&gt;
Having the extra function which executes when serializing is an optimization over emitting a part of the document at map time, but it seems like it would be a very desirable optimization when authentication and authorization is more mature and could be useful now.  Just trying to get things that fall out from the authentication and authorizations discussions visible in JIRA for elaboration and consideration.&lt;br/&gt;
</comment>
                    <comment id="12736836" author="paul.joseph.davis" created="Wed, 29 Jul 2009 21:07:52 +0000 (UTC)"  >This description &amp;quot;A view/format/display function that would be a peer to the map and reduce function which could be used to process the matched documents so that only the information that is necessary to support the related business function is exposed.&amp;quot; is pretty much what _list and _show are meant for. If _list doesn&apos;t have access to include_docs (which theoretically it should already have) then we can definitely look at adding that.&lt;br/&gt;
&lt;br/&gt;
I&apos;d also prefer to keep general discussions on the dev@ list so that we can try and keep the JIRA SNR at a sane level.</comment>
                    <comment id="12736975" author="carnold@apache.org" created="Thu, 30 Jul 2009 03:28:57 +0000 (UTC)"  >I wasn&apos;t familiar with _lists and _shows, I&apos;ve been head down into an system using CouchDB for a while and hadn&apos;t tracked their development.  There are some similarities between the functionality, but not quite the same.&lt;br/&gt;
&lt;br/&gt;
To accomplish the authorization goal, you would need to be able to specify that a user could run a particular view only when it is in the context of a specific list request.  That would require the view processor to be aware of its context and run with some elevated privilege which sounds like a recipe for problems.&lt;br/&gt;
&lt;br/&gt;
JIRA works well to focus discussion around specific feature requests.  Having specific byte-sized enhancements defined in JIRA should make it easier to new people to pick up and contribute to the project.  However, I&apos;ll switch to starting discussion on new features on the mailing list first and then create the JIRA entry when the discussion dies down.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12736979" author="paul.joseph.davis" created="Thu, 30 Jul 2009 04:01:09 +0000 (UTC)"  >Right, we&apos;d need to add ACL support to _list and _show to accomplish the original intent, but that was my reason for doubting the feature; we can just roll this functionality into the existing feature set.&lt;br/&gt;
&lt;br/&gt;
Closing this because it probably won&apos;t happen. When some of the upcoming auth/access patches hit similar functionality will most likely get rolled into _list and _show. For interested listeners, keep an ear to the dev@ ground for updates.</comment>
                    <comment id="12737340" author="jchris" created="Thu, 30 Jul 2009 22:50:11 +0000 (UTC)"  >for what it&apos;s worth:&lt;br/&gt;
&lt;br/&gt;
emit(key, sanitize(doc)); &lt;br/&gt;
&lt;br/&gt;
this is the &amp;quot;right&amp;quot; way to do it. include_docs should be avoided in production code paths (admin is fine) especially where you&apos;ll be selecting a non-trivial number of rows.</comment>
                    <comment id="12737411" author="kocolosk" created="Fri, 31 Jul 2009 03:44:59 +0000 (UTC)"  >Hmm Chris, I&apos;m not sure I agree with that statement.  I&apos;ve seen production setups with ~5 GB view indexes where the view emitted (key,null) and used include_docs=true for the lookup.  If the view had used sanitize(doc) it would&apos;ve been much too big to be cached in main memory.  Then you&apos;re pretty well screwed.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 30 Jul 2009 04:01:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 29 Jul 2009 17:37:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-441] Finally implement pre-write-doc-edit handlers.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-441</link>

                    <description>It would be useful for auditing to have the identity of the user who inserted a new revision and the timestamp of the operation to be inserted in the document in the same way that the new revision number is.&lt;br/&gt;
&lt;br/&gt;
Doing this at the application level is not adequate since it would be readily spoofable and would bypass the authentication handler.&lt;br/&gt;
&lt;br/&gt;
There is a comment in couch_db:update_docs about generating new revision ids, but I couldn&apos;t quite comprehend what specific code was responsible for inserting the id into the document.</description>
                <environment></environment>
            <key id="12431706">COUCHDB-441</key>
        <summary>Finally implement pre-write-doc-edit handlers.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="carnold@apache.org">Curt Arnold</reporter>
            
    <created>Wed, 29 Jul 2009 16:08:58 +0000 (UTC)</created>
    <updated>Mon, 14 Sep 2009 10:44:02 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>2</votes>
    
                                        

            <comments>
                    <comment id="12736687" author="paul.joseph.davis" created="Wed, 29 Jul 2009 16:17:38 +0000 (UTC)"  >Inserting timestamps automagically would be bad because it would limit a whole swath of use cases. Probably the same for user id.&lt;br/&gt;
&lt;br/&gt;
The feature you&apos;re wanting is the end point that allows a JavaScript function to mutate incoming docs before they&apos;re written to the DB. If there isn&apos;t a ticket for that yet please create one so that it stares at us like a lost puppy and it&apos;ll be gotten to.</comment>
                    <comment id="12736742" author="carnold@apache.org" created="Wed, 29 Jul 2009 18:37:09 +0000 (UTC)"  >Reopened the bug with a new title that focuses more on the use-case than the approach.&lt;br/&gt;
&lt;br/&gt;
I guess I could see situations where you may not want to have that info inserted into the documents, so it would need to be configurable.&lt;br/&gt;
&lt;br/&gt;
Could be something similar to validate_doc_update (would likely need to occur before validate_doc_update) but would have the ability to modify the document, would need to have access to the user_ctx and maybe something equivalent for the server context.</comment>
                    <comment id="12736744" author="paul.joseph.davis" created="Wed, 29 Jul 2009 18:44:04 +0000 (UTC)"  >Renamed before I forget what the other title means.</comment>
                    <comment id="12737136" author="rburke" created="Thu, 30 Jul 2009 15:23:48 +0000 (UTC)"  >We could use either a generic hook to insert timestamps ourselves, or some built-in handling where possibly the string $now$ in the JSON (possibly with a format specifier to get ISO 8601 dates or other date formats) gets replaced with the current UTC time.  &lt;br/&gt;
&lt;br/&gt;
We have many timestamps that we need to record other than just created / last modified (when the user completed a certain workflow step, etc).  We can keep a few db machines in close enough synch with a time server.  We cannot rely on our client machines to have the correct time.</comment>
                    <comment id="12737187" author="rburke" created="Thu, 30 Jul 2009 17:26:06 +0000 (UTC)"  >Being able to insert info in docs when committed to the db implies that using PUT/POST to create/update a document needs to return more in the response than what it currently does, for example: {&amp;quot;ok&amp;quot;:true, &amp;quot;id&amp;quot;:&amp;quot;123BAC&amp;quot;, &amp;quot;rev&amp;quot;:&amp;quot;946B7D1C&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
It probably needs to return the entire JSON of the new or updated doc.  Otherwise, gotta call the db twice.</comment>
                    <comment id="12737214" author="carnold@apache.org" created="Thu, 30 Jul 2009 18:22:07 +0000 (UTC)"  >&amp;nbsp;?include_doc=true could be borrowed from the view syntax so that you got the committed doc back as the &amp;quot;doc&amp;quot; member of the reply regardless of whether there was any pre-write-doc-edit handler.  If you aren&apos;t modifying or you don&apos;t need the doc, you could omit the param or set it to false.&lt;br/&gt;
&lt;br/&gt;
I&apos;d discourage special replacements sequences, then you have to figure out how to escape them when you really wanted a literal &amp;quot;$now$&amp;quot; in the body.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12738004" author="paul.joseph.davis" created="Sun, 2 Aug 2009 07:06:21 +0000 (UTC)"  >Yep. This is a patch for _update handlers.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
To use them, create a _design doc that looks like this:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;_id&amp;quot;: &amp;quot;_design/foo&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;updates&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;mult&amp;quot;: &amp;quot;function(oldDoc, newDoc, req, userCtx) {oldDoc.value = oldDoc.value * 2;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
And then PUT a document to this URL:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/db_name/_design/foo/_update/mult/$&quot;&gt;http://127.0.0.1:5984/db_name/_design/foo/_update/mult/$&lt;/a&gt;{DOCID}&lt;br/&gt;
&lt;br/&gt;
or POST a document to&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/db_name/_design/foo/_update/mult&quot;&gt;http://127.0.0.1:5984/db_name/_design/foo/_update/mult&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
You can also pull the code from:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;git://github.com/davisp/couchdb.git&quot;&gt;git://github.com/davisp/couchdb.git&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
If you&apos;re of the git persuasion.&lt;br/&gt;
&lt;br/&gt;
Also, I realized while implementing this that it more or less enables an often sought after ability with a small caveat. +1 beer to the person that spots that. +6 beers to the person that sees the caveat.&lt;br/&gt;
&lt;br/&gt;
Yay updates!&lt;br/&gt;
</comment>
                    <comment id="12738023" author="jasondd" created="Sun, 2 Aug 2009 09:08:31 +0000 (UTC)"  >Nice work Paul!  One thing I noticed about your patch is that _update expects a JSON body in the request.  Can we remove this requirement and make it so the function signature is simply (doc, req, userCtx)?  In my oauth branch I&apos;ve modified couch_httpd_external.erl to always populate req.userCtx so the function signature will be even shorter when this gets merged.&lt;br/&gt;
&lt;br/&gt;
Then we can do fun things like handle XML bodies in the request.</comment>
                    <comment id="12738096" author="jasondd" created="Sun, 2 Aug 2009 17:18:49 +0000 (UTC)"  >The other thing I forgot to mention is that I would like the function to return an arbitrary response body too, so the function would be something like:&lt;br/&gt;
&lt;br/&gt;
function(doc, req) {&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// do some processing on doc&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;return {doc: doc, body: body, headers: headers};&lt;br/&gt;
&lt;br/&gt;
}</comment>
                    <comment id="12738119" author="benoitc" created="Sun, 2 Aug 2009 19:17:02 +0000 (UTC)"  >Why another url handelr and not reusing _show ? Having all verbs on one place would be interresting. I don&apos;t have time to test it right now, but I will tomottow morning.</comment>
                    <comment id="12738120" author="cmlenz" created="Sun, 2 Aug 2009 19:38:41 +0000 (UTC)"  >I think a post-save update function should be exactly analogous to the validate_doc_func feature already in CouchDB: add a function to the design doc, and have CouchDB invoke it for any document update.&lt;br/&gt;
&lt;br/&gt;
In fact, this functionality could be part of the validation routine if the doc wasn&apos;t made read-only (and the function returned a new document), saving some overhead.&lt;br/&gt;
&lt;br/&gt;
Am I missing something?</comment>
                    <comment id="12738122" author="janl" created="Sun, 2 Aug 2009 19:50:45 +0000 (UTC)"  >@christopher validation runs on replication time. update modifications do not.</comment>
                    <comment id="12738124" author="paul.joseph.davis" created="Sun, 2 Aug 2009 19:54:39 +0000 (UTC)"  >My original thoughts were that this would be a pretty thin wrapper that would mutate a single document when putting. Adding the ability to work with arbitrary data and return arbitrary responses changes the game somewhat.&lt;br/&gt;
&lt;br/&gt;
I&apos;d disagree pretty strongly with using _show because the basic intent is quite different.&lt;br/&gt;
&lt;br/&gt;
The other thing I just realized is that there&apos;s also no way to use the current scheme with _bulk_docs.&lt;br/&gt;
&lt;br/&gt;
Things to think about.</comment>
                    <comment id="12738126" author="paul.joseph.davis" created="Sun, 2 Aug 2009 20:10:10 +0000 (UTC)"  >@christopher&lt;br/&gt;
&lt;br/&gt;
The other thing about validate_doc_update is that ordering isn&apos;t important. Any function can veto the update. But for mutation operations if we allow any number of functions then your function has to accept any possible configuration of the order of applying those functions. And it has to work with possibly unknown other code in the same db. Basically the possibilities started hurting my brain so I just went with the url approach.&lt;br/&gt;
</comment>
                    <comment id="12738178" author="carnold@apache.org" created="Mon, 3 Aug 2009 03:09:16 +0000 (UTC)"  >I wasn&apos;t expecting a new API,  but a designable or configurable feature for the existing _bulk_docs and PUT request handlers.  If you were using this to ensure that all documents had the appropriate username, timestamp, requesting ip address of last modification,  you&apos;d need to disable _bulk_docs and the  PUT docid and rewrite all apps to use this new API.&lt;br/&gt;
&lt;br/&gt;
A doc-edit-handler in the existing API would probably still be called on replication, but could distinguish between a replication action and a normal action.&lt;br/&gt;
&lt;br/&gt;
As for the multiple doc-edit-handler, I think you could accept multiple handlers, but explicitly declare that there is no promised ordering.  If a designer adds doc-edit-handlers that conflict or have an order-dependency, then they have nobody to blame except themselves.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12738190" author="paul.joseph.davis" created="Mon, 3 Aug 2009 05:14:52 +0000 (UTC)"  >Curt,&lt;br/&gt;
&lt;br/&gt;
Three things that come to mind:&lt;br/&gt;
&lt;br/&gt;
1. What would the API look like if it weren&apos;t an API endpoint? I just ran with what was easy to implement, but between your&apos;s, Jason&apos;s and Chritopher&apos;s comments I&apos;m wondering if maybe there&apos;s another approach that is more general.&lt;br/&gt;
&lt;br/&gt;
2. I&apos;m fairly against calling mutation handlers on replication as it seems like it could very easily lead to an inability to reach steady state. If we force clients to choose to push docs to a handler that is OOB from replication then we alleviate such concerns.&lt;br/&gt;
&lt;br/&gt;
3. I&apos;m also fairly against the arbitrary ordering. A big understanding in the community is that we&apos;re presenting users the ability to replicate _design docs as an entire application. Forcing applications to write against transient undefinable situations seems like a recipe for disaster. The question isn&apos;t if I as a design declare an edit function, its that I have to account for any possible configuration of order of any possible input. I could see it being very easy for two independent designers declaring mutually exclusive conditions and rending a DB un-editable from app code.&lt;br/&gt;
&lt;br/&gt;
Paul&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12738384" author="carnold@apache.org" created="Mon, 3 Aug 2009 15:14:42 +0000 (UTC)"  >1. Other than possibly adding a ?include_doc(s) query parameter that would indicate whether the modified doc needs to be returned, I would not see the HTTP API changing.  On the back-end, I&apos;d be open to anything from a hard-coded entry, configured Erlang handler or design doc similar to validate_doc.&lt;br/&gt;
&lt;br/&gt;
2. I&apos;m thinking there is already a different code path for replication since I&apos;d think that replication would preserve the existing revision id.  However, on my initial scan of couch_db:update_docs, I could not identify the code that was responsible for generating the new revision id.  If done with a design doc approach, either the function would not be called on during replication, the design doc would define whether it was called during replication, or the function would be called but it could detect whether it was being called during replication.  I haven&apos;t thought of a reason that you&apos;d want to invoke during replication, so I&apos;d be fine with any of them.&lt;br/&gt;
&lt;br/&gt;
3. Instead of having the edit function directly modifying the document, it could return a document that is merged into the existing document.  Any top-level key that is present in the return value from an doc-edit function would be inserted in the document replacing any existing value for that key in the document.  However, if multiple edit functions add the same key value, the PUT would fail with a conflict error.</comment>
                    <comment id="12739363" author="jasondd" created="Wed, 5 Aug 2009 07:49:23 +0000 (UTC)"  >Updated patch that uses req.userCtx now that OAuth/cookie auth has landed.</comment>
                    <comment id="12741210" author="jasondd" created="Mon, 10 Aug 2009 07:01:50 +0000 (UTC)"  >Forgot to include new files share/server/update.js and share/www/script/test/updates.js.  Included in this patch.</comment>
                    <comment id="12754917" author="janl" created="Mon, 14 Sep 2009 10:44:02 +0000 (UTC)"  >Fixed in trunk and 0.10 earlier this year.</comment>
                </comments>
    
    <attachments>
            <attachment id="12415582" name="COUCHDB-441.2.patch" size="17365" author="jasondd" created="Wed, 5 Aug 2009 07:49:23 +0000 (UTC)" />
            <attachment id="12416026" name="COUCHDB-441.3.patch" size="21477" author="jasondd" created="Mon, 10 Aug 2009 07:01:50 +0000 (UTC)" />
            <attachment id="12415263" name="COUCHDB-441.patch" size="10289" author="paul.joseph.davis" created="Sun, 2 Aug 2009 07:06:21 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Sep 2009 10:44:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 29 Jul 2009 16:17:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-440] Fix windows libname_spec hacks in configure.ac</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-440</link>

                    <description>The windows build process has a hack at the end of configure.ac, which runs sed over libtool to fix the libname_spec option and remove the -link option.  I suspect this is related to attempting to combine usage of libtool with erlang&apos;s cc.sh script we use; erlang&apos;s build process doesn&apos;t use libtool.</description>
                <environment>Windows</environment>
            <key id="12431659">COUCHDB-440</key>
        <summary>Fix windows libname_spec hacks in configure.ac</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Wed, 29 Jul 2009 03:52:04 +0000 (UTC)</created>
    <updated>Wed, 29 Jul 2009 03:52:04 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-439] Fix bogus $(INSTALL) of couchspawnkillable.exe on Windows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-439</link>

                    <description>There is a bogus $INSTALL in src/Makefile.am which needs to be fixed once a work around is determined.</description>
                <environment>Windows</environment>
            <key id="12431658">COUCHDB-439</key>
        <summary>Fix bogus $(INSTALL) of couchspawnkillable.exe on Windows</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Wed, 29 Jul 2009 03:36:57 +0000 (UTC)</created>
    <updated>Wed, 29 Jul 2009 03:38:44 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12736430" author="mhammond" created="Wed, 29 Jul 2009 03:38:44 +0000 (UTC)"  >From IRC:&lt;br/&gt;
&lt;br/&gt;
(10:11:07 AM) nslater: markh: I&apos;m not happy with this:&lt;br/&gt;
(10:11:09 AM) nslater: $(INSTALL) priv/.libs/couchspawnkillable.exe &amp;quot;$(DESTDIR)$(couchprivdir)/.&amp;quot;&lt;br/&gt;
(10:11:20 AM) markh: me either :(&lt;br/&gt;
(10:11:29 AM) nslater: markh: can you post to the automake list with a description of the problem, to see what they come up with? they&apos;re usually pretty helpful&lt;br/&gt;
(10:11:49 AM) markh: I think it is more libtool related&lt;br/&gt;
(10:12:00 AM) markh: as the comments say, I end up with *2* executables - one broken, one working&lt;br/&gt;
(10:12:21 AM) markh: the broken one is what gets copied by default.  That line overwrites the broken one with the good one :(&lt;br/&gt;
(10:12:48 AM) nslater: yeah, dunno. its usual to end up with two, with one under .libs - but I dunno why one would work, and one wouldn&apos;t. perhaps something is done to the one under .libs after it is copied into the regular place&lt;br/&gt;
(10:12:59 AM) markh: and &apos;libtool related&apos; is also hard - we are using the frankenstein .sh scripts from erlang for the compiler and linker&lt;br/&gt;
(10:13:09 AM) markh: they are linked differently&lt;br/&gt;
(10:13:23 AM) nslater: the automake list is probably the best place to start... even if it just means they bounce you off some place else</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-438] Add per database (OAuth) authentication to couchdb</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-438</link>

                    <description>In set-ups where a couchdb node holds databases for many different users that are not allowed to see each other&apos;s data, it is vital that it is possible to give users separate roles for each database. &lt;br/&gt;
&lt;br/&gt;
It would be best if adding new users, and assigning roles to users for specific databases could be done through the http interface, as modifying .ini files becomes unwieldy for large numbers of users.</description>
                <environment></environment>
            <key id="12431582">COUCHDB-438</key>
        <summary>Add per database (OAuth) authentication to couchdb</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jasondd">Jason Davies</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Tue, 28 Jul 2009 09:55:56 +0000 (UTC)</created>
    <updated>Mon, 12 Oct 2009 22:48:41 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>2</votes>
    
                                        

            <comments>
                    <comment id="12742162" author="janl" created="Wed, 12 Aug 2009 00:58:47 +0000 (UTC)"  >bump to 0.11</comment>
                    <comment id="12746610" author="janl" created="Sun, 23 Aug 2009 14:45:17 +0000 (UTC)"  >properly bump to 0.11</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 12 Aug 2009 00:58:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-437] Make compression level configurable, and allow attachments to be compressed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-437</link>

                    <description>As suggested by Adam Kocolosk in &lt;a href=&quot;http://www.mail-archive.com/dev@couchdb.apache.org/msg02858.html&quot;&gt;http://www.mail-archive.com/dev@couchdb.apache.org/msg02858.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&amp;gt; The nice thing is that binary_to_term seems perfectly happy reading a mix of compressed and uncompressed binaries, which means the compression level can be a configuration parameter if we want it to be. gzip decompresses pretty quickly, so I&apos;m guessing that reading a compressed DB will be faster than an uncompressed one. We&apos;ll have to measure it, though.&lt;br/&gt;
&lt;br/&gt;
Just thinking that space may be at a premium for some users and enabling compression could save them quite a bit of space depending on the data stored in docs.  Compressing attachments could be beneficial too, and for particular use cases compression might increase read throughput due to needing less disk reads.  As Adam says, we need to measure it.</description>
                <environment></environment>
            <key id="12431532">COUCHDB-437</key>
        <summary>Make compression level configurable, and allow attachments to be compressed</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Mon, 27 Jul 2009 19:37:18 +0000 (UTC)</created>
    <updated>Tue, 22 Dec 2009 03:49:06 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12792982" author="fdmanana" created="Sun, 20 Dec 2009 10:52:36 +0000 (UTC)"  >This seems to be the same feature as the one for ticket 583 =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-583&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-583&lt;/a&gt;</comment>
                    <comment id="12793148" author="fdmanana" created="Mon, 21 Dec 2009 10:36:53 +0000 (UTC)"  >Same patch as the one attached to ticket 583 (updated etap test suite with more tests).&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12793439" author="fdmanana" created="Tue, 22 Dec 2009 00:43:26 +0000 (UTC)"  >latest patch added to ticket 583</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12441889">COUCHDB-583</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12428567" name="couchdb-583-trunk-4th-try-trunk.patch" size="62831" author="fdmanana" created="Sun, 20 Dec 2009 10:52:36 +0000 (UTC)" />
            <attachment id="12428619" name="couchdb-583-trunk-5th-try.patch" size="69519" author="fdmanana" created="Mon, 21 Dec 2009 10:36:52 +0000 (UTC)" />
            <attachment id="12428675" name="couchdb-583-trunk-6th-try.patch" size="74067" author="fdmanana" created="Tue, 22 Dec 2009 00:43:26 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 20 Dec 2009 10:52:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-436] Allow update or creation of document and attachments in single multipart POST</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-436</link>

                    <description>&lt;br/&gt;
Modify the existing multipart/form-data POST handling to accept an additional _doc form parameter. This allows a single operation to create a document with all of its attachments.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12431516">COUCHDB-436</key>
        <summary>Allow update or creation of document and attachments in single multipart POST</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Mon, 27 Jul 2009 15:59:15 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 14:23:50 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12735636" author="rnewson" created="Mon, 27 Jul 2009 16:00:43 +0000 (UTC)"  >&lt;br/&gt;
If form data includes _doc, interpret it as JSON and treat it the same as a POST update to the document.</comment>
                    <comment id="12773069" author="janl" created="Tue, 3 Nov 2009 14:23:50 +0000 (UTC)"  >Applied in r832427.</comment>
                </comments>
    
    <attachments>
            <attachment id="12414634" name="COUCHDB-436.patch" size="1005" author="rnewson" created="Mon, 27 Jul 2009 16:00:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Nov 2009 14:23:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Nov 2009 14:23:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-435] Build against spidermonkey in xulrunner-1.9.1</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-435</link>

                    <description>JSOPTION_NATIVE_BRANCH_CALLBACK doesn&apos;t exist in newer spidermonkeys. Minor patch to handle this properly against both older and newer codebases. &lt;br/&gt;
&lt;br/&gt;
Changelog data:&lt;br/&gt;
&lt;br/&gt;
Patch by Alexander Sack &amp;lt;&lt;a href=&apos;mailto:asac@ubuntu.com&apos;&gt;asac@ubuntu.com&lt;/a&gt;&amp;gt;&lt;br/&gt;
</description>
                <environment>Ubuntu 9.10, may apply to other Firefox 3.5 platforms</environment>
            <key id="12431509">COUCHDB-435</key>
        <summary>Build against spidermonkey in xulrunner-1.9.1</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="aquarius">Stuart Langridge</reporter>
            
    <created>Mon, 27 Jul 2009 13:23:01 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 15:02:35 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12735606" author="mhammond" created="Mon, 27 Jul 2009 13:49:47 +0000 (UTC)"  >Does couch work correctly for you with this patch?  I&apos;ve done something similar but struck problems, then discovered davisp has a branch at github for this, and although it is stale, it is further than I got.  I&apos;m wondering if this problem has magically gone away on the trunk...</comment>
                    <comment id="12735728" author="alessandrod" created="Mon, 27 Jul 2009 19:26:14 +0000 (UTC)"  >I gave a try at this too, patch here &lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-288&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-288&lt;/a&gt;</comment>
                    <comment id="12736017" author="aquarius" created="Tue, 28 Jul 2009 10:12:07 +0000 (UTC)"  >Alessandro&apos;s &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-288&quot; title=&quot;couch_js.c:1217: error: &apos;JSOPTION_NATIVE_BRANCH_CALLBACK&apos; with spidermonkey tip&quot;&gt;&lt;strike&gt;COUCHDB-288&lt;/strike&gt;&lt;/a&gt; patch may obsolete this.</comment>
                    <comment id="12738997" author="janl" created="Tue, 4 Aug 2009 15:02:35 +0000 (UTC)"  >Fixed in the patch for &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-288&quot; title=&quot;couch_js.c:1217: error: &apos;JSOPTION_NATIVE_BRANCH_CALLBACK&apos; with spidermonkey tip&quot;&gt;&lt;strike&gt;COUCHDB-288&lt;/strike&gt;&lt;/a&gt;.</comment>
                </comments>
    
    <attachments>
            <attachment id="12414616" name="native_js_callback.patch" size="737" author="aquarius" created="Mon, 27 Jul 2009 13:23:47 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 15:02:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 27 Jul 2009 13:49:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-434] 500 error when working with deleted bulk docs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-434</link>

                    <description>When upgrading our app from 0.9 to trunk, I encountered a 500 error attempting to update previously deleted documents.  I&apos;ve hacked together a patch to the test suite which demonstrates an almost identical error, but note:&lt;br/&gt;
&lt;br/&gt;
* The test code is misplaced due to that test otherwise failing for me when attempting to compact.  It should go either at the end of the test, or into its own test.&lt;br/&gt;
* As the comments note, the attempt to delete the documents appears to fail with conflict errors - which it probably shouldn&apos;t.&lt;br/&gt;
* If you ignore these conflicts (as the test does), the next attempt to &apos;resurrect&apos; these docs causes a 500 error with a badmatch exception.</description>
                <environment></environment>
            <key id="12431337">COUCHDB-434</key>
        <summary>500 error when working with deleted bulk docs</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Fri, 24 Jul 2009 08:03:08 +0000 (UTC)</created>
    <updated>Wed, 29 Jul 2009 21:49:47 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12734960" author="mhammond" created="Fri, 24 Jul 2009 08:03:53 +0000 (UTC)"  >hacky patch to the test suite which causes the badmatch exception.</comment>
                    <comment id="12735224" author="mhammond" created="Sat, 25 Jul 2009 01:00:48 +0000 (UTC)"  >oops - previous patch had a simple error causing the conflict errors.  Please ignore all commentary about the conflicts - now the 500 error is the only &apos;unusual&apos; thing demonstrated by this patch.</comment>
                    <comment id="12736387" author="jchris" created="Wed, 29 Jul 2009 00:40:11 +0000 (UTC)"  >relevant log output:&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.1898.0&amp;gt;] Uncaught error in HTTP request: {error,{badmatch,error}}&lt;br/&gt;
[info] [&amp;lt;0.1898.0&amp;gt;] Stacktrace: [{couch_db,&apos;-update_docs/4-fun-4-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,map,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,update_docs,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]</comment>
                    <comment id="12736407" author="jchris" created="Wed, 29 Jul 2009 01:24:28 +0000 (UTC)"  >I&apos;ve looked into the bug and it seems for some reason _deleted docs aren&apos;t coming back in the IdRevs ++ CommitResults ++ PreCommitFailures result set for some reason.&lt;br/&gt;
&lt;br/&gt;
In couch_db:update_docs(Db, Docs, Options, interactive_edit), the call to dict:find currently only matches {ok, Result}&lt;br/&gt;
&lt;br/&gt;
For some reason this test makes dict:find return the atom error instead of {ok, Result} (eg the dict doesn&apos;t have the key).&lt;br/&gt;
&lt;br/&gt;
I&apos;m guessing it&apos;s to do with deterministic revs and deletion.&lt;br/&gt;
&lt;br/&gt;
Assigning to Damien.</comment>
                    <comment id="12736856" author="damienkatz" created="Wed, 29 Jul 2009 21:49:47 +0000 (UTC)"  >Fixed in trunk.</comment>
                </comments>
    
    <attachments>
            <attachment id="12414488" name="bulk_save_500.patch" size="801" author="mhammond" created="Sat, 25 Jul 2009 01:00:48 +0000 (UTC)" />
            <attachment id="12414413" name="bulk_save_500.patch" size="894" author="mhammond" created="Fri, 24 Jul 2009 08:03:53 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 29 Jul 2009 21:49:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 29 Jul 2009 00:40:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-433] CouchDB doesn&apos;t handle Expect header.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-433</link>

                    <description>An HTTP client may elect to send an &amp;quot;Expect: 100-Continue&amp;quot; header. All compliant HTTP servers are required to;&lt;br/&gt;
&lt;br/&gt;
&amp;quot;A server that does not understand or is unable to comply with any of the expectation values in the Expect field of a request MUST respond with appropriate error status. The server MUST respond with a 417 (Expectation Failed) status if any of the expectations cannot be met or, if there are other problems with the request, some other 4xx status.&amp;quot;&lt;br/&gt;
from &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
CouchDB sends neither the Continue response (if it supports expect-continue) or 417 (if it doesn&apos;t).&lt;br/&gt;
&lt;br/&gt;
This leads clients that include the header to hang while they timeout expecting either response.&lt;br/&gt;
&lt;br/&gt;
Suggest returning a 417 response so that compliant clients will retry immediately without the Expect header.</description>
                <environment></environment>
            <key id="12431309">COUCHDB-433</key>
        <summary>CouchDB doesn&apos;t handle Expect header.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Thu, 23 Jul 2009 22:53:21 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 17:18:02 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742501" author="rnewson" created="Wed, 12 Aug 2009 18:12:22 +0000 (UTC)"  >This test demonstrates the bug. Because it&apos;s executed serially, it just hangs forever in the face of the incorrect Expect-Continue handling;&lt;br/&gt;
&lt;br/&gt;
couchTests.custom_test = function(debug) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var db = new CouchDB(&amp;quot;test_suite_db&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.createDb();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var db2 = new CouchDB(&amp;quot;test_suite_db&amp;quot;, {&amp;quot;Expect&amp;quot;:&amp;quot;100-continue&amp;quot;});&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (debug) debugger;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(db2.save({_id:&amp;quot;1&amp;quot;,a:2,b:4}).ok);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(db2.open(&amp;quot;1&amp;quot;) != null);&lt;br/&gt;
};&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12742589" author="rnewson" created="Wed, 12 Aug 2009 21:34:19 +0000 (UTC)"  >&lt;br/&gt;
Mochiweb expects the Expect headers value to be &amp;quot;100-continue&amp;quot; and hangs if it gets, for example, &amp;quot;100-Continue&amp;quot; which is what Apache HttpClient sends.&lt;br/&gt;
&lt;br/&gt;
the patch lower-cases the value of the Expect header before matching to &amp;quot;100-continue&amp;quot; thus allowing HttpClient to work against couchdb without the 2 second delay while it waits for an &amp;quot;HTTP 1.1 100 continue&amp;quot; response that will never come.</comment>
                    <comment id="12742592" author="rnewson" created="Wed, 12 Aug 2009 21:37:27 +0000 (UTC)"  >logged upstream as &lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=42&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=42&lt;/a&gt;&lt;br/&gt;
</comment>
                    <comment id="12781012" author="kocolosk" created="Sat, 21 Nov 2009 17:18:02 +0000 (UTC)"  >Issue 42 was fixed upstream in r103; we&apos;re now at r113.  The custom test passes, so closing this one out.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12432964">HTTPCORE-202</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12416363" name="0001-fix-e-c-handling.patch" size="841" author="rnewson" created="Wed, 12 Aug 2009 21:34:19 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:18:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:18:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-432] Upgrade Futon&apos;s json2.js and jquery.js</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-432</link>

                    <description>The json2.js file currently being used by Futon is over a year old and contains bugs and security issues. I&apos;ve updated it to the most recent version on json.org &amp;lt;&lt;a href=&quot;http://www.json.org/json2.js&quot;&gt;http://www.json.org/json2.js&lt;/a&gt;&amp;gt; and all the tests pass on FF3.0 and FF3.5. Also, you can upgrae jquery to 1.3.2. All tests also pass with this upgrade.</description>
                <environment></environment>
            <key id="12431291">COUCHDB-432</key>
        <summary>Upgrade Futon&apos;s json2.js and jquery.js</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="devinus">Devin Torres</reporter>
            
    <created>Thu, 23 Jul 2009 19:47:47 +0000 (UTC)</created>
    <updated>Tue, 15 Sep 2009 22:43:03 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="60">0.02h</timeoriginalestimate>        <timeestimate seconds="60">0.02h</timeestimate>                    

            <comments>
                    <comment id="12755457" author="jasondd" created="Tue, 15 Sep 2009 11:15:24 +0000 (UTC)"  >Any objections to me committing this?  Mr. Lenz?  All tests pass for me (although I&apos;m getting unrelated spurious failures probably due to the stats collector).</comment>
                    <comment id="12755764" author="jasondd" created="Tue, 15 Sep 2009 22:43:03 +0000 (UTC)"  >Fixed in r815521.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Sep 2009 22:43:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Sep 2009 11:15:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-431] Support cross domain XMLHttpRequest (XHR) calls by implementing Access Control spec</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-431</link>

                    <description>Historically, browsers have been restricted to making XMLHttpRequests (XHRs) to the same origin (domain) as the web page making the request. However, the latest browsers now support cross-domain requests by implementing the Access Control spec from the W3C:&lt;br/&gt;
&lt;a href=&quot;http://dev.w3.org/2006/waf/access-control/&quot;&gt;http://dev.w3.org/2006/waf/access-control/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
In order to keep older servers safe that assume browsers only do same-domain requests, the Access Control spec requires the server to opt-in to allow cross domain requests by the use of special HTTP headers and supporting some &amp;quot;pre-flight&amp;quot; HTTP calls.&lt;br/&gt;
&lt;br/&gt;
Why should CouchDB support this: in larger, high traffic site, it is common to serve the static UI files from a separate, differently scaled server complex than the data access/API server layer. Also, there are some API services that are meant to be centrally hosted, but allow API consumers to use the API from different domains. In these cases, the UI in the browser would need to do cross domain requests to access CouchDB servers that act as the API/data access server layer.&lt;br/&gt;
&lt;br/&gt;
JSONP is not enough in these cases since it is limited to GET requests, so no POSTing or PUTing of documents.&lt;br/&gt;
&lt;br/&gt;
Some information from Firefox&apos;s perspective (functionality available as of Firefox 3.5):&lt;br/&gt;
&lt;a href=&quot;https://developer.mozilla.org/en/HTTP_access_control&quot;&gt;https://developer.mozilla.org/en/HTTP_access_control&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
And information on Safari/Webkit (functionality in latest WebKit and Safari 4):&lt;br/&gt;
&lt;a href=&quot;http://developer.apple.com/safari/library/documentation/AppleApplications/Conceptual/SafariJSProgTopics/Articles/XHR.html&quot;&gt;http://developer.apple.com/safari/library/documentation/AppleApplications/Conceptual/SafariJSProgTopics/Articles/XHR.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
IE 8 also uses the Access Control spec, but the requests have to go through their XDomainRequest object (XDR):&lt;br/&gt;
&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/cc288060%28VS.85%29.aspx&quot;&gt;http://msdn.microsoft.com/en-us/library/cc288060%28VS.85%29.aspx&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
and I thought IE8 only allowed GET or POST requests through their XDR.&lt;br/&gt;
&lt;br/&gt;
But as far as CouchDB is concerned, implementing the Access Control headers should be enough, and hopefully IE 9 will allow normal xdomain requests via XHR.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12431288">COUCHDB-431</key>
        <summary>Support cross domain XMLHttpRequest (XHR) calls by implementing Access Control spec</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jrburke">James Burke</reporter>
            
    <created>Thu, 23 Jul 2009 19:29:27 +0000 (UTC)</created>
    <updated>Thu, 23 Jul 2009 19:48:22 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12734753" author="kocolosk" created="Thu, 23 Jul 2009 19:48:22 +0000 (UTC)"  >cool stuff!  This is the first I&apos;ve heard of it.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Jul 2009 19:48:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-430] respondWith() called after getRow() does not set &quot;Content-Type&quot; response</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-430</link>

                    <description>After calling getRow() once, the response header are locked and cannot be changed by respondWith.&lt;br/&gt;
getRow() should be side-effect free and Sending shouldn&apos;t start before calling send();&lt;br/&gt;
&lt;br/&gt;
Example, where respondWith() cannot set &amp;quot;Content-Type&amp;quot; response header according to &amp;quot;Accept&amp;quot; request header:&lt;br/&gt;
&lt;br/&gt;
function(head, req){&lt;br/&gt;
	var row = getRow();&lt;br/&gt;
	respondWith(req,&lt;br/&gt;
	{&lt;br/&gt;
		json : function() {&lt;br/&gt;
			send(&amp;quot;{&apos;json&apos;}&amp;quot;);&lt;br/&gt;
		},&lt;br/&gt;
		xml : function() {&lt;br/&gt;
			send(&apos;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;&apos;);&lt;br/&gt;
		}&lt;br/&gt;
	});&lt;br/&gt;
}&lt;br/&gt;
</description>
                <environment>{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a796218&amp;quot;}&lt;br/&gt;
Linux</environment>
            <key id="12431233">COUCHDB-430</key>
        <summary>respondWith() called after getRow() does not set &quot;Content-Type&quot; response</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="rsl">Rune S. Larsen</reporter>
            
    <created>Thu, 23 Jul 2009 10:17:25 +0000 (UTC)</created>
    <updated>Thu, 23 Jul 2009 10:22:38 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-429] Wrong rows shown when clicking &quot;previous&quot; in Futon for reduce views</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-429</link>

                    <description>Click &amp;quot;next&amp;quot; twice, and then click &amp;quot;previous&amp;quot; twice, and it only shows 9 rows on the first page (less if you click &amp;quot;next&amp;quot; more times).  This is due to the &amp;quot;extra&amp;quot; row being put in the wrong place when clicking &amp;quot;previous&amp;quot;.  Patch to follow.</description>
                <environment></environment>
            <key id="12431195">COUCHDB-429</key>
        <summary>Wrong rows shown when clicking &quot;previous&quot; in Futon for reduce views</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Wed, 22 Jul 2009 23:12:14 +0000 (UTC)</created>
    <updated>Fri, 14 Aug 2009 15:17:52 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12734505" author="cmlenz" created="Thu, 23 Jul 2009 07:49:23 +0000 (UTC)"  >That patch does not seem to fix the issue for me.</comment>
                    <comment id="12735433" author="jasondd" created="Sun, 26 Jul 2009 22:58:26 +0000 (UTC)"  >Updated patch, verified for both non-reduce and reduce views.  The previous patch only fixed reduce views.</comment>
                    <comment id="12743229" author="paul.joseph.davis" created="Fri, 14 Aug 2009 15:17:52 +0000 (UTC)"  >Applied in r804255.</comment>
                </comments>
    
    <attachments>
            <attachment id="12414567" name="futon.browse.js.2.patch" size="1070" author="jasondd" created="Sun, 26 Jul 2009 22:58:25 +0000 (UTC)" />
            <attachment id="12414279" name="futon.browse.js.patch" size="1058" author="jasondd" created="Wed, 22 Jul 2009 23:12:32 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Aug 2009 15:17:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Jul 2009 07:49:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-428] Extra row shown per page for pages greater than 1 in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-428</link>

                    <description>See patch for one-line fix.</description>
                <environment></environment>
            <key id="12431189">COUCHDB-428</key>
        <summary>Extra row shown per page for pages greater than 1 in Futon</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Wed, 22 Jul 2009 22:08:05 +0000 (UTC)</created>
    <updated>Wed, 22 Jul 2009 22:22:57 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12734362" author="cmlenz" created="Wed, 22 Jul 2009 22:22:57 +0000 (UTC)"  >Patch applied in r796895. Thanks!</comment>
                </comments>
    
    <attachments>
            <attachment id="12414271" name="futon.browse.js.patch" size="525" author="jasondd" created="Wed, 22 Jul 2009 22:08:22 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 22 Jul 2009 22:22:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 22 Jul 2009 22:22:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-427] 0.9.1 DBs with duplicate attachments can break replication to 0.10+</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-427</link>

                    <description>When you try to replicate a database from an old version of couchdb to latest, the cpu usage increase up to 100% and more instead of just hanging.&lt;br/&gt;
&lt;br/&gt;
You can try to replicate from &lt;a href=&quot;http://benoitc.im/b&quot;&gt;http://benoitc.im/b&lt;/a&gt; to latest trunk or 0.9.1 to replicate this issue.</description>
                <environment>osx, ubuntu, openbsd</environment>
            <key id="12431179">COUCHDB-427</key>
        <summary>0.9.1 DBs with duplicate attachments can break replication to 0.10+</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Wed, 22 Jul 2009 20:30:47 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 19:48:03 +0000 (UTC)</updated>

                
                
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742945" author="kocolosk" created="Thu, 13 Aug 2009 19:46:43 +0000 (UTC)"  >Confirmed that this is still a problem on trunk.  I&apos;m attaching the full crash dump, but the key stacktrace is&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.69.0&amp;gt;] ** Generic server &amp;lt;0.69.0&amp;gt; terminating &lt;br/&gt;
** Last message in was {&apos;EXIT&apos;,&amp;lt;0.89.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{nocatch,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{bad_request,&amp;lt;&amp;lt;&amp;quot;Duplicate attachments&amp;quot;&amp;gt;&amp;gt;}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db,check_dup_atts,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,sort_and_check_atts,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-update_docs/4-lc$^3/1-3-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-update_docs/4-lc$^2/1-2-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-update_docs/4-lc$^2/1-2-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,update_docs,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep_writer,writer_loop,3}]}}</comment>
                    <comment id="12743068" author="kocolosk" created="Fri, 14 Aug 2009 03:48:28 +0000 (UTC)"  >So we identified the document that has duplicate attachments as&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://benoitc.im/b/7cb06e5de28327c7fc81c7028bece5a3&quot;&gt;http://benoitc.im/b/7cb06e5de28327c7fc81c7028bece5a3&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
and indeed it does have three attachments with the same name. I&apos;m not sure what the next step is here.  We certainly don&apos;t want replication to break, but this seems like such an edge case that I&apos;m not sure it&apos;s worth putting in special code in the replicator to deal with it.&lt;br/&gt;
&lt;br/&gt;
Damien, the check_dup_atts code is your stuff, right?  Do you know how Benoit could&apos;ve ended up with 3 identically-named attachments in the past?</comment>
                </comments>
    
    <attachments>
            <attachment id="12416478" name="duplicate_attachments_crash.txt" size="26047" author="kocolosk" created="Thu, 13 Aug 2009 19:46:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 13 Aug 2009 19:46:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-426] Sort view names alphabetically in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-426</link>

                    <description>Simple patch to follow...</description>
                <environment></environment>
            <key id="12431168">COUCHDB-426</key>
        <summary>Sort view names alphabetically in Futon</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Wed, 22 Jul 2009 18:31:20 +0000 (UTC)</created>
    <updated>Wed, 22 Jul 2009 21:36:13 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12734240" author="jasondd" created="Wed, 22 Jul 2009 18:35:42 +0000 (UTC)"  >Better patch that also sorts design docs in alphabetical order and reduces number of HTTP requests.</comment>
                    <comment id="12734339" author="cmlenz" created="Wed, 22 Jul 2009 21:36:13 +0000 (UTC)"  >Second patch applied in r796885. Thanks!</comment>
                </comments>
    
    <attachments>
            <attachment id="12414234" name="futon.browse.js.2.diff" size="2081" author="jasondd" created="Wed, 22 Jul 2009 18:35:42 +0000 (UTC)" />
            <attachment id="12414232" name="futon.browse.js.diff" size="1178" author="jasondd" created="Wed, 22 Jul 2009 18:32:04 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 22 Jul 2009 21:36:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 22 Jul 2009 21:36:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-425] Hiding sidebar in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-425</link>

                    <description>Sometimes you&apos;d like to have maximum space for browsing your views. Therefore I&apos;d like to see a way to hide the sidebar.</description>
                <environment></environment>
            <key id="12431082">COUCHDB-425</key>
        <summary>Hiding sidebar in Futon</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="vmx">Volker Mische</reporter>
            
    <created>Tue, 21 Jul 2009 22:33:41 +0000 (UTC)</created>
    <updated>Fri, 24 Jul 2009 09:36:09 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733867" author="vmx" created="Tue, 21 Jul 2009 22:36:04 +0000 (UTC)"  >Patch for hiding the sidebar in Futon. What I don&apos;t like about the patch at the moment is, that it manipulates CSS with JavaScript. I guess it can be done in a much better way (perhaps with changing the whole markup a bit more).&lt;br/&gt;
If I find time I&apos;ll try to clean it up, but if anyone wants to step in, feel free to do so.</comment>
                    <comment id="12733869" author="vmx" created="Tue, 21 Jul 2009 22:37:08 +0000 (UTC)"  >The patched interface needs a different background image.</comment>
                    <comment id="12734162" author="vmx" created="Wed, 22 Jul 2009 15:48:51 +0000 (UTC)"  >I&apos;ve cleaned up the patch. In my opinion it&apos;s ready to be applied now (the bg.png is still needed).</comment>
                    <comment id="12734346" author="cmlenz" created="Wed, 22 Jul 2009 21:48:21 +0000 (UTC)"  >I agree it would be nice to be able to hide the sidebar. But I&apos;d very much prefer a nicer visual representation of the hide/show function, and it sucks having two background image files, the second just being a trivial variation of the first. I understand why you did this, but there *must* be a better way :P&lt;br/&gt;
&lt;br/&gt;
Anyway, I plan to experiment with this in the next couple of days.</comment>
                    <comment id="12734378" author="vmx" created="Wed, 22 Jul 2009 23:17:11 +0000 (UTC)"  >I fully agree on a nicer visual presentation. This was the main reason why I asked for a review when I first mentioned it on the mailings list. I&apos;m looking forward what you come up with.&lt;br/&gt;
&lt;br/&gt;
About the image, it&apos;s not a second one, it&apos;s a replacement of the old one.</comment>
                    <comment id="12734506" author="cmlenz" created="Thu, 23 Jul 2009 07:51:46 +0000 (UTC)"  >Oh, I should have checked the patch more closely. This looks pretty nice already.</comment>
                    <comment id="12734545" author="cmlenz" created="Thu, 23 Jul 2009 10:36:18 +0000 (UTC)"  >Here&apos;s a patch that adds the hide/show trigger as a graphical button (which I&apos;ll attach separately). This required a bit of rework of the layout, so that for example the header is now fixed at the top of the page.&lt;br/&gt;
&lt;br/&gt;
I&apos;m not 100% happy with the +/- icons, and suppose that maybe a more subtle expansion triangle would be nicer. But the raw URL link is already an arrow, and I don&apos;t want two arrow things sitting next to each other. Maybe I can rework the raw URL link icon...</comment>
                    <comment id="12734551" author="cmlenz" created="Thu, 23 Jul 2009 11:05:24 +0000 (UTC)"  >A slightly improved version of the previous patch. Needs an updated icon.</comment>
                    <comment id="12734552" author="cmlenz" created="Thu, 23 Jul 2009 11:07:05 +0000 (UTC)"  >Okay, the icon needed by the cmlenz2 patch wants the sidebar-toggle.png image with the arrows, not the one with the plus/minus symbols.</comment>
                    <comment id="12734652" author="vmx" created="Thu, 23 Jul 2009 17:27:59 +0000 (UTC)"  >Thank for the commit, it looks great. Though here&apos;s a patch that makes the animation a bit more subtly (fading out the child nodes, instead of toggling them). This patch also reduced the wobbling of the triangle a bit (with animating the #wrap before the #sidebar), I&apos;d like to get rid of the wobbling completly but it doesn&apos;t seem to that easy to achieve.</comment>
                    <comment id="12734824" author="cmlenz" created="Thu, 23 Jul 2009 22:47:25 +0000 (UTC)"  >Thanks for the patch, applied in r797252.</comment>
                    <comment id="12735002" author="janl" created="Fri, 24 Jul 2009 09:36:09 +0000 (UTC)"  >Volker, Christopher, just to let you guys know, I just spent three minutes hiding and showing the sidebar. it looks that cool, thanks!</comment>
                </comments>
    
    <attachments>
            <attachment id="12414154" name="bg.png" size="372" author="vmx" created="Tue, 21 Jul 2009 22:37:08 +0000 (UTC)" />
            <attachment id="12414220" name="futon-hide-sidebar-2.patch" size="4072" author="vmx" created="Wed, 22 Jul 2009 15:48:51 +0000 (UTC)" />
            <attachment id="12414332" name="futon-hide-sidebar-cmlenz1.patch" size="6082" author="cmlenz" created="Thu, 23 Jul 2009 10:36:17 +0000 (UTC)" />
            <attachment id="12414336" name="futon-hide-sidebar-cmlenz2.patch" size="5942" author="cmlenz" created="Thu, 23 Jul 2009 11:05:23 +0000 (UTC)" />
            <attachment id="12414354" name="futon-hide-sidebar-vmx.patch" size="1145" author="vmx" created="Thu, 23 Jul 2009 17:27:59 +0000 (UTC)" />
            <attachment id="12414153" name="futon-hide-sidebar.patch" size="3715" author="vmx" created="Tue, 21 Jul 2009 22:36:04 +0000 (UTC)" />
            <attachment id="12414337" name="sidebar-toggle.png" size="512" author="cmlenz" created="Thu, 23 Jul 2009 11:05:24 +0000 (UTC)" />
            <attachment id="12414333" name="sidebar-toggle.png" size="778" author="cmlenz" created="Thu, 23 Jul 2009 10:36:42 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Jul 2009 22:47:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 22 Jul 2009 21:48:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-424] fixed minor issues in etap tests dues to code evolution</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-424</link>

                    <description>fixed etap tests to accomodate changes in couch_config, couch_stream, etc..</description>
                <environment></environment>
            <key id="12431027">COUCHDB-424</key>
        <summary>fixed minor issues in etap tests dues to code evolution</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Tue, 21 Jul 2009 14:17:46 +0000 (UTC)</created>
    <updated>Thu, 23 Jul 2009 13:27:40 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733632" author="dionne" created="Tue, 21 Jul 2009 14:18:28 +0000 (UTC)"  >patch for three etap tests</comment>
                    <comment id="12733668" author="dionne" created="Tue, 21 Jul 2009 15:35:03 +0000 (UTC)"  >this fixes the rest of the etaps and the permissions on the replication test</comment>
                    <comment id="12733669" author="kocolosk" created="Tue, 21 Jul 2009 15:50:46 +0000 (UTC)"  >Thanks Bob.  I didn&apos;t realize the tests needed +x, but the escript she-bang should&apos;ve tipped me off!</comment>
                    <comment id="12734594" author="paul.joseph.davis" created="Thu, 23 Jul 2009 13:27:40 +0000 (UTC)"  >Applied in r797053</comment>
                </comments>
    
    <attachments>
            <attachment id="12414109" name="etaps.diff" size="3328" author="dionne" created="Tue, 21 Jul 2009 15:35:03 +0000 (UTC)" />
            <attachment id="12414103" name="etaps.diff" size="2677" author="dionne" created="Tue, 21 Jul 2009 14:18:28 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Jul 2009 13:27:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 15:50:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-423] couch_file misses an edge case</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-423</link>

                    <description>pread_binary reads the first 20 bytes. This causes a simple append_binary followed by pread_binary to fail, as in 010-file-basics.t test case. This case may never occur because of couchdb&apos;s file format </description>
                <environment></environment>
            <key id="12431020">COUCHDB-423</key>
        <summary>couch_file misses an edge case</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Tue, 21 Jul 2009 13:18:12 +0000 (UTC)</created>
    <updated>Thu, 23 Jul 2009 13:28:16 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733611" author="dionne" created="Tue, 21 Jul 2009 13:19:39 +0000 (UTC)"  >attached patch fixes the issue.</comment>
                    <comment id="12734595" author="paul.joseph.davis" created="Thu, 23 Jul 2009 13:28:16 +0000 (UTC)"  >Applied in r797053</comment>
                </comments>
    
    <attachments>
            <attachment id="12414100" name="couch_file.diff" size="1496" author="dionne" created="Tue, 21 Jul 2009 13:19:39 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Jul 2009 13:28:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Jul 2009 13:28:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-422] PUT to _local/doc_id creates document &apos;_local&apos;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-422</link>

                    <description>After davisp&apos;s revision r796246 doing a put to a document id like &apos;_local/doc_id&apos; results in a visible, and apparently non-local document with id &apos;_local&apos;. When escaping the slash as &apos;%2F&apos; everything works as before, and expected, i.e. a local document with the above id is created.&lt;br/&gt;
&lt;br/&gt;
To test:&lt;br/&gt;
&lt;br/&gt;
curl -X PUT -d &apos;{&amp;quot;foo&amp;quot;: &amp;quot;bar&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5987/db1/_local/yokal&quot;&gt;http://127.0.0.1:5987/db1/_local/yokal&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
result:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;_local&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-770307fe8d4210bab8ec65c59983e03c&amp;quot;}&lt;br/&gt;
</description>
                <environment>Ubuntu 9.04</environment>
            <key id="12431013">COUCHDB-422</key>
        <summary>PUT to _local/doc_id creates document &apos;_local&apos;</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Tue, 21 Jul 2009 11:23:18 +0000 (UTC)</created>
    <updated>Fri, 14 Aug 2009 15:47:59 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742939" author="kocolosk" created="Thu, 13 Aug 2009 19:31:42 +0000 (UTC)"  >Thanks for this report, Eric.  I think _local docs should behave like _design docs; that is, we should accept a PUT to _local/foo just fine.</comment>
                    <comment id="12742940" author="kocolosk" created="Thu, 13 Aug 2009 19:32:07 +0000 (UTC)"  >Paul, can you check into this sometime?</comment>
                    <comment id="12743044" author="paul.joseph.davis" created="Fri, 14 Aug 2009 01:03:57 +0000 (UTC)"  >Checked this out and I can fairly easily make the patch with a caveat. Is it just me or do _local docs not allow attachments?</comment>
                    <comment id="12743251" author="paul.joseph.davis" created="Fri, 14 Aug 2009 15:47:59 +0000 (UTC)"  >Fixed as of r804269.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Aug 2009 15:47:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 13 Aug 2009 19:31:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-421] add longpolling for _changes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-421</link>

                    <description>Implement longpolling on _changes. Instead of continuous, longpolling hold &lt;br/&gt;
request until an update is available then close it. The client will have &lt;br/&gt;
to ask a new connection. Should solve problem for XHR&apos;s  that don&apos;t have that status changed (on ie, opera..) .&lt;br/&gt;
&lt;br/&gt;
I&apos;ve put all the code in my github repo :&lt;br/&gt;
&lt;a href=&quot;http://github.com/benoitc/couchdb/tree/longpoll&quot;&gt;http://github.com/benoitc/couchdb/tree/longpoll&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
diff against trunk is attached.</description>
                <environment></environment>
            <key id="12430957">COUCHDB-421</key>
        <summary>add longpolling for _changes</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 20 Jul 2009 20:35:54 +0000 (UTC)</created>
    <updated>Sat, 1 Aug 2009 13:50:52 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12733344" author="benoitc" created="Mon, 20 Jul 2009 20:36:21 +0000 (UTC)"  >patch implementing longpoll option.</comment>
                    <comment id="12733361" author="damienkatz" created="Mon, 20 Jul 2009 21:20:55 +0000 (UTC)"  >Style wise this patch looks good, however you must change the indention tabs to spaces.&lt;br/&gt;
&lt;br/&gt;
I recommend instead of adding the  longpolling_changes call in the code, just reuse the keep_sending_changes call, and after the call to send_changes, add a check if  EndSeq &amp;gt; StartSeq and the long poll option is on, stop,&lt;br/&gt;
&lt;br/&gt;
Also I&apos;m not sure about calling it &amp;quot;long_poll&amp;quot;, but I don&apos;t have a better name myself.</comment>
                    <comment id="12733364" author="paul.joseph.davis" created="Mon, 20 Jul 2009 21:35:47 +0000 (UTC)"  >I&apos;m pretty sure that long poll is the standard name for this pattern. I&apos;d be hesitant to call it something else.</comment>
                    <comment id="12733461" author="benoitc" created="Tue, 21 Jul 2009 03:57:48 +0000 (UTC)"  >new patch following Damien&apos;s feedback. It now reuses the keep_sending_changes function. indentation should be fixed too.</comment>
                    <comment id="12733528" author="jchris" created="Tue, 21 Jul 2009 08:02:09 +0000 (UTC)"  >just looking at the new patch. definitely solid. One think I see: the changes_response_type/1 function may be a smell that we shouldn&apos;t have eg:&lt;br/&gt;
&lt;br/&gt;
continuous=true&lt;br/&gt;
or &lt;br/&gt;
longpoll=true&lt;br/&gt;
&lt;br/&gt;
but rather an single query parameter like:&lt;br/&gt;
&lt;br/&gt;
connection=continuous&lt;br/&gt;
or &lt;br/&gt;
connection=longpoll&lt;br/&gt;
&lt;br/&gt;
with a default of &amp;quot;normal&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
This way we don&apos;t need a helper function to parse it and we also don&apos;t need to worry about cases where a user (or library) does something silly like:&lt;br/&gt;
&lt;br/&gt;
continuous=true&amp;amp;longpoll=true&lt;br/&gt;
&lt;br/&gt;
This involves changing the API but maybe it&apos;s worth it?</comment>
                    <comment id="12733532" author="benoitc" created="Tue, 21 Jul 2009 08:16:02 +0000 (UTC)"  >It will be more simple, maybe feed=continuous or feed=longpoll in this case ?&lt;br/&gt;
</comment>
                    <comment id="12733710" author="wohali" created="Tue, 21 Jul 2009 16:54:47 +0000 (UTC)"  >feed= makes sense, as it allows for extension to other methods in the future if there&apos;s demand (e.g., bayeux, html5).&lt;br/&gt;
&lt;br/&gt;
I&apos;ll even volunteer to submit a fix for the Toast example that works cross-browser if this gets committed.</comment>
                    <comment id="12733752" author="kocolosk" created="Tue, 21 Jul 2009 17:57:32 +0000 (UTC)"  >feed=continuous|longpoll also makes sense to me</comment>
                    <comment id="12734043" author="janl" created="Wed, 22 Jul 2009 09:09:25 +0000 (UTC)"  >to me too, if we need any more consensus :)</comment>
                    <comment id="12734318" author="benoitc" created="Wed, 22 Jul 2009 21:05:49 +0000 (UTC)"  >patch that use feed=longpoll or feed=continuous as parameter instead of longpoll=true and continuous=true.</comment>
                    <comment id="12734322" author="benoitc" created="Wed, 22 Jul 2009 21:08:23 +0000 (UTC)"  >same patch as previous with indentation fixed.</comment>
                    <comment id="12737881" author="janl" created="Sat, 1 Aug 2009 13:50:52 +0000 (UTC)"  >patch applied in r799862.</comment>
                </comments>
    
    <attachments>
            <attachment id="12414034" name="longpoll.diff" size="4899" author="benoitc" created="Mon, 20 Jul 2009 20:36:21 +0000 (UTC)" />
            <attachment id="12414062" name="longpoll2.diff" size="5615" author="benoitc" created="Tue, 21 Jul 2009 03:57:48 +0000 (UTC)" />
            <attachment id="12414264" name="longpoll3.diff" size="5591" author="benoitc" created="Wed, 22 Jul 2009 21:05:49 +0000 (UTC)" />
            <attachment id="12414265" name="longpoll4.diff" size="5481" author="benoitc" created="Wed, 22 Jul 2009 21:08:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 1 Aug 2009 13:50:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 20 Jul 2009 21:20:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-420] OAuth authentication support (2-legged initially) and cookie-based authentication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-420</link>

                    <description>This patch adds two-legged OAuth support to CouchDB.&lt;br/&gt;
&lt;br/&gt;
1. In order to do this, a couple of changes have been made to the way auth handlers are used.  Essentially, the patch allows multiple handlers to be specified in a comma-separated list in the following in the [httpd] section of your .ini config e.g.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;authentication_handlers = {couch_httpd_oauth, oauth_authentication_handler}, {couch_httpd_auth, default_authentication_handler}&lt;br/&gt;
&lt;br/&gt;
The handlers are tried in order until one of them successfully authenticates and sets user_ctx on the request.  Then the request is passed to the main handler.&lt;br/&gt;
&lt;br/&gt;
2. Now for the OAuth consumer keys and secrets: as Ubuntu need to be able to bootstrap this i.e. add tokens without a running CouchDB, I have advised creating a new config file in $PREFIX/etc/couchdb/default.d/ called oauth.ini or similar.  This should get read by CouchDB&apos;s startup script when it loads its config files (e.g. default.ini and local.ini as well).  There are three sections available:&lt;br/&gt;
&lt;br/&gt;
i. [oauth_consumer_secrets] &amp;lt;consumer_key&amp;gt; = &amp;lt;consumer_secret&amp;gt;&lt;br/&gt;
ii. [oauth_token_secrets] &amp;lt;oauth_token&amp;gt; = &amp;lt;oauth_token_secret&amp;gt;&lt;br/&gt;
iii. [oauth_token_users] &amp;lt;oauth_token&amp;gt; = &amp;lt;username&amp;gt;&lt;br/&gt;
&lt;br/&gt;
The format I&apos;ve used above is [section name] followed by how the keys and values for that section will look on subsequent lines.  The secrets are a way for the consumer to prove that it owns the corresponding consumer key or access token.  The mapping of auth tokens to usernames is a way to specify which user/roles to give to a consumer with a given access token.&lt;br/&gt;
&lt;br/&gt;
In the future we will also store tokens in the user database (see below).&lt;br/&gt;
&lt;br/&gt;
3. OAuth replication.  I&apos;ve extended the JSON sent via POST when initiating a replication as follows:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;source: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;url: &amp;lt;url&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;auth: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;oauth: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;consumer_key: &amp;lt;oauth_consumer_key&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;consumer_secret: &amp;lt;oauth_consumer_secret&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;token_secret: &amp;lt;oauth_token_secret&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;token: &amp;lt;oauth_token&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;},&lt;br/&gt;
&amp;nbsp;target: /* same syntax as source, or string for a URL with no auth info, or string for local database name */&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
4. This patch also includes cookie-authentication support to CouchDB.  I&apos;ve covered this here: &lt;a href=&quot;http://www.jasondavies.com/blog/2009/05/27/secure-cookie-authentication-couchdb/&quot;&gt;http://www.jasondavies.com/blog/2009/05/27/secure-cookie-authentication-couchdb/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The cookie-authentication branch is being used on a couple of live sites and the branch has also been worked on by jchris and benoitc.  As well as cookie auth it includes the beginnings of support for a per-node user database, with APIs for creating/deleting users etc.</description>
                <environment></environment>
            <key id="12430940">COUCHDB-420</key>
        <summary>OAuth authentication support (2-legged initially) and cookie-based authentication</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Mon, 20 Jul 2009 16:08:24 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 20:05:23 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733265" author="jasondd" created="Mon, 20 Jul 2009 16:27:46 +0000 (UTC)"  >Patch for review.</comment>
                    <comment id="12736012" author="thisfred" created="Tue, 28 Jul 2009 09:50:46 +0000 (UTC)"  >Great work, Jason!&lt;br/&gt;
&lt;br/&gt;
I&apos;ve gotten the newest version of the patch working (which I&apos;m sure will be attached soon.) Getting things to work still required a lot of hand holding, so I would love to have (and help write) some detailed setup documentation. In particular:&lt;br/&gt;
&lt;br/&gt;
1. An example oauth.ini and an elaborate description of all the steps it takes to authenticate against that.&lt;br/&gt;
2. An example replication session from the command line (using curl, or python + python-oauth or somesuch.) using the credentials created in 1.&lt;br/&gt;
3. A description of the process to add new (oauth) authenticated users to a running couchdb. (If that is currently possible, I think Jan suggested it was.)&lt;br/&gt;
</comment>
                    <comment id="12736033" author="jasondd" created="Tue, 28 Jul 2009 11:08:15 +0000 (UTC)"  >Latest patch with code cleanups and a couple of bug fixes.</comment>
                    <comment id="12739111" author="jasondd" created="Tue, 4 Aug 2009 19:28:50 +0000 (UTC)"  >Latest patch generated from my github branch.</comment>
                </comments>
    
    <attachments>
            <attachment id="12414018" name="oauth.1.diff" size="130185" author="jasondd" created="Mon, 20 Jul 2009 16:27:46 +0000 (UTC)" />
            <attachment id="12414737" name="oauth.2.patch" size="129644" author="jasondd" created="Tue, 28 Jul 2009 11:08:15 +0000 (UTC)" />
            <attachment id="12415511" name="oauth.3.patch" size="127882" author="jasondd" created="Tue, 4 Aug 2009 19:28:50 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 20:05:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 28 Jul 2009 09:50:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-419] Replication HTTP requests lack User-Agent and Accept headers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-419</link>

                    <description>Currently when making replication HTTP requests to a remote CouchDB instance, CouchDB makes the HTTP requests &amp;quot;anonymously&amp;quot;, without providing any information that it is a CouchDB instance and that it wants to receive JSON.&lt;br/&gt;
&lt;br/&gt;
Examples of what this could be:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;User-Agent: CouchDB/0.9.0&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Accept: application/json&lt;br/&gt;
&lt;br/&gt;
See &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
It would be good to add these headers to HTTP requests made by CouchDB, as it makes it easier for other systems like Midgard to support the replication protocol:&lt;br/&gt;
&lt;a href=&quot;http://bergie.iki.fi/blog/couchdb_and_midgard_talking_with_each_other/&quot;&gt;http://bergie.iki.fi/blog/couchdb_and_midgard_talking_with_each_other/&lt;/a&gt;</description>
                <environment></environment>
            <key id="12430920">COUCHDB-419</key>
        <summary>Replication HTTP requests lack User-Agent and Accept headers</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="bergie">Henri Bergius</reporter>
            
    <created>Mon, 20 Jul 2009 12:13:19 +0000 (UTC)</created>
    <updated>Thu, 13 Aug 2009 19:40:19 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742943" author="kocolosk" created="Thu, 13 Aug 2009 19:40:19 +0000 (UTC)"  >Thanks Henri, CouchDB should now be sending these headers with replication requests.&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 13 Aug 2009 19:40:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 13 Aug 2009 19:40:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-418] properly close jsonp response on _changes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-418</link>

                    <description>Currently if you use jsonp callback, in _changes request, the response is&apos;nt properly closed at the end of request (after timeout or if continuous=false). Here is a patch that should fix it.</description>
                <environment></environment>
            <key id="12430910">COUCHDB-418</key>
        <summary>properly close jsonp response on _changes</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 20 Jul 2009 07:02:39 +0000 (UTC)</created>
    <updated>Tue, 21 Jul 2009 09:18:25 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733308" author="benoitc" created="Mon, 20 Jul 2009 18:23:53 +0000 (UTC)"  >This patch add a test for callback.</comment>
                    <comment id="12733317" author="benoitc" created="Mon, 20 Jul 2009 18:58:20 +0000 (UTC)"  >update diff with latest change of damien.</comment>
                    <comment id="12733543" author="janl" created="Tue, 21 Jul 2009 09:18:25 +0000 (UTC)"  >fixed in r796207.Thanks.</comment>
                </comments>
    
    <attachments>
            <attachment id="12413985" name="changes_jsonp.diff" size="1023" author="benoitc" created="Mon, 20 Jul 2009 07:03:15 +0000 (UTC)" />
            <attachment id="12414024" name="changes_jsonp_2.diff" size="2047" author="benoitc" created="Mon, 20 Jul 2009 18:23:53 +0000 (UTC)" />
            <attachment id="12414026" name="changes_jsonp_3.diff" size="2195" author="benoitc" created="Mon, 20 Jul 2009 18:58:20 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 09:18:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 09:18:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-417] Graphical interface for editing _list functions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-417</link>

                    <description>There&apos;s no nice graphical interface for editing _list functions in Futon.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve create one which can be found at: &lt;a href=&quot;http://github.com/vmx/couchdb/tree/futon-list&quot;&gt;http://github.com/vmx/couchdb/tree/futon-list&lt;/a&gt;&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12430877">COUCHDB-417</key>
        <summary>Graphical interface for editing _list functions</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="vmx">Volker Mische</reporter>
            
    <created>Sun, 19 Jul 2009 13:36:59 +0000 (UTC)</created>
    <updated>Mon, 20 Jul 2009 17:54:49 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733278" author="janl" created="Mon, 20 Jul 2009 17:03:17 +0000 (UTC)"  >I tried the branch. I&apos;m seeing the &amp;quot;List&amp;quot; tab when editing a view, but when I click on it, I get to: /_utils/database.html?databasename in Firefox 3.5, 3.0.11 and Safari 4. What am i doing wrong? Firebug shows:&lt;br/&gt;
&lt;br/&gt;
Syntax error () jquery.js?1.3.1 (line 3603)</comment>
                    <comment id="12733299" author="vmx" created="Mon, 20 Jul 2009 17:54:49 +0000 (UTC)"  >Should be fixed now. Thanks Jan.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 20 Jul 2009 17:03:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-416] Replicating shards into a single aggregation node may cause endless respawning</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-416</link>

                    <description>I have a set of CouchDB instances, each one acting as a shard for a large set of data.&lt;br/&gt;
Ocassionally, we replicate each instances&apos; database into a different CouchDB instance. We always &amp;quot;pull&amp;quot; replicate (see image attached)&lt;br/&gt;
When we do this, we often see errors like this on the target instance:&lt;br/&gt;
* [Thu, 16 Jul 2009 13:52:32 GMT] [error] [emulator] Error in process &amp;lt;0.29787.102&amp;gt; with exit value: {function_clause,[{lists,map,[#Fun&amp;lt;couch_rep.6.75683565&amp;gt;,undefined]},{couch_rep,enum_docs_since,4}]}&lt;br/&gt;
* &lt;br/&gt;
* &lt;br/&gt;
* &lt;br/&gt;
* [Thu, 16 Jul 2009 13:52:32 GMT] [error] [&amp;lt;0.7456.6&amp;gt;] replication enumerator exited with {function_clause,&lt;br/&gt;
*                                     [{lists,map,&lt;br/&gt;
*                                       [#Fun&amp;lt;couch_rep.6.75683565&amp;gt;,undefined]},&lt;br/&gt;
*                                      {couch_rep,enum_docs_since,4}]} .. respawning&lt;br/&gt;
&lt;br/&gt;
Once this starts, it is fatal to the CouchDB instance. It logs these messages at over 1000 per second (log level = severe) and chews up HDD.&lt;br/&gt;
&lt;br/&gt;
No errors (other than a HTTP timeout) are seen.&lt;br/&gt;
&lt;br/&gt;
After a database had gone &amp;quot;respawning&amp;quot;,  the target node was shutdown, logs cleared, target node restarted. Log was tailed - all was quiet. Once a single replication was called again against this database it again immediatly went into respawning hell. There were no stacked replications in this case.&lt;br/&gt;
&lt;br/&gt;
From this it seems that - if a database ever goes into &amp;quot;respawning&amp;quot; it cannot recover (when your enviroment/setup requires replication to occur always).&lt;br/&gt;
</description>
                <environment>couchdb 0.9.0.r766883 CentOS x86_64</environment>
            <key id="12430676">COUCHDB-416</key>
        <summary>Replicating shards into a single aggregation node may cause endless respawning</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="enda.farrell">Enda Farrell</reporter>
            
    <created>Thu, 16 Jul 2009 14:55:00 +0000 (UTC)</created>
    <updated>Sat, 15 Aug 2009 05:15:03 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12731974" author="enda.farrell" created="Thu, 16 Jul 2009 14:57:48 +0000 (UTC)"  >This png shows how there are 4 sources (looks like they are running on different ports on localhost, but actually they are ssh LocalForwards to different servers) are replicating into a single database.</comment>
                    <comment id="12731977" author="enda.farrell" created="Thu, 16 Jul 2009 14:59:22 +0000 (UTC)"  >I do not believe that this is directly related to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-240&quot; title=&quot;Replication breaks with large Attachments.&quot;&gt;COUCHDB-240&lt;/a&gt; but it may have some resemblance.</comment>
                    <comment id="12732010" author="kocolosk" created="Thu, 16 Jul 2009 16:32:36 +0000 (UTC)"  >Hi Enda, thanks for this report.  There should be some lines in the logs on the remote servers around the time that this occurs that correspond to requests for&lt;br/&gt;
&lt;br/&gt;
/labuk_braintestbritian/_all_docs_by_seq?limit=100&amp;amp;startkey=...&lt;br/&gt;
&lt;br/&gt;
Can you check those logs to see if there was anything &amp;quot;out of the ordinary&amp;quot; -- e.g. a status code that was not 200?&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12732487" author="enda.farrell" created="Fri, 17 Jul 2009 11:56:31 +0000 (UTC)"  >Hi Adam.&lt;br/&gt;
&lt;br/&gt;
Due to the way I have been playing with the environments I am afraid I don&apos;t have debug logs for this particular test.&lt;br/&gt;
&lt;br/&gt;
However ...&lt;br/&gt;
&lt;br/&gt;
As I was attempting to recreate this, I did find a possible bug which has the same symptoms. Essentially, as I think you&apos;re hinting at above, if the source database doesn&apos;t exist, the replication module isn&apos;t handling the 404s and endlessly keeps trying. I have an example here of trying to pull replicate from a source that&apos;s known to NOT exist:&lt;br/&gt;
&lt;br/&gt;
***********************************************************************************************************************************&lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.141.0&amp;gt;] &apos;GET&apos; /social/ {1,1}&lt;br/&gt;
** Headers: [{&apos;Host&apos;,&amp;quot;10.10.10.16:5984&amp;quot;}]&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.141.0&amp;gt;] httpd 404 error response:&lt;br/&gt;
** {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Missing&amp;quot;}&lt;br/&gt;
** &lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [info] [&amp;lt;0.141.0&amp;gt;] 10.10.10.15 - - &apos;GET&apos; /social/ 404&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2451.0&amp;gt;] &apos;GET&apos; /social/_local%2F5ba3add9594c40bb0b0480ff454d89a2 {1,1}&lt;br/&gt;
** Headers: [{&apos;Host&apos;,&amp;quot;10.10.10.16:5984&amp;quot;}]&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2451.0&amp;gt;] httpd 404 error response:&lt;br/&gt;
** {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Missing&amp;quot;}&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [info] [&amp;lt;0.2451.0&amp;gt;] 10.10.10.15 - - &apos;GET&apos; /social/_local%2F5ba3add9594c40bb0b0480ff454d89a2 404&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2454.0&amp;gt;] &apos;GET&apos; /social/_all_docs_by_seq?limit=100&amp;amp;startkey=0 {1,1}&lt;br/&gt;
** Headers: [{&apos;Host&apos;,&amp;quot;10.10.10.16:5984&amp;quot;}]&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2454.0&amp;gt;] httpd 404 error response:&lt;br/&gt;
** {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Missing&amp;quot;}&lt;br/&gt;
** &lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [info] [&amp;lt;0.2454.0&amp;gt;] 10.10.10.15 - - &apos;GET&apos; /social/_all_docs_by_seq?limit=100&amp;amp;startkey=0 404&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2457.0&amp;gt;] &apos;GET&apos; /social/_all_docs_by_seq?limit=100&amp;amp;startkey=0 {1,1}&lt;br/&gt;
** Headers: [{&apos;Host&apos;,&amp;quot;10.10.10.16:5984&amp;quot;}]&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2457.0&amp;gt;] httpd 404 error response:&lt;br/&gt;
** {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Missing&amp;quot;}&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [info] [&amp;lt;0.2457.0&amp;gt;] 10.10.10.15 - - &apos;GET&apos; /social/_all_docs_by_seq?limit=100&amp;amp;startkey=0 404&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2460.0&amp;gt;] &apos;GET&apos; /social/_all_docs_by_seq?limit=100&amp;amp;startkey=0 {1,1}&lt;br/&gt;
** Headers: [{&apos;Host&apos;,&amp;quot;10.10.10.16:5984&amp;quot;}]&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2460.0&amp;gt;] httpd 404 error response:&lt;br/&gt;
** {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Missing&amp;quot;}&lt;br/&gt;
** &lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [info] [&amp;lt;0.2460.0&amp;gt;] 10.10.10.15 - - &apos;GET&apos; /social/_all_docs_by_seq?limit=100&amp;amp;startkey=0 404&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2463.0&amp;gt;] &apos;GET&apos; /social/_all_docs_by_seq?limit=100&amp;amp;startkey=0 {1,1}&lt;br/&gt;
** Headers: [{&apos;Host&apos;,&amp;quot;10.10.10.16:5984&amp;quot;}]&lt;br/&gt;
** &lt;br/&gt;
** [Thu, 16 Jul 2009 16:23:05 GMT] [debug] [&amp;lt;0.2463.0&amp;gt;] httpd 404 error response:&lt;br/&gt;
** {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Missing&amp;quot;}&lt;br/&gt;
** &lt;br/&gt;
**                                                                                                                            &lt;br/&gt;
***********************************************************************************************************************************&lt;br/&gt;
&lt;br/&gt;
Is thins a known bug? If not I can spin one up.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
It *is* possible that the above is the bug, and that it has nothing to do with replicating the same database-name from many sources into a single (aggregator) database. I have not yet been able to rule it in or out. Never-the-less, I&apos;ll be changing our &amp;quot;replication controller&amp;quot; code to be mindful of this issue.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I</comment>
                    <comment id="12743523" author="kocolosk" created="Sat, 15 Aug 2009 02:21:32 +0000 (UTC)"  >Hi Enda, good sleuthing.  Trunk now throws a db_not_found exception if the source and/or target DB does not exist.  We should probably clean up the error message that gets propagated to the client, but now it won&apos;t respawn like mad and blow up logs.&lt;br/&gt;
&lt;br/&gt;
I&apos;m fairly certain that the missing DB was the problem.  Multiple sources replicating to the same target should work just fine.  If you give the OK I&apos;ll close this ticket.</comment>
                    <comment id="12743549" author="kocolosk" created="Sat, 15 Aug 2009 05:14:17 +0000 (UTC)"  >Cleaned up the error message.  If you try to specify a non-existent DB as source or target, replication will fail immediately with a 404. The response body will indicate which DB could&lt;br/&gt;
not be opened.</comment>
                    <comment id="12743551" author="kocolosk" created="Sat, 15 Aug 2009 05:15:03 +0000 (UTC)"  >resolving, back to Enda for confirmation</comment>
                </comments>
    
    <attachments>
            <attachment id="12413695" name="Picture 2.png" size="50568" author="enda.farrell" created="Thu, 16 Jul 2009 14:57:48 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 15 Aug 2009 05:15:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 16 Jul 2009 16:32:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-415] View sorting</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-415</link>

                    <description>I&apos;d like to be able to sort the output of a view. I have a view that generates a list of event objects with start and end timestamps (and some other data). I emit this data using the end timestamp as the key, because that is what I want to use for my ?startkey=... query. But I&apos;d like the results to be sorted by the start timestamp. I understand this is not currently possible using regular CouchDB views.&lt;br/&gt;
&lt;br/&gt;
The CouchDB Users mailinglist suggested to use couchdb-lucene, as that does offer the option to sort on any indexed field. I&apos;m trying that route now, but it feels like overkill to add a full-text indexer to CouchDB just to be able to sort the output of my view.&lt;br/&gt;
&lt;br/&gt;
Some soundbites from the IRC channel when I brought this up:&lt;br/&gt;
&lt;br/&gt;
----&lt;br/&gt;
&amp;lt;rnewson&amp;gt; breun: jan___: in this case the data to sort on is known at map time, so an extension to emit to support multiple keys (with separate btrees) would do it. not sure how much effort that is, though.&lt;br/&gt;
&amp;lt;rnewson&amp;gt; sorting at query time feels infeasible.&lt;br/&gt;
&lt;br/&gt;
&amp;lt;jan____&amp;gt; rnewson: I think davisp had something like that working back in the day. i.e. alternate sort oder. davisp?&lt;br/&gt;
&lt;br/&gt;
&amp;lt;rnewson&amp;gt; jan___: I missed that, but it sounds reasonable at emit time.&lt;br/&gt;
&lt;br/&gt;
&amp;lt;davisp&amp;gt; I think its this one: &lt;a href=&quot;http://github.com/davisp/couchdb-old-patches/tree/view-sort&quot;&gt;http://github.com/davisp/couchdb-old-patches/tree/view-sort&lt;/a&gt;&lt;br/&gt;
----&lt;br/&gt;
&lt;br/&gt;
I would love to have view sorting native in CouchDB.</description>
                <environment></environment>
            <key id="12430646">COUCHDB-415</key>
        <summary>View sorting</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="breun">Nils Breunese</reporter>
            
    <created>Thu, 16 Jul 2009 08:28:47 +0000 (UTC)</created>
    <updated>Thu, 20 Aug 2009 20:15:04 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>3</votes>
    
                                        

            <comments>
                    <comment id="12731912" author="kocolosk" created="Thu, 16 Jul 2009 11:53:09 +0000 (UTC)"  >I&apos;m +1 on getting this feature into CouchDB in some fashion.  There are lots of cases where a client-side sort is infeasible.</comment>
                    <comment id="12738008" author="paul.joseph.davis" created="Sun, 2 Aug 2009 07:41:19 +0000 (UTC)"  >Just realized that my old patch may not be the entire answer to this. For reference, the old patch only allows specifying forward or reverse sorting for array key elements at definition time.&lt;br/&gt;
&lt;br/&gt;
Nils here apparently wants to select a range of rows by endtime and then resort based on starttime. My patch would only give &amp;quot;sort by end time asc, sort by startime asc within endtime keys&amp;quot;. Think simple Excel sort by multiple columns type sorting here.&lt;br/&gt;
&lt;br/&gt;
That said, the patch itself isn&apos;t too hard.</comment>
                    <comment id="12738015" author="paul.joseph.davis" created="Sun, 2 Aug 2009 08:07:45 +0000 (UTC)"  >Link to old issue with the patch</comment>
                    <comment id="12745003" author="breun" created="Wed, 19 Aug 2009 11:17:03 +0000 (UTC)"  >Looks like couchdb-footrest (&lt;a href=&quot;http://github.com/assembly/couchdb-footrest&quot;&gt;http://github.com/assembly/couchdb-footrest&lt;/a&gt;) implements this feature:&lt;br/&gt;
&lt;br/&gt;
----&lt;br/&gt;
Order Docs By Value Fields&lt;br/&gt;
&lt;br/&gt;
Ever need to order results by something other than the key you&apos;re segmenting the data with? Footrest makes that easy too:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/loudly_dev/_footrest/_all_docs?startkey=&quot;&gt;http://localhost:5984/loudly_dev/_footrest/_all_docs?startkey=&lt;/a&gt;&amp;quot;00&amp;quot;&amp;amp;endkey=&amp;quot;10&amp;quot;&amp;amp;order_by=[&amp;quot;created_at&amp;quot;,&amp;quot;asc&amp;quot;]&lt;br/&gt;
----</comment>
                    <comment id="12745609" author="jchris" created="Thu, 20 Aug 2009 20:15:04 +0000 (UTC)"  >I&apos;m not that into this patch, because it will require complex optimizations to work on view queries with more than a trivial number of rows. Otherwise we&apos;ll asking the Erlang VM to store the entirety of the view query in memory, and that&apos;s not feasible.&lt;br/&gt;
&lt;br/&gt;
Footrest looks like it&apos;s coming along, now that it has the ability to use another CouchDB database as a scratch pad.&lt;br/&gt;
&lt;br/&gt;
I also don&apos;t think this blocks the user-definable collations. Those don&apos;t suffer from the same memory usage problems, as they are applied one row at a time when the rows are indexed.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10032">
            <name>Blocker</name>
                            <outwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12408117">COUCHDB-158</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 16 Jul 2009 11:53:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-414] If &quot;aclocal&quot; is invoked during build, it doesn&apos;t get called with the right arguments</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-414</link>

                    <description>For some changes a Linux distro might make to couchdb when packaging, the build might reinvoke aclocal, automake, autoconf, etc.&lt;br/&gt;
&lt;br/&gt;
If &amp;quot;aclocal&amp;quot; gets invoked, it doesn&apos;t know that some of the macros are stored in the m4/ subdirectory.  This can be fixed by adding the following line to the toplevel Makefile.am:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ACLOCAL_AMFLAGS = -I m4&lt;br/&gt;
&lt;br/&gt;
This is documented in Section 6.3.4 (Handling Local Macros) of the Automake 1.10 manual.&lt;br/&gt;
&lt;br/&gt;
It is also recommended to add a line like the following to configure.ac so other tools know you&apos;re using m4/ as the autoconf macro directory:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;AC_CONFIG_MACRO_DIR([m4])&lt;br/&gt;
&lt;br/&gt;
With these two changes, it shouldn&apos;t be necessary to explicitly m4_include() m4/ac_check_icu.m4 in configure.ac</description>
                <environment>Ubuntu 9.04</environment>
            <key id="12430453">COUCHDB-414</key>
        <summary>If &quot;aclocal&quot; is invoked during build, it doesn&apos;t get called with the right arguments</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="jameshenstridge">James Henstridge</reporter>
            
    <created>Wed, 15 Jul 2009 01:42:25 +0000 (UTC)</created>
    <updated>Fri, 25 Sep 2009 16:27:01 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <issuelinks>
                <issuelinktype id="12310010">
            <name>Incorporates</name>
                            <outwardlinks description="incorporates">
                            <issuelink>
            <issuekey id="12409413">COUCHDB-165</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12420568" name="0001-Add-proper-aclocal-arguments.patch" size="1560" author="ndim" created="Fri, 25 Sep 2009 16:27:01 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-413] src/couchdb/priv/couchspawnkillable not included by &quot;make dist&quot;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-413</link>

                    <description>I was building a tarball from Subversion r793829, and ended up with the following error:&lt;br/&gt;
&lt;br/&gt;
...&lt;br/&gt;
make[3]: *** No rule to make target `priv/couchspawnkillable&apos;, needed by `all-am&apos;.  Stop.&lt;br/&gt;
make[3]: Leaving directory `/build/buildd/couchdb-0.10.0~svn793829/src/couchdb&apos;&lt;br/&gt;
make[2]: *** [all-recursive] Error 1&lt;br/&gt;
make[2]: Leaving directory `/build/buildd/couchdb-0.10.0~svn793829&apos;&lt;br/&gt;
make[1]: *** [all] Error 2&lt;br/&gt;
make[1]: Leaving directory `/build/buildd/couchdb-0.10.0~svn793829&apos;&lt;br/&gt;
&lt;br/&gt;
It seems that the script is not included in the distribution tarball.  This could be fixed by adding $(couchpriv_SCRIPTS) to EXTRA_DIST in src/couchdb/Makefile.am.</description>
                <environment>Ubuntu 9.04</environment>
            <key id="12430451">COUCHDB-413</key>
        <summary>src/couchdb/priv/couchspawnkillable not included by &quot;make dist&quot;</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="jameshenstridge">James Henstridge</reporter>
            
    <created>Wed, 15 Jul 2009 01:32:02 +0000 (UTC)</created>
    <updated>Wed, 26 Aug 2009 09:12:14 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12747848" author="jameshenstridge" created="Wed, 26 Aug 2009 09:12:14 +0000 (UTC)"  >Looks like this bug was fixed in r805272 (log message &amp;quot;Fixing make distcheck errors.&amp;quot;).</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 26 Aug 2009 09:12:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-412] CouchDB fails to start when log file is a pipe</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-412</link>

                    <description>I have an 0.9 CouchDB. When the local.ini file&apos;s [log] file is actually a pipe (with a known to be running consumer) rather than a file, CouchDB fails to start.</description>
                <environment>CentOS x86_64</environment>
            <key id="12430201">COUCHDB-412</key>
        <summary>CouchDB fails to start when log file is a pipe</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="enda.farrell">Enda Farrell</reporter>
            
    <created>Mon, 13 Jul 2009 12:50:43 +0000 (UTC)</created>
    <updated>Fri, 29 Jan 2010 10:31:06 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12730336" author="paul.joseph.davis" created="Mon, 13 Jul 2009 13:14:40 +0000 (UTC)"  >Are we sure this isn&apos;t a permissions error?</comment>
                    <comment id="12730348" author="enda.farrell" created="Mon, 13 Jul 2009 13:47:05 +0000 (UTC)"  >Yes - the pipes were created by root using:&lt;br/&gt;
&amp;quot;mkfifo -m 777 5984.log&amp;quot;&lt;br/&gt;
and result in:&lt;br/&gt;
&amp;quot;prwxrwxrwx 1 root    root       0 Jul 13 13:57 5984.log&amp;quot;&lt;br/&gt;
&lt;br/&gt;
A thought had occurred later - the ini file uses &amp;quot;[log] file = ...&amp;quot; and I tried &amp;quot;[log] pipe = ...&amp;quot; and CouchDB starts up and appears to run. I am starting tests now to see if this is actually the case.</comment>
                    <comment id="12730349" author="paul.joseph.davis" created="Mon, 13 Jul 2009 13:53:42 +0000 (UTC)"  >setting &apos;pipe = something&apos; in the ini file will just result in an ignored value.</comment>
                    <comment id="12730350" author="enda.farrell" created="Mon, 13 Jul 2009 13:56:39 +0000 (UTC)"  >Unfortunatly, the &amp;quot;[log] pipe = ...&amp;quot; directive does not seem to work.&lt;br/&gt;
&lt;br/&gt;
In my &amp;quot;defaults.ini&amp;quot; I have  &amp;quot;/usr/local/couchdb/var/log/couch.log&amp;quot; as the default log. In my per-instance ini (I run many instances on a single machine) I have overriding definitions tghat puts CouchDB logs into specific directories. When I change the per-instance ini, the override does not work, CouchDB is NOT logging into the pipe, it is logging into the default log. It&apos;s not failing on startup - it fails silently instead of throwing an error.</comment>
                    <comment id="12730356" author="enda.farrell" created="Mon, 13 Jul 2009 14:21:45 +0000 (UTC)"  >... as Paul Joseph Davis points out ...</comment>
                    <comment id="12740555" author="kocolosk" created="Fri, 7 Aug 2009 13:49:16 +0000 (UTC)"  >CouchDB executes the following code:&lt;br/&gt;
&lt;br/&gt;
Filename = couch_config:get(&amp;quot;log&amp;quot;, &amp;quot;file&amp;quot;, &amp;quot;couchdb.log&amp;quot;),&lt;br/&gt;
{ok, Fd} = file:open(Filename, [append]),&lt;br/&gt;
&lt;br/&gt;
I tried using a pipe in a plain erl shell:&lt;br/&gt;
&lt;br/&gt;
$ mkfifo -m 777 blah.log&lt;br/&gt;
$ ls -l blah.log&lt;br/&gt;
prwxrwxrwx  1 kocolosk  staff  0 Aug  7 09:45 blah.log&lt;br/&gt;
&lt;br/&gt;
$ erl&lt;br/&gt;
Erlang R13B (erts-5.7.1) [source] [smp:2:2] [rq:2] [async-threads:0] [hipe] [kernel-poll:false]&lt;br/&gt;
&lt;br/&gt;
Eshell V5.7.1  (abort with ^G)&lt;br/&gt;
1&amp;gt; file:open(&amp;quot;blah.log&amp;quot;, [append]).&lt;br/&gt;
{error,eisdir}&lt;br/&gt;
&lt;br/&gt;
Sure enough, in the Erlang manual for file:open there&apos;s a list of common error codes that includes&lt;br/&gt;
&lt;br/&gt;
eisdir:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;The  named  file  is not a regular file. It may be a directory, a&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fifo, or a device.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll do a little more digging to see how one is supposed to handle FIFOs in Erlang.</comment>
                    <comment id="12740567" author="kocolosk" created="Fri, 7 Aug 2009 14:32:56 +0000 (UTC)"  >Hmm, weird stuff.  It looks like open_port() used to be able to work with named pipes (~2001), but I think that&apos;s no longer the case.  It&apos;s possible to redirect stdin and stdout to named pipes using run_erl&lt;br/&gt;
&lt;br/&gt;
run_erl -daemon /tmp/ /tmp &amp;quot;/usr/local/bin/couchdb&amp;quot;&lt;br/&gt;
&lt;br/&gt;
but I don&apos;t really care for that solution.</comment>
                    <comment id="12740569" author="kocolosk" created="Fri, 7 Aug 2009 14:34:48 +0000 (UTC)"  >Found a thread from 2008 that recommends writing wrapper scripts around named pipes for use with open_port():&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://erlang.org/pipermail/erlang-questions/2008-August/037234.html&quot;&gt;http://erlang.org/pipermail/erlang-questions/2008-August/037234.html&lt;/a&gt;</comment>
                    <comment id="12802751" author="mwhooker" created="Wed, 20 Jan 2010 08:55:45 +0000 (UTC)"  >This is a &amp;quot;rough draft&amp;quot; of a potential fix for this issue. &lt;br/&gt;
&lt;br/&gt;
This patch makes it so all writes to the log file happen through a port to the attached wrapper script. &lt;br/&gt;
&lt;br/&gt;
If people think this is a good approach the problem, a few more things should be done:&lt;br/&gt;
&lt;br/&gt;
1. only use the pipe wrapper if the target file is a named pipe, otherwise use standard file descriptors.&lt;br/&gt;
2. find win32 solution (if applicable)&lt;br/&gt;
&lt;br/&gt;
I think a risk with this approach is if the wrapper script is aborted for some reason. There&apos;s no supervisor process to restart it, so logs will stop working.</comment>
                    <comment id="12802805" author="candlerb" created="Wed, 20 Jan 2010 12:16:17 +0000 (UTC)"  >I think this should be made a general facility to log via an external program: i.e. don&apos;t hardcoded the path to pipe_wrapper.sh, or the fact that it requires a filename argument for the log destination.&lt;br/&gt;
&lt;br/&gt;
This would then be comparable to the corresponding feature in Apache httpd:&lt;br/&gt;
&lt;br/&gt;
CustomLog &amp;quot;|/path/to/program&amp;quot; ...&lt;br/&gt;
&lt;br/&gt;
It would let you do lots of cool things: e.g. log to syslog or log via HTTP to another couchdb server, without having to launch another process which tails a pipe.&lt;br/&gt;
</comment>
                    <comment id="12806207" author="mwhooker" created="Fri, 29 Jan 2010 03:04:15 +0000 (UTC)"  >@Brian I think that makes a lot of sense, but is also a little beyond the scope of this bug.  Maybe we should close this out and open a new feature request?&lt;br/&gt;
&lt;br/&gt;
If closing this bug out is the way to go, what do people think of this proposed solution?</comment>
                    <comment id="12806295" author="enda.farrell" created="Fri, 29 Jan 2010 10:31:06 +0000 (UTC)"  >I favour the approach that allows the &apos;CustomLog &amp;quot;|/path/to/program&amp;quot; &apos;  - but as I&apos;ve not tried to write such a handoff, I don&apos;t know if it&apos;s difficult or simply a matter of a config ini setting.&lt;br/&gt;
&lt;br/&gt;
I think it somewhat important that if there&apos;s no supervisor process to restart it, we at least have the ability to call (perhaps the  _status?) an API to test whether or not it is working/running.</comment>
                </comments>
    
    <attachments>
            <attachment id="12430858" name="COUCHDB_412_01.patch" size="4388" author="mwhooker" created="Wed, 20 Jan 2010 08:55:45 +0000 (UTC)" />
            <attachment id="12430859" name="pipe_wrapper.sh" size="66" author="mwhooker" created="Wed, 20 Jan 2010 08:55:45 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 13 Jul 2009 13:14:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-411] Unescaped database name in Location header in 201 response after document creation</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-411</link>

                    <description>I just did a PUT on /test_suite_db%2Fwith_slashes/ to create a new document, and the Location header in the 201 Created response had a literal slash in the database name instead; the resulting URL of course yields a 404:&lt;br/&gt;
&lt;br/&gt;
POST /test_suite_db%2Fwith_slashes/ HTTP/1.0&lt;br/&gt;
Host: localhost:5984&lt;br/&gt;
User-Agent: PHPCouch/1.0.0-dev&lt;br/&gt;
Accept: */*, application/json&lt;br/&gt;
Content-Length: 13&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;foo&amp;quot;:&amp;quot;bar&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 201 Created&lt;br/&gt;
Server: CouchDB/0.9.0 (Erlang OTP/R13B)&lt;br/&gt;
Location: &lt;a href=&quot;http://localhost:5984/test_suite_db/with_slashes/d578ca758745a89add2c369695fcd9ec&quot;&gt;http://localhost:5984/test_suite_db/with_slashes/d578ca758745a89add2c369695fcd9ec&lt;/a&gt;&lt;br/&gt;
Date: Sun, 12 Jul 2009 15:10:08 GMT&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Content-Length: 73&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;d578ca758745a89add2c369695fcd9ec&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-1120917420&amp;quot;}</description>
                <environment>Mac OS X 10.5.7 / CouchDBX-0.9.0-R13B</environment>
            <key id="12430170">COUCHDB-411</key>
        <summary>Unescaped database name in Location header in 201 response after document creation</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dzuelke">David Z&#252;lke</reporter>
            
    <created>Sun, 12 Jul 2009 17:44:43 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 17:25:24 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12739049" author="janl" created="Tue, 4 Aug 2009 17:25:24 +0000 (UTC)"  >Fixed in r800883</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 17:25:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 17:25:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-410] JavaScript errors in validate_doc_update should be handled more gracefully</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-410</link>

                    <description>For example, if I create validate_doc_update:&lt;br/&gt;
&lt;br/&gt;
function (oldDoc, newDoc, userCtx) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;doc.foo;&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
I am greeted by an &amp;quot;OS process timed out&amp;quot; message.  In the logs, all I see is:&lt;br/&gt;
&lt;br/&gt;
OS Process :: Error converting object to JSON: TypeError: {Array:function (v) {var buf = [];for (var i = 0; i &amp;lt; v.length; i++) {buf.push(toJSON(v[i]));}return &amp;quot;[&amp;quot; + buf.join(&amp;quot;,&amp;quot;) + &amp;quot;]&amp;quot;;}, Boolean:function (v) {return v.toString();}, Date:function (v) {var f = function (n) {return n &amp;lt; 10 ? &amp;quot;0&amp;quot; + n : n;};return &amp;quot;\&amp;quot;&amp;quot; + v.getUTCFullYear() + &amp;quot;-&amp;quot; + f(v.getUTCMonth() + 1) + &amp;quot;-&amp;quot; + f(v.getUTCDate()) + &amp;quot;T&amp;quot; + f(v.getUTCHours()) + &amp;quot;:&amp;quot; + f(v.getUTCMinutes()) + &amp;quot;:&amp;quot; + f(v.getUTCSeconds()) + &amp;quot;Z\&amp;quot;&amp;quot;;}, Number:function (v) {return isFinite(v) ? v.toString() : &amp;quot;null&amp;quot;;}, Object:function (v) {if (v === null) {return &amp;quot;null&amp;quot;;}var buf = [];for (var k in v) {if (!v.hasOwnProperty(k) || typeof k !== &amp;quot;string&amp;quot; || v[k] === undefined) {continue;}buf.push(toJSON(k, val) + &amp;quot;: &amp;quot; + toJSON(v[k]));}return &amp;quot;{&amp;quot; + buf.join(&amp;quot;,&amp;quot;) + &amp;quot;}&amp;quot;;}, String:function (v) {if (/[&amp;quot;\\\x00-\x1f]/.test(v)) {v = v.replace(/([\x00-\x1f\\&amp;quot;])/g, function (a, b) {var c = subs[b];if (c) {return c;}c = b.charCodeAt();return &amp;quot;\\u00&amp;quot; + Math.floor(c / 16).toString(16) + (c % 16).toString(16);});}return &amp;quot;\&amp;quot;&amp;quot; + v + &amp;quot;\&amp;quot;&amp;quot;;}}[val != null ? val.constructor.name : &amp;quot;Object&amp;quot;] is not a function&lt;br/&gt;
&lt;br/&gt;
When really the problem is a ReferenceError (I should have used newDoc.foo or oldDoc.foo).  The attached patch modifies toJSON() in utils.js so that it converts anything that isn&apos;t a String, Array, Date, Object etc. into a String.  This makes the error appear in the popup in Futon when saving.&lt;br/&gt;
&lt;br/&gt;
This isn&apos;t necessarily the best thing to do as it modifies the semantics of toJSON(), and also we might want to keep the exception info in the logs, and not propagate it to the user.  Perhaps it would be better to modify respond(obj) to produce a better error message in the logs (simply adding something that tried to log obj.toString() would suffice).</description>
                <environment></environment>
            <key id="12430144">COUCHDB-410</key>
        <summary>JavaScript errors in validate_doc_update should be handled more gracefully</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Sat, 11 Jul 2009 16:05:48 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:40:39 +0000 (UTC)</updated>

                        <version>0.9.1</version>
                    <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12730004" author="jasondd" created="Sat, 11 Jul 2009 16:06:54 +0000 (UTC)"  >Patch that modifies toJSON() so that toJSON(ReferenceError(&amp;quot;doc.foo is not defined&amp;quot;)) works.</comment>
                    <comment id="12730005" author="jasondd" created="Sat, 11 Jul 2009 16:11:40 +0000 (UTC)"  >Clarified what the error is in my example.</comment>
                    <comment id="12772676" author="kocolosk" created="Mon, 2 Nov 2009 20:40:39 +0000 (UTC)"  >I don&apos;t think there&apos;s going to be an 0.9.2, adjusting FixFor to 0.11</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12433880">COUCHDB-484</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12413208" name="util.js.diff" size="768" author="jasondd" created="Sat, 11 Jul 2009 16:06:54 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:40:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-409] $.couch.saveDoc() in jquery.couch.js sets doc._id and doc._rev to undefined on error, causing a new doc to be created if the same doc is modified and saved again</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-409</link>

                    <description>Simple fix attached.  Recommend that we include this in 0.9.1 as it&apos;s a non-obvious annoyance that occurs when saving docs in Futon.&lt;br/&gt;
&lt;br/&gt;
For example, if I try and save a doc and validation fails, and I fix the doc and save again, it will be saved with a NEW document id, since doc._id is set to undefined.</description>
                <environment></environment>
            <key id="12430143">COUCHDB-409</key>
        <summary>$.couch.saveDoc() in jquery.couch.js sets doc._id and doc._rev to undefined on error, causing a new doc to be created if the same doc is modified and saved again</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Sat, 11 Jul 2009 15:41:23 +0000 (UTC)</created>
    <updated>Sat, 11 Jul 2009 21:07:52 +0000 (UTC)</updated>

                        <version>0.9.1</version>
                    <version>0.10</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12730015" author="paul.joseph.davis" created="Sat, 11 Jul 2009 21:07:52 +0000 (UTC)"  >Comitted in r793218 and backported to the 0.9.x branch</comment>
                </comments>
    
    <attachments>
            <attachment id="12413207" name="jquery.couch.saveDoc.diff" size="706" author="jasondd" created="Sat, 11 Jul 2009 15:42:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 11 Jul 2009 21:07:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 11 Jul 2009 21:07:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-408] Futon _view URLs should be similar to the HTTP interface</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-408</link>

                    <description>URLs of view in Futon normally look like:&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/_utils/database.html?db/_design/designdocname/viewname&quot;&gt;http://localhost:5984/_utils/database.html?db/_design/designdocname/viewname&lt;/a&gt;&lt;br/&gt;
The HTTP interface is:&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/db/_design/desigdocname/_view/viewname&quot;&gt;http://localhost:5984/db/_design/desigdocname/_view/viewname&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The patch changes the URLs to:&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/_utils/database.html?db/_design/designdocname/_view/viewname&quot;&gt;http://localhost:5984/_utils/database.html?db/_design/designdocname/_view/viewname&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
It changes the dropdown menu on the top right to use this new URL, are there any other places where you can get to a view?&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12430097">COUCHDB-408</key>
        <summary>Futon _view URLs should be similar to the HTTP interface</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="vmx">Volker Mische</reporter>
            
    <created>Fri, 10 Jul 2009 20:18:31 +0000 (UTC)</created>
    <updated>Tue, 21 Jul 2009 21:17:32 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12729799" author="vmx" created="Fri, 10 Jul 2009 20:19:26 +0000 (UTC)"  >Changes _view URLs in Futon to URLs similar to the HTTP interface.</comment>
                    <comment id="12730023" author="vmx" created="Sat, 11 Jul 2009 22:44:04 +0000 (UTC)"  >Updated patch (&amp;quot;save view as&amp;quot; redirected to the wrong URL).</comment>
                    <comment id="12733288" author="janl" created="Mon, 20 Jul 2009 17:36:41 +0000 (UTC)"  >It actually turns the URIs into /_utils/database.html?db/_design%2fdesigndocname%2f_view%2fviewname for me (safari 4, firefox 3.0.11). I find that less readable :)</comment>
                    <comment id="12733362" author="cmlenz" created="Mon, 20 Jul 2009 21:32:46 +0000 (UTC)"  >I&apos;ve applied this patch in r796027, and modified it to only URL-encode the doc-id and view-name parts, which should address Jan&apos;s issue.</comment>
                    <comment id="12733385" author="vmx" created="Mon, 20 Jul 2009 22:43:43 +0000 (UTC)"  >At the moment Design Docs with slashes don&apos;t work in Futon (they also didn&apos;t work before this patch was applied). Some smarter en/decoding is needed.&lt;br/&gt;
&lt;br/&gt;
My proposition is to keep document IDs URL encoded internally and only decoding them for display purpose. This way you can split the path easily into Design Doc and View with a path.split(&amp;quot;/&amp;quot;) (without splitting an ID accidently).&lt;br/&gt;
&lt;br/&gt;
While this needs quite a few changes, it might also make sense to change jquery.couch.js/openDoc() to take an already encoded URL as parameter. Else you would need an encode/decode round-trip quite often.</comment>
                    <comment id="12733811" author="cmlenz" created="Tue, 21 Jul 2009 20:29:54 +0000 (UTC)"  >I&apos;m attaching a patch that cleans up the encoding/decoding of design doc IDs and view names. Haven&apos;t been able to find any cases where this fails, but of course it&apos;s still possible I&apos;ve missed something. Would appreciate some testing by others before checking this in.</comment>
                    <comment id="12733821" author="vmx" created="Tue, 21 Jul 2009 20:53:20 +0000 (UTC)"  >Works great for me.</comment>
                    <comment id="12733832" author="cmlenz" created="Tue, 21 Jul 2009 21:17:32 +0000 (UTC)"  >Thanks for testing, I&apos;ve applied the patch in r796541.</comment>
                </comments>
    
    <attachments>
            <attachment id="12413214" name="futon-view-url-2.patch" size="3416" author="vmx" created="Sat, 11 Jul 2009 22:44:04 +0000 (UTC)" />
            <attachment id="12414140" name="futon_design_name_slashes.diff" size="10354" author="cmlenz" created="Tue, 21 Jul 2009 20:29:54 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 21:17:32 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 20 Jul 2009 17:36:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-407] Add DELETE /_add_dbs?seriously=true</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-407</link>

                    <description>Convenience method to delete all databases on the server.</description>
                <environment></environment>
            <key id="12429958">COUCHDB-407</key>
        <summary>Add DELETE /_add_dbs?seriously=true</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="briankierstead">Brian Kierstead</reporter>
            
    <created>Thu, 9 Jul 2009 17:14:06 +0000 (UTC)</created>
    <updated>Mon, 20 Jul 2009 17:45:09 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12729341" author="paul.joseph.davis" created="Thu, 9 Jul 2009 17:21:13 +0000 (UTC)"  >I&apos;m -1 on this. I&apos;d close it out of hand right now as won&apos;t fix but I&apos;ll leave it open for a bit to see if anyone can convince me that its not out of the question.</comment>
                    <comment id="12729354" author="briankierstead" created="Thu, 9 Jul 2009 17:56:14 +0000 (UTC)"  >I added it because we&apos;re generating large numbers (~50k) of DB&apos;s and having a convenient way to delete would be nice.</comment>
                    <comment id="12729362" author="paul.joseph.davis" created="Thu, 9 Jul 2009 18:12:01 +0000 (UTC)"  >I&apos;m still not convinced. A Python script to do that would be like 10 lines and that could include regular expression filtering and other bells and whistles. Sticking a big red &amp;quot;DON&apos;T PUSH&apos; button out there for all clients to push does not sound like a good idea to me.&lt;br/&gt;
</comment>
                    <comment id="12733295" author="janl" created="Mon, 20 Jul 2009 17:45:09 +0000 (UTC)"  >find  /var/lib/couchdb/ | xargs rm -rf</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 20 Jul 2009 17:45:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 9 Jul 2009 17:21:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-406] build on windows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-406</link>

                    <description>Attaching a patch to get things building on Windows, including docs.  As noted in the docs, we reuse as much of the couch and erlang build processes as possible.  This patch leaves a functioning couch on Windows - with some polish left to be done, but working and tests passing as well as expected - and still works on linux.&lt;br/&gt;
&lt;br/&gt;
Includes a couple of new files - couchspawnkillable_win.c from &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-374&quot; title=&quot;couchspawnkillable doesn&apos;t work on windows&quot;&gt;&lt;strike&gt;COUCHDB-374&lt;/strike&gt;&lt;/a&gt; (while I will close), and a couchdb.bat.tpl file which generates a suitable .bat file at &apos;make install&apos; time.&lt;br/&gt;
&lt;br/&gt;
Note this patch makes no attempt to create an installer - it just creates a functioning tree suitable for zipping up, or for future consumption by an installer.</description>
                <environment>windows, trunk</environment>
            <key id="12429933">COUCHDB-406</key>
        <summary>build on windows</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Thu, 9 Jul 2009 12:34:47 +0000 (UTC)</created>
    <updated>Tue, 18 Aug 2009 23:29:40 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12729235" author="mhammond" created="Thu, 9 Jul 2009 12:35:49 +0000 (UTC)"  >windows build patch</comment>
                    <comment id="12737418" author="mhammond" created="Fri, 31 Jul 2009 04:21:42 +0000 (UTC)"  >updated patch addressing comments from nslater, and updated README based on starting this process again from scratch.  I&apos;m proposing this for checkin ASAP.</comment>
                    <comment id="12742125" author="mhammond" created="Wed, 12 Aug 2009 00:01:05 +0000 (UTC)"  >removed conflict in configure.ac</comment>
                    <comment id="12743991" author="mhammond" created="Mon, 17 Aug 2009 07:57:51 +0000 (UTC)"  >davisp added some tweaks to address build failures on osx</comment>
                    <comment id="12744005" author="janl" created="Mon, 17 Aug 2009 09:23:31 +0000 (UTC)"  >This still fails for me on Mac OS X 10.5.8. &lt;br/&gt;
&lt;br/&gt;
I think the correct solution is to not depend on the priv/couchspawnkillable target in the non-windows case, but I have no idea how to make that happen. Noah?&lt;br/&gt;
&lt;br/&gt;
In addition: as a result `make clean` removes couchspawnkillable in the non-windows case.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12744102" author="paul.joseph.davis" created="Mon, 17 Aug 2009 15:28:49 +0000 (UTC)"  >Jan, what&apos;s the build failure you&apos;re getting? Is it still trying to compile couchspawnkillable_win.c? It looks like that patch doesn&apos;t include the renaming the kill script. But it basically does what you&apos;re saying, make couchspawnkillable a target that is built on both platforms, in the case of *nix I just copy couchspawnkillable.sh to couchspawnkillable.&lt;br/&gt;
&lt;br/&gt;
If its not that link failure, can you paste the traceback?</comment>
                    <comment id="12744779" author="paul.joseph.davis" created="Tue, 18 Aug 2009 23:29:40 +0000 (UTC)"  >Applied in r805243</comment>
                </comments>
    
    <attachments>
            <attachment id="12413008" name="windows_build.patch" size="22542" author="mhammond" created="Thu, 9 Jul 2009 12:35:49 +0000 (UTC)" />
            <attachment id="12415092" name="windows_build_2.patch" size="21535" author="mhammond" created="Fri, 31 Jul 2009 04:21:42 +0000 (UTC)" />
            <attachment id="12416264" name="windows_build_3.patch" size="21436" author="mhammond" created="Wed, 12 Aug 2009 00:01:05 +0000 (UTC)" />
            <attachment id="12416752" name="windows_build_4.patch" size="21908" author="mhammond" created="Mon, 17 Aug 2009 07:57:50 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 23:29:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 17 Aug 2009 09:23:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-405] Change _changes line ending to simplify clients</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-405</link>

                    <description>Sending a &amp;quot;\n&amp;quot; with each line in the _changes response, especially the results rows, simplifies client code by making it much easier to parse. See &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200907.mbox/&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200907.mbox/&lt;/a&gt;&amp;lt;&lt;a href=&apos;mailto:214c385b0907070612r3ed4dad9ydc9e81c7aa3f6e83@mail.gmail.com&apos;&gt;214c385b0907070612r3ed4dad9ydc9e81c7aa3f6e83@mail.gmail.com&lt;/a&gt;&amp;gt; for full discussion.</description>
                <environment></environment>
            <key id="12429925">COUCHDB-405</key>
        <summary>Change _changes line ending to simplify clients</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="emgee">Matt Goodall</reporter>
            
    <created>Thu, 9 Jul 2009 10:20:35 +0000 (UTC)</created>
    <updated>Thu, 9 Jul 2009 10:28:04 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12729143" author="emgee" created="Thu, 9 Jul 2009 10:28:04 +0000 (UTC)"  >Patch to send newline with the results row, and a comma in front of all but the first row.</comment>
                </comments>
    
    <attachments>
            <attachment id="12412988" name="changes-newline.diff" size="657" author="emgee" created="Thu, 9 Jul 2009 10:28:04 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-404] restfull and shorter urls for lists and shows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-404</link>

                    <description>We discussing yesterday with @jchris and @jasondavies about shortening&lt;br/&gt;
shows and lists urls and we arrived on this format :&lt;br/&gt;
&lt;br/&gt;
/db/docid?show=dname/showname&lt;br/&gt;
/db/_view/dname/vname?list=listname&lt;br/&gt;
This change is very usefull since it allows shorter urls and I think&lt;br/&gt;
it&apos;s more RESTFul. I had time this morning to write this and I created&lt;br/&gt;
a branch on my github repository :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/benoitc/couchdb/tree/formuri&quot;&gt;http://github.com/benoitc/couchdb/tree/formuri&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
To do this I refactored a little couch_httpd_show to reuse code to&lt;br/&gt;
display lists and shows and added URL parameters parsing/validation.&lt;br/&gt;
All changes made in this branch don&apos;t break current CouchDB behavior&lt;br/&gt;
so :&lt;br/&gt;
&lt;br/&gt;
* Views are available on&lt;br/&gt;
&lt;br/&gt;
/db/_design/designame/_view/viewname (current behavior) but also on&lt;br/&gt;
/db/_view/designame/viewname&lt;br/&gt;
&lt;br/&gt;
* Lists are available on&lt;br/&gt;
&lt;br/&gt;
/db/_design/designame/_list/listname/viewname (current behavior)&lt;br/&gt;
&lt;br/&gt;
but also on&lt;br/&gt;
&amp;nbsp;/db/_view/designame/viewname?list=listname&lt;br/&gt;
&lt;br/&gt;
* Shows are available on&lt;br/&gt;
&lt;br/&gt;
/db/_design/designame/_show/showname/docid&lt;br/&gt;
&lt;br/&gt;
but also on&lt;br/&gt;
&lt;br/&gt;
/db/docid?show=designame/showname&lt;br/&gt;
</description>
                <environment>*</environment>
            <key id="12429697">COUCHDB-404</key>
        <summary>restfull and shorter urls for lists and shows</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 7 Jul 2009 08:49:10 +0000 (UTC)</created>
    <updated>Fri, 10 Jul 2009 01:19:19 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12728135" author="candlerb" created="Tue, 7 Jul 2009 15:02:43 +0000 (UTC)"  >My recollection is that the URLs were changed quite recently to the current format to make them *more* RESTful - specifically, that lists and shows could link to each other using relative URLs, without having to have hard-coded knowledge of the design document they were sitting in.&lt;br/&gt;
</comment>
                    <comment id="12728486" author="jchris" created="Wed, 8 Jul 2009 03:51:56 +0000 (UTC)"  >There are reasons to support both configurations.&lt;br/&gt;
&lt;br/&gt;
The _design doc path allows rewriting proxies to treat applications as resources, but the shortcut version is easier on user&apos;s eyes.&lt;br/&gt;
&lt;br/&gt;
We could have a big argument about which is better but frankly they both have their place. As long as we don&apos;t screw up replication I don&apos;t have a problem with relaxing the query syntax, especially with such a simple patch.</comment>
                    <comment id="12728489" author="benoitc" created="Wed, 8 Jul 2009 04:00:04 +0000 (UTC)"  >You could still use relatives urls with this format but against db: they aren&apos;t contained in the _design though but I don&apos;t think it&apos;s a problem since the patch don&apos;t break anything. But using format parameter make CouchDB a real resource/documnt repository where you could choose format of docs &amp;amp; views. And I think it&apos;s very usefull for some usages. </comment>
                    <comment id="12729418" author="benoitc" created="Thu, 9 Jul 2009 21:16:58 +0000 (UTC)"  >patch from my github repo</comment>
                    <comment id="12729488" author="jchris" created="Fri, 10 Jul 2009 01:19:19 +0000 (UTC)"  >applied in r792771</comment>
                </comments>
    
    <attachments>
            <attachment id="12413056" name="formuri.diff" size="19925" author="benoitc" created="Thu, 9 Jul 2009 21:16:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 10 Jul 2009 01:19:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 7 Jul 2009 15:02:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-403] User-defined GroupRowsFun</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-403</link>

                    <description>CouchDB has hard-coded functionality for grouping. From the user&apos;s point of view: group_level=N will truncate Array keys to the first N elements, and that&apos;s it. (*)&lt;br/&gt;
&lt;br/&gt;
It would be wonderful if application-specific grouping functions could be added. Useful examples include:&lt;br/&gt;
&lt;br/&gt;
* for string keys, truncate to the first N characters (e.g. group by first 3 letters of surname)&lt;br/&gt;
* for numeric keys, trunc(k/N) (e.g. divide by 100 would give you buckets of 0..99, 100..199, 200..299 etc)&lt;br/&gt;
* combine with group_level: e.g. truncate array to first two elements plus the third element divided by 100&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;string1&amp;quot;,&amp;quot;string2&amp;quot;,Number,&amp;quot;rest&amp;quot;] =&amp;gt; [&amp;quot;string1&amp;quot;,&amp;quot;string2&amp;quot;,trunc(Number/100)]&lt;br/&gt;
&lt;br/&gt;
* for numeric keys: use trunc(log(V) * N) for exponential buckets&lt;br/&gt;
* for hexadecimal-string keys: right-shift N places&lt;br/&gt;
* ...etc&lt;br/&gt;
&lt;br/&gt;
In each case N would be a parameter chosen at query time, like group_level is now.&lt;br/&gt;
&lt;br/&gt;
It would be sufficient just to have a hook to statically link Erlang functions to do this. There would then need to be two new HTTP parameters: one to choose the grouping function and one for any arguments it needs.&lt;br/&gt;
&lt;br/&gt;
Theoretically this function could also be handed off to the external view server so the logic could be written in Javascript or whatever, but I think it would be too slow in practice.&lt;br/&gt;
&lt;br/&gt;
Note: group truncation functions would have need to meet certain constraints to work with grouping logic. Something like:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;K1 &amp;lt;= K2 implies grouptrunc(K1) &amp;lt;= grouptrunc(K2)&lt;br/&gt;
&lt;br/&gt;
(*) It&apos;s not implemented exactly like that. As far as I can see, there&apos;s one function to compare keys for equality by looking at the first N elements (GroupRowsFun), and another function truncates them when emitting them (RespFun). For adding bolt-on functions it would be more convenient just to define a single group key truncation function.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12429693">COUCHDB-403</key>
        <summary>User-defined GroupRowsFun</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Tue, 7 Jul 2009 08:13:45 +0000 (UTC)</created>
    <updated>Tue, 7 Jul 2009 08:13:45 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-402] C code fails to build on Windows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-402</link>

                    <description>Much of the C code in couch currently fails to compile on Windows, due to the MS compiler being very slow keeping up with the C standards.  Specifically, the MS c compiler still doesn&apos;t like &apos;inline&apos; variable declarations - they must all be declared at the top of a block.  Submitting a patch which does exactly this.</description>
                <environment></environment>
            <key id="12429585">COUCHDB-402</key>
        <summary>C code fails to build on Windows</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Mon, 6 Jul 2009 07:58:08 +0000 (UTC)</created>
    <updated>Wed, 8 Jul 2009 01:26:57 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12727424" author="mhammond" created="Mon, 6 Jul 2009 07:58:44 +0000 (UTC)"  >Patch to move variable decls to the start of a block.</comment>
                    <comment id="12728457" author="paul.joseph.davis" created="Wed, 8 Jul 2009 01:26:57 +0000 (UTC)"  >Patch applied as of r792010</comment>
                </comments>
    
    <attachments>
            <attachment id="12412586" name="move_c_decls.patch" size="10822" author="mhammond" created="Mon, 6 Jul 2009 07:58:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 8 Jul 2009 01:26:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 8 Jul 2009 01:26:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-401] Remove trailing whitespaces from JavaScript files</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-401</link>

                    <description>The JavaScript failes contain many trailing whitespaces, please remove them.&lt;br/&gt;
&lt;br/&gt;
I could submit a patch, but I think it&apos;s way easier if one of the committers runs the one-liner locally and committs the changes.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve used&lt;br/&gt;
find . -name &apos;*.js&apos; -exec sed -i {} -e &apos;s/[ \t]*$//&apos; &apos;;&apos;&lt;br/&gt;
which I&apos;ve found at &lt;a href=&quot;http://zebert.blogspot.com/2009/06/clean-up-trailing-whitespaces-in.html&quot;&gt;http://zebert.blogspot.com/2009/06/clean-up-trailing-whitespaces-in.html&lt;/a&gt;&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12429574">COUCHDB-401</key>
        <summary>Remove trailing whitespaces from JavaScript files</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="vmx">Volker Mische</reporter>
            
    <created>Mon, 6 Jul 2009 00:18:22 +0000 (UTC)</created>
    <updated>Mon, 6 Jul 2009 00:31:09 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>JavaScript View Server</component>
                    <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12727370" author="paul.joseph.davis" created="Mon, 6 Jul 2009 00:26:29 +0000 (UTC)"  >Volker,&lt;br/&gt;
&lt;br/&gt;
Which JS files and why is it important?&lt;br/&gt;
&lt;br/&gt;
Paul&lt;br/&gt;
</comment>
                    <comment id="12727372" author="nslater" created="Mon, 6 Jul 2009 00:31:09 +0000 (UTC)"  >It&apos;s important because it&apos;s a coding standard.&lt;br/&gt;
&lt;br/&gt;
Every single committer should configure his or her editor to trim trailing white space and trailing newlines at the end of a file. I have run this command over every text file in the source. Thanks for bringing it to our attention. </comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 6 Jul 2009 00:31:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 6 Jul 2009 00:26:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-400] Allow Distributed Erlang Short/Long Name and Cookie to be Specified in Configuration Files</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-400</link>

                    <description>It would be nice to allow specifying Erlang short or long name and cookie via the ini files and have CouchDB read those values and setup distributed Erlang appropriately. This is useful for anyone using Hovercraft as well as a potential couchctl script to interact with a running CouchDB node via the command-line.&lt;br/&gt;
&lt;br/&gt;
An alternative to specifying these in the .ini files would be to allow doing it via startup scripts, but the ini files feels like a cleaner solution to me.</description>
                <environment></environment>
            <key id="12429530">COUCHDB-400</key>
        <summary>Allow Distributed Erlang Short/Long Name and Cookie to be Specified in Configuration Files</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="bbrowning">Ben Browning</reporter>
            
    <created>Sat, 4 Jul 2009 14:09:00 +0000 (UTC)</created>
    <updated>Sat, 4 Jul 2009 14:19:52 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12727241" author="bbrowning" created="Sat, 4 Jul 2009 14:11:09 +0000 (UTC)"  >First stab at setting up distributed erlang via ini files</comment>
                    <comment id="12727242" author="bbrowning" created="Sat, 4 Jul 2009 14:19:52 +0000 (UTC)"  >Related to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-381&quot; title=&quot;it would be nice to have an option in bin/couchdb to pass &amp;quot;-sname node_name&amp;quot; to erlang at startup&quot;&gt;&lt;strike&gt;COUCHDB-381&lt;/strike&gt;&lt;/a&gt; but they are also probably mutually exclusive.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12427501">COUCHDB-381</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12412535" name="couchdb_400.patch" size="1808" author="bbrowning" created="Sat, 4 Jul 2009 14:11:09 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-399] [PATCH] speed up toJSON()</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-399</link>

                    <description>This patch is a trivial optimisation of the toJSON() function in main.js&lt;br/&gt;
&lt;br/&gt;
It provides a surprising speedup. For example, in my real-world app, it reduces indexing time of ~3,800 docs from 80 seconds to 60 seconds. And using the benchmark script I posted to dev@, I see:&lt;br/&gt;
&lt;br/&gt;
2.877 -&amp;gt; 2.062 secs  (3000 docs, emit one k/v per doc)&lt;br/&gt;
13.522 -&amp;gt; 7.585 secs (3000 docs, emit 10 simple k/v per doc)&lt;br/&gt;
19.049 -&amp;gt; 12.714 secs (3000 docs, emit 10 compound k/v per doc)&lt;br/&gt;
</description>
                <environment>{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a787397&amp;quot;}&lt;br/&gt;
</environment>
            <key id="12429393">COUCHDB-399</key>
        <summary>[PATCH] speed up toJSON()</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Thu, 2 Jul 2009 14:33:34 +0000 (UTC)</created>
    <updated>Fri, 24 Jul 2009 16:08:02 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12735090" author="janl" created="Fri, 24 Jul 2009 16:08:02 +0000 (UTC)"  >applied in r797548</comment>
                </comments>
    
    <attachments>
            <attachment id="12412396" name="main.js.patch" size="2068" author="candlerb" created="Thu, 2 Jul 2009 14:34:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 24 Jul 2009 16:08:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 24 Jul 2009 16:08:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-398] test failure: &quot;should keep the same number of open databases when reaching the max_dbs_open limit&quot;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-398</link>

                    <description>This test fails because it makes an incorrect assumption about POST /_restart, namely that it restart the stats processes.  Linking to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-397&quot; title=&quot;POST _restart only restarts couch_server process&quot;&gt;COUCHDB-397&lt;/a&gt; for details.</description>
                <environment></environment>
            <key id="12429102">COUCHDB-398</key>
        <summary>test failure: &quot;should keep the same number of open databases when reaching the max_dbs_open limit&quot;</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 29 Jun 2009 15:51:21 +0000 (UTC)</created>
    <updated>Tue, 30 Jun 2009 17:04:06 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12725295" author="kocolosk" created="Mon, 29 Jun 2009 18:11:35 +0000 (UTC)"  >A quick-fix hack against the 0.9.x branch would be:&lt;br/&gt;
&lt;br/&gt;
Index: src/couchdb/couch_server_sup.erl&lt;br/&gt;
===================================================================&lt;br/&gt;
--- src/couchdb/couch_server_sup.erl	(revision 789389)&lt;br/&gt;
+++ src/couchdb/couch_server_sup.erl	(working copy)&lt;br/&gt;
@@ -32,6 +32,10 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end.&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;restart_core_server() -&amp;gt;&lt;br/&gt;
+    supervisor:terminate_child(couch_secondary_services, stats_collector),&lt;br/&gt;
+    supervisor:restart_child(couch_secondary_services, stats_collector),&lt;br/&gt;
+    supervisor:terminate_child(couch_secondary_services, stats_aggregator),&lt;br/&gt;
+    supervisor:restart_child(couch_secondary_services, stats_aggregator),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:terminate_child(couch_primary_services, couch_server),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:restart_child(couch_primary_services, couch_server).&lt;br/&gt;
&lt;br/&gt;
This ignores the whole question of how much of couchdb should be restarted by /_restart and just takes out the stats processes so that the counters get reset.&lt;br/&gt;
</comment>
                    <comment id="12725700" author="kocolosk" created="Tue, 30 Jun 2009 17:04:06 +0000 (UTC)"  >Fixed in 0.9.1 and trunk</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12429100">COUCHDB-397</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 30 Jun 2009 17:04:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-397] POST _restart only restarts couch_server process</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-397</link>

                    <description>Perhaps this is by design, but POSTing to /_restart only restarts the couch_server process.  It does not restart any of the other myriad processes CouchDB relies on for operation.  In particular, this causes the stats test suite to occasionally fail, because the stats counters do not get reset.  The test that fails is&lt;br/&gt;
&lt;br/&gt;
Assertion &apos;open_databases &amp;gt; 0 &amp;amp;&amp;amp; max &amp;gt;= open_databases, name&apos; failed: should keep the same number of open databases when reaching the max_dbs_open limit</description>
                <environment></environment>
            <key id="12429100">COUCHDB-397</key>
        <summary>POST _restart only restarts couch_server process</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 29 Jun 2009 15:44:52 +0000 (UTC)</created>
    <updated>Sat, 22 Aug 2009 15:26:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12725230" author="paul.joseph.davis" created="Mon, 29 Jun 2009 16:06:59 +0000 (UTC)"  >After a 5 minute run through, I don&apos;t see why couch_stats isn&apos;t being restarted but I don&apos;t have the best handle on the application:start/stop details. AFAIK, couch_stats should be listed under the secondary services since its listed as a daemon in the INI file, and the restart_core_server call looks like its trying to restart those.</comment>
                    <comment id="12725235" author="kocolosk" created="Mon, 29 Jun 2009 16:24:17 +0000 (UTC)"  >Hmm, the restart_core_server() I see in the 0.9.x branch is &lt;br/&gt;
&lt;br/&gt;
restart_core_server() -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:terminate_child(couch_primary_services, couch_server),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:restart_child(couch_primary_services, couch_server).&lt;br/&gt;
&lt;br/&gt;
That only restarts the couch_server process supervised by couch_primary_services.  On trunk I see&lt;br/&gt;
&lt;br/&gt;
restart_core_server() -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:terminate_child(couch_secondary_services, couch_server),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:terminate_child(couch_primary_services, couch_server),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:restart_child(couch_primary_services, couch_server),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:restart_child(couch_secondary_services, couch_server).&lt;br/&gt;
&lt;br/&gt;
which I don&apos;t understand (does couch_server now get supervised by couch_secondary_services on occasion?)  But it still is not restarting couch_stats_*</comment>
                    <comment id="12725281" author="paul.joseph.davis" created="Mon, 29 Jun 2009 17:55:57 +0000 (UTC)"  >Reading the docs on supervisor shutdown docs is a bit confusing on what&apos;s going on. I won&apos;t have time to dig too deeply into this until tonight, but the first thing that I&apos;d check is if some of those secondary services are ignoring signals from a parent in their handle_info callbacks?&lt;br/&gt;
</comment>
                    <comment id="12725289" author="kocolosk" created="Mon, 29 Jun 2009 18:02:10 +0000 (UTC)"  >Hi Paul, sorry if I&apos;m being unclear.  Nobody is telling the processes to terminate.  The daemons supervised by couch_secondary_services are not linked to couch_server.  When we tell couch_server to restart, it has absolutely no effect on the other daemons.</comment>
                    <comment id="12725296" author="paul.joseph.davis" created="Mon, 29 Jun 2009 18:14:50 +0000 (UTC)"  >As I understand the situation:&lt;br/&gt;
&lt;br/&gt;
couch_stats_* are daemons listed in the couch_secondary_services spec and started by couch_server_sup:start_secondary_services bit&lt;br/&gt;
0.9.1 doesn&apos;t restart secondary services&lt;br/&gt;
trunk has a call to terminate_child(couch_secondary_services, couch_server) but still doesn&apos;t appear to be restarting the stats processes.&lt;br/&gt;
&lt;br/&gt;
So I&apos;m running under the theory that terminate_child/restart_child is the proper way to do this reboot, but something is broken in the terminate_child call.&lt;br/&gt;
&lt;br/&gt;
That could all be wrong though. :)</comment>
                    <comment id="12725309" author="kocolosk" created="Mon, 29 Jun 2009 18:39:41 +0000 (UTC)"  >Ok, let&apos;s review:&lt;br/&gt;
&lt;br/&gt;
supervisor:terminate_child(couch_primary_services, couch_server)&lt;br/&gt;
&lt;br/&gt;
This call tells the supervisor process registered as couch_primary_services to terminate its child process with id couch_server.  The child specification for couch_server specifies a brutal_kill shutdown strategy.  This means that the couch_server process will not execute the code in its terminate function; it will just die.&lt;br/&gt;
&lt;br/&gt;
If couch_stats_* were linked to couch_server and were not trapping exits, this would probably be enough to reset the counters.  But that&apos;s not the case.&lt;br/&gt;
&lt;br/&gt;
A sneaky hack that you could use to bring down the entire server would be &lt;br/&gt;
&lt;br/&gt;
exit(whereis(couch_config), any_reason_you_feel_like).&lt;br/&gt;
&lt;br/&gt;
couch_server_sup has three children: couch_config, couch_primary_services, and couch_secondary_services.  If you kill one, the supervisor will bring them all down and restart them (this is the one_for_all supervision strategy).  couch_config doesn&apos;t trap exits, so it&apos;s an easy kill :-)&lt;br/&gt;
</comment>
                    <comment id="12725324" author="paul.joseph.davis" created="Mon, 29 Jun 2009 19:55:05 +0000 (UTC)"  >Now I&apos;m confused even more.&lt;br/&gt;
&lt;br/&gt;
I get the notion of how terminate_child is working in terms of the terminate/restart semantics but you&apos;re losing me with the discussion about linking the processes to get them to shutdown when couch_server goes down. Why would we consider that when we can instead restart the secondary services directly as trunk does currently and the patch you have on 398 does. Also, does the patch for 398 mean that that works? In your earlier comment you made it sound like that didn&apos;t work.&lt;br/&gt;
&lt;br/&gt;
Regardless, I definitely think you&apos;re right that we should sit down and discuss what exactly needs to get restarted on on a call to _restart. On the other hand, should _restart even be enabled by default? AFAIK it was just put in for testing, are there use cases for making it available?</comment>
                    <comment id="12725336" author="kocolosk" created="Mon, 29 Jun 2009 20:40:55 +0000 (UTC)"  >Hi Paul, I probably shouldn&apos;t have brought up the whole exit(couch_config, blah) thing.  Let&apos;s focus on the supervisor behavior.&lt;br/&gt;
&lt;br/&gt;
The trunk code *does not* restart any secondary services.  AFAICT these lines are a no-op:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:terminate_child(couch_secondary_services, couch_server), &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:restart_child(couch_secondary_services, couch_server). &lt;br/&gt;
&lt;br/&gt;
There is no child of couch_secondary_services named couch_server.  Damien should comment on the rationale.  Perhaps what was intended was&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:terminate_child(couch_server_sup, couch_secondary_services), &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor:restart_child(couch_server_sup, couch_secondary_services).&lt;br/&gt;
&lt;br/&gt;
That change would also fix &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-398&quot; title=&quot;test failure: &amp;quot;should keep the same number of open databases when reaching the max_dbs_open limit&amp;quot;&quot;&gt;&lt;strike&gt;COUCHDB-398&lt;/strike&gt;&lt;/a&gt; -- it just restarts a bit more of the application than what I posted.&lt;br/&gt;
&lt;br/&gt;
Not sure where I made a comment that indicated my diff in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-398&quot; title=&quot;test failure: &amp;quot;should keep the same number of open databases when reaching the max_dbs_open limit&amp;quot;&quot;&gt;&lt;strike&gt;COUCHDB-398&lt;/strike&gt;&lt;/a&gt; didn&apos;t work.  I&apos;ve checked -- it does reset the stats counters, and the test suite does pass.&lt;br/&gt;
&lt;br/&gt;
I think having a working _restart handler would actually be kinda useful, much like the _log handler Jan implemented a while back.&lt;br/&gt;
&lt;br/&gt;
I propose that /_restart should gracefully restart the entire couch application, not just the couch_server process.  Cheers, Adam&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12725375" author="paul.joseph.davis" created="Mon, 29 Jun 2009 22:21:18 +0000 (UTC)"  >Now we&apos;re on the same page. I didn&apos;t look nearly close enough at the patch for 398 to realize it was different than what&apos;s in trunk. I&apos;d vote for applying the proper terminate_child call you&apos;ve listed here instead of specifying the stats module as it&apos;s cleaner.&lt;br/&gt;
</comment>
                    <comment id="12725704" author="kocolosk" created="Tue, 30 Jun 2009 17:08:20 +0000 (UTC)"  >Hi Paul, I tried terminating all secondary services, but it ended up getting a bit complicated.  couch_httpd is one of those services, so we end up shutting down the connection that accepted the request.  I tried to work around this by spawning a fun to trigger the restart.  This allowed me to respond to the request to _restart, but the test suite still ran into problems because modern browsers will make multiple connections to the CouchDB server in order to run the tests.&lt;br/&gt;
&lt;br/&gt;
I think we can develop a graceful shutdown procedure that closes all connections appropriately and and restarts things, but in the interests of getting 0.9.1 out the door I just changed restart_core_server() to explicitly restart the stats processes.</comment>
                    <comment id="12725708" author="paul.joseph.davis" created="Tue, 30 Jun 2009 17:14:55 +0000 (UTC)"  >Sounds like the best solution to me. </comment>
                    <comment id="12746471" author="nslater" created="Sat, 22 Aug 2009 15:26:46 +0000 (UTC)"  >How can we make the init script hook into this too?&lt;br/&gt;
&lt;br/&gt;
I would like to be able to do:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;/etc/init.d/couchdb reload&lt;br/&gt;
&lt;br/&gt;
And have CouchDB reload its configuration files, without cold restarting the server.&lt;br/&gt;
&lt;br/&gt;
I can make this do anything, I just need instruction from you Erlang guys about the correct command to call.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12429102">COUCHDB-398</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 16:06:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-396] Fixing weirdness in couch_stats_aggregator.erl</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-396</link>

                    <description>Looking at adding unit tests to the couchdb_stats_aggregator module the other day I realized it was doing some odd calculations. This is a fairly non-trivial patch so I figured that I&apos;d put in JIRA and get feed back before applying. This patch does everything the old version does afaict, but I&apos;ll be adding tests before I consider it complete.&lt;br/&gt;
&lt;br/&gt;
List of major changes:&lt;br/&gt;
&lt;br/&gt;
* The old behavior for stats was to integrate incoming values for a time period and then reset the values and start integrating again. That seemed a bit odd so I rewrote things to keep the average and standard deviation for the last N seconds with approximately 1 sample per second.&lt;br/&gt;
* Changed request timing calculations [note below]&lt;br/&gt;
* Sample periods are configurable in the .ini file. Sample periods of 0 are a special case and integrate all values from couchdb boot up.&lt;br/&gt;
* Sample descriptions are in the configuration files now.&lt;br/&gt;
* You can request different time periods for the root stats end point.&lt;br/&gt;
* Added a sum to the list of statistics&lt;br/&gt;
* Simplified some of the external API&lt;br/&gt;
&lt;br/&gt;
The biggest change is in how time for requests are calculated. AFAICT, the old way was accumulating request timings in the stats collector and just adding new values as clock ticks went by as everything else does which makes sense in the case of resetting counters every time period. In the new way I&apos;m keeping a list of the samples in the last time period and when I get a clock tick part of the update is to remove the samples that have passed out of the time period. For a variable like request_time this would lead to unbounded storage.&lt;br/&gt;
&lt;br/&gt;
The new method is calculating the average time of all requests in a single clock tick (1s). One thing this loses is when you start having lots of variability in a single clock tick. Ie, your average request time is 100ms, but 10% of your requests are taking 500ms. I&apos;ve read of people doing the averaging trick but also storing quantile information as well [1]. There are also algorithms for doing single pass quantile estimation and the like so its possible to do those things in O(N) time. The issue with quantiles is that it&apos;d start breaking the logic of how the collector and aggregators are setup. As it is now, there&apos;s basically a one event -&amp;gt; one stat constraint. For the time being I went without quartiles to minimize the impact of the patch.&lt;br/&gt;
&lt;br/&gt;
This code will also be on github [3] as I add patches.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://code.flickr.com/blog/2008/10/27/counting-timing/&quot;&gt;http://code.flickr.com/blog/2008/10/27/counting-timing/&lt;/a&gt;&lt;br/&gt;
[2] &lt;a href=&quot;http://www.slamb.org/svn/repos/trunk/projects/loadtest/benchtools/stats.py&quot;&gt;http://www.slamb.org/svn/repos/trunk/projects/loadtest/benchtools/stats.py&lt;/a&gt; (See the QuantileEstimator class)&lt;br/&gt;
[3] &lt;a href=&quot;http://github.com/davisp/couchdb/tree/stats-patch&quot;&gt;http://github.com/davisp/couchdb/tree/stats-patch&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>trunk</environment>
            <key id="12429038">COUCHDB-396</key>
        <summary>Fixing weirdness in couch_stats_aggregator.erl</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sun, 28 Jun 2009 01:30:53 +0000 (UTC)</created>
    <updated>Thu, 17 Sep 2009 04:13:10 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12727226" author="janl" created="Sat, 4 Jul 2009 12:11:56 +0000 (UTC)"  >The patch looks good. It basically addresses all the points I had noted down for &amp;quot;solving later&amp;quot;. With unit tests, I&apos;d be confident to put this into trunk. It&apos;d be interesting if we see any variation performance with this.</comment>
                    <comment id="12733595" author="paul.joseph.davis" created="Tue, 21 Jul 2009 11:25:14 +0000 (UTC)"  >Jan says: &lt;br/&gt;
&lt;br/&gt;
I&apos;d opt for a ./configure option --disable-stats and -ifdef() based conditional&lt;br/&gt;
code.&lt;br/&gt;
&lt;br/&gt;
Cheers&lt;br/&gt;
Jan&lt;br/&gt;
&lt;br/&gt;
Which sounds like the best build solution. Is there anything that&apos;d bite me in the ass with an implicit dependency? Testing for stats state in the tests already sounds fun.</comment>
                    <comment id="12743941" author="paul.joseph.davis" created="Mon, 17 Aug 2009 00:55:39 +0000 (UTC)"  >Updated the patch with more testing goodness. Includes new etap tests as well as updated the JS tests. This is a bit on the large side, anyone want to run their eyes over it before I commit?</comment>
                    <comment id="12744154" author="dionne" created="Mon, 17 Aug 2009 18:16:13 +0000 (UTC)"  >we tested using conditional compilation to disable stats collection. It made no measurable difference in either the Futon test suite or any local load tests. Just updating ets tables appears to be quite cheap.</comment>
                    <comment id="12756359" author="paul.joseph.davis" created="Thu, 17 Sep 2009 04:13:10 +0000 (UTC)"  >Fixed as of r816043.&lt;br/&gt;
&lt;br/&gt;
No backport on this one because it&apos;s a behavior change.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416733" name="couch_stats.patch" size="71231" author="paul.joseph.davis" created="Mon, 17 Aug 2009 00:55:39 +0000 (UTC)" />
            <attachment id="12412004" name="couchdb_stats_aggregator.patch" size="28356" author="paul.joseph.davis" created="Sun, 28 Jun 2009 01:31:39 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 17 Sep 2009 04:13:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 4 Jul 2009 12:11:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-395] Erlang system and process info administration handlers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-395</link>

                    <description>Some handlers for obtaining the system and process infos.</description>
                <environment>Mac OS X, Erlang 5.6.5</environment>
            <key id="12428956">COUCHDB-395</key>
        <summary>Erlang system and process info administration handlers</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="michalptaszek">Michal Ptaszek</reporter>
            
    <created>Fri, 26 Jun 2009 13:40:19 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:58 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="1800">0.5h</timeoriginalestimate>        <timeestimate seconds="1800">0.5h</timeestimate>                    

            <comments>
                    <comment id="12724532" author="michalptaszek" created="Fri, 26 Jun 2009 13:41:26 +0000 (UTC)"  >The patch that resolves the issue</comment>
                    <comment id="12738006" author="paul.joseph.davis" created="Sun, 2 Aug 2009 07:25:39 +0000 (UTC)"  >Michal,&lt;br/&gt;
&lt;br/&gt;
Just noticed this patch, was there a specific reason you wanted to be able to get information the the Erlang processes running in the VM. Depending on load the processes could be extremely transient so I&apos;m not sure why you&apos;d want the Erlang info associated with each one. If it&apos;s a stat that you&apos;re wanting then adding something to the stats module would probably be the best approach.&lt;br/&gt;
</comment>
                    <comment id="12738214" author="michalptaszek" created="Mon, 3 Aug 2009 07:21:17 +0000 (UTC)"  >Hi Paul,&lt;br/&gt;
&lt;br/&gt;
Well, that simple patch has been implemented&lt;br/&gt;
during the CouchDB course in London: one of &lt;br/&gt;
the trainers (I do not exactly remember which of&lt;br/&gt;
them: Jan or Chris) were interested in tracing &lt;br/&gt;
the VM state via JSON API. &lt;br/&gt;
&lt;br/&gt;
I do realize about the drawbacks of the solution:&lt;br/&gt;
it is just a very basic proposal. Feel free to&lt;br/&gt;
edit/remove it.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Cheers,&lt;br/&gt;
-- &lt;br/&gt;
Michal Ptaszek&lt;br/&gt;
&lt;a href=&quot;http://www.erlang-consulting.com&quot;&gt;www.erlang-consulting.com&lt;/a&gt;&lt;br/&gt;
</comment>
                    <comment id="12772671" author="kocolosk" created="Mon, 2 Nov 2009 20:39:58 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
            <attachment id="12411922" name="system_info.patch" size="3708" author="michalptaszek" created="Fri, 26 Jun 2009 13:41:26 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Aug 2009 07:25:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-394] Intermittent HTTP 500 errors on queries, no useful diagnostics</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-394</link>

                    <description>Originally raised on &lt;a href=&apos;mailto:user@couchdb.apache.org&apos;&gt;user@couchdb.apache.org&lt;/a&gt; on 2009-06-16, but no resolution.  Original message follows later.&lt;br/&gt;
&lt;br/&gt;
Analysis: seems like there is a failure during the call to gen_tcp:send, a connection dropped or something like that, however the calling code in mochiweb_request:send appears to discard the reason returned by gen_tcp:send leaving a user with no clue of the underlying problem.&lt;br/&gt;
&lt;br/&gt;
Here is Mochiweb_request:send&lt;br/&gt;
&lt;br/&gt;
send(Data) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case gen_tcp:send(Socket, Data) of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_ -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit(normal)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
In the case of a non ok return from gen_tcp:send, exit(normal) is called which is connected with the log file in the original message.  It would seem much more helpful if the recent included in the return value from gen_tcp:send was passed to the exit/1 function.&lt;br/&gt;
&lt;br/&gt;
Actually, a different function appears in the original log file.  I was looking at a slightly different entry in a different log file, but I think the analysis holds.&lt;br/&gt;
&lt;br/&gt;
Different log snippet:&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [info] [&amp;lt;0.3318.13&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /default/_design/query/_view/byURI?include_docs=true;key=... 200&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3318.13&amp;gt;] &apos;GET&apos; /default/_design/query/_view/byURI?include_docs=true;key=.. {1,&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1}&lt;br/&gt;
&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2&amp;quot;},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;keep-alive&amp;quot;},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Java/1.6.0_0&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3318.13&amp;gt;] request_group {Pid, Seq} {&amp;lt;0.3872.0&amp;gt;,1890}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3318.13&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;...&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [error] [&amp;lt;0.3318.13&amp;gt;] Uncaught error in HTTP request: {exit,normal}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3318.13&amp;gt;] Stacktrace: [{mochiweb_request,send,2},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,send_chunk,2},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_view,design_doc_view,5},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3332.13&amp;gt;] &apos;GET&apos; /default/_design/query/_view/forSubject?include_docs=true;key=[] {1,&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1}&lt;br/&gt;
&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2&amp;quot;},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;keep-alive&amp;quot;},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Java/1.6.0_0&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3318.13&amp;gt;] httpd 500 error response:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;normal&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3332.13&amp;gt;] request_group {Pid, Seq} {&amp;lt;0.3872.0&amp;gt;,1890}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3332.13&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;...&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Wed, 27 May 2009 00:39:00 GMT] [debug] [&amp;lt;0.3332.13&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;...&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
------&lt;br/&gt;
&lt;br/&gt;
Original message:&lt;br/&gt;
&lt;br/&gt;
I&apos;ve been seeing HTTP 500 failures from time to time with a fairly  &lt;br/&gt;
recent snapshot build (&amp;quot;0.10.0a777361&amp;quot;) from the SVN.  The actual keys  &lt;br/&gt;
have been omitted, however the queries have been working for a long  &lt;br/&gt;
time and the keys are valid and return the right data most of the time.&lt;br/&gt;
&lt;br/&gt;
Any clues what might be happening?&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:22:59 GMT] [debug] [&amp;lt;0.1178.84&amp;gt;] &apos;POST&apos; /loaded/ &lt;br/&gt;
_design/query/_view/byURI?include_docs=true {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Language&apos;,&amp;quot;en-us&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cache-Control&apos;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;Keep-Alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;537&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;text/plain; charset=utf-8&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cookie&apos;,&amp;quot;x-auto-16=m%3Asize%7Cf%3A235.0&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Referer&apos;,&amp;quot;&lt;a href=&quot;http://localhost:8888/browser/hosted.html?&quot;&gt;http://localhost:8888/browser/hosted.html?&lt;/a&gt; &lt;br/&gt;
browser&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT  &lt;br/&gt;
5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR  &lt;br/&gt;
3.5.30729; .NET CLR 1.1.4322)&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:22:59 GMT] [debug] [&amp;lt;0.1180.84&amp;gt;] &apos;GET&apos; /loaded/ &lt;br/&gt;
_design/query/_view/forSubject?include_docs=true;;key=[omitted] {1,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1 &lt;br/&gt;
}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Language&apos;,&amp;quot;en-us&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cache-Control&apos;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;Keep-Alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cookie&apos;,&amp;quot;x-auto-16=m%3Asize%7Cf%3A235.0&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Referer&apos;,&amp;quot;&lt;a href=&quot;http://localhost:8888/browser/hosted.html?&quot;&gt;http://localhost:8888/browser/hosted.html?&lt;/a&gt; &lt;br/&gt;
browser&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT  &lt;br/&gt;
5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR  &lt;br/&gt;
3.5.30729; .NET CLR 1.1.4322)&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:22:59 GMT] [debug] [&amp;lt;0.1180.84&amp;gt;] request_group  &lt;br/&gt;
{Pid, Seq} {&amp;lt;0.15823.64&amp;gt;,4485}&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:22:59 GMT] [info] [&amp;lt;0.1180.84&amp;gt;] 127.0.0.1 - -  &lt;br/&gt;
&apos;GET&apos; /loaded/_design/query/_view/forSubject? &lt;br/&gt;
include_docs=true;;key=[omitted] 200&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:22:59 GMT] [debug] [&amp;lt;0.1180.84&amp;gt;] &apos;GET&apos; /loaded/ &lt;br/&gt;
_design/query/_view/byURI?include_docs=true;key=[omitted] {1,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1 &lt;br/&gt;
}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Language&apos;,&amp;quot;en-us&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cache-Control&apos;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;Keep-Alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cookie&apos;,&amp;quot;x-auto-16=m%3Asize%7Cf%3A235.0&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;If-None-Match&apos;,&amp;quot;\&amp;quot;60FWBA3D7UUZI9NSMR4PS9VM4\&amp;quot;&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Referer&apos;,&amp;quot;&lt;a href=&quot;http://localhost:8888/browser/hosted.html?&quot;&gt;http://localhost:8888/browser/hosted.html?&lt;/a&gt; &lt;br/&gt;
browser&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT  &lt;br/&gt;
5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR  &lt;br/&gt;
3.5.30729; .NET CLR 1.1.4322)&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:22:59 GMT] [debug] [&amp;lt;0.1180.84&amp;gt;] request_group  &lt;br/&gt;
{Pid, Seq} {&amp;lt;0.15823.64&amp;gt;,4485}&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:22:59 GMT] [info] [&amp;lt;0.1180.84&amp;gt;] 127.0.0.1 - -  &lt;br/&gt;
&apos;GET&apos; /loaded/_design/query/_view/byURI? &lt;br/&gt;
include_docs=true;key=[omitted] 304&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:23:09 GMT] [error] [&amp;lt;0.1178.84&amp;gt;] Uncaught error  &lt;br/&gt;
in HTTP request: {exit,normal}&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:23:09 GMT] [debug] [&amp;lt;0.1178.84&amp;gt;] Stacktrace:  &lt;br/&gt;
[{mochiweb_request,recv,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request,stream_unchunked_body,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request,recv_body,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,json_body,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,json_body_obj,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_view,handle_view_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5}]&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:23:09 GMT] [debug] [&amp;lt;0.1178.84&amp;gt;] httpd 500 error  &lt;br/&gt;
response:&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;normal&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:23:09 GMT] [info] [&amp;lt;0.1178.84&amp;gt;] 127.0.0.1 - -  &lt;br/&gt;
&apos;POST&apos; /loaded/_design/query/_view/byURI?include_docs=true 500&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:23:20 GMT] [debug] [&amp;lt;0.1180.84&amp;gt;] &apos;GET&apos; /loaded/ &lt;br/&gt;
_design/query/_view/forValue?key=[omitted] {1,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1 &lt;br/&gt;
}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Language&apos;,&amp;quot;en-us&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;Keep-Alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;text/plain; charset=utf-8&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cookie&apos;,&amp;quot;x-auto-16=m%3Asize%7Cf%3A235.0&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;If-None-Match&apos;,&amp;quot;\&amp;quot;60FWBA3D7UUZI9NSMR4PS9VM4\&amp;quot;&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Referer&apos;,&amp;quot;&lt;a href=&quot;http://localhost:8888/browser/hosted.html?&quot;&gt;http://localhost:8888/browser/hosted.html?&lt;/a&gt; &lt;br/&gt;
browser&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT  &lt;br/&gt;
5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR  &lt;br/&gt;
3.5.30729; .NET CLR 1.1.4322)&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Thu, 18 Jun 2009 01:23:20 GMT] [debug] [&amp;lt;0.1180.84&amp;gt;] request_group  &lt;br/&gt;
{Pid, Seq} {&amp;lt;0.15823.64&amp;gt;,4485}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Ubuntu 8.10 on x386 on Amazon Web Services VM</environment>
            <key id="12428830">COUCHDB-394</key>
        <summary>Intermittent HTTP 500 errors on queries, no useful diagnostics</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="carnold@apache.org">Curt Arnold</reporter>
            
    <created>Thu, 25 Jun 2009 05:32:30 +0000 (UTC)</created>
    <updated>Mon, 12 Oct 2009 00:07:13 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12735695" author="carnold@apache.org" created="Mon, 27 Jul 2009 18:18:24 +0000 (UTC)"  >I cloned my application and made the following modification to hopefully provide more diagnostics of the underlying problem.&lt;br/&gt;
&lt;br/&gt;
===================================================================&lt;br/&gt;
--- src/mochiweb/mochiweb_request.erl   (revision 798196)&lt;br/&gt;
+++ src/mochiweb/mochiweb_request.erl   (working copy)&lt;br/&gt;
@@ -121,6 +121,8 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case gen_tcp:send(Socket, Data) of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok;&lt;br/&gt;
+        { error, Reason } -&amp;gt;&lt;br/&gt;
+            exit(Reason);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_ -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit(normal)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end.&lt;br/&gt;
&lt;br/&gt;
Was finally able to trigger the error and had the following in the log:&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] &apos;POST&apos; /loaded/_design/query/_view/byURI?include_docs=true {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cache-Control&apos;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;keep-alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;1373&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Pragma&apos;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Java/1.6.0_0&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] request_group {Pid, Seq} {&amp;lt;0.119.0&amp;gt;,4709}&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O284&quot;&gt;http://www.example.com/2009/03/schema#O284&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O209&quot;&gt;http://www.example.com/2009/03/schema#O209&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;d6490a8694d19768347dab5c62969b33&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O182&quot;&gt;http://www.example.com/2009/03/schema#O182&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O187&quot;&gt;http://www.example.com/2009/03/schema#O187&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O229&quot;&gt;http://www.example.com/2009/03/schema#O229&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O20&quot;&gt;http://www.example.com/2009/03/schema#O20&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O248&quot;&gt;http://www.example.com/2009/03/schema#O248&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O225&quot;&gt;http://www.example.com/2009/03/schema#O225&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O2&quot;&gt;http://www.example.com/2009/03/schema#O2&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O204&quot;&gt;http://www.example.com/2009/03/schema#O204&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O201&quot;&gt;http://www.example.com/2009/03/schema#O201&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O133&quot;&gt;http://www.example.com/2009/03/schema#O133&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O32&quot;&gt;http://www.example.com/2009/03/schema#O32&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O12&quot;&gt;http://www.example.com/2009/03/schema#O12&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O251&quot;&gt;http://www.example.com/2009/03/schema#O251&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O192&quot;&gt;http://www.example.com/2009/03/schema#O192&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O174&quot;&gt;http://www.example.com/2009/03/schema#O174&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O290&quot;&gt;http://www.example.com/2009/03/schema#O290&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O238&quot;&gt;http://www.example.com/2009/03/schema#O238&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O197&quot;&gt;http://www.example.com/2009/03/schema#O197&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#acme&quot;&gt;http://www.example.com/2009/03/schema#acme&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O232&quot;&gt;http://www.example.com/2009/03/schema#O232&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O74&quot;&gt;http://www.example.com/2009/03/schema#O74&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Include Doc: &amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O114&quot;&gt;http://www.example.com/2009/03/schema#O114&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt; nil&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [error] [&amp;lt;0.1162.0&amp;gt;] Uncaught error in HTTP request: {exit,closed}&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] Stacktrace: [{mochiweb_request,send,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,send_chunk,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_view,design_doc_view,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [debug] [&amp;lt;0.1162.0&amp;gt;] httpd 500 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;closed&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [error] [&amp;lt;0.1162.0&amp;gt;] {error_report,&amp;lt;0.21.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.1162.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.1162.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,enotconn,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request,send,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request,start_raw_response,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request,respond,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,send_response,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,acceptor_loop,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&amp;lt;0.54.0&amp;gt;,#Port&amp;lt;0.148&amp;gt;,#Fun&amp;lt;mochiweb_http.1.81679042&amp;gt;}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_httpd,couch_secondary_services,couch_server_sup,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[#Port&amp;lt;0.309&amp;gt;,&amp;lt;0.54.0&amp;gt;,#Port&amp;lt;0.308&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request_body,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;keys\&amp;quot;:[\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O284&quot;&gt;http://www.example.com/2009/03/schema#O284&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O209&quot;&gt;http://www.example.com/2009/03/schema#O209&lt;/a&gt;\&amp;quot;,\&amp;quot;urn:uuid:d6490a86-94d1-9768-347d-ab5c62969b33\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O182&quot;&gt;http://www.example.com/2009/03/schema#O182&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O187&quot;&gt;http://www.example.com/2009/03/schema#O187&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O229&quot;&gt;http://www.example.com/2009/03/schema#O229&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O20&quot;&gt;http://www.example.com/2009/03/schema#O20&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O248&quot;&gt;http://www.example.com/2009/03/schema#O248&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O225&quot;&gt;http://www.example.com/2009/03/schema#O225&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O2&quot;&gt;http://www.example.com/2009/03/schema#O2&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O204&quot;&gt;http://www.example.com/2009/03/schema#O204&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O201&quot;&gt;http://www.example.com/2009/03/schema#O201&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O133&quot;&gt;http://www.example.com/2009/03/schema#O133&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O32&quot;&gt;http://www.example.com/2009/03/schema#O32&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O12&quot;&gt;http://www.example.com/2009/03/schema#O12&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O251&quot;&gt;http://www.example.com/2009/03/schema#O251&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O192&quot;&gt;http://www.example.com/2009/03/schema#O192&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O174&quot;&gt;http://www.example.com/2009/03/schema#O174&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O290&quot;&gt;http://www.example.com/2009/03/schema#O290&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O238&quot;&gt;http://www.example.com/2009/03/schema#O238&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O197&quot;&gt;http://www.example.com/2009/03/schema#O197&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#acme&quot;&gt;http://www.example.com/2009/03/schema#acme&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O232&quot;&gt;http://www.example.com/2009/03/schema#O232&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O74&quot;&gt;http://www.example.com/2009/03/schema#O74&lt;/a&gt;\&amp;quot;,\&amp;quot;&lt;a href=&quot;http://www.example.com/2009/03/schema#O114&quot;&gt;http://www.example.com/2009/03/schema#O114&lt;/a&gt;\&amp;quot;]}&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request_qs,[{&amp;quot;include_docs&amp;quot;,&amp;quot;true&amp;quot;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request_recv,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{jsonp,undefined},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_drv_port,#Port&amp;lt;0.309&amp;gt;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,2584},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,87159}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 27 Jul 2009 16:45:55 GMT] [error] [&amp;lt;0.54.0&amp;gt;] {error_report,&amp;lt;0.21.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.54.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,235,{child_error,enotconn}}}}&lt;br/&gt;
&lt;br/&gt;
The corresponding code on the client side is:&lt;br/&gt;
&lt;br/&gt;
	new JSONObject(new JSONTokener(new BufferedReader(new InputStreamReader(connection.getInputStream(), &amp;quot;utf-8&amp;quot;))));&lt;br/&gt;
&lt;br/&gt;
In this particular failure, both the client and CouchDB are on the same machine, so it is unlikely a problem with a network intermediary.  The list of fetched documents matches the expected response to the query (in this particular instance, document IDs have a one-to-one correspondency with keys, though that is not generally the case).   Since all the documents were fetched and the time between request and failure was less than a second, a timeout seems unlikely.&lt;br/&gt;
&lt;br/&gt;
If there was a problem with the decoding or parsing, it might have prematurely closed the socket, resulting in the error.&lt;br/&gt;
&lt;br/&gt;
Any thoughts?&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12764524" author="mhammond" created="Mon, 12 Oct 2009 00:07:13 +0000 (UTC)"  >&lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-452&quot; title=&quot;couch logs an [error] record if a client disconnects&quot;&gt;&lt;strike&gt;COUCHDB-452&lt;/strike&gt;&lt;/a&gt; is now closed as the trunk ignores this &apos;normal exit&apos; case.  However, this bug goes a little further than 452 - it has identified a potential enhancement to mochiweb to propagate the error reason so it could be logged or special cased in other ways - therefore I&apos;m leaving this open for now...</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                                        <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12432232">COUCHDB-452</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 12 Oct 2009 00:07:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-393] Cannot discover currently running http port if ini file specifies port 0</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-393</link>

                    <description>It is currently not possible, if the ini file specifies port 0 as the http port (so that the OS chooses a random port) to discover which port the OS actually chose.&lt;br/&gt;
&lt;br/&gt;
It would be nice if the currently running port was made available in the statusline output (couchdb -s), but a log statement would be adequate; some way that an external script can discover which port a running CouchDB is listening on.&lt;br/&gt;
&lt;br/&gt;
Edited discussion from #couchdb:&lt;br/&gt;
&lt;br/&gt;
&amp;lt;bitdiddle&amp;gt; aquarius: well at a glance it appears couch_http passes the 0 to mochiweb_http which passes it to the mochiweb_socket_server, which passes it to gen_tcp, an erlang module that lets the underlying OS assign it. mochiweb_socket_server then grabs that port and stores it. It has a get method to retrieve properties but that needs to be exposed to mochiweb_http so it would take a little work to do it. It&apos;s probably a JIRA ticket, unless someone else sees a quicker approach&lt;br/&gt;
&amp;lt;davisp&amp;gt; bitdiddle: you got that far and didn&apos;t find it?&lt;br/&gt;
&amp;lt;aquarius&amp;gt; davisp: is there a better way to find the port?&lt;br/&gt;
&amp;lt;davisp&amp;gt; oh, is that not the bind port?&lt;br/&gt;
&amp;nbsp;I was just thinking a log statement&lt;br/&gt;
&amp;lt;aquarius&amp;gt; davisp: the problem is if you specify 0 as the bind port (so the OS chooses a port), how do you find out what was chosen?&lt;br/&gt;
&amp;lt;davisp&amp;gt; aquarius: you have to look at the port returned by the socket&lt;br/&gt;
&amp;nbsp;aquarius: in other words, CouchDB was never written to do that&lt;br/&gt;
&amp;lt;davisp&amp;gt; AFAIK&lt;br/&gt;
&amp;lt;bitdiddle&amp;gt; davisp: I found it, just needs some work to expose it&lt;br/&gt;
&amp;lt;davisp&amp;gt; aquarius: and by do that, I mean, we never put in a statement to log that&lt;br/&gt;
&amp;lt;bitdiddle&amp;gt; mochiweb_http is the module that needs to bubble it up&lt;br/&gt;
&amp;lt;aquarius&amp;gt; davisp: I don&apos;t really mind whether it&apos;s a log statement or it&apos;s exposed to couchdb -s (the latter seems tidier to me, but whichever), I just want to be able to start couch on port 0 and then later find out which port got chosen :)&lt;br/&gt;
&amp;lt;davisp&amp;gt; aquarius: for the time being you can use something like netstat or lsof, but we&apos;ll get a log statement in there or something&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Ubuntu 9.04</environment>
            <key id="12428664">COUCHDB-393</key>
        <summary>Cannot discover currently running http port if ini file specifies port 0</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="aquarius">Stuart Langridge</reporter>
            
    <created>Tue, 23 Jun 2009 13:29:21 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:43:13 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.12</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12723097" author="aquarius" created="Tue, 23 Jun 2009 14:48:13 +0000 (UTC)"  >Tiny patch to write out to the logfile:&lt;br/&gt;
&lt;br/&gt;
Index: mochiweb_socket_server.erl&lt;br/&gt;
===================================================================&lt;br/&gt;
--- mochiweb_socket_server.erl	(revision 787671)&lt;br/&gt;
+++ mochiweb_socket_server.erl	(working copy)&lt;br/&gt;
@@ -150,6 +150,7 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case gen_tcp:listen(Port, Opts) of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, Listen} -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, ListenPort} = inet:port(Listen),&lt;br/&gt;
+            io:format(&amp;quot;Now listening on port ~w.~n&amp;quot;, [ListenPort]),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, new_acceptor(State#mochiweb_socket_server{listen=Listen, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;port=ListenPort})};&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error, Reason} -&amp;gt;&lt;br/&gt;
</comment>
                    <comment id="12723103" author="paul.joseph.davis" created="Tue, 23 Jun 2009 15:06:28 +0000 (UTC)"  >As was pointed out, reading the port from a log file is probably not the best solution. The other alternative would be to make it available with something like `couchdb -s` which would require some other voodoo magic. Another alternative would be to update the couchdb -s command to actually be a couchdbctl command that uses Erlang RPC similar to how rabbitmqctl works. The setup isn&apos;t without problems though as it requires coordination of erlang cookies and other bits.&lt;br/&gt;
&lt;br/&gt;
Any one else have thoughts on how to accomplish this better than the log style?</comment>
                    <comment id="12723108" author="antonyblakey" created="Tue, 23 Jun 2009 15:30:27 +0000 (UTC)"  >Why not use the same mechanism as the pid file e.g. a command line option specifying a file to write the port number to.</comment>
                    <comment id="12723185" author="nslater" created="Tue, 23 Jun 2009 16:57:59 +0000 (UTC)"  >I think Paul Davis hit on the best option here. It would be nice to hook &amp;quot;couchdb -s&amp;quot; into some kind of Erlang VM communication, and we could return the IP address and port number on the command line in some parseable fashion. Perhaps something similar to &amp;quot;Visit the Futon administration console at &lt;a href=&quot;http://0.0.0.0:0/_utils/&quot;&gt;http://0.0.0.0:0/_utils/&lt;/a&gt;&amp;quot; like we used to show on CouchDB start-up.</comment>
                    <comment id="12727245" author="bbrowning" created="Sat, 4 Jul 2009 14:45:07 +0000 (UTC)"  >If we go the route of Erlang VM communication, here&apos;s the RPC call to retrieve the mochiweb port of a CouchDB node running in a different VM:&lt;br/&gt;
&lt;br/&gt;
rpc:call(&lt;a href=&apos;mailto:couch@hostname&apos;&gt;couch@hostname&lt;/a&gt;, mochiweb_socket_server, get, [couch_httpd, port]).&lt;br/&gt;
&lt;br/&gt;
For this to work you have to make sure CouchDB is running distributed - &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-400&quot; title=&quot;Allow Distributed Erlang Short/Long Name and Cookie to be Specified in Configuration Files&quot;&gt;COUCHDB-400&lt;/a&gt; has a patch to make this happen.</comment>
                    <comment id="12730028" author="paul.joseph.davis" created="Sun, 12 Jul 2009 00:03:19 +0000 (UTC)"  >This patch is a completely working implementation of grabbing the port using RPC. It adds an installed &apos;couchctl&apos; command that you can use to print the port. Currently, this is the only functionality supported but if there&apos;s other stuff needed then that can be added easily.&lt;br/&gt;
&lt;br/&gt;
Of note is that this patch now gives couchdb a default node name of &apos;&lt;a href=&apos;mailto:couch@host&apos;&gt;couch@host&lt;/a&gt;&apos; so that it can be pinged by the RPC call. As such I included the patch on &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-381&quot; title=&quot;it would be nice to have an option in bin/couchdb to pass &amp;quot;-sname node_name&amp;quot; to erlang at startup&quot;&gt;&lt;strike&gt;COUCHDB-381&lt;/strike&gt;&lt;/a&gt; so that the node name can be set to something else. couchctl requires knowing the node name to ping.&lt;br/&gt;
&lt;br/&gt;
This patch adds some bits to the build system so I&apos;m adding it and assigning to Noah to get his opinion before committing.</comment>
                    <comment id="12730029" author="paul.joseph.davis" created="Sun, 12 Jul 2009 00:04:00 +0000 (UTC)"  >JIRA sure does make me want to break things.</comment>
                    <comment id="12730155" author="nslater" created="Sun, 12 Jul 2009 22:22:33 +0000 (UTC)"  >+  -n          set the CouchDB server node name&lt;br/&gt;
+  -p          display the CouchDB server socket port&lt;br/&gt;
&lt;br/&gt;
These options should be rolled into the `couchdb` command, like the existing `-s` flag.&lt;br/&gt;
&lt;br/&gt;
+  -S SNAME    pass the node name into erlang shell&lt;br/&gt;
&lt;br/&gt;
Use the ERL_FLAGS environment variable, and remove this option.&lt;br/&gt;
</comment>
                    <comment id="12730159" author="paul.joseph.davis" created="Sun, 12 Jul 2009 22:56:39 +0000 (UTC)"  >The way I implemented this uses Erlang&apos;s RPC calls to query the value of a running CouchDB node. To simply switch the -p flag back to couchdb would probably require dropping the entire implementation and going with writing a file after the server socket is opened etc etc. Going to a file based system would also mean that it wouldn&apos;t make any sense to keep around the -n flag.&lt;br/&gt;
&lt;br/&gt;
So basically, if you think we should do file writing then that&apos;s cool, but if we want the RPC style so that we can add different types of introspection for sysadmins then the current system would probably be more future proof.&lt;br/&gt;
&lt;br/&gt;
For reference, I was pulling this pattern from rabbitmq&apos;s rabbitmqctl command that does similar things.</comment>
                    <comment id="12730161" author="nslater" created="Sun, 12 Jul 2009 23:05:40 +0000 (UTC)"  >I&apos;m slightly drunk, so may not be explaining things properly. Imagining the implementation behind `-p` and `-n` as a black-box, I think you should simply expose this functionality via the regular `couchdb` script, instead of having a new command. The current `couchdb` command has a `-s` option, which is analogous as far as the user is concerned. So, to reiterate, keep the implementation the same, but toss out the new shell script, and wrap up the functionality into the existing `couchdb` command. And thanks, for dealing with my comments so patiently. Heh.</comment>
                    <comment id="12730163" author="paul.joseph.davis" created="Sun, 12 Jul 2009 23:09:06 +0000 (UTC)"  >That can be done, though if we stick with using RPC calls then we have to have a -S option to set the node name as appropriate. Let me rework the patch tonight and see what I can come up with.</comment>
                    <comment id="12739050" author="janl" created="Tue, 4 Aug 2009 17:27:13 +0000 (UTC)"  >As of r800884 CouchDB reports bind address and port to the log file using the info level.</comment>
                    <comment id="12742154" author="janl" created="Wed, 12 Aug 2009 00:51:41 +0000 (UTC)"  >bump to 0.11.</comment>
                    <comment id="12828281" author="janl" created="Mon, 1 Feb 2010 21:43:13 +0000 (UTC)"  >bump to 0.12</comment>
                </comments>
    
    <attachments>
            <attachment id="12413216" name="couchctl.patch" size="12278" author="paul.joseph.davis" created="Sun, 12 Jul 2009 00:03:19 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 23 Jun 2009 15:06:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-392] list and show responses should send utf-8 by default</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-392</link>

                    <description>we get this wrong currently, making unicode characters display as gibberish by default in most browsers. It&apos;s as simple as making the response headers include:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Content-type&amp;quot;:&amp;quot;text/html; charset=utf-8&amp;quot;&lt;br/&gt;
&lt;br/&gt;
so that the browser understands what we&apos;re sending. We always work in utf-8 so this should be the default.</description>
                <environment></environment>
            <key id="12428655">COUCHDB-392</key>
        <summary>list and show responses should send utf-8 by default</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Tue, 23 Jun 2009 12:02:14 +0000 (UTC)</created>
    <updated>Mon, 30 Nov 2009 05:27:06 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772663" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12783541" author="jchris" created="Mon, 30 Nov 2009 05:27:06 +0000 (UTC)"  >I fixed this a while back, but forgot to close the ticket.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 30 Nov 2009 05:27:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-391] Restoring the couchDB (restore Documents Views on different Servers)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-391</link>

                    <description>i want to restore the CouchDB Documents &amp;amp; Views from One server to another (on clients server)&lt;br/&gt;
there is option for replication (remote server)..but i don&apos;t have access to that server...(so i can&apos;t Replicate DB on that server using Replicator)&lt;br/&gt;
..but i need to deploy the Db on that server&lt;br/&gt;
.. also in future maybe i will be needing the documents from client server for debugging purpose&lt;br/&gt;
how i can do this?</description>
                <environment>Microsoft Windows XP Professional version 2002&lt;br/&gt;
service Pack2&lt;br/&gt;
erlang : 5.6.5&lt;br/&gt;
couchDb : 0.9.0&lt;br/&gt;
&lt;br/&gt;
</environment>
            <key id="12428653">COUCHDB-391</key>
        <summary>Restoring the couchDB (restore Documents Views on different Servers)</summary>

            <type id="11" iconUrl="http://issues.apache.org/jira/images/icons/genericissue.gif">Question</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ajaypawaskar">Ajay jagdish Pawaskar</reporter>
            
    <created>Tue, 23 Jun 2009 11:49:30 +0000 (UTC)</created>
    <updated>Tue, 23 Jun 2009 11:53:06 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12723050" author="damienkatz" created="Tue, 23 Jun 2009 11:53:06 +0000 (UTC)"  >Please ask questions in the appropriate CouchDB mailing list, not in the bug system:&lt;br/&gt;
&lt;a href=&quot;http://couchdb.apache.org/community/lists.html&quot;&gt;http://couchdb.apache.org/community/lists.html&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 23 Jun 2009 11:53:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 23 Jun 2009 11:53:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-390] proposed additions to _changes feed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-390</link>

                    <description>The _changes comet feed as a replacement for the update notifications is a great step forward, but I&apos;m currently missing these features:&lt;br/&gt;
&lt;br/&gt;
1. The feeds are now per database, rather than per server, which is nice in some use cases, but in others it&apos;s preferable to have a server wide feed (In the case of many thousands of databases on a server, and a single process reacting to updates, by putting messages on a message queue for instance). Ideally I&apos;d like to have both server wide and per database _changes feeds available.&lt;br/&gt;
&lt;br/&gt;
2. I&apos;d like to have a configurable _changes feed that let&apos;s me declare what data will be output in the update rows in the feed, in a similar way to writing views.&lt;br/&gt;
&lt;br/&gt;
3. I&apos;d like to (optionally) have information on whether a particular update was a document creation, update or deletion, so clients would be able to react to those differently without needing to query into the database to find out what happened. </description>
                <environment></environment>
            <key id="12428650">COUCHDB-390</key>
        <summary>proposed additions to _changes feed</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Tue, 23 Jun 2009 11:16:50 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:46:56 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12728006" author="rnewson" created="Tue, 7 Jul 2009 09:32:29 +0000 (UTC)"  >&lt;br/&gt;
A  global _changes would make changing couchdb-lucene away from update notification easier. A thread per database to keep things in sync is unappealing.</comment>
                    <comment id="12728008" author="rnewson" created="Tue, 7 Jul 2009 09:36:47 +0000 (UTC)"  >&lt;br/&gt;
To me, the per-db feature of _changes is useful for applications themselves, to refresh a display with a new post or something. For everything else, including replication, a global stream with a user-supplied filter function seems better.</comment>
                    <comment id="12740047" author="rsl" created="Thu, 6 Aug 2009 13:17:48 +0000 (UTC)"  >2&lt;br/&gt;
Custom made  &amp;quot;_changed&amp;quot;-functions could be handled like views and kept in design-documents for easy deployment.&lt;br/&gt;
&lt;br/&gt;
Idea:     /&amp;lt;dbname&amp;gt;/_design/&amp;lt;design-name&amp;gt;/_changed/&amp;lt;filterfunction&amp;gt;/&lt;br/&gt;
&lt;br/&gt;
-------&lt;br/&gt;
&lt;br/&gt;
3&lt;br/&gt;
You can already identify creations because _rev will start with &amp;quot;1-&amp;quot;  - at least when _rev is assigned automaticly. Still it could be a nice feature to see if the doc was C/U/D.</comment>
                    <comment id="12742148" author="janl" created="Wed, 12 Aug 2009 00:42:29 +0000 (UTC)"  >bump to 0.11. We have changes filters now.</comment>
                    <comment id="12828284" author="janl" created="Mon, 1 Feb 2010 21:46:56 +0000 (UTC)"  >Bump to 0.12. Not a blocker.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 7 Jul 2009 09:32:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-389] [PATCH] Make offset calculation more available during btree folding</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-389</link>

                    <description>When CouchDB returns no values for _all_docs (or potentially any fold over the btree), then no offset is calculated, either.  This is not a problem in non-clustered CouchDB.  However, when you are in a clustered environment and treat each shard as its own CouchDB, then not returning an offset when no values are found on the shard can be problematic.  The specific case is if there is a startkey or skip specified, and there were values before (or after with descending=true) the startkey or skip values, but there are no current values.&lt;br/&gt;
&lt;br/&gt;
Moving the Offset calculation to be available for all clauses in the return fun of couch_httpd_view:make_view_fold_fun/6 allows the user to store Offsets in the RowFunAcc and client code using this function will work as expected.</description>
                <environment></environment>
            <key id="12428296">COUCHDB-389</key>
        <summary>[PATCH] Make offset calculation more available during btree folding</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="boorad">Brad Anderson</reporter>
            
    <created>Thu, 18 Jun 2009 21:12:23 +0000 (UTC)</created>
    <updated>Wed, 8 Jul 2009 01:33:33 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12721509" author="boorad" created="Thu, 18 Jun 2009 21:35:53 +0000 (UTC)"  >as davisp pointed out in IRC, this patch would do a reduce for every row... sub-optimal.&lt;br/&gt;
&lt;br/&gt;
Also, I&apos;ve reverted this patch, and the clustering code is still working.  I believe a change elsewhere fixed my issue (using Total Count when no values were returned from the shard).  I&apos;ll do some more checks, and if that&apos;s the case, I&apos;ll close this as invalid.</comment>
                    <comment id="12721521" author="paul.joseph.davis" created="Thu, 18 Jun 2009 22:07:15 +0000 (UTC)"  >You need that calculating in the first clause (as well as the clause for StartResp) both. The first instance is for when startkey and enkey end up returning 0 rows.</comment>
                    <comment id="12724144" author="boorad" created="Thu, 25 Jun 2009 16:30:14 +0000 (UTC)"  >updated patch based on davisp conversations in IRC.  All tests pass.</comment>
                    <comment id="12727581" author="boorad" created="Mon, 6 Jul 2009 15:26:13 +0000 (UTC)"  >passes davisp muster.</comment>
                    <comment id="12727604" author="paul.joseph.davis" created="Mon, 6 Jul 2009 16:08:39 +0000 (UTC)"  >For reference, this patch makes sure that an offset is calculated for all view responses. Before if the view didn&apos;t return any rows, no offset was calculated. I plan on adding this tonight unless someone spots an error.</comment>
                    <comment id="12728460" author="paul.joseph.davis" created="Wed, 8 Jul 2009 01:33:33 +0000 (UTC)"  >Fixed as of r792013.</comment>
                </comments>
    
    <attachments>
            <attachment id="12411140" name="clustered_offset.patch" size="1068" author="boorad" created="Thu, 18 Jun 2009 21:13:03 +0000 (UTC)" />
            <attachment id="12412573" name="couchdb-389-2.svn.patch" size="7204" author="boorad" created="Mon, 6 Jul 2009 02:32:17 +0000 (UTC)" />
            <attachment id="12412620" name="couchdb-389-3.git.patch" size="8371" author="boorad" created="Mon, 6 Jul 2009 15:26:13 +0000 (UTC)" />
            <attachment id="12411833" name="couchdb-389.svn.patch" size="5315" author="boorad" created="Thu, 25 Jun 2009 16:30:14 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 8 Jul 2009 01:33:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 18 Jun 2009 22:07:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-388] throw an error if the view query range can contain no rows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-388</link>

                    <description>users get confused because when applying descending=true as a previously working query will return 0 rows. this is correct behavior but we could make things a lot easier for people if we&apos;d raise an error in cases where its impossible for there to be keys between the start and end.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12428294">COUCHDB-388</key>
        <summary>throw an error if the view query range can contain no rows</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Thu, 18 Jun 2009 20:58:31 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 22:02:31 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12721501" author="paul.joseph.davis" created="Thu, 18 Jun 2009 21:23:05 +0000 (UTC)"  >Just went to implement this and realized we&apos;d be throwing an error when there are no rows returned by the view. Which is obviously great for letting beginners figure out reverse=true semantics, but it would throw an error just because a view doesn&apos;t return any results.&lt;br/&gt;
&lt;br/&gt;
In other words, do we want to force people to do something like ?empty=ok in their views that might have zero rows returned because they&apos;re keys don&apos;t allow it? As in, maybe this is desirable in some situations?</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 1 Feb 2010 22:02:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 18 Jun 2009 21:23:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-387] curl: (56) Received problem 2 in the chunky parser</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-387</link>

                    <description>I wrote the show function at &lt;a href=&quot;http://friendpaste.com/1W51qISAkmAUZ2JG4Z0FBE&quot;&gt;http://friendpaste.com/1W51qISAkmAUZ2JG4Z0FBE&lt;/a&gt; to let CouchDB render a list of articles as a CSV file. Curl returned this at the end of the output:&lt;br/&gt;
&lt;br/&gt;
----&lt;br/&gt;
curl: (56) Received problem 2 in the chunky parser&lt;br/&gt;
----&lt;br/&gt;
&lt;br/&gt;
After changing the &amp;#xEB; to a plain e this problem went away. Jan Lehnardt on #couchdb thought this might be a bytes versus characters mismatch (&amp;quot;definitely one for chris&amp;quot;).</description>
                <environment>Red Hat Enterprise Linux 5.3 x86_64</environment>
            <key id="12428256">COUCHDB-387</key>
        <summary>curl: (56) Received problem 2 in the chunky parser</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="breun">Nils Breunese</reporter>
            
    <created>Thu, 18 Jun 2009 14:13:52 +0000 (UTC)</created>
    <updated>Tue, 21 Jul 2009 10:51:31 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12721280" author="breun" created="Thu, 18 Jun 2009 14:32:56 +0000 (UTC)"  >jasondavies suggested to change the content-type header to &amp;quot;text/csv; charset=utf-8&amp;quot;, which solves the issue. So, maybe there is no bug.&lt;br/&gt;
&lt;br/&gt;
Edit: the problem returned again.</comment>
                    <comment id="12733583" author="janl" created="Tue, 21 Jul 2009 10:51:31 +0000 (UTC)"  >Since r791145 CouchDB sends the content-type header with the utf-8 info by default. Please re-open if you still see cases of this.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 10:51:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 10:51:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-386] conditional requests for attachments never return 304</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-386</link>

                    <description>If you make a conditional request for a document using the etag, you correctly get a 304 response.  If you try the same thing with an attachment you always get a 200.  Attaching a test case to demonstrate this.&lt;br/&gt;
</description>
                <environment>svn trunk</environment>
            <key id="12428195">COUCHDB-386</key>
        <summary>conditional requests for attachments never return 304</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Thu, 18 Jun 2009 00:42:15 +0000 (UTC)</created>
    <updated>Fri, 10 Jul 2009 01:18:37 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12721017" author="mhammond" created="Thu, 18 Jun 2009 00:43:24 +0000 (UTC)"  >patch to the attachment tests which demonstrates the behaviour.</comment>
                    <comment id="12729487" author="jchris" created="Fri, 10 Jul 2009 01:18:37 +0000 (UTC)"  >fixed in 792774</comment>
                </comments>
    
    <attachments>
            <attachment id="12411015" name="attachment_304.patch" size="620" author="mhammond" created="Thu, 18 Jun 2009 00:43:24 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 10 Jul 2009 01:18:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 10 Jul 2009 01:18:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-385] responses to HEAD requests for _all_docs* have bogus &quot;Content-Length: 0&quot; header</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-385</link>

                    <description>CouchDB invariably sends a bogus &amp;quot;Content-Length: 0&amp;quot; header in response to HEAD requests for _all_docs and _all_docs_by_seq (and possibly other queries). According to &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4&lt;/a&gt; &amp;quot;The metainformation contained in the HTTP headers in response to a HEAD request SHOULD be identical to the information sent in response to a GET request.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
(I discovered this while writing a python script to stream the body of an _all_docs_by_seq response to stdout for use as a database dump.)</description>
                <environment>Linux melkjug.org 2.6.26-hardened-r4 #2 SMP Fri Oct 24 00:59:43 AKDT 2008 x86_64 Intel(R) Xeon(R) CPU L5430 @ 2.66GHz GenuineIntel GNU/Linux</environment>
            <key id="12428048">COUCHDB-385</key>
        <summary>responses to HEAD requests for _all_docs* have bogus &quot;Content-Length: 0&quot; header</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Tue, 16 Jun 2009 21:23:22 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:27:57 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-384] [PATCH] Improvements to couch_config for unit testing purposes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-384</link>

                    <description>To be able to run unit tests involving configuration (i.e. couch_config module), two changes are proposed:&lt;br/&gt;
&lt;br/&gt;
1.  The ability to start the couch_config gen_server with no .ini files in start_link/1.  This means that CouchDB doesn&apos;t even need to be running for tests to be performed.  The caller of set/4 needs to use &apos;false&apos; as the Persist argument, but this is probably desirable when running unit tests.  &lt;br/&gt;
&lt;br/&gt;
2.  The ability to shut down the couch_config gen_server is necessary for proper cleanup after the tests are run.&lt;br/&gt;
&lt;br/&gt;
The attached patch solves both issues.</description>
                <environment></environment>
            <key id="12428020">COUCHDB-384</key>
        <summary>[PATCH] Improvements to couch_config for unit testing purposes</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="boorad">Brad Anderson</reporter>
            
    <created>Tue, 16 Jun 2009 16:52:16 +0000 (UTC)</created>
    <updated>Wed, 24 Jun 2009 05:53:58 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12723456" author="paul.joseph.davis" created="Wed, 24 Jun 2009 05:53:57 +0000 (UTC)"  >Fixed in r787914.</comment>
                </comments>
    
    <attachments>
            <attachment id="12410830" name="couchdb-384.patch" size="2333" author="boorad" created="Tue, 16 Jun 2009 16:53:35 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 24 Jun 2009 05:53:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 24 Jun 2009 05:53:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-383] HTTP get parameter strictness/looseness</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-383</link>

                    <description>The use of GET params in a URL is either too loose or too strict depending on your point of view.&lt;br/&gt;
&lt;br/&gt;
Adding extra GET params that are not needed to a query works on every request except for /dbname/_all_docs, in this event CouchDB returns an error.&lt;br/&gt;
&lt;br/&gt;
Test Case:&lt;br/&gt;
/foobar/_all_docs?callback=jsonp1244562168058&amp;amp;_=1244562168079 &lt;br/&gt;
&lt;br/&gt;
Returns: jsonp1244562168058({&amp;quot;error&amp;quot;:&amp;quot;query_parse_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Invalid URL parameter: \&amp;quot;_\&amp;quot;&amp;quot;});&lt;br/&gt;
&lt;br/&gt;
NOTE: this is not just a JSONP error, this is just how I found it.&lt;br/&gt;
&lt;br/&gt;
Ideally, CouchDB either needs to accept this or to error on every request with that contains erroneous GET parameters.</description>
                <environment>Linux Debian 5.0 (VMware image)</environment>
            <key id="12427883">COUCHDB-383</key>
        <summary>HTTP get parameter strictness/looseness</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="sthulbourn">Simon Thulbourn</reporter>
            
    <created>Mon, 15 Jun 2009 09:16:49 +0000 (UTC)</created>
    <updated>Mon, 22 Jun 2009 12:53:57 +0000 (UTC)</updated>

                        <version>1.0</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12719480" author="sthulbourn" created="Mon, 15 Jun 2009 09:19:23 +0000 (UTC)"  >Adding content.</comment>
                    <comment id="12719538" author="paul.joseph.davis" created="Mon, 15 Jun 2009 12:30:30 +0000 (UTC)"  >The root of this is that the parse_view_parameters function is much more strict that the average URL in CouchDB. Most end points only check what they use if they even check beyond the standard Erlang assume true, barf on error method.&lt;br/&gt;
&lt;br/&gt;
As Simon mentions, the two avenues are either a) go through and beef up URL parameters throughout, or b) relax parameter handling for view queries. The relaxation that&apos;d be needed would be fairly trivial. The code is already there to even trigger it with an ignore_extra=True (for this case at least). On the other hand, tightening all other URL&apos;s would be quite arduous at best. Someone would have to find every URL, and then find every parameter that might be used, and then write all the logic for values those parameters might take.&lt;br/&gt;
&lt;br/&gt;
I&apos;m open to either approach.</comment>
                    <comment id="12719825" author="jchris" created="Mon, 15 Jun 2009 22:29:38 +0000 (UTC)"  >I vote relax!</comment>
                    <comment id="12721419" author="carnold@apache.org" created="Thu, 18 Jun 2009 19:02:52 +0000 (UTC)"  >This feature/bug relates to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-257&quot; title=&quot;HTTP caching headers don&apos;t provide expected behaviour&quot;&gt;COUCHDB-257&lt;/a&gt; which addressed the inability to work around IE&apos;s overly aggressive caching of XmlHttpRequests.  A potential work around would be to throw in an extra ignored parameter with a constantly changing value to prevent the inappropriate cache hit, however this does not work since CouchDB returns a query_parse_error for the extra parameter.&lt;br/&gt;
&lt;br/&gt;
I have not observed other queries accepting extra parameters either with or without an ignore_extra parameter.  I&apos;m using 0.10.0a777361 which is a few weeks old, so perhaps that behavior have changed in the interim.&lt;br/&gt;
&lt;br/&gt;
I vote relax.</comment>
                    <comment id="12721478" author="sthulbourn" created="Thu, 18 Jun 2009 20:48:06 +0000 (UTC)"  >I found it by using jQuery with JSONP.&lt;br/&gt;
&lt;br/&gt;
It would be nice to relax it.</comment>
                    <comment id="12721560" author="paul.joseph.davis" created="Thu, 18 Jun 2009 23:44:28 +0000 (UTC)"  >No one opposed, so I relaxed URL parameter parsing as of r786337</comment>
                    <comment id="12722350" author="candlerb" created="Sun, 21 Jun 2009 12:22:42 +0000 (UTC)"  >If you&apos;re gonna fully relax, then I think you might also want to accept things like reduce=false on a map-only view. (Perhaps even ignore reduce=true too?)&lt;br/&gt;
&lt;br/&gt;
Right now, nonsense like &apos;reducz=false&apos; is accepted, but the reasonable &apos;reduce=false&apos; is not:&lt;br/&gt;
&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a787002&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
$ curl &apos;&lt;a href=&quot;http://127.0.0.1:5984/test/_design/test/_view/test?reduce=false&quot;&gt;http://127.0.0.1:5984/test/_design/test/_view/test?reduce=false&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;query_parse_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Invalid URL parameter `reduce` for map view.&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
This is a pain, given that map-reduce views default to reduce=true. That is, if you know you only want the map part of the view, but you don&apos;t know if it has a reduce part or not, you may end up having to submit the query twice.&lt;br/&gt;
</comment>
                    <comment id="12722378" author="paul.joseph.davis" created="Sun, 21 Jun 2009 16:26:54 +0000 (UTC)"  >I don&apos;t find it very relaxing to accept a request that is invalid just because we think we might know what the user wanted. This may seem trivial enough but its the first step on the path to dragons.&lt;br/&gt;
&lt;br/&gt;
However, I would support adding a new parameter that is map=true to force viewing a map that would obviously work for either map-only or map-reduce views.&lt;br/&gt;
&lt;br/&gt;
Another solution I once described was to split urls like:&lt;br/&gt;
&lt;br/&gt;
/db_name/_design/foo/_view/bar&lt;br/&gt;
&lt;br/&gt;
becomes&lt;br/&gt;
&lt;br/&gt;
/db_name/_design/foo/_map/bar&lt;br/&gt;
/db_name/_design/foo/_red/bar&lt;br/&gt;
&lt;br/&gt;
I support the splitting from an CouchDB internals point of view plus this exact reduce=false messiness. Obviously, that&apos;s quite a huge break for clients though.</comment>
                    <comment id="12722420" author="candlerb" created="Sun, 21 Jun 2009 20:33:09 +0000 (UTC)"  >I&apos;d say there are dragons in accepting random unknown query strings too. A few times I have done something like&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;....?include_attachments=true&lt;br/&gt;
instead of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;....?attachments=true&lt;br/&gt;
&lt;br/&gt;
(or is it the other way round?) Having erroneous parameters fail silently is not, IMO, very helpful. However I agree that the situation wasn&apos;t very consistent as it was.&lt;br/&gt;
&lt;br/&gt;
Having &amp;quot;map=true&amp;quot; doesn&apos;t seem sensible to me, given that it&apos;s just the negative of &amp;quot;reduce=false&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
Having views default to reduce=false would suit me well (i.e. if you want it reduced, you have to ask for reduce=true), but would be hugely non backwards compatible. Ditto for your suggestion of _map and _red.&lt;br/&gt;
&lt;br/&gt;
Perhaps we could even have multiple reduce functions behind the same map - so you&apos;d have to select which one you wanted anyway.</comment>
                    <comment id="12722476" author="carnold@apache.org" created="Mon, 22 Jun 2009 04:07:31 +0000 (UTC)"  >For &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-257&quot; title=&quot;HTTP caching headers don&apos;t provide expected behaviour&quot;&gt;COUCHDB-257&lt;/a&gt;, it would be hugely beneficial to have an always accepted parameter that is always ignored by CouchDB.&lt;br/&gt;
&lt;br/&gt;
Not quite the same issue, but CouchDB (at least a few months ago) had problems when it was behind an authenticated proxy.  The credentials were processed properly by the proxy server but they carried through to CouchDB which would reject the request, even though credentials weren&apos;t intended to be used by CouchDB and the request would have worked fine without credentials.  There is the potential that CouchDB may see parameters that were included for some other layer in the processing chain.  There should be at least an option to accept unrecognized parameters.&lt;br/&gt;
&lt;br/&gt;
My possibly uninformed opinion is:&lt;br/&gt;
&lt;br/&gt;
1. Add an ignore=... parameter for &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-257&quot; title=&quot;HTTP caching headers don&apos;t provide expected behaviour&quot;&gt;COUCHDB-257&lt;/a&gt;&lt;br/&gt;
2. Add a strict=true|false to control whether to reject unrecognized parameters with a default of true (behavior prior to r786337)&lt;br/&gt;
3. Accept reduce=false for map-only views regardless of strict setting.&lt;br/&gt;
4. Accept reduce=true for map-only views when strict=false.</comment>
                    <comment id="12722489" author="jchris" created="Mon, 22 Jun 2009 05:27:59 +0000 (UTC)"  >&amp;gt; Having views default to reduce=false would suit me well (i.e. if you want it reduced, you have to ask for reduce=true), but would be hugely non backwards compatible.&lt;br/&gt;
&lt;br/&gt;
This idea is the most sensible of the bunch as far as I&apos;m concerned. Backwards compatibility is still less important than good API design at this point.&lt;br/&gt;
&lt;br/&gt;
I&apos;m not opposed to the introduction of the strict=true option, but I&apos;d suggest that defaulting to false is more relaxing.</comment>
                    <comment id="12722505" author="vsajip" created="Mon, 22 Jun 2009 08:12:47 +0000 (UTC)"  >I don&apos;t see that this is particularly related to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-257&quot; title=&quot;HTTP caching headers don&apos;t provide expected behaviour&quot;&gt;COUCHDB-257&lt;/a&gt; - that issue is about HTTP headers, this is about interpretation of HTTP query parameters.</comment>
                    <comment id="12722582" author="carnold@apache.org" created="Mon, 22 Jun 2009 12:53:57 +0000 (UTC)"  >The typical work-around used with other services to workaround IE&apos;s XmlHttpRequest ignoring requests not to cache responses is to add nonsense query parameters.  Since CouchDB (until the recent patch) returns sees unrecognized parameters as errors, that work-around isn&apos;t available.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12414871">COUCHDB-257</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 18 Jun 2009 23:44:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 15 Jun 2009 12:30:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-382] couch_erl_driver is 32bit even when the erlang beam is 64bit which results in couchdb crashing</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-382</link>

                    <description>Trunk &apos;make dev&apos; (possibly the installation as well) couchdb startup fails when beam is 64 bit because couch_erl_driver.so is 32bit.&lt;br/&gt;
&lt;br/&gt;
The error returned:&lt;br/&gt;
$ utils/run&lt;br/&gt;
Apache CouchDB 0.10.0a783287 (LogLevel=error) is starting.&lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,&amp;quot;dlopen(/Users/lestat/Projects/couchdb/src/couchdb/.libs/couch_erl_driver.so, 2): no suitable image found.  Did find:\n	/Users/lestat/Projects/couchdb/src/couchdb/.libs/couch_erl_driver.so: mach-o, but wrong architecture&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot (dlopen(/Users/lestat/Projects/couchdb/src/couchdb/.libs/couch_erl_driver.so, 2): no suitable image found.  Did find:&lt;br/&gt;
	/Users/lestat/Projects/couchdb/src/couchdb/.libs/co&lt;br/&gt;
&lt;br/&gt;
The file results:&lt;br/&gt;
$file couch_erl_driver.so &lt;br/&gt;
couch_erl_driver.so: Mach-O bundle i386&lt;br/&gt;
&lt;br/&gt;
$file beam.smp &lt;br/&gt;
beam.smp: Mach-O 64-bit executable x86_64&lt;br/&gt;
&lt;br/&gt;
$ autoconf --version&lt;br/&gt;
autoconf (GNU Autoconf) 2.61&lt;br/&gt;
Copyright (C) 2006 Free Software Foundation, Inc.&lt;br/&gt;
This is free software.  You may redistribute copies of it under the terms of&lt;br/&gt;
the GNU General Public License &amp;lt;&lt;a href=&quot;http://www.gnu.org/licenses/gpl.html&quot;&gt;http://www.gnu.org/licenses/gpl.html&lt;/a&gt;&amp;gt;.&lt;br/&gt;
There is NO WARRANTY, to the extent permitted by law.&lt;br/&gt;
&lt;br/&gt;
Written by David J. MacKenzie and Akim Demaille.&lt;br/&gt;
&lt;br/&gt;
$ automake --version&lt;br/&gt;
automake (GNU automake) 1.10&lt;br/&gt;
Written by Tom Tromey &amp;lt;&lt;a href=&apos;mailto:tromey@redhat.com&apos;&gt;tromey@redhat.com&lt;/a&gt;&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;and Alexandre Duret-Lutz &amp;lt;&lt;a href=&apos;mailto:adl@gnu.org&apos;&gt;adl@gnu.org&lt;/a&gt;&amp;gt;.&lt;br/&gt;
&lt;br/&gt;
Copyright 2006 Free Software Foundation, Inc.&lt;br/&gt;
This is free software; see the source for copying conditions.  There is NO&lt;br/&gt;
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&lt;br/&gt;
</description>
                <environment>Mac OSX 10.5/MacBook2.1, &lt;br/&gt;
automake(default Mac one), &lt;br/&gt;
autoconf(default Mac one), &lt;br/&gt;
erlang R13B compiled from source with: /configure --prefix=/opt/erlang --enable-threads --enable-smp-support --enable-kernel-poll --enable-darwin-64bit</environment>
            <key id="12427566">COUCHDB-382</key>
        <summary>couch_erl_driver is 32bit even when the erlang beam is 64bit which results in couchdb crashing</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="tamas.nagy">Tamas Nagy</reporter>
            
    <created>Wed, 10 Jun 2009 14:48:32 +0000 (UTC)</created>
    <updated>Wed, 10 Jun 2009 17:03:05 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12718140" author="nslater" created="Wed, 10 Jun 2009 17:03:05 +0000 (UTC)"  >&amp;quot;You&apos;ve probably built Erlang with the 64 bit option enabled. The problem is that ICU, which CouchDB attempts to load at startup time, has not been compiled with 64 bit support, so it can&apos;t be loaded into the 64bit Erlang process.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
See &lt;a href=&quot;http://wiki.apache.org/couchdb/Error_messages&quot;&gt;http://wiki.apache.org/couchdb/Error_messages&lt;/a&gt; for more information.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 10 Jun 2009 17:03:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 10 Jun 2009 17:03:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-381] it would be nice to have an option in bin/couchdb to pass &quot;-sname node_name&quot; to erlang at startup</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-381</link>

                    <description>attached is a patch to bin/couchdb.tpl.in that accomplishes this</description>
                <environment></environment>
            <key id="12427501">COUCHDB-381</key>
        <summary>it would be nice to have an option in bin/couchdb to pass &quot;-sname node_name&quot; to erlang at startup</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Tue, 9 Jun 2009 22:03:19 +0000 (UTC)</created>
    <updated>Thu, 9 Jul 2009 17:02:46 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12717838" author="dionne" created="Tue, 9 Jun 2009 22:07:52 +0000 (UTC)"  >adds -sname node_name to erlang shell using a -S option</comment>
                    <comment id="12729327" author="nslater" created="Thu, 9 Jul 2009 17:02:46 +0000 (UTC)"  >You can pass options to the Erlang VM with the following variables:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ERL_FLAGS, ERL_AFLAGS, ERL_ZFLAGS&lt;br/&gt;
&lt;br/&gt;
Thanks for taking the time to prepare a patch though.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12429530">COUCHDB-400</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12410260" name="couchdb.tpl.in.patch" size="2308" author="dionne" created="Tue, 9 Jun 2009 22:07:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 9 Jul 2009 17:02:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 9 Jul 2009 17:02:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-380] Getting &quot;please try again.&quot; response from CouchDb when tried to update the document</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-380</link>

                    <description>hi&lt;br/&gt;
i m Updating couch document from &amp;gt;net framework 2.0 (c#)&lt;br/&gt;
i m getting response as &amp;quot;please try again&amp;quot;....&lt;br/&gt;
(when i am updating other docs those docs getting updated)&lt;br/&gt;
&lt;br/&gt;
here is what i m doing&lt;br/&gt;
&lt;br/&gt;
i have two docs &lt;br/&gt;
&amp;nbsp;&amp;nbsp;1] appconfiguarion&lt;br/&gt;
&amp;nbsp;&amp;nbsp;2] systemrestore&lt;br/&gt;
&lt;br/&gt;
i m getting (GET) systemrestore &amp;amp; appconfiguarion&lt;br/&gt;
then in my .net code i update the appconfiguarion from systemrestore  document ( taken care of _id &amp;amp; _rev Fields)&lt;br/&gt;
then i am trying to update(PUT) the appconfiguarion document&lt;br/&gt;
where i m getting error as &amp;quot;please try again&amp;quot;&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
one more thing&lt;br/&gt;
when i m updating appconfiguarion document separately it&apos;s getting updated (from my .Net code)&lt;br/&gt;
&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
i tried by restarting couchDb server same error i am getting&lt;br/&gt;
.&lt;br/&gt;
is any any kind of BUG from couchdb?&lt;br/&gt;
or m i missing something? &lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Microsoft windows Xp Professional version 2002 Service Pack 2&lt;br/&gt;
Microsoft Visual C# 2005</environment>
            <key id="12427471">COUCHDB-380</key>
        <summary>Getting &quot;please try again.&quot; response from CouchDb when tried to update the document</summary>

            <type id="11" iconUrl="http://issues.apache.org/jira/images/icons/genericissue.gif">Question</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="ajaypawaskar">Ajay jagdish Pawaskar</reporter>
            
    <created>Tue, 9 Jun 2009 16:31:36 +0000 (UTC)</created>
    <updated>Tue, 23 Jun 2009 11:37:42 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12717762" author="paul.joseph.davis" created="Tue, 9 Jun 2009 17:36:36 +0000 (UTC)"  >This sounds like an error coming from the C# library in response to a precondition failed when not providing the right _rev attribute durring an update. AFAIK there is no &amp;quot;please try again&amp;quot; error in CouchDB.&lt;br/&gt;
&lt;br/&gt;
If you can provide HTTP header and bodies transferred that show that this is a bug in CouchDB feel free to attach those and reopen the bug.</comment>
                    <comment id="12723046" author="ajaypawaskar" created="Tue, 23 Jun 2009 11:34:49 +0000 (UTC)"  >ya.. i messed up with the revisions..so in that case i was giving message Please try Again&lt;br/&gt;
thx</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Jun 2009 17:36:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Jun 2009 17:36:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-379] Inconsistent Server headers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-379</link>

                    <description>When requesting a document from CouchDB it is served by &amp;quot;CouchDB/0.9.0 (Erlang OTP/R12B)&amp;quot; according to the Server header, but when requesting a document through a show function seems to be served by &amp;quot;MochiWeb/1.0 (Any of you quaids got a smint?)&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
Jason Davies on #couchdb: &amp;quot;hmm, we should probably make those consistent&amp;quot;</description>
                <environment>Red Hat Enterprise Linux 5.3</environment>
            <key id="12427451">COUCHDB-379</key>
        <summary>Inconsistent Server headers</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="breun">Nils Breunese</reporter>
            
    <created>Tue, 9 Jun 2009 12:34:34 +0000 (UTC)</created>
    <updated>Mon, 15 Jun 2009 09:50:18 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12719493" author="janl" created="Mon, 15 Jun 2009 09:50:18 +0000 (UTC)"  >Fixed in r784706.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 15 Jun 2009 09:50:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 15 Jun 2009 09:50:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-378] couchdb start-up script breaks on Solaris 10, expects GNU find</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-378</link>

                    <description>If I install couchdb on stock Solaris 10, this happens when trying to start it using command &apos;couchdb&apos;:&lt;br/&gt;
&lt;br/&gt;
# couchdb&lt;br/&gt;
find: bad option -mindepth&lt;br/&gt;
find: [-H | -L] path-list predicate-list&lt;br/&gt;
&lt;br/&gt;
Reason here is that Solaris 10 doesn&apos;t ship with GNU find, and Solaris 10&apos;s own find doesn&apos;t support -mindepth or -maxdepth options. The offending command is in _add_config_dir function. Replacing it with a simple wildcard + test-expression should be trivial. Something along these lines:&lt;br/&gt;
&lt;br/&gt;
for file in &amp;quot;$1&amp;quot;/*; do&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;test -f $file &amp;amp;&amp;amp; _add_config_file $file&lt;br/&gt;
done</description>
                <environment>Solaris 10</environment>
            <key id="12427346">COUCHDB-378</key>
        <summary>couchdb start-up script breaks on Solaris 10, expects GNU find</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="onre">Erno Palonheimo</reporter>
            
    <created>Mon, 8 Jun 2009 11:13:36 +0000 (UTC)</created>
    <updated>Mon, 8 Jun 2009 11:13:36 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-377] allow native view servers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-377</link>

                    <description>There has been some discussion on IRC etc about how to support &apos;native&apos; view servers, such as &apos;erlview&apos; in a generic way.  Currently using erlview requires you to modify couch.&lt;br/&gt;
&lt;br/&gt;
I&apos;m attaching a patch as a first attempt at supporting this.  In summary, the patch now looks up a new &apos;native_query_servers&apos; config file section for a list of view_server names with a {Module, Func, Args} style string specifying the entry-point of the view server.  The code now passes an additional atom around indicating if the PID is &apos;native&apos; or &apos;external&apos;, and map_docs takes advantage of this to avoid the json step.  This patch allows erlview to work for me, but in theory any erlang code could be used here.&lt;br/&gt;
&lt;br/&gt;
I&apos;m very new at erlang - please let me know if I should make stylistic or other changes, or indeed if I should take a different approach completely.</description>
                <environment></environment>
            <key id="12427288">COUCHDB-377</key>
        <summary>allow native view servers</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Sun, 7 Jun 2009 04:23:21 +0000 (UTC)</created>
    <updated>Wed, 12 Aug 2009 19:59:01 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12722757" author="damienkatz" created="Mon, 22 Jun 2009 18:43:15 +0000 (UTC)"  >I think we should not try to avoid the JSON term conversion, as it&apos;s the most stable API and it&apos;s a low cost conversion, everything is still Erlang terms. It&apos;s the serialization to a string and back that&apos;s expensive.&lt;br/&gt;
&lt;br/&gt;
I think we should go ahead and change the get os_process call to return a record, instead of a tuple, something like:&lt;br/&gt;
&lt;br/&gt;
-record(proc, {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pid,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lang,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;type,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;prompt_fun&lt;br/&gt;
}}.&lt;br/&gt;
&lt;br/&gt;
The prompt_fun replaces and wraps couch_os_process:prompt and now we call the prompt_fun with the same args. If it&apos;s an OS process, it&apos;s the same call to couch_os_process:prompt, otherwise it&apos;s a function that calls apply(Mod, Fun, [Pid, Args]) or something like that.&lt;br/&gt;
&lt;br/&gt;
The patch otherwise looks good, I don&apos;t see any obvious bugs or style problems.</comment>
                    <comment id="12730054" author="mhammond" created="Sun, 12 Jul 2009 07:50:28 +0000 (UTC)"  >Attaching a new patch which should be getting closer to what Damien requested - a record object and 3 functions -  &apos;prompt&apos;, &apos;set_timeout&apos; and &apos;stop&apos;.</comment>
                    <comment id="12730092" author="jchris" created="Sun, 12 Jul 2009 14:57:47 +0000 (UTC)"  >All I did here was refactor the calls into the query-server fun to make them a little cleaner to deal with in the code itself (from the perspective of adding new query_server features). &lt;br/&gt;
&lt;br/&gt;
I like where Mark&apos;s going with this. </comment>
                    <comment id="12732958" author="mhammond" created="Sun, 19 Jul 2009 02:41:42 +0000 (UTC)"  >Attaching a simple native view server.  I&apos;ve named it couch_native_process.erl in anticipation of it being shipped with couch itself.  It is fairly minimalistic - no &apos;helper&apos; functions are provided, just a raw erlang interface.  The comments at the top of the file include the instructions for configuring and testing, but it assumes Jan&apos;s other patch in this issue has already been applied.</comment>
                    <comment id="12732982" author="mhammond" created="Sun, 19 Jul 2009 07:48:58 +0000 (UTC)"  >A patch that creates an &apos;include_docs&apos; test for the erlang views...</comment>
                    <comment id="12733433" author="mhammond" created="Tue, 21 Jul 2009 01:52:04 +0000 (UTC)"  >&lt;a href=&quot;git://github.com/mhammond/couchdb-native-views.git&quot;&gt;git://github.com/mhammond/couchdb-native-views.git&lt;/a&gt; has the latest version of this patch - not included here is another test, makefile and default.ini template tweaks, and allowing the native server to return tuples of {Key, Value} rather than 2-item lists of [Key, Value].</comment>
                    <comment id="12735601" author="mhammond" created="Mon, 27 Jul 2009 13:17:18 +0000 (UTC)"  >Now is being done in the &apos;native_proc&apos; branch on both davisp and my couchdb forks.  Some help needed by people who understand the view server architecture.</comment>
                    <comment id="12738207" author="mhammond" created="Mon, 3 Aug 2009 06:58:36 +0000 (UTC)"  >An integrated patch, including all previous patches, tests etc, as discussed on the -dev mailing list.</comment>
                    <comment id="12739063" author="damienkatz" created="Tue, 4 Aug 2009 17:52:14 +0000 (UTC)"  >This patch looks good to me, though I would like to see some JS based tests using the run_on_modified_server functionality in the test suite.</comment>
                    <comment id="12740413" author="mhammond" created="Fri, 7 Aug 2009 05:32:10 +0000 (UTC)"  >The start of js tests - map and reduce are working fine, but the &apos;list&apos; feature needs some work...</comment>
                    <comment id="12741209" author="paul.joseph.davis" created="Mon, 10 Aug 2009 07:01:28 +0000 (UTC)"  >When Mark added the JS tests it pointed out that we weren&apos;t accounting for when ErlJSON objects were using atoms instead of binaries. I&apos;m going to look into the doc_to_json calls and if possible munge all atoms (except null, true, and false) to their binary representations.&lt;br/&gt;
&lt;br/&gt;
This didn&apos;t actually break anything, but in the Erlang code you&apos;d have to figure out what type the key was when doing porplists:get_value calls.</comment>
                    <comment id="12742547" author="jchris" created="Wed, 12 Aug 2009 19:59:01 +0000 (UTC)"  >closed in r803685&lt;br/&gt;
&lt;br/&gt;
thanks everyone!</comment>
                </comments>
    
    <attachments>
            <attachment id="12413939" name="couch_native_process.erl" size="5001" author="mhammond" created="Sun, 19 Jul 2009 02:41:42 +0000 (UTC)" />
            <attachment id="12413944" name="erlang_test_include_docs.patch" size="2162" author="mhammond" created="Sun, 19 Jul 2009 07:48:58 +0000 (UTC)" />
            <attachment id="12413221" name="native_query_servers.patch" size="16295" author="mhammond" created="Sun, 12 Jul 2009 07:50:28 +0000 (UTC)" />
            <attachment id="12410077" name="native_query_servers.patch" size="5860" author="mhammond" created="Sun, 7 Jun 2009 04:23:57 +0000 (UTC)" />
            <attachment id="12415318" name="native_query_servers2.patch" size="40614" author="mhammond" created="Mon, 3 Aug 2009 06:58:36 +0000 (UTC)" />
            <attachment id="12415817" name="native_view_js_tests.patch" size="4217" author="mhammond" created="Fri, 7 Aug 2009 05:32:10 +0000 (UTC)" />
            <attachment id="12413237" name="query_proc.patch" size="15366" author="jchris" created="Sun, 12 Jul 2009 14:57:47 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 12 Aug 2009 19:59:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 22 Jun 2009 18:43:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-376] jquery.couch.js support of &quot;keys&quot; options in view function </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-376</link>

                    <description>Patch adding support for &amp;quot;keys&amp;quot; options in views to jquery.couch.js.</description>
                <environment></environment>
            <key id="12427217">COUCHDB-376</key>
        <summary>jquery.couch.js support of &quot;keys&quot; options in view function </summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Fri, 5 Jun 2009 14:12:28 +0000 (UTC)</created>
    <updated>Sun, 13 Sep 2009 17:54:28 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12754734" author="janl" created="Sun, 13 Sep 2009 17:54:28 +0000 (UTC)"  >Committed in r814364.</comment>
                </comments>
    
    <attachments>
            <attachment id="12409985" name="couchdb-share_www_script_jquery_couch_js.diff" size="1037" author="benoitc" created="Fri, 5 Jun 2009 14:13:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 13 Sep 2009 17:54:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 13 Sep 2009 17:54:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-375] src/couchdb directory needs reorganising</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-375</link>

                    <description>Since adding a priv directory here, we should create a lib directory for the erl files.</description>
                <environment></environment>
            <key id="12427021">COUCHDB-375</key>
        <summary>src/couchdb directory needs reorganising</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Wed, 3 Jun 2009 10:50:05 +0000 (UTC)</created>
    <updated>Wed, 3 Jun 2009 15:36:04 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12715956" author="paul.joseph.davis" created="Wed, 3 Jun 2009 15:30:55 +0000 (UTC)"  >We need to do way more than create a library directory. If we&apos;re gonna plan a break, we should probably plan to split things properly.</comment>
                    <comment id="12715958" author="nslater" created="Wed, 3 Jun 2009 15:36:04 +0000 (UTC)"  >Agreed.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 3 Jun 2009 15:30:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-374] couchspawnkillable doesn&apos;t work on windows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-374</link>

                    <description>The shell script &apos;couchspawnkillable&apos; doesn&apos;t work on windows, meaning lots of things are broken in the trunk.  It might be possible to bash cygwin/msys etc to work, but I think a better solution for windows is a custom little C app which does the same basic thing.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve attached the source for such an app and it works for me.  It creates a suspended child process with the same handles as us, then echos the &apos;kill&apos; command, then spawns the real app and terminates.  The &apos;kill command&apos; is a reference to the same couchspawnkillable.exe but with a &apos;--kill&apos; command-line.  I&apos;ve not tried to integrate with a build system, but simple instructions are at the top of the file.&lt;br/&gt;
&lt;br/&gt;
Attaching it here so it doesn&apos;t get lost...</description>
                <environment>windows</environment>
            <key id="12427005">COUCHDB-374</key>
        <summary>couchspawnkillable doesn&apos;t work on windows</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="4">Incomplete</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Wed, 3 Jun 2009 06:42:53 +0000 (UTC)</created>
    <updated>Thu, 9 Jul 2009 23:40:39 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12715837" author="mhammond" created="Wed, 3 Jun 2009 06:43:39 +0000 (UTC)"  >a win32 native couchspawnkillable.exe</comment>
                    <comment id="12715886" author="mhammond" created="Wed, 3 Jun 2009 10:05:09 +0000 (UTC)"  >Added apache license, updated comments...</comment>
                    <comment id="12717003" author="mhammond" created="Sun, 7 Jun 2009 01:32:38 +0000 (UTC)"  >I noticed that depending on how erlang itself is started, couchspawnkillable may not have a valid stderr, so would fail.  This new version only considers failure to duplicate stdin and stdout fatal and ignores failure duplicating stderr.</comment>
                    <comment id="12729454" author="mhammond" created="Thu, 9 Jul 2009 23:40:39 +0000 (UTC)"  >Now incorporated as a complete patch in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-406&quot; title=&quot;build on windows&quot;&gt;&lt;strike&gt;COUCHDB-406&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
            <attachment id="12410076" name="couchspawnkillable_win.c" size="4811" author="mhammond" created="Sun, 7 Jun 2009 01:32:38 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 9 Jul 2009 23:40:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-373] ./utils/run complains about non-existant directories</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-373</link>

                    <description>Executing ./utils/run complains about missing directories&lt;br/&gt;
&lt;br/&gt;
Steps to reproduce:&lt;br/&gt;
1. Find a computer that you can install linux on.&lt;br/&gt;
2. Fetch a copy of an operating system that you can use. I recommed the GNU/Linux Ubuntu distribution. You can download a copy of it at [1]. If you&apos;re new to the GNU/Linux operating system, I recommend downloading the &amp;quot;Desktop&amp;quot; distribution. At the time of this writing, Ubuntu 9.04 is the most recent release an is the recommended version when following these steps to reproduce the issue.&lt;br/&gt;
3. Once your download has completed you should have a local file that has an extension of &amp;quot;.iso&amp;quot;. (An extension is the last three characters of the filename.) &amp;quot;ISO&amp;quot; files is an archive copy that is commonly used to distributed software that is designed to run from optical media. See [2] for a more thorough explanation of the format.&lt;br/&gt;
4. Transfer the ISO file to an optical media that your target system is capable of reading. (Alternatively you could create a bootable thumb drive [3], but that is outside the scope of this document.) When transferring the &amp;quot;ISO&amp;quot; file you must be sure to use software that understands the format. See [4] for further help.&lt;br/&gt;
5. Place the installation media into your computer and reboot.&lt;br/&gt;
6. When the BIOS screen [5] appears, press the appropriate key combination to view your preferred boot device [6]. You&apos;ll need to ensure that the drive containing your installation media is the primary boot device. Exact instructions will vary based on manufacturer and model of motherboard. Consult Google [7] for more information.&lt;br/&gt;
7. Installing GNU/Linux will depend on the distribution that you chose. If you followed these steps to reproduce, the Ubuntu installation procedure provides helpful Graphical User Interface [8] to assist with the installation procedure. More detail instructions for installation can be found at [9].&lt;br/&gt;
8. Assuming that your installation was successful it is always helpful to get acquainted with the new system. See [10] for a helpful community of Ubuntu users. To proceed with the rest of these steps you&apos;ll need to become familiar with the Command Line Interface [11]. In the Ubuntu GNU/Linux operating system, this application is called &amp;quot;Terminal&amp;quot; [12]. At the minimum you will need to be familiar with how to execute commands and perform actions as the &amp;quot;Superuser&amp;quot; or &amp;quot;Root user&amp;quot; [13]. See [14] for instructions on using the &amp;quot;sudo&amp;quot; (Super User Do) command line application.&lt;br/&gt;
9. Install dependencies that CouchDB requires for configuration and compiling. The fastest method for installing dependencies is to issue the following command in the Terminal application:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ sudo build-dep couchdb&lt;br/&gt;
&lt;br/&gt;
A note on commands: The above syntax is a method for describing commands in the Terminal application. The &apos;$&apos; character represents the &amp;quot;prompt&amp;quot; [11]. Commands are entered as a string of characters and executed by pressing the &amp;quot;Return&amp;quot; key on your keyboard. Sometimes the &amp;quot;Return&amp;quot; key is referred to by other names, (for instance, on keyboards for languages other than English), suffice it to say that it is generally the largest key on the right hand side of your keyboard (disregarding the (possibly non-existant) numeric keypad, and (possibly non-existant) directional keys.).&lt;br/&gt;
&lt;br/&gt;
Assuming that command completes successfully, we should be ready to start configuring and installing CouchDB. If something goes awry, you should be aware that the CouchDB community is willing to help [15].&lt;br/&gt;
10. Fetch the Subversion [16] utility. Subversion is a &amp;quot;Revision Control System&amp;quot; [17], a tool commonly used by programmers to track changes they make to a program. On the Ubuntu GNU/Linux you can fetch this tool with the following command:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ sudo apt-get install subversion&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
If that command fails, I will refer the user once again to the CouchDB community found at [15].&lt;br/&gt;
&lt;br/&gt;
11. Fetch a copy of the CouchDB source code.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ svn co &lt;a href=&quot;http://svn.apache.org/repos/asf/couchdb/trunk&quot;&gt;http://svn.apache.org/repos/asf/couchdb/trunk&lt;/a&gt; couchdb&lt;br/&gt;
&lt;br/&gt;
12. Change into the CouchDB directory&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ cd couchdb&lt;br/&gt;
&lt;br/&gt;
13. Bootstrap the software. Bootstrapping [18] refers to the process of preparing a source code distribution (such as the one you have just retrieved) for the configuration process. A more thorough description of the process can be found at [19].&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ ./bootstrap&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
14. Configure the software. Note, although we will not be installing the software in this guide, the configuration step is where the paths for installation are decided. If you are building CouchDB for system wide use, you may wish to peruse the Filesystem Hierarchy Standard (FHS) [20] to get an idea of where you may want to install different portions of the final build product. Also consult with the CouchDB README that has helpful pointers.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ ./configure&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
15. Now that the software is configured, we are ready to compile it into a running program.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ make&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
16. The following steps involve creating and running CouchDB in a development environment as this is the configuration affected by this bug. If you desired to install the compiled program on your system the appropriate command would be:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;# THIS IS NOT REQUIRED&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ sudo make install&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
I have placed an obvious note to...&lt;br/&gt;
&lt;br/&gt;
Damn. My upgrade yesterday broke stuff. I have things to attend to.&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://www.ubuntu.com/getubuntu/download&quot;&gt;http://www.ubuntu.com/getubuntu/download&lt;/a&gt;&lt;br/&gt;
[2] &lt;a href=&quot;http://en.wikipedia.org/wiki/ISO_image&quot;&gt;http://en.wikipedia.org/wiki/ISO_image&lt;/a&gt;&lt;br/&gt;
[3] &lt;a href=&quot;http://www.google.com/search?q=bootable+thumb+drive&quot;&gt;http://www.google.com/search?q=bootable+thumb+drive&lt;/a&gt;&lt;br/&gt;
[4] &lt;a href=&quot;http://www.google.com/search?q=Burning+an+ISO&quot;&gt;http://www.google.com/search?q=Burning+an+ISO&lt;/a&gt;&lt;br/&gt;
[5] &lt;a href=&quot;http://en.wikipedia.org/wiki/BIOS&quot;&gt;http://en.wikipedia.org/wiki/BIOS&lt;/a&gt;&lt;br/&gt;
[6] &lt;a href=&quot;http://en.wikipedia.org/wiki/Booting#Boot_devices_.28IBM_PC.29&quot;&gt;http://en.wikipedia.org/wiki/Booting#Boot_devices_.28IBM_PC.29&lt;/a&gt;&lt;br/&gt;
[7] &lt;a href=&quot;http://www.google.com&quot;&gt;http://www.google.com&lt;/a&gt;&lt;br/&gt;
[8] &lt;a href=&quot;http://en.wikipedia.org/wiki/Graphical_user_interface&quot;&gt;http://en.wikipedia.org/wiki/Graphical_user_interface&lt;/a&gt;&lt;br/&gt;
[9] &lt;a href=&quot;https://help.ubuntu.com/9.04/installation-guide/i386/index.html&quot;&gt;https://help.ubuntu.com/9.04/installation-guide/i386/index.html&lt;/a&gt;&lt;br/&gt;
[10] &lt;a href=&quot;http://www.ubuntu.com/community&quot;&gt;http://www.ubuntu.com/community&lt;/a&gt;&lt;br/&gt;
[11] &lt;a href=&quot;http://en.wikipedia.org/wiki/Command_line_interface&quot;&gt;http://en.wikipedia.org/wiki/Command_line_interface&lt;/a&gt;&lt;br/&gt;
[12] &lt;a href=&quot;https://help.ubuntu.com/community/UsingTheTerminal&quot;&gt;https://help.ubuntu.com/community/UsingTheTerminal&lt;/a&gt;&lt;br/&gt;
[13] &lt;a href=&quot;http://en.wikipedia.org/wiki/Root_user&quot;&gt;http://en.wikipedia.org/wiki/Root_user&lt;/a&gt;&lt;br/&gt;
[14] &lt;a href=&quot;https://help.ubuntu.com/community/RootSudo&quot;&gt;https://help.ubuntu.com/community/RootSudo&lt;/a&gt;&lt;br/&gt;
[15] &lt;a href=&quot;http://couchdb.apache.org/community/index.html&quot;&gt;http://couchdb.apache.org/community/index.html&lt;/a&gt;&lt;br/&gt;
[16] &lt;a href=&quot;http://subversion.tigris.org/&quot;&gt;http://subversion.tigris.org/&lt;/a&gt;&lt;br/&gt;
[17] &lt;a href=&quot;http://en.wikipedia.org/wiki/Revision_control&quot;&gt;http://en.wikipedia.org/wiki/Revision_control&lt;/a&gt;&lt;br/&gt;
[18] &lt;a href=&quot;http://en.wikipedia.org/wiki/Bootstrapping_(computing)#Software_bootstrapping&quot;&gt;http://en.wikipedia.org/wiki/Bootstrapping_(computing)#Software_bootstrapping&lt;/a&gt;&lt;br/&gt;
[19] &lt;a href=&quot;http://sources.redhat.com/autobook/autobook/autobook_43.html#SEC43&quot;&gt;http://sources.redhat.com/autobook/autobook/autobook_43.html#SEC43&lt;/a&gt;&lt;br/&gt;
</description>
                <environment>trunk</environment>
            <key id="12426932">COUCHDB-373</key>
        <summary>./utils/run complains about non-existant directories</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 2 Jun 2009 15:00:24 +0000 (UTC)</created>
    <updated>Tue, 2 Jun 2009 15:00:24 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-372] update_notification broken with couchspawnkillable change</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-372</link>

                    <description>as of at least r780544, my update_notification cannot be launched by couchdb. I get this;&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB 0.10.0a780544 (LogLevel=info) is starting.&lt;br/&gt;
[error] [&amp;lt;0.49.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.49.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.49.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{bad_return_value,{os_process_error,{data,&amp;quot;kill -9 19883\n&amp;quot;}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,init_it,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{couch_os_process,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_db_update,couch_primary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.43.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,610},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,244}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,{{badmatch,{error,shutdown}},[{couch_server_sup,start_server,1},{erl_eval,do_apply,5},{erl_eval,exprs,5},{init,start_it,1},{init,start_em,1}]}}&lt;br/&gt;
&lt;br/&gt;
If I comment out the first line in src/couchdb/priv/couchspawnkillable my process is launched correctly but is then killed shortly afterwards by couch;&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB 0.10.0a780544 (LogLevel=info) is starting.&lt;br/&gt;
[couchdb-lucene] INFO indexer started.&lt;br/&gt;
[couchdb-lucene] INFO indexer stopped.&lt;br/&gt;
[error] [&amp;lt;0.49.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.49.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.49.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{bad_return_value,{os_process_error,&amp;quot;OS process timed out.&amp;quot;}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,init_it,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{couch_os_process,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_db_update,couch_primary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.43.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,610},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,244}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,{{badmatch,{error,shutdown}},[{couch_server_sup,start_server,1},{erl_eval,do_apply,5},{erl_eval,exprs,5},{init,start_it,1},{init,start_em,1}]}}&lt;br/&gt;
&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot ()&lt;br/&gt;
&lt;br/&gt;
real	0m5.769s&lt;br/&gt;
user	0m0.648s&lt;br/&gt;
sys	0m0.520s&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12426792">COUCHDB-372</key>
        <summary>update_notification broken with couchspawnkillable change</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Mon, 1 Jun 2009 01:47:15 +0000 (UTC)</created>
    <updated>Tue, 9 Jun 2009 00:59:09 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12714952" author="rnewson" created="Mon, 1 Jun 2009 02:09:58 +0000 (UTC)"  >davisp on IRC suggested this fix, which works for me;&lt;br/&gt;
&lt;br/&gt;
Index: src/couchdb/couch_db_update_notifier.erl&lt;br/&gt;
===================================================================&lt;br/&gt;
--- src/couchdb/couch_db_update_notifier.erl	(revision 780544)&lt;br/&gt;
+++ src/couchdb/couch_db_update_notifier.erl	(working copy)&lt;br/&gt;
@@ -37,7 +37,7 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;couch_event_sup:stop(Pid).&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;init(Exec) when is_list(Exec) -&amp;gt; % an exe&lt;br/&gt;
-    couch_os_process:start_link(Exec, [], [stream, exit_status, hide]);&lt;br/&gt;
+    couch_os_process:start_link(Exec, []);&lt;br/&gt;
&amp;nbsp;init(Else) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, Else}.&lt;br/&gt;
&amp;nbsp;</comment>
                    <comment id="12717507" author="paul.joseph.davis" created="Tue, 9 Jun 2009 00:59:09 +0000 (UTC)"  >Fixed with as of r782854.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Jun 2009 00:59:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Jun 2009 00:59:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-371] Need a way to limit memory used by a subprocess</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-371</link>

                    <description>We need a way to limit the total memory used by sub processes, such as a view process, so they can not use up all the available memory due to coding error or malicious attack. We can probably do this by setting ulimit in the couchspawnkillable script.&lt;br/&gt;
&lt;br/&gt;
-Damien</description>
                <environment></environment>
            <key id="12426745">COUCHDB-371</key>
        <summary>Need a way to limit memory used by a subprocess</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="damienkatz">Damien Katz</reporter>
            
    <created>Sat, 30 May 2009 18:07:08 +0000 (UTC)</created>
    <updated>Sat, 30 May 2009 18:07:08 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-370] If the CouchDB vm is dies or is killed, view subprocesses (js) are not automatically killed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-370</link>

                    <description>If CouchDB dies or is killed, it&apos;s subprocess are not forcefully killed. If the subprocesses are in infinite loops, they will never die. We need some kind of external watchdog process, or processes that kill the subprocess automatically if the CouchDB erlang vm dies.</description>
                <environment></environment>
            <key id="12426743">COUCHDB-370</key>
        <summary>If the CouchDB vm is dies or is killed, view subprocesses (js) are not automatically killed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="damienkatz">Damien Katz</reporter>
            
    <created>Sat, 30 May 2009 18:03:33 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 00:10:59 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12737848" author="mhammond" created="Sat, 1 Aug 2009 08:04:12 +0000 (UTC)"  >An option may be to upgrade couch_spawn_killable to detect its parent dieing and kill its child?</comment>
                    <comment id="12738079" author="kocolosk" created="Sun, 2 Aug 2009 13:28:56 +0000 (UTC)"  >Hi Mark, I think couchspawnkillable was supposed the solution to this ticket.</comment>
                    <comment id="12738141" author="mhammond" created="Sun, 2 Aug 2009 22:34:12 +0000 (UTC)"  >If I understand correctly, couchspawnkillable will terminate couch&apos;s children when couch explicitly asks, but should couch go away silently and suddenly these children may continue to exist.  While couch stopping would *usually* kill the child due to the child&apos;s stdin being closed, this would not be the case if the child process was in an infinite loop and didn&apos;t get back to trying to read stdin.</comment>
                    <comment id="12738340" author="kocolosk" created="Mon, 3 Aug 2009 13:37:31 +0000 (UTC)"  >Hi Mark, my take on the code in couch_os_process is that if the couch_os_process gen_server dies for any reason, another process which has been monitoring that gen_server swoops in and executes a kill -9 on the OS process.  This approach doesn&apos;t rely on stdin being read by the child proc.&lt;br/&gt;
&lt;br/&gt;
I could see a sudden Erlang VM death leading to an OS process being orphaned.  If that&apos;s happening I think we should focus our efforts on preventing the VM death :-), but if it&apos;s simple to do then having couchspawnkillable monitor the VM is also a good idea.</comment>
                    <comment id="12738390" author="damienkatz" created="Mon, 3 Aug 2009 15:32:04 +0000 (UTC)"  >While I agree we should prevent unnecessary VM exits, we can&apos;t prevent them all and fortunately the VM is designed to terminate and restart quickly. This is part of CouchDB&apos;s design too, restarts are always fast.&lt;br/&gt;
&lt;br/&gt;
A correct solution is one or more watchdog processes that watch the VM and the subprocess, and if the VM dies, it kills all the subprocesses and then itself.</comment>
                    <comment id="12738471" author="paul.joseph.davis" created="Mon, 3 Aug 2009 18:13:48 +0000 (UTC)"  >Is this something we can hook into heart to look at the process tree between restarts?&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://steve.vinoski.net/blog/2009/02/22/controlling-erlangs-heart/&quot;&gt;http://steve.vinoski.net/blog/2009/02/22/controlling-erlangs-heart/&lt;/a&gt;</comment>
                    <comment id="12738677" author="mhammond" created="Mon, 3 Aug 2009 23:26:15 +0000 (UTC)"  >Damien writes:&lt;br/&gt;
&amp;gt; A correct solution is one or more watchdog processes that watch the &lt;br/&gt;
&amp;gt; VM and the subprocess, and if the VM dies, it kills all the subprocesses and then itself.&lt;br/&gt;
&lt;br/&gt;
Exactly.  I was proposing couch_spawn_killable could serve the role of that watchdog - it can watch for its parent terminating, then terminate its child and then itself.  Although this isn&apos;t a *single* watchdog, it should have the same end result.</comment>
                    <comment id="12738697" author="paul.joseph.davis" created="Tue, 4 Aug 2009 00:10:59 +0000 (UTC)"  >Is it possible to make couchspawnkillable watch for the parent process death without introducing a new process into the mix? The *nix variant is a simple shell script that exec&apos;s and I&apos;d be a tad remiss to make it more complicated. It also seems awfully recursive otherwise. Not to mention that we&apos;d be doubling the number of OS level processes used.&lt;br/&gt;
&lt;br/&gt;
My vote would still be for using heart if possible.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 1 Aug 2009 08:04:12 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-369] Views ain&apos;t listed in &quot;select view&quot; when using Opera.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-369</link>

                    <description>I discovered that views ain&apos;t displayed when using Opera.&lt;br/&gt;
Demo: &lt;a href=&quot;http://img507.imageshack.us/img507/3910/couchdbfutonbugoperaj.png&quot;&gt;http://img507.imageshack.us/img507/3910/couchdbfutonbugoperaj.png&lt;/a&gt;</description>
                <environment></environment>
            <key id="12426739">COUCHDB-369</key>
        <summary>Views ain&apos;t listed in &quot;select view&quot; when using Opera.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="wildchild">Alexander Uvarov</reporter>
            
    <created>Sat, 30 May 2009 15:48:46 +0000 (UTC)</created>
    <updated>Tue, 21 Jul 2009 10:12:39 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12714735" author="wildchild" created="Sat, 30 May 2009 15:51:01 +0000 (UTC)"  >Patch fixing a bug.</comment>
                    <comment id="12733565" author="janl" created="Tue, 21 Jul 2009 10:12:39 +0000 (UTC)"  >applied in r796234.</comment>
                </comments>
    
    <attachments>
            <attachment id="12409468" name="futon_list_views_opera.diff" size="900" author="wildchild" created="Sat, 30 May 2009 15:51:01 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 10:12:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 10:12:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-368] Refactoring of jquery.couch.js</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-368</link>

                    <description>When I dived into jquery.couch.js, I saw a lot of repetitions, I tried to refactor it a little bit, centralizing all (but one) $.ajax into one place (called ajax).&lt;br/&gt;
&lt;br/&gt;
Before:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;allDbs: function(options) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;options = options || {};&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$.ajax({&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;type: &amp;quot;GET&amp;quot;, url: &amp;quot;/_all_dbs&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;complete: function(req) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var resp = $.httpData(req, &amp;quot;json&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (req.status == 200) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (options.success) options.success(resp);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} else if (options.error) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;options.error(req.status, resp.error, resp.reason);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} else {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;alert(&amp;quot;An error occurred retrieving the list of all databases: &amp;quot; +&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;resp.reason);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;});&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;},&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
After:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;allDbs: function(options) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ajax(&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{url: &amp;quot;/_all_dbs&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;options,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;An error occurred retrieving the list of all databases&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
Cheers,&lt;br/&gt;
&lt;br/&gt;
-- &lt;br/&gt;
Yoan</description>
                <environment>{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a780214&amp;quot;}</environment>
            <key id="12426732">COUCHDB-368</key>
        <summary>Refactoring of jquery.couch.js</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="greut">Yoan Blanc</reporter>
            
    <created>Sat, 30 May 2009 10:54:15 +0000 (UTC)</created>
    <updated>Tue, 21 Jul 2009 10:03:22 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12714692" author="greut" created="Sat, 30 May 2009 10:57:44 +0000 (UTC)"  >Patch and new file.</comment>
                    <comment id="12733561" author="janl" created="Tue, 21 Jul 2009 10:03:22 +0000 (UTC)"  >Applied in in r796228.</comment>
                </comments>
    
    <attachments>
            <attachment id="12409457" name="COUCHDB-368.jquery.couch.js.patch" size="16848" author="greut" created="Sat, 30 May 2009 10:57:44 +0000 (UTC)" />
            <attachment id="12409458" name="jquery.couch.js" size="9043" author="greut" created="Sat, 30 May 2009 10:57:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 10:03:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 10:03:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-367] CouchDB caching attachments that have been overwritten</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-367</link>

                    <description>I created a document with an image file as an attachment, then replaced the attachment with a different image. CouchDB still serves the older image instead of the replacement.&lt;br/&gt;
&lt;br/&gt;
Steps to recreate:&lt;br/&gt;
1. Create a new document.&lt;br/&gt;
2. Using Futon, upload an image called &amp;quot;test.jpg&amp;quot; as an attachment to the document.&lt;br/&gt;
3. View the attachment to confirm that it&apos;s uploaded correctly.&lt;br/&gt;
4. Back in Futon, upload a different image with the same filename (&amp;quot;test.jpg&amp;quot;) as an attachment to the document. Futon will correctly report the size of the new attachment.&lt;br/&gt;
5. View the attachment - you will still see the image from step 2.&lt;br/&gt;
6. View the attachment in a different web browser, to make sure it&apos;s not just browser caching. You will still see the image from step 2 instead of the newer one.&lt;br/&gt;
&lt;br/&gt;
BTW I came across this because I was doing some experiments to see whether CouchDB would keep the attachment revision history for me. So if the above is the wrong way to create a new version of an attachment, I apologise now!</description>
                <environment>64-bit Linux (Fedora 11) 2.6.29.4-162.fc11.x86_64 #1 SMP&lt;br/&gt;
Erlang (BEAM) emulator version 5.6.5 [source] [64-bit] [smp:4] [async-threads:0] [hipe] [kernel-poll:false]&lt;br/&gt;
CouchDB 0.9.0 (installed from the yum packages)&lt;br/&gt;
</environment>
            <key id="12426668">COUCHDB-367</key>
        <summary>CouchDB caching attachments that have been overwritten</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="vilyah">Vilya Harvey</reporter>
            
    <created>Fri, 29 May 2009 12:42:34 +0000 (UTC)</created>
    <updated>Fri, 29 May 2009 12:42:34 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-366] Error Uploading Attachment</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-366</link>

                    <description>20:21 &amp;lt;davisp&amp;gt; damienkatz: uploading a large attachment ends up&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throwing a function_clause error on split_iolist and&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;the parameter types are binary(), int(), [binary()]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Traceback attached</description>
                <environment>Ubuntu 8.04, CouchDB Trunk rev 779803</environment>
            <key id="12426638">COUCHDB-366</key>
        <summary>Error Uploading Attachment</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="bbrowning">Ben Browning</reporter>
            
    <created>Fri, 29 May 2009 00:34:20 +0000 (UTC)</created>
    <updated>Fri, 29 May 2009 12:31:56 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12714250" author="bbrowning" created="Fri, 29 May 2009 01:05:47 +0000 (UTC)"  >&lt;br/&gt;
CouchApp that produces the error</comment>
                    <comment id="12714256" author="paul.joseph.davis" created="Fri, 29 May 2009 01:30:14 +0000 (UTC)"  >Patch by Damien appears to fix the issue.&lt;br/&gt;
&lt;br/&gt;
Index: src/couchdb/couch_stream.erl&lt;br/&gt;
===================================================================&lt;br/&gt;
--- src/couchdb/couch_stream.erl	(revision 778521)&lt;br/&gt;
+++ src/couchdb/couch_stream.erl	(working copy)&lt;br/&gt;
@@ -102,7 +102,7 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;buffer_list = Buffer,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;max_buffer = Max} = Stream,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if BinSize + BufferLen &amp;gt; Max -&amp;gt;&lt;br/&gt;
-        {ok, Pos} = couch_file:append_binary(Fd, lists:reverse(Buffer, Bin)),&lt;br/&gt;
+        {ok, Pos} = couch_file:append_binary(Fd, lists:reverse(Buffer, [Bin])),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reply, ok, Stream#stream{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;written_len=WrittenLen + BufferLen + BinSize,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;written_pointers=[Pos|Written],</comment>
                    <comment id="12714276" author="bbrowning" created="Fri, 29 May 2009 02:25:50 +0000 (UTC)"  >&lt;br/&gt;
Attached javascript test case to reproduce the error</comment>
                </comments>
    
    <attachments>
            <attachment id="12409330" name="attachment_traceback.txt" size="156144" author="bbrowning" created="Fri, 29 May 2009 00:35:47 +0000 (UTC)" />
            <attachment id="12409332" name="bespin.zip" size="4688395" author="bbrowning" created="Fri, 29 May 2009 01:05:47 +0000 (UTC)" />
            <attachment id="12409334" name="couchdb-366-test.patch" size="43433" author="bbrowning" created="Fri, 29 May 2009 02:25:50 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 29 May 2009 12:31:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 29 May 2009 01:30:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-365] Replication hangs and won&apos;t restart</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-365</link>

                    <description>Partway through a replication I get this:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;json_encode&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{bad_term,{couch_rep,&apos;-memory_footprint/1-fun-0-&apos;,2}}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
as the response from the replication request. Attempting to restart replication results in:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[info] [&amp;lt;0.5511.0&amp;gt;] replication &amp;quot;1f78d088910dc73016c0b16b2fb84aac&amp;quot; already running at &amp;lt;0.4203.0&amp;gt;&lt;br/&gt;
&lt;br/&gt;
but the replication has hung.</description>
                <environment>Replicate to Ubuntu from OSX, both running R13B</environment>
            <key id="12426632">COUCHDB-365</key>
        <summary>Replication hangs and won&apos;t restart</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="antonyblakey">Antony Blakey</reporter>
            
    <created>Thu, 28 May 2009 21:50:56 +0000 (UTC)</created>
    <updated>Sat, 17 Oct 2009 13:59:05 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12714195" author="antonyblakey" created="Thu, 28 May 2009 22:17:39 +0000 (UTC)"  >After this happens, I get repeated hangs with the log showing this:&lt;br/&gt;
&lt;br/&gt;
[debug] [&amp;lt;0.89.0&amp;gt;] Attachment URL &lt;a href=&quot;http://localhost:5985/acumen-curricula/c16669078d5349503423e44095de25a3/Eng3MainIdea.pdf?rev=31-3046362463&quot;&gt;http://localhost:5985/acumen-curricula/c16669078d5349503423e44095de25a3/Eng3MainIdea.pdf?rev=31-3046362463&lt;/a&gt;&lt;br/&gt;
[debug] [&amp;lt;0.89.0&amp;gt;] streaming attachment Status &amp;quot;200&amp;quot; Headers [{&amp;quot;Transfer-Encoding&amp;quot;,&amp;quot;chunked&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Server&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;CouchDB/0.10.0a (Erlang OTP/R13B)&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;ETag&amp;quot;,&amp;quot;\&amp;quot;31-3046362463\&amp;quot;&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Date&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Thu, 28 May 2009 22:11:11 GMT&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Content-Type&amp;quot;,&amp;quot;application/pdf&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Cache-Control&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;must-revalidate&amp;quot;}]&lt;br/&gt;
[debug] [&amp;lt;0.89.0&amp;gt;] ProcessMem 56738000 BinaryMem 24014824&lt;br/&gt;
[debug] [&amp;lt;0.89.0&amp;gt;] ProcessMem 32203508 BinaryMem 2156534&lt;br/&gt;
&lt;br/&gt;
but each time at a different point. This may well be unrelated, but I&apos;m not sure.&lt;br/&gt;
</comment>
                    <comment id="12714200" author="antonyblakey" created="Thu, 28 May 2009 22:25:15 +0000 (UTC)"  >And after a few of those, I get this error after a restart, which cannot be proceeded beyond without further restarts of couchdb. It seems random whether it will continue on to the previous error, or immediately crapout with this one.&lt;br/&gt;
&lt;br/&gt;
[debug] [&amp;lt;0.125.0&amp;gt;] &apos;POST&apos; /_replicate {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;102&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;curl/7.18.0 (i486-pc-linux-gnu) libcurl/7.18.0 OpenSSL/0.9.8g zlib/1.2.3.3 libidn/1.1&amp;quot;}]&lt;br/&gt;
[debug] [&amp;lt;0.137.0&amp;gt;] couch_rep HTTP get request: &lt;a href=&quot;http://localhost:5985/acumen-curricula/&quot;&gt;http://localhost:5985/acumen-curricula/&lt;/a&gt;&lt;br/&gt;
[error] [&amp;lt;0.137.0&amp;gt;] {error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.137.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{initial_call,{couch_rep,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{pid,&amp;lt;0.137.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{badarg,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{erlang,list_to_existing_atom,[&amp;quot;db_name&amp;quot;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-get_db_info/1-lc$^0/1-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_db_info,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,init,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,init_it,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,init_it,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_rep_sup,couch_primary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.42.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,987},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,24},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,679}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
[error] [&amp;lt;0.125.0&amp;gt;] Uncaught error in HTTP request: {error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{case_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badarg,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{erlang,list_to_existing_atom,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;db_name&amp;quot;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-get_db_info/1-lc$^0/1-0-&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_db_info,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,init,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,init_it,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;1f78d088910dc73016c0b16b2fb84aac&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,start_link,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_rep,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;1f78d088910dc73016c0b16b2fb84aac&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{remote,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://localhost:5985/acumen-curricula/&quot;&gt;http://localhost:5985/acumen-curricula/&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{remote,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;&lt;a href=&quot;http://localhost:5984/acumen-curricula/&quot;&gt;http://localhost:5984/acumen-curricula/&lt;/a&gt;&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;transient,1,worker,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_rep]}}}}}&lt;br/&gt;
[info] [&amp;lt;0.125.0&amp;gt;] Stacktrace: [{couch_rep,replicate,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_misc_handlers,handle_replicate_req,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]&lt;br/&gt;
[debug] [&amp;lt;0.125.0&amp;gt;] httpd 500 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;case_clause&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{error,{{badarg,[{erlang,list_to_existing_atom,[\&amp;quot;db_name\&amp;quot;]},\n                 {couch_rep,&apos;-get_db_info/1-lc$^0/1-0-&apos;,1},\n                 {couch_rep,get_db_info,1},\n                 {couch_rep,init,1},\n                 {gen_server,init_it,6},\n                 {proc_lib,init_p_do_apply,3}]},\n        {child,undefined,\&amp;quot;1f78d088910dc73016c0b16b2fb84aac\&amp;quot;,\n               {gen_server,start_link,\n                           [couch_rep,\n                            [\&amp;quot;1f78d088910dc73016c0b16b2fb84aac\&amp;quot;,\n                             {remote,&amp;lt;&amp;lt;\&amp;quot;&lt;a href=&quot;http://localhost:5985/acumen-curricula/&quot;&gt;http://localhost:5985/acumen-curricula/&lt;/a&gt;\&amp;quot;&amp;gt;&amp;gt;,\n                                     []},\n                             {remote,&amp;lt;&amp;lt;\&amp;quot;&lt;a href=&quot;http://localhost:5984/acumen-curricula/&quot;&gt;http://localhost:5984/acumen-curricula/&lt;/a&gt;\&amp;quot;&amp;gt;&amp;gt;,\n                                     []}],\n                            []]},\n               transient,1,worker,\n               [couch_rep]}}}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.125.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /_replicate 500&lt;br/&gt;
</comment>
                    <comment id="12714210" author="antonyblakey" created="Thu, 28 May 2009 22:54:54 +0000 (UTC)"  >The immediately preceding problem doesn&apos;t occur/goes away if I make a different request first, such as a futon request. If however I start couchdb and then make a replication request, it always fails with the above error,</comment>
                    <comment id="12714294" author="antonyblakey" created="Fri, 29 May 2009 04:13:57 +0000 (UTC)"  >The original error is in this code:&lt;br/&gt;
&lt;br/&gt;
should_flush(_DocCount) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;MeAndMyLinks = [self()|&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[P || P &amp;lt;- element(2,process_info(self(),links)), is_pid(P)]],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case length(MeAndMyLinks)/2 &amp;gt; ?BUFFER_NATTACHMENTS of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;true -&amp;gt; true;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;false -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case memory_footprint(MeAndMyLinks) &amp;gt; 2*?BUFFER_MEMORY of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;true -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[garbage_collect(Pid) || Pid &amp;lt;- MeAndMyLinks],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;memory_footprint(MeAndMyLinks) &amp;gt; ?BUFFER_MEMORY;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;false -&amp;gt; false&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end.&lt;br/&gt;
&lt;br/&gt;
The problem being that the second time memory_footprint is called the elements of MeAndMyLinks may not be valid because of the preceding garbage_collect.&lt;br/&gt;
&lt;br/&gt;
I fixed this by replacing that second call by this:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;memory_footprint([self()| [P || P &amp;lt;- element(2,process_info(self(),links)), is_pid(P)]]) &amp;gt; ?BUFFER_MEMORY;</comment>
                    <comment id="12714305" author="kocolosk" created="Fri, 29 May 2009 05:40:09 +0000 (UTC)"  >Thanks, Antony.  The second problem you encountered is due to the use of list_to_existing_atom/1.  I replaced it with plain-old list_to_atom.&lt;br/&gt;
&lt;br/&gt;
Instead of recalculating the &amp;quot;MeAndMyLinks&amp;quot; list every time, I added some guards to memory_footprint so that it doesn&apos;t try to call process_info with a dead Pid.  Hopefully this resolves the issue.</comment>
                    <comment id="12766916" author="kocolosk" created="Sat, 17 Oct 2009 13:59:05 +0000 (UTC)"  >We stopped using this code path anyway.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 17 Oct 2009 13:59:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 29 May 2009 05:40:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-364] Badly formed bulk insert returns an invalid HTTP response</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-364</link>

                    <description>Trying to do a bulk update via /database/_bulk_docs and passing any unexpected JSON value as the body (i.e. anything other than a map with the key &amp;quot;docs&amp;quot; containing the list of documents) causes CouchDB to return an empty response. I guess it should be returning an error message describing the problem in this case?&lt;br/&gt;
&lt;br/&gt;
For example, this works correctly and returns the list of inserted documents:&lt;br/&gt;
curl -X POST -d &apos;{ &amp;quot;docs&amp;quot;: [{&amp;quot;name&amp;quot;: &amp;quot;Fred&amp;quot;}, {&amp;quot;name&amp;quot;: &amp;quot;Bruce&amp;quot;}] }&apos; &lt;a href=&quot;http://localhost:5984/scans/_bulk_docs&quot;&gt;http://localhost:5984/scans/_bulk_docs&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
But this fails with the error message as below:&lt;br/&gt;
curl -X POST -d &apos;[{&amp;quot;name&amp;quot;: &amp;quot;Fred&amp;quot;}, {&amp;quot;name&amp;quot;: &amp;quot;Bruce&amp;quot;}]&apos; &lt;a href=&quot;http://localhost:5984/scans/_bulk_docs&quot;&gt;http://localhost:5984/scans/_bulk_docs&lt;/a&gt;&lt;br/&gt;
curl: (52) Empty reply from server&lt;br/&gt;
&lt;br/&gt;
(the difference being that the second is just passing through a list of documents, leaving out the { &amp;quot;docs&amp;quot;: ... } wrapper).</description>
                <environment>Linux 2.6.29.4-162.fc11.x86_64 (Fedora 11)&lt;br/&gt;
Erlang (BEAM) emulator version 5.6.5 [source] [64-bit] [smp:4] [async-threads:0] [hipe] [kernel-poll:false] with OTP R12B&lt;br/&gt;
CouchDB 0.9.0</environment>
            <key id="12426626">COUCHDB-364</key>
        <summary>Badly formed bulk insert returns an invalid HTTP response</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="vilyah">Vilya Harvey</reporter>
            
    <created>Thu, 28 May 2009 20:55:42 +0000 (UTC)</created>
    <updated>Thu, 28 May 2009 21:24:27 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12714183" author="paul.joseph.davis" created="Thu, 28 May 2009 21:24:27 +0000 (UTC)"  >Pretty sure this is a duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-306&quot; title=&quot;Wacky error responses to malformed documents&quot;&gt;&lt;strike&gt;COUCHDB-306&lt;/strike&gt;&lt;/a&gt; which is fixed in trunk. If you can reproduce this on trunk please reopen.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 28 May 2009 21:24:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 28 May 2009 21:24:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-363] can&apos;t POST to an external</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-363</link>

                    <description>Trying to post to an external and get error 500 :&lt;br/&gt;
&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;application/json, text/javascript, */*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Charset&apos;,&amp;quot;ISO-8859-1,utf-8;q=0.7,*;q=0.7&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip,deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Language&apos;,&amp;quot;en-us,en;q=0.5&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Cache-Control&apos;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Connection&apos;,&amp;quot;keep-alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;59&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded; charset=UTF-8&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Keep-Alive&apos;,&amp;quot;300&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Pragma&apos;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Referer&apos;,&amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/friendpaste/_design/fp/index.html&quot;&gt;http://127.0.0.1:5984/friendpaste/_design/fp/index.html&lt;/a&gt;&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.0.10) Gecko/2009042315 Firefox/3.0.10&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;X-Requested-With&amp;quot;,&amp;quot;XMLHttpRequest&amp;quot;}]&lt;br/&gt;
[error] [&amp;lt;0.60.0&amp;gt;] Uncaught error in HTTP request: {error,function_clause}&lt;br/&gt;
[info] [&amp;lt;0.60.0&amp;gt;] Stacktrace: [{mochiweb_util,parse_qs_key,[undefined,[]]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_util,parse_qs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_external,json_req_obj,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_external,process_external_req,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]&lt;br/&gt;
[debug] [&amp;lt;0.60.0&amp;gt;] httpd 500 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;function_clause&amp;quot;}</description>
                <environment></environment>
            <key id="12426403">COUCHDB-363</key>
        <summary>can&apos;t POST to an external</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 26 May 2009 23:42:55 +0000 (UTC)</created>
    <updated>Wed, 27 May 2009 01:18:41 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12713344" author="benoitc" created="Wed, 27 May 2009 00:46:25 +0000 (UTC)"  >patch that solve this issue</comment>
                    <comment id="12713361" author="paul.joseph.davis" created="Wed, 27 May 2009 01:18:41 +0000 (UTC)"  >Fixed with patch supplied by Benoit.</comment>
                </comments>
    
    <attachments>
            <attachment id="12409104" name="couch_httpd_external.diff" size="513" author="benoitc" created="Wed, 27 May 2009 00:46:25 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 27 May 2009 01:18:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 27 May 2009 01:18:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-362] Malformed _attachments gives 500 and function_clause error</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-362</link>

                    <description>Creating a document with bad format of the _attachments structure gives a 500 error and Erlang function_clause exceptions.&lt;br/&gt;
&lt;br/&gt;
---- example 1 ----&lt;br/&gt;
require &apos;rubygems&apos;&lt;br/&gt;
require &apos;restclient&apos;&lt;br/&gt;
require &apos;json&apos;&lt;br/&gt;
&lt;br/&gt;
DB=&amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&amp;quot;&lt;br/&gt;
RestClient.delete DB rescue nil&lt;br/&gt;
RestClient.put DB, {}.to_json&lt;br/&gt;
&lt;br/&gt;
doc = {&amp;quot;_id&amp;quot;=&amp;gt;&amp;quot;test&amp;quot;,&amp;quot;hello&amp;quot;=&amp;gt;&amp;quot;world&amp;quot;,&amp;quot;_attachments&amp;quot;=&amp;gt;{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;foo&amp;quot;=&amp;gt;[&amp;quot;This is a test&amp;quot;].pack(&amp;quot;m&amp;quot;),&lt;br/&gt;
}}&lt;br/&gt;
puts RestClient.post(&amp;quot;#{DB}/_bulk_docs&amp;quot;, {&apos;docs&apos;=&amp;gt;[doc],&apos;all_or_nothing&apos;=&amp;gt;true}.to_json)&lt;br/&gt;
&lt;br/&gt;
This aborts with 500 and logs:&lt;br/&gt;
&lt;br/&gt;
[Tue, 26 May 2009 10:14:53 GMT] [error] [&amp;lt;0.98.0&amp;gt;] Uncaught error in HTTP request: {error,function_clause}&lt;br/&gt;
&lt;br/&gt;
[Tue, 26 May 2009 10:14:53 GMT] [info] [&amp;lt;0.98.0&amp;gt;] Stacktrace: [{couch_doc,&apos;-transfer_fields/2-fun-0-&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&amp;lt;&amp;lt;&amp;quot;foo&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;VGhpcyBpcyBhIHRlc3Q=\n&amp;quot;&amp;gt;&amp;gt;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,flatmap,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_doc,transfer_fields,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,&apos;-db_req/2-fun-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,map,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,5}]&lt;br/&gt;
&lt;br/&gt;
[Tue, 26 May 2009 10:14:53 GMT] [info] [&amp;lt;0.98.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /test/_bulk_docs 500&lt;br/&gt;
&lt;br/&gt;
---- example 2 ----&lt;br/&gt;
require &apos;rubygems&apos;&lt;br/&gt;
require &apos;restclient&apos;&lt;br/&gt;
require &apos;json&apos;&lt;br/&gt;
&lt;br/&gt;
DB=&amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&amp;quot;&lt;br/&gt;
RestClient.delete DB rescue nil&lt;br/&gt;
RestClient.put DB, {}.to_json&lt;br/&gt;
&lt;br/&gt;
doc = {&amp;quot;_id&amp;quot;=&amp;gt;&amp;quot;test&amp;quot;,&amp;quot;hello&amp;quot;=&amp;gt;&amp;quot;world&amp;quot;,&amp;quot;_attachments&amp;quot;=&amp;gt;{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;foo&amp;quot;=&amp;gt;{&amp;quot;content_type&amp;quot;=&amp;gt;&amp;quot;text/plain&amp;quot;,&amp;quot;data&amp;quot;=&amp;gt;[&amp;quot;This is a test&amp;quot;].pack(&amp;quot;m&amp;quot;)},&lt;br/&gt;
}}&lt;br/&gt;
puts RestClient.post(&amp;quot;#{DB}/_bulk_docs&amp;quot;, {&apos;docs&apos;=&amp;gt;[doc],&apos;all_or_nothing&apos;=&amp;gt;true}.to_json)&lt;br/&gt;
&lt;br/&gt;
This also aborts with 500 and logs:&lt;br/&gt;
&lt;br/&gt;
[Tue, 26 May 2009 10:16:10 GMT] [error] [&amp;lt;0.199.0&amp;gt;] Uncaught error in HTTP request: {error,function_clause}&lt;br/&gt;
&lt;br/&gt;
[Tue, 26 May 2009 10:16:10 GMT] [info] [&amp;lt;0.199.0&amp;gt;] Stacktrace: [{couch_util,decode1,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;&amp;lt;&amp;quot;\n&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;84,104,105,115,32,105,115,32,97,32,116,101,115,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,1&amp;gt;&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_doc,&apos;-transfer_fields/2-fun-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,flatmap,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_doc,transfer_fields,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,&apos;-db_req/2-fun-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,map,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2}]&lt;br/&gt;
&lt;br/&gt;
[Tue, 26 May 2009 10:16:10 GMT] [info] [&amp;lt;0.199.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /test/_bulk_docs 500&lt;br/&gt;
&lt;br/&gt;
In this case, it seems only that the trailing newline in the base64 representation is causing the error (adding a &apos;chomp&apos; makes the program work). But it&apos;s not exactly a helpful error message.&lt;br/&gt;
</description>
                <environment>{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a778641&amp;quot;}&lt;br/&gt;
</environment>
            <key id="12426337">COUCHDB-362</key>
        <summary>Malformed _attachments gives 500 and function_clause error</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Tue, 26 May 2009 10:20:44 +0000 (UTC)</created>
    <updated>Thu, 28 May 2009 19:37:12 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12714126" author="janl" created="Thu, 28 May 2009 19:37:12 +0000 (UTC)"  >Good one. Can you try and provide a JS-based testcase? It&apos;d make fixing easier and faster. Thanks! :)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 28 May 2009 19:37:12 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-361] [PATCH] Updating README to match current experience of installing on OSX</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-361</link>

                    <description>The README is no longer accurate for installation on OSX. This patch should make it a tad easier</description>
                <environment></environment>
            <key id="12426313">COUCHDB-361</key>
        <summary>[PATCH] Updating README to match current experience of installing on OSX</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="lachlanhardy">Lachlan Hardy</reporter>
            
    <created>Tue, 26 May 2009 01:41:48 +0000 (UTC)</created>
    <updated>Tue, 26 May 2009 01:55:02 +0000 (UTC)</updated>

                
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12712829" author="nslater" created="Tue, 26 May 2009 01:55:02 +0000 (UTC)"  >Please address my comments on the mailing list if you wish to reopen.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12408979" name="README.patch" size="1680" author="lachlanhardy" created="Tue, 26 May 2009 01:42:36 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 26 May 2009 01:55:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 26 May 2009 01:55:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-360] Add global _changes feature</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-360</link>

                    <description>Add a global version of _changes to allow monitoring of changes to all databases. It does not need to include details of the change as clients of this interface must track update sequences for each database anyway.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12426311">COUCHDB-360</key>
        <summary>Add global _changes feature</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Mon, 25 May 2009 23:27:34 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:27:57 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12712814" author="rnewson" created="Mon, 25 May 2009 23:28:11 +0000 (UTC)"  >&lt;br/&gt;
Write a JSON line whenever a database changes as;&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;db&amp;quot;:&amp;quot;DB_NAME&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12712815" author="rnewson" created="Mon, 25 May 2009 23:29:57 +0000 (UTC)"  >Hook it up with;&lt;br/&gt;
&lt;br/&gt;
[httpd_global_handlers]&lt;br/&gt;
_changes = {couch_httpd_misc_handlers, handle_changes_req}&lt;br/&gt;
</comment>
                    <comment id="12733320" author="thisfred" created="Mon, 20 Jul 2009 19:04:31 +0000 (UTC)"  >I would really like to have a global _changes feed, as I anticipate having a lot of databases to deal with in a similar manner. One question though: Is it impossible, or inefficient to include more details of the changes? I would really like to at least optionally have the same information available as the per db _changes feed exposes.  </comment>
                    <comment id="12749499" author="rnewson" created="Mon, 31 Aug 2009 13:47:17 +0000 (UTC)"  >&lt;br/&gt;
Updated patch, never exits but does send type and db.</comment>
                    <comment id="12757833" author="benoitc" created="Mon, 21 Sep 2009 07:28:19 +0000 (UTC)"  >new patch for global change handler. It manage longpolling and continuous (set feed=continuous, default is longpoll). &lt;br/&gt;
&lt;br/&gt;
Each change send a line &lt;br/&gt;
&lt;br/&gt;
{&amp;quot;type&amp;quot;: &amp;quot;typeofchange&amp;quot;, &amp;quot;db&amp;quot;: &amp;quot;nameof db&amp;quot;, &amp;quot;seq&amp;quot;: &amp;quot;updated seq in db&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
you could also do jsonp.</comment>
                    <comment id="12757857" author="benoitc" created="Mon, 21 Sep 2009 09:27:51 +0000 (UTC)"  >updated patch with tests and fix for line changes (prepend by &amp;quot;\n&amp;quot; when needed).</comment>
                    <comment id="12757866" author="benoitc" created="Mon, 21 Sep 2009 11:03:11 +0000 (UTC)"  >following jan suggestion renamed keep_sending_changes to keep_sending_dbs_changes to avoid confusion with couch_httpd_db:keep_sending_changes. Also removed 2 useless debug messages.</comment>
                    <comment id="12757871" author="benoitc" created="Mon, 21 Sep 2009 11:41:37 +0000 (UTC)"  >I forgot to handle deleted event. This patch add support for this. Also we make sure we get all events notified.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12434649">COUCHDB-494</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12420170" name="db_changes.patch" size="4723" author="benoitc" created="Mon, 21 Sep 2009 07:28:19 +0000 (UTC)" />
            <attachment id="12420174" name="db_changes2.patch" size="9598" author="benoitc" created="Mon, 21 Sep 2009 09:27:51 +0000 (UTC)" />
            <attachment id="12420182" name="db_changes3.patch" size="9522" author="benoitc" created="Mon, 21 Sep 2009 11:03:11 +0000 (UTC)" />
            <attachment id="12420184" name="db_changes4.patch" size="10084" author="benoitc" created="Mon, 21 Sep 2009 11:41:37 +0000 (UTC)" />
            <attachment id="12418146" name="global_changes.patch" size="1869" author="rnewson" created="Mon, 31 Aug 2009 13:47:17 +0000 (UTC)" />
            <attachment id="12408974" name="global_changes.patch" size="1117" author="rnewson" created="Mon, 25 May 2009 23:28:11 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 20 Jul 2009 19:04:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-359] group_level should be rejected when a single key is specified</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-359</link>

                    <description>As noted in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-357&quot; title=&quot;group_level fails for multi-key reduce view&quot;&gt;&lt;strike&gt;COUCHDB-357&lt;/strike&gt;&lt;/a&gt;, couch correctly rejects a multikey fetch when group_level is specified (although the error message is misleading).  group_level should be similarly rejected when a single-key fetch is used - currently is is accepted but returns incorrect results.</description>
                <environment></environment>
            <key id="12426264">COUCHDB-359</key>
        <summary>group_level should be rejected when a single key is specified</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Mon, 25 May 2009 01:42:36 +0000 (UTC)</created>
    <updated>Mon, 25 May 2009 01:43:18 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12426171">COUCHDB-357</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-358] make install not creating {$prefix}/var/run/couchdb on RHEL5/OSX</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-358</link>

                    <description>Installing CouchDB from trunk on RHEL5 (and OSX) failed to create the {$prefix}/var/run/couchdb dir, necessitating manual creation and chown&apos;ing. This directory is needed when running in background.&lt;br/&gt;
</description>
                <environment>RHEL5 / OSX</environment>
            <key id="12426241">COUCHDB-358</key>
        <summary>make install not creating {$prefix}/var/run/couchdb on RHEL5/OSX</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="sho">Sho Fukamachi</reporter>
            
    <created>Sun, 24 May 2009 12:03:18 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:58 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772667" author="kocolosk" created="Mon, 2 Nov 2009 20:39:58 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:39:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-357] group_level fails for multi-key reduce view</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-357</link>

                    <description>If you try and execute a multi-key reduce view with a group_level param, could returns a query parser error with message &apos;&amp;quot;Multi-key fetchs for reduce view must include `group=true`&amp;quot;.  The error persists if you add that param.  The problem appears to be that couch_httpd_view.erl is only checking for &apos;exact&apos; grouping, not an integer level.  Attaching a patch; thanks to Paul Davis for the direction...</description>
                <environment></environment>
            <key id="12426171">COUCHDB-357</key>
        <summary>group_level fails for multi-key reduce view</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Sat, 23 May 2009 06:11:50 +0000 (UTC)</created>
    <updated>Mon, 25 May 2009 01:43:18 +0000 (UTC)</updated>

                
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12712364" author="mhammond" created="Sat, 23 May 2009 06:13:35 +0000 (UTC)"  >testcase and patch</comment>
                    <comment id="12712383" author="mhammond" created="Sat, 23 May 2009 08:31:29 +0000 (UTC)"  >I also meant to change the error message to be less misleading when group_level was supplied - something like &amp;quot;Multi-key fetchs for reduce view must include `group=true` or a `group_level`&amp;quot;</comment>
                    <comment id="12712622" author="paul.joseph.davis" created="Mon, 25 May 2009 01:29:40 +0000 (UTC)"  >Given the set of keys: [1, 0] [1, 1] [1, 2] and a group_level=1 then we&apos;d need to provide the equivalent of key=[1] but this will fail during reduction because startkey=[1]&amp;amp;endkey=[1] (the equivalent of specifying key=[1]) will select no keys.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12426264">COUCHDB-359</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12408871" name="issue-357.patch" size="1319" author="mhammond" created="Sat, 23 May 2009 06:13:35 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 25 May 2009 01:29:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 25 May 2009 01:29:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-356] batch=ok should take a wait=true option</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-356</link>

                    <description>This would hold the connection to the client until the document has been committed, instead of returning immediately with a 202 Accepted</description>
                <environment></environment>
            <key id="12426149">COUCHDB-356</key>
        <summary>batch=ok should take a wait=true option</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Fri, 22 May 2009 20:44:06 +0000 (UTC)</created>
    <updated>Tue, 22 Dec 2009 17:48:31 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12793224" author="fdmanana" created="Mon, 21 Dec 2009 15:01:06 +0000 (UTC)"  >Hello,&lt;br/&gt;
&lt;br/&gt;
What&apos;s the advantage of the wait=true option? Isn&apos;t it the same as not supplying the batch=ok option? &lt;br/&gt;
&lt;br/&gt;
that is,&lt;br/&gt;
PUT /somedb/doc?batch=ok&amp;amp;wait=true &amp;lt;=&amp;gt; PUT /somedb/doc  ?&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12793249" author="jchris" created="Mon, 21 Dec 2009 16:22:58 +0000 (UTC)"  >This is actually a bit outdated as we have a new batch infra based on Damien&apos;s parallel writers patch.&lt;br/&gt;
&lt;br/&gt;
Essentially we are always running batch=ok&amp;amp;wait=true now. Only we do the batching at the file-write level, not in an in-memory data structure.&lt;br/&gt;
&lt;br/&gt;
I think it&apos;s worth reevaluating the batch API for 0.11</comment>
                    <comment id="12793258" author="paul.joseph.davis" created="Mon, 21 Dec 2009 16:44:58 +0000 (UTC)"  >FWIW, Robert Newson pointed out that the batch writer API doesn&apos;t minimize writes like the batch api did which ends up resulting in larger database files due to more writes. Plus unless I&apos;m mistaken the new write merging won&apos;t speed up the single client case, just when multiple writers are writing simultaneously.&lt;br/&gt;
&lt;br/&gt;
Bottom line, I could see a case for bringing the batch API back.</comment>
                    <comment id="12793260" author="damienkatz" created="Mon, 21 Dec 2009 16:52:02 +0000 (UTC)"  >Actually it does speed up single client performance. It doesn&apos;t make the file smaller, but compaction fixes that.</comment>
                    <comment id="12793267" author="rnewson" created="Mon, 21 Dec 2009 17:17:24 +0000 (UTC)"  >I&apos;ve measured the increased compaction overhead since the batch api change and, for my data profile, it&apos;s not that big a deal (&amp;lt;12% reduction). The advantage of the new approach is that the database is valid at each document insertion, which is a lovely thing to have, whereas previously the entire batch would be effectively discarded if interrupted before reaching the disk.&lt;br/&gt;
&lt;br/&gt;
So, while the disk usage has increased over the previous batch api, it&apos;s only for, I think, artificial cases with very small documents (and little or no attachments) that the overhead might seem onerous, and in both of those cases compaction should be quick enough anyway.</comment>
                    <comment id="12793270" author="paul.joseph.davis" created="Mon, 21 Dec 2009 17:22:47 +0000 (UTC)"  >Huh, I had in my head that the inflation was much worse than 10%. And now I get to go reread that patch because I must&apos;ve missed something in speeding up single writers.</comment>
                    <comment id="12793271" author="rnewson" created="Mon, 21 Dec 2009 17:28:32 +0000 (UTC)"  >It depends on the size of the data inbetween headers. In my case, I have 1k of document and ~60k of attachment per document, so the overhead vanishes. If you have smaller documents and no attachments, then the overhead is much higher, but your database is also much smaller, so compaction is much more feasible.&lt;br/&gt;
</comment>
                    <comment id="12793691" author="candlerb" created="Tue, 22 Dec 2009 17:48:31 +0000 (UTC)"  >&lt;br/&gt;
Err... you could have a very large number of small documents. Logs for&lt;br/&gt;
example.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 21 Dec 2009 15:01:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-355] deleting a _config key sets the value to &quot;&quot;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-355</link>

                    <description>couch_config:delete/2 is implemented as&lt;br/&gt;
&lt;br/&gt;
delete(Section, Key) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;set(Section, Key, &amp;quot;&amp;quot;).&lt;br/&gt;
&lt;br/&gt;
I think that&apos;s misleading -- a key with an empty value is not the same as no key at all.  Consider the case of an update_notification process.  To me, deleting that key should just send an EOF to the process.  Instead Couch sends the EOF and then tries to spawn an os_process to execute &amp;quot;&amp;quot;.  The end result is the same, but a few things crash along the way.</description>
                <environment></environment>
            <key id="12426022">COUCHDB-355</key>
        <summary>deleting a _config key sets the value to &quot;&quot;</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Thu, 21 May 2009 14:38:10 +0000 (UTC)</created>
    <updated>Sun, 19 Jul 2009 21:31:56 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733058" author="kocolosk" created="Sun, 19 Jul 2009 20:04:03 +0000 (UTC)"  >This bug is complicated by our use of configuration directories.  At the moment runtime updates to the configuration are persisted in the last file in the config chain.  If the config KV we want to delete is in another file we&apos;re going to have trouble finding it.</comment>
                    <comment id="12733061" author="kocolosk" created="Sun, 19 Jul 2009 20:20:20 +0000 (UTC)"  >Not only that, we&apos;d have to keep track of all the times a given Key appears in the configuration chain and delete all of them.&lt;br/&gt;
&lt;br/&gt;
It would probably be easier (if more confusing) to interpret an empty value in the config file to mean DELETE.</comment>
                    <comment id="12733074" author="kocolosk" created="Sun, 19 Jul 2009 21:31:56 +0000 (UTC)"  >r795630 checks for empty config values while we parse an ini value.  If a value is empty, we interpret that to mean delete the key from the config.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 19 Jul 2009 21:31:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-354] Ungraceful behaviour if view returns a function</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-354</link>

                    <description>If a typo in a view definition causes it to return a function instead of a normal value:&lt;br/&gt;
* the view server crashes&lt;br/&gt;
* you get a huge Erlang barf in the log with worrying messages like &amp;quot;OS process timed out&amp;quot; and &amp;quot;brutal kill&amp;quot;&lt;br/&gt;
&lt;br/&gt;
I got all this just by accidentally writing &amp;quot;vs.shift&amp;quot; instead of &amp;quot;vs.shift()&amp;quot;&lt;br/&gt;
&lt;br/&gt;
The fundamental problem is that a function cannot be serialised in toJSON, but the error message is not helpful:&lt;br/&gt;
&lt;br/&gt;
OS Process Log Message: Error converting object to JSON: TypeError: {Array:function (v) {var ... snip loads ... &amp;quot;Object&amp;quot;] is not a function&lt;br/&gt;
&lt;br/&gt;
When actually the problem is that the object I was trying to convert *was* a function :-)&lt;br/&gt;
&lt;br/&gt;
I will attach some code which replicates this, and the barf generated.&lt;br/&gt;
&lt;br/&gt;
Of course this is entirely down to user error in an invalid map/reduce function. However there&apos;s already a clean error for &apos;undefined&apos;, maybe this could be done for &apos;function&apos; too (or indeed any non-serialisable entity)</description>
                <environment>{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a776990&amp;quot;}&lt;br/&gt;
</environment>
            <key id="12426005">COUCHDB-354</key>
        <summary>Ungraceful behaviour if view returns a function</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Thu, 21 May 2009 09:41:52 +0000 (UTC)</created>
    <updated>Fri, 22 May 2009 15:45:52 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12711540" author="candlerb" created="Thu, 21 May 2009 09:43:17 +0000 (UTC)"  >Example where re-reduce function accidentally returns a function instead of an object</comment>
                    <comment id="12711541" author="candlerb" created="Thu, 21 May 2009 09:43:59 +0000 (UTC)"  >The resulting barf</comment>
                    <comment id="12711542" author="candlerb" created="Thu, 21 May 2009 09:45:06 +0000 (UTC)"  >... and what&apos;s more confusing, this error can be in one view, but you get it when querying a completely different view (because all the views are built at once). So even if the view server is going to crash, it would be good to know which view it was building at the time.</comment>
                    <comment id="12712079" author="janl" created="Fri, 22 May 2009 13:34:26 +0000 (UTC)"  >no barfs in trunk.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&amp;gt; ruby1.9 test_reduce_barf.rb &lt;br/&gt;
&lt;br/&gt;
reduce across all says:&lt;br/&gt;
{&amp;quot;rows&amp;quot;:[]}&lt;br/&gt;
&lt;a href=&apos;mailto:jan@dahlia&apos;&gt;jan@dahlia&lt;/a&gt; ~/Downloads &lt;br/&gt;
&amp;gt; curl &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a773842&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB 0.10.0a773842 (LogLevel=debug) is starting.&lt;br/&gt;
Configuration Settings [&amp;quot;/Users/jan/Work/couchdb/trunk/etc/couchdb/default_dev.ini&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/Users/jan/Work/couchdb/trunk/etc/couchdb/local_dev.ini&amp;quot;]:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] batch_save_interval=&amp;quot;1000&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] batch_save_size=&amp;quot;1000&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] database_dir=&amp;quot;/Users/jan/Work/couchdb/trunk/tmp/lib&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] max_attachment_chunk_size=&amp;quot;4294967296&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] max_dbs_open=&amp;quot;100&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] max_document_size=&amp;quot;4294967296&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] os_process_timeout=&amp;quot;5000&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] util_driver_dir=&amp;quot;/Users/jan/Work/couchdb/trunk/src/couchdb/.libs&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[couchdb] view_index_dir=&amp;quot;/Users/jan/Work/couchdb/trunk/tmp/lib&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] batch_save=&amp;quot;{couch_batch_save_sup, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] db_update_notifier=&amp;quot;{couch_db_update_notifier_sup, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] external_manager=&amp;quot;{couch_external_manager, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] httpd=&amp;quot;{couch_httpd, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] query_servers=&amp;quot;{couch_query_servers, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] stats_aggregator=&amp;quot;{couch_stats_aggregator, start, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] stats_collector=&amp;quot;{couch_stats_collector, start, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[daemons] view_manager=&amp;quot;{couch_view, start_link, []}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] WWW-Authenticate=&amp;quot;Basic realm=\&amp;quot;administrator\&amp;quot;&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] authentication_handler=&amp;quot;{couch_httpd, default_authentication_handler}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] bind_address=&amp;quot;127.0.0.1&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] default_handler=&amp;quot;{couch_httpd_db, handle_request}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd] port=&amp;quot;5984&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _changes=&amp;quot;{couch_httpd_db, handle_changes_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _compact=&amp;quot;{couch_httpd_db, handle_compact_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _design=&amp;quot;{couch_httpd_db, handle_design_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_db_handlers] _temp_view=&amp;quot;{couch_httpd_view, handle_temp_view_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _list=&amp;quot;{couch_httpd_show, handle_view_list_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _show=&amp;quot;{couch_httpd_show, handle_doc_show_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_design_handlers] _view=&amp;quot;{couch_httpd_view, handle_view_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] /=&amp;quot;{couch_httpd_misc_handlers, handle_welcome_req, &amp;lt;&amp;lt;\&amp;quot;Welcome\&amp;quot;&amp;gt;&amp;gt;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _active_tasks=&amp;quot;{couch_httpd_misc_handlers, handle_task_status_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _all_dbs=&amp;quot;{couch_httpd_misc_handlers, handle_all_dbs_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _config=&amp;quot;{couch_httpd_misc_handlers, handle_config_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _log=&amp;quot;{couch_httpd_misc_handlers, handle_log_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _replicate=&amp;quot;{couch_httpd_misc_handlers, handle_replicate_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _restart=&amp;quot;{couch_httpd_misc_handlers, handle_restart_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _sleep=&amp;quot;{couch_httpd_misc_handlers, handle_sleep_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _stats=&amp;quot;{couch_httpd_stats_handlers, handle_stats_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _utils=&amp;quot;{couch_httpd_misc_handlers, handle_utils_dir_req, \&amp;quot;/Users/jan/Work/couchdb/trunk/share/www\&amp;quot;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] _uuids=&amp;quot;{couch_httpd_misc_handlers, handle_uuids_req}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[httpd_global_handlers] favicon.ico=&amp;quot;{couch_httpd_misc_handlers, handle_favicon_req, \&amp;quot;/Users/jan/Work/couchdb/trunk/share/www\&amp;quot;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[log] file=&amp;quot;/Users/jan/Work/couchdb/trunk/tmp/log/couch.log&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[log] level=&amp;quot;debug&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[query_server_config] reduce_limit=&amp;quot;true&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[query_servers] javascript=&amp;quot;/Users/jan/Work/couchdb/trunk/bin/couchjs_dev /Users/jan/Work/couchdb/trunk/share/server/main.js&amp;quot;&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
[info] [&amp;lt;0.1.0&amp;gt;] Apache CouchDB has started.&lt;br/&gt;
[debug] [&amp;lt;0.52.0&amp;gt;] &apos;DELETE&apos; /test {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;application/xml&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Ruby&amp;quot;}]&lt;br/&gt;
[debug] [&amp;lt;0.52.0&amp;gt;] httpd 404 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.52.0&amp;gt;] 127.0.0.1 - - &apos;DELETE&apos; /test 404&lt;br/&gt;
[debug] [&amp;lt;0.57.0&amp;gt;] &apos;PUT&apos; /test {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;application/xml&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;2&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Ruby&amp;quot;}]&lt;br/&gt;
[info] [&amp;lt;0.57.0&amp;gt;] 127.0.0.1 - - &apos;PUT&apos; /test 201&lt;br/&gt;
[debug] [&amp;lt;0.58.0&amp;gt;] &apos;POST&apos; /test/_bulk_docs {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;application/xml&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;1901&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Ruby&amp;quot;}]&lt;br/&gt;
[info] [&amp;lt;0.58.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /test/_bulk_docs 201&lt;br/&gt;
[debug] [&amp;lt;0.67.0&amp;gt;] &apos;PUT&apos; /test/_design/test {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;application/xml&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;896&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/x-www-form-urlencoded&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Ruby&amp;quot;}]&lt;br/&gt;
[info] [&amp;lt;0.67.0&amp;gt;] 127.0.0.1 - - &apos;PUT&apos; /test/_design/test 201&lt;br/&gt;
[debug] [&amp;lt;0.68.0&amp;gt;] &apos;GET&apos; /test/_design/test/_view/test {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;application/xml&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept-Encoding&apos;,&amp;quot;gzip, deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;Ruby&amp;quot;}]&lt;br/&gt;
[debug] [&amp;lt;0.44.0&amp;gt;] Spawning new group server for view group _design/test in database test.&lt;br/&gt;
[debug] [&amp;lt;0.70.0&amp;gt;] Reseting group index &amp;quot;_design/test&amp;quot; in db test&lt;br/&gt;
[debug] [&amp;lt;0.68.0&amp;gt;] request_group {Pid, Seq} {&amp;lt;0.70.0&amp;gt;,151}&lt;br/&gt;
[debug] [&amp;lt;0.68.0&amp;gt;] request_group {Pid, Seq} {&amp;lt;0.70.0&amp;gt;,151}&lt;br/&gt;
[info] [&amp;lt;0.68.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /test/_design/test/_view/test 200&lt;br/&gt;
[debug] [&amp;lt;0.69.0&amp;gt;] &apos;GET&apos; / {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;curl/7.16.3 (powerpc-apple-darwin9.0) libcurl/7.16.3 OpenSSL/0.9.7l zlib/1.2.3&amp;quot;}]&lt;br/&gt;
[info] [&amp;lt;0.69.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; / 200&lt;br/&gt;
</comment>
                    <comment id="12712095" author="candlerb" created="Fri, 22 May 2009 14:03:42 +0000 (UTC)"  >This is really odd: trunk still barfs for me. And what&apos;s especially odd is (a) your debug log doesn&apos;t show *anything* wrong with that Javascript at all, and (b) your reduce output is completely empty, not even &apos;key&apos;=&amp;gt;null. Does all_docs show the documents? You&apos;re not running the eep-0018 branch?&lt;br/&gt;
&lt;br/&gt;
I get exactly the same:&lt;br/&gt;
&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a777521&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
$ ruby ~/test_reduce_barf.rb&lt;br/&gt;
&lt;br/&gt;
reduce across all says:&lt;br/&gt;
/var/lib/gems/1.8/gems/rest-client-0.9.2/lib/restclient/request.rb:144:in `process_result&apos;: HTTP status code 500 (RestClient::RequestFailed)&lt;br/&gt;
	from /var/lib/gems/1.8/gems/rest-client-0.9.2/lib/restclient/request.rb:106:in `transmit&apos;&lt;br/&gt;
	from /usr/lib/ruby/1.8/net/http.rb:543:in `start&apos;&lt;br/&gt;
	from /var/lib/gems/1.8/gems/rest-client-0.9.2/lib/restclient/request.rb:103:in `transmit&apos;&lt;br/&gt;
	from /var/lib/gems/1.8/gems/rest-client-0.9.2/lib/restclient/request.rb:36:in `execute_inner&apos;&lt;br/&gt;
	from /var/lib/gems/1.8/gems/rest-client-0.9.2/lib/restclient/request.rb:28:in `execute&apos;&lt;br/&gt;
	from /var/lib/gems/1.8/gems/rest-client-0.9.2/lib/restclient/request.rb:12:in `execute&apos;&lt;br/&gt;
	from /var/lib/gems/1.8/gems/rest-client-0.9.2/lib/restclient.rb:57:in `get&apos;&lt;br/&gt;
	from /home/brian/test_reduce_barf.rb:56&lt;br/&gt;
&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/_log&quot;&gt;http://127.0.0.1:5984/_log&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,987},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,751}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Fri, 22 May 2009 13:53:41 GMT] [error] [&amp;lt;0.44.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.44.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_secondary_services}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,{os_process_error,&amp;quot;OS process timed out.&amp;quot;}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,[{pid,&amp;lt;0.45.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,view_manager},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,{couch_view,start_link,[]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,permanent},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,brutal_kill},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Fri, 22 May 2009 13:53:41 GMT] [info] [&amp;lt;0.78.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /test/_design/test/_view/test 500&lt;br/&gt;
&lt;br/&gt;
[Fri, 22 May 2009 13:53:50 GMT] [info] [&amp;lt;0.79.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; / 200&lt;br/&gt;
&lt;br/&gt;
So maybe it&apos;s something platform related. On this particular machine, I am running:&lt;br/&gt;
* Ubuntu Jaunty&lt;br/&gt;
* erlang 1:12.b.5-dfsg-2&lt;br/&gt;
* libmozjs0d 1.8.1.16+nobinonly-0ubuntu1&lt;br/&gt;
&lt;br/&gt;
(erlang and spidermonkey are both out-of-the-box Ubuntu components)&lt;br/&gt;
</comment>
                    <comment id="12712118" author="janl" created="Fri, 22 May 2009 14:44:31 +0000 (UTC)"  >&amp;gt; * libmozjs0d 1.8.1.16+nobinonly-0ubuntu1 &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;^^^^^^^^^^^^^^^^^ - I believe this to be a non-stable release. Can you please try with 1.7?</comment>
                    <comment id="12712141" author="candlerb" created="Fri, 22 May 2009 15:39:28 +0000 (UTC)"  >It&apos;s the only version provided in both Ubuntu Hardy and Ubuntu Jaunty. It also works perfectly fine for me in general, and I don&apos;t think the problem is anything to do with the Javascript engine.&lt;br/&gt;
&lt;br/&gt;
Hidden in the barf you can see what the error is - it&apos;s caused by the toJSON function in main.js, which in skeleton form looks like this: it&apos;s a strange sort of case statement.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return  {&apos;Array&apos;:f1, &apos;Boolean&apos;:f2, ...}[val.constructor.name](val);&lt;br/&gt;
&lt;br/&gt;
The problem is that if val is a function, val.constructor.name is &apos;Function&apos; which is not defined in the object, so you are essentially calling undefined(val).&lt;br/&gt;
&lt;br/&gt;
You can get a rather better error by catching unexpected values, e.g. like this:&lt;br/&gt;
&lt;br/&gt;
--- main.js.orig	2009-05-22 16:26:22.000000000 +0100&lt;br/&gt;
+++ main.js	2009-05-22 16:32:05.000000000 +0100&lt;br/&gt;
@@ -306,7 +306,7 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;if (typeof(val) == &amp;quot;xml&amp;quot;) { // E4X support&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;val = val.toXMLString();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
-  return {&lt;br/&gt;
+  var handlers = {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Array&amp;quot;: function(v) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var buf = [];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (var i = 0; i &amp;lt; v.length; i++) {&lt;br/&gt;
@@ -351,7 +351,11 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return &apos;&amp;quot;&apos; + v + &apos;&amp;quot;&apos;;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
-  }[val != null ? val.constructor.name : &amp;quot;Object&amp;quot;](val);&lt;br/&gt;
+  }&lt;br/&gt;
+  var k = val != null ? val.constructor.name : &amp;quot;Object&amp;quot;;&lt;br/&gt;
+  var h = handlers[k];&lt;br/&gt;
+  if (!h) { throw (&amp;quot;Cannot encode &apos;&amp;quot; + k + &amp;quot;&apos; value as JSON&amp;quot;) };&lt;br/&gt;
+  return h(val);&lt;br/&gt;
&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;function compileFunction(source) {&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
But I still get a &apos;badmatch&apos; crash:&lt;br/&gt;
&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {{badmatch,&amp;lt;&amp;lt;&amp;quot;Cannot encode &apos;Function&apos; value as JSON&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_query_servers,&apos;-rereduce/3-fun-0-&apos;,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,zipwith,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_query_servers,rereduce,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_view_group,&apos;-init_group/4-fun-0-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,&apos;-write_node/3-lc$^0/1-0-&apos;,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,write_node,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,complete_root,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_btree,query_modify,4}]}&lt;br/&gt;
&lt;br/&gt;
Given that you&apos;ve closed this ticket a second time, I&apos;ll defer to your judgement that you do not think this should be fixed, and leave it closed.</comment>
                    <comment id="12712142" author="janl" created="Fri, 22 May 2009 15:45:52 +0000 (UTC)"  >Oh hey by no means, keep opening things as you see fit :)&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
The problem is that there&apos;s behaviour change between 1.7 and 1.8 and we currently only work with 1.7. Paul offered to get this fixed. Reopening the ticket so we don&apos;t forget.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Thanks for the JS diff, too.</comment>
                </comments>
    
    <attachments>
            <attachment id="12408675" name="barf.log" size="9606" author="candlerb" created="Thu, 21 May 2009 09:43:59 +0000 (UTC)" />
            <attachment id="12408674" name="test_reduce_barf.rb" size="1415" author="candlerb" created="Thu, 21 May 2009 09:43:17 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 22 May 2009 13:34:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-353] [PATCH] add default_handler into configuration for overriding couch_httpd_db:handle_request/1 if needed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-353</link>

                    <description>To execute code other than couch_httpd_db:handle_request/1 for the default handler function, we need to add a configuration option to specify the new module/fun and execute that function upon a request.  This will allow devs to execute alternate code for things like database creation and deletion, etc.</description>
                <environment></environment>
            <key id="12425751">COUCHDB-353</key>
        <summary>[PATCH] add default_handler into configuration for overriding couch_httpd_db:handle_request/1 if needed</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="boorad">Brad Anderson</reporter>
            
    <created>Mon, 18 May 2009 18:39:01 +0000 (UTC)</created>
    <updated>Tue, 19 May 2009 01:19:25 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12710444" author="paul.joseph.davis" created="Mon, 18 May 2009 18:51:22 +0000 (UTC)"  >Brad,&lt;br/&gt;
&lt;br/&gt;
Can you run a quick curl test to make sure that the mochiweb receive loop gets notification of the config change (via being kiled from the exit call and restarted)? I&apos;m wondering if maybe the config handler might need to explicitly kill the mochiweb server.</comment>
                    <comment id="12710476" author="boorad" created="Mon, 18 May 2009 20:30:05 +0000 (UTC)"  >This console dump shows that mochiweb is picking up the change and does not need to be restarted, as davisp was thinking might be required.&lt;br/&gt;
&lt;br/&gt;
Note:  my new handler returns {ok, false} and doesn&apos;t delete the database.  The normal couch handler returns {ok, true} and performs the delete of the database.</comment>
                    <comment id="12710578" author="paul.joseph.davis" created="Tue, 19 May 2009 01:19:25 +0000 (UTC)"  >In trunk as of r776143</comment>
                </comments>
    
    <attachments>
            <attachment id="12408409" name="default_handler.console.txt" size="1047" author="boorad" created="Mon, 18 May 2009 20:30:05 +0000 (UTC)" />
            <attachment id="12408401" name="default_handler.patch" size="3274" author="boorad" created="Mon, 18 May 2009 18:39:38 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 19 May 2009 01:19:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 18 May 2009 18:51:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-352] Replicate documents and attachments with extremely long IDs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-352</link>

                    <description>In &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-243&quot; title=&quot;Tests for extra long docid&apos;s and attachment names.&quot;&gt;&lt;strike&gt;COUCHDB-243&lt;/strike&gt;&lt;/a&gt; we concluded that the replicator should try to play nice with documents and attachments that have names longer than MochiWeb can handle.  Opening this case to track how we might go about that.&lt;br/&gt;
&lt;br/&gt;
The replicator already handles documents with lots of revisions to replicate by chunking the rev list and combining the results from multiple requests.  We obviously can&apos;t play the same game with document IDs and attachment names.</description>
                <environment></environment>
            <key id="12425678">COUCHDB-352</key>
        <summary>Replicate documents and attachments with extremely long IDs</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Sun, 17 May 2009 12:25:18 +0000 (UTC)</created>
    <updated>Sun, 17 May 2009 12:25:18 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-351] intra-document checkpointing during replication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-351</link>

                    <description>Ben Cohen noted that Couch will fail to make progress if a link is never up long enough to transfer a specific large document or attachment:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-user/200905.mbox/%3cA192849F-B7EE-48A2-B010-D63D171FC034@gmail.com%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-user/200905.mbox/%3cA192849F-B7EE-48A2-B010-D63D171FC034@gmail.com%3e&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
If we want to do intra-document checkpointing we&apos;ll need:&lt;br/&gt;
&lt;br/&gt;
1) support for the Range header in GET requests&lt;br/&gt;
2) a place to store partially-transferred docs/attachments when a replication fails -- possibly as attachments to the replicator _local doc.  On the other hand, this feature is not really replication-specific, so we&apos;d probably want some sort of standalone &amp;quot;upload cache&amp;quot; that saves partial transfers.&lt;br/&gt;
3) for push replication, an extension to the _missing_revs API that can describe partial transfers existing on the target&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12425463">COUCHDB-351</key>
        <summary>intra-document checkpointing during replication</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Thu, 14 May 2009 14:01:06 +0000 (UTC)</created>
    <updated>Thu, 14 May 2009 14:01:06 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-350] Attachment with tab in the filename is refused with 400 bad request</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-350</link>

                    <description>Issuing a PUT request to &lt;a href=&quot;http://localhost:5984/test/9b3c90b888e2cab3f5aa93badb1f67fe/April+2009+Minutes+CISD%09Meeting.doc?rev=1-166931409&quot;&gt;http://localhost:5984/test/9b3c90b888e2cab3f5aa93badb1f67fe/April+2009+Minutes+CISD%09Meeting.doc?rev=1-166931409&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
results in a 400 Bad Request response:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;bad_request&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Attachment name is not UTF-8 encoded&amp;quot;}</description>
                <environment>CouchDB trunk (384774a1cf4689650758cfe10726eadcc0ed8058) and Erlang 12.b.5 on Ubuntu Jaunty.</environment>
            <key id="12425343">COUCHDB-350</key>
        <summary>Attachment with tab in the filename is refused with 400 bad request</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="technomancy">Phil Hagelberg</reporter>
            
    <created>Wed, 13 May 2009 17:11:57 +0000 (UTC)</created>
    <updated>Wed, 13 May 2009 17:33:33 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12709014" author="kocolosk" created="Wed, 13 May 2009 17:18:25 +0000 (UTC)"  >I don&apos;t see 384774 in the unofficial CouchDB git repo.  Can you supply an SVN revision number?</comment>
                    <comment id="12709019" author="technomancy" created="Wed, 13 May 2009 17:33:33 +0000 (UTC)"  >Sure; I originally saw it on SVN 769804. (c. 2 weeks ago) But I just updated to the latest (774181) and it is still an issue.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 13 May 2009 17:18:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-349] Removing a _view can cause the database browser interface to break</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-349</link>

                    <description>Futon may navigate you to a _view that no longer exists when returning to the database&apos;s browser, causing the interface to break.&lt;br/&gt;
&lt;br/&gt;
Steps to reproduce:&lt;br/&gt;
1. View an existing _view in Futon (ex., &lt;a href=&quot;http://localhost:5984/_utils/database.html?foo/_design%2FuserInfo%2Fbar)&quot;&gt;http://localhost:5984/_utils/database.html?foo/_design%2FuserInfo%2Fbar)&lt;/a&gt;&lt;br/&gt;
2. Browse to the design document - I just clicked on the &amp;quot;_design/userInfo&amp;quot; link on the right side of the &amp;quot;View code&amp;quot; box.&lt;br/&gt;
3. Edit the design document, removing the _view we were just at (in this case, &amp;quot;bar&amp;quot;).&lt;br/&gt;
4. Save the design document.&lt;br/&gt;
5. Return to the database&apos;s overview. I clicked on the &amp;quot;Overview &amp;gt; foo&amp;quot; link in the top navigation bar.&lt;br/&gt;
&lt;br/&gt;
Error message(s):&lt;br/&gt;
1. Firebug reports the following...&lt;br/&gt;
viewCode is undefined&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/_utils/script/futon.browse.js?0.9.0&quot;&gt;http://localhost:5984/_utils/script/futon.browse.js?0.9.0&lt;/a&gt;&lt;br/&gt;
Line 298&lt;br/&gt;
&lt;br/&gt;
2. Firebug reports the following...&lt;br/&gt;
document.body is null&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/_utils/script/jquery.js?1.3.1&quot;&gt;http://localhost:5984/_utils/script/jquery.js?1.3.1&lt;/a&gt;&lt;br/&gt;
Line 3085&lt;br/&gt;
&lt;br/&gt;
The cause:&lt;br/&gt;
When you return to the database&apos;s browser, whether from the Futon Overview page or a direct link, Futon attempts to return to the previous view, which we just removed from the design document. &lt;br/&gt;
&lt;br/&gt;
Temporary fix:&lt;br/&gt;
You need to change the URL in the address bar to something valid (ex., specify a _view that&apos;s valid). If you try to go back to the Futon Overview page and then click on the database, it will simply redirect you to the invalid view again.</description>
                <environment></environment>
            <key id="12425166">COUCHDB-349</key>
        <summary>Removing a _view can cause the database browser interface to break</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="ravidgemole">Sam Bisbee</reporter>
            
    <created>Tue, 12 May 2009 04:08:38 +0000 (UTC)</created>
    <updated>Wed, 13 May 2009 23:12:24 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12709204" author="paul.joseph.davis" created="Wed, 13 May 2009 23:12:24 +0000 (UTC)"  >Fixed in 774587</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 13 May 2009 23:12:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 13 May 2009 23:12:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-348] / should redirect to a human readable page when accessed from a browser</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-348</link>

                    <description>As more people are adopting CouchDB, the number of questions along the lines of &amp;quot;All I see is {&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.10.0a773399&amp;quot;}, what now?&amp;quot;&lt;br/&gt;
&lt;br/&gt;
If this page redirected to /_utils/ (or maybe something more user-focussed) when the accept headers included html, we could make the first-time user experience more palatable.&lt;br/&gt;
&lt;br/&gt;
There&apos;s some code in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-234&quot; title=&quot;[PATCH] Improved Accept/Content-Type negotiation&quot;&gt;COUCHDB-234&lt;/a&gt; that might be helpful here.</description>
                <environment></environment>
            <key id="12425128">COUCHDB-348</key>
        <summary>/ should redirect to a human readable page when accessed from a browser</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Mon, 11 May 2009 18:48:17 +0000 (UTC)</created>
    <updated>Thu, 17 Dec 2009 09:21:16 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12747048" author="sthulbourn" created="Mon, 24 Aug 2009 20:18:23 +0000 (UTC)"  >I disagree, this should remain as it is. It allows for people writing API classes to perform a check to see if it&apos;s successful. Besides, how does it know what a browser is without parts of the user agent string to be checked every time something visits the page?</comment>
                    <comment id="12747057" author="jchris" created="Mon, 24 Aug 2009 20:37:06 +0000 (UTC)"  >The check would be relatively straightforward, web-sane, and friendly to API clients. No browser-sniffing required.&lt;br/&gt;
&lt;br/&gt;
If the client sends an HTTP Accept header that prefers HTML to JSON (as browsers do), then we&apos;d send HTML, otherwise we&apos;d send JSON.</comment>
                    <comment id="12772674" author="kocolosk" created="Mon, 2 Nov 2009 20:39:59 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12791291" author="mwhooker" created="Wed, 16 Dec 2009 09:43:15 +0000 (UTC)"  >I think this patch does what Chris described. I&apos;ve tested it in firefox and curl, and I get the expected results.&lt;br/&gt;
&lt;br/&gt;
Not being super expert at either the CouchDB codebase or Erlang, I think this is sort of a naive approach, and would appreciate some feedback.&lt;br/&gt;
&lt;br/&gt;
It merely checks if the client is sending &apos;text/html&apos; as part of the Accept header, and like &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-234&quot; title=&quot;[PATCH] Improved Accept/Content-Type negotiation&quot;&gt;COUCHDB-234&lt;/a&gt;, it doesn&apos;t respect qvalues, so if the client can do both html and json, it will get html.&lt;br/&gt;
&lt;br/&gt;
Thanks.</comment>
                    <comment id="12791296" author="djc" created="Wed, 16 Dec 2009 09:51:45 +0000 (UTC)"  >It should probably parse the qvalues and try to only redirect if text/html (or maybe application/xhtml+xml?) gets higher priority than application/json.</comment>
                    <comment id="12791692" author="mwhooker" created="Thu, 17 Dec 2009 00:17:20 +0000 (UTC)"  >properly parsing qvalues is actually kind of tricky. I probably would have messed up the implementation, but luckily there&apos;s a great library that does just that, hosted over at &lt;a href=&quot;http://code.google.com/p/mimeparse/&quot;&gt;http://code.google.com/p/mimeparse/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Attached also is the patch that uses that to correctly resolve this issue.&lt;br/&gt;
&lt;br/&gt;
The question now is, can I include that library in couch? If so, how? I can see it being quite useful for other things (e.g. &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-234&quot; title=&quot;[PATCH] Improved Accept/Content-Type negotiation&quot;&gt;COUCHDB-234&lt;/a&gt;).&lt;br/&gt;
&lt;br/&gt;
Thanks,</comment>
                    <comment id="12791698" author="benoitc" created="Thu, 17 Dec 2009 00:39:52 +0000 (UTC)"  >i posted a patch that display a &amp;quot;human&amp;quot; page and still send the message on accept header :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-472&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-472&lt;/a&gt;</comment>
                    <comment id="12791709" author="emgee" created="Thu, 17 Dec 2009 00:53:55 +0000 (UTC)"  >I don&apos;t disagree with this at all - an HTML version of the couchdb root resource would make sense. However, some browsers (yes, Internet Explorer) don&apos;t always send text/html in the Accept header. So, sadly, it&apos;s not actually true that all browser prefer HTML to JSON. IE sends an insane Accept header and the best match ends up being &amp;quot;*/*&amp;quot; which means it may be up to the server to prioritise text/html over application/json.</comment>
                    <comment id="12791727" author="nslater" created="Thu, 17 Dec 2009 01:38:30 +0000 (UTC)"  >This would be an abuse of HTTP semantics. Representations (i.e. the different media types) are meant to represent the same conceptual resource. Switching in Futon based on the Accept header would be a gross abuse of content negotiation, as Futon is not the HTML representation of any resource which also has the root CouchDB JSON response as another representation. The only two options we have for this ticket is to close it as WONTFIX, or to replace the root resource with Futon - that is, to make Futon live at the root of CouchDB.</comment>
                    <comment id="12791743" author="paul.joseph.davis" created="Thu, 17 Dec 2009 02:27:15 +0000 (UTC)"  >@matthew That mimeparse library is busted. media type parameters can be quoted which breaks the call to string:tokens(&amp;quot;=&amp;quot;). Though, that&apos;s not too crazy. Even WebOb is broken. Just saying is all. :) As to including it, you might double check if mochiweb already has something. If not, then as long as the license is kosher we&apos;ll put it in somewhere.&lt;br/&gt;
&lt;br/&gt;
@nslater Perhaps if someone had suggested redirecting to Futon based on Accept header you&apos;d be in the right ballpark. As it so happens, we&apos;re discussing returning an alternate representation of the root resource with something that is human readable based on the accept headers. For instance, the general idea is to replace:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.11.0b890185&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
with something like this: &lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12416873/screenshot.png&quot;&gt;https://issues.apache.org/jira/secure/attachment/12416873/screenshot.png&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I could see adding a couple user friendly links to couchdb.apache.org, wiki.apache.org/couchdb and Futon. But the resource is still they same old &amp;quot;Hey buddy, glad you could make it, lemme get you a nice frosty cold glass of lemonade while you relax right here on this comfy couch.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Cheerio!</comment>
                    <comment id="12791747" author="paul.joseph.davis" created="Thu, 17 Dec 2009 02:31:12 +0000 (UTC)"  >@matt - So I&apos;m unsuprised to learn that IE screws the pooch as per usual. But technically if they end up preferring */* then if memory serves the server can choose. And I don&apos;t know why that choice couldn&apos;t be based on what exists in the User-Agent string if it exists.</comment>
                    <comment id="12791754" author="nslater" created="Thu, 17 Dec 2009 02:51:41 +0000 (UTC)"  >I would be happy with that screenshot being implemented.&lt;br/&gt;
&lt;br/&gt;
A link to Futon in both JSON and HTML would be good too.&lt;br/&gt;
&lt;br/&gt;
As for conneg, just sniff for anything with HTML.&lt;br/&gt;
&lt;br/&gt;
If it doesn&apos;t work for all clients, it doesn&apos;t work.</comment>
                    <comment id="12791755" author="nslater" created="Thu, 17 Dec 2009 02:52:27 +0000 (UTC)"  >Also, you missed the slippers.</comment>
                    <comment id="12791844" author="mwhooker" created="Thu, 17 Dec 2009 08:23:24 +0000 (UTC)"  >From the comments, it seems like a mix of the Accept detection and the human readable &amp;quot;Welcome&amp;quot; page in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-472&quot; title=&quot;handle custom CouchdDB welcome page&quot;&gt;COUCHDB-472&lt;/a&gt; is preferred. Attached is a patch which does just that.&lt;br/&gt;
&lt;br/&gt;
@paul I didn&apos;t see anything in Mochiweb that might deal with Accept headers or mime types. The code is under the MIT license.</comment>
                    <comment id="12791846" author="benoitc" created="Thu, 17 Dec 2009 08:29:30 +0000 (UTC)"  >@ matthew I don&apos;t see why it shouldn&apos;t works with Interet Explorer here (speaking of my patch). Does ie rewrite the Accept header ? </comment>
                    <comment id="12791848" author="mwhooker" created="Thu, 17 Dec 2009 08:39:10 +0000 (UTC)"  >@benoitc Matt mentions that it might not work with IE, but I haven&apos;t checked. As Dirkjan points out, though, it should probably properly parse the Accept header.</comment>
                    <comment id="12791857" author="fdmanana" created="Thu, 17 Dec 2009 09:19:09 +0000 (UTC)"  >Matthew, regarding the of parsing Q values, I did it for a patch to 583. It was done for parsing the &amp;quot;Accept-Encoding&amp;quot; header, but it should be reusable for other Q values lists. I didn&apos;t find it in Mochiweb also :( I agree with yout, it&apos;s boring to do such a parsing function.&lt;br/&gt;
&lt;br/&gt;
I add it here in a separate file with test functions. The main function is build_enc_lists/1, which builds 2 lists, one for Q values &amp;gt; 0, and the other with Q values == 0. It ignores white spaces all over and it&apos;s case insensitive (as rfc 2626 says):&lt;br/&gt;
&lt;br/&gt;
test_build_lists() -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[], []} = build_enc_lists(&amp;quot;&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[], [identity]} = build_enc_lists(&amp;quot;identity;q=0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[], [identity]} = build_enc_lists(&amp;quot;identity ;q=0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[], [identity]} = build_enc_lists(&amp;quot; identity; q =0 &amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[], [identity]} = build_enc_lists(&amp;quot;identity ; q = 0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[], [identity]} = build_enc_lists(&amp;quot;identity ; q= 0.0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[gzip, deflate], [identity]} = build_enc_lists(&amp;quot;gzip,deflate,identity;q=0.0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[deflate, gzip], [identity]} = build_enc_lists(&amp;quot;deflate,gzip,identity;q=0.0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[gzip, deflate, gzip], [identity]} = build_enc_lists(&amp;quot;gzip,deflate,gzip,identity;q=0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[gzip, deflate], [identity]} = build_enc_lists(&amp;quot;gzip, deflate , identity; q=0.0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[gzip, deflate], [identity]} = build_enc_lists(&amp;quot;gzip; q=1, deflate;q=1.0, identity;q=0.0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[deflate, gzip], [identity]} = build_enc_lists(&amp;quot;gzip; q=0.5, deflate;q=1.0, identity;q=0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[deflate, gzip], [identity]} = build_enc_lists(&amp;quot;gzip; q=0.5, deflate , identity;q=0.0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[deflate, gzip], [identity]} = build_enc_lists(&amp;quot;gzip; q=0.5, deflate;q=0.8, identity;q=0.0&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[deflate, identity, gzip], []} = build_enc_lists(&amp;quot;gzip; q=0.5,deflate,identity&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[deflate, identity, identity, gzip], []} = build_enc_lists(&amp;quot;gzip; q=0.5,deflate,identity, identity &amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok.&lt;br/&gt;
&lt;br/&gt;
cheers</comment>
                    <comment id="12791859" author="emgee" created="Thu, 17 Dec 2009 09:21:16 +0000 (UTC)"  >A good example of IE&apos;s accept header is:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Accept: image/jpeg, application/x-ms-application, image/gif,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;application/xaml+xml, image/pjpeg, application/x-ms-xbap,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;application/x-shockwave-flash, application/msword, */*&lt;br/&gt;
&lt;br/&gt;
I took that from &lt;a href=&quot;http://www.newmediacampaigns.com/page/browser-rest-http-accept-headers&quot;&gt;http://www.newmediacampaigns.com/page/browser-rest-http-accept-headers&lt;/a&gt; but there are plenty of other examples if you search for &amp;quot;internet explorer accept header&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
@paul, yes the server can decide what to return when */* is the best match. Some servers implement a server-side quality, e.g. q=0.9, to decide what representation to return.&lt;br/&gt;
&lt;br/&gt;
And, even though I brought this up, I&apos;m actually with Noah on &amp;quot;If it doesn&apos;t work for all clients, it doesn&apos;t work.&amp;quot;</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12433329">COUCHDB-472</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12428151" name="COUCHDB_348_01.patch" size="1125" author="mwhooker" created="Wed, 16 Dec 2009 09:43:14 +0000 (UTC)" />
            <attachment id="12428242" name="COUCHDB_348_02.patch" size="1218" author="mwhooker" created="Thu, 17 Dec 2009 00:17:20 +0000 (UTC)" />
            <attachment id="12428276" name="COUCHDB_348_03.patch" size="5267" author="mwhooker" created="Thu, 17 Dec 2009 08:23:24 +0000 (UTC)" />
            <attachment id="12428279" name="encs.erl" size="5184" author="fdmanana" created="Thu, 17 Dec 2009 09:19:09 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 24 Aug 2009 20:18:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-347] Chage doc_validation status code</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-347</link>

                    <description>doc_validation errors return a 500 HTTP response status. This should probably be a 400.</description>
                <environment></environment>
            <key id="12425020">COUCHDB-347</key>
        <summary>Chage doc_validation status code</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sat, 9 May 2009 21:58:39 +0000 (UTC)</created>
    <updated>Sat, 9 May 2009 21:58:39 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-346] ddoc option to include seq number on the doc for view generation</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-346</link>

                    <description>this allows us to collate docs in the order they were recorded on the local database. useful for lots of things, like Eric&apos;s replication processor but also for ordering messages.</description>
                <environment></environment>
            <key id="12424867">COUCHDB-346</key>
        <summary>ddoc option to include seq number on the doc for view generation</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Thu, 7 May 2009 21:48:47 +0000 (UTC)</created>
    <updated>Mon, 30 Nov 2009 05:29:26 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12707161" author="paul.joseph.davis" created="Thu, 7 May 2009 22:30:29 +0000 (UTC)"  >Making this a design doc option alleviates any of my concerns about views being different on different nodes. This way the user must explicitly ask for it which means they should be aware of the consequences.</comment>
                    <comment id="12772658" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12783542" author="jchris" created="Mon, 30 Nov 2009 05:29:26 +0000 (UTC)"  >this is fixed. to include the local seq of documents into your view, add &lt;br/&gt;
&lt;br/&gt;
options : {&lt;br/&gt;
local_seq : true&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
to your design doc.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 30 Nov 2009 05:29:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 7 May 2009 22:30:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-345] &quot;High ASCII&quot; can be inserted into db but not retrieved</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-345</link>

                    <description>It is possible to PUT/POST a document into CouchDB with a &amp;quot;high ASCII&amp;quot; value that cannot be retrieved. This results from not escaping a non-ASCII value into \u#### when PUT/POSTing the document.&lt;br/&gt;
&lt;br/&gt;
The attached sample code will recreate the problem using the hex value D8 (&amp;#xD8;) in a possibly unsavoury test string.&lt;br/&gt;
Sample output against 0.9.0 is as follows:&lt;br/&gt;
================================================&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;ok&amp;quot;: true&lt;br/&gt;
}&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;id&amp;quot;: &amp;quot;fail&amp;quot;, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;ok&amp;quot;: true, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;rev&amp;quot;: &amp;quot;1-76726372&amp;quot;&lt;br/&gt;
}&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;error&amp;quot;: &amp;quot;ucs&amp;quot;, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;reason&amp;quot;: &amp;quot;{bad_utf8_character_code}&amp;quot;&lt;br/&gt;
}&lt;br/&gt;
================================================&lt;br/&gt;
&lt;br/&gt;
Please note this defect turned up another problem, namely that the bad_utf8_character_code exception thrown by a design document attempting to map() the bad document caused Futon to fail silently in building the view, with no indication (except via debug log) that there was a failure. The log indicated two attempts to build the view, both failing, followed by an uncaught exception error for Futon.&lt;br/&gt;
&lt;br/&gt;
Based on this, there are likely other areas in the codebase that do not handle the bad_utf8_character_code exception correctly.&lt;br/&gt;
&lt;br/&gt;
My belief is that CouchDB shouldn&apos;t accept this input and should have rejected the PUT/POST, or should have escaped the input itself before the insertion.</description>
                <environment>OSX 10.5.6</environment>
            <key id="12424767">COUCHDB-345</key>
        <summary>&quot;High ASCII&quot; can be inserted into db but not retrieved</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="wohali">Joan Touzet</reporter>
            
    <created>Wed, 6 May 2009 22:15:11 +0000 (UTC)</created>
    <updated>Wed, 23 Sep 2009 20:56:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12706626" author="wohali" created="Wed, 6 May 2009 22:22:22 +0000 (UTC)"  >Code to reproduce the defect including the pre-requisite wrapper module.</comment>
                    <comment id="12706689" author="carnold@apache.org" created="Thu, 7 May 2009 01:31:33 +0000 (UTC)"  >Not a CouchDB or Python developer, but interested in the issue and thought I might help you clarify what you have encountered.&lt;br/&gt;
&lt;br/&gt;
According to &lt;a href=&quot;http://www.ietf.org/rfc/rfc4627.txt?number=4627,&quot;&gt;http://www.ietf.org/rfc/rfc4627.txt?number=4627,&lt;/a&gt; JSON data must be encoded in Unicode and the default encoding is UTF-8.  I&apos;m assuming that is the definite statement on JSON encoding.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;It should not be necessary to escape non US-ASCII characters as long as the document is properly encoded in UTF-8, one of the UTF-16s or UCS-4.  What I&apos;m guessing is happening in your code fragment is that a Latin-1 (ISO-8859-1) byte sequence is sent in  the request which should have been rejected by the PUT operation since it bad JSON.&lt;br/&gt;
&lt;br/&gt;
If that interpretation is correct and shooting from the hip, I think:&lt;br/&gt;
&lt;br/&gt;
1. The Python API should have either rejected the standard string or converted it to a Unicode string before sending the request.&lt;br/&gt;
&lt;br/&gt;
2. CouchDB should reject any document that is not valid UTF-8, UTF-16BE, UTF-16LE or UCS-4.&lt;br/&gt;
&lt;br/&gt;
3. It should not require non-USASCII characters to be escaped.&lt;br/&gt;
&lt;br/&gt;
4. CouchDB should ignore any encoding specified in the header.  Limiting to only Unicode types means that the encoding can be reliably determined and it is likely that any encoding in the header might be wrong.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12749028" author="carnold@apache.org" created="Fri, 28 Aug 2009 23:38:16 +0000 (UTC)"  >This is a JUnit 4 test case (with corresponding pom.xml) that demonstrates the current broken behavior (or at least of about a week or so ago).&lt;br/&gt;
&lt;br/&gt;
Documents that are not valid UTF-8 are accepted into the database, but can not be retrieved.  I did not test if they broken queries, but have no reason to doubt that misencoded documents would cause unexpected behavior in the database.  It would seem plausible that an attacker could seriously damage a CouchDB application by inserting misencoded documents.  Depending on an API layer to not send misencoded documents would still leave the DB vulnerable to an intentional attack or a miscoded API layer.&lt;br/&gt;
&lt;br/&gt;
The test creates &lt;a href=&quot;http://localhost:5984/testdb&quot;&gt;http://localhost:5984/testdb&lt;/a&gt; and then tries to insert 5 documents.  The first is just straight ASCII, the second inserts a document containing \u00C0 - \u00C6 encoded in UTF-8 and the 3rd inserts the same document, but with the characters escaped instead of UTF-8 encoded.  These three behavior as expected.&lt;br/&gt;
&lt;br/&gt;
The next two attempt to insert the same characters, but instead of UTF-8 encoded, they are ISO-8859-1 encoded (that is the byte sequence 0xC0, 0xC1, 0xC2 ... is in the body).  One attempt is with an Content-Encoding=ISO-8559-1 and the other without.   Both PUT returns with an 201 response, but an attempt to fetch results in a 500 due with an encoding error stack trace.  Returning a 400 in both cases would be appropriate since the RFC says that JSON is always UTF-8 encoded.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12749058" author="paul.joseph.davis" created="Sat, 29 Aug 2009 02:07:53 +0000 (UTC)"  >Thanks for tracking this down to find a repeatable test. Couple notes:&lt;br/&gt;
&lt;br/&gt;
I actually got caught by this just the other day, but the json rfc says that strings must be Unicode, not utf-8. Ie, utf-8, 16 and 32, and both BE and LE for 16 and 32. I don&apos;t think I&apos;ve ever seen a completely compliant parser. &lt;br/&gt;
&lt;br/&gt;
Does anyone know if this byte range is special? I&apos;m no encoding expert so I don&apos;t have a good feel for what might be the issue.&lt;br/&gt;
&lt;br/&gt;
While I appreciate your tracking this down, in the future could you submit test cases as JavaScript, erlang, or a bash script? Not many of us have a java dev environment setup to run junit tests. </comment>
                    <comment id="12749062" author="nslater" created="Sat, 29 Aug 2009 02:44:21 +0000 (UTC)"  >It is unpossible to have Unicode strings. That breaks science.</comment>
                    <comment id="12749083" author="carnold@apache.org" created="Sat, 29 Aug 2009 05:55:34 +0000 (UTC)"  >ISO-8859-1, Cp1252 and Latin-1 are near synonyms for encoding the first 256 character points in Unicode as single byte values and is incapable of representing any other character without some escape mechanism.   Any arbitrary set of bytes would be a valid ISO-8859-1 sequence and can be decoded into a sequence of Unicode characters.&lt;br/&gt;
&lt;br/&gt;
UTF-8 is an variable byte encoding of the full Unicode character repertoire.  Character values from \u0000 to \u007F are represented as a single-byte, while other characters require 2-6 bytes to encode.  Unlike ISO-8859-1, not every sequence of bytes is valid and can be converted back to Unicode character points.  If I remember correctly, any two-bytes in a row with the high-bit set is invalid.  The test date in the last two cases are valid ISO-8859-1 sequence, but they can not be interpreted as UTF-8 since they contain byte sequences that can not be converted back into Unicode code points.&lt;br/&gt;
&lt;br/&gt;
If it was just an encoding mismatch and the data was being misinterpreted, you would lay the blame at the client.  However, in this case, data can go into the database that the rest of the stack can&apos;t process since it contains invalid sequences. &lt;br/&gt;
&lt;br/&gt;
The RFC mentions the two variants of UTF-16 and UCS-4, however the ISO-8859-1 sequences could not be interpreted using any of those encodings since the first two characters must be ASCII.  There are only certain sequences of bytes that could appear for JSON encoded in any of those encodings and the byte sequences send in the last two cases don&apos;t match any of those patterns.  Sniffing the encoding  would work in a similar manner to XML which is described in &lt;a href=&quot;http://www.w3.org/TR/REC-xml/#sec-guessing&quot;&gt;http://www.w3.org/TR/REC-xml/#sec-guessing&lt;/a&gt;.</comment>
                    <comment id="12749084" author="kocolosk" created="Sat, 29 Aug 2009 06:10:30 +0000 (UTC)"  >Hi folks, here&apos;s a patch that rejects updates which are not valid UTF-8.  I tested it against  Joan&apos;s and Mark&apos;s Python scripts, but I don&apos;t have junit so I wasn&apos;t able to run Curt&apos;s test.</comment>
                    <comment id="12749085" author="kocolosk" created="Sat, 29 Aug 2009 06:11:42 +0000 (UTC)"  >oh, and the other funny thing is that with this patch applied, the oauth and cookie_auth tests break, because they try to upload a secret that is invalid UTF-8 :-P.</comment>
                    <comment id="12749090" author="nslater" created="Sat, 29 Aug 2009 08:54:16 +0000 (UTC)"  >Forcing the request body to be UTF-8 is lazy and inconsiderate.&lt;br/&gt;
&lt;br/&gt;
CouchDB should attempt to decode any request body according to the Content-Encoding header.&lt;br/&gt;
&lt;br/&gt;
If no such header exists, CouchDB should do one of the following:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* attempt to decode as UTF-8&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* attempt to guess the character encoding, and decode&lt;br/&gt;
&lt;br/&gt;
If either of these three methods fail, the request body is garbage and should be rejected with a 4xx client error.</comment>
                    <comment id="12749103" author="janl" created="Sat, 29 Aug 2009 09:52:47 +0000 (UTC)"  >I&apos;d be happy to see in code what Noah suggests down the road. But until we get such a patch we should go with denying non-utf-8 encoding if we can&apos;t handle it correctly. I don&apos;t think this is lazy as a first approach</comment>
                    <comment id="12749108" author="kocolosk" created="Sat, 29 Aug 2009 11:22:23 +0000 (UTC)"  >I agree with both Noah and Jan.  Applying this patch is better than not applying it.</comment>
                    <comment id="12749149" author="carnold@apache.org" created="Sat, 29 Aug 2009 14:15:07 +0000 (UTC)"  >The patch does result in passing the tests as they were intended to be (asserting that the PUT returns a 400).  The versions that were attached were demonstrating the failure of the GET after the PUT so they didn&apos;t assert the 400 return.  The patch hunk for couch_httpd.erl is a little stale and needs to be manually applied.&lt;br/&gt;
&lt;br/&gt;
The patch modifies mochijson2, so it puts us in the position of diverging from stock MochiWeb.&lt;br/&gt;
&lt;br/&gt;
My thought was to put a call to unicode:characters_to_binary(Bin,utf8,utf8) in PUT code path.  If the source Bin is valid UTF-8, the return value will be identical.  If not, then it returns { error, &amp;quot;Valid characters&amp;quot;, &amp;lt;&amp;lt;MalformedStuff&amp;gt;&amp;gt; }.  Support for the UTF-16&apos;s could be done at the same place.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://erlang.org/doc/apps/stdlib/unicode_usage.html&quot;&gt;http://erlang.org/doc/apps/stdlib/unicode_usage.html&lt;/a&gt; and &lt;a href=&quot;http://erlang.org/doc/man/unicode.html&quot;&gt;http://erlang.org/doc/man/unicode.html&lt;/a&gt; mention that the implementation is complete as documented in R13A, but I don&apos;t know how much if any of the unicode module is present in R12B5.  Mochiweb references xmerl_ucs, which isn&apos;t in the docs but is apparently the ucs string support for the XML parser.&lt;br/&gt;
&lt;br/&gt;
I&apos;d suggest implementing a check/conversion on the PUT code path using the unicode module and then adapting it to run on our minimum platform if that is an issue.</comment>
                    <comment id="12749156" author="janl" created="Sat, 29 Aug 2009 15:07:44 +0000 (UTC)"  >the unicode module is new in R13.</comment>
                    <comment id="12749159" author="carnold@apache.org" created="Sat, 29 Aug 2009 15:59:26 +0000 (UTC)"  >The patch also addresses the issue.  It redefined ?JSON_DECODE to couch_db:json_decode/1 which calls xmerl_ucs:from_utf8 prior to delegating to mochijson2:decode.  If there is a encoding problem, it throws {invalid_json, &amp;lt;&amp;lt;&amp;quot;bad utf8...&amp;quot;&amp;gt;&amp;gt; } which eliminates the need to add new catch clauses in the calling code.</comment>
                    <comment id="12749160" author="carnold@apache.org" created="Sat, 29 Aug 2009 16:29:06 +0000 (UTC)"  >I looked at the Erlang test suite and didn&apos;t see anything that looked similar to what I wanted to test.  When I did &amp;quot;make check&amp;quot;, I got a lot of lines like:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;test/etap/070-couch-db....................dubious&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test returned status 127 (wstat 32512, 0x7f00)&lt;br/&gt;
&lt;br/&gt;
Looks like it is beyond my skills at the moment to write an Erlang test that would effectively test the changes.&lt;br/&gt;
&lt;br/&gt;
If you wanted to accept interpret badly encoded UTF-8 as ISO-8859-1, I&apos;d suggest logging it, but in the catch, you could do something like:&lt;br/&gt;
&lt;br/&gt;
mochijson2:decode(xmerl_ucs:to_utf8(binary_to_list(S))&lt;br/&gt;
&lt;br/&gt;
Sniffing the multi-byte encodings could also be done in couch_db:json_decode as an enhancement.  You don&apos;t have the Content-Encoding header available, so you could not support users who explicitly try to send JSON in arbitrary encodings.  However, since JSON is supposed to be encoded in Unicode and you can unambiguously determine the encoding from the content.  I think it is best to ignore the Content-Encoding even if it was available.&lt;br/&gt;
&lt;br/&gt;
I do not know the performance implications of the patch.  It would likely be cheaper if the binary could be scanned only and not extracted to a list, but I think that has to be relatively minor compared to the JSON parsing.</comment>
                    <comment id="12749162" author="janl" created="Sat, 29 Aug 2009 16:35:14 +0000 (UTC)"  >Hi Curt, to run `make check` successfully, you need to install etap first: &lt;a href=&quot;http://github.com/ngerakines/etap/&quot;&gt;http://github.com/ngerakines/etap/&lt;/a&gt;</comment>
                    <comment id="12749164" author="nslater" created="Sat, 29 Aug 2009 16:40:07 +0000 (UTC)"  >I disagree with Curt.&lt;br/&gt;
&lt;br/&gt;
The JSON RFC is either wrong or carelessly worded. You cannot encode anything as Unicode because Unicode is not an encoding, it is a collection of code points that have no binary representation. You can encode these code points into character data, and you can decode the same character data into Unicode. Unicode is always some internal representation after decoding, and before encoding. I am guessing everyone already knows this, but I keep seeing people form arguments (particularly on IRC) that start with &amp;quot;since JSON has to be encoded as Unicode&amp;quot; which is just a meaningless sentence (and the RFC is to blame as it uses this wording) and hence conclusions that follow from that have tended to be false.&lt;br/&gt;
&lt;br/&gt;
In this case, what the JSON RFC should say is that JSON should be encoded from Unicode, which means that the encoding could be anything from ISO-8859-1 to Shift JIS, which means that we cannot &amp;quot;unambiguously determine the encoding from the content.&amp;quot; Even if we decided to only allow UTF-8, UTF-16, or UTF-32, we could only &amp;quot;unambiguously determine the encoding&amp;quot; if the request body included the BOM, which is entirely optional. So again, without the Content-Encoding information, we are forced to use a heuristic. Heuristics already exist, and where they are not already available in Erlang, I rather suspect that they can be ported with relative ease.&lt;br/&gt;
&lt;br/&gt;
If we can access the Content-Encoding, we should absolutely use it, and absolutely reject as garbage any request that could not be decoded with the explicit encoding. Any patch that will-fully ignored this information only to fall back onto a heuristic would get my emphatic veto. I am however satisfied with requiring UTF-8 in the short term, and adding Content-Encoding awareness at some later point.</comment>
                    <comment id="12749207" author="kocolosk" created="Sat, 29 Aug 2009 23:06:35 +0000 (UTC)"  >Hi Curt, thanks for all your work on this ticket.  I did a bit of simple benchmarking using code from the eep0018 project, which indicated that couch_db:json_decode increased decoding time by about 12% over trunk.  The patch I submitted added about 4%.  I wouldn&apos;t put much stock in the difference between these numbers, but it does support your expectation that xmerl_ucs:from_utf8 is fast compared to the actual JSON decoding.&lt;br/&gt;
&lt;br/&gt;
I&apos;m comfortable with either patch.  I&apos;m not so concerned about diverging from stock MochiWeb.  We already diverge in order to correctly handle escaped UTF-16 surrogate pairs, and to use the generally-agreed-upon ejson  term format instead of the {obj, Data} one in the stock distribution.  We submitted a patch for the surrogate pair issue quite a while ago, but it hasn&apos;t been applied.  We could submit a patch for this, too, as rejecting bad input is a feature that any JSON decoder should have.</comment>
                    <comment id="12749216" author="carnold@apache.org" created="Sun, 30 Aug 2009 02:18:30 +0000 (UTC)"  >I&apos;m guessing that the performance difference would be reduced if couch_db:json_decode were modified so it only called xmerl_ucs:from_utf8 when it encountered a byte value &amp;gt; 0x7F in the binary.  I&apos;ve leave to Adam to code and benchmark it to avoid demonstrating my Erlang newbieness.&lt;br/&gt;
</comment>
                    <comment id="12758726" author="janl" created="Wed, 23 Sep 2009 15:09:50 +0000 (UTC)"  >I&apos;d like to defer decision on this patch until after 0.10. I don&apos;t think this should block 0.10 and we can fix this in 0.10.x (x &amp;gt; 0) under the following conditions: the 0.10.0 release notes contain a link to this issue and explain that the current acceptance of non-utf8 input is discouraged and should not be relied upon as it will be removed in later releases.</comment>
                    <comment id="12758729" author="kocolosk" created="Wed, 23 Sep 2009 15:15:25 +0000 (UTC)"  >I&apos;m on board with that.  I don&apos;t have the time to properly benchmark the different patches at the moment, and if we&apos;re serious about patching mochijson2 to reject bad input we should get their thoughts on the matter as well.</comment>
                    <comment id="12758738" author="paul.joseph.davis" created="Wed, 23 Sep 2009 15:39:28 +0000 (UTC)"  >I&apos;d vote for applying Adam&apos;s patch to reject the utf-8 as a stop gap. Then when we become more enterprising we should patch mochiweb_request to mux the incoming body to utf-8. For the short term rejecting non-utf8 seems more sane than accepting it and rejecting to return the stored data.&lt;br/&gt;
&lt;br/&gt;
On a side note I see a note about xmerl_ucs:from_utf8 and friends. There&apos;s a unicode:is_7bit_clean (or similarly named) function that might be useful.</comment>
                    <comment id="12758741" author="kocolosk" created="Wed, 23 Sep 2009 15:50:07 +0000 (UTC)"  >I think we wanted to keep R12B-5 as the minimum Erlang version for 0.10, so that means no unicode module.</comment>
                    <comment id="12758844" author="carnold@apache.org" created="Wed, 23 Sep 2009 19:21:56 +0000 (UTC)"  >&amp;gt;I&apos;d like to defer decision on this patch until after 0.10. I don&apos;t think this should block 0.10 and we can fix this in 0.10.x (x &amp;gt; 0) under the following conditions: &amp;gt;the 0.10.0 release notes contain a link to this issue and explain that the current acceptance of non-utf8 input is discouraged and should not be relied &amp;gt;upon as it will be removed in later releases.&lt;br/&gt;
&lt;br/&gt;
The only people who would be intentionally inserting malformed documents would be those who are intentionally trying to crash a database.  Are you saying that people who are trying to attack a deployed CouchDB instance would be discouraged from using this attack since it might go away in the future?&lt;br/&gt;
&lt;br/&gt;
Without either of the patches, any CouchDB instance is vulnerable to serious degradation or failure from anyone who can put a document in the database.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12758878" author="kocolosk" created="Wed, 23 Sep 2009 20:56:46 +0000 (UTC)"  >Ok, I&apos;ve committed the patch I wrote to trunk and the 0.10 release branch.  I&apos;ll submit it upstream to the Mochi team as well.  We still need to address the issue of alternate encodings and Content-Encoding headers so we don&apos;t come across as &amp;quot;lazy and inconsiderate&amp;quot; :)</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12432497">COUCHDB-457</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12418063" name="badenc1.patch" size="1239" author="carnold@apache.org" created="Sat, 29 Aug 2009 15:59:26 +0000 (UTC)" />
            <attachment id="12407404" name="badtext.tar.gz" size="1295" author="wohali" created="Wed, 6 May 2009 22:22:22 +0000 (UTC)" />
            <attachment id="12418037" name="enctest.zip" size="3648" author="carnold@apache.org" created="Fri, 28 Aug 2009 23:38:16 +0000 (UTC)" />
            <attachment id="12418049" name="reject_invalid_utf8.patch" size="1876" author="kocolosk" created="Sat, 29 Aug 2009 06:10:30 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 23 Sep 2009 20:56:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 7 May 2009 01:31:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-344] can&apos;t start couchdb / ubuntu 9.04</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-344</link>

                    <description>&amp;gt;&amp;gt; ./couchdb &lt;br/&gt;
Apache CouchDB 0.9.0 (LogLevel=info) is starting.&lt;br/&gt;
Failure to start Mochiweb: eaddrinuse&lt;br/&gt;
[error] [&amp;lt;0.52.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.52.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.52.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,couch_httpd},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,{exit,eaddrinuse,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,init_it,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{mochiweb_socket_server,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_secondary_services,couch_server_sup,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.44.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,610},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,435}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,{{badmatch,{error,shutdown}},[{couch_server_sup,start_server,1},{erl_eval,do_apply,5},{erl_eval,exprs,5},{init,start_it,1},{init,start_em,1}]}}&lt;br/&gt;
&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot ()&lt;br/&gt;
</description>
                <environment>Ubuntu 9.04</environment>
            <key id="12424762">COUCHDB-344</key>
        <summary>can&apos;t start couchdb / ubuntu 9.04</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="keo">Gr&#233;goire A.</reporter>
            
    <created>Wed, 6 May 2009 21:33:40 +0000 (UTC)</created>
    <updated>Wed, 6 May 2009 22:18:37 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12706600" author="keo" created="Wed, 6 May 2009 21:35:10 +0000 (UTC)"  >Crash dump</comment>
                    <comment id="12706616" author="janl" created="Wed, 6 May 2009 22:02:48 +0000 (UTC)"  >The line `{error_info,{exit,eaddrinuse,` suggest that a daemon is already bound to the ip address &amp;amp; port number that you are trying to bind CouchDB to. Maybe another CouchDB? Or if you changed the default port to, say 80, a web server like Apache?</comment>
                    <comment id="12706624" author="keo" created="Wed, 6 May 2009 22:18:37 +0000 (UTC)"  >thanks sorry for this issue&lt;br/&gt;
and thanks for your quick reply</comment>
                </comments>
    
    <attachments>
            <attachment id="12407393" name="erl_crash.dump" size="376307" author="keo" created="Wed, 6 May 2009 21:35:10 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 6 May 2009 22:02:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 6 May 2009 22:02:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-343] [PATCH] JSONP support</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-343</link>

                    <description>Adds support for JSONP, or JSON with Padding, which surrounds the response JSON object with a callback from the querystring ?callback=blah as blah({json_resp});&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/&quot;&gt;http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/&lt;/a&gt;&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12424603">COUCHDB-343</key>
        <summary>[PATCH] JSONP support</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="boorad">Brad Anderson</reporter>
            
    <created>Tue, 5 May 2009 13:58:53 +0000 (UTC)</created>
    <updated>Wed, 13 May 2009 03:34:39 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12708714" author="boorad" created="Wed, 13 May 2009 01:28:57 +0000 (UTC)"  >Forgot this file in the patch</comment>
                    <comment id="12708740" author="paul.joseph.davis" created="Wed, 13 May 2009 03:34:39 +0000 (UTC)"  >Fixed in r774180</comment>
                </comments>
    
    <attachments>
            <attachment id="12407954" name="jsonp.js" size="2287" author="boorad" created="Wed, 13 May 2009 01:28:57 +0000 (UTC)" />
            <attachment id="12407240" name="jsonp.patch" size="9516" author="boorad" created="Tue, 5 May 2009 14:00:12 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 13 May 2009 03:34:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 13 May 2009 03:34:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-342] url-encode attachment paths during replication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-342</link>

                    <description>fixed this a while back (&lt;a href=&apos;mailto:trunk@765364&apos;&gt;trunk@765364&lt;/a&gt;, &lt;a href=&apos;mailto:0.9.1@765365&apos;&gt;0.9.1@765365&lt;/a&gt;), adding JIRA ticket for posterity&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12424598">COUCHDB-342</key>
        <summary>url-encode attachment paths during replication</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 5 May 2009 13:01:07 +0000 (UTC)</created>
    <updated>Tue, 5 May 2009 13:01:15 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="0">0h</timeoriginalestimate>        <timeestimate seconds="0">0h</timeestimate>                    

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 5 May 2009 13:01:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-341] No way to reconstruct true path in _list and _show functions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-341</link>

                    <description>The req.path variable is a list of path components.  However, it is impossible, for example, to tell whether the actual path ends in &apos;/&apos; or not.  I propose putting the true path into req.path as a string, and using a (JavaScript) helper function to split it into components instead.  Alternatively the empty string &apos;&apos; could be appended to the list for paths ending in &apos;/&apos;, but I think this is probably more confusing.</description>
                <environment></environment>
            <key id="12424320">COUCHDB-341</key>
        <summary>No way to reconstruct true path in _list and _show functions</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Thu, 30 Apr 2009 16:51:20 +0000 (UTC)</created>
    <updated>Thu, 30 Apr 2009 16:51:20 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-340] Canonical URLs: Issue redirects where appropriate</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-340</link>

                    <description>We should issue a redirect from &lt;a href=&quot;http://127.0.0.1:5984/dbname&quot;&gt;http://127.0.0.1:5984/dbname&lt;/a&gt; -&amp;gt; &lt;a href=&quot;http://127.0.0.1:5984/dbname/&quot;&gt;http://127.0.0.1:5984/dbname/&lt;/a&gt; (note trailing slash) as the latter seems more appropriate to represent the hierarchy.  As for document URLs, I am thinking they should probably also have a trailing slash, as it is possible to have document attachments at the next level of the hierarchy.  When using _show, this would also mean links to attachments would be simpler.&lt;br/&gt;
&lt;br/&gt;
As for view URLs (and _list), I don&apos;t see any reason for them to have trailing slashes.  In these cases, we should probably issue a 301 to the non-trailing-slash URL, or issue a 404.</description>
                <environment></environment>
            <key id="12424309">COUCHDB-340</key>
        <summary>Canonical URLs: Issue redirects where appropriate</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Thu, 30 Apr 2009 15:53:53 +0000 (UTC)</created>
    <updated>Thu, 30 Apr 2009 15:53:53 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-339] Configurable (globally and per database) full_commit default setting</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-339</link>

                    <description>[couchdb]&lt;br/&gt;
force_full_commit = true; or false&lt;br/&gt;
&lt;br/&gt;
[per_db_settings]&lt;br/&gt;
dbname1_full_commit = false; or true&lt;br/&gt;
dbname2_full_commit = true; or false&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12424263">COUCHDB-339</key>
        <summary>Configurable (globally and per database) full_commit default setting</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="apokalyptik">Demitrious S. Kelly</reporter>
            
    <created>Thu, 30 Apr 2009 07:38:43 +0000 (UTC)</created>
    <updated>Thu, 30 Apr 2009 07:41:23 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12704514" author="apokalyptik" created="Thu, 30 Apr 2009 07:41:23 +0000 (UTC)"  >Decided to go keep the changes in couchdb_http_db:update_doc because reading this option farther down the rabbit hole would have been messier and not significantly clearer (imo) </comment>
                </comments>
    
    <attachments>
            <attachment id="12406881" name="config_full_commit.diff" size="1991" author="apokalyptik" created="Thu, 30 Apr 2009 07:41:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-338] key, startkey, endkey query args passed to list function as strings, not JSON</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-338</link>

                    <description>In list function, req.query.[key|startkey|endkey] are strings such as &amp;quot;[\&amp;quot;foo\&amp;quot;]&amp;quot; instead of JSON such as [&amp;quot;foo&amp;quot;]. When constructing paging URLs using req.query.endkey, this argument is escaped once for each page traversal. The paging continues to work, but the URLs get longer and longer:&lt;br/&gt;
endkey=[&amp;quot;cat&amp;quot;,null]&lt;br/&gt;
endkey=&amp;quot;[\&amp;quot;cat\&amp;quot;,null]&amp;quot;&lt;br/&gt;
endkey=&amp;quot;\&amp;quot;[\\\&amp;quot;cat\\\&amp;quot;,null]\&amp;quot;&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Attached patch applies ?JSON_DECODE to these query arguments.</description>
                <environment>trunk @769507</environment>
            <key id="12424113">COUCHDB-338</key>
        <summary>key, startkey, endkey query args passed to list function as strings, not JSON</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="skeltoac">Andy Skelton</reporter>
            
    <created>Wed, 29 Apr 2009 00:49:35 +0000 (UTC)</created>
    <updated>Wed, 29 Apr 2009 00:56:00 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12703926" author="skeltoac" created="Wed, 29 Apr 2009 00:56:00 +0000 (UTC)"  >Ran Test Suite against Futon on Apache CouchDB  0.10.0a769507 with patch applied. All success.</comment>
                </comments>
    
    <attachments>
            <attachment id="12406721" name="query_to_json_terms.diff" size="1158" author="skeltoac" created="Wed, 29 Apr 2009 00:50:18 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-337] attachments from old/conflict revisions are not accessible via standalone API</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-337</link>

                    <description>Couch ignores rev qs parameter for attachment GETs.  I believe it should not.  Attaching proposed patch.</description>
                <environment></environment>
            <key id="12424085">COUCHDB-337</key>
        <summary>attachments from old/conflict revisions are not accessible via standalone API</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 28 Apr 2009 20:00:42 +0000 (UTC)</created>
    <updated>Mon, 4 May 2009 22:39:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12704200" author="damienkatz" created="Wed, 29 Apr 2009 16:40:58 +0000 (UTC)"  >Here is a replication test to show the failures of replicating conflicts with attachments, which doesn&apos;t yet pass with attachment_revisions.diff</comment>
                    <comment id="12704475" author="kocolosk" created="Thu, 30 Apr 2009 05:00:16 +0000 (UTC)"  >Hah, I knew the line &amp;quot;% TODO worry about revisions&amp;quot; would come back to bite me eventually!  Here&apos;s a patch for the replicator that passes that test.</comment>
                    <comment id="12705802" author="kocolosk" created="Mon, 4 May 2009 22:39:46 +0000 (UTC)"  >added attachment revision support in r771474&lt;br/&gt;
used revisions in attachment repl. in r771480</comment>
                </comments>
    
    <attachments>
            <attachment id="12406688" name="attachment_revisions.diff" size="3778" author="kocolosk" created="Tue, 28 Apr 2009 20:04:13 +0000 (UTC)" />
            <attachment id="12406873" name="conflict_attachment_replication.diff" size="1535" author="kocolosk" created="Thu, 30 Apr 2009 05:00:16 +0000 (UTC)" />
            <attachment id="12406802" name="replication_test.diff" size="1585" author="damienkatz" created="Wed, 29 Apr 2009 16:40:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 4 May 2009 22:39:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 29 Apr 2009 16:40:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-336] Would like errors in map function to be reported to client</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-336</link>

                    <description>At the moment, if a runtime error occurs in a map function, the document is silently excluded from the view and the client is none the wiser.&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -d &apos;{&amp;quot;foo&amp;quot;:&amp;quot;bar&amp;quot;}&apos; -X PUT &lt;a href=&quot;http://127.0.0.1:5984/test/doc1&quot;&gt;http://127.0.0.1:5984/test/doc1&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;doc1&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-3413565576&amp;quot;}&lt;br/&gt;
$ curl -d &apos;{&amp;quot;food&amp;quot;:&amp;quot;bar&amp;quot;}&apos; -X PUT &lt;a href=&quot;http://127.0.0.1:5984/test/doc2&quot;&gt;http://127.0.0.1:5984/test/doc2&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;doc2&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-2088327893&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
# Example 1: map function calls undefined function&lt;br/&gt;
$ curl -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emitt(null,null); }&amp;quot;}&apos; -H &apos;Content-Type: application/json&apos; -X POST &lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view&quot;&gt;http://127.0.0.1:5984/test/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:0,&amp;quot;rows&amp;quot;:[]}&lt;br/&gt;
&lt;br/&gt;
# Example 2: map function attempts to emit &apos;undefined&apos;&lt;br/&gt;
$ curl -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emit(doc._id,doc.foo); }&amp;quot;}&apos; -H &apos;Content-Type: application/json&apos; -X POST &lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view&quot;&gt;http://127.0.0.1:5984/test/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;doc1&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;doc1&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;bar&amp;quot;}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
Of course, errors are available in the server log:&lt;br/&gt;
&lt;br/&gt;
[Tue, 28 Apr 2009 08:40:39 GMT] [info] [&amp;lt;0.1276.0&amp;gt;] OS Process Log Message: function raised exception (ReferenceError: emitt is not defined) with doc._id doc1&lt;br/&gt;
[Tue, 28 Apr 2009 08:43:44 GMT] [info] [&amp;lt;0.1276.0&amp;gt;] OS Process Log Message: function raised exception (Cannot encode &apos;undefined&apos; value as JSON) with doc._id doc2&lt;br/&gt;
&lt;br/&gt;
But the client cannot see these, and worse, gets what appears to be a valid result set.&lt;br/&gt;
&lt;br/&gt;
I think there are two cases to consider.&lt;br/&gt;
&lt;br/&gt;
- in temporary views, it ought to be easy to do something: e.g. (1) return the full set of failed docs with their errors, or (2) return a count of failed docs, or (3) just abort on the first error&lt;br/&gt;
&lt;br/&gt;
- in permanent views, it might also be useful to return this information, but it could be expensive to persist. Also, when you&apos;re querying for key X you might not want to see a whole load of errors for unrelated docs. An error count might be OK though, similar to total_rows.&lt;br/&gt;
&lt;br/&gt;
The current behaviour may be useful, although I personally wouldn&apos;t want to rely on it, especially as it generates errors in the log. That is, I would rather be forced to rewrite example 2 as&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;function(doc) { if (doc.foo) { emit(doc._id, doc.foo); } }&lt;br/&gt;
or&lt;br/&gt;
&amp;nbsp;&amp;nbsp;function(doc) { emit(doc._id, doc.foo || null); }&lt;br/&gt;
&lt;br/&gt;
as appropriate.&lt;br/&gt;
&lt;br/&gt;
Workaround: users can manually wrap each of their map functions in a catcher which emits a sentinel key/value pair containing the error. However they would still have to query the key range which includes the error messages.&lt;br/&gt;
</description>
                <environment>svn trunk 0.10.0a768591</environment>
            <key id="12423988">COUCHDB-336</key>
        <summary>Would like errors in map function to be reported to client</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Tue, 28 Apr 2009 09:07:23 +0000 (UTC)</created>
    <updated>Thu, 7 May 2009 08:18:22 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12703745" author="paul.joseph.davis" created="Tue, 28 Apr 2009 17:10:12 +0000 (UTC)"  >Chris Anderson had a patch that he was working on for this specifically. IIRC, his behavior was to throw an error at query time that reports the first error that was thrown from the map function. Not sure on the current status.</comment>
                    <comment id="12706200" author="candlerb" created="Tue, 5 May 2009 21:22:23 +0000 (UTC)"  >As an additional point: the error messages currently returned for a badly-formed map or reduce function are not as good as the standalone js is capable of producing. For example:&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc){val val=doc.k; emit(val||null,null);}&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view&quot;&gt;http://127.0.0.1:5984/test/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;compilation_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;expression does not eval to a function. (function(doc){val val=doc.k; emit(val||null,null);})&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
It&apos;s very common for a syntax error to return only &amp;quot;expression does not eval to a function&amp;quot;. However, pasting the same code into js gives a much more informative error, indicating both the nature of the error and its location.&lt;br/&gt;
&lt;br/&gt;
js&amp;gt; function(doc){val val=doc.k; emit(val||null,null);}&lt;br/&gt;
typein:1: SyntaxError: missing ; before statement:&lt;br/&gt;
typein:1: function(doc){val val=doc.k; emit(val||null,null);}&lt;br/&gt;
typein:1: ..................^&lt;br/&gt;
</comment>
                    <comment id="12706224" author="paul.joseph.davis" created="Tue, 5 May 2009 22:01:42 +0000 (UTC)"  >Error reporting like that is hard in JS. I&apos;ve tried to do it for python-spidermonkey but haven&apos;t quite got it nailed down. Granted it was never quite at the top of the priority list. If you can provide a patch that mimics the code on the JS shell I&apos;d give it a serious look to add to main.js but as I recall its a bit convoluted.</comment>
                    <comment id="12706742" author="candlerb" created="Thu, 7 May 2009 07:10:35 +0000 (UTC)"  >Strange,. When I  replicate the logic from  compileFunction() at the spidermonkey command line, it seems to catch the error just fine:&lt;br/&gt;
&lt;br/&gt;
js&amp;gt; sandbox = evalcx(&apos;&apos;);&lt;br/&gt;
[object sandbox]&lt;br/&gt;
js&amp;gt; try { f = eval(&amp;quot;function(doc){val val=doc.k; emit(val||null,null);}&amp;quot;, sandbox); } catch (err) { print(&amp;quot;OOPS: &amp;quot; + err); }&lt;br/&gt;
OOPS: SyntaxError: missing ; before statement&lt;br/&gt;
js&amp;gt; try { f = eval(&amp;quot;function(doc){val val=doc.k; emit(val||null,null);}&amp;quot;, sandbox); } catch (err) { print(&amp;quot;OOPS: &amp;quot; + err.toString()); }&lt;br/&gt;
OOPS: SyntaxError: missing ; before statement&lt;br/&gt;
&lt;br/&gt;
Maybe a js/spidermonkey expert can explain why this doesn&apos;t seem to work in main.js. Instead it falls through to the later test which checks whether typeof(functionObject) == &amp;quot;function&amp;quot;</comment>
                    <comment id="12706745" author="jchris" created="Thu, 7 May 2009 07:18:58 +0000 (UTC)"  >Until recently there was a bug in the couchjs interpreter that caused any syntax error to result in a process exit. I&apos;ve resolved that bug but haven&apos;t had a chance to see if we can do a better job reporting errors to the user. You should be able to make this cleaner just by hacking the files in share/server/</comment>
                    <comment id="12706759" author="candlerb" created="Thu, 7 May 2009 08:18:22 +0000 (UTC)"  >Sorry, my mistake for using eval instead of evalcx. The problem seems to be that evalcx silently catches and discards all errors:&lt;br/&gt;
&lt;br/&gt;
js&amp;gt; evalcx(&apos;junk(&apos;);&lt;br/&gt;
js&amp;gt; evalcx(&apos;throw(&amp;quot;wobbly&amp;quot;)&apos;);&lt;br/&gt;
js&amp;gt; result = evalcx(&apos;throw(&amp;quot;wobbly&amp;quot;)&apos;);&lt;br/&gt;
js&amp;gt; typeof result&lt;br/&gt;
undefined&lt;br/&gt;
js&amp;gt; &lt;br/&gt;
&lt;br/&gt;
I&apos;ll ask about this on dev-tech-javascript. At the moment, the only solution I can see is to eval() inside the evalcx(), which is ugly as it involves re-escaping the source string.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 28 Apr 2009 17:10:12 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-335] More 500 errors for malformed client requests</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-335</link>

                    <description>Here are four more cases where malformed client requests can return &amp;quot;500 Internal Server Error&amp;quot; (as shown by curl -v) with an unhelpful diagnostic message.&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/test&quot;&gt;http://127.0.0.1:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;docs&amp;quot;:[1,2,3]}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test/_bulk_docs&quot;&gt;http://127.0.0.1:5984/test/_bulk_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;function_clause&amp;quot;}&lt;br/&gt;
### 500 Internal Server Error&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;docs&amp;quot;:{&amp;quot;foo&amp;quot;:&amp;quot;bar&amp;quot;}}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test/_bulk_docs&quot;&gt;http://127.0.0.1:5984/test/_bulk_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;function_clause&amp;quot;}&lt;br/&gt;
### 500 Internal Server Error&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;[]&apos; -H &apos;Content-Type: application/json&apos; &lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view&quot;&gt;http://127.0.0.1:5984/test/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;&amp;quot;}&lt;br/&gt;
### 500 Internal Server Error&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{}&apos; -H &apos;Content-Type: application/json&apos; &lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view&quot;&gt;http://127.0.0.1:5984/test/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{{nocatch,{compilation_error,&amp;lt;&amp;lt;\&amp;quot;expression does not eval to a function. (undefined)\&amp;quot;&amp;gt;&amp;gt;}},\n [{couch_os_process,prompt,2},\n  {couch_query_servers,&apos;-start_doc_map/2-fun-0-&apos;,2},\n  {lists,foreach,2},\n  {couch_query_servers,start_doc_map,2},\n  {couch_view_updater,view_compute,2},\n  {couch_view_updater,update,1}]}&amp;quot;}&lt;br/&gt;
### 500 Internal Server Error&lt;br/&gt;
&lt;br/&gt;
See also &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-320&quot; title=&quot;[PATCH] Remove requirement for application/json from _temp_view&quot;&gt;&lt;strike&gt;COUCHDB-320&lt;/strike&gt;&lt;/a&gt; which gives another way to elicit a 500:&lt;br/&gt;
&lt;br/&gt;
curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(){}&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view&quot;&gt;http://127.0.0.1:5984/test/_temp_view&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;incorrect_mime_type&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;application/x-www-form-urlencoded&amp;quot;}&lt;br/&gt;
### 500 Internal Server Error&lt;br/&gt;
</description>
                <environment>SVN trunk &amp;quot;0.10.0a768591&amp;quot;</environment>
            <key id="12423982">COUCHDB-335</key>
        <summary>More 500 errors for malformed client requests</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Tue, 28 Apr 2009 08:02:18 +0000 (UTC)</created>
    <updated>Wed, 29 Apr 2009 11:00:05 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12703743" author="paul.joseph.davis" created="Tue, 28 Apr 2009 17:07:38 +0000 (UTC)"  >Thanks for the reports. Would it be possible for you to generate a test suite patch so that I don&apos;t make more mistakes when translating the curl errors?&lt;br/&gt;
&lt;br/&gt;
I&apos;m at a conference and I can&apos;t commit a whole bunch of time to this but failing tests would be helpful to make sure that I&apos;m fixing exactly what you&apos;ve found.</comment>
                    <comment id="12704066" author="candlerb" created="Wed, 29 Apr 2009 11:00:05 +0000 (UTC)"  >Test cases for errors 1-3 attached.&lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure what you want to return for case 4. Clearly we need the Javascript compilation error somehow, but I don&apos;t think the Erlang barf is needed.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12406762" name="error-tests.js" size="1792" author="candlerb" created="Wed, 29 Apr 2009 11:00:05 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 28 Apr 2009 17:07:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-334] With deferred commits and 100+ active dbs, CouchDB can lose uncommitted changes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-334</link>

                    <description>By default, CouchDB keeps a maximum of 100 databases open and active. This is controlled by the ini setting max_dbs_open in [couchdb] .&lt;br/&gt;
&lt;br/&gt;
This limit controls the number of Erlang server processes that are readily available and hold resources, like file handles, and hold state for deferred commits. Once CouchDB hits the open database limit, it will always close an idle database and files before opening a new database file. The problem is that CouchDB would consider instances to be idle even if they still had deferred commits pending. It would then close the instance and drop it&apos;s deferred commits.</description>
                <environment></environment>
            <key id="12423924">COUCHDB-334</key>
        <summary>With deferred commits and 100+ active dbs, CouchDB can lose uncommitted changes</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="damienkatz">Damien Katz</reporter>
            
    <created>Mon, 27 Apr 2009 19:07:36 +0000 (UTC)</created>
    <updated>Mon, 27 Apr 2009 21:58:37 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12703303" author="damienkatz" created="Mon, 27 Apr 2009 19:13:29 +0000 (UTC)"  >This fix should be pushed to 0.9.1</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 27 Apr 2009 19:13:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-333] Json handling of UTF8 strings not in accordance with rfc4627</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-333</link>

                    <description>Handling of some unicode values escaped in json format \uXXXX fails with &amp;quot;invalid_json&amp;quot; error.&lt;br/&gt;
&lt;br/&gt;
curl -X PUT -d &apos;{&amp;quot;revisions&amp;quot;:[],&amp;quot;_id&amp;quot;:&amp;quot;U_1d11e&amp;quot;,&amp;quot;codepoint&amp;quot;:&amp;quot;3441&amp;quot;,&amp;quot;definition&amp;quot;:&amp;quot;\uD834\uDD1E G clef character&amp;quot;}&apos; &lt;a href=&quot;http://localhost:5984/mydb/U_1d11e&quot;&gt;http://localhost:5984/mydb/U_1d11e&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
yields&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;invalid_json&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{\&amp;quot;revisions\&amp;quot;:[],\&amp;quot;_id\&amp;quot;:\&amp;quot;U_1d11e\&amp;quot;,\&amp;quot;codepoint\&amp;quot;:\&amp;quot;3441\&amp;quot;,\&amp;quot;definition\&amp;quot;:\&amp;quot;\\uD834\\uDD1E G clef character\&amp;quot;}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
When the RFC states:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;To escape an extended character that is not in the Basic Multilingual&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Plane, the character is represented as a twelve-character sequence,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;encoding the UTF-16 surrogate pair.  So, for example, a string&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;containing only the G clef character (U+1D11E) may be represented as&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;\uD834\uDD1E&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
Furthermore, couchdb accepts encoded strings of the format \uXXXXXXXX which is not mentioned as acceptable in the json rfc&lt;br/&gt;
&lt;br/&gt;
curl -X PUT -d &apos;{&amp;quot;revisions&amp;quot;:[],&amp;quot;_id&amp;quot;:&amp;quot;U_1d11e&amp;quot;,&amp;quot;codepoint&amp;quot;:&amp;quot;3441&amp;quot;,&amp;quot;definition&amp;quot;:&amp;quot;\u0001D11E G clef character&amp;quot;}&apos; &lt;a href=&quot;http://localhost:5984/mydb/U_1d11e&quot;&gt;http://localhost:5984/mydb/U_1d11e&lt;/a&gt;&lt;br/&gt;
Yields:&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;U_1d11e&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-1270273433&amp;quot;}&lt;br/&gt;
</description>
                <environment>couchdb 0.9.0  spidermonkey 0.7.0 erlang R12B3</environment>
            <key id="12423779">COUCHDB-333</key>
        <summary>Json handling of UTF8 strings not in accordance with rfc4627</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="couchmark">mark</reporter>
            
    <created>Sat, 25 Apr 2009 17:00:09 +0000 (UTC)</created>
    <updated>Mon, 8 Jun 2009 14:33:58 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12705889" author="couchmark" created="Tue, 5 May 2009 04:10:03 +0000 (UTC)"  >Issue has been reported upstream to mochiweb.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=35&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=35&lt;/a&gt;</comment>
                    <comment id="12716640" author="kocolosk" created="Fri, 5 Jun 2009 15:24:11 +0000 (UTC)"  >I submitted a patch to that issue in addition to the one that was already there.  This problem actually breaks replication, see&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-327&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-327&lt;/a&gt;</comment>
                    <comment id="12716643" author="kocolosk" created="Fri, 5 Jun 2009 15:30:07 +0000 (UTC)"  >here&apos;s the patch i submitted upstream</comment>
                    <comment id="12716720" author="damienkatz" created="Fri, 5 Jun 2009 18:52:32 +0000 (UTC)"  >I think we should add this to our mochiweb src until it&apos;s patched upstream. I&apos;d even like to see it in 0.9.1, since this problem can break replication.</comment>
                    <comment id="12717269" author="kocolosk" created="Mon, 8 Jun 2009 14:33:58 +0000 (UTC)"  >patch applied to trunk (r 782643) and 0.9.x (r 782645)</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12423316">COUCHDB-327</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12409996" name="utf16-surrogate-pairs.diff" size="1789" author="kocolosk" created="Fri, 5 Jun 2009 15:30:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 8 Jun 2009 14:33:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 5 Jun 2009 15:24:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-332] Reject documents whose ids start with underscore</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-332</link>

                    <description>docids which start with underscore are reserved for CouchDB. I believe they should be rejected to avoid confusion.&lt;br/&gt;
&lt;br/&gt;
Currently observed behaviour:&lt;br/&gt;
&lt;br/&gt;
(1) an attempt to PUT to /db/_docid succeeds, and creates a document whose ID starts with an underscore&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT -d &amp;quot;{}&amp;quot; &lt;a href=&quot;http://127.0.0.1:5984/foo/_xxx&quot;&gt;http://127.0.0.1:5984/foo/_xxx&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;_xxx&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-1751372641&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
(2) a POST to /db/_docid tries to do something and fails; possibly it could succeed given the right headers and body.&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &amp;quot;{}&amp;quot; &lt;a href=&quot;http://127.0.0.1:5984/foo/_yyy&quot;&gt;http://127.0.0.1:5984/foo/_yyy&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;bad_content_type&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Invalid Content-Type header for form upload&amp;quot;}&lt;br/&gt;
-- status line show 415 Unsupported Media Type&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This means that typos can result in confusing error messages; for example, a POST to /db/_tmp_view instead of /db/_temp_view. IMO it would be cleaner first to test the docid and reject it on that basis.&lt;br/&gt;
&lt;br/&gt;
(Sorry, I am not including a test suite submission. It will be much easier for someone who already knows their way around the rather large set of private libraries which the test suite contains. I currently use Ruby to talk to CouchDB, not ECMAscript)&lt;br/&gt;
</description>
                <environment>0.10.0a767851</environment>
            <key id="12423680">COUCHDB-332</key>
        <summary>Reject documents whose ids start with underscore</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Fri, 24 Apr 2009 08:42:06 +0000 (UTC)</created>
    <updated>Mon, 27 Apr 2009 21:02:15 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12703371" author="paul.joseph.davis" created="Mon, 27 Apr 2009 21:02:15 +0000 (UTC)"  >Fixed in trunk as of 769127.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 27 Apr 2009 21:02:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 27 Apr 2009 21:02:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-331] Allow reduce=true&amp;include_docs=false</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-331</link>

                    <description>If you query to a map/reduce view, then currently a request for&lt;br/&gt;
&amp;nbsp;&amp;nbsp;reduce=true&amp;amp;include_docs=false&lt;br/&gt;
is rejected as erroneous.&lt;br/&gt;
&lt;br/&gt;
It would be useful to allow this, to simplify clients which remember default options for a view (e.g. :reduce=&amp;gt;false,:include_docs=&amp;gt;true) and then override them for particular queries.&lt;br/&gt;
</description>
                <environment>0.10.0a767851</environment>
            <key id="12423676">COUCHDB-331</key>
        <summary>Allow reduce=true&amp;include_docs=false</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Fri, 24 Apr 2009 08:14:40 +0000 (UTC)</created>
    <updated>Sat, 25 Apr 2009 18:34:43 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12702290" author="candlerb" created="Fri, 24 Apr 2009 08:53:27 +0000 (UTC)"  >Test case</comment>
                    <comment id="12702739" author="jchris" created="Sat, 25 Apr 2009 18:11:36 +0000 (UTC)"  >+1 I agree we should be more relaxed in our approach here</comment>
                    <comment id="12702741" author="paul.joseph.davis" created="Sat, 25 Apr 2009 18:34:30 +0000 (UTC)"  >Whoops. This was me being a bit overzealous for rejecting bits. Definitely agree it shouldn&apos;t be an error.&lt;br/&gt;
&lt;br/&gt;
Fixed in trunk as of: r768573</comment>
                </comments>
    
    <attachments>
            <attachment id="12406345" name="test-reduce.diff" size="578" author="candlerb" created="Fri, 24 Apr 2009 08:53:27 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 25 Apr 2009 18:34:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 25 Apr 2009 18:11:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-330] throw an error when reduce function fails to reduce the data enough</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-330</link>

                    <description>This fixes a major source of documentation headaches by warning properly when a reduce function needs to be redesigned.&lt;br/&gt;
&lt;br/&gt;
Includes better error handling for query_servers in general.&lt;br/&gt;
&lt;br/&gt;
In progress: still needs an override flag for those who want to break the rules. I&apos;m putting this down for now but it&apos;s almost done. If someone picks it right up it&apos;ll be easy to get the rest of the tests passing I hope.&lt;br/&gt;
&lt;br/&gt;
Thanks!</description>
                <environment></environment>
            <key id="12423406">COUCHDB-330</key>
        <summary>throw an error when reduce function fails to reduce the data enough</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Tue, 21 Apr 2009 20:41:24 +0000 (UTC)</created>
    <updated>Fri, 19 Jun 2009 17:04:26 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12701259" author="jchris" created="Tue, 21 Apr 2009 20:42:23 +0000 (UTC)"  >attachment still has failing specs please review</comment>
                </comments>
    
    <attachments>
            <attachment id="12406054" name="reduce_limit.diff" size="6113" author="jchris" created="Tue, 21 Apr 2009 20:42:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 19 Jun 2009 17:04:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-329] Replication from Futon does not copy design docs with admin authentication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-329</link>

                    <description>If I go into Futon, and select local to local replication. Admin authentication is turned on. I enter the credentials. Then it begins replicating, but fails on design documents. This should work, or at least one shouldn&apos;t have to specify a local database as a &amp;quot;remote&amp;quot; to get it to work.</description>
                <environment>Mac OS, Linux</environment>
            <key id="12423395">COUCHDB-329</key>
        <summary>Replication from Futon does not copy design docs with admin authentication</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="garbetsp">Shawn Garbett</reporter>
            
    <created>Tue, 21 Apr 2009 17:57:58 +0000 (UTC)</created>
    <updated>Tue, 21 Apr 2009 17:58:21 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12419197">COUCHDB-303</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-328] [patch] allow futon reduce textareas to contain accidental white spaces.  </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-328</link>

                    <description>simple patch, so that an accidental white space character dont return a cryptic &apos;Badmatch: ......&apos;   javascript alert. </description>
                <environment>ubuntu 8.10</environment>
            <key id="12423341">COUCHDB-328</key>
        <summary>[patch] allow futon reduce textareas to contain accidental white spaces.  </summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="kij">Kevin Ilchmann J&#248;rgensen</reporter>
            
    <created>Tue, 21 Apr 2009 06:47:29 +0000 (UTC)</created>
    <updated>Wed, 22 Jul 2009 21:41:54 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12709574" author="kij" created="Thu, 14 May 2009 20:37:59 +0000 (UTC)"  >&amp;nbsp;use === for comparison</comment>
                    <comment id="12725216" author="kocolosk" created="Mon, 29 Jun 2009 15:22:35 +0000 (UTC)"  >pushing back to 1.0</comment>
                    <comment id="12734342" author="cmlenz" created="Wed, 22 Jul 2009 21:41:54 +0000 (UTC)"  >Applied simplified patch in r796888.</comment>
                </comments>
    
    <attachments>
            <attachment id="12406001" name="check_reduceVal.patch" size="1257" author="kij" created="Tue, 21 Apr 2009 06:51:48 +0000 (UTC)" />
            <attachment id="12408182" name="check_reduceVal2.patch" size="1245" author="kij" created="Thu, 14 May 2009 20:37:59 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 22 Jul 2009 21:41:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 15:22:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-327] Replication of document results in invalid_json error</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-327</link>

                    <description>While replicating a document containing UTf8 characters replication fails with invalid_json errors in the receiving couch instance.&lt;br/&gt;
The test below will cause the replication error.&lt;br/&gt;
&lt;br/&gt;
couchTests.utf8_replication = function(debug) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (debug) debugger;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var host = CouchDB.host;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var texts = [];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var dbPairs = [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{source:&amp;quot;http://&amp;quot;+host+&amp;quot;/test_suite_db_a&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;target:&amp;quot;http://&amp;quot;+host+&amp;quot;/test_suite_db_b&amp;quot;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var dbA = new CouchDB(&amp;quot;test_suite_db_a&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var dbB = new CouchDB(&amp;quot;test_suite_db_b&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var numDocs = 10;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var xhr;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;for (var testPair = 0; testPair &amp;lt; dbPairs.length; testPair++) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var A = dbPairs[testPair].source&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var B = dbPairs[testPair].target&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;dbA.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;dbA.createDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;dbB.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;dbB.createDb();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;text = &amp;quot;�� Fakain: �� Faktor produksi yang digunakan hanya tenaga kerja saja. �� Kualitas ba&amp;quot;;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;dbA.save({_id:&amp;quot;1&amp;quot;, text:text})&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var result = CouchDB.replicate(A, B);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
};&lt;br/&gt;
</description>
                <environment>Ubuntu 8.10</environment>
            <key id="12423316">COUCHDB-327</key>
        <summary>Replication of document results in invalid_json error</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="greggmc">Matthew Gregg</reporter>
            
    <created>Mon, 20 Apr 2009 23:24:50 +0000 (UTC)</created>
    <updated>Mon, 8 Jun 2009 14:34:17 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12701000" author="janl" created="Tue, 21 Apr 2009 00:27:48 +0000 (UTC)"  >Can&apos;t reproduce. Can you add more information about the dependencie&apos;s versions and your operating system?</comment>
                    <comment id="12701011" author="greggmc" created="Tue, 21 Apr 2009 01:13:50 +0000 (UTC)"  >The following dependencies are installed, all via Ubuntu 8.10 packages.&lt;br/&gt;
Erlang:  12.b.5&lt;br/&gt;
ICU:  3.8.1&lt;br/&gt;
openssl: 0.9.8g&lt;br/&gt;
spidermonkey(libmozjs0d):  1.8.1&lt;br/&gt;
libcurl: 7.18.2&lt;br/&gt;
</comment>
                    <comment id="12701019" author="greggmc" created="Tue, 21 Apr 2009 02:37:13 +0000 (UTC)"  >Applying this patch &lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=32&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=32&lt;/a&gt; solve this issue for me.</comment>
                    <comment id="12716639" author="kocolosk" created="Fri, 5 Jun 2009 15:22:58 +0000 (UTC)"  >I also cannot get that particular utf8_replication test to fail, but I agree that there is a problem here.  I believe the root of the problem is mochijson2&apos;s inability to decode unicode characters outside the Basic Multilingual Plane that are transmitted escaped as UTF-16 surrogate pairs.  There&apos;s a couchdb and a  mochiweb issue for this:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-333&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-333&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=35&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=35&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Replication breaks on documents containing raw UTF-8 corresponding to Unicode outside the BMP, because the mochijson2 encoder transmits the characters as UTF-16 surrogate pairs, but the decoder on the decoder on the other end can&apos;t handle that.&lt;br/&gt;
&lt;br/&gt;
Matthew was able to work around the problem by making the encoder transmit raw unicode instead of escaped.  I thought we were discussing switching to that mode of operation in another ticket, but I can&apos;t find it at the moment.&lt;br/&gt;
&lt;br/&gt;
I submitted a patch for this to mochiweb (in addition to one that was already available), but we can also apply it in our repo now if so desired.&lt;br/&gt;
</comment>
                    <comment id="12717270" author="kocolosk" created="Mon, 8 Jun 2009 14:34:17 +0000 (UTC)"  >patch applied to trunk (r 782643) and 0.9.x (r 782645)</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12423779">COUCHDB-333</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 8 Jun 2009 14:34:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Apr 2009 00:27:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-326] Occasional {&quot;error&quot;:&quot;error&quot;,&quot;reason&quot;:&quot;eacces&quot;} errors deleting a database on Windows</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-326</link>

                    <description>On Windows, occasionally you will see errors attempting to delete a database.   This manifests itself by 10-30% of the test suite failing on Windows.  If you retry the tests that failed, they will usually pass on subsequent attempts.  Running the tests individually causes them to fail roughly 10% of the time.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;The log output shown is:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[debug] [&amp;lt;0.18650.6&amp;gt;] httpd 500 error response:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;eacces&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[info] [&amp;lt;0.18650.6&amp;gt;] 127.0.0.1 - - &apos;DELETE&apos; /test_suite_db/ 500&lt;br/&gt;
&lt;br/&gt;
A slightly snipped transcript from IRC:&lt;br/&gt;
&lt;br/&gt;
(2:58:32 PM) markh: I see a number of INFO logs &amp;quot;Shutting down view group server, monitored db is closing.&amp;quot; directly before the error.  I was guessing the file may be unlink&apos;d before one of those workers actually closes its handle?&lt;br/&gt;
(2:58:54 PM) alisdair: yeah, it&apos;s probably a race condition&lt;br/&gt;
(2:59:13 PM) alisdair: where the delete is tried before the fd is let go&lt;br/&gt;
(2:59:26 PM) alisdair: the reader fd that is&lt;br/&gt;
(2:59:32 PM) markh: yeah&lt;br/&gt;
...&lt;br/&gt;
(3:11:47 PM) alisdair: i can&apos;t find an obvious deadlock&lt;br/&gt;
(3:12:18 PM) alisdair: couch_server:delete explicitly waits for the db process to exit&lt;br/&gt;
(3:12:23 PM) alisdair: before deleting it&lt;br/&gt;
(3:15:15 PM) alisdair: i think i found the problem&lt;br/&gt;
(3:15:23 PM) alisdair: but i need a windows machine to confirm&lt;br/&gt;
(3:15:30 PM) alisdair: i&apos;ll look into it tomorrow&lt;br/&gt;
</description>
                <environment>Windows, couch 0.9, erlang R12B 5.6.5</environment>
            <key id="12423187">COUCHDB-326</key>
        <summary>Occasional {&quot;error&quot;:&quot;error&quot;,&quot;reason&quot;:&quot;eacces&quot;} errors deleting a database on Windows</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Sat, 18 Apr 2009 05:59:01 +0000 (UTC)</created>
    <updated>Sun, 24 Jan 2010 23:49:07 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12700990" author="alisdair" created="Mon, 20 Apr 2009 23:50:02 +0000 (UTC)"  >exit(Pid, kill),&lt;br/&gt;
receive {&apos;EXIT&apos;, Pid, close} -&amp;gt; ok end,&lt;br/&gt;
&lt;br/&gt;
To achieve a clean shutdown of the db and it&apos;s child processes, you need to send it a signal other than kill and give it a chance to shutdown and cleanup it&apos;s processes. The receive here doesn&apos;t do anything as a killed process sends the &apos;EXIT&apos; msg immediately upon being killed.</comment>
                    <comment id="12721585" author="mhammond" created="Fri, 19 Jun 2009 00:36:31 +0000 (UTC)"  >Just got some clarification from damien:&lt;br/&gt;
&lt;br/&gt;
(10:33:56 AM) damienkatz: it waits to get the killed message, but the point isn&apos;t to wait for an orderly shutdown, just to clear the message.&lt;br/&gt;
(10:34:16 AM) markh: right - so that receive does do something important...&lt;br/&gt;
(10:34:44 AM) damienkatz: yes, if it didn&apos;t, the couch_server process would die.&lt;br/&gt;
(10:35:08 AM) damienkatz: as it would get the message later and not know where it came from, so it assumes something bad happened.&lt;br/&gt;
</comment>
                    <comment id="12804331" author="toothrot" created="Sun, 24 Jan 2010 23:49:07 +0000 (UTC)"  >This issue still exists in the windows binary installer version 0.11.0b897093</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 20 Apr 2009 23:50:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-325] Memory Leak in 9.0?</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-325</link>

                    <description>I am using couchrest to transform a document from one database to another (millions of records). The memory usage continues to increase till all the memory is used. The process occasionally fails, but usually completes. I dont know enough about ruby/couchrest/couchdb to be able to tell you where the memory is increasing from - but  if you give me some direction, I will be happy to take a look. &lt;br/&gt;
&lt;br/&gt;
If I comment out the save, it seems ok. &lt;br/&gt;
&lt;br/&gt;
Here is the code:&lt;br/&gt;
&lt;br/&gt;
--------------------------------&lt;br/&gt;
&lt;br/&gt;
require &apos;rubygems&apos;&lt;br/&gt;
require &apos;couchrest&apos;&lt;br/&gt;
&lt;br/&gt;
@db = CouchRest.database!(&amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/xfpds_2008&quot;&gt;http://127.0.0.1:5984/xfpds_2008&lt;/a&gt;&amp;quot;)&lt;br/&gt;
@db2 = CouchRest.database!(&amp;quot;&lt;a href=&quot;http://127.0.0.1:5984/fpds_2008&quot;&gt;http://127.0.0.1:5984/fpds_2008&lt;/a&gt;&amp;quot;)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
@streamer = CouchRest::Streamer.new(@db)&lt;br/&gt;
@streamer.view(&amp;quot;_all_docs&amp;quot;) do |row|&lt;br/&gt;
begin&lt;br/&gt;
&lt;br/&gt;
doc = @db.get(row[&amp;quot;id&amp;quot;])&lt;br/&gt;
&lt;br/&gt;
# remove id so the new database gets fresh document&lt;br/&gt;
doc.delete(&amp;quot;_id&amp;quot;)&lt;br/&gt;
doc.delete(&amp;quot;_rev&amp;quot;)&lt;br/&gt;
&lt;br/&gt;
# change badgerfish notation to assign $ key value to parent&lt;br/&gt;
doc[&amp;quot;amounts&amp;quot;][&amp;quot;obligatedAmount&amp;quot;] =  doc[&amp;quot;amounts&amp;quot;][&amp;quot;obligatedAmount&amp;quot;][&amp;quot;$&amp;quot;]&lt;br/&gt;
doc[&amp;quot;amounts&amp;quot;][&amp;quot;baseAndAllOptionsValue&amp;quot;] =  doc[&amp;quot;amounts&amp;quot;][&amp;quot;baseAndAllOptionsValue&amp;quot;][&amp;quot;$&amp;quot;]&lt;br/&gt;
doc[&amp;quot;amounts&amp;quot;][&amp;quot;baseAndExercisedOptionsValue&amp;quot;] =  doc[&amp;quot;amounts&amp;quot;][&amp;quot;baseAndExercisedOptionsValue&amp;quot;][&amp;quot;$&amp;quot;]&lt;br/&gt;
&lt;br/&gt;
...... A whole bunch of fields&lt;br/&gt;
&lt;br/&gt;
# save the document using bulk save&lt;br/&gt;
response =  @db2.save_doc(doc,true)&lt;br/&gt;
&lt;br/&gt;
rescue&lt;br/&gt;
&amp;nbsp;&amp;nbsp;# if streamer ends, save last few documents&lt;br/&gt;
&amp;nbsp;&amp;nbsp;@db2.bulk_save&lt;br/&gt;
end&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
end&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>gentoo linux on c1.medium aws instance</environment>
            <key id="12422792">COUCHDB-325</key>
        <summary>Memory Leak in 9.0?</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ramarnat">Rohit Amarnath</reporter>
            
    <created>Tue, 14 Apr 2009 13:47:58 +0000 (UTC)</created>
    <updated>Wed, 15 Apr 2009 13:33:26 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12698780" author="janl" created="Tue, 14 Apr 2009 14:11:24 +0000 (UTC)"  >Can you add some information about what exactly is eating the memory? Ruby or CouchDB?&lt;br/&gt;
</comment>
                    <comment id="12698786" author="ramarnat" created="Tue, 14 Apr 2009 14:29:04 +0000 (UTC)"  >Not sure, could you point me in the direction of some tool I could install and run to give you that info?&lt;br/&gt;
</comment>
                    <comment id="12698850" author="ramarnat" created="Tue, 14 Apr 2009 17:44:24 +0000 (UTC)"  >I added the following code to the ruby program:&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
memory_usage = `ps -o rss= -p #{Process.pid}`.to_i # physical memory in kilobytes&lt;br/&gt;
memory_usage = memory_usage + `ps -o vsz= -p #{Process.pid}`.to_i # Virtual memory in kilobytes&lt;br/&gt;
&lt;br/&gt;
if memory_usage &amp;gt; memory_last&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;puts &amp;quot;memory increased by #{memory_usage - memory_last} KB to #{memory_usage/1024} MB&amp;quot;&lt;br/&gt;
elsif memory_usage &amp;lt; memory_last&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;puts &amp;quot;memory decreased by #{memory_usage - memory_last} KB to #{memory_usage/1024} MB&amp;quot;&lt;br/&gt;
end&lt;br/&gt;
&lt;br/&gt;
memory_last = memory_usage&lt;br/&gt;
&lt;br/&gt;
The memory for ruby goes up to about 260MB and hovers between 230MB and 260MB, but the memory usage on the system continues to increase to the max. Everytime it does a bulk load the memory goes up by 30MB, but then the garbage collector kicks in and reduces it back to 230MB.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12699191" author="ramarnat" created="Wed, 15 Apr 2009 13:33:26 +0000 (UTC)"  >Looks like using htop, I was able to identify the memory usage as caches. So am closing this. </comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 15 Apr 2009 13:33:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 14 Apr 2009 14:11:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-324] startkey and endkey don&apos;t work with ~ or %7E</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-324</link>

                    <description>The following range queries don&apos;t work as expected&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;startkey=&amp;quot;a&amp;quot;&amp;amp;endkey=&amp;quot;a~&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;startkey=&amp;quot;a&amp;quot;&amp;amp;endkey=&amp;quot;a%7E&amp;quot;&lt;br/&gt;
&lt;br/&gt;
(Aside: I was hoping to use &amp;quot;foo&amp;quot; to &amp;quot;foo~&amp;quot; as a reasonably clean way of querying &amp;quot;any key beginning with foo&amp;quot;)&lt;br/&gt;
&lt;br/&gt;
The following testcase shows this for &amp;quot;a~&amp;quot;, since query doesn&apos;t encode it. However I wasn&apos;t sure how to test for &amp;quot;a%7E&amp;quot; cleanly.&lt;br/&gt;
&lt;br/&gt;
--- /home/brian/svn/couchdb/share/www/script/test/view_collation.js	2009-03-20 12:50:46.000000000 +0000&lt;br/&gt;
+++ view_collation.js	2009-04-09 11:23:20.000000000 +0100&lt;br/&gt;
@@ -109,4 +109,11 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;endkey : &amp;quot;b&amp;quot;, endkey_docid: &amp;quot;b&amp;quot;, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inclusive_end:false}).rows;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;T(rows[rows.length-1].key == &amp;quot;aa&amp;quot;)&lt;br/&gt;
+&lt;br/&gt;
+  // startkey and endkey with ~ (currently query doesn&apos;t encode this,&lt;br/&gt;
+  // but really we should test both a~ and a%7E)&lt;br/&gt;
+  var rows = db.query(queryFun, null, {startkey: &amp;quot;a&amp;quot;, endkey: &amp;quot;a~&amp;quot;}).rows;&lt;br/&gt;
+  T(rows.length == 3); // a, A, aa&lt;br/&gt;
+  var rows = db.query(queryFun, null, {startkey: &amp;quot;a~&amp;quot;, endkey: &amp;quot;b&amp;quot;}).rows;&lt;br/&gt;
+  T(rows.length == 1 &amp;amp;&amp;amp; rows[0].key == &amp;quot;b&amp;quot;);&lt;br/&gt;
&amp;nbsp;};&lt;br/&gt;
&lt;br/&gt;
Here are the actual results obtained using curl:&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emit(doc.foo, null); }&amp;quot;}&apos; &apos;&lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_temp_view?startkey=&quot;&gt;http://127.0.0.1:5984/test_suite_db/_temp_view?startkey=&lt;/a&gt;&amp;quot;a&amp;quot;&amp;amp;endkey=&amp;quot;a~&amp;quot;&apos;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:26,&amp;quot;offset&amp;quot;:7,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;7&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;a&amp;quot;,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;8&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;value&amp;quot;:null}&lt;br/&gt;
]}&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emit(doc.foo, null); }&amp;quot;}&apos; &apos;&lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_temp_view?startkey=&quot;&gt;http://127.0.0.1:5984/test_suite_db/_temp_view?startkey=&lt;/a&gt;&amp;quot;a&amp;quot;&amp;amp;endkey=&amp;quot;a%7E&amp;quot;&apos;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:26,&amp;quot;offset&amp;quot;:7,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;7&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;a&amp;quot;,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;8&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;value&amp;quot;:null}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
But what I was expecting was the same as range &amp;quot;a&amp;quot; to &amp;quot;az&amp;quot;:&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;map&amp;quot;:&amp;quot;function(doc) { emit(doc.foo, null); }&amp;quot;}&apos; &apos;&lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_temp_view?startkey=&quot;&gt;http://127.0.0.1:5984/test_suite_db/_temp_view?startkey=&lt;/a&gt;&amp;quot;a&amp;quot;&amp;amp;endkey=&amp;quot;az&amp;quot;&apos;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:26,&amp;quot;offset&amp;quot;:7,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;7&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;a&amp;quot;,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;8&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;A&amp;quot;,&amp;quot;value&amp;quot;:null},&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;9&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;aa&amp;quot;,&amp;quot;value&amp;quot;:null}&lt;br/&gt;
]}&lt;br/&gt;
</description>
                <environment>svn -r763553</environment>
            <key id="12422455">COUCHDB-324</key>
        <summary>startkey and endkey don&apos;t work with ~ or %7E</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Thu, 9 Apr 2009 10:28:32 +0000 (UTC)</created>
    <updated>Fri, 10 Apr 2009 08:18:47 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12697767" author="candlerb" created="Fri, 10 Apr 2009 08:18:47 +0000 (UTC)"  >This is expected behaviour from the Unicode Collation Algorithm. I have added some notes on this to&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/couchdb/View_collation&quot;&gt;http://wiki.apache.org/couchdb/View_collation&lt;/a&gt;&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 10 Apr 2009 08:18:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-323] add support to jquery.couch.js for &apos;keys&apos; param to all_docs view</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-323</link>

                    <description>jquery.couch.js currently doesn&apos;t allow you to execute a query via a POST passing keys in the request body.  I&apos;m attaching a patch which adds support for this.  It also changes the error message when hitting a view to include the name of the view - it seemed worthwhile to keep in the patch, but obviously isn&apos;t required.</description>
                <environment></environment>
            <key id="12422192">COUCHDB-323</key>
        <summary>add support to jquery.couch.js for &apos;keys&apos; param to all_docs view</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="mhammond">Mark Hammond</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Tue, 7 Apr 2009 02:19:05 +0000 (UTC)</created>
    <updated>Sun, 18 Oct 2009 00:50:06 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12766903" author="janl" created="Sat, 17 Oct 2009 12:59:28 +0000 (UTC)"  >Duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-376&quot; title=&quot;jquery.couch.js support of &amp;quot;keys&amp;quot; options in view function &quot;&gt;&lt;strike&gt;COUCHDB-376&lt;/strike&gt;&lt;/a&gt; which was fixed in r814573.</comment>
                    <comment id="12766998" author="mhammond" created="Sun, 18 Oct 2009 00:49:36 +0000 (UTC)"  >Sorry, I should have updated this bug earlier.  This is 1/2 out-of-date, but 1/2 not - specifically, the all_docs view still doesn&apos;t support keys. I&apos;ll update it.</comment>
                </comments>
    
    <attachments>
            <attachment id="12404793" name="jquery_view_keys.patch" size="3056" author="mhammond" created="Tue, 7 Apr 2009 02:20:25 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 17 Oct 2009 12:59:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-322] Specifying reduce=true on a view with no reduce does not cause an error.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-322</link>

                    <description>Specifying group=true when a view has no reduce function should probably throw an error. Any objections?</description>
                <environment>trunk</environment>
            <key id="12422174">COUCHDB-322</key>
        <summary>Specifying reduce=true on a view with no reduce does not cause an error.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Mon, 6 Apr 2009 23:26:35 +0000 (UTC)</created>
    <updated>Sat, 18 Apr 2009 16:19:03 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12696301" author="kocolosk" created="Mon, 6 Apr 2009 23:48:52 +0000 (UTC)"  >Fine by me, as long as the response status code is 400 and not 500.</comment>
                    <comment id="12700501" author="paul.joseph.davis" created="Sat, 18 Apr 2009 16:19:03 +0000 (UTC)"  >Fixed in trunk. Merging to 0.9.1</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 18 Apr 2009 16:19:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 6 Apr 2009 23:48:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-321] Futon breaks when used with a reverse proxy</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-321</link>

                    <description>It is often convenient to reverse proxy CouchDB at a url like /couch.  Unfortunately, while CouchDB will work perfectly in this situation, Futon cannot handle it as jquery.couch.js uses absolute URLs to access all CouchDB functions.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve attached a small patch that fixes this problem by:&lt;br/&gt;
&lt;br/&gt;
1. Adding a urlPrefix attribute to $.couch which it uses to construct its URLs.&lt;br/&gt;
2. Adding logic to the futon.js constructor that figures out a suitable prefix and sets $.couch.urlPrefix to use this.&lt;br/&gt;
&lt;br/&gt;
Any client code that makes use of $.couch will need to do something similar.  Since only the application and the adminstrator will know what the prefix should be or how to deduce it, I didn&apos;t really know of a better way to handle this.</description>
                <environment>Affects all platforms.</environment>
            <key id="12422170">COUCHDB-321</key>
        <summary>Futon breaks when used with a reverse proxy</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="metajack">Jack Moffitt</reporter>
            
    <created>Mon, 6 Apr 2009 22:28:33 +0000 (UTC)</created>
    <updated>Sat, 30 Jan 2010 01:22:49 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12696280" author="metajack" created="Mon, 6 Apr 2009 22:29:19 +0000 (UTC)"  >Patch attached for jquery.couch.js and futon.js.</comment>
                    <comment id="12709469" author="mikefrawley" created="Thu, 14 May 2009 17:04:45 +0000 (UTC)"  >Thanks Jack, I was having this same problem which was rather annoying.&lt;br/&gt;
&lt;br/&gt;
I used this simpler logic to get the urlPrefix:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;urlPrefix: window.location.pathname.split(&amp;quot;/_utils/&amp;quot;)[0]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I&apos;m wondering if prepending the urlPrefix should be done in $.ajaxsetup() instead of every ajax call, which could make it a bit easier to manage.&lt;br/&gt;
</comment>
                    <comment id="12709473" author="metajack" created="Thu, 14 May 2009 17:15:52 +0000 (UTC)"  >Mike, that looks great.  Perhaps you could attach a modified patch that moved the logic to $.ajaxsetup?</comment>
                    <comment id="12805767" author="gdamjan" created="Thu, 28 Jan 2010 03:58:56 +0000 (UTC)"  >In my opinion it would be better if Futon only uses relative urls. &lt;br/&gt;
That way it&apos;ll not require any hacks nor admin configuration.&lt;br/&gt;
&lt;br/&gt;
Here&apos;s a patch against 0.11.0b3fa3b673-git that implements this.&lt;br/&gt;
&lt;br/&gt;
With this patch all except one tests pass when running directly on CouchDB.&lt;br/&gt;
&lt;br/&gt;
Using Nginx as a proxy some of the tests fail regardless of if it&apos;s proxying on the root or on a usb-url, because Nginx rewrites url&apos;s (so any tests with test_suite_db%2Fwith_slashes fail). Also tests expecting the Server http header to be CouchDB fail too. The config.httpd.port == port check obviously fails too.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
The oauth test is the only one that fails without the proxy, and it&apos;s because it creates externall urls (http://) to which this patch prepends &amp;quot;..&amp;quot; There are several ways to solve this, but I think .request should have an _external flag or something.</comment>
                    <comment id="12805768" author="gdamjan" created="Thu, 28 Jan 2010 04:00:27 +0000 (UTC)"  >attaching the fix.&lt;br/&gt;
&lt;br/&gt;
ps. the nginx conf used for testing is:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;server {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;location / {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_pass         &lt;a href=&quot;http://127.0.0.1:5984;&quot;&gt;http://127.0.0.1:5984;&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   Host $host;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   X-Real-IP $remote_addr;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_redirect     off;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;location /db/ {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;rewrite            /db/(.*) /$1 break;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_pass         &lt;a href=&quot;http://127.0.0.1:5984;&quot;&gt;http://127.0.0.1:5984;&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   Host $host;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   X-Real-IP $remote_addr;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_redirect     off;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
</comment>
                    <comment id="12806593" author="janl" created="Sat, 30 Jan 2010 01:22:49 +0000 (UTC)"  >Applied in r904705.</comment>
                </comments>
    
    <attachments>
            <attachment id="12431636" name="futon-proxy-fix.diff" size="4733" author="gdamjan" created="Thu, 28 Jan 2010 04:00:27 +0000 (UTC)" />
            <attachment id="12404774" name="futon.patch" size="2868" author="metajack" created="Mon, 6 Apr 2009 22:29:19 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 30 Jan 2010 01:22:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 14 May 2009 17:04:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-320] [PATCH] Remove requirement for application/json from _temp_view</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-320</link>

                    <description>There is an anomolous check in _temp_view which insists on Content-Type: application/json&lt;br/&gt;
&lt;br/&gt;
Similar checks elsewhere in the code have already been removed.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>svn r762247</environment>
            <key id="12422092">COUCHDB-320</key>
        <summary>[PATCH] Remove requirement for application/json from _temp_view</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Mon, 6 Apr 2009 08:19:58 +0000 (UTC)</created>
    <updated>Wed, 29 Apr 2009 14:09:18 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12704069" author="candlerb" created="Wed, 29 Apr 2009 11:11:21 +0000 (UTC)"  >Test case</comment>
                    <comment id="12704123" author="kocolosk" created="Wed, 29 Apr 2009 14:09:18 +0000 (UTC)"  >Committed in r769792.  Thanks Brian</comment>
                </comments>
    
    <attachments>
            <attachment id="12404698" name="couchdb-temp-view.patch" size="782" author="candlerb" created="Mon, 6 Apr 2009 08:21:40 +0000 (UTC)" />
            <attachment id="12406764" name="test-ignore-content-type.js" size="668" author="candlerb" created="Wed, 29 Apr 2009 11:11:21 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 29 Apr 2009 14:09:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 29 Apr 2009 14:09:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-319] javascript is default language for views.   - not working for save and save-as</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-319</link>

                    <description>javascript is default language for views.  and works when run from the futon.  But save and save-as still requires a &amp;quot;language&amp;quot; : &amp;quot;javascript&amp;quot; key value in the _design/document. &lt;br/&gt;
&lt;br/&gt;
the checks are on  share/couchdb/www/script/futon.browse.js:434 and 388&lt;br/&gt;
</description>
                <environment>couchdb  0.9.0a762190 and 0.9.0 on ubuntu 8.10</environment>
            <key id="12422082">COUCHDB-319</key>
        <summary>javascript is default language for views.   - not working for save and save-as</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kij">Kevin Ilchmann J&#248;rgensen</reporter>
            
    <created>Mon, 6 Apr 2009 01:19:58 +0000 (UTC)</created>
    <updated>Tue, 14 Apr 2009 00:18:42 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12698597" author="kij" created="Tue, 14 Apr 2009 00:18:42 +0000 (UTC)"  >seems done.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;language : &amp;quot;javascript&amp;quot;  is added on save-as from temp. views or set on save - if not already set. </comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 14 Apr 2009 00:18:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-318] if the _attachments key&apos;s value, generated by uploading a file is overwritten. The admin interface fails with a object is null error on jquery.js?1.3.1 (line 666).</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-318</link>

                    <description>if the _attachments key&apos;s value, generated by uploading a file is overwritten. The admin interface fails with a object is null error on jquery.js?1.3.1 (line 666).&lt;br/&gt;
&lt;br/&gt;
reproduce by:  creating new document - attach file - add new field named &amp;quot;_attachments&amp;quot; - save document - observe javascript error.</description>
                <environment>Ubuntu 8.10  - using apache-couchdb-0.9.0.tar.gz  </environment>
            <key id="12422067">COUCHDB-318</key>
        <summary>if the _attachments key&apos;s value, generated by uploading a file is overwritten. The admin interface fails with a object is null error on jquery.js?1.3.1 (line 666).</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="kij">Kevin Ilchmann J&#248;rgensen</reporter>
            
    <created>Sun, 5 Apr 2009 12:54:11 +0000 (UTC)</created>
    <updated>Tue, 21 Jul 2009 21:43:15 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733841" author="cmlenz" created="Tue, 21 Jul 2009 21:43:15 +0000 (UTC)"  >Fixed in r796548.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 21:43:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 21:43:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-317] Badmatch error if _replicate target starts with slash</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-317</link>

                    <description>Giving a replication source or target which starts with a slash gives an Erlang barf error. (The wiki at &lt;a href=&quot;http://wiki.apache.org/couchdb/Replication&quot;&gt;http://wiki.apache.org/couchdb/Replication&lt;/a&gt; said that this slash was necessary. I will fix the wiki, but the error is still unsightly)&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;source&amp;quot;:&amp;quot;/foo&amp;quot;,&amp;quot;target&amp;quot;:&amp;quot;/bar&amp;quot;}&apos; &lt;a href=&quot;http://127.0.0.1:5984/_replicate&quot;&gt;http://127.0.0.1:5984/_replicate&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;case_clause&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{error,{{{badmatch,{error,illegal_database_name}},\n         [{couch_rep,init,1},\n          {gen_server,init_it,6},\n          {proc_lib,init_p,5}]},\n        {child,undefined,\&amp;quot;7898c2bfbbcf8adbb305371e6c3c949e\&amp;quot;,\n               {gen_server,start_link,\n                           [couch_rep,\n                            [\&amp;quot;7898c2bfbbcf8adbb305371e6c3c949e\&amp;quot;,\n                             {local,&amp;lt;&amp;lt;\&amp;quot;/foo\&amp;quot;&amp;gt;&amp;gt;,{user_ctx,null,[&amp;lt;&amp;lt;\&amp;quot;_admin\&amp;quot;&amp;gt;&amp;gt;]}},\n                             {local,&amp;lt;&amp;lt;\&amp;quot;/bar\&amp;quot;&amp;gt;&amp;gt;,\n                                    {user_ctx,null,[&amp;lt;&amp;lt;\&amp;quot;_admin\&amp;quot;&amp;gt;&amp;gt;]}}],\n                            []]},\n               transient,1,worker,\n               [couch_rep]}}}&amp;quot;}&lt;br/&gt;
</description>
                <environment>svn r761188</environment>
            <key id="12421875">COUCHDB-317</key>
        <summary>Badmatch error if _replicate target starts with slash</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Thu, 2 Apr 2009 14:11:26 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:24:21 +0000 (UTC)</updated>

                        <version>0.9.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772836" author="kocolosk" created="Tue, 3 Nov 2009 02:24:21 +0000 (UTC)"  >Confirmed that this is still a problem in 0.10.0.  I kinda think those paths ought to be valid, but either way we should certainly catch the illegal_database_name error.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Nov 2009 02:24:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-316] statistics(runtime) doesn&apos;t do what we think it does</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-316</link>

                    <description>I was looking at the runtime statistics and finding that {couchdb, request_time} was reporting values that seemed to be too small.  On further investigation I&apos;m fairly certain that the delta returned by statistics(runtime) is the time since that function was last called in *any* process.  That&apos;s not at all what we want -- in a highly concurrent system the values reported actually converge to zero!&lt;br/&gt;
&lt;br/&gt;
We could replace it with timer:now_diff.  That&apos;ll be a measure of wallclock time, not CPU, but I think wallclock may be the better metric anyway.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12421869">COUCHDB-316</key>
        <summary>statistics(runtime) doesn&apos;t do what we think it does</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Thu, 2 Apr 2009 13:38:15 +0000 (UTC)</created>
    <updated>Sat, 4 Apr 2009 21:48:44 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12695792" author="kocolosk" created="Sat, 4 Apr 2009 21:47:54 +0000 (UTC)"  >fixed in r762019</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 4 Apr 2009 21:47:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-315] Add Red Hat specific installation instructions in the README</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-315</link>

                    <description>Currently the README file for CouchDB has specific instructions for Debian-based (inc. Ubuntu) and Mac OS X systems. I had to adapt these instructions in order to be able to install CouchDB on Red Hat Enterprise Linux 5. I have attached a patch against the README file.</description>
                <environment>Red Hat Enterprise Linux 5</environment>
            <key id="12421862">COUCHDB-315</key>
        <summary>Add Red Hat specific installation instructions in the README</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="breun">Nils Breunese</reporter>
            
    <created>Thu, 2 Apr 2009 12:51:15 +0000 (UTC)</created>
    <updated>Thu, 2 Apr 2009 12:51:52 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
            <attachment id="12404439" name="README.patch" size="3301" author="breun" created="Thu, 2 Apr 2009 12:51:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-314] Release tarball contains directories with 777 permissions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-314</link>

                    <description>I unpacked the release tarball on Ubuntu 8.10 and Mac OS X 10.5.6 using the following tar mantra, which produces the desired result:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;$ tar zxvf apache-couchdb-0.9.0.tar.gz&lt;br/&gt;
&lt;br/&gt;
However, when running this command on Red Hat Enterprise Linux 5.3 all resulting directories have 777 permissions.&lt;br/&gt;
&lt;br/&gt;
Inspecting the tarball showed that the directories inside the tarball indeed have 777 permissions. Apparently Red Hat&apos;s tar is applying the -p/--preserve-permissions flag automatically, while this doesn&apos;t happen on Ubuntu and Mac OS X. That&apos;s why the directories look normal on Ubuntu and Mac OS X, as in that case the default umask is applied, which is generally set to 0022 and therefor yields 755 permissions for directories.&lt;br/&gt;
&lt;br/&gt;
I generally don&apos;t like having 777 directories on my system, especially when it serves no purpose, so could the release tarball maybe be altered to just have &apos;normal&apos; directories with 755 permissions?</description>
                <environment>Red Hat Enterprise Linux 5.3 fully updated</environment>
            <key id="12421853">COUCHDB-314</key>
        <summary>Release tarball contains directories with 777 permissions</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="breun">Nils Breunese</reporter>
            
    <created>Thu, 2 Apr 2009 09:55:49 +0000 (UTC)</created>
    <updated>Thu, 2 Apr 2009 11:50:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12694971" author="nslater" created="Thu, 2 Apr 2009 11:50:46 +0000 (UTC)"  >I found the following explanation:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/bug-automake@gnu.org/msg01303.html&quot;&gt;http://www.mail-archive.com/bug-automake@gnu.org/msg01303.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I am including it verbatim in this bug report in case it vanishes at any time.&lt;br/&gt;
&lt;br/&gt;
Hello Richard,&lt;br/&gt;
&lt;br/&gt;
thanks for the report.&lt;br/&gt;
&lt;br/&gt;
* Richard Cunningham wrote on Thu, Feb 26, 2009 at 03:32:03PM CET:&lt;br/&gt;
&amp;gt; I am finding that a number of packages come with tars with world write  &lt;br/&gt;
&amp;gt; on some the directories when unpacked (without a umask).&lt;br/&gt;
&amp;gt; I reported the issue to the lighttpd, who said:&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; &apos;please file a bug on autotools at the gnu website. they do this on  &lt;br/&gt;
&amp;gt; purpose for some unknown reason in &amp;quot;make dist&amp;quot;.&apos;&lt;br/&gt;
&amp;gt; &lt;a href=&quot;http://redmine.lighttpd.net/issues/1921&quot;&gt;http://redmine.lighttpd.net/issues/1921&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
If any, this would be an Automake bug rather than an Autoconf one.&lt;br/&gt;
Adding bug-automake in Cc:.&lt;br/&gt;
&lt;br/&gt;
I&apos;m not yet sure if it needs fixing, as a sensible umask avoids security&lt;br/&gt;
issues at unpacking time.  Anyway, the current code is mandated by the&lt;br/&gt;
GNU Coding Standards, so if would need changing, too:&lt;br/&gt;
&lt;br/&gt;
|    Make sure that the directory into which the distribution unpacks (as&lt;br/&gt;
| well as any subdirectories) are all world-writable (octal mode 777).&lt;br/&gt;
| This is so that old versions of `tar&apos; which preserve the ownership and&lt;br/&gt;
| permissions of the files from the tar archive will be able to extract&lt;br/&gt;
| all the files even if the user is unprivileged.&lt;br/&gt;
| &lt;br/&gt;
|    Make sure that all the files in the distribution are world-readable.&lt;br/&gt;
&lt;br/&gt;
The code in question lives in automake/lib/am/distdir.am and there&lt;br/&gt;
carries this comment:&lt;br/&gt;
&lt;br/&gt;
## This complex find command will try to avoid changing the modes of&lt;br/&gt;
## links into the source tree, in case they&apos;re hard-linked.  It will&lt;br/&gt;
## also make directories writable by everybody, because some&lt;br/&gt;
## brain-dead tar implementations change ownership and permissions of&lt;br/&gt;
## a directory before extracting the files, thus becoming unable to&lt;br/&gt;
## extract them.&lt;br/&gt;
##&lt;br/&gt;
## Ignore return result from chmod, because it might give an error&lt;br/&gt;
## if we chmod a symlink.&lt;br/&gt;
##&lt;br/&gt;
## Another nastiness: if the file is unreadable by us, we make it&lt;br/&gt;
## readable regardless of the number of links to it.  This only&lt;br/&gt;
## happens in perverse cases.&lt;br/&gt;
[...]&lt;br/&gt;
&lt;br/&gt;
This comment was added originally in:&lt;br/&gt;
&lt;br/&gt;
commit 2d5c3abead3f72c457d886b92b3fbd977d273191&lt;br/&gt;
Author: Alexandre Oliva &amp;lt;ol...@...&amp;gt;&lt;br/&gt;
Date:   Mon Jun 7 03:34:04 1999 +0000&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;* automake.in (dist_header): Avoid changing permissions of files&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;in the source tree, trying a complex `find/chmod&apos; command before&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;falling back to plain chmod.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(handle_dist_worker): Do not create directories with mode 777, the&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;find above will take care of that.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;* m4/init.m4: Set install_sh for find/chmod above.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Some discussion I can find from around this time in the old list&lt;br/&gt;
archive: &amp;lt;&lt;a href=&quot;http://sourceware.org/ml/automake/1999-05/msg00036.html&quot;&gt;http://sourceware.org/ml/automake/1999-05/msg00036.html&lt;/a&gt;&amp;gt;.&lt;br/&gt;
One should note that even then, the &amp;quot;old tar&amp;quot; versions hinted at in GCS&lt;br/&gt;
were considered old already.&lt;br/&gt;
&lt;br/&gt;
Hope that helps.&lt;br/&gt;
&lt;br/&gt;
Cheers,&lt;br/&gt;
Ralf&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 2 Apr 2009 11:50:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 2 Apr 2009 11:50:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-313] &apos;$&apos; in database name confuses behaviour of %2F in design doc ID</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-313</link>

                    <description>Normally, if you use %2F to separate _design from the rest of the URL, you get a 301 redirect:&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/mydb&quot;&gt;http://127.0.0.1:5984/mydb&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X PUT -d&amp;quot;{}&amp;quot; &lt;a href=&quot;http://127.0.0.1:5984/mydb/_design/test&quot;&gt;http://127.0.0.1:5984/mydb/_design/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;_design/test&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-481559718&amp;quot;}&lt;br/&gt;
$ curl -v &lt;a href=&quot;http://127.0.0.1:5984/mydb/_design%2Ftest&quot;&gt;http://127.0.0.1:5984/mydb/_design%2Ftest&lt;/a&gt;&lt;br/&gt;
...&lt;br/&gt;
&amp;lt; HTTP/1.1 301 Moved Permanently&lt;br/&gt;
&amp;lt; Server: CouchDB/0.9.0 (Erlang OTP/R12B)&lt;br/&gt;
&amp;lt; Location: &lt;a href=&quot;http://127.0.0.1:5984/mydb/_design/test&quot;&gt;http://127.0.0.1:5984/mydb/_design/test&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
However this logic is broken if you use a database which has a &apos;$&apos; in the name: you get a &apos;badmatch&apos; erlang error.&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db&quot;&gt;http://127.0.0.1:5984/my$db&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X PUT -d&apos;{}&apos; &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db/_design/test&quot;&gt;http://127.0.0.1:5984/my$db/_design/test&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;_design/test&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-4187139805&amp;quot;}&lt;br/&gt;
$ curl &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db/_design/test&quot;&gt;http://127.0.0.1:5984/my$db/_design/test&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;_id&amp;quot;:&amp;quot;_design/test&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;1-4187139805&amp;quot;}&lt;br/&gt;
$ curl &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db/_design%2Ftest&quot;&gt;http://127.0.0.1:5984/my$db/_design%2Ftest&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{ok,[\&amp;quot;/my$db/\&amp;quot;,\&amp;quot;test\&amp;quot;]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
$ is allowed in a database name according to the wiki (as long as it&apos;s not the first character), and otherwise appears to work OK. I have not tried other &apos;unusual&apos; characters.&lt;br/&gt;
</description>
                <environment>svn r761188&lt;br/&gt;
Ubuntu Hardy + Erlang 12B3 from Intrepid&lt;br/&gt;
</environment>
            <key id="12421843">COUCHDB-313</key>
        <summary>&apos;$&apos; in database name confuses behaviour of %2F in design doc ID</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Thu, 2 Apr 2009 08:14:19 +0000 (UTC)</created>
    <updated>Thu, 21 Jan 2010 06:40:23 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12803169" author="mwhooker" created="Thu, 21 Jan 2010 04:35:38 +0000 (UTC)"  >works fine for me off trunk. I think this can be closed.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db&quot;&gt;http://127.0.0.1:5984/my$db&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X PUT -d&apos;{}&apos; &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db/_design/test&quot;&gt;http://127.0.0.1:5984/my$db/_design/test&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;_design/test&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
$ curl &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db/_design/test&quot;&gt;http://127.0.0.1:5984/my$db/_design/test&lt;/a&gt;&apos;&lt;br/&gt;
{&amp;quot;_id&amp;quot;:&amp;quot;_design/test&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;1-967a00dff5e02add41819138abb3284d&amp;quot;}&lt;br/&gt;
$ curl -v &apos;&lt;a href=&quot;http://127.0.0.1:5984/my$db/_design%2Ftest&quot;&gt;http://127.0.0.1:5984/my$db/_design%2Ftest&lt;/a&gt;&apos;&lt;br/&gt;
* About to connect() to 127.0.0.1 port 5984 (#0)&lt;br/&gt;
*   Trying 127.0.0.1... connected&lt;br/&gt;
* Connected to 127.0.0.1 (127.0.0.1) port 5984 (#0)&lt;br/&gt;
&amp;gt; GET /my$db/_design%2Ftest HTTP/1.1&lt;br/&gt;
&amp;gt; User-Agent: curl/7.19.5 (i486-pc-linux-gnu) libcurl/7.19.5 OpenSSL/0.9.8g zlib/1.2.3.3 libidn/1.15&lt;br/&gt;
&amp;gt; Host: 127.0.0.1:5984&lt;br/&gt;
&amp;gt; Accept: */*&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;lt; HTTP/1.1 301 Moved Permanently&lt;br/&gt;
&amp;lt; Server: CouchDB/0.11.0b890693 (Erlang OTP/R13B)&lt;br/&gt;
&amp;lt; Location: &lt;a href=&quot;http://127.0.0.1:5984/my%24db/_design/test&quot;&gt;http://127.0.0.1:5984/my%24db/_design/test&lt;/a&gt;&lt;br/&gt;
&amp;lt; Date: Thu, 21 Jan 2010 04:33:39 GMT&lt;br/&gt;
&amp;lt; Content-Length: 0&lt;br/&gt;
&amp;lt; &lt;br/&gt;
* Connection #0 to host 127.0.0.1 left intact&lt;br/&gt;
* Closing connection #0</comment>
                    <comment id="12803198" author="candlerb" created="Thu, 21 Jan 2010 06:36:43 +0000 (UTC)"  >Yes, I concur.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 21 Jan 2010 06:36:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 21 Jan 2010 04:35:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-312] Release tarball should include INSTALL file</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-312</link>

                    <description></description>
                <environment></environment>
            <key id="12421669">COUCHDB-312</key>
        <summary>Release tarball should include INSTALL file</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Tue, 31 Mar 2009 13:56:53 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:29:13 +0000 (UTC)</updated>

                
                
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-311] Wrong encoded _external error message</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-311</link>

                    <description>The error message when no external server configuration is found is encoded as a list of bytes.&lt;br/&gt;
&lt;br/&gt;
To reproduce this bug, enable _external and browse &lt;a href=&quot;http://localhost:5984/geodata/_external/ithrowanerror&quot;&gt;http://localhost:5984/geodata/_external/ithrowanerror&lt;/a&gt;</description>
                <environment></environment>
            <key id="12421659">COUCHDB-311</key>
        <summary>Wrong encoded _external error message</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="vmx">Volker Mische</reporter>
            
    <created>Tue, 31 Mar 2009 12:38:38 +0000 (UTC)</created>
    <updated>Sat, 18 Apr 2009 16:37:34 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9.1</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12694086" author="vmx" created="Tue, 31 Mar 2009 12:39:58 +0000 (UTC)"  >This patch fixes the problem. I&apos;ve also renamed the variable &amp;quot;Mesg&amp;quot; to &amp;quot;Msg&amp;quot; as it seems to be the common name in the code base.</comment>
                    <comment id="12700504" author="paul.joseph.davis" created="Sat, 18 Apr 2009 16:37:34 +0000 (UTC)"  >Fixed in trunk and 0.9.x branches.</comment>
                </comments>
    
    <attachments>
            <attachment id="12404235" name="no-server-error.patch" size="797" author="vmx" created="Tue, 31 Mar 2009 12:39:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 18 Apr 2009 16:37:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 18 Apr 2009 16:37:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-310] Fix hardcoded redirect to &quot;/_utils/&quot;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-310</link>

                    <description>Find attached a patch that remove hard writing of &amp;quot;_utils&amp;quot; path in handle_utils_dir_req. It allows to really change the util path or use the handler to manage other path.</description>
                <environment>*</environment>
            <key id="12421494">COUCHDB-310</key>
        <summary>Fix hardcoded redirect to &quot;/_utils/&quot;</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sun, 29 Mar 2009 12:09:57 +0000 (UTC)</created>
    <updated>Sat, 18 Apr 2009 17:17:38 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                        <fixVersion>0.9.1</fixVersion>
                    <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12700508" author="paul.joseph.davis" created="Sat, 18 Apr 2009 17:15:32 +0000 (UTC)"  >Title was: &amp;quot;patch do make redirect depending of request path in handle_utils_dir_req&amp;quot;</comment>
                    <comment id="12700509" author="paul.joseph.davis" created="Sat, 18 Apr 2009 17:17:38 +0000 (UTC)"  >Fixed and merged to trunk and 0.9.x</comment>
                </comments>
    
    <attachments>
            <attachment id="12404076" name="couch_httpd_misc_handlers.erl.diff" size="1117" author="benoitc" created="Sun, 29 Mar 2009 12:10:16 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 18 Apr 2009 17:17:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 18 Apr 2009 17:15:32 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-309] Cannot build CouchDB from clean because build-aux directory doesn&apos;t exist</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-309</link>

                    <description>This commit: &lt;a href=&quot;http://github.com/halorgium/couchdb/commit/0f0df4cb3b80e78f32e6e3393eabd9b2ef13e673&quot;&gt;http://github.com/halorgium/couchdb/commit/0f0df4cb3b80e78f32e6e3393eabd9b2ef13e673&lt;/a&gt; removed the two files from build-aux. When checking out (via git at least) directories are implicit, so build-aux no longer exists, which stops bootstrap from working.&lt;br/&gt;
&lt;br/&gt;
To fix, add &apos;mkdir -p build-aux&apos; to bootstrap in place of the lines that were removed</description>
                <environment></environment>
            <key id="12419606">COUCHDB-309</key>
        <summary>Cannot build CouchDB from clean because build-aux directory doesn&apos;t exist</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="antonyblakey">Antony Blakey</reporter>
            
    <created>Fri, 27 Mar 2009 02:53:47 +0000 (UTC)</created>
    <updated>Tue, 31 Mar 2009 16:19:31 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12689799" author="antonyblakey" created="Fri, 27 Mar 2009 03:35:48 +0000 (UTC)"  >mkdir  =&amp;gt; mkdir -p</comment>
                    <comment id="12694169" author="nslater" created="Tue, 31 Mar 2009 16:19:31 +0000 (UTC)"  >Fixed in r760503. Thanks.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 31 Mar 2009 16:19:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 31 Mar 2009 16:19:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-308] Server-level index page should provide pointers to other available resources</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-308</link>

                    <description>It would be nice if the HTTP interface made it easy to find other relevant resources (i.e. don&apos;t require the API user to know the endpoints beforehand).</description>
                <environment></environment>
            <key id="12419549">COUCHDB-308</key>
        <summary>Server-level index page should provide pointers to other available resources</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Thu, 26 Mar 2009 16:30:34 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12689537" author="djc" created="Thu, 26 Mar 2009 16:31:33 +0000 (UTC)"  >Here&apos;s a patch to do this for the / info page.</comment>
                    <comment id="12689570" author="djc" created="Thu, 26 Mar 2009 17:45:26 +0000 (UTC)"  >Hmm, adding &amp;quot;admin&amp;quot;: &amp;quot;/_utils/&amp;quot; would probably also make sense.</comment>
                    <comment id="12700506" author="paul.joseph.davis" created="Sat, 18 Apr 2009 16:48:57 +0000 (UTC)"  >Was there a mailing list thread about this? At the very least this would need to be changed to pull the urls from the current config instead of hard coding the end points. Also what does this add beyond hitting the _config end point to get the list of other end points? Though _config might be gone or named differently. So maybe just a link to the _config end point? Now I&apos;ve managed to confuse myself.</comment>
                    <comment id="12772660" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
            <attachment id="12403723" name="server-links.diff" size="790" author="djc" created="Thu, 26 Mar 2009 16:31:32 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 18 Apr 2009 16:48:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-307] windows drive letters in &apos;database_dir&apos; breaks _all_dbs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-307</link>

                    <description>I had configured my default.ini with:&lt;br/&gt;
&lt;br/&gt;
[couchdb]&lt;br/&gt;
database_dir=C:/erl5.6.5/usr/couch_data&lt;br/&gt;
view_index_dir=C:/erl5.6.5/usr/couch_data&lt;br/&gt;
&lt;br/&gt;
Couch would start and futon would let me create a DB named &apos;test&apos;.  However, requesting _all_dbs resulted in:&lt;br/&gt;
&lt;br/&gt;
[&amp;quot;c/test&amp;quot;]&lt;br/&gt;
&lt;br/&gt;
Note the leading &apos;c/&apos;.  Requesting this database name obviously failed.  If I reconfigured couch to remove the &apos;C:&apos; from those settings, or even changed it to a lowercase &apos;c:&apos;, I got the expected:&lt;br/&gt;
&lt;br/&gt;
[&amp;quot;test&amp;quot;]&lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure if this is a real bug or simply a documentation issue?  Either way, its worth recording here for now.</description>
                <environment>windows trunk - r758137</environment>
            <key id="12419365">COUCHDB-307</key>
        <summary>windows drive letters in &apos;database_dir&apos; breaks _all_dbs</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mhammond">Mark Hammond</reporter>
            
    <created>Wed, 25 Mar 2009 04:04:45 +0000 (UTC)</created>
    <updated>Wed, 25 Mar 2009 04:04:45 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-306] Wacky error responses to malformed documents</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-306</link>

                    <description>Here are some error conditions where CouchDB provides very strange responses.&lt;br/&gt;
&lt;br/&gt;
---- Setup ----&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://127.0.0.1:5984/foo&quot;&gt;http://127.0.0.1:5984/foo&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
&lt;br/&gt;
---- example 1 ----&lt;br/&gt;
$ curl -d &amp;quot;[]&amp;quot; -X PUT &lt;a href=&quot;http://127.0.0.1:5984/foo/bar&quot;&gt;http://127.0.0.1:5984/foo/bar&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;bad_request&amp;quot;,&amp;quot;reason&amp;quot;:[68,111,99,117,109,101,110,116,32,109,117,115,116,32,98,101,32,97,32,74,83,79,78,32,111,98,106,101,99,116]}&lt;br/&gt;
&lt;br/&gt;
---- example 2 ----&lt;br/&gt;
$ curl -d &amp;quot;[]&amp;quot; -X PUT &lt;a href=&quot;http://127.0.0.1:5984/foo/_bulk_docs&quot;&gt;http://127.0.0.1:5984/foo/_bulk_docs&lt;/a&gt;&lt;br/&gt;
-- TCP connection is dropped on the floor, no response (not even HTTP 500 status)&lt;br/&gt;
&lt;br/&gt;
---- example 3 ----&lt;br/&gt;
$ curl -d &amp;quot;{}&amp;quot; -X POST &lt;a href=&quot;http://127.0.0.1:5984/foo/bar&quot;&gt;http://127.0.0.1:5984/foo/bar&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{\&amp;quot;application/x-www-form-urlencoded\&amp;quot;,[]}&amp;quot;}&lt;br/&gt;
$ curl -d &amp;quot;{}&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; -X POST &lt;a href=&quot;http://127.0.0.1:5984/foo/bar&quot;&gt;http://127.0.0.1:5984/foo/bar&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{\&amp;quot;application/json\&amp;quot;,[]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
---- example 4 ----&lt;br/&gt;
$ curl -d &apos;[]&apos; -X POST &lt;a href=&quot;http://127.0.0.1:5984/foo/_all_docs&quot;&gt;http://127.0.0.1:5984/foo/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
---- example 5 ----&lt;br/&gt;
$ curl -d &apos;{&amp;quot;keys&amp;quot;:&amp;quot;foo&amp;quot;}&apos; -X POST &lt;a href=&quot;http://127.0.0.1:5984/foo/_all_docs&quot;&gt;http://127.0.0.1:5984/foo/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;unknown_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;function_clause&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Of course, all of these are misuse of the API, but they may be seen by newcomers.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12419314">COUCHDB-306</key>
        <summary>Wacky error responses to malformed documents</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Tue, 24 Mar 2009 15:14:38 +0000 (UTC)</created>
    <updated>Tue, 21 Apr 2009 16:39:18 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9.1</fixVersion>
                    <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688714" author="janl" created="Tue, 24 Mar 2009 15:24:20 +0000 (UTC)"  >Brian, thanks for sending these in. For the future, can you write a .js file that we can integrate into the test suite? That way we can reliably fix any issues faster. Thanks!</comment>
                    <comment id="12700524" author="paul.joseph.davis" created="Sat, 18 Apr 2009 18:41:42 +0000 (UTC)"  >Fixed in trunk and 0.9.x</comment>
                    <comment id="12700530" author="candlerb" created="Sat, 18 Apr 2009 19:46:37 +0000 (UTC)"  >Examples 1, 4 and 5 now give sensible errors in the body, and example 2 gives a 405 Method Not Allowed response (albeit with an empty body). These are fine.&lt;br/&gt;
&lt;br/&gt;
However example 3 still gives its perplexing response:&lt;br/&gt;
&lt;br/&gt;
$ curl &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.9.0a766377&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
-- example 3&lt;br/&gt;
$ curl -d &amp;quot;{}&amp;quot; -X POST &lt;a href=&quot;http://127.0.0.1:5984/foo/bar&quot;&gt;http://127.0.0.1:5984/foo/bar&lt;/a&gt; &lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{\&amp;quot;application/x-www-form-urlencoded\&amp;quot;,[]}&amp;quot;}&lt;br/&gt;
$ curl -d &amp;quot;{}&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; -X POST &lt;a href=&quot;http://127.0.0.1:5984/foo/bar&quot;&gt;http://127.0.0.1:5984/foo/bar&lt;/a&gt; &lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;badmatch&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{\&amp;quot;application/json\&amp;quot;,[]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Both are with a 500 Internal Server Error&lt;br/&gt;
&lt;br/&gt;
I think a 405 would be more appropriate. The error is that the user tried to POST rather than PUT to update an attachment.&lt;br/&gt;
</comment>
                    <comment id="12700533" author="paul.joseph.davis" created="Sat, 18 Apr 2009 20:43:04 +0000 (UTC)"  >Doh!&lt;br/&gt;
&lt;br/&gt;
I meant to make a note that the JS I was trying wouldn&apos;t trigger #3. Now that I look harder it would appear to be a completely different bit of code than what I was even looking at. Plus the fact that curl and XHR are providing different headers which are causing that error.&lt;br/&gt;
&lt;br/&gt;
I didn&apos;t even realize that #2 was a PUT and not POST till just now. I wrote and tested changes to make sure there was a Json object passed as the body for POST though :D&lt;br/&gt;
&lt;br/&gt;
On a side note, this is a good example of why we like JS test submissions. A patch for the test-suite would&apos;ve caught both of these errors. Now that I see the error related to #3 I&apos;ll fix it as well.</comment>
                    <comment id="12701195" author="paul.joseph.davis" created="Tue, 21 Apr 2009 16:39:18 +0000 (UTC)"  >This is fixed in trunk and 0.9.x now.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Apr 2009 16:39:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Mar 2009 15:24:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-305] Warnings from the /usr/bin/couchdb script</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-305</link>

                    <description>When starting CouchDB, I get the following warnings:&lt;br/&gt;
&lt;br/&gt;
/usr/bin/couchdb: line 143: 0: command not found&lt;br/&gt;
/usr/bin/couchdb: line 147: 0: command not found&lt;br/&gt;
/usr/bin/couchdb: line 151: 0: command not found&lt;br/&gt;
</description>
                <environment>Gentoo, bash 3.2.39.</environment>
            <key id="12419293">COUCHDB-305</key>
        <summary>Warnings from the /usr/bin/couchdb script</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Tue, 24 Mar 2009 10:36:56 +0000 (UTC)</created>
    <updated>Tue, 24 Mar 2009 13:12:40 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688677" author="nslater" created="Tue, 24 Mar 2009 13:12:40 +0000 (UTC)"  >Fixed in r757772. Thanks.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Mar 2009 13:12:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Mar 2009 13:12:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-304] make dies with *** No rule to make target `default/couchdb&apos;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-304</link>

                    <description>It works with r755866, fails with r757406 (from the snapshots off of build.couchdb.org).</description>
                <environment>Happens in Gentoo, custom-made ebuild (see earlier ones in &lt;a href=&quot;http://hg.xavamedia.nl/portage/)&quot;&gt;http://hg.xavamedia.nl/portage/)&lt;/a&gt;.</environment>
            <key id="12419228">COUCHDB-304</key>
        <summary>make dies with *** No rule to make target `default/couchdb&apos;</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Mon, 23 Mar 2009 16:23:19 +0000 (UTC)</created>
    <updated>Mon, 23 Mar 2009 17:26:42 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688338" author="nslater" created="Mon, 23 Mar 2009 17:26:42 +0000 (UTC)"  >Works in Subversion HEAD.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 17:26:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 17:26:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-303] always have to pass credentials with replication to get design docs  when an admin is set</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-303</link>

                    <description>When you have set an admin to couchdb, even if you are already logged you need to pass username and password in url to replicate a database to another with design docs with futon interface.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12419197">COUCHDB-303</key>
        <summary>always have to pass credentials with replication to get design docs  when an admin is set</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 23 Mar 2009 08:10:14 +0000 (UTC)</created>
    <updated>Tue, 21 Apr 2009 17:58:21 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688257" author="janl" created="Mon, 23 Mar 2009 10:07:15 +0000 (UTC)"  >Replication does not run in the futon browser session, but separately and only between the source and target instances. This is expected behaviour.&lt;br/&gt;
</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12423395">COUCHDB-329</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 10:07:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 10:07:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-302] Permissions problems under Ubuntu</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-302</link>

                    <description>Couchdb install scripts not setting correct permissions under Ubuntu. First I did a complete wipe of all couchdb-related files and directories:&lt;br/&gt;
&lt;br/&gt;
$ sudo rm -rf /usr/local/var/lib/couchdb&lt;br/&gt;
$ sudo rm -rf /usr/local/lib/couchdb /usr/local/share/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb.pid /usr/local/etc/init.d/couchdb /usr/local/etc/logrotate.d/couchdb /usr/local/etc/default/couchdb /usr/local/bin/couch{db,js}&lt;br/&gt;
&lt;br/&gt;
Then after a &apos;make install&apos;:&lt;br/&gt;
&lt;br/&gt;
$ sudo /usr/local/etc/init.d/couchdb start&lt;br/&gt;
&amp;nbsp;* Starting database server couchdb                                             Apache CouchDB needs write permission on the PID file: /usr/local/var/run/couchdb.pid&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[fail]&lt;br/&gt;
&lt;br/&gt;
So I created the pidfile by hand:&lt;br/&gt;
&lt;br/&gt;
$ sudo touch /usr/local/var/run/couchdb.pid&lt;br/&gt;
$ sudo chown couchdb:couchdb /usr/local/var/run/couchdb.pid&lt;br/&gt;
$ sudo /usr/local/etc/init.d/couchdb start&lt;br/&gt;
&amp;nbsp;* Starting database server couchdb                                             /usr/local/bin/couchdb: 1: 0: not found&lt;br/&gt;
/usr/local/bin/couchdb: 1: 0: not found&lt;br/&gt;
/usr/local/bin/couchdb: 1: 0: not found&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[ OK ]&lt;br/&gt;
&lt;br/&gt;
Despite the &amp;quot;not found&amp;quot; errors, couchdb was running. Now:&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://localhost:5984/db1&quot;&gt;http://localhost:5984/db1&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;eacces&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
I found that /usr/local/var/lib/couchdb had been recreated with owner 0:0&lt;br/&gt;
&lt;br/&gt;
It seems to work OK after this:&lt;br/&gt;
$ sudo chown couchdb:couchdb /usr/local/var/lib/couchdb&lt;br/&gt;
</description>
                <environment>r757147&lt;br/&gt;
Ubuntu Hardy&lt;br/&gt;
</environment>
            <key id="12419170">COUCHDB-302</key>
        <summary>Permissions problems under Ubuntu</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Sun, 22 Mar 2009 09:14:10 +0000 (UTC)</created>
    <updated>Mon, 6 Apr 2009 08:30:25 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688285" author="candlerb" created="Mon, 23 Mar 2009 13:22:53 +0000 (UTC)"  >Fix for the &amp;quot;1: 0: not found&amp;quot; errors:&lt;br/&gt;
&lt;br/&gt;
--- bin/couchdb.tpl.in	(revision 757393)&lt;br/&gt;
+++ bin/couchdb.tpl.in	(working copy)&lt;br/&gt;
@@ -140,15 +140,15 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit $SCRIPT_ERROR&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fi&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;message_prefix=&amp;quot;Apache CouchDB needs a regular&amp;quot;&lt;br/&gt;
-    if `echo 2&amp;gt; /dev/null &amp;gt;&amp;gt; $PID_FILE; echo $?` -gt 0; then&lt;br/&gt;
+    if test `echo 2&amp;gt; /dev/null &amp;gt;&amp;gt; $PID_FILE; echo $?` -gt 0; then&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;echo &amp;quot;$message_prefix PID file: $PID_FILE&amp;quot; &amp;gt;&amp;amp;2&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit $SCRIPT_ERROR&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fi&lt;br/&gt;
-    if `echo 2&amp;gt; /dev/null &amp;gt;&amp;gt; $STDOUT_FILE; echo $?` -gt 0; then&lt;br/&gt;
+    if test `echo 2&amp;gt; /dev/null &amp;gt;&amp;gt; $STDOUT_FILE; echo $?` -gt 0; then&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;echo &amp;quot;$message_prefix STDOUT file: $STDOUT_FILE&amp;quot; &amp;gt;&amp;amp;2&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit $SCRIPT_ERROR&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fi&lt;br/&gt;
-    if `echo 2&amp;gt; /dev/null &amp;gt;&amp;gt; $STDERR_FILE; echo $?` -gt 0; then&lt;br/&gt;
+    if test `echo 2&amp;gt; /dev/null &amp;gt;&amp;gt; $STDERR_FILE; echo $?` -gt 0; then&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;echo &amp;quot;$message_prefix STDERR file: $STDERR_FILE&amp;quot; &amp;gt;&amp;amp;2&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit $SCRIPT_ERROR&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fi&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I notice that the README tells you to chown the /usr/local/var/lib/couchdb and /usr/local/var/log/couchdb directories. IMO this would be better done automatically by &apos;make install&apos;.&lt;br/&gt;
&lt;br/&gt;
Suggested fix for pidfile permission errors: move the pidfile into a /usr/local/var/run/couchdb/ directory with correct ownership. (This would then be a third directory which needs to be created correctly). Or else into the log directory.&lt;br/&gt;
&lt;br/&gt;
--- bin/couchdb.tpl.in	(revision 757393)&lt;br/&gt;
+++ bin/couchdb.tpl.in	(working copy)&lt;br/&gt;
@@ -27,7 +27,7 @@&lt;br/&gt;
&amp;nbsp;DEFAULT_INI_FILE=%localconfdir%/%defaultini%&lt;br/&gt;
&amp;nbsp;LOCAL_INI_FILE=%localconfdir%/%localini%&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
-PID_FILE=%localstatedir%/run/couchdb.pid&lt;br/&gt;
+PID_FILE=%localstatedir%/run/couchdb/couchdb.pid&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;STDOUT_FILE=couchdb.stdout&lt;br/&gt;
&amp;nbsp;STDERR_FILE=couchdb.stderr&lt;br/&gt;
</comment>
                    <comment id="12696005" author="candlerb" created="Mon, 6 Apr 2009 08:30:25 +0000 (UTC)"  >The &amp;quot;1: 0&amp;quot; error was reported separately as &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-305&quot; title=&quot;Warnings from the /usr/bin/couchdb script&quot;&gt;&lt;strike&gt;COUCHDB-305&lt;/strike&gt;&lt;/a&gt; and fixed&lt;br/&gt;
&lt;br/&gt;
The pidfile was moved recently to .../var/run/couchdb/ directory (r761355) and the README updated to indicate that this directory needs to be created with the correct permissions (r761352)&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 6 Apr 2009 08:30:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-301] Jumping to documents in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-301</link>

                    <description>I&apos;d love to be able to make a quick jump to a document for which I know the ID, from the database page in Futon.&lt;br/&gt;
&lt;br/&gt;
When doing admin tasks on a larger database, browsing documents to find a needed document becomes tedious. We can provide a simple text box that allows us to quickly jump to a document. It can use auto-suggest to make it even easier.&lt;br/&gt;
&lt;br/&gt;
It could be expanded even more to also do views, but just documents would be a good start, IMO.</description>
                <environment></environment>
            <key id="12419154">COUCHDB-301</key>
        <summary>Jumping to documents in Futon</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Sat, 21 Mar 2009 13:51:19 +0000 (UTC)</created>
    <updated>Mon, 20 Jul 2009 21:35:07 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688030" author="djc" created="Sat, 21 Mar 2009 13:51:58 +0000 (UTC)"  >Here&apos;s my patch for this. Seems to work in Firefox and IE7.</comment>
                    <comment id="12688032" author="jchris" created="Sat, 21 Mar 2009 14:15:37 +0000 (UTC)"  >Haven&apos;t applied the patch but reading it it looks clever. I&apos;ve tried to do an advanced view browser, for setting query params, but never got the UI worked out.&lt;br/&gt;
&lt;br/&gt;
I do like the autocomplete. Maybe where the jump-to-doc control is on the all-docs view, a query composer could be made available on views...</comment>
                    <comment id="12733363" author="cmlenz" created="Mon, 20 Jul 2009 21:35:07 +0000 (UTC)"  >Damien seems to have applied this in r787354.</comment>
                </comments>
    
    <attachments>
            <attachment id="12403370" name="futon-jump-to.diff" size="2442" author="djc" created="Sat, 21 Mar 2009 13:51:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 20 Jul 2009 21:35:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 14:15:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-300] Update Sequence broken</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-300</link>

                    <description>Database gets into a state where there is one document but an empty update sequence.</description>
                <environment>ubuntu hardy</environment>
            <key id="12419150">COUCHDB-300</key>
        <summary>Update Sequence broken</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="shelmberger">Sven Helmberger</reporter>
            
    <created>Sat, 21 Mar 2009 12:03:03 +0000 (UTC)</created>
    <updated>Sat, 21 Mar 2009 13:28:12 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688016" author="shelmberger" created="Sat, 21 Mar 2009 12:04:13 +0000 (UTC)"  >Testcase that shows the bug</comment>
                    <comment id="12688017" author="janl" created="Sat, 21 Mar 2009 12:17:46 +0000 (UTC)"  >Fixed testcase.</comment>
                    <comment id="12688021" author="damienkatz" created="Sat, 21 Mar 2009 12:40:29 +0000 (UTC)"  >This is an old bug, but recent changes made it happen on most conflicts, instead of occasional conflicts.&lt;br/&gt;
&lt;br/&gt;
For any database that&apos;s gotten itself in this state, this should be fixable by touching (load and save) the affected docs in the database (or all the docs in the database).</comment>
                    <comment id="12688023" author="shelmberger" created="Sat, 21 Mar 2009 12:46:29 +0000 (UTC)"  >But if I use  _all_docs_by_seq to know what documents have changed, I don&apos;t know that I have to touch the document to fix things because it&apos;s missing from _all_docs_by_seq. Isn&apos;t that a bit of a problem?</comment>
                    <comment id="12688024" author="damienkatz" created="Sat, 21 Mar 2009 12:56:13 +0000 (UTC)"  >Sven, you can still find all the documents in the database by scanning the _all_docs view. Load and reopen each doc by name.</comment>
                    <comment id="12688025" author="shelmberger" created="Sat, 21 Mar 2009 13:06:28 +0000 (UTC)"  >I understand that. I just wanted to point out that my initial intent for using the _all_docs_by_seq view is to know which documents have changed.&lt;br/&gt;
So I know for example what action to execute with a changed document. The fact that the document is missing prevents me from knowing it has changed.&lt;br/&gt;
So in order for this idea to work I would need to touch the document for every update conflict I catch in my app and hope no one screws up things by changing the database from the outside of the app.&lt;br/&gt;
That doesn&apos;t sound good to me.</comment>
                    <comment id="12688028" author="damienkatz" created="Sat, 21 Mar 2009 13:21:24 +0000 (UTC)"  >Sven, I think you missed the fix checked in for this bug? The fix prevents databases from getting into this state.&lt;br/&gt;
&lt;br/&gt;
But if you already have a database in this state, you can fix it by touching all the docs (or just the affected one). It&apos;s a one time thing.</comment>
                    <comment id="12688029" author="shelmberger" created="Sat, 21 Mar 2009 13:28:12 +0000 (UTC)"  >Oh.. sorry.. I totally misunderstood..&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12403366" name="all_docs_by_seq.js" size="729" author="janl" created="Sat, 21 Mar 2009 12:17:46 +0000 (UTC)" />
            <attachment id="12403365" name="update_seq_kaputt.js" size="610" author="shelmberger" created="Sat, 21 Mar 2009 12:04:13 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 12:40:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 12:17:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-299] Futon cannot display map-only views</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-299</link>

                    <description>If you have a map-only view, Futon is no longer able to display it, instead showing an error dialog:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Error: query_parse_error&lt;br/&gt;
&lt;br/&gt;
Query parameter &amp;quot;group&amp;quot; and/or &amp;quot;group_level&amp;quot; are invalid for map views.&amp;quot;</description>
                <environment>CouchDB SVN r756437&lt;br/&gt;
Ubuntu Hardy&lt;br/&gt;
Standard Firefox 3.0.7+nobinonly-0ubuntu0.8.04.1</environment>
            <key id="12417382">COUCHDB-299</key>
        <summary>Futon cannot display map-only views</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Fri, 20 Mar 2009 13:40:47 +0000 (UTC)</created>
    <updated>Fri, 20 Mar 2009 13:54:50 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12683885" author="paul.joseph.davis" created="Fri, 20 Mar 2009 13:46:33 +0000 (UTC)"  >Chris Anderson just comitted a change for this. Did you reload Futon to clear the old JS that&apos;s in your browser cache?</comment>
                    <comment id="12683887" author="candlerb" created="Fri, 20 Mar 2009 13:54:19 +0000 (UTC)"  >D&apos;oh. Shift-reload fixed it. Thank you.&lt;br/&gt;
&lt;br/&gt;
(Aside: the script has a slug but it&apos;s only the next release version number: script/futon.js?0.9.0 - maybe SVN rev would be better? But not a problem now I know what to do)&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 20 Mar 2009 13:54:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 20 Mar 2009 13:46:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-298] Document vanishes from view after attempted update</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-298</link>

                    <description>If you attempt to make an update to a doc with an old _rev, and hence it is rejected with a 409, the document drops out of [at least some] views.&lt;br/&gt;
&lt;br/&gt;
I have a shell script which replicates this problem reliably.&lt;br/&gt;
</description>
                <environment>CouchDB SVN r756437&lt;br/&gt;
Ubuntu Hardy (but with Erlang 1:12.b.3-dfsg-1ubuntu1 from Ubuntu Intrepid)</environment>
            <key id="12417378">COUCHDB-298</key>
        <summary>Document vanishes from view after attempted update</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Fri, 20 Mar 2009 13:01:42 +0000 (UTC)</created>
    <updated>Sat, 21 Mar 2009 23:59:49 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12683870" author="candlerb" created="Fri, 20 Mar 2009 13:03:11 +0000 (UTC)"  >Script to replicate problem</comment>
                    <comment id="12688083" author="janl" created="Sat, 21 Mar 2009 23:59:49 +0000 (UTC)"  >Closed as of r756925. Thanks.</comment>
                </comments>
    
    <attachments>
            <attachment id="12402659" name="view2.sh" size="1123" author="candlerb" created="Fri, 20 Mar 2009 13:03:11 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 23:59:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 23:59:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-297] Delete a not existing document results in HTTP status 200 - OK</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-297</link>

                    <description>Instead of an HTTP-Error status code like 404 deletion of a non-existing document results in HTTP 200 - OK:&lt;br/&gt;
&lt;br/&gt;
$ curl -i -X PUT &lt;a href=&quot;http://localhost:5984/some_database&quot;&gt;http://localhost:5984/some_database&lt;/a&gt; &amp;amp;&amp;amp; curl -i -X DELETE &lt;a href=&quot;http://localhost:5984/some_database/not_existing&quot;&gt;http://localhost:5984/some_database/not_existing&lt;/a&gt;&lt;br/&gt;
HTTP/1.1 412 Precondition Failed&lt;br/&gt;
Server: CouchDB/0.9.0a756409 (Erlang OTP/R12B)&lt;br/&gt;
Date: Fri, 20 Mar 2009 10:45:10 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Content-Length: 95&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;file_exists&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;The database could not be created, the file already exists.&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
Server: CouchDB/0.9.0a756409 (Erlang OTP/R12B)&lt;br/&gt;
Etag: &amp;quot;1-754167300&amp;quot;&lt;br/&gt;
Date: Fri, 20 Mar 2009 10:45:10 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Content-Length: 52&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;not_existing&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-754167300&amp;quot;}&lt;br/&gt;
</description>
                <environment>CouchDB Revision: 756409</environment>
            <key id="12417373">COUCHDB-297</key>
        <summary>Delete a not existing document results in HTTP status 200 - OK</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="apache@kore-nordmann.de">Kore Nordmann</reporter>
            
    <created>Fri, 20 Mar 2009 10:59:16 +0000 (UTC)</created>
    <updated>Sat, 21 Mar 2009 14:19:32 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688034" author="jchris" created="Sat, 21 Mar 2009 14:19:32 +0000 (UTC)"  >fixed in r756948</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 14:19:32 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 14:19:32 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-296] A built-in conflicts view</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-296</link>

                    <description>It would be great if CouchDB came with a built-in db/_conflicts view. It could have code like the current test/view_conflicts.js.</description>
                <environment></environment>
            <key id="12417363">COUCHDB-296</key>
        <summary>A built-in conflicts view</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="djc">Dirkjan Ochtman</reporter>
            
    <created>Fri, 20 Mar 2009 09:56:32 +0000 (UTC)</created>
    <updated>Thu, 13 Aug 2009 19:16:37 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12742923" author="zdzolton" created="Thu, 13 Aug 2009 18:49:23 +0000 (UTC)"  >I think this is a duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-462&quot; title=&quot;track conflict count in db_info (was built-in conflicts view)&quot;&gt;COUCHDB-462&lt;/a&gt; &amp;quot;track conflict count in db_info (was built-in conflicts view)&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
So, we should probably close this out, right?</comment>
                    <comment id="12742932" author="kocolosk" created="Thu, 13 Aug 2009 19:16:08 +0000 (UTC)"  >Good catch, Zachary</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                                        <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12432840">COUCHDB-462</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 13 Aug 2009 19:16:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 13 Aug 2009 18:49:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-295] Upload attachment form in futon does not work</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-295</link>

                    <description>Using &apos;upload attachment&apos; form in futon. The server returns 405 and the upload form hangs with full progress bar.</description>
                <environment>couchdb 0.9.0a754958&lt;br/&gt;
firefox 3.0.7-1.fc10</environment>
            <key id="12417180">COUCHDB-295</key>
        <summary>Upload attachment form in futon does not work</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="jamiiecb">Jamie Brandon</reporter>
            
    <created>Wed, 18 Mar 2009 15:35:43 +0000 (UTC)</created>
    <updated>Thu, 19 Mar 2009 20:51:54 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12683606" author="cmlenz" created="Thu, 19 Mar 2009 20:51:54 +0000 (UTC)"  >This should&apos;ve been fixed by r756186.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 19 Mar 2009 20:51:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 19 Mar 2009 20:51:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-294] in validation functions, new_doc does not contain the rev that was sent in the request </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-294</link>

                    <description>The new_doc in a validation does not contain the revision that you sent in the post/put request. &lt;br/&gt;
&lt;br/&gt;
In this log, each block contains a log of &lt;br/&gt;
&lt;br/&gt;
[info] old_doc&lt;br/&gt;
[info] new_doc&lt;br/&gt;
[info] request&lt;br/&gt;
&lt;br/&gt;
{{{&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
new doc&lt;br/&gt;
-------&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.68.0&amp;gt;] OS Process Log Message: null&lt;br/&gt;
[info] [&amp;lt;0.68.0&amp;gt;] OS Process Log Message: {&amp;quot;_id&amp;quot;: &amp;quot;wibble&amp;quot;,&amp;quot;_rev&amp;quot;: &amp;quot;1-3141321355&amp;quot;,&amp;quot;_revisions&amp;quot;: {&amp;quot;start&amp;quot;: 1,&amp;quot;ids&amp;quot;: [&amp;quot;3141321355&amp;quot;]}}&lt;br/&gt;
[info] [&amp;lt;0.935.0&amp;gt;] 127.0.0.1 - - &apos;PUT&apos; /conflict/wibble 201&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
update 1st rev, no conflict&lt;br/&gt;
---------------------------&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.68.0&amp;gt;] OS Process Log Message: {&amp;quot;_id&amp;quot;: &amp;quot;wibble&amp;quot;,&amp;quot;_rev&amp;quot;: &amp;quot;1-3141321355&amp;quot;,&amp;quot;_revisions&amp;quot;: {&amp;quot;start&amp;quot;: 1,&amp;quot;ids&amp;quot;: [&amp;quot;3141321355&amp;quot;]}}&lt;br/&gt;
[info] [&amp;lt;0.68.0&amp;gt;] OS Process Log Message: {&amp;quot;_id&amp;quot;: &amp;quot;wibble&amp;quot;,&amp;quot;_rev&amp;quot;: &amp;quot;2-1123114967&amp;quot;,&amp;quot;_revisions&amp;quot;: {&amp;quot;start&amp;quot;: 2,&amp;quot;ids&amp;quot;: [&amp;quot;1123114967&amp;quot;,&amp;quot;3141321355&amp;quot;]}}&lt;br/&gt;
[info] [&amp;lt;0.977.0&amp;gt;] 127.0.0.1 - - &apos;POST&apos; /conflict/_bulk_docs 201&lt;br/&gt;
&lt;br/&gt;
As you can see on this second request, the document sent will have had a rev of &amp;quot;1-3141321355&amp;quot; but in the validation function the new_doc has the rev that is just about to be written to disk.. I cannot see a way to access the rev that was sent across the request.&lt;br/&gt;
&lt;br/&gt;
}}}</description>
                <environment>ubuntu</environment>
            <key id="12417179">COUCHDB-294</key>
        <summary>in validation functions, new_doc does not contain the rev that was sent in the request </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="timparkin">Tim</reporter>
            
    <created>Wed, 18 Mar 2009 15:24:04 +0000 (UTC)</created>
    <updated>Wed, 18 Mar 2009 15:24:04 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-293] uneneeded line in etc/couchdb/default_dev.ini</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-293</link>

                    <description>The admin line in etc/couchdb/default_dev.ini isn&apos;t needed and could be removed :&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/couchdb/trunk/etc/couchdb/local_dev.ini?revision=755023&amp;view=markup&quot;&gt;http://svn.apache.org/viewvc/couchdb/trunk/etc/couchdb/local_dev.ini?revision=755023&amp;amp;view=markup&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
was introduced in latest trunk.</description>
                <environment>*</environment>
            <key id="12417041">COUCHDB-293</key>
        <summary>uneneeded line in etc/couchdb/default_dev.ini</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 17 Mar 2009 09:18:49 +0000 (UTC)</created>
    <updated>Tue, 17 Mar 2009 10:59:14 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12682623" author="janl" created="Tue, 17 Mar 2009 10:59:14 +0000 (UTC)"  >Fixed in r755185. Thanks.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 17 Mar 2009 10:59:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 17 Mar 2009 10:59:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-292] A deleted document may be resaved with an old revision and is then considered undeleted</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-292</link>

                    <description>If a document is deleted, a PUT request may be issued with the same revision that was passed to the DELETE request. When this happens the previously deleted document is assigned a new revision and is no longer considered deleted.&lt;br/&gt;
&lt;br/&gt;
This behaviour is new within the last few weeks.&lt;br/&gt;
&lt;br/&gt;
The following curl session illustrates the issue. &lt;br/&gt;
&lt;br/&gt;
08:18 : ~ $ curl -X PUT -d &apos;{&amp;quot;_id&amp;quot;:&amp;quot;foo&amp;quot;}&apos; localhost:5984/scratch/foo&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-3690485448&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
08:19 : ~ $ curl -X PUT -d &apos;{&amp;quot;_id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;1-3690485448&amp;quot;}&apos; localhost:5984/scratch/foo&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;2-966942539&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
08:19 : ~ $ curl -X DELETE localhost:5984/scratch/foo?rev=&amp;quot;2-966942539&amp;quot;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;3-421182311&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
08:20 : ~ $ curl -X GET localhost:5984/scratch/foo&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;deleted&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
08:20 : ~ $ curl -X PUT -d &apos;{&amp;quot;_id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;2-966942539&amp;quot;}&apos; localhost:5984/scratch/foo&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;3-1867999175&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
08:20 : ~ $ curl -X GET localhost:5984/scratch/foo&lt;br/&gt;
{&amp;quot;_id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;3-1867999175&amp;quot;}&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12417034">COUCHDB-292</key>
        <summary>A deleted document may be resaved with an old revision and is then considered undeleted</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Tue, 17 Mar 2009 08:27:20 +0000 (UTC)</created>
    <updated>Mon, 23 Nov 2009 20:44:14 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688321" author="jchris" created="Mon, 23 Mar 2009 16:46:48 +0000 (UTC)"  >I was able to duplicate this on my machine.&lt;br/&gt;
&lt;br/&gt;
Paul if you can possibly rebuild this as a JavaScript test suite test (perhaps a patch to basics.js) we can start to look for the right fix.&lt;br/&gt;
&lt;br/&gt;
At the end of my session I tried:&lt;br/&gt;
&lt;br/&gt;
$: curl -X GET localhost:5984/scratch/foo?meta=true&lt;br/&gt;
{&amp;quot;_id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;_rev&amp;quot;:&amp;quot;3-2144795776&amp;quot;,&amp;quot;_revs_info&amp;quot;:[{&amp;quot;rev&amp;quot;:&amp;quot;3-2144795776&amp;quot;,&amp;quot;status&amp;quot;:&amp;quot;available&amp;quot;},{&amp;quot;rev&amp;quot;:&amp;quot;2-4259004717&amp;quot;,&amp;quot;status&amp;quot;:&amp;quot;available&amp;quot;},{&amp;quot;rev&amp;quot;:&amp;quot;1-1189092513&amp;quot;,&amp;quot;status&amp;quot;:&amp;quot;available&amp;quot;}],&amp;quot;_deleted_conflicts&amp;quot;:[&amp;quot;3-1788894625&amp;quot;]}&lt;br/&gt;
&lt;br/&gt;
So it looks like I have a deleted conflict. I&apos;m not sure what this means but it seems relevant to the underlying model.</comment>
                    <comment id="12689708" author="emgee" created="Thu, 26 Mar 2009 22:42:24 +0000 (UTC)"  >I&apos;ve just come across the same problem, but using _bulk_docs:&lt;br/&gt;
&lt;br/&gt;
$ curl -X &amp;quot;POST&amp;quot; -d &amp;quot;{\&amp;quot;docs\&amp;quot;: [{\&amp;quot;_id\&amp;quot;: \&amp;quot;foo\&amp;quot;}]}&amp;quot;  &lt;a href=&quot;http://localhost:5984/test/_bulk_docs&quot;&gt;http://localhost:5984/test/_bulk_docs&lt;/a&gt;&lt;br/&gt;
[{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-3973353391&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
$ curl -X &amp;quot;GET&amp;quot; &lt;a href=&quot;http://localhost:5984/test/_all_docs&quot;&gt;http://localhost:5984/test/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-3973353391&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
$ curl -X &amp;quot;POST&amp;quot; -d &amp;quot;{\&amp;quot;docs\&amp;quot;: [{\&amp;quot;_id\&amp;quot;: \&amp;quot;foo\&amp;quot;, \&amp;quot;_rev\&amp;quot;: \&amp;quot;1-3973353391\&amp;quot;, \&amp;quot;_deleted\&amp;quot;: true}]}&amp;quot;  &lt;a href=&quot;http://localhost:5984/test/_bulk_docs&quot;&gt;http://localhost:5984/test/_bulk_docs&lt;/a&gt;&lt;br/&gt;
[{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;2-1972132827&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
$ curl -X &amp;quot;GET&amp;quot; &lt;a href=&quot;http://localhost:5984/test/_all_docs&quot;&gt;http://localhost:5984/test/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:0,&amp;quot;rows&amp;quot;:[]}&lt;br/&gt;
&lt;br/&gt;
$ curl -X &amp;quot;POST&amp;quot; -d &amp;quot;{\&amp;quot;docs\&amp;quot;: [{\&amp;quot;_id\&amp;quot;: \&amp;quot;foo\&amp;quot;, \&amp;quot;_rev\&amp;quot;: \&amp;quot;1-3973353391\&amp;quot;}]}&amp;quot;  &lt;a href=&quot;http://localhost:5984/test/_bulk_docs&quot;&gt;http://localhost:5984/test/_bulk_docs&lt;/a&gt;&lt;br/&gt;
[{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;2-2387444021&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
$ curl -X &amp;quot;GET&amp;quot; &lt;a href=&quot;http://localhost:5984/test/_all_docs&quot;&gt;http://localhost:5984/test/_all_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;2-2387444021&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
</comment>
                    <comment id="12689722" author="emgee" created="Thu, 26 Mar 2009 23:14:45 +0000 (UTC)"  >Here&apos;s a test:&lt;br/&gt;
&lt;br/&gt;
couchTests.undead = function(debug) {&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Create fresh database&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var db = new CouchDB(&amp;quot;test_suite_db&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db.createDb();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Create a document&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var results = db.bulkSave([{_id: &amp;quot;foo&amp;quot;}]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var original_rev = results[0].rev;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(db.info().doc_count == 1);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Delete the document.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var results = db.bulkSave([{_id: &amp;quot;foo&amp;quot;, _rev: original_rev, _deleted: true}]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(results[0].rev != original_rev);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(db.info().doc_count == 0);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Try to raise the document from the grave (shouldn&apos;t work).&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var results = db.bulkSave([{_id: &amp;quot;foo&amp;quot;, _rev: original_rev}]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(results[0].error == &amp;quot;conflict&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(db.info().doc_count == 0);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;};&lt;br/&gt;
</comment>
                    <comment id="12772668" author="kocolosk" created="Mon, 2 Nov 2009 20:39:58 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12781612" author="damienkatz" created="Mon, 23 Nov 2009 20:44:14 +0000 (UTC)"  >Fix with tests in svn r883494.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Nov 2009 20:44:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 16:46:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-291] Futon and tests should use relative URLs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-291</link>

                    <description>The use of relative URLs in Futon and the client side test suite would allow for the whole package to live happily behind a reverse proxy, including while nested under a deeper path than &amp;quot;/&amp;quot;.</description>
                <environment></environment>
            <key id="12416981">COUCHDB-291</key>
        <summary>Futon and tests should use relative URLs</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="amoshayes">Amos Hayes</reporter>
            
    <created>Mon, 16 Mar 2009 16:14:54 +0000 (UTC)</created>
    <updated>Mon, 6 Apr 2009 22:32:06 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                
                        <component>Documentation</component>
                    <component>Futon</component>
                    <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12696281" author="metajack" created="Mon, 6 Apr 2009 22:32:06 +0000 (UTC)"  >I&apos;m not sure that this can be done as stated because Futon uses jquery.couch.js to do the functions and it uses absolute URLs.  It&apos;s not clear to me how you could deduce what the path prefix is automatically (except in the case of an application like Futon which has a recognizable URL).&lt;br/&gt;
&lt;br/&gt;
I&apos;ve attached a patch to fix the issue of Futon working with reverse proxies to &lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-321&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-321&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 6 Apr 2009 22:32:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-290] Include sequence number in update notifications</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-290</link>

                    <description>Hi! There&apos;s been requests to include the sequence number when sending an update notification.  Thanks to the guidance from davisp on #couchdb on March 13th, I&apos;ve been able to put together a little patch that does just that. In the future I&apos;m interested in doing the same for the create notification, and perhaps extending create/delete/update notifications to include a list of affected doc IDs.&lt;br/&gt;
&lt;br/&gt;
For now though, just this simple patch.</description>
                <environment></environment>
            <key id="12416934">COUCHDB-290</key>
        <summary>Include sequence number in update notifications</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="statik">Elliot Murphy</reporter>
            
    <created>Mon, 16 Mar 2009 03:24:46 +0000 (UTC)</created>
    <updated>Wed, 5 Aug 2009 14:29:39 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12682211" author="statik" created="Mon, 16 Mar 2009 03:26:44 +0000 (UTC)"  >This is the patch that adds the sequence number to the update notification. Output looks like this:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;type&amp;quot;:&amp;quot;updated&amp;quot;,&amp;quot;db&amp;quot;:&amp;quot;replication_notification_test&amp;quot;,&amp;quot;seq&amp;quot;:1}&lt;br/&gt;
&lt;br/&gt;
The &amp;quot;seq&amp;quot; : 1 part is what is added by this patch.</comment>
                    <comment id="12682216" author="paul.joseph.davis" created="Mon, 16 Mar 2009 04:35:54 +0000 (UTC)"  >Patch looks simple enough. I&apos;d rename seq to update_seq to maintain consistency. I&apos;m uncertain about adding the list of affected document ids. I&apos;d have to go back and look at the code paths again to see what&apos;s what. If adding the list included making a hit all the way down to the update sequence btree I&apos;d force the overhead to the client instead of including it in every update notification. Minus the s/seq/update_seq/ I&apos;d be good applying this as is.</comment>
                    <comment id="12682261" author="rnewson" created="Mon, 16 Mar 2009 09:56:36 +0000 (UTC)"  >+1 for including update_seq, -1 for including affected doc id&apos;s (potentially huge).&lt;br/&gt;
</comment>
                    <comment id="12682282" author="statik" created="Mon, 16 Mar 2009 11:37:24 +0000 (UTC)"  >Renamed seq to update_seq as requested, and regenerated patch.</comment>
                    <comment id="12682287" author="janl" created="Mon, 16 Mar 2009 11:47:00 +0000 (UTC)"  >What problem does including the update_seq solve?&lt;br/&gt;
&lt;br/&gt;
-1 on adding doc ids, this can not be solved in a sensible way.</comment>
                    <comment id="12682299" author="kocolosk" created="Mon, 16 Mar 2009 12:20:14 +0000 (UTC)"  >The last time I used an update notification process it only received one notification per _bulk_docs.  Including the update_seq would allow a process to do something (e.g. rebuild views) for every N updates to the DB, regardless of whether the update occurred in a _bulk_docs or in a standalone request.</comment>
                    <comment id="12682301" author="thisfred" created="Mon, 16 Mar 2009 12:27:41 +0000 (UTC)"  >The problem it solves is that for many update triggers, it is important to find out what has changed in the update, which unfortunately means logging sequence numbers outside of couchdb, so that an all_documents_by_seq query?startkey=old_seq can be run to find out which documents have changed. I think this is a pretty common use case.&lt;br/&gt;
&lt;br/&gt;
We can of course let each update trigger call fire off a request to the db to get its current seq_no, but that&apos;s unfortunate since the information could easily be provided to the update trigger, and by the time the request has returned, the sequence number might have changed again.&lt;br/&gt;
&lt;br/&gt;
A list of changed document ids would be even better, but if this is not possible, we will have to do requests for them. &lt;br/&gt;
&lt;br/&gt;
Bulk updates aside, this would always be a single document id though, or am I wrong? If there is a way to pass that document id *or*  &amp;quot;_bulk&amp;quot; or something, that would solve it for all non-nulk updates at least. I realize that would probably be a more involved patch.</comment>
                    <comment id="12682302" author="rnewson" created="Mon, 16 Mar 2009 12:36:54 +0000 (UTC)"  >for me (that is, couchdb-lucene) it would for verification and would save one call per update. When I receive an update notification I GET /&amp;lt;dbname&amp;gt; to find the latest update_seq,  I then call _all_docs_by_seq with a startkey that I track independently and a configurable limit that defaults to 1000. I loop until I&apos;ve processed up to the update_seq I got in the last call. &lt;br/&gt;
&lt;br/&gt;
If the update_seq were provided in the notification, I could simplify the code. I would think every update trigger must do something much the same, it seems reasonable to add it the update notification.&lt;br/&gt;
&lt;br/&gt;
If, as eric suggests, the before and after value was supplied, that might further simplify the code.&lt;br/&gt;
</comment>
                    <comment id="12682305" author="janl" created="Mon, 16 Mar 2009 12:56:55 +0000 (UTC)"  >@Adam Good one.&lt;br/&gt;
&lt;br/&gt;
@Eric The default use case is that you track the last seq_nr you queried on. The only special case is the first request where you don&apos;t have a seq_nr and get everything from your DB. There is nothing &amp;quot;unfortunate&amp;quot; about that, it&apos;s the API. I don&apos;t see how including the current seq_nr in the notification would help at all in this case. It would help if the result of _all_docs_by_seq would include the then latest seq_nr so the process can store it and I believe it does.&lt;br/&gt;
&lt;br/&gt;
Adding a list of documents comes with more problems: &lt;br/&gt;
&lt;br/&gt;
1) In a bulk operation, you might get _a lot_ of ids and you&apos;d need to take care of that.&lt;br/&gt;
2) The API is meant to be asynchronous. CouchDB does not have to track which documents get sent to the notifier process in case of an error. The process would just restart with its last know sequence number. It significantly simplifies on the CouchDB end which is good for reliability. I think the extra step to go for the process is not too bad.&lt;br/&gt;
&lt;br/&gt;
@Robert so you query _all_docs_by_seq with a startkey and endkey? Why not just drop the endkey?&lt;br/&gt;
</comment>
                    <comment id="12682307" author="rnewson" created="Mon, 16 Mar 2009 13:03:52 +0000 (UTC)"  >@Jan no, I do not use endkey. I specify startkey and limit only (I already know startkey and limit is just to make the couchdb call a constant cost). If the update notification contained the new update_seq I would not have to find it with a call to &lt;a href=&quot;http://localhost:5984/&amp;lt;dbname&quot;&gt;http://localhost:5984/&amp;amp;lt;dbname&lt;/a&gt;&amp;gt;. I use the new update_seq as the escape condition for my loop. That is, my code attempts to catch up from where I left off to where couchdb is at the time of the notification, neither more nor less. &lt;br/&gt;
&lt;br/&gt;
Having the new sequence in the update notification would eliminate the &lt;a href=&quot;http://localhost:5984/&amp;lt;dbname&quot;&gt;http://localhost:5984/&amp;amp;lt;dbname&lt;/a&gt;&amp;gt; call. It&apos;s not a big deal for me, couchdb-lucene works fine without it, but I don&apos;t see any downside, and some modest upside, to the suggestion.&lt;br/&gt;
</comment>
                    <comment id="12682310" author="janl" created="Mon, 16 Mar 2009 13:10:51 +0000 (UTC)"  >@Robert Can you not simplify by not ending your loop based on the &amp;quot;current&amp;quot; seq_nr, but keep going until no more new docs come in and then stop and wait for the next update notification to kick off? You can then ignore all update notifications that come in while you are looping.</comment>
                    <comment id="12682313" author="thisfred" created="Mon, 16 Mar 2009 13:29:31 +0000 (UTC)"  >@Jan ah, yes: remembering the last sequence number you got in your last query would solve the problem for some use cases, unfortunately not for ours: we want to track sequence numbers and log them with a timestamp, i.e. we don&apos;t want to query the couchdb at all at that particular moment, but possibly at some later date for everything updated between seq_n and seq_m, based on their timestamps.</comment>
                    <comment id="12682315" author="rnewson" created="Mon, 16 Mar 2009 13:31:32 +0000 (UTC)"  >@Jan I could, but I&apos;m not going to. :) I&apos;m not going to assume there&apos;s a time when &amp;quot;no more new docs come in&amp;quot;. Without some end condition, no new updates will become searchable. Again, the reason I fetch the current update_seq is to prevent a runaway while loop in my code, I could, instead, simply flush my changes to the index every N minutes or N changes (whichever occurs first). Since there&apos;s interest in that model anyway, I guess it&apos;s moot.&lt;br/&gt;
&lt;br/&gt;
For now, I&apos;m happy with the way I handle update notifications, receiving the new update_seq in the notification would just be tidier for my case.&lt;br/&gt;
&lt;br/&gt;
As Damien mentioned on the dev list, update notification might be obsolete soon anyway, so we&apos;ll all need to change to a different solution anyway.</comment>
                    <comment id="12682751" author="statik" created="Tue, 17 Mar 2009 18:41:18 +0000 (UTC)"  >Wow, thanks for all the feedback! From reading all the discussion, it sounded like the attached patch is useful to some people, hurts nothing, and might get thrown away when the entire update notification system changed to use comet. Will the patch be applied then, or rejected? I&apos;ve made the name change as requested, let me know if I should change anything else. Hugs, -elliot</comment>
                    <comment id="12694976" author="thisfred" created="Thu, 2 Apr 2009 12:20:35 +0000 (UTC)"  >Now that 0.9 has landed, is there any chance this patch could land? I found an issue in our specific use case which make it more that just optimization:&lt;br/&gt;
&lt;br/&gt;
we log sequence numbers with timestamps to a file, and getting the sequence number from couch with a request from the update trigger frequently returns a higher sequence number than one would expect, since another update has already happened before the update trigger gets back the sequence number. This can be coded around, but it makes it *very* hard to write deterministic tests for the update triggers.&lt;br/&gt;
&lt;br/&gt;
If there is anything I or Elliot can do to help this patch along, we&apos;d be glad to do it.</comment>
                    <comment id="12695258" author="jchris" created="Fri, 3 Apr 2009 06:25:17 +0000 (UTC)"  >reviewing the patch. +1 on applying it. &lt;br/&gt;
&lt;br/&gt;
can someone please apply this? I&apos;m sorry to ask but the bandwidth where I am is unacceptable. svn commit fail. thanks!</comment>
                    <comment id="12695304" author="damienkatz" created="Fri, 3 Apr 2009 09:11:18 +0000 (UTC)"  >-1 on the patch. This functionality should be at the HTTP level, </comment>
                    <comment id="12695490" author="jchris" created="Fri, 3 Apr 2009 16:48:57 +0000 (UTC)"  >My general thought processes had been that since the db update notifier is basically deprecated, it wouldn&apos;t hurt to start giving it a few bells and whistles, in preparation for the making the same info available over the Comet interface.&lt;br/&gt;
&lt;br/&gt;
Damien, I take it that you&apos;re not against making the update-seq available, you&apos;d just rather see the db-update-notification-process go away altogether?&lt;br/&gt;
&lt;br/&gt;
If now is the time to start implementing the Comet hook I guess we should start a thread about the implementation. Eric, Elliot - I&apos;m with Damien on thinking this should go into the HTTP layer. I may be a little more cavalier about playing around with the old implementation, instead of moving forward on Comet. Damien may have a point though, that enhancing a deprecated API gives the wrong expectations.</comment>
                    <comment id="12695494" author="damienkatz" created="Fri, 3 Apr 2009 16:58:35 +0000 (UTC)"  >I&apos;m actually working on this HTTP functionality right now. Then not only child processes, but remote processes will be able to easily register for notifications over HTTP, and we can present a richer interface.&lt;br/&gt;
&lt;br/&gt;
Once in place the std io notifications would be removed completely and we could then use std io for logging and error reporting of the child process.</comment>
                    <comment id="12695503" author="thisfred" created="Fri, 3 Apr 2009 17:10:25 +0000 (UTC)"  >That is excellent news! If there is any way we can assist with that work (testing, discussion/feedback, documenting on wiki, or coding) please let us know. If this is in the near future, I guess we can live with patching our couch instances for the duration.</comment>
                    <comment id="12695556" author="jchris" created="Fri, 3 Apr 2009 20:11:00 +0000 (UTC)"  >Very exciting. If you don&apos;t mind working in a branch or on git, I bet you&apos;ll get a lot of help along the way.</comment>
                    <comment id="12739526" author="janl" created="Wed, 5 Aug 2009 14:29:39 +0000 (UTC)"  >update_seq numbers are included in the new _changes feed. DbUpdateNotifiers are deprecated now. and we won&apos;t include the document data in the notification.</comment>
                </comments>
    
    <attachments>
            <attachment id="12402272" name="couchdb-sequences.patch" size="2442" author="statik" created="Mon, 16 Mar 2009 11:37:24 +0000 (UTC)" />
            <attachment id="12402238" name="couchdb-sequences.patch" size="2435" author="statik" created="Mon, 16 Mar 2009 03:26:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 5 Aug 2009 14:29:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Mar 2009 04:35:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-289] _all_docs should support both GET and POST</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-289</link>

                    <description>As of 0.9, if you want to query multiple documents at once and load them, you have to do: &lt;br/&gt;
&lt;br/&gt;
&apos;POST&apos; /my_db/_all_docs?include_docs=true and pass the document ids.&lt;br/&gt;
&lt;br/&gt;
The problem with that approach is that the requests can&apos;t be cached. Being to make a GET request (with the obvious limitations) would make a lot of sense.</description>
                <environment></environment>
            <key id="12416705">COUCHDB-289</key>
        <summary>_all_docs should support both GET and POST</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mattetti">Matt Aimonetti</reporter>
            
    <created>Thu, 12 Mar 2009 00:50:10 +0000 (UTC)</created>
    <updated>Wed, 20 Jan 2010 00:02:49 +0000 (UTC)</updated>

                        <version>0.10</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772700" author="kocolosk" created="Mon, 2 Nov 2009 21:30:20 +0000 (UTC)"  >I&apos;m +1 on this.  Also if the keys are passed in the query-string it gives us a chance to throw &apos;414 Request-URI Too Long&amp;quot;.  We should never pass up the opportunity to correctly use an obscure HTTP status code :-)</comment>
                    <comment id="12801251" author="dipthegeezer" created="Sat, 16 Jan 2010 18:34:54 +0000 (UTC)"  >I&apos;m going to have a stab at this if there are no objections.&lt;br/&gt;
&lt;br/&gt;
Dip</comment>
                    <comment id="12802557" author="jchris" created="Wed, 20 Jan 2010 00:02:49 +0000 (UTC)"  >Not an objection, but something to bear in mind.&lt;br/&gt;
&lt;br/&gt;
Right now POSTing the keys to views kinda sucks, because it&apos;s so limited.&lt;br/&gt;
&lt;br/&gt;
We&apos;d like to change the API so that you post an object the specifies a list of queries, not just keys:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;quot;queries&amp;quot; : [&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;startkey&amp;quot; : &amp;quot;foo&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;limit&amp;quot; : 5,&lt;br/&gt;
&amp;nbsp;},&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;startkey&amp;quot; : &amp;quot;baz&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;limit&amp;quot; : 5,&lt;br/&gt;
}&lt;br/&gt;
]&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
which gives the current functionality but also much more flexibility. It&apos;s also harder to compress into get params, but not impossible.&lt;br/&gt;
&lt;br/&gt;
Anyway, just a heads up.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 21:30:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-288] couch_js.c:1217: error: &apos;JSOPTION_NATIVE_BRANCH_CALLBACK&apos; with spidermonkey tip</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-288</link>

                    <description>libtool: link: ( cd &amp;quot;.libs&amp;quot; &amp;amp;&amp;amp; rm -f &amp;quot;couch_erl_driver.la&amp;quot; &amp;amp;&amp;amp; ln -s &amp;quot;../couch_erl_driver.la&amp;quot; &amp;quot;couch_erl_driver.la&amp;quot; )&lt;br/&gt;
i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I../..   -D_XOPEN_SOURCE  -L/usr/local/lib -L/opt/local/lib -I/usr/lib/erlang/usr/include -I/usr/lib/erlang/usr/include -I/usr/local/lib/erlang/usr/include -I/opt/local/lib/erlang/usr/include -I/usr/include -I/usr/include/js -I/usr/include/mozjs -I/usr/local/include -I/opt/local/include -I/usr/local/include/js -I/opt/local/include/js -DXP_UNIX    -DMUDKIPZ -march=native -pipe -O2 -MT couchjs-couch_js.o -MD -MP -MF .deps/couchjs-couch_js.Tpo -c -o couchjs-couch_js.o `test -f &apos;couch_js.c&apos; || echo &apos;./&apos;`couch_js.c&lt;br/&gt;
couch_js.c: In function &apos;main&apos;:&lt;br/&gt;
couch_js.c:1217: error: &apos;JSOPTION_NATIVE_BRANCH_CALLBACK&apos; undeclared (first use in this function)&lt;br/&gt;
couch_js.c:1217: error: (Each undeclared identifier is reported only once&lt;br/&gt;
couch_js.c:1217: error: for each function it appears in.)&lt;br/&gt;
make[2]: Leaving directory `/var/tmp/paludis/build/dev-db-couchdb-scm/work/couchdb-scm/src/couchdb&apos;&lt;br/&gt;
make[2]: *** [couchjs-couch_js.o] Error 1&lt;br/&gt;
make[1]: Leaving directory `/var/tmp/paludis/build/dev-db-couchdb-scm/work/couchdb-scm&apos;&lt;br/&gt;
make[1]: *** [all-recursive] Error 1&lt;br/&gt;
make: *** [all] Error 2&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Patching with &lt;br/&gt;
Index: src/couchdb/couch_js.c&lt;br/&gt;
===================================================================&lt;br/&gt;
--- src/couchdb/couch_js.c	(revision 752552)&lt;br/&gt;
+++ src/couchdb/couch_js.c	(working copy)&lt;br/&gt;
@@ -1213,8 +1213,8 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (!context)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return 1;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;JS_SetErrorReporter(context, PrintError);&lt;br/&gt;
-    JS_SetBranchCallback(context, BranchCallback);&lt;br/&gt;
-    JS_ToggleOptions(context, JSOPTION_NATIVE_BRANCH_CALLBACK);&lt;br/&gt;
+//    JS_SetBranchCallback(context, BranchCallback);&lt;br/&gt;
+//    JS_ToggleOptions(context, JSOPTION_NATIVE_BRANCH_CALLBACK);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;JS_ToggleOptions(context, JSOPTION_XML);&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;global = JS_NewObject(context, NULL, NULL, NULL);&lt;br/&gt;
&lt;br/&gt;
compiles and &amp;quot;works&amp;quot; in so far as I can talk to futon&lt;br/&gt;
&lt;br/&gt;
I think it might me related to &lt;a href=&quot;http://markmail.org/search/?q=JS_SetBranchCallback#query:JS_SetBranchCallback%20list%3Aorg.apache.couchdb.commits+page:1+mid:kgc3bx6rclmlpkvb+state:results&quot;&gt;http://markmail.org/search/?q=JS_SetBranchCallback#query:JS_SetBranchCallback%20list%3Aorg.apache.couchdb.commits+page:1+mid:kgc3bx6rclmlpkvb+state:results&lt;/a&gt;</description>
                <environment>linux-x86 latest erlang/otp spidermonkey from &lt;a href=&quot;http://hg.mozilla.org/mozilla-central/&quot;&gt;http://hg.mozilla.org/mozilla-central/&lt;/a&gt;</environment>
            <key id="12416691">COUCHDB-288</key>
        <summary>couch_js.c:1217: error: &apos;JSOPTION_NATIVE_BRANCH_CALLBACK&apos; with spidermonkey tip</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rbrown">Richard Brown</reporter>
            
    <created>Wed, 11 Mar 2009 21:37:37 +0000 (UTC)</created>
    <updated>Tue, 4 Aug 2009 12:30:55 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12681063" author="paul.joseph.davis" created="Wed, 11 Mar 2009 22:13:37 +0000 (UTC)"  >Applying that patch wouldn&apos;t break anything in CouchDB directly as its only running garbage collection every 16K branches. I don&apos;t have any feeling for how much RAM the JS VM uses in normal operation so while its possible that things blow up without it, I tend to think it wouldn&apos;t. Though it may have been added specifically because couchjs did suck up a lot of RAM between the other various calls to the garbage collector.&lt;br/&gt;
&lt;br/&gt;
Anyone know if BranchCallback was added from necessity? If not, I&apos;d be inclined to remove it and then add a few more calls to gc() in main.js as well as change the garbage collector call in couch_js.c JS_GC() to JS_MaybeGC().</comment>
                    <comment id="12735064" author="alessandrod" created="Fri, 24 Jul 2009 14:20:15 +0000 (UTC)"  >Running the tests I found other issues with spidermonkey tip.&lt;br/&gt;
With this patch all but one of the js tests pass.</comment>
                    <comment id="12736016" author="aquarius" created="Tue, 28 Jul 2009 10:09:49 +0000 (UTC)"  >Using spidermonkey from Ubuntu karmic and xulrunner 1.9.1 and Firefox 3.5, this patch fixes the &amp;quot;Expression does not evaluate to a function&amp;quot; issue, and all tests but one pass:&lt;br/&gt;
&lt;br/&gt;
show_documents	failure	360ms	&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;1. Run with debuggerAssertion failed: xhr.getResponseHeader(&amp;quot;Content-Type&amp;quot;) == &amp;quot;application/xml&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;2. Assertion failed: xhr.responseText.match(/plankton/)&lt;br/&gt;
</comment>
                    <comment id="12736533" author="alessandrod" created="Wed, 29 Jul 2009 08:53:23 +0000 (UTC)"  >I polished the patch and made sure it doesn&apos;t break spidermonkey 1.7.&lt;br/&gt;
I still haven&apos;t had time to look at the failing test, I hope I will have some&lt;br/&gt;
time later today.</comment>
                    <comment id="12738116" author="janl" created="Sun, 2 Aug 2009 19:11:40 +0000 (UTC)"  >The latest patch fails for me during make:&lt;br/&gt;
&lt;br/&gt;
ccache gcc -DHAVE_CONFIG_H -I. -I../..   -L/tmp/lib/ -L/usr/local/lib -L/opt/local/lib -I/usr/local/lib/erlang/usr/include -I/usr/lib/erlang/usr/include -I/usr/local/lib/erlang/usr/include -I/opt/local/lib/erlang/usr/include -I/tmp/include/ -DXP_UNIX    -g -O2 -MT couchjs-couch_js.o -MD -MP -MF .deps/couchjs-couch_js.Tpo -c -o couchjs-couch_js.o `test -f &apos;couch_js.c&apos; || echo &apos;./&apos;`couch_js.c&lt;br/&gt;
mv -f .deps/couchjs-couch_js.Tpo .deps/couchjs-couch_js.Po&lt;br/&gt;
ccache gcc -DHAVE_CONFIG_H -I. -I../..   -L/tmp/lib/ -L/usr/local/lib -L/opt/local/lib -I/usr/local/lib/erlang/usr/include -I/usr/lib/erlang/usr/include -I/usr/local/lib/erlang/usr/include -I/opt/local/lib/erlang/usr/include -I/tmp/include/ -DXP_UNIX    -g -O2 -MT couchjs-curlhelper.o -MD -MP -MF .deps/couchjs-curlhelper.Tpo -c -o couchjs-curlhelper.o `test -f &apos;curlhelper.c&apos; || echo &apos;./&apos;`curlhelper.c&lt;br/&gt;
mv -f .deps/couchjs-curlhelper.Tpo .deps/couchjs-curlhelper.Po&lt;br/&gt;
/bin/sh ../../libtool --tag=CC   --mode=link ccache gcc  -g -O2  -L/tmp/lib/ -L/usr/local/lib -L/opt/local/lib -I/usr/local/lib/erlang/usr/include -I/usr/lib/erlang/usr/include -I/usr/local/lib/erlang/usr/include -I/opt/local/lib/erlang/usr/include -I/tmp/include/ -DXP_UNIX  -lm  -o couchjs couchjs-couch_js.o couchjs-curlhelper.o -lcurl -lmozjs -L/tmp/lib/ -L/usr/local/lib -L/opt/local/lib -lpthread &lt;br/&gt;
ccache gcc -g -O2 -I/usr/local/lib/erlang/usr/include -I/usr/lib/erlang/usr/include -I/usr/local/lib/erlang/usr/include -I/opt/local/lib/erlang/usr/include -I/tmp/include/ -DXP_UNIX -o couchjs couchjs-couch_js.o couchjs-curlhelper.o  -L/tmp/lib/ -L/usr/local/lib -L/opt/local/lib -lm -lcurl -lmozjs -lpthread&lt;br/&gt;
Undefined symbols:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;_JS_SetBranchCallback&amp;quot;, referenced from:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_main in couchjs-couch_js.o&lt;br/&gt;
ld: symbol(s) not found&lt;br/&gt;
collect2: ld returned 1 exit status&lt;br/&gt;
make[3]: *** [couchjs] Error 1&lt;br/&gt;
make[2]: *** [all-recursive] Error 1&lt;br/&gt;
make[1]: *** [all-recursive] Error 1&lt;br/&gt;
make: *** [all] Error 2&lt;br/&gt;
</comment>
                    <comment id="12738123" author="janl" created="Sun, 2 Aug 2009 19:53:13 +0000 (UTC)"  >Thanks to Paul Davis, I could now apply the patch correctly. The issue seems to be that the #if JS_VERSION &amp;lt;= 170 doesn&apos;t get picked up correctly. When I comment out the if branch and only keep the else, the patch works. I see all tests passing but the show_documents one.</comment>
                    <comment id="12738125" author="janl" created="Sun, 2 Aug 2009 20:08:47 +0000 (UTC)"  >This patch makes the failing test case pass. Thanks to Paul Davis again:&lt;br/&gt;
&lt;br/&gt;
Index: share/www/script/test/show_documents.js&lt;br/&gt;
===================================================================&lt;br/&gt;
--- share/www/script/test/show_documents.js	(revision 799860)&lt;br/&gt;
+++ share/www/script/test/show_documents.js	(working copy)&lt;br/&gt;
@@ -112,7 +112,7 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Becase Safari can&apos;t stand to see that dastardly&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// E4X outside of a string. Outside of tests you&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// can just use E4X literals.&lt;br/&gt;
-            this.eval(&apos;&lt;a href=&apos;mailto:xml.node.@foo&apos;&gt;xml.node.@foo&lt;/a&gt; = doc.word&apos;);&lt;br/&gt;
+            eval(&apos;&lt;a href=&apos;mailto:xml.node.@foo&apos;&gt;xml.node.@foo&lt;/a&gt; = doc.word&apos;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;body: xml&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;};&lt;br/&gt;
</comment>
                    <comment id="12738944" author="janl" created="Tue, 4 Aug 2009 12:30:55 +0000 (UTC)"  >Committed in r800750.</comment>
                </comments>
    
    <attachments>
            <attachment id="12415299" name="COUCHDB-288-tests.patch" size="587" author="janl" created="Sun, 2 Aug 2009 20:10:00 +0000 (UTC)" />
            <attachment id="12414870" name="couchdb_spidermonkey_tip-1.diff" size="2580" author="alessandrod" created="Wed, 29 Jul 2009 08:53:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 4 Aug 2009 12:30:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Mar 2009 22:13:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-287] Changing the update notifier only takes effect on restart</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-287</link>

                    <description>Changing the update notifier only takes effect on restart. However, it should take effect as soon as the change is made.&lt;br/&gt;
&lt;br/&gt;
To reproduce:&lt;br/&gt;
- Create a script based on &lt;a href=&quot;http://wiki.apache.org/couchdb/Regenerating_views_on_update&quot;&gt;http://wiki.apache.org/couchdb/Regenerating_views_on_update&lt;/a&gt;&lt;br/&gt;
- Duplicate the script, tweaking the output contents &lt;br/&gt;
- Update your local.ini file pointing to a copy of the script&lt;br/&gt;
- Change from one script to the other in &lt;a href=&quot;http://127.0.0.1:5984/_utils/config.html&quot;&gt;http://127.0.0.1:5984/_utils/config.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
No changes take effect until CouchDB is restarted.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12416617">COUCHDB-287</key>
        <summary>Changing the update notifier only takes effect on restart</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Wed, 11 Mar 2009 08:31:29 +0000 (UTC)</created>
    <updated>Sun, 15 Nov 2009 21:20:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12777857" author="dipthegeezer" created="Sat, 14 Nov 2009 09:46:18 +0000 (UTC)"  >Hi&lt;br/&gt;
&lt;br/&gt;
I think this is fixed with this commit in couch_db_update_notifier_sup.erl in the main trunk:&lt;br/&gt;
&lt;br/&gt;
r776715 | kocolosk | 2009-05-20 15:41:00 +0100 (Wed, 20 May 2009) | 1 line&lt;br/&gt;
&lt;br/&gt;
restart update_notification process when config changes&lt;br/&gt;
&lt;br/&gt;
Anyway I couldn&apos;t reproduce using the above Steps to replicate. It seemed to work fine when I switched via the config.html. &lt;br/&gt;
&lt;br/&gt;
If I am wrong please let me know?&lt;br/&gt;
&lt;br/&gt;
Thanks&lt;br/&gt;
&lt;br/&gt;
Dip</comment>
                    <comment id="12778178" author="kocolosk" created="Sun, 15 Nov 2009 21:20:46 +0000 (UTC)"  >Thanks Dipesh, you&apos;re quite right.  I missed this ticket when I committed that fix.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 15 Nov 2009 21:20:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 14 Nov 2009 09:46:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-286] Unit test fail: show_documents</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-286</link>

                    <description>The current HEAD fails the show_documents test with the following error:&lt;br/&gt;
&lt;br/&gt;
# Exception raised:&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;message&amp;quot;:&amp;quot;console is not defined&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;fileName&amp;quot;:&amp;quot;&lt;a href=&quot;http://ec2-75-101-233-200.compute-1.amazonaws.com:5984/_utils/script/couch_test_runner.js&quot;&gt;http://ec2-75-101-233-200.compute-1.amazonaws.com:5984/_utils/script/couch_test_runner.js&lt;/a&gt;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;lineNumber&amp;quot;:61,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;stack&amp;quot;:&amp;quot;((void 0))@&lt;a href=&quot;http://ec2-75-101-233-200.compute-1.amazonaws.com:5984/_utils/script/couch_test_runner.js:61&quot;&gt;http://ec2-75-101-233-200.compute-1.amazonaws.com:5984/_utils/script/couch_test_runner.js:61&lt;/a&gt;\nrun(233)@&lt;a href=&quot;http://ec2-75-101-233-200.compute-1.amazonaws.com:5984/_utils/script/couch_test_runner.js:78&quot;&gt;http://ec2-75-101-233-200.compute-1.amazonaws.com:5984/_utils/script/couch_test_runner.js:78&lt;/a&gt;\n&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;name&amp;quot;:&amp;quot;ReferenceError&amp;quot;&lt;br/&gt;
} &lt;br/&gt;
&lt;br/&gt;
It looks to me like jchris accidentally left some debugging code in the file.  The attached patch corrects the bug.</description>
                <environment>Ubuntu 8.10 EC2 server</environment>
            <key id="12416497">COUCHDB-286</key>
        <summary>Unit test fail: show_documents</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jhs">Jason Smith</reporter>
            
    <created>Tue, 10 Mar 2009 07:27:26 +0000 (UTC)</created>
    <updated>Tue, 10 Mar 2009 08:23:02 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12680396" author="jhs" created="Tue, 10 Mar 2009 07:28:15 +0000 (UTC)"  >Remove console.log call to correct failing test</comment>
                    <comment id="12680406" author="janl" created="Tue, 10 Mar 2009 08:23:02 +0000 (UTC)"  >Fixed in r752020. Thanks.</comment>
                </comments>
    
    <attachments>
            <attachment id="12401813" name="couchdb-show_documents-bugfix.patch" size="506" author="jhs" created="Tue, 10 Mar 2009 07:28:15 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 10 Mar 2009 08:23:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 10 Mar 2009 08:23:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-285] tail append headers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-285</link>

                    <description>this will make .couch files resilient even when truncated (data-loss but still usable). also cuts down on the # of disk seeks.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[3:02pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
damienkatz: the offset in a header would corresponds to number of bytes from the front of the file?&lt;br/&gt;
[3:03pm]&lt;br/&gt;
andysky joined the chat room.&lt;br/&gt;
[3:03pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
jchris: yes&lt;br/&gt;
[3:03pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
because my offset seems to suggest that just over a MB of the file is missing&lt;br/&gt;
[3:03pm] &amp;#xBB; jchris &lt;br/&gt;
blames not couchdb&lt;br/&gt;
[3:03pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
but the streaming writes you&apos;ve talked about would make this more resilent, eh?&lt;br/&gt;
[3:03pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
where the header is also appended each time&lt;br/&gt;
[3:04pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
there could be data lost but the db would still be usable&lt;br/&gt;
[3:04pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
yes, a file truncation just  gives you and earlier version of the file&lt;br/&gt;
[3:05pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
now&apos;s not a good time for me to work on that, but after Amsterdam I may want to pick it up&lt;br/&gt;
[3:05pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
the hardest part is finding the header again&lt;br/&gt;
[3:06pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
hu? isn&apos;t the header the firs 4k?&lt;br/&gt;
[3:06pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
t&lt;br/&gt;
[3:06pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
it would only really change couch_file:read_header and write_header I think&lt;br/&gt;
[3:06pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
jan____: we&apos;re talking about moving it to the end&lt;br/&gt;
[3:06pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
so it never gets overwritten&lt;br/&gt;
[3:06pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
jan____: this is for tail append headers&lt;br/&gt;
[3:06pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
duh&lt;br/&gt;
[3:06pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
futuretalk&lt;br/&gt;
[3:06pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
n/m me&lt;br/&gt;
[3:07pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
jchris: so one way is to sign the header regions, but you need to make it unforgable.&lt;br/&gt;
[3:08pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
basically a boundary problem...&lt;br/&gt;
[3:08pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
because if a client wrote a binary that looked like it had a header, they could do bad things.&lt;br/&gt;
[3:08pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
like for instance an attachment that&apos;s a .couch file :)&lt;br/&gt;
[3:08pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
right&lt;br/&gt;
[3:09pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
so you can salt the db file on creation with a key in the header. And use that key to sign and verify headers.&lt;br/&gt;
[3:09pm]&lt;br/&gt;
tlrobinson joined the chat room.&lt;br/&gt;
[3:09pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
doesn&apos;t sound too tough&lt;br/&gt;
[3:10pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
damienkatz: I looked into adding conflict inducing bulk docs in rep_security. would this work: POST /db/_bulk_docs?allow_conflicts=true could do a regular bulk save but grab the &amp;quot;error&amp;quot; responses and do a update_docs() call with the replicated_changes option for all &amp;quot;errors&amp;quot; from the first bulk save while assigning new _revs for &amp;quot;new&amp;quot; docs?&lt;br/&gt;
[3:10pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
the key is crypto-random, and must stay hidden from clients.&lt;br/&gt;
[3:10pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
if you have the file, you could forge headers...&lt;br/&gt;
[3:10pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
but under normal operation, it sounds like not a big deal&lt;br/&gt;
[3:10pm]&lt;br/&gt;
Qaexl joined the chat room.&lt;br/&gt;
[3:11pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
so we just give the db an internal secret uuid&lt;br/&gt;
[3:11pm]&lt;br/&gt;
mmalone left the chat room. (Connection reset by peer)&lt;br/&gt;
[3:11pm]&lt;br/&gt;
peritus_ joined the chat room.&lt;br/&gt;
[3:11pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
I&apos;m not sure I like this approach.&lt;br/&gt;
[3:11pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
damienkatz: drawbacks?&lt;br/&gt;
[3:11pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
if a client can see a file share with the db, they can attack it.&lt;br/&gt;
[3:12pm]&lt;br/&gt;
mmalone joined the chat room.&lt;br/&gt;
[3:12pm]&lt;br/&gt;
mmalone left the chat room. (Read error: 104 (Connection reset by peer))&lt;br/&gt;
[3:12pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
how about this approach. every 4k, we write a NULL byte.&lt;br/&gt;
[3:13pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
we always write headers at the 4k boundary&lt;br/&gt;
[3:13pm]&lt;br/&gt;
mmalone joined the chat room.&lt;br/&gt;
[3:13pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
and make that byte 1&lt;br/&gt;
[3:13pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
grr&lt;br/&gt;
[3:13pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
did my bulk-docs proposal get through?&lt;br/&gt;
[3:13pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
the attacker could still get lucky&lt;br/&gt;
[3:13pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
(or got it shot down? :)&lt;br/&gt;
[3:13pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
jan____: sorry.&lt;br/&gt;
[3:13pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
damienkatz: I couldn&apos;t read the backlog&lt;br/&gt;
[3:13pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
Let me think about the conflict stuff a little bit.&lt;br/&gt;
[3:13pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
sure&lt;br/&gt;
[3:13pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
no baclog then&lt;br/&gt;
[3:14pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
+k&lt;br/&gt;
[3:14pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
jan____: your paragraph is dense there -&lt;br/&gt;
[3:14pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
jchris: no, this is immune from attack&lt;br/&gt;
[3:14pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
because you&apos;d write an attachment marker after the null byte for attachments?&lt;br/&gt;
[3:14pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
every 4k, we just write a 0 byte, we skip that byte.&lt;br/&gt;
[3:15pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
jchris: yeah, sorry, will let you finish the file stuff&lt;br/&gt;
[3:15pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
no matter what, we never write anything into that byte.&lt;br/&gt;
[3:15pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
wasting all these 0 bytes&lt;br/&gt;
[3:15pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
a big file right whil write all the surrounding bytes, but not that byte.&lt;br/&gt;
[3:16pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
only 1 every 4k jan. I think we&apos;ll manage ;)&lt;br/&gt;
[3:16pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
:)&lt;br/&gt;
[3:16pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
when that byte is a 1 though, that means is the start of a header.&lt;br/&gt;
[3:16pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
oh, gotcha&lt;br/&gt;
[3:17pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
so headers always get written on a 4k boundary.&lt;br/&gt;
[3:17pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
and nothing else does&lt;br/&gt;
[3:17pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
that means the average cost of a write, before we even write the data of the new header, is 2k on average.&lt;br/&gt;
[3:17pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
because we have to jump at least that far for the new header&lt;br/&gt;
[3:18pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
yes&lt;br/&gt;
[3:18pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
compaction could fill it in though&lt;br/&gt;
[3:18pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
we can change the boundary to be 1k,2k etc.&lt;br/&gt;
[3:19pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
I think couch_file would handle the skipping of the byte, make it transparent.&lt;br/&gt;
[3:19pm] &amp;lt;Monty&amp;gt;&lt;br/&gt;
kind of mohican or bleach, but someone else?&lt;br/&gt;
[3:19pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
both on reading and writing. and it would handle writing the header.&lt;br/&gt;
[3:19pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
and reading the header on start.&lt;br/&gt;
[3:19pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
handle_call({append_bin can do the 4k stuff&lt;br/&gt;
[3:20pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
damienkatz: how does the null byte protect against a malicious attachment?&lt;br/&gt;
[3:20pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
and of course, you can link to the previou headers, chaining the different db states as a history.&lt;br/&gt;
[3:20pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
davisp: because nothing can fill that byte ever.&lt;br/&gt;
[3:21pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
the guaranteed 4k offset also makes finding a header on cold start faster&lt;br/&gt;
[3:21pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
damienkatz: But couldn&apos;t I design a malicious binary that looked like a header?&lt;br/&gt;
[3:21pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
yes, but we wouldn&apos;t see it.&lt;br/&gt;
[3:22pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
I must be missing something&lt;br/&gt;
[3:22pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
when we write a header, we set the byte too 1.&lt;br/&gt;
[3:22pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
The 4k offset thing would be harder to overcome, but you could brute force it with 4k*4k max&lt;br/&gt;
[3:22pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
I have no idea how big that is&lt;br/&gt;
[3:22pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
jchris: less dense: v&lt;br/&gt;
[3:22pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
&lt;a href=&quot;http://friendpaste.com/4rid4TsUNBYjlUse9wm8qP&quot;&gt;http://friendpaste.com/4rid4TsUNBYjlUse9wm8qP&lt;/a&gt;&lt;br/&gt;
[3:22pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
attachments are written around the byte&lt;br/&gt;
[3:22pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
*lets dance*&lt;br/&gt;
[3:23pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
davisp: is not possible to attack this scheme.&lt;br/&gt;
[3:23pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
I must be missing something&lt;br/&gt;
[3:23pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
Then again, my knowledge of the attachment writing is slim to none&lt;br/&gt;
[3:23pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
when the db engine writes attachments, is leaves a 0 byte every 4k.&lt;br/&gt;
[3:24pm] &amp;lt;damienkatz&amp;gt;&lt;br/&gt;
when it reads the attachment back, it skips that byte again.&lt;br/&gt;
[3:24pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
light bulb!&lt;br/&gt;
[3:24pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
same here :D&lt;br/&gt;
[3:24pm] &amp;lt;jan____&amp;gt;&lt;br/&gt;
davisp: *5*&lt;br/&gt;
[3:24pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
is there a ticket for this yet?&lt;br/&gt;
[3:24pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
if not I&apos;ll attach this transcript to one</description>
                <environment></environment>
            <key id="12416381">COUCHDB-285</key>
        <summary>tail append headers</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Sat, 7 Mar 2009 23:30:40 +0000 (UTC)</created>
    <updated>Fri, 17 Jul 2009 16:13:24 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12680323" author="rnewson" created="Mon, 9 Mar 2009 23:29:23 +0000 (UTC)"  >&lt;br/&gt;
I like this idea. One further enhancement is to break the .couch file into multiple files (with sequential names, i.e, dbname-0000001.couch, dbname-0000002.couch, etc). if each file were 100MB (configurable, I guess), you&apos;d still get good I/O rates.&lt;br/&gt;
&lt;br/&gt;
This would allow incremental database compaction and would mean compaction could occur with less disk space, allowing a couchdb database to exceed 50% of the capacity of a disk (which it currently cannot, unless you never compact).&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 17 Jul 2009 16:13:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 9 Mar 2009 23:29:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-284] Couchdb can&apos;t find main.js when running under a path that contains a directory name starting with two or more dashes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-284</link>

                    <description>When coucdb runs in directory below any directory whose name starts with two or more dashes, say&lt;br/&gt;
&lt;br/&gt;
/some/path/---foo/couch&lt;br/&gt;
&lt;br/&gt;
It will error when it tries to call main.js with:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;could not open script file /path/some/-foo/couch/share/server/main.js&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Note that the first two dashes have been dropped.&lt;br/&gt;
</description>
                <environment>Ubuntu Linux</environment>
            <key id="12416310">COUCHDB-284</key>
        <summary>Couchdb can&apos;t find main.js when running under a path that contains a directory name starting with two or more dashes</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Fri, 6 Mar 2009 15:28:41 +0000 (UTC)</created>
    <updated>Fri, 6 Mar 2009 15:28:41 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Build System</component>
                    <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-283] Query parse errors should be returned as 400 Bad Request, not 500 Internal Server Error</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-283</link>

                    <description>Thus quoth Jan:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;jan____: jasondavies: the 500 status code is for bugs in the server&lt;br/&gt;
&lt;br/&gt;
Patch to follow...</description>
                <environment></environment>
            <key id="12416304">COUCHDB-283</key>
        <summary>Query parse errors should be returned as 400 Bad Request, not 500 Internal Server Error</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Fri, 6 Mar 2009 13:12:04 +0000 (UTC)</created>
    <updated>Fri, 6 Mar 2009 16:46:00 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12679585" author="jasondd" created="Fri, 6 Mar 2009 13:15:05 +0000 (UTC)"  >This patch updates tests and couch_httpd_view:parse_view_query to throw bad_request instead of query_parse_error, thus returning a 400 instead of a 500 response.&lt;br/&gt;
&lt;br/&gt;
This patch also includes a minor update to couch_httpd_show to validate the query for reduce _lists (this was originally attached to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-269&quot; title=&quot;_list doesn&apos;t allow POST requests&quot;&gt;&lt;strike&gt;COUCHDB-269&lt;/strike&gt;&lt;/a&gt;, but moving it here as the tests for it also needed updating and it&apos;s only a few lines long).</comment>
                    <comment id="12679639" author="jchris" created="Fri, 6 Mar 2009 16:46:00 +0000 (UTC)"  >fixed in r750969</comment>
                </comments>
    
    <attachments>
            <attachment id="12401622" name="bad_requests.diff" size="8048" author="jasondd" created="Fri, 6 Mar 2009 13:15:05 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 6 Mar 2009 16:46:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 6 Mar 2009 16:46:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-282] Abort views that have exceptions in the view server</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-282</link>

                    <description>I&apos;m incrementally experimenting with new views on a 100K document db. If there&apos;s a typo in the javascript view or some other exception, there&apos;s a spew of logs in couch.log while each of the couch documents continue to go through the map/reduce code (which is buggy). This takes about 15 minutes before I can update the view and re-query again. It would be awesome if couch can handle exceptions in the view server and stop processing so that the fix can be made.</description>
                <environment>All</environment>
            <key id="12416279">COUCHDB-282</key>
        <summary>Abort views that have exceptions in the view server</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kowsik">kowsik</reporter>
            
    <created>Fri, 6 Mar 2009 05:30:48 +0000 (UTC)</created>
    <updated>Fri, 6 Mar 2009 05:30:48 +0000 (UTC)</updated>

                        <version>0.8</version>
                    <version>0.8.1</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-281] couch clobbers stdout file and stderr file</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-281</link>

                    <description>If you start couch with -o or -e and give it a file that already exists, it truncates the file rather than appending to it.</description>
                <environment>Linux melkjug.com 2.6.23-gentoo-r8 #1 SMP Wed Feb 13 14:28:49 EST 2008 x86_64 QEMU Virtual CPU version 0.9.1 GenuineIntel GNU/Linux</environment>
            <key id="12416227">COUCHDB-281</key>
        <summary>couch clobbers stdout file and stderr file</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Thu, 5 Mar 2009 18:05:54 +0000 (UTC)</created>
    <updated>Thu, 5 Mar 2009 18:13:08 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12679276" author="nslater" created="Thu, 5 Mar 2009 18:13:08 +0000 (UTC)"  >Good catch. Fixed in r750531. Thanks</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 5 Mar 2009 18:13:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 5 Mar 2009 18:13:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-280] relative links between resources provided by design docs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-280</link>

                    <description>In an earlier thread we discussed the costs and benefits of changing CouchDB so that all the resources provided by a design doc are rooted in the design doc.&lt;br/&gt;
&lt;br/&gt;
Under the current system, there is no way to link among HTML files attached to a design docs, the HTML output of show and list functions, and view queries. The only way to link between these resources is by hard-coding the design doc name in your link. By giving the resources provided by design docs a common root, one can link between them using hrefs like &amp;quot;../../_show/sname/docid&amp;quot;. &lt;br/&gt;
&lt;br/&gt;
The current system never posed a problem before, because design docs only provided one type of resource. However, going forward I can see that design docs could continue to provide new, unanticipated resources. Jason Davies has proposed an _update resource, which would be a JavaScript (or other language) function that can accept request with non-JSON bodies (for instance POSTed XML from a webhook service) and convert them to JSON for storage.&lt;br/&gt;
&lt;br/&gt;
The advantages to decomposing the traditional &amp;quot;accept a request, do whatever you want, send a reply&amp;quot; app-server model into discrete functions are numerous, the main one being that developers can support custom non-JSON content-types, while still interacting with the database in a manner where side-effects and memory / runtime characteristics are controlled.&lt;br/&gt;
&lt;br/&gt;
Show and list break non-JSON rendering down into the right sized granules for safe, cacheable idempotent requests. But because we we can&apos;t link between them (and design doc attachments) using normal html links (the links must be computed on the server) they aren&apos;t enough to provide a hypermedia interface for CouchDB. Hypermedia is above what CouchDB has been shooting for, but we are so close now that it seems silly not to go the &amp;quot;rest&amp;quot; of the way.&lt;br/&gt;
&lt;br/&gt;
If it were just the tradeoffs between relative links (good) and slightly uglier urls (bad) I&apos;d be roughly +0 on this change. But a consequence of giving design doc resources a common root is that the applications the define can then be proxied with a URL rewriter. The means that (if written correctly) an application with paths like:&lt;br/&gt;
&lt;br/&gt;
/db/_design/foo/_view/bar?limit=10&lt;br/&gt;
/db/_design/foo/_show/docid&lt;br/&gt;
/db/_design/foo/index.html&lt;br/&gt;
&lt;br/&gt;
can be proxied so that the &amp;quot;/db/_design/foo&amp;quot; part of the URL is added by the proxy, so that all clients see is:&lt;br/&gt;
&lt;br/&gt;
/_view/bar?limit=10&lt;br/&gt;
/_show/docid&lt;br/&gt;
/index.html&lt;br/&gt;
&lt;br/&gt;
This also nicely limits end-client access, so that they may only interact with the database using resources provided by the design doc. I consider this an edge-case for deployment but the fact that we can cleanly support makes me think we&apos;re on the right track with the change to a common root for design doc resources.&lt;br/&gt;
&lt;br/&gt;
For more details about these URL path interactions, see the earlier thread:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200902.mbox/%3Ce282921e0902242116n2cd207c4x7a9d0feced3f10d9@mail.gmail.com%3E&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200902.mbox/%3Ce282921e0902242116n2cd207c4x7a9d0feced3f10d9@mail.gmail.com%3E&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;ve implemented a patch (attached to this ticket) that makes it so that views, shows, lists, and design doc attachments are all rooted under the design doc.&lt;br/&gt;
&lt;br/&gt;
It works by adding a section to the ini file, like this (which we could use to easily add new resource, like the _update mentioned above):&lt;br/&gt;
&lt;br/&gt;
[httpd_design_handlers]&lt;br/&gt;
_view = {couch_httpd_view, handle_view_req}&lt;br/&gt;
_show = {couch_httpd_show, handle_doc_show_req}&lt;br/&gt;
_list = {couch_httpd_show, handle_view_list_req}&lt;br/&gt;
&lt;br/&gt;
the _design handler itself is just an http_db_handler. &lt;br/&gt;
&lt;br/&gt;
Points of discussion:&lt;br/&gt;
&lt;br/&gt;
If we want to change the names of any of: _view, _show, _list, or _design now is a good time to do it. We&apos;ve been over the names _list and _show many times, and while they aren&apos;t perfect, they are short, and more-or-less descriptive of what they do.&lt;br/&gt;
&lt;br/&gt;
The code is robust about changes to the _design db handler&apos;s name. That is, we could continue to call them design docs, and store them with ids like &amp;quot;_design/name&amp;quot;, while changing the resource root so that the above set of URLs could be something like (modulo an attachments handler, &amp;quot;_files&amp;quot; here, for clarity):&lt;br/&gt;
&lt;br/&gt;
/db/_baz/foo/_view/bar?limit=10&lt;br/&gt;
/db/_baz/foo/_show/docid&lt;br/&gt;
/db/_baz/foo/_files/index.html&lt;br/&gt;
&lt;br/&gt;
Before we commit / before 0.9.0:&lt;br/&gt;
&lt;br/&gt;
This patch is a big enough change that I think we should vote on it before I commit it. However, I&apos;d like to get it in before 0.9.0 to avoid future confusion where trunk is incompatible with API clients and applications designed to run on our latest release.&lt;br/&gt;
&lt;br/&gt;
Sincerely,&lt;br/&gt;
Chris&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12416068">COUCHDB-280</key>
        <summary>relative links between resources provided by design docs</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 4 Mar 2009 04:15:04 +0000 (UTC)</created>
    <updated>Mon, 9 Mar 2009 19:53:27 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due>Fri, 6 Mar 2009 08:00:00 +0000 (UTC)</due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12678577" author="jchris" created="Wed, 4 Mar 2009 04:20:38 +0000 (UTC)"  >Patch forthcoming, you can access it here while I rebase against trunk:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/jchris/couchdb/tree/rel-paths&quot;&gt;http://github.com/jchris/couchdb/tree/rel-paths&lt;/a&gt;</comment>
                    <comment id="12678588" author="jchris" created="Wed, 4 Mar 2009 05:27:46 +0000 (UTC)"  >Here is a patch, against r749902. &lt;br/&gt;
&lt;br/&gt;
The previously mentioned github branch is out of date. If you want to use git, the branch is here:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/jchris/couchdb/tree/rel-paths-rebased&quot;&gt;http://github.com/jchris/couchdb/tree/rel-paths-rebased&lt;/a&gt;</comment>
                    <comment id="12680245" author="jchris" created="Mon, 9 Mar 2009 19:53:27 +0000 (UTC)"  >closed in r751813</comment>
                </comments>
    
    <attachments>
            <attachment id="12401368" name="relative-design-paths.diff" size="26391" author="jchris" created="Wed, 4 Mar 2009 05:27:46 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 9 Mar 2009 19:53:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-279] couchdb stops logging after logrotate</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-279</link>

                    <description>after logrotate (which performs copytruncate) finishes, my couch logfiles remain empty even though couch is responding to requests and up until the rotate was logging them. here is some lsof output:&lt;br/&gt;
&lt;br/&gt;
# lsof | grep couch.log&lt;br/&gt;
beam      19084 couchdb    8w      REG                3,1    98655952    4145164 /var/log/couchdb/couch.log&lt;br/&gt;
</description>
                <environment>Linux melkjug.com 2.6.23-gentoo-r8 #1 SMP Wed Feb 13 14:28:49 EST 2008 x86_64 QEMU Virtual CPU version 0.9.1 GenuineIntel GNU/Linux&lt;br/&gt;
</environment>
            <key id="12416046">COUCHDB-279</key>
        <summary>couchdb stops logging after logrotate</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Tue, 3 Mar 2009 23:56:11 +0000 (UTC)</created>
    <updated>Wed, 4 Mar 2009 10:26:29 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-278] bin/couchdb does not honour -o and -e when running in foreground / without -d (matters on macosx)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-278</link>

                    <description>When couchdb is running in foreground, then the option flags -o and -e are not honoured. This probably quite ok on most systems because foregroud there equals roughly to development mode. On the mac this is different, because fork and daemoinze calls are deprecated, services are managed using launchd, and launchd watches these processes directly. It depends on these processes not (double-)forking and intentionally dying.&lt;br/&gt;
&lt;br/&gt;
So in the current state of things the provided plist starts couchdb, quite consequentially does not use -o/e and. That works, but has the effect that couchdb writes to stdout, which launchd apparently forwards to syslog. So the syslog ends up being hogged by access-log level messages. And it is not possible to avoid that by simply editing the quasi config file .plist.&lt;br/&gt;
&lt;br/&gt;
I will attach a patch which changes bin/couchdb, .plist, and etc/Makefile.am to make this work more like I reckon it should.</description>
                <environment>any *nix</environment>
            <key id="12416045">COUCHDB-278</key>
        <summary>bin/couchdb does not honour -o and -e when running in foreground / without -d (matters on macosx)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="febeling">Florian Ebeling</reporter>
            
    <created>Tue, 3 Mar 2009 23:48:39 +0000 (UTC)</created>
    <updated>Mon, 23 Mar 2009 17:41:16 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
                    <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12678679" author="nslater" created="Wed, 4 Mar 2009 10:24:52 +0000 (UTC)"  >The -o and -e options are only provided so that that the -b option can redirect output, I do not want to provide a generic way to redirect output. In fact, I&apos;m not sure why this command would want to produce output in the first place, that&apos;s what the log file should be used for. If you think that the output to STDOUT and STDERR is too verbose, or that it should be sent to the log file only, please open another bug for that. Note that using init.d redirects these to /dev/null anyway, so I think there should be a little information sent over STDOUT and STDERR as possible.</comment>
                    <comment id="12678687" author="febeling" created="Wed, 4 Mar 2009 10:52:22 +0000 (UTC)"  >True, on close examination the help message makes that clear. Then I propose to change the plist only to /dev/null output. I can attach a patch later today.</comment>
                    <comment id="12680201" author="febeling" created="Mon, 9 Mar 2009 17:09:58 +0000 (UTC)"  >This patch changes the macosx launchd plist to write to stdout and stderr to /dev/null. So I lied in the original description.</comment>
                    <comment id="12688345" author="nslater" created="Mon, 23 Mar 2009 17:41:16 +0000 (UTC)"  >Fixed in r757465. Thanks.</comment>
                </comments>
    
    <attachments>
            <attachment id="12401343" name="COUCHDB-278.diff" size="2426" author="febeling" created="Tue, 3 Mar 2009 23:51:16 +0000 (UTC)" />
            <attachment id="12401765" name="patch-plist_redirects_to_devnull.diff" size="531" author="febeling" created="Mon, 9 Mar 2009 17:09:57 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 17:41:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Mar 2009 10:24:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-277] Improve the OS process handling to have pool semantics.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-277</link>

                    <description>Just got reminded that I need to add pool semantics to OS processes. Now that we&apos;re using JS processes for more and more things other than Map/Reduce this will be especially important.</description>
                <environment></environment>
            <key id="12415973">COUCHDB-277</key>
        <summary>Improve the OS process handling to have pool semantics.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 3 Mar 2009 01:50:22 +0000 (UTC)</created>
    <updated>Tue, 3 Mar 2009 15:58:08 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12678353" author="jchris" created="Tue, 3 Mar 2009 15:58:08 +0000 (UTC)"  >There are a couple of notes here:&lt;br/&gt;
&lt;br/&gt;
One is that couch_query_servers (which is in charge of baby-sitting views, lists and shows) already manages a pool of processes to avoid opening and closing them.&lt;br/&gt;
&lt;br/&gt;
The second is that the main.js protocol could be enhanced so that the reduce, show, etc funs can be named (by md5?) so that they don&apos;t have to be resent for each request.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Mar 2009 15:58:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-276] Should have a command line flag to add to the erlang load path</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-276</link>

                    <description>Given that the couchdb script allows new configuration files to be loaded, I think you should be able to add to the erlang load path a similar fashion, so that the new configuration files can refer to erlang code not included with couchdb itself.</description>
                <environment></environment>
            <key id="12415970">COUCHDB-276</key>
        <summary>Should have a command line flag to add to the erlang load path</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="antonyblakey">Antony Blakey</reporter>
            
    <created>Tue, 3 Mar 2009 00:56:45 +0000 (UTC)</created>
    <updated>Tue, 3 Mar 2009 01:32:10 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12678178" author="antonyblakey" created="Tue, 3 Mar 2009 00:59:46 +0000 (UTC)"  >This patch adds an &apos;-l DIR&apos; command line option that prepends DIR to the erlang load path</comment>
                    <comment id="12678188" author="janl" created="Tue, 3 Mar 2009 01:32:10 +0000 (UTC)"  >You can set additional erlang args via environment variables.&lt;br/&gt;
&lt;br/&gt;
i.e. ERL_AFLAGS=&amp;quot;-pa /path/to/libs&amp;quot; couchdb&lt;br/&gt;
or ERL_LIBS=&amp;quot;/path/to/liibs&amp;quot; couchdb&lt;br/&gt;
&lt;br/&gt;
will do.&lt;br/&gt;
&lt;br/&gt;
From man erl:&lt;br/&gt;
&lt;br/&gt;
Environment variables&lt;br/&gt;
[...]&lt;br/&gt;
ERL_AFLAGS&lt;br/&gt;
The content of this environment variable will be added to the beginning of the command line for erl.&lt;br/&gt;
The -extra flag is treated specially. Its scope ends at the end of the environment variable content. Arguments following an -extra flag are moved on the command line into the -extra section, i.e. the end of the command line following after an -extra flag.&lt;br/&gt;
&lt;br/&gt;
ERL_ZFLAGS and ERL_FLAGS&lt;br/&gt;
The content of these environment variables will be added to the end of the command line for erl.&lt;br/&gt;
The -extra flag is treated specially. Its scope ends at the end of the environment variable content. Arguments following an -extra flag are moved on the command line into the -extra section, i.e. the end of the command line following after an -extra flag.&lt;br/&gt;
&lt;br/&gt;
ERL_LIBS&lt;br/&gt;
This environment variable contains a list of additional library directories that the code server will search for applications and add to the code path. See code(3).&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12401273" name="0001-Add-l-DIR-command-line-option-that-prepends-DIR-t.patch" size="2090" author="antonyblakey" created="Tue, 3 Mar 2009 00:59:46 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Mar 2009 01:32:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Mar 2009 01:32:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-275] couch crashes erlang vm under heavy load</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-275</link>

                    <description>I clicked &amp;quot;Compact&amp;quot; in futon for my 11G database at 9:04 AM EST:&lt;br/&gt;
&lt;br/&gt;
[Mon, 02 Mar 2009 14:04:32 GMT] [info] [&amp;lt;0.59.0&amp;gt;] Starting compaction for db &amp;quot;melkjug&amp;quot;&lt;br/&gt;
&lt;br/&gt;
An hour and a half later it was 85% finished and then the following was output to stderr:&lt;br/&gt;
&lt;br/&gt;
heart: Mon Mar  2 10:33:20 2009: heart-beat time-out.&lt;br/&gt;
/usr/bin/couchdb: line 255: echo: write error: Broken pipe&lt;br/&gt;
heart: Mon Mar  2 10:33:22 2009: Executed &amp;quot;/usr/bin/couchdb -k&amp;quot;. Terminating.&lt;br/&gt;
&lt;br/&gt;
I am retaining my 4.3G melkjug.couch.compact file in case it&apos;s useful in debugging this.</description>
                <environment>Linux melkjug.com 2.6.23-gentoo-r8 #1 SMP Wed Feb 13 14:28:49 EST 2008 x86_64 QEMU Virtual CPU version 0.9.1 GenuineIntel GNU/Linux&lt;br/&gt;
</environment>
            <key id="12415937">COUCHDB-275</key>
        <summary>couch crashes erlang vm under heavy load</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Mon, 2 Mar 2009 15:44:18 +0000 (UTC)</created>
    <updated>Thu, 14 May 2009 16:56:55 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12678028" author="nslater" created="Mon, 2 Mar 2009 16:08:46 +0000 (UTC)"  >Just for clarification, the issue here is related to the Erlang VM crashing.&lt;br/&gt;
&lt;br/&gt;
The weird broken pipe error is a benign artefact of the Erlang heart process trying to restart CouchDB.</comment>
                    <comment id="12678433" author="jab" created="Tue, 3 Mar 2009 20:05:16 +0000 (UTC)"  >This happened again last night, except not during compaction but rather during one of my application&apos;s update cycles (which slams couch with requests). Should have mentioned earlier, I am running off of trunk r746690. This did not used to happen when we were running off of r745993. Could running off a different revision of trunk help us avoid this? If so could you recommend one?&lt;br/&gt;
&lt;br/&gt;
Thanks,&lt;br/&gt;
Josh</comment>
                    <comment id="12678450" author="janl" created="Tue, 3 Mar 2009 21:21:16 +0000 (UTC)"  >What kind of load? &lt;br/&gt;
&lt;br/&gt;
Can you paste more relevant couch/log entries?</comment>
                    <comment id="12678456" author="jab" created="Tue, 3 Mar 2009 21:31:15 +0000 (UTC)"  >See &lt;a href=&quot;http://paste.pocoo.org/show/106370/&quot;&gt;http://paste.pocoo.org/show/106370/&lt;/a&gt; for the last 100 lines of couch.log. The last logged request is at  03 Mar 2009 08:11:48 GMT and at 08:12:04 GMT couch output the broken pipe error to stderr (see &lt;a href=&quot;http://paste.pocoo.org/show/106368/&quot;&gt;http://paste.pocoo.org/show/106368/&lt;/a&gt; for the last 100 lines of stderr output and &lt;a href=&quot;http://paste.pocoo.org/show/106367/&quot;&gt;http://paste.pocoo.org/show/106367/&lt;/a&gt; for the last 100 lines of stdout).&lt;br/&gt;
</comment>
                    <comment id="12678988" author="jab" created="Wed, 4 Mar 2009 23:30:25 +0000 (UTC)"  >updated to r749851 as jan___ in #couchdb told me about a file descriptor leak prior to r748299, and retried compaction. this time compaction appears to have successfully completed, at least the following was output to couch.log:&lt;br/&gt;
&lt;br/&gt;
[Wed, 04 Mar 2009 23:19:23 GMT] [debug] [&amp;lt;0.8952.0&amp;gt;] CouchDB swapping files /var/lib/couchdb/melkjug.couch and /var/lib/couchdb/melkjug.couch.compact.&lt;br/&gt;
&lt;br/&gt;
however, 11 seconds later (adjusting for my local time of GMT-5) the erlang vm appears to have crashed again: the following was output to stderr:&lt;br/&gt;
&lt;br/&gt;
heart: Wed Mar  4 18:19:34 2009: heart-beat time-out.&lt;br/&gt;
heart: Wed Mar  4 18:19:39 2009: Unable to kill old process, kill failed (tried multiple times).&lt;br/&gt;
heart: Wed Mar  4 18:19:40 2009: Executed &amp;quot;/usr/bin/couchdb -k&amp;quot;. Terminating.</comment>
                    <comment id="12679262" author="jab" created="Thu, 5 Mar 2009 17:59:06 +0000 (UTC)"  >couch crashed again while under heavy load early this morning. attaching an excerpt of the last 26 seconds of couch.log before the crash, 10:34:00 GMT to 10:34:26 GMT, in case it&apos;s more convenient than the pastebin link, all it indicates is the amount of load we&apos;re putting on couch -- 3422 requests in 26 seconds (~130req/sec) is typical load over the course of the 2.5 hours we update the database with people&apos;s news. The  15:10:43 GMT timestamp of the last few lines of the excerpt reflects that couch was down for the 5 hours between when it crashed and when I started it back up.</comment>
                    <comment id="12680569" author="jab" created="Tue, 10 Mar 2009 18:22:42 +0000 (UTC)"  >after attaching gdb to beam and triggering a crash by invoking a compaction, I got a backtrace with many lines like &amp;quot;#2073 0x00000000004a535b in enc_term ()&amp;quot;. from what i gathered from damienkatz in #couchdb the problem is the term_to_binary function calls itself recursively for nested lists and tuples which can cause a stack overflow. i tried compacting after doubling stack size via &amp;quot;ulimit -s&amp;quot; and it completed before crashing (yay!) but then crashed and came back a few seconds later.&lt;br/&gt;
</comment>
                    <comment id="12680628" author="damienkatz" created="Tue, 10 Mar 2009 21:36:03 +0000 (UTC)"  >This is patch to the Erlang vm for this crash. It fixes a problem with Erlang&apos;s term_to_binary code where it blows the C stack on deeply nested terms (ie deep trees). Example, this will crash any unpatched erlang VM:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; term_to_binary(lists:foldl(fun(E,A) -&amp;gt; [E, A] end, [], lists:seq(1, 100000))).&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This patch fixes the Erlang vm by changing the the term_to_binary code from a recursive C implementation to one using it&apos;s own stack.</comment>
                    <comment id="12680776" author="janl" created="Wed, 11 Mar 2009 07:35:23 +0000 (UTC)"  >Bj&amp;#xF6;rn Gustavsson from the OTP Team replies:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;We will not include the suggested patch in OTP.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;However, we do intend to fix the problem as soon as possible,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;in a way that degrades performance as little as possible,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;possibly already in the R13B release.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;/Bjorn&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;-- &lt;br/&gt;
&amp;nbsp;&amp;nbsp;Bj&amp;#xF6;rn Gustavsson, Erlang/OTP, Ericsson AB&lt;br/&gt;
</comment>
                    <comment id="12681179" author="jab" created="Thu, 12 Mar 2009 06:22:16 +0000 (UTC)"  >I have installed erlang R12B-5 on a development server, applied the attached patch, and can confirm that it prevents the term_to_binary snippet above from crashing erlang. did bjorn give any idea as to why the OTP team will not include this patch? would be good to know before we roll this out on our production server.</comment>
                    <comment id="12683519" author="jab" created="Thu, 19 Mar 2009 17:02:18 +0000 (UTC)"  >Though the patch prevented the term_to_binary snippet from crashing Erlang, compacting still caused a crash. I had gdb attached while it happened but it didn&apos;t help:&lt;br/&gt;
&lt;br/&gt;
# gdb program `pidof beam.smp`&lt;br/&gt;
...&lt;br/&gt;
(gdb) continue&lt;br/&gt;
Continuing.&lt;br/&gt;
&lt;br/&gt;
[hours pass while compaction progresses]&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB crashed, restarting in 3 seconds.&lt;br/&gt;
Program terminated with signal SIGKILL, Killed.&lt;br/&gt;
The program no longer exists.&lt;br/&gt;
(gdb) bt&lt;br/&gt;
No stack.&lt;br/&gt;
(gdb) # d&apos;oh&lt;br/&gt;
&lt;br/&gt;
For some reason it didn&apos;t catch Erlang in the act of crashing so there was no opportunity to get a backtrace.&lt;br/&gt;
&lt;br/&gt;
Using ulimit to increase stack size for now.</comment>
                    <comment id="12705084" author="jab" created="Fri, 1 May 2009 18:32:39 +0000 (UTC)"  >looks like this may have been fixed in the erlang/otp R13B release (just last week). from the release notes[1]:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;OTP-7894  The term_to_binary/1 BIF used to be implemented with&lt;br/&gt;
	      recursive C code, which could cause the Erlang emulator to&lt;br/&gt;
	      terminate because of a stack overflow.&lt;br/&gt;
&lt;br/&gt;
	      Also fixed some minor issues in term_to_binary/1 and&lt;br/&gt;
	      binary_to_term/1 pointed out by Matthew Dempsky.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Has anyone tried R13B yet?&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://erlang.org/download/otp_src_R13B.readme&quot;&gt;http://erlang.org/download/otp_src_R13B.readme&lt;/a&gt;</comment>
                    <comment id="12709457" author="jab" created="Thu, 14 May 2009 16:20:57 +0000 (UTC)"  >We are running Gentoo system installs of CouchDB 0.9 and Erlang R13B on a new production server and are no longer seeing the crashes. The term_to_binary snippet:&lt;br/&gt;
&lt;br/&gt;
1&amp;gt; term_to_binary(lists:foldl(fun(E,A) -&amp;gt; [E, A] end, [], lists:seq(1, 100000))).&lt;br/&gt;
&lt;br/&gt;
also no longer causes Erlang to crash.</comment>
                    <comment id="12709467" author="janl" created="Thu, 14 May 2009 16:56:55 +0000 (UTC)"  >Erlang R13B fixes this issue.</comment>
                </comments>
    
    <attachments>
            <attachment id="12401530" name="2009-03-05-couch.log.snippet" size="1302823" author="jab" created="Thu, 5 Mar 2009 17:59:06 +0000 (UTC)" />
            <attachment id="12401866" name="term_to_binary_fix.diff" size="16982" author="damienkatz" created="Tue, 10 Mar 2009 21:36:03 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 14 May 2009 16:56:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Mar 2009 16:08:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-274] Add a -C option to load configuration file without resetting system default</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-274</link>

                    <description>I created a patch that adds a -C (as opposed to lowercase -c) option that accepts one of more configuration files and overrides the system default with the values specified therein.</description>
                <environment></environment>
            <key id="12415931">COUCHDB-274</key>
        <summary>Add a -C option to load configuration file without resetting system default</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="thisfred">eric casteleijn</reporter>
            
    <created>Mon, 2 Mar 2009 14:17:40 +0000 (UTC)</created>
    <updated>Mon, 2 Mar 2009 14:51:17 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12677997" author="nslater" created="Mon, 2 Mar 2009 14:35:08 +0000 (UTC)"  >This line incorrectly removes the &amp;quot;:&amp;quot; setting from the &amp;quot;-c&amp;quot; option:&lt;br/&gt;
&lt;br/&gt;
-    options=`getopt hVc:ibp:r:Ro:e:skd $@`&lt;br/&gt;
+    options=`getopt hVcC:ibp:r:Ro:e:skd $@`&lt;br/&gt;
&lt;br/&gt;
Apart from that, I think this patch looks good to go. Thank you.</comment>
                    <comment id="12677998" author="thisfred" created="Mon, 2 Mar 2009 14:40:46 +0000 (UTC)"  >Restored &apos;:&apos; option to -c option. Thanks Noah.</comment>
                    <comment id="12678002" author="nslater" created="Mon, 2 Mar 2009 14:51:17 +0000 (UTC)"  >Patch applied in r749321. Thank you.</comment>
                </comments>
    
    <attachments>
            <attachment id="12401241" name="couchdb.patch" size="1717" author="thisfred" created="Mon, 2 Mar 2009 14:40:46 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Mar 2009 14:51:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Mar 2009 14:35:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-273] view rows should be able to include _rev</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-273</link>

                    <description>In our project we use maps in order to group objects, but do not generate any interesting any meaningful data to return from the mapping function aside from the sorted ordering. Our client basically does a GET against the view to determine what objects are in for a key. It has a local cache, and currently it then HEADs every object returned by that view to see if the objects need to be reloaded. If the rev was included in the row that would be unnecessary. Currently we are intending to return { &amp;quot;rev&amp;quot; : doc._rev } out of the mapping function, but the seems a bit clumsy.&lt;br/&gt;
&lt;br/&gt;
Jan suggested in irc that maybe the correct thing to do is to remove the &amp;quot;_id&amp;quot; from the roes by default and add both &amp;quot;_rev&amp;quot; and &amp;quot;_id&amp;quot; with an option (include_meta=true). This approach seems good to me, since I suspect people who are using views to manipulate the data in interesting ways generally don&apos;t need the object ids, and people who are using views primarily to organize objects almost always need the rev in addition to the object id.</description>
                <environment></environment>
            <key id="12415873">COUCHDB-273</key>
        <summary>view rows should be able to include _rev</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="lgerbarg">Louis Gerbarg</reporter>
            
    <created>Sun, 1 Mar 2009 12:00:44 +0000 (UTC)</created>
    <updated>Sun, 31 Jan 2010 10:57:02 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12677804" author="antonyblakey" created="Sun, 1 Mar 2009 13:10:44 +0000 (UTC)"  >I would like to see the rev in view rows, but for a different reason, namely exposing the view results as immutable values. There was a thread on this here: &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200901.mbox/%3c9F8937BF-9332-416C-BA01-4B1D001EA029@gmail.com%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200901.mbox/%3c9F8937BF-9332-416C-BA01-4B1D001EA029@gmail.com%3e&lt;/a&gt;</comment>
                    <comment id="12806802" author="jchris" created="Sun, 31 Jan 2010 10:57:02 +0000 (UTC)"  >this has been fixed for a while. Now you can use _id and _rev in view values to direct include docs. This is think satisfies the request.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 31 Jan 2010 10:57:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 1 Mar 2009 13:10:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-272] timeout on DELETE</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-272</link>

                    <description>issuing a DELETE on a database of moderate size(4GB or larger) results in couchdb returning a timeout error.&lt;br/&gt;
&lt;br/&gt;
(demo-couchdb)&lt;a href=&apos;mailto:jlh@jlh-d520&apos;&gt;jlh@jlh-d520&lt;/a&gt;:~/Projects/venvs/demo-couchdb/src$ curl -X DELETE &lt;a href=&quot;http://localhost:5984/couchdb-python-62&quot;&gt;http://localhost:5984/couchdb-python-62&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;timeout&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{gen_server,call,\n            [couch_server,\n             {delete,&amp;lt;&amp;lt;\&amp;quot;couchdb-python-62\&amp;quot;&amp;gt;&amp;gt;,\n                     [{user_ctx,{user_ctx,null,[&amp;lt;&amp;lt;\&amp;quot;_admin\&amp;quot;&amp;gt;&amp;gt;]}}]}]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
The database is deleted however the calling code is given bad information&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>apache couchdb 0.9.0a748865</environment>
            <key id="12415870">COUCHDB-272</key>
        <summary>timeout on DELETE</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dundeemt">Jeff Hinrichs</reporter>
            
    <created>Sun, 1 Mar 2009 04:20:44 +0000 (UTC)</created>
    <updated>Sun, 1 Mar 2009 04:23:08 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12677771" author="dundeemt" created="Sun, 1 Mar 2009 04:23:08 +0000 (UTC)"  >script shows the error occurring on my system.  depending on disk subsystem speed the size of the db necessary will vary.&lt;br/&gt;
&lt;br/&gt;
If you comment out the line #63&lt;br/&gt;
&amp;nbsp;&amp;nbsp;del srvA[dbAname]&lt;br/&gt;
&lt;br/&gt;
you can attempt the delete with curl and see the same results&lt;br/&gt;
&amp;nbsp;curl -X DELETE &lt;a href=&quot;http://localhost:5984/couchdb-python-62&quot;&gt;http://localhost:5984/couchdb-python-62&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
            <attachment id="12401192" name="couchdb_python62_Test.py" size="1966" author="dundeemt" created="Sun, 1 Mar 2009 04:23:08 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-271] preventing compaction from ruining the OS block cache</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-271</link>

                    <description>Adam Kocolosk:&lt;br/&gt;
&lt;br/&gt;
Hi, I&apos;ve noticed that compacting large DBs pretty much kills any filesystem caching benefits for CouchDB.  I believe the problem is that the OS (Linux 2.6.21 kernel in my case) is caching blocks from the .compact file, even though those blocks won&apos;t be read again until compaction has finished.  In the meantime, the portion of the cache dedicated to the old DB file shrinks and performance really suffers.&lt;br/&gt;
&lt;br/&gt;
I think a better mode of operation would be to advise/instruct the OS not to cache any portion of the .compact file until we&apos;re ready to replace the main DB.  On Linux, specifying the POSIX_FADV_DONTNEED option to posix_fadvise() seems like the way to go:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://linux.die.net/man/2/posix_fadvise&quot;&gt;http://linux.die.net/man/2/posix_fadvise&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
This link has a little more detail and a usage example:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://insights.oetiker.ch/linux/fadvise.html&quot;&gt;http://insights.oetiker.ch/linux/fadvise.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Of course, POSIX_FADV_DONTNEED isn&apos;t really available from inside the Erlang VM.  Perhaps the simplest approach would be to have a helper process that we can spawn which calls that function (or its equivalent on a non-Linux OS) periodically during compaction?  I&apos;m not really sure, but I wanted to get this out on the list for discussion.  Best,&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12415848">COUCHDB-271</key>
        <summary>preventing compaction from ruining the OS block cache</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sat, 28 Feb 2009 09:03:28 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:56 +0000 (UTC)</updated>

                        <version>0.8.1</version>
                    <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12677666" author="janl" created="Sat, 28 Feb 2009 09:03:57 +0000 (UTC)"  >Damien Katz:&lt;br/&gt;
&lt;br/&gt;
The problem is we don&apos;t get access to the low level apis or flags passed in to the OS unless Erlang chooses to expose it. We have similar problems with compaction on windows because we need special flags to give us unix file semantics.&lt;br/&gt;
&lt;br/&gt;
To fix this, we&apos;ll either need the Erlang VM changed or use our own Erlang file driver interface.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Oh yeah, one more option that is kind of crazy is to spawn a small external child process for file io. It would be a very small simple process that opens a file and responds to read/write commands from the erlang server. Then we can implement exactly the low level apis and caching behavior desired. The cost is extra IPC, but that should be small compare the the cost of a blown file cache.&lt;br/&gt;
</comment>
                    <comment id="12677667" author="janl" created="Sat, 28 Feb 2009 09:08:19 +0000 (UTC)"  >The best way to get any patch into OTP is coming up with a patch to send to erlang-patches@. If we manage to find cross-platform alternatives and a non-intrusive patch, I&apos;d assume a high chance of Ericsson accepting the patch.&lt;br/&gt;
&lt;br/&gt;
We could make it easy and label the patch Linux-only, but we might as well do some research for at least Windows, Solaris, the BSD&apos;s and Darwin.&lt;br/&gt;
&lt;br/&gt;
Once included and released with OTP, we&apos;d bump the minimum required version.&lt;br/&gt;
&lt;br/&gt;
If either the patch gets rejected or want to support older OTP releases, we should look into the external daemon variant.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12677669" author="lgerbarg" created="Sat, 28 Feb 2009 10:12:06 +0000 (UTC)"  >On darwin you do this by setting the  F_NOCACHE fcntl on the descriptor:&lt;br/&gt;
&lt;br/&gt;
#include &amp;lt;sys/fcntl.h&amp;gt;&lt;br/&gt;
&lt;br/&gt;
....&lt;br/&gt;
&lt;br/&gt;
err = fcntl(file_des, F_NOCACHE);&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12743898" author="rnewson" created="Sun, 16 Aug 2009 21:01:16 +0000 (UTC)"  >&lt;br/&gt;
Another way to approach this is to eliminate wholesale database writing to achieve compaction.&lt;br/&gt;
&lt;br/&gt;
Specifically, instead of a single file for a couchdb database it would be an ordered sequence of files. It&apos;s still append-only, so earlier files will contain data thats been superceded by updates, etc, just as they do today. Each file is eligible to be compacted separately by reading all the extant records from it and writing them to the end of the current file, the old file is then deleted. With this approach (c.f. Berkeley JE), compaction could be an ongoing background task, would not require 100% as much disk space as the database itself, and the current inability to swap to the .compact file in the presence of constant writes would also be addressed.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12772655" author="kocolosk" created="Mon, 2 Nov 2009 20:39:56 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 28 Feb 2009 10:12:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-270] Replication w/ Large Attachments Fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-270</link>

                    <description>Attempting to replicate a database with largish attachments (&amp;lt;= ~18MB of attachments in a doc, less thatn 200 docs)  from one machine to another fails consistently and at the same point.&lt;br/&gt;
&lt;br/&gt;
Scenario:&lt;br/&gt;
Both servers are running from HEAD and I&apos;ve been tracking for some time.  This problem has been around as long as I&apos;ve been using couch.&lt;br/&gt;
&lt;br/&gt;
Machine A holds the original database, Machine B is the server that is doing a PULL replication&lt;br/&gt;
&lt;br/&gt;
During the replication, Machine A starts showing the following sporadically in the log:&lt;br/&gt;
[Fri, 27 Feb 2009 14:02:48 GMT] [debug] [&amp;lt;0.5902.3&amp;gt;] &apos;GET&apos;&lt;br/&gt;
/delasco-invoices/INV00652429?revs=true&amp;amp;attachments=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;425644723&amp;quot;]&lt;br/&gt;
{1,&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1}&lt;br/&gt;
Headers: [{&apos;Host&apos;,&amp;quot;192.168.2.52:5984&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Fri, 27 Feb 2009 14:02:48 GMT] [error] [&amp;lt;0.5901.3&amp;gt;] Uncaught error in&lt;br/&gt;
HTTP request: {exit,normal}&lt;br/&gt;
&lt;br/&gt;
[Fri, 27 Feb 2009 14:02:48 GMT] [debug] [&amp;lt;0.5901.3&amp;gt;] Stacktrace:&lt;br/&gt;
[{mochiweb_request,send,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,send_chunk,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,db_doc_req,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]&lt;br/&gt;
&lt;br/&gt;
[Fri, 27 Feb 2009 14:02:48 GMT] [debug] [&amp;lt;0.5901.3&amp;gt;] HTTPd 500 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;normal&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
As the replication continues, the frequency of these error &amp;quot;Uncaught error in HTTP request: {exit,normal}&amp;quot;  increase.  Until the error is being constantly repeated.  Then Machine B stops sending requests, no more log output, no errors, the last thing in Machine B&apos;s log file is:&lt;br/&gt;
&lt;br/&gt;
[Fri, 27 Feb 2009 14:03:24 GMT] [info] [&amp;lt;0.20893.1&amp;gt;] retrying&lt;br/&gt;
couch_rep HTTP get request due to {error, req_timedout}: [104,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,112,58,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;47,47,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;57,50,46,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;49,54,56,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;46,50,46,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,50,58,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,57,56,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;52,47,100,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,108,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;115,99,111,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;45,105,110,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;118,111,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;105,99,101,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;115,47,73,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;78,86,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,54,53,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,49,51,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;56,63,114,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,118,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;115,61,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,117,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,38,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,116,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;99,104,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,110,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,115,61,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,114,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;117,101,38,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;108,97,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,115,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,61,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,117,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,38,111,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;112,101,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;110,95,114,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,118,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;115,61,91,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;34,&lt;br/&gt;
&lt;br/&gt;
&amp;lt;&amp;lt;&amp;quot;3070455362&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;34,93]&lt;br/&gt;
&lt;br/&gt;
A request for status from the couchdb init.d script returns nothing and checking the processes returns:&lt;br/&gt;
&lt;br/&gt;
(demo-couchdb)&lt;a href=&apos;mailto:jlh@mars&apos;&gt;jlh@mars&lt;/a&gt;:~/projects/venvs/demo-couchdb/src$ ps ax|grep cou&lt;br/&gt;
29281 pts/2    S+     0:00 grep cou&lt;br/&gt;
(demo-couchdb)&lt;a href=&apos;mailto:jlh@mars&apos;&gt;jlh@mars&lt;/a&gt;:~/projects/venvs/demo-couchdb/src$ ps ax|grep beam&lt;br/&gt;
29305 pts/2    R+     0:00 grep beam&lt;br/&gt;
&lt;br/&gt;
In fact, couch has gone away completely on Machine B.  In fact, couch&apos;s death is so quick it can&apos;t even say why.&lt;br/&gt;
&lt;br/&gt;
Attempts to incrementally replicate after the first failure die at exactly the same place.&lt;br/&gt;
&lt;br/&gt;
I can replicate this same database on the same machine from one database to another without issue.  I can dump and reload the database with no problems.&lt;br/&gt;
</description>
                <environment>Apache CouchDB 0.9.0a748379</environment>
            <key id="12415845">COUCHDB-270</key>
        <summary>Replication w/ Large Attachments Fails</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="dundeemt">Jeff Hinrichs</reporter>
            
    <created>Sat, 28 Feb 2009 04:07:38 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 18:40:21 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12677694" author="dundeemt" created="Sat, 28 Feb 2009 17:03:34 +0000 (UTC)"  >The above failure was created using futon.  &lt;br/&gt;
&lt;br/&gt;
I am trying to build a script to replicate the failure on demand but I am seeing something different now, the error is kind of like couchdb-240 (see below for more error output)  I will attach my script to this issue.  Hopefully it will help.&lt;br/&gt;
&lt;br/&gt;
--error information---&lt;br/&gt;
&lt;br/&gt;
[Sat, 28 Feb 2009 16:56:35 GMT] [info] [&amp;lt;0.962.0&amp;gt;] 192.168.2.52 - - &apos;POST&apos; /couchdb-270-target/_bulk_docs 201&lt;br/&gt;
&lt;br/&gt;
[Sat, 28 Feb 2009 16:56:49 GMT] [debug] [&amp;lt;0.979.0&amp;gt;] &apos;POST&apos; /couchdb-270-target/_bulk_docs {1,1}&lt;br/&gt;
Headers: [{&apos;Host&apos;,&amp;quot;192.168.2.194:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Transfer-Encoding&apos;,&amp;quot;chunked&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Sat, 28 Feb 2009 16:57:18 GMT] [error] [&amp;lt;0.906.0&amp;gt;] ** Generic server &amp;lt;0.906.0&amp;gt; terminating &lt;br/&gt;
** Last message in was {update_docs,[[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[]],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]}&lt;br/&gt;
** When Server state == {db,&amp;lt;0.905.0&amp;gt;,&amp;lt;0.906.0&amp;gt;,nil,&amp;lt;&amp;lt;&amp;quot;1235840109444771&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.904.0&amp;gt;,&amp;lt;0.908.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,0,100,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{104867784,0},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{104876441,{100,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{104872023,100},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.907.0&amp;gt;,&amp;lt;0.904.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.904.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{104876441,{100,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.5983005&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.77407758&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.41936925&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.15562944&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.904.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{104872023,100},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.64364170&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.113053104&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.146363&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.904.0&amp;gt;,nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;100,&amp;lt;&amp;lt;&amp;quot;couchdb-270-target&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/usr/local/var/lib/couchdb/couchdb-270-target.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,null,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,&apos;-update_docs_int/3-fun-0-&apos;,[[],{[],[]}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,foldl,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,update_docs_int,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,handle_call,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Sat, 28 Feb 2009 16:57:19 GMT] [error] [&amp;lt;0.906.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.906.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.906.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,&apos;-update_docs_int/3-fun-0-&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[],{[],[]}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,foldl,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,update_docs_int,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,handle_call,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},{proc_lib,init_p,5}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen,init_it,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[gen_server,&amp;lt;0.905.0&amp;gt;,&amp;lt;0.905.0&amp;gt;,couch_db_updater,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.905.0&amp;gt;,&amp;lt;&amp;lt;&amp;quot;couchdb-270-target&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/usr/local/var/lib/couchdb/couchdb-270-target.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.904.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[create,{user_ctx,{user_ctx,null,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.905.0&amp;gt;,couch_server,couch_primary_services,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.905.0&amp;gt;,&amp;lt;0.907.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,6765},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,96260}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{neighbour,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.907.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen,init_it,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[gen_server,&amp;lt;0.906.0&amp;gt;,&amp;lt;0.906.0&amp;gt;,couch_stream,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{0,0},&amp;lt;0.904.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{current_function,{gen_server,loop,6}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.906.0&amp;gt;,&amp;lt;0.905.0&amp;gt;,couch_server,couch_primary_services,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.906.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,waiting},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,233},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,12},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,5849}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{neighbour,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.905.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen,init_it,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[gen_server,&amp;lt;0.44.0&amp;gt;,&amp;lt;0.44.0&amp;gt;,couch_db,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;couchdb-270-target&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/usr/local/var/lib/couchdb/couchdb-270-target.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.904.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[create,{user_ctx,{user_ctx,null,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{current_function,{gen_server,loop,6}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_server,couch_primary_services,couch_server_sup,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.44.0&amp;gt;,&amp;lt;0.906.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,waiting},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,987},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,12},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,320}]}]]}}&lt;br/&gt;
&lt;br/&gt;
[Sat, 28 Feb 2009 16:57:19 GMT] [error] [&amp;lt;0.979.0&amp;gt;] Uncaught error in HTTP request: {exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db_updater,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;-update_docs_int/3-fun-0-&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[],{[],[]}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,foldl,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,update_docs_int,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db_updater,handle_call,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.906.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{update_docs,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[],[],[],[],[],[],[],[]],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;infinity]}}}&lt;br/&gt;
&lt;br/&gt;
[Sat, 28 Feb 2009 16:57:19 GMT] [debug] [&amp;lt;0.979.0&amp;gt;] Stacktrace: [{gen_server,call,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,write_and_commit,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]&lt;br/&gt;
&lt;br/&gt;
[Sat, 28 Feb 2009 16:57:19 GMT] [debug] [&amp;lt;0.979.0&amp;gt;] HTTPd 500 error response:&lt;br/&gt;
&amp;nbsp;{&amp;quot;error&amp;quot;:&amp;quot;{function_clause,[{couch_db_updater,&apos;-update_docs_int/3-fun-0-&apos;,\n                                    [[],{[],[]}]},\n                  {lists,foldl,3},\n                  {couch_db_updater,update_docs_int,3},\n                  {couch_db_updater,handle_call,3},\n                  {gen_server,handle_msg,5},\n                  {proc_lib,init_p,5}]}&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{gen_server,call,\n            [&amp;lt;0.906.0&amp;gt;,\n             {update_docs,[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],\n                           [],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],\n                           [],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],\n                           [],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],\n                           [],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],\n                           [],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],\n                          []},\n             infinity]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12677770" author="dundeemt" created="Sun, 1 Mar 2009 04:16:04 +0000 (UTC)"  >The attached script can produce a number of errors in replication.  Hopefully a python based script is helpful for you.  The script requires couchdb-python 0.5 and nose (to run the tests)&lt;br/&gt;
&lt;br/&gt;
One thing I have discovered is that the replication issues are not limited to attachments but are related to overall document size.  I am creating these replication issues by only using docs of large size.&lt;br/&gt;
&lt;br/&gt;
You will need to modify the top of the script &lt;br/&gt;
srvAuri = &apos;&lt;a href=&quot;http://192.168.2.52:5984/&quot;&gt;http://192.168.2.52:5984/&lt;/a&gt;&apos;&lt;br/&gt;
srvBuri = &apos;&lt;a href=&quot;http://192.168.2.194:5984/&quot;&gt;http://192.168.2.194:5984/&lt;/a&gt;&apos;&lt;br/&gt;
&lt;br/&gt;
to make sense for your environment&lt;br/&gt;
&lt;br/&gt;
The bigger the document size the harder/faster couchdb dies.  1MB documents are enough to make it groan before going away, 10MB will occasionally garner a wimpering before death -- though not always, while 20MB documents are akin to a head shot.</comment>
                    <comment id="12678231" author="kocolosk" created="Tue, 3 Mar 2009 04:17:48 +0000 (UTC)"  >Hi Jeff, thanks for the test case -- it proved quite useful. I have a short-term fix and a longer-term solution. I&apos;ll attach the quick fix now (still waiting on SVN commit access). It merely sets the ibrowse timeout to infinity and does a better check of the memory utilization when deciding whether to flush the save_docs_buffer. &lt;br/&gt;
&lt;br/&gt;
The longer term solution will likely require scrapping the parallelized portion of the replicator. Processing 100 documents in parallel doesn&apos;t give us enough control over the memory utilization on the servers. I&apos;m confident I can rewrite the module so that it loads documents into memory &amp;quot;just-in-time&amp;quot; and maintains the same throughput with a much lower memory footprint. &lt;br/&gt;
&lt;br/&gt;
I ran your test suite between two m1.large instances on EC2 and got the following results: &lt;br/&gt;
&lt;br/&gt;
200x512k push OK &lt;br/&gt;
200x512k pull OK &lt;br/&gt;
200x1m push OK &lt;br/&gt;
200x1m pull OK &lt;br/&gt;
200x20m push OK &lt;br/&gt;
200x20m pull FAIL &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
The last one failed in &amp;quot;head shot&amp;quot; fashion -- I believe the target server Erlang VM ran out of memory. Fixing that one will require the long-term solution. Will keep you posted, &lt;br/&gt;
&lt;br/&gt;
Adam</comment>
                    <comment id="12678232" author="kocolosk" created="Tue, 3 Mar 2009 04:19:08 +0000 (UTC)"  >I should clarify that I obtained the results in my previous comment after applying this quick fix.</comment>
                    <comment id="12678323" author="dundeemt" created="Tue, 3 Mar 2009 14:22:29 +0000 (UTC)"  >Adam, I am reproducing the similar results in my environment (laptop).  Although, with less memory??, neither 20M is passing for me.&lt;br/&gt;
&lt;br/&gt;
200x20m push FAIL (connection refused)&lt;br/&gt;
200x20m pull FAIL &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Thank you for your work on this.&lt;br/&gt;
&lt;br/&gt;
Now that you are getting closer, should I update the tests to use proper attachments in addition to extremely large documents?  If so, I was thinking tests for documents with a 512K body size +:&lt;br/&gt;
&amp;nbsp;* one massive attachment (20MB)&lt;br/&gt;
&amp;nbsp;* three attachments (10M/6M/4M) 20M overall in attachments&lt;br/&gt;
&amp;nbsp;* a dozen attachments (5M/5M/10x1M) 20M overall in attachments&lt;br/&gt;
&lt;br/&gt;
If you would like different/additional tests/parameters let me know and I&apos;ll update the script to include them.&lt;br/&gt;
&lt;br/&gt;
Now that I am on my second cup of joe, I should probably do a test that focuses on a large number of revisions.  Currently the tests create databases that are relatively pristine with N revisions, where N is 0 or very small.  If you would like this in the tests what N or Ns should be used?&lt;br/&gt;
&lt;br/&gt;
Jeff</comment>
                    <comment id="12678336" author="kocolosk" created="Tue, 3 Mar 2009 14:58:44 +0000 (UTC)"  >Hi Jeff, tests for attachments would be nice.  In the trunk code they should perform essentially the same as the test with a document of a similar size, but eventually we&apos;ll be handling attachments differently (i.e. streaming them directly to disk, see &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-163&quot; title=&quot;replicate attachments without Base64 encoding&quot;&gt;COUCHDB-163&lt;/a&gt;).&lt;br/&gt;
&lt;br/&gt;
I&apos;ve done some testing with large numbers of revisions on my own -- I don&apos;t think we need to add any more tests to this ticket.  The replicator already knows to split up a request if the # of revs is so large that they can&apos;t all fit into an 8KB URL (MochiWeb limit).  I don&apos;t believe there are any other gotchas related to large numbers of revisions.  The replicator only grabs the latest one, after all.&lt;br/&gt;
&lt;br/&gt;
Cheers, Adam&lt;br/&gt;
</comment>
                    <comment id="12678730" author="dundeemt" created="Wed, 4 Mar 2009 13:34:21 +0000 (UTC)"  >test script has been enhanced by:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;adding additional tests for proper attachment(s) of varying size&lt;br/&gt;
&amp;nbsp;&amp;nbsp;error handling for couchdb-272 has been added to avoid errors irrelevant to couchdb-270 during the test setup phase</comment>
                    <comment id="12679904" author="kocolosk" created="Sat, 7 Mar 2009 19:05:26 +0000 (UTC)"  >Hi Jeff,  those longer-term fixes have landed on trunk.  I checked that all of the tests you posted passed on machines with 2GB or more of memory.  To reduce the memory consumption further we need to dig into the ibrowse HTTP client that Couch uses internally.&lt;br/&gt;
&lt;br/&gt;
Do you mind confirming that the tests pass in your environment?</comment>
                    <comment id="12682076" author="dundeemt" created="Sat, 14 Mar 2009 17:31:05 +0000 (UTC)"  >All of the large document tests are passing.  All of the proper attachment pull tests, 10,12,14,16,18 work just fine.  However the proper attachment push tests (13,15,17) still fail if the attachments are of any size. (#11 passes - 200x256K payload + 256K Attachment)  I start getting connection refused errors with those.  &lt;br/&gt;
&lt;br/&gt;
Sorry for the tardiness of my reply.  Was out of town in SF, I ran the tests as soon as I got back, it took a while to figure out what was going on since the pushes left couch in a bad state and then the rest of the tests would fail.</comment>
                    <comment id="12682077" author="dundeemt" created="Sat, 14 Mar 2009 17:32:30 +0000 (UTC)"  >forgot to mention on the last report:  Apache CouchDB 0.9.0a752084</comment>
                    <comment id="12688319" author="jchris" created="Mon, 23 Mar 2009 16:39:51 +0000 (UTC)"  >This concords with the current state of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-163&quot; title=&quot;replicate attachments without Base64 encoding&quot;&gt;COUCHDB-163&lt;/a&gt;: pull replication is binary streaming, push replication still uses base64. I believe that the groundwork has been laid for this, it&apos;s just a matter of closing the loop in the replicator.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10032">
            <name>Blocker</name>
                                        <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12408522">COUCHDB-163</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12401409" name="couchdb270_Test.py" size="11579" author="dundeemt" created="Wed, 4 Mar 2009 13:34:21 +0000 (UTC)" />
            <attachment id="12401191" name="couchdb270_Test.py" size="6619" author="dundeemt" created="Sun, 1 Mar 2009 04:16:04 +0000 (UTC)" />
            <attachment id="12401283" name="quick_fix.diff" size="1049" author="kocolosk" created="Tue, 3 Mar 2009 04:19:08 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Mar 2009 04:17:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-269] _list doesn&apos;t allow POST requests</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-269</link>

                    <description>Currently, a 405 response is returned if you issue a POST request to _list.  We should allow POST requests so we can do a multi-key fetch.</description>
                <environment></environment>
            <key id="12415657">COUCHDB-269</key>
        <summary>_list doesn&apos;t allow POST requests</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Thu, 26 Feb 2009 11:58:41 +0000 (UTC)</created>
    <updated>Fri, 6 Mar 2009 13:16:23 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12677172" author="jasondd" created="Thu, 26 Feb 2009 23:42:59 +0000 (UTC)"  >Patch and tests enabling multi-key fetch (via POST method) for _list.  I will post another, more refactored patch soon; just posting this now in case anyone else needs it.</comment>
                    <comment id="12677676" author="jasondd" created="Sat, 28 Feb 2009 11:35:27 +0000 (UTC)"  >Updated patch for latest trunk (r748754) after jchris&apos;s ETag update.</comment>
                    <comment id="12677695" author="jasondd" created="Sat, 28 Feb 2009 17:26:08 +0000 (UTC)"  >Refactored start and row functions out to reduce code duplication.</comment>
                    <comment id="12678352" author="jasondd" created="Tue, 3 Mar 2009 15:51:21 +0000 (UTC)"  >Marked this as blocker for 0.9.</comment>
                    <comment id="12679323" author="jchris" created="Thu, 5 Mar 2009 19:49:15 +0000 (UTC)"  >applied in r750565&lt;br/&gt;
&lt;br/&gt;
thanks!</comment>
                    <comment id="12679531" author="jasondd" created="Fri, 6 Mar 2009 08:30:25 +0000 (UTC)"  >Minor patch to add validation for multi-key reduce _list views i.e. they should return a 500 error when group=false.</comment>
                </comments>
    
    <attachments>
            <attachment id="12401165" name="list_multikey.2.diff" size="12679" author="jasondd" created="Sat, 28 Feb 2009 11:35:27 +0000 (UTC)" />
            <attachment id="12401166" name="list_multikey.3.diff" size="17011" author="jasondd" created="Sat, 28 Feb 2009 17:26:08 +0000 (UTC)" />
            <attachment id="12401071" name="list_multikey.diff" size="12363" author="jasondd" created="Thu, 26 Feb 2009 23:42:59 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 5 Mar 2009 19:49:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 5 Mar 2009 19:49:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-268] _design/ resource to make Futon view lists faster</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-268</link>

                    <description>I think we can do this in one http request per database. (A temp view could work but would require significant processing overhead...). The simplest thing is probably to implement a _design resource.&lt;br/&gt;
&lt;br/&gt;
this will make Futon database browsing much faster because it won&apos;t have to load (potentially large) design docs to see which views are available.</description>
                <environment></environment>
            <key id="12415619">COUCHDB-268</key>
        <summary>_design/ resource to make Futon view lists faster</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 25 Feb 2009 22:27:05 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:59:41 +0000 (UTC)</updated>

                
                        <fixVersion>0.12</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772656" author="kocolosk" created="Mon, 2 Nov 2009 20:39:56 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                    <comment id="12828290" author="janl" created="Mon, 1 Feb 2010 21:59:41 +0000 (UTC)"  >bump to 0.12</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:39:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-267] the some unicode document id can not be created: Exception... &quot;Component returned failure code: 0x805e000a [nsIXMLHttpRequest.open]&quot;  nsresult: &quot;0x805e000a (&lt;unknown&gt;)&quot; </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-267</link>

                    <description>first create a documnet of docid :  &amp;quot;&#25991;&amp;quot;(%E6%96%87&amp;quot;),&lt;br/&gt;
then create a documnet of docid : &amp;quot;&#25991;&#23398;&amp;quot;(&amp;quot;%E6%96%87%E5%AD%A6&amp;quot;)&lt;br/&gt;
&lt;br/&gt;
the exception occur: &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;Component returned failure code: 0x805e000a [nsIXMLHttpRequest.open]&amp;quot;  nsresult: &amp;quot;0x805e000a (&amp;lt;unknown&amp;gt;)&amp;quot; &lt;br/&gt;
&lt;br/&gt;
IE is work well.</description>
                <environment>Ubuntu 8.10 &lt;br/&gt;
CouchDB svn 747766&lt;br/&gt;
Firefox 3.06</environment>
            <key id="12415581">COUCHDB-267</key>
        <summary>the some unicode document id can not be created: Exception... &quot;Component returned failure code: 0x805e000a [nsIXMLHttpRequest.open]&quot;  nsresult: &quot;0x805e000a (&lt;unknown&gt;)&quot; </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="riceball">Riceball LEE</reporter>
            
    <created>Wed, 25 Feb 2009 13:04:28 +0000 (UTC)</created>
    <updated>Wed, 25 Feb 2009 13:42:50 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-266] PUTting json docs &gt; 1MB causes Uncaught error in HTTP request: {exit,{body_too_large,content_length}} </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-266</link>

                    <description>error displays itself when trying to PUT  a json document that is &amp;gt; 1MB.  First noticed in the python interface, confirmed with curl&lt;br/&gt;
&lt;br/&gt;
[Tue, 24 Feb 2009 13:30:00 GMT] [error] [&amp;lt;0.1113.0&amp;gt;] Uncaught error in HTTP request: {exit,{body_too_large,content_length}}&lt;br/&gt;
2 	&lt;br/&gt;
3 	[Tue, 24 Feb 2009 13:30:00 GMT] [debug] [&amp;lt;0.1113.0&amp;gt;] Stacktrace: [{mochiweb_request,stream_body,5},&lt;br/&gt;
4 	{mochiweb_request,recv_body,2},&lt;br/&gt;
5 	{couch_httpd,json_body,1},&lt;br/&gt;
6 	{couch_httpd_db,db_doc_req,3},&lt;br/&gt;
7 	{couch_httpd_db,do_db_req,2},&lt;br/&gt;
8 	{couch_httpd,handle_request,3},&lt;br/&gt;
9 	{mochiweb_http,headers,4},&lt;br/&gt;
10 	{proc_lib,init_p,5}] &lt;br/&gt;
&lt;br/&gt;
modifying src/mochiweb/mochiweb_request.erl &amp;gt; -define(MAX_RECV_BODY, (1024*1024)) &lt;br/&gt;
to something bigger, say -define(MAX_RECV_BODY, (1024*1024*16))&lt;br/&gt;
alleviates the problem temporarily.&lt;br/&gt;
&lt;br/&gt;
issue confirmed by cmlenz on irc, he believed it to be a regression&lt;br/&gt;
</description>
                <environment>&amp;nbsp;Apache CouchDB 0.9.0a747258</environment>
            <key id="12415476">COUCHDB-266</key>
        <summary>PUTting json docs &gt; 1MB causes Uncaught error in HTTP request: {exit,{body_too_large,content_length}} </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="dundeemt">Jeff Hinrichs</reporter>
            
    <created>Tue, 24 Feb 2009 13:51:13 +0000 (UTC)</created>
    <updated>Tue, 24 Feb 2009 18:07:13 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12676278" author="cmlenz" created="Tue, 24 Feb 2009 13:56:15 +0000 (UTC)"  >First, here&apos;s a simple way to reproduce this problem:&lt;br/&gt;
&lt;br/&gt;
$ ls -lh big.json&lt;br/&gt;
-rw-r--r--  1 chris  staff   1,1M 24 Feb 14:36 big.json&lt;br/&gt;
&lt;br/&gt;
$ curl -T big.json &lt;a href=&quot;http://localhost:5984/testing/big&quot;&gt;http://localhost:5984/testing/big&lt;/a&gt;&lt;br/&gt;
curl: (55) Send failure: Broken pipe&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;body_too_large&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;content_length&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
The problem is caused by a mistake in the mochiweb_request:stream_body/4 that jchris submitted to MochiWeb. I&apos;ve confirmed that the bug is also in the Mochiweb repository, and will create an issue for that project.&lt;br/&gt;
&lt;br/&gt;
The patch is simple enough:&lt;br/&gt;
&lt;br/&gt;
Index: src/mochiweb/mochiweb_request.erl &lt;br/&gt;
=================================================================== &lt;br/&gt;
--- src/mochiweb/mochiweb_request.erl   (revision 747380) &lt;br/&gt;
+++ src/mochiweb/mochiweb_request.erl   (working copy) &lt;br/&gt;
@@ -182,7 +182,7 @@ &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;true -&amp;gt;  &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{NewLength, [Bin | BinAcc]} &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end &lt;br/&gt;
-        end, {0, []}, ?MAX_RECV_BODY), &lt;br/&gt;
+        end, {0, []}, MaxBody), &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;put(?SAVE_BODY, Body), &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Body. &lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12676280" author="cmlenz" created="Tue, 24 Feb 2009 13:58:58 +0000 (UTC)"  >Patch applied in r747381.</comment>
                    <comment id="12676285" author="cmlenz" created="Tue, 24 Feb 2009 14:06:38 +0000 (UTC)"  >For the record, here&apos;s the MochiWeb issue: &lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=30&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=30&lt;/a&gt;</comment>
                    <comment id="12676348" author="jchris" created="Tue, 24 Feb 2009 18:07:13 +0000 (UTC)"  >Thanks cmlenz!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Feb 2009 13:58:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Feb 2009 13:56:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-265] HEAD requests get a Content-Length header</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-265</link>

                    <description>Looks like HEAD requests are returning a bogus Content-Length header. If I remember my HTTP spec correctly, HEAD requests are supposed to return no Content-Length or a Content-Length of 0 but I could be wrong on that. Either way, it confuses the crap out of curl:&lt;br/&gt;
&lt;br/&gt;
$ curl -X HEAD -i &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
Server: CouchDB/0.9.0a (Erlang OTP/R12B)&lt;br/&gt;
Date: Mon, 23 Feb 2009 20:56:55 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Content-Length: 40&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
curl: (18) transfer closed with 40 bytes remaining to read&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Also, I just happened to be reading couch_http.erl the other day and I remember seeing a note that said mochiweb automatically strips bodies so internally HEAD requests are treated like a GET and mochiweb I guess just doesn&apos;t send a body. That&apos;s probably important.&lt;br/&gt;
</description>
                <environment>curl + trunk</environment>
            <key id="12415408">COUCHDB-265</key>
        <summary>HEAD requests get a Content-Length header</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Mon, 23 Feb 2009 21:18:02 +0000 (UTC)</created>
    <updated>Tue, 24 Feb 2009 12:16:28 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12676072" author="snej" created="Mon, 23 Feb 2009 21:25:50 +0000 (UTC)"  >No, HEAD is supposed to return _exactly the same headers_ as GET, just without the body.&lt;br/&gt;
It can be used by clients to determine the size of a resource before downloading it, so the Content-Length is definitely useful.</comment>
                    <comment id="12676073" author="paul.joseph.davis" created="Mon, 23 Feb 2009 21:27:58 +0000 (UTC)"  >Yeah. Noah just corrected me and I went back and reread the spec again which definitely says that changes in content-length should be detectable. Guess this is just curl being dumb. Apologies for the noise.</comment>
                    <comment id="12676074" author="paul.joseph.davis" created="Mon, 23 Feb 2009 21:28:23 +0000 (UTC)"  >Should&apos;ve read the spec before filing :D</comment>
                    <comment id="12676075" author="snej" created="Mon, 23 Feb 2009 21:29:19 +0000 (UTC)"  >By the way, curl has exactly the same problem with HEAD requests to other servers, so I&apos;d say this is a bug in curl itself. (For example, try &amp;quot;curl -X HEAD &lt;a href=&quot;http://www.google.com&quot;&gt;http://www.google.com&lt;/a&gt;&amp;quot;.)</comment>
                    <comment id="12676254" author="cmlenz" created="Tue, 24 Feb 2009 12:16:28 +0000 (UTC)"  >For the record, the proper way to issue HEAD requests with curl is &amp;quot;curl -I &lt;a href=&quot;http://localhost:5984/&quot;&gt;http://localhost:5984/&lt;/a&gt;&amp;quot; (that&apos;s the uppercase i option).</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Feb 2009 21:28:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Feb 2009 21:25:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-264] Evaluate if we&apos;d like to track heart-restarts and stop completely after X restarts in Y time.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-264</link>

                    <description>See &lt;a href=&quot;http://steve.vinoski.net/blog/2009/02/22/controlling-erlangs-heart/&quot;&gt;http://steve.vinoski.net/blog/2009/02/22/controlling-erlangs-heart/&lt;/a&gt; for a discussion. We could decide if we want to add the same to CouchDB.</description>
                <environment></environment>
            <key id="12415347">COUCHDB-264</key>
        <summary>Evaluate if we&apos;d like to track heart-restarts and stop completely after X restarts in Y time.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Mon, 23 Feb 2009 09:37:01 +0000 (UTC)</created>
    <updated>Mon, 23 Feb 2009 09:37:01 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-263] require valid user for all database operations</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-263</link>

                    <description>Admin accounts currently restrict a few operations, but leave all other operations completely open.  Many use cases will require all operations to be authenticated.   This can certainly be done by overriding the default_authentication_handler, but I think this very common use case can be handled in default_authentication_handler without increasing the complexity much.&lt;br/&gt;
&lt;br/&gt;
Attached is a patch which adds a new config option, &amp;quot;require_valid_user&amp;quot;, which restricts all operations to authenticated users only.  Since CouchDB currently only has admins, this means that all operations are restricted to admins.  In a future CouchDB where there are also normal users, the intention is that this would let them pass through as well.</description>
                <environment>All platforms.</environment>
            <key id="12415261">COUCHDB-263</key>
        <summary>require valid user for all database operations</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="metajack">Jack Moffitt</reporter>
            
    <created>Fri, 20 Feb 2009 22:50:02 +0000 (UTC)</created>
    <updated>Wed, 12 Aug 2009 00:37:15 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12675500" author="metajack" created="Fri, 20 Feb 2009 22:51:03 +0000 (UTC)"  >Patch to add require_valid_user to httpd config section.</comment>
                    <comment id="12721425" author="damienkatz" created="Thu, 18 Jun 2009 19:25:57 +0000 (UTC)"  >This patch looks okay, but we actually need something like this at the database level, the ability to say who can and can&apos;t access a database, and the ability to disallow anonymous access.</comment>
                    <comment id="12721435" author="damienkatz" created="Thu, 18 Jun 2009 19:52:33 +0000 (UTC)"  >hmmm, on second thought, we do need this both as a server wide setting and at the database level.&lt;br/&gt;
&lt;br/&gt;
However, this check and throwing exceptions for authenticated users should not be done in the authentication function, but by the caller of the auth function, so the setting works with all auth handlers.&lt;br/&gt;
&lt;br/&gt;
Also, it would be nice to have a more complete solution with more settings: allowed users, disallowed users and allow anonymous</comment>
                    <comment id="12736678" author="carnold@apache.org" created="Wed, 29 Jul 2009 15:55:40 +0000 (UTC)"  >References on &lt;a href=&quot;http://wiki.apache.org/couchdb/Authentication_and_Authorization&quot;&gt;http://wiki.apache.org/couchdb/Authentication_and_Authorization&lt;/a&gt;.   Similar to VALID-USER authorization use case.</comment>
                    <comment id="12737097" author="jasondd" created="Thu, 30 Jul 2009 13:21:05 +0000 (UTC)"  >I&apos;ve absorbed this patch into my oauth branch at &lt;a href=&quot;http://github.com/jasondavies/couchdb/tree/oauth&quot;&gt;http://github.com/jasondavies/couchdb/tree/oauth&lt;/a&gt; .&lt;br/&gt;
&lt;br/&gt;
I&apos;ve modified it as follows:&lt;br/&gt;
&lt;br/&gt;
1. The setting has been moved to [couch_httpd_auth] require_valid_user = true&lt;br/&gt;
2. The setting affects all authentication handlers instance-wide.  If none of them set user_ctx, then a 401 error is returned when require_valid_user = true.</comment>
                    <comment id="12742142" author="janl" created="Wed, 12 Aug 2009 00:37:15 +0000 (UTC)"  >Fixed in r800938 as part of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-420&quot; title=&quot;OAuth authentication support (2-legged initially) and cookie-based authentication&quot;&gt;&lt;strike&gt;COUCHDB-420&lt;/strike&gt;&lt;/a&gt;.</comment>
                </comments>
    
    <attachments>
            <attachment id="12400633" name="couchauth.diff" size="1438" author="metajack" created="Fri, 20 Feb 2009 22:51:03 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 12 Aug 2009 00:37:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 18 Jun 2009 19:25:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-262] &quot;The document could not be retrieved&quot; for _design docs in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-262</link>

                    <description>Futon displays &amp;quot;The document could not be retrieved&amp;quot; when viewing design documents as a result of the &amp;quot;/&amp;quot; in the design doc&apos;s id being URL encoded in jquery_couch openDoc()  function</description>
                <environment>Firefox 3</environment>
            <key id="12415217">COUCHDB-262</key>
        <summary>&quot;The document could not be retrieved&quot; for _design docs in Futon</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="chrisfarms">Chris Farmiloe</reporter>
            
    <created>Fri, 20 Feb 2009 10:59:26 +0000 (UTC)</created>
    <updated>Fri, 20 Feb 2009 10:59:26 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-261] curl build on Mac OSX</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-261</link>

                    <description>Curl seems not to like building on at least one Mac OSX box.&lt;br/&gt;
&lt;br/&gt;
Logs to follow.</description>
                <environment>Mac OSX, svn trunk, mac ports for dependencies.</environment>
            <key id="12415103">COUCHDB-261</key>
        <summary>curl build on Mac OSX</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 18 Feb 2009 22:29:02 +0000 (UTC)</created>
    <updated>Wed, 18 Feb 2009 22:37:43 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12674815" author="jchris" created="Wed, 18 Feb 2009 22:37:43 +0000 (UTC)"  >This looks like a transient issue related to an initial build which failed due to a mismatched curl version, leaving artifacts on the source tree. The fix was to rm -rf * &amp;amp;&amp;amp; svn up and rerun ./bootstrap &amp;amp;&amp;amp; ./configure&lt;br/&gt;
&lt;br/&gt;
Still, if anyone else runs across this, please reopen.&lt;br/&gt;
&lt;br/&gt;
[2:29pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
bleything: &lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-261&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-261&lt;/a&gt;&lt;br/&gt;
[2:29pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
you might have to log in to paste, if that&apos;s a pain I can paste it&lt;br/&gt;
[2:30pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
jchris: okay cool, paste forthcoming.  glibtoolize is vomiting a bunch of warnings, maybe I should resolve those first?&lt;br/&gt;
[2:30pm]&lt;br/&gt;
benbangert joined the chat room.&lt;br/&gt;
[2:31pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
jchris: uh... weird.  it built that time.&lt;br/&gt;
[2:31pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
bleything: the magic of ./bootstrap&lt;br/&gt;
[2:31pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
we should better document that&lt;br/&gt;
[2:31pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
thanks!&lt;br/&gt;
[2:31pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
jchris: I&apos;d been doing ./bootstrap &amp;amp;&amp;amp; ./configure this whole time :P&lt;br/&gt;
[2:32pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
yay&lt;br/&gt;
[2:32pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
what I changed this time was rm -rf * &amp;amp;&amp;amp; svn up first&lt;br/&gt;
[2:32pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
maybe artifacts...&lt;br/&gt;
[2:32pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
so I think maybe an earlier failed compile had left some artifa... yeah.&lt;br/&gt;
[2:32pm]&lt;br/&gt;
rnewson joined the chat room.&lt;br/&gt;
[2:32pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
sigh.  sorry for the false alarm?  don&apos;t know what the hell was going on.&lt;br/&gt;
[2:32pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
make clean&lt;br/&gt;
[2:32pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
make clean dev&lt;br/&gt;
[2:32pm] &amp;lt;davisp&amp;gt;&lt;br/&gt;
ameoba_: it wouldn&apos;t be *that* difficult to add, but the current major bottleneck is the Erlang - JSON conversions. There&apos;s some work being done on adding an Erlang bif to speed that up&lt;br/&gt;
[2:32pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
oops, wrong window :P&lt;br/&gt;
[2:33pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
nope. looks easy now, but in hindsight it looked real gnarly&lt;br/&gt;
[2:33pm]&lt;br/&gt;
priidu_ left the chat room. (Read error: 113 (No route to host))&lt;br/&gt;
[2:33pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
I&apos;ll close it with some transcript ;)&lt;br/&gt;
[2:33pm] &amp;lt;bleything&amp;gt;&lt;br/&gt;
heh. thanks :)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 18 Feb 2009 22:37:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-260] Support for reduce views in _list</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-260</link>

                    <description>The awesomeness of _list needs the awesomeness of reduce views.  Patch to follow.</description>
                <environment></environment>
            <key id="12415062">COUCHDB-260</key>
        <summary>Support for reduce views in _list</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Wed, 18 Feb 2009 15:33:04 +0000 (UTC)</created>
    <updated>Wed, 25 Feb 2009 06:34:34 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12674658" author="jasondd" created="Wed, 18 Feb 2009 15:36:51 +0000 (UTC)"  >Initial patch for reduce views support for _list.&lt;br/&gt;
&lt;br/&gt;
Note: the map and reduce stuff does need refactoring as I noticed there&apos;s a fair bit of duplication going on.  Might submit another patch for the refactoring at some point if I get time, but this does the job (TM) for now.</comment>
                    <comment id="12675511" author="jasondd" created="Fri, 20 Feb 2009 23:32:10 +0000 (UTC)"  >Updated patch with fix for handling {stop: true} (thanks, Paul Davis) and more tests.</comment>
                    <comment id="12675827" author="jasondd" created="Mon, 23 Feb 2009 09:06:06 +0000 (UTC)"  >Added fix and tests for bug when _list is empty (i.e. head, row and tail are &amp;quot;&amp;quot;).  Also started refactoring map and reduce code to remove code duplication.</comment>
                    <comment id="12676527" author="jchris" created="Wed, 25 Feb 2009 06:34:34 +0000 (UTC)"  >applied in r747679</comment>
                </comments>
    
    <attachments>
            <attachment id="12400639" name="list_reduce_views.2.diff" size="15662" author="jasondd" created="Fri, 20 Feb 2009 23:32:10 +0000 (UTC)" />
            <attachment id="12400741" name="list_reduce_views.3.diff" size="18425" author="jasondd" created="Mon, 23 Feb 2009 09:06:05 +0000 (UTC)" />
            <attachment id="12400421" name="list_reduce_views.diff" size="13672" author="jasondd" created="Wed, 18 Feb 2009 15:36:51 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 25 Feb 2009 06:34:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 25 Feb 2009 06:34:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-259] Ability to store abitrary data in attachment stubs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-259</link>

                    <description>I suggest the ability to store arbitrary data in line with single attachments to a doc. The mooted use is to store metadata about that attachment.&lt;br/&gt;
&lt;br/&gt;
For example, a current attachment:&lt;br/&gt;
&lt;br/&gt;
m[&apos;_attachments&apos;]&lt;br/&gt;
=&amp;gt; {&amp;quot;yamanote.jpg&amp;quot;=&amp;gt;{&amp;quot;content_type&amp;quot;=&amp;gt;&amp;quot;image/jpeg&amp;quot;, &amp;quot;stub&amp;quot;=&amp;gt;true, &amp;quot;length&amp;quot;=&amp;gt;382613}}&lt;br/&gt;
&lt;br/&gt;
Desired behaviour is to be able to insert persistent metadata like so:&lt;br/&gt;
&lt;br/&gt;
m[&apos;_attachments&apos;]&lt;br/&gt;
=&amp;gt; {&amp;quot;yamanote.jpg&amp;quot;=&amp;gt;{&amp;quot;content_type&amp;quot;=&amp;gt;&amp;quot;image/jpeg&amp;quot;, &amp;quot;stub&amp;quot;=&amp;gt;true, &amp;quot;length&amp;quot;=&amp;gt;382613, &amp;quot;width&amp;quot; =&amp;gt; 800, &amp;quot;height&amp;quot; =&amp;gt; 600, &amp;quot;md5&amp;quot; =&amp;gt; &amp;quot;95de7a118ee28824afa8d2ad8fe5819f&amp;quot;}}&lt;br/&gt;
&lt;br/&gt;
And many other use cases according to media type.</description>
                <environment></environment>
            <key id="12415051">COUCHDB-259</key>
        <summary>Ability to store abitrary data in attachment stubs</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="sho">Sho Fukamachi</reporter>
            
    <created>Wed, 18 Feb 2009 14:15:45 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12674636" author="rnewson" created="Wed, 18 Feb 2009 14:43:57 +0000 (UTC)"  >&lt;br/&gt;
+1, I&apos;d like somewhere to store md5 or sha1 values for the attachments too. I attempted a local hack, and while I can manage it on retrieval, my attempts to get it into the stored file failed.</comment>
                    <comment id="12674637" author="rnewson" created="Wed, 18 Feb 2009 14:45:42 +0000 (UTC)"  >also, this should be for 0.9.0? It&apos;s my understanding that this changes the on-disk format, making it a blocker for 0.9 (or rejected..)</comment>
                    <comment id="12674656" author="sho" created="Wed, 18 Feb 2009 15:33:25 +0000 (UTC)"  >Robert: If you&apos;re game, you could always make a view that includes a hash function in JS and then emit output from that ...&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://pajhome.org.uk/crypt/md5/md5src.html&quot;&gt;http://pajhome.org.uk/crypt/md5/md5src.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I didn&apos;t really know which version to set as the target. I am hoping a core dev will correct it to what it should be...</comment>
                    <comment id="12674660" author="rnewson" created="Wed, 18 Feb 2009 15:39:06 +0000 (UTC)"  >My intention for storing the md5 with the attachment is to detect corruption and to enable an enhancement to keep one copy of any attachment per database (so-called &apos;single-instance store&apos;). &lt;br/&gt;
&lt;br/&gt;
Doing something so cpu-intensive like md5 or sha1 in javascript never even occured to me...</comment>
                    <comment id="12674661" author="shelmberger" created="Wed, 18 Feb 2009 15:43:23 +0000 (UTC)"  >This issue is linked to 217 because if you don&apos;t know which attachment changed you&apos;d have to recalculate the md5sum of every attachment just to be sure it hasn&apos;t changed. </comment>
                    <comment id="12674729" author="sho" created="Wed, 18 Feb 2009 18:36:02 +0000 (UTC)"  >Robert: For small things it&apos;s probably OK. JS isn&apos;t *that* slow. Wouldn&apos;t want to run a 600M video through it, though. I do think it&apos;s a valid approach though - the idea of &amp;quot;generative views&amp;quot; is fascinating. For large files I&apos;d want to consider writing the view in ruby, though, which has a C md5/sha1 module.&lt;br/&gt;
&lt;br/&gt;
Sven: It&apos;s relevant to that ticket but I think you&apos;re touching on a much bigger subject there, that of revisions for individual attachments, which is an issue in its own right and beyond the scope of this one.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12674737" author="rnewson" created="Wed, 18 Feb 2009 18:45:20 +0000 (UTC)"  >&lt;br/&gt;
Perhaps the couchdb file format already includes checksums for detecting corruption within attachments (but, if it does, I haven&apos;t found it). My intention was to put an md5 on every attachment, which could include 600M videos, etc. Specifically, calling crypto:md5() seems preferable, assuming it&apos;s native. &lt;br/&gt;
&lt;br/&gt;
The Ruby idea is interesting but, again, I wanted the digest calculated on the data being added and stored with the attachment to detect corruption, generating it in a view is only equivalent if you never regenerate it, which is fragile.&lt;br/&gt;
</comment>
                    <comment id="12772659" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310020">
            <name>Dependants</name>
                            <outwardlinks description="depends on">
                            <issuelink>
            <issuekey id="12412894">COUCHDB-217</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 18 Feb 2009 14:43:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-258] Nicer error messages for view parameters that are not valid JSON</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-258</link>

                    <description>If a view that defines a string key gets queried with startkey=foo, CouchDB returns a (cryptic) error message. A message saying that the value is no valid JSON and should be startkey=&amp;quot;foo&amp;quot; instead would help.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12414974">COUCHDB-258</key>
        <summary>Nicer error messages for view parameters that are not valid JSON</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 17 Feb 2009 18:44:10 +0000 (UTC)</created>
    <updated>Wed, 18 Feb 2009 07:49:16 +0000 (UTC)</updated>

                        <version>0.8.1</version>
                    <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12674505" author="jchris" created="Wed, 18 Feb 2009 07:49:16 +0000 (UTC)"  >fixed in r745401.&lt;br/&gt;
&lt;br/&gt;
Our version of mochijson2 is already somewhat diverged from the original. This change is worth sending upstream, I&apos;m not sure about the others.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 18 Feb 2009 07:49:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 18 Feb 2009 07:49:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-257] HTTP caching headers don&apos;t provide expected behaviour</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-257</link>

                    <description>The HTTP caching headers currently put out cause IE (for example) to not display information correctly in Futon. It&apos;s easy to reproduce: I open windows in Firefox and IE simultaneously, do an update using Firefox (e.g. add a new document) and refresh the IE window. The updated document count is not shown. If I clear the browser cache and try again, the updated information is displayed.  The HTTP header put out is&lt;br/&gt;
&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
which seems to me insufficient - for IE, at least. Is there way of configuring these headers, to for example &lt;br/&gt;
&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: some date in the past, or the same value as the Date: header&lt;br/&gt;
&lt;br/&gt;
Christopher Lenz has said about this that &amp;quot;This is due to extra-aggressive (and against the HTTP spec) caching   that IE does on XMLHTTPRequests. A patch would need to do user agent sniffing to conditionally add the  &amp;quot;cache: false&amp;quot;  parameter to the jQuery ajax() invocations in   jquery.couch.js (and maybe elsewhere). I wouldn&apos;t want to add this for all user agents, as it basically circumvents any caching for AJAX  requests (even for not-craptastically-broken implementations), and  thus would add quite a bit of unnecessary overhead.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
To this, I would comment that I don&apos;t believe a patch to the client-side code in Futon would be sufficient. There are other clients out there, some of which will be on Windows and so by default use the (acknowledgely broken) Microsoft stack. In my view it is more important to err on the side of correctness than performance - so I believe the headers generated server-side need to change, as well as perhaps Futon client-side changes.&lt;br/&gt;
&lt;br/&gt;
I note that handle_uuids_req in couch_httpd_misc_handlers.erl uses the no-cache/Expires scheme I mention.</description>
                <environment>Server: Ubuntu Hardy on x86. Client: Windows XP (32-bit).</environment>
            <key id="12414871">COUCHDB-257</key>
        <summary>HTTP caching headers don&apos;t provide expected behaviour</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="vsajip">Vinay Sajip</reporter>
            
    <created>Mon, 16 Feb 2009 13:58:21 +0000 (UTC)</created>
    <updated>Wed, 16 Sep 2009 07:19:41 +0000 (UTC)</updated>

                        <version>0.8.1</version>
                    <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12673883" author="vsajip" created="Mon, 16 Feb 2009 14:06:06 +0000 (UTC)"  >Patch to change HTTP caching headers to&lt;br/&gt;
&lt;br/&gt;
Cache-control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Fri, 01 Jan 1990 00:00:00 GMT&lt;br/&gt;
</comment>
                    <comment id="12674003" author="cmlenz" created="Mon, 16 Feb 2009 17:06:15 +0000 (UTC)"  >Disabling all client (and proxy) caching sounds like a really bad idea to me. This isn&apos;t just about using Futon via IE6, it&apos;s about the primary (and basically only) method for talking to CouchDB. We don&apos;t want to punish all clients (and thus all CouchDB applications) just because IE is broken. And we&apos;re putting in extra work in other places to have e.g. useful Etag support, which would be a complete waste if we made the change you&apos;re proposing.&lt;br/&gt;
&lt;br/&gt;
Also, this particular bug with IE over-aggressively caching responses applies only to AJAX requests AFAIK. If you request any of the CouchDB requests directly through the Win HTTP stack, you should see the &amp;quot;Cache-Control: must-revalidate&amp;quot; and &amp;quot;Etag&amp;quot; headers getting properly respected.&lt;br/&gt;
&lt;br/&gt;
I stick to my opinion that this should be handled on the client side, with some browser-sniffing thrown in for good measure.</comment>
                    <comment id="12674174" author="vsajip" created="Tue, 17 Feb 2009 11:08:32 +0000 (UTC)"  >The patch is just meant as a temporary fix, I&apos;m not suggesting it&apos;s the best solution. I agree with your comments about not penalising all clients because of IE&apos;s behaviour: however, I first experienced this issue with a Flash client and not from a browser XHR request. Whatever IE is doing, it&apos;s also affecting requests from the Flash plugin. Anyway, the patch got me around the current problem for now, pending a better fix.</comment>
                    <comment id="12674650" author="vsajip" created="Wed, 18 Feb 2009 15:17:14 +0000 (UTC)"  >I&apos;ve had a look at RFC2616 (the HTTP 1.1 spec) with regard to &amp;quot;must-revalidate&amp;quot;. It says:&lt;br/&gt;
&lt;br/&gt;
When the must-revalidate directive is present in a response received by a cache, that cache MUST NOT use the entry after it becomes stale to respond to a subsequent request without first revalidating it with the origin server.&lt;br/&gt;
&lt;br/&gt;
However, currently no staleness information is being sent by the server. I notice that if we add a &amp;quot;max-age=0&amp;quot; clause to &amp;quot;must-revalidate&amp;quot;, then the behaviour is as expected.&lt;br/&gt;
&lt;br/&gt;
For the resource /_utils/, the information already sent out is stale whenever a new database is added or removed or a document is added or removed. Perhaps a suitable ETag should be computed and sent out which can be used to revalidate?</comment>
                    <comment id="12713756" author="carnold@apache.org" created="Wed, 27 May 2009 21:34:02 +0000 (UTC)"  >So what is the client-side workaround for IE&apos;s behavior?  I&apos;ve read the following on the general underlying issue:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/aa905731.aspx&quot;&gt;http://msdn.microsoft.com/en-us/library/aa905731.aspx&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&lt;a href=&quot;http://www.subbu.org/blog/2005/10/xmlhttprequest-and-caching&quot;&gt;http://www.subbu.org/blog/2005/10/xmlhttprequest-and-caching&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&lt;a href=&quot;http://davidmaddison.blogspot.com/2009/01/gwt-internet-explorer-and.html&quot;&gt;http://davidmaddison.blogspot.com/2009/01/gwt-internet-explorer-and.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The typical client-side fix is to add an extra parameter that the server does not recognize but the caching logic will think is significant and give it a random value.  I tried this with a fairly recent CouchDB by requesting a URI like:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://localhost:5984/default/_design/query/_view/someView?include_docs=true;key=someKey;random=0.9650435170417132&quot;&gt;http://localhost:5984/default/_design/query/_view/someView?include_docs=true;key=someKey;random=0.9650435170417132&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
and I got:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;query_parse_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Invalid URL parameter: \&amp;quot;random\&amp;quot;&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
If there isn&apos;t one already, could CouchDB accept and ignore at least a specific parameter on queries and requests?&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12722478" author="carnold@apache.org" created="Mon, 22 Jun 2009 04:08:50 +0000 (UTC)"  >This issue is somewhat related to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-383&quot; title=&quot;HTTP get parameter strictness/looseness&quot;&gt;&lt;strike&gt;COUCHDB-383&lt;/strike&gt;&lt;/a&gt;</comment>
                    <comment id="12722506" author="vsajip" created="Mon, 22 Jun 2009 08:13:51 +0000 (UTC)"  >I don&apos;t see that this is particularly related to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-383&quot; title=&quot;HTTP get parameter strictness/looseness&quot;&gt;&lt;strike&gt;COUCHDB-383&lt;/strike&gt;&lt;/a&gt; - this issue is about HTTP headers, that is about interpretation of HTTP query parameters.</comment>
                    <comment id="12722880" author="mhammond" created="Mon, 22 Jun 2009 22:56:10 +0000 (UTC)"  >My 2c - IE is wrong in not interpreting a lack of time-to-live info in the same way as explicitly specifying a max-age of 0 or expiry in the past.  I see no problem with explicitly adding max-age to the headers as it should offer identical semantics for non-broken browsers and would appear to also make IE work as expected.</comment>
                    <comment id="12737879" author="mhammond" created="Sat, 1 Aug 2009 12:53:29 +0000 (UTC)"  >My last comment probably wasn&apos;t very clear (seeing I had to read it a few times myself!)  Would adding a &apos;cache-control: max-age=0&apos; solve the problem with IE?  If so, I&apos;d suggest adding such a header to all responses would be reasonable.</comment>
                    <comment id="12748972" author="carnold@apache.org" created="Fri, 28 Aug 2009 20:42:21 +0000 (UTC)"  >Spent a few hours testing this today.&lt;br/&gt;
&lt;br/&gt;
max_age still has a problem with rapid requests   The test case below fails when CouchDB returns max-age=0, but works with a Expires date in the past.  Specifying Expires in the past does appear to be effective.  That approach is currently used in couch_httpd_misc_handlers.erl.&lt;br/&gt;
&lt;br/&gt;
Default headers are generated in two locations in couch_httpd.erl and once in couch_httpd_misc_handlers.erl.  Should try to combine those so the default headers are only specified in one location.&lt;br/&gt;
&lt;br/&gt;
Making CacheControl and Expires configurable would probably be the best solution with a default like:&lt;br/&gt;
&lt;br/&gt;
[httpd]&lt;br/&gt;
CacheControl = must-revalidate&lt;br/&gt;
Expires = 0&lt;br/&gt;
&lt;br/&gt;
The following test will fail on IE 6 when Tools/Options/General/Temporary Internet Files/Check for newer is set to automatic.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
couchTests.basics = function(debug) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var result = JSON.parse(CouchDB.request(&amp;quot;GET&amp;quot;, &amp;quot;/&amp;quot;).responseText);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(result.couchdb == &amp;quot;Welcome&amp;quot;);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var db = new CouchDB(&amp;quot;test_suite_db&amp;quot;, {&amp;quot;X-Couch-Full-Commit&amp;quot;:&amp;quot;false&amp;quot;});&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.deleteDb();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.createDb();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// create a document and save it to the database&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var doc = {_id:&amp;quot;0&amp;quot;,a:1,b:1};&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var result = db.save(doc);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(result.ok==true); // return object has an ok member with a value true&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var id = result.id;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// reopen document we saved earlier&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var existingDoc = db.open(id);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(existingDoc.a==1);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;//modify and save&lt;br/&gt;
&amp;nbsp;&amp;nbsp;existingDoc.a=4;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.save(existingDoc);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var modifiedDoc = db.open(id);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(modifiedDoc.a == 4);&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
};&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I&apos;ll work up a patch tonight.</comment>
                    <comment id="12750507" author="carnold@apache.org" created="Wed, 2 Sep 2009 16:11:58 +0000 (UTC)"  >This patch adds &lt;br/&gt;
&lt;br/&gt;
Expires: Mon, Jan 01, 1990 00:00:00 GMT&lt;br/&gt;
&lt;br/&gt;
to all headers.  This results in the response being considered instantly stale and a cached version will only be used after re-validating with the server.&lt;br/&gt;
&lt;br/&gt;
I would have preferred sending &amp;quot;Expires: 0&amp;quot; which the HTTP RFC goes out of its way to indicate should be interpreted as immediately expired, but www/script/test/uuids.js expects a valid date and just outputting a valid early date was a smaller change.&lt;br/&gt;
&lt;br/&gt;
couch_httpd_misc_handlers.erl identified 1990-01-01 as a Friday, but every calendar that I&apos;ve seen indicates that it was a Monday.  If the header specification in couch_httpd_misc_handers.erl is not removed, then both dates appear separated by commas.&lt;br/&gt;
&lt;br/&gt;
FYI: The headers emitted by _uuids now have &lt;br/&gt;
&lt;br/&gt;
Cache-Control: must-revalidate,no-cache&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12750512" author="carnold@apache.org" created="Wed, 2 Sep 2009 16:21:52 +0000 (UTC)"  >The statement about the Cache-Control was independent of the proposed patch.  Just mentioning that the current code sends out inconsistent cache recommendations and will continue to send out inconsistent cache recommendations.&lt;br/&gt;
&lt;br/&gt;
Down in mochiweb, multiple values for the same header are merged together which is an appropriate and desirable behavior when the values are orthogonal.  However, doesn&apos;t work so well when multiple dates are merged or mutually exclusive header values are combined.&lt;br/&gt;
&lt;br/&gt;
Don&apos;t know if the current behavior causes any problems and guess that _uuids would still work if it had just must-revalidate, but haven&apos;t tested it.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12755761" author="janl" created="Tue, 15 Sep 2009 22:42:43 +0000 (UTC)"  >From dev@:&lt;br/&gt;
&lt;br/&gt;
Christopher Lenz:&lt;br/&gt;
This is a somewhat misleading description; it&apos;s not the lack of an Expires header on CouchDB responses that results in incorrect caching, it&apos;s a (really ugly) bug in the XMLHttpRequest implementation of IE6 that does this. As far as I know, the cache control headers sent by CouchDB are absolutely correct according to the HTTP specification. Unconditionally adding an Expires header (with a date in the past) just to workaround the XHR bug in IE6 *completely disables* any caching by any user agent!&lt;br/&gt;
&lt;br/&gt;
Note also that IE6 gets cache invalidation right when you don&apos;t go through XMLHttpRequest (that is, request CouchDB documents/views directly).&lt;br/&gt;
&lt;br/&gt;
A CouchDB-based application that runs on the client (CouchApp-style), and that needs to work on IE6, has the option to force all XHR requests to invalidate the cache (for example by using jQuery&apos;s &amp;quot;cache=false&amp;quot; option to AJAX requests, which simply adds an extra timestamp-valued query string parameter). In addition, it can choose to do so if, and only if, it detects to be running on IE6. And of course, applications accessing CouchDB only through server-side code do not need to care about this issue at all.&lt;br/&gt;
&lt;br/&gt;
Presumably we *could* add the browser detection and the conditional addition of an Expires header to the CouchDB HTTP server, but browser detection is a really slippery slope that I think we should avoid, and IE6 is likely (or so I hope) to be pretty much extinct by the time CouchDB reaches the 1.0 mark. In any case, I&apos;m -1 on any patch that does this unconditionally, and -0.5 on any patch that does the Expires header dance conditionally. I&apos;d be okay with adding the cache busting trick to Futon (but again, only conditionally), and documenting the issue and workaround for CouchApps.&lt;br/&gt;
</comment>
                    <comment id="12755916" author="cmlenz" created="Wed, 16 Sep 2009 07:19:41 +0000 (UTC)"  >Oops, turns out I got this wrong. As Curt explains on the mailing list, adding an Expires header set to the past, in combination with the &amp;quot;Cache-Control: must-revalidate&amp;quot; header we&apos;re already sending, just forces the user agent to not apply any heuristics to determine freshness and always revalidate with the server. This is the behavior we want.&lt;br/&gt;
&lt;br/&gt;
Furthermore, according to Curt, max-age=0 or Expires=Date is insufficient because at least with some user agents there&apos;s a one second window where you could still get the cached entity without revalidation.&lt;br/&gt;
&lt;br/&gt;
In light of this I retract my objection. Sorry for the noise!</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12427883">COUCHDB-383</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12400276" name="caching-header-patch.diff" size="1836" author="vsajip" created="Mon, 16 Feb 2009 14:06:06 +0000 (UTC)" />
            <attachment id="12418396" name="expires.patch" size="1503" author="carnold@apache.org" created="Wed, 2 Sep 2009 16:11:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Feb 2009 17:06:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-256] Replicating from a write-protected server fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-256</link>

                    <description>I attempted to follow the example in jchris&apos;s &amp;quot;My Couch Of Yours?&amp;quot; post (&lt;a href=&quot;http://jchris.mfdz.com/code/2008/11/my_couch_or_yours__shareable_ap),&quot;&gt;http://jchris.mfdz.com/code/2008/11/my_couch_or_yours__shareable_ap),&lt;/a&gt; pulling a copy of his Twitter client CouchApp from his server. Unfortunately the replication fails. In his reply to my mailing list post, Jan said &amp;quot;At the moment, replication does not fully work with authentication-enabled replication sources. But this is being worked on [...] I don&apos;t think we have an open JIRA ticket for this.&amp;quot; So I&apos;m filing a ticket for it.&lt;br/&gt;
&lt;br/&gt;
The Replicator in the Futon interface doesn&apos;t show any errors, it just never stops the spinny progress indicator. But this immediately gets dumped to the log file:&lt;br/&gt;
&lt;br/&gt;
[Sun, 15 Feb 2009 03:58:57 GMT] [error] [emulator] Error in process &amp;lt;0.214.0&amp;gt; with exit value: {{nocatch,{unauthorized,&amp;lt;&amp;lt;39 bytes&amp;gt;&amp;gt;}},[{couch_db,validate_doc_update,3},{couch_db,&apos;-update_docs/4-lc$^1/1-8-&apos;,2},{lists,zipwith,3},{couch_db,update_docs,4},{couch_rep,save_docs_buffer,3}]}&lt;br/&gt;
&lt;br/&gt;
[Sun, 15 Feb 2009 03:58:57 GMT] [error] [&amp;lt;0.49.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.49.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,235,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{nocatch,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{unauthorized,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;You are not a server or database admin.&amp;quot;&amp;gt;&amp;gt;}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db,validate_doc_update,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-update_docs/4-lc$^1/1-8-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,zipwith,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,update_docs,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,save_docs_buffer,3}]}}}}}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>SVN r743373 (2/11/09); Mac OS X 10.5.6; current DarwinPorts versions of dependencies.</environment>
            <key id="12414840">COUCHDB-256</key>
        <summary>Replicating from a write-protected server fails</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="snej">Jens Alfke</reporter>
            
    <created>Sun, 15 Feb 2009 22:10:50 +0000 (UTC)</created>
    <updated>Mon, 14 Sep 2009 10:33:13 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12753139" author="kocolosk" created="Wed, 9 Sep 2009 16:07:42 +0000 (UTC)"  >Hi Jens, would you care to try this again with a new checkout?  There shouldn&apos;t be any problem replicating from a protected source server.  You can also replicate to a write-protected server if you supply the proper credentials in the POST body.&lt;br/&gt;
&lt;br/&gt;
If you do encounter the problem, can you include the syntax you used to trigger the replication in a comment?  Thanks,&lt;br/&gt;
&lt;br/&gt;
Adam</comment>
                    <comment id="12754913" author="janl" created="Mon, 14 Sep 2009 10:33:13 +0000 (UTC)"  >no feedback in a while. Please re-open if this still occurs.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Sep 2009 10:33:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 9 Sep 2009 16:07:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-255] Update MochiWeb</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-255</link>

                    <description>&lt;a href=&quot;http://code.google.com/p/mochiweb/source/detail?r=89&quot;&gt;http://code.google.com/p/mochiweb/source/detail?r=89&lt;/a&gt;</description>
                <environment></environment>
            <key id="12414837">COUCHDB-255</key>
        <summary>Update MochiWeb</summary>

            <type id="3" iconUrl="http://issues.apache.org/jira/images/icons/task.gif">Task</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sun, 15 Feb 2009 19:19:26 +0000 (UTC)</created>
    <updated>Tue, 24 Feb 2009 22:15:52 +0000 (UTC)</updated>

                        <version>0.8</version>
                    <version>0.8.1</version>
                    <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12676350" author="jchris" created="Tue, 24 Feb 2009 18:09:42 +0000 (UTC)"  >One thing to take into account here is that our mochijson2 may not be the same as theirs. It&apos;s at least worth a look to make sure, before replacing ours.</comment>
                    <comment id="12676419" author="cmlenz" created="Tue, 24 Feb 2009 21:22:45 +0000 (UTC)"  >I&apos;ve updated the vendor branch in r747541.&lt;br/&gt;
&lt;br/&gt;
mochijson2 merges cleanly, no problem there.&lt;br/&gt;
&lt;br/&gt;
However, there&apos;s a newly introduced bug in MochiWeb that&apos;s breaking our redirects, and thus Futon:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=27#c2&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=27#c2&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;ll wait to see whether/how this is fixed upstream before I proceed with the updating.</comment>
                    <comment id="12676428" author="cmlenz" created="Tue, 24 Feb 2009 22:15:52 +0000 (UTC)"  >I&apos;ve upgraded the included MochiWeb to r97 in r747575.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Feb 2009 22:15:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Feb 2009 18:09:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-254] Non-Unicde characters in an attachment name render a document unreadable.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-254</link>

                    <description>Attatchment names containing nun unicode characters can be created easily because URI-s are (nearly) 8-bit clean. But when reading they are encoded into utf-8 which doesn&apos;t work out. So you are left with unreadable database entries.&lt;br/&gt;
&lt;br/&gt;
I was not able to generate invalid UTF-8 in JavaScript but a test case would look somewhat like this:&lt;br/&gt;
&lt;br/&gt;
--- couch_tests.js      2009-02-05 19:47:20.000000000 +0000&lt;br/&gt;
+++ /usr/local/share/couchdb/www/script/couch_tests.js  2009-02-13 21:34:23.000000000 +0000&lt;br/&gt;
@@ -1078,9 +1078,31 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var xhr = CouchDB.request(&amp;quot;GET&amp;quot;, &amp;quot;/test_suite_db/bin_doc4/attachment.txt&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(xhr.status == 200);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(xhr.responseText == &amp;quot;This is a string&amp;quot;);&lt;br/&gt;
-&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;},&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
+  attatchment_names : function(debug) {&lt;br/&gt;
+    var db = new CouchDB(&amp;quot;test_suite_db&amp;quot;);&lt;br/&gt;
+    db.deleteDb();&lt;br/&gt;
+    db.createDb();&lt;br/&gt;
+    if (debug) debugger;&lt;br/&gt;
+&lt;br/&gt;
+    var binAttDoc = {&lt;br/&gt;
+      _id: &amp;quot;bin_doc&amp;quot;,&lt;br/&gt;
+      _attachments:{&lt;br/&gt;
+        &amp;quot;foo\x80txt&amp;quot;: {&lt;br/&gt;
+          content_type:&amp;quot;text/plain&amp;quot;,&lt;br/&gt;
+          data: &amp;quot;VGhpcyBpcyBhIGJhc2U2NCBlbmNvZGVkIHRleHQ=&amp;quot;&lt;br/&gt;
+        }&lt;br/&gt;
+      }&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    var save_response = db.save(binAttDoc);&lt;br/&gt;
+    T(save_response.ok);&lt;br/&gt;
+&lt;br/&gt;
+    var xhr = CouchDB.request(&amp;quot;GET&amp;quot;, &amp;quot;/test_suite_db/bin_doc\x80foo.txt&amp;quot;);&lt;br/&gt;
+    T(xhr.responseText == &amp;quot;This is a base64 encoded text&amp;quot;);&lt;br/&gt;
+},&lt;br/&gt;
+&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;attachment_paths : function(debug) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (debug) debugger;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var dbNames = [&amp;quot;test_suite_db&amp;quot;, &amp;quot;test_suite_db/with_slashes&amp;quot;];&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
A python script (fuzzer?) for triggering the bug looks like this:&lt;br/&gt;
&lt;br/&gt;
import sys&lt;br/&gt;
import couchdb.client&lt;br/&gt;
&lt;br/&gt;
COUCHSERVER = &amp;quot;&lt;a href=&quot;http://localhost:5984&quot;&gt;http://localhost:5984&lt;/a&gt;&amp;quot;&lt;br/&gt;
COUCHDB_NAME = &amp;quot;md_test&amp;quot;&lt;br/&gt;
&lt;br/&gt;
def _setup_couchdb():&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;Get a connection handler to the CouchDB Database, creating it when needed.&amp;quot;&amp;quot;&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;server = couchdb.client.Server(COUCHSERVER)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;print &amp;quot;using %s/%s&amp;quot; % (COUCHSERVER, COUCHDB_NAME)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if COUCHDB_NAME in server:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return server[COUCHDB_NAME]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;else:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return server.create(COUCHDB_NAME)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
def main():&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db = _setup_couchdb()&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;doc_id = &amp;quot;doc_id&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;doc = db[doc_id]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;except couchdb.client.ResourceNotFound:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;doc = {}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db[doc_id] = doc&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for i in range(256):&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;char = chr(i)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;name = &amp;quot;___%s___&amp;quot; % (char)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;print &amp;quot;checking %r (%d) &amp;quot; % (char, i),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;sys.stdout.flush()&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db.put_attachment(db[doc_id], &amp;quot;data&amp;quot;, name)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db[doc_id]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;print &apos;\r&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;print &lt;br/&gt;
&lt;br/&gt;
main()&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Linux, erlang, 12b-5, couchdb r791265</environment>
            <key id="12414777">COUCHDB-254</key>
        <summary>Non-Unicde characters in an attachment name render a document unreadable.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Fri, 13 Feb 2009 21:44:34 +0000 (UTC)</created>
    <updated>Fri, 6 Mar 2009 00:12:57 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12673705" author="snej" created="Sun, 15 Feb 2009 19:37:48 +0000 (UTC)"  >A more accurate title would be &amp;quot;Invalid UTF-8 encoding in an attachment URI renders a document unreadable.&amp;quot; The issue, as I understand it, isn&apos;t with Unicode characters but with the UTF-8 byte sequences that encode them. There are many byte sequences that aren&apos;t syntactically-valid UTF-8 and can&apos;t be decoded into a Unicode string.&lt;br/&gt;
&lt;br/&gt;
Sounds like the issue here is that the server code handling the PUT request is extracting the attachment name from the URI as a byte string, without validating that it&apos;s valid UTF-8. The invalid name then goes into the database, but when it&apos;s written out into a JSON response, it poisons the response text and causes it to fail UTF-8 decoding.&lt;br/&gt;
&lt;br/&gt;
So, basically any place the HTTP server is receiving a request, it should validate the URI&apos;s UTF-8 encoding, and send back a 400 error if it fails. This is really easy to do, but unfortunately I know very little Erlang, and nothing about how it works with Unicode...</comment>
                    <comment id="12679173" author="janl" created="Thu, 5 Mar 2009 12:06:06 +0000 (UTC)"  >This patch sends  a 400 Bad Request response with the reason &amp;quot;Attachment name is not UTF-8 encoded&amp;quot; when trying to save a document with an attachment which has non-utf-8 characters in the name. With test cases for inline-attachments, standalone attachments, bulk docs.</comment>
                    <comment id="12679435" author="janl" created="Fri, 6 Mar 2009 00:12:57 +0000 (UTC)"  >Fixed as of r750695 with a slightly modified patch.</comment>
                </comments>
    
    <attachments>
            <attachment id="12401515" name="COUCHDB-254.txt" size="5124" author="janl" created="Thu, 5 Mar 2009 12:06:06 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 6 Mar 2009 00:12:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 15 Feb 2009 19:37:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-253] Replicator should not use chunked transfer-encoding on GET requests</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-253</link>

                    <description>Hi, I screwed this up when we switched to ibrowse.  We&apos;re telling ibrowse to use chunked t-e on every replicator HTTP request.  We don&apos;t send a body with the GET request, so ibrowse just puts a 0 in the body.  Mochiweb chooses to interpret this as &amp;quot;close the connection&amp;quot;.  That&apos;s obviously not what we want.  Quick patch below to skip chunked if the request is a GET:&lt;br/&gt;
&lt;br/&gt;
diff --git a/src/couchdb/couch_rep.erl b/src/couchdb/couch_rep.erl&lt;br/&gt;
index ff92658..fa3623d 100644&lt;br/&gt;
--- a/src/couchdb/couch_rep.erl&lt;br/&gt;
+++ b/src/couchdb/couch_rep.erl&lt;br/&gt;
@@ -179,11 +179,16 @@ do_http_request(Url, Action, Headers, JsonBody, Retries) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_ -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;iolist_to_binary(?JSON_ENCODE(JsonBody))&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end,&lt;br/&gt;
-    Options = [&lt;br/&gt;
+    &lt;br/&gt;
+    Options = &lt;br/&gt;
+    case Action of&lt;br/&gt;
+        get -&amp;gt; [];&lt;br/&gt;
+        _ -&amp;gt;   [{transfer_encoding, {chunked, 65535}}]&lt;br/&gt;
+    end ++ [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{content_type, &amp;quot;application/json; charset=utf-8&amp;quot;},&lt;br/&gt;
-        {max_pipeline_size, 101},&lt;br/&gt;
-        {transfer_encoding, {chunked, 65535}}&lt;br/&gt;
+        {max_pipeline_size, 101}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;],&lt;br/&gt;
+    &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case ibrowse:send_req(Url, Headers, Action, Body, Options) of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, Status, ResponseHeaders, ResponseBody} -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ResponseCode = list_to_integer(Status),&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12414753">COUCHDB-253</key>
        <summary>Replicator should not use chunked transfer-encoding on GET requests</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Fri, 13 Feb 2009 15:11:59 +0000 (UTC)</created>
    <updated>Fri, 13 Feb 2009 17:58:27 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="1800">0.5h</timeoriginalestimate>        <timeestimate seconds="1800">0.5h</timeestimate>                    

            <comments>
                    <comment id="12673326" author="jchris" created="Fri, 13 Feb 2009 17:58:27 +0000 (UTC)"  >applied in r744193</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 17:58:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 17:58:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-252] Allow _list functiosn to signal that iteration of the view should cease.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-252</link>

                    <description>Allows _list functions to return {stop: true} to signal that row iteration should cease.</description>
                <environment></environment>
            <key id="12414741">COUCHDB-252</key>
        <summary>Allow _list functiosn to signal that iteration of the view should cease.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Fri, 13 Feb 2009 12:48:19 +0000 (UTC)</created>
    <updated>Fri, 13 Feb 2009 20:57:03 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12673243" author="paul.joseph.davis" created="Fri, 13 Feb 2009 12:50:06 +0000 (UTC)"  >Patch for the improvment. This may cause a conflict with &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-251&quot; title=&quot;Allow _list functions to accept arbitrary GET parameters.&quot;&gt;&lt;strike&gt;COUCHDB-251&lt;/strike&gt;&lt;/a&gt;&apos;s patch when being applied because they both edit couch_tests.js in the same spot. Should be trivial beyond that.</comment>
                    <comment id="12673375" author="jchris" created="Fri, 13 Feb 2009 20:57:03 +0000 (UTC)"  >applied in r744240</comment>
                </comments>
    
    <attachments>
            <attachment id="12400183" name="COUCHDB-252.patch" size="4725" author="paul.joseph.davis" created="Fri, 13 Feb 2009 12:50:06 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 20:57:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 20:57:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-251] Allow _list functions to accept arbitrary GET parameters.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-251</link>

                    <description>Updates parse_view_query to allow for a specifiable parameter that causes unknown query string parameters to be ignored. This allows _list functions to get input other than just the standard view parameters.</description>
                <environment></environment>
            <key id="12414740">COUCHDB-251</key>
        <summary>Allow _list functions to accept arbitrary GET parameters.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Fri, 13 Feb 2009 12:45:51 +0000 (UTC)</created>
    <updated>Fri, 13 Feb 2009 18:36:15 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12673242" author="paul.joseph.davis" created="Fri, 13 Feb 2009 12:47:22 +0000 (UTC)"  >Patch for the improvement.</comment>
                    <comment id="12673345" author="jchris" created="Fri, 13 Feb 2009 18:36:15 +0000 (UTC)"  >applied in r744210</comment>
                </comments>
    
    <attachments>
            <attachment id="12400182" name="COUCHDB-251.patch" size="3001" author="paul.joseph.davis" created="Fri, 13 Feb 2009 12:47:22 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 18:36:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 18:36:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-250] init script missing check for $COUCHDB_PID_FILE</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-250</link>

                    <description>the following patch fixes this:&lt;br/&gt;
&lt;br/&gt;
Index: etc/init/couchdb.tpl.in&lt;br/&gt;
===================================================================&lt;br/&gt;
--- etc/init/couchdb.tpl.in	(revision 744021)&lt;br/&gt;
+++ etc/init/couchdb.tpl.in	(working copy)&lt;br/&gt;
@@ -63,6 +63,9 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;# Start Apache CouchDB as a background process.&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;command=&amp;quot;$COUCHDB -b&amp;quot;&lt;br/&gt;
+    if test -n &amp;quot;$COUCHDB_PID_FILE&amp;quot;; then&lt;br/&gt;
+        command=&amp;quot;$command -p $COUCHDB_PID_FILE&amp;quot;&lt;br/&gt;
+    fi&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if test -n &amp;quot;$COUCHDB_STDOUT_FILE&amp;quot;; then&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;command=&amp;quot;$command -o $COUCHDB_STDOUT_FILE&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fi&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>gentoo</environment>
            <key id="12414724">COUCHDB-250</key>
        <summary>init script missing check for $COUCHDB_PID_FILE</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jab">Joshua Bronson</reporter>
            
    <created>Fri, 13 Feb 2009 09:33:59 +0000 (UTC)</created>
    <updated>Sun, 22 Feb 2009 17:06:45 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12675674" author="janl" created="Sun, 22 Feb 2009 17:03:20 +0000 (UTC)"  >Applied in r746771. Thanks.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 22 Feb 2009 17:03:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 22 Feb 2009 17:03:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-249] Treat output rows of views as documents for other views to build upon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-249</link>

                    <description>Unless I manually copy the JSON rows of a view into a new document, I am unable to create new views that are computed from existing views. That is, it seems as if views are second class citizens compared to first-class documents.&lt;br/&gt;
&lt;br/&gt;
Suppose I wanted to find the spread between the cheapest suppliers and the most expensive suppliers of each fruit. I know it&apos;s possible to use one map/reduce to compute such a view, but I&apos;d like to be able to re-use my existing &amp;quot;cheapest&amp;quot; and &amp;quot;costliest&amp;quot; views. That is, I&apos;d like to use the document output of these views as input into another view.&lt;br/&gt;
&lt;br/&gt;
I started with the simple fruit store example in the CouchDB book. I developed a simple view called &amp;quot;cheapest&amp;quot; with the following map and reduce functions (the &amp;quot;costliest&amp;quot; view is the same as &amp;quot;cheapest&amp;quot; but except the reduce function&apos;s comparison is the other way around):&lt;br/&gt;
&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var store, price, key;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (doc.item &amp;amp;&amp;amp; doc.prices) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (store in doc.prices) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;price = doc.prices[store];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;key = doc.item;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;emit(key, {store:store, price:price});&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
function(item,store) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var m = store[0];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;for (i in store) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (m.price &amp;gt; store[i].price) m = store[i];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;return m;&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
The output is as follows:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;key&amp;quot;:&amp;quot;apple&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;store&amp;quot;:&amp;quot;Apples Express&amp;quot;,&amp;quot;price&amp;quot;:0.79}},&lt;br/&gt;
{&amp;quot;key&amp;quot;:&amp;quot;banana&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;store&amp;quot;:&amp;quot;Price Max&amp;quot;,&amp;quot;price&amp;quot;:079}},&lt;br/&gt;
{&amp;quot;key&amp;quot;:&amp;quot;orange&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;store&amp;quot;:&amp;quot;Citrus Circus&amp;quot;,&amp;quot;price&amp;quot;:1.09}}&lt;br/&gt;
]}&lt;br/&gt;
&lt;br/&gt;
I&apos;d like to develop a new view whose input is the output of the view above, but as far as I can tell, views only operate on documents, not the output of existing views. Am I missing something?</description>
                <environment></environment>
            <key id="12414678">COUCHDB-249</key>
        <summary>Treat output rows of views as documents for other views to build upon</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="lawrancj">Joey Lawrance</reporter>
            
    <created>Thu, 12 Feb 2009 16:37:23 +0000 (UTC)</created>
    <updated>Thu, 4 Jun 2009 10:36:25 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
                    <component>Infrastructure</component>
                    <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>3</votes>
    
                                        

            <comments>
                    <comment id="12673169" author="vseledkin" created="Fri, 13 Feb 2009 07:52:43 +0000 (UTC)"  >I support this requirement. In my project I had to implement it by myself to perform computation schema what are not possible to implement using current view implementation. I am new with Erlang and my implementation is probably not  efficient  and reliable. I prefer to see this feature as built in for Couch DB.&lt;br/&gt;
&lt;br/&gt;
By the way if someone needs i posting my code that does the job.</comment>
                    <comment id="12673172" author="vseledkin" created="Fri, 13 Feb 2009 08:07:16 +0000 (UTC)"  >this is modified couch_view_updater.erl of 739866 trunk version.&lt;br/&gt;
To use it, on you view add the following comment at the beginning of the view code &lt;br/&gt;
//put_results_to(db_name)&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (doc.document){&lt;br/&gt;
..........&lt;br/&gt;
&lt;br/&gt;
the db db_name must exist,&lt;br/&gt;
when after view is rebuilt you&apos;ll have all result from it in db_name db&lt;br/&gt;
so you can create additional views on it. The incremental update of the view incrementally updates db_name content to keep it consistent. Use at your own risk, keep you data backups fresh :)</comment>
                    <comment id="12716213" author="vseledkin" created="Thu, 4 Jun 2009 09:48:44 +0000 (UTC)"  >Also ataching patch file to couch_view_updater.erl to support multi level views </comment>
                    <comment id="12716219" author="wildchild" created="Thu, 4 Jun 2009 10:19:32 +0000 (UTC)"  >Why not follow erlang coding conventions? I am confused about all this getViewDBName and friends.</comment>
                    <comment id="12716226" author="vseledkin" created="Thu, 4 Jun 2009 10:36:25 +0000 (UTC)"  >I am not Erlanger in any sense  :) I know nothing about Erlang coding culture, I wrote that code almost intuitively. It wouild be nice if someone revise code and publish it here</comment>
                </comments>
    
    <attachments>
            <attachment id="12409867" name="couch_view_updaer.erl.patch.txt" size="6934" author="vseledkin" created="Thu, 4 Jun 2009 09:48:44 +0000 (UTC)" />
            <attachment id="12400906" name="couch_view_updater.erl" size="14577" author="vseledkin" created="Wed, 25 Feb 2009 05:50:34 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 07:52:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-248] The log process should use SASL for logging</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-248</link>

                    <description>As it stands the log process is ad-hoc since it was written from scratch. Making it a wrapper around SASL (&lt;a href=&quot;http://erlang.org/doc/apps/sasl/index.html&quot;&gt;http://erlang.org/doc/apps/sasl/index.html&lt;/a&gt;) would be a good improvement.</description>
                <environment>any</environment>
            <key id="12414643">COUCHDB-248</key>
        <summary>The log process should use SASL for logging</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ulises">Ulises Cervino Beresi</reporter>
            
    <created>Thu, 12 Feb 2009 07:43:24 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 20:15:08 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772360" author="dipthegeezer" created="Sun, 1 Nov 2009 20:39:34 +0000 (UTC)"  >Hi&lt;br/&gt;
&lt;br/&gt;
I&apos;m new to couch ( and erlang ) and would like to have a stab at this. In terms of wrapping the logging around sasl, should I just be using whatever logging module that gets set up when sasl starts? Or should I be wrapping couch_log around a specific module.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;eg.  sasl_report_file_h/error_logger_mf_h&lt;br/&gt;
&lt;br/&gt;
Thanks&lt;br/&gt;
&lt;br/&gt;
Dip</comment>
                    <comment id="12772687" author="kocolosk" created="Mon, 2 Nov 2009 20:59:16 +0000 (UTC)"  >Hi Dip, I&apos;m not quite sure what Ulises had in mind with this ticket.  Couch logs events by registering a new handler for the SASL error_logger event manager and generating error_logger:error_report and error_logger:info_report messages.  It seems to me that it already is a wrapper around SASL, in fact.</comment>
                    <comment id="12772691" author="paul.joseph.davis" created="Mon, 2 Nov 2009 21:09:20 +0000 (UTC)"  >This is most odd. We go through SASL callbacks and end up with io:format calls? Is this how normal Erlang logging is done? The original part of that ticket was a general &amp;quot;use erlang&apos;s builtin logging instead of a roll our own&amp;quot; approach. I didn&apos;t realize we even touched sasl as it currently is.</comment>
                    <comment id="12772829" author="kocolosk" created="Tue, 3 Nov 2009 02:10:14 +0000 (UTC)"  >Hi Paul, I don&apos;t know what&apos;s &amp;quot;normal&amp;quot;.  As Dip pointed out, SASL ships with a few event handlers.  We use the default one (sasl_report_tty_h) and set &lt;br/&gt;
&lt;br/&gt;
-sasl errlog_type error&lt;br/&gt;
&lt;br/&gt;
in the startup script so that it only logs error-level messages.  I think that logger only handles crash and supervisor reports, becuase we define ?LOG_DEBUG and ?LOG_INFO to send info_reports and ?LOG_ERROR to send error reports of specific types (couch_debug/info/error), and those types are only handled by custom event handlers.&lt;br/&gt;
&lt;br/&gt;
I don&apos;t think there&apos;s anything too weird about writing our own event handlers for these messages.  The event handlers that ship with SASL are probably much too verbose for an access log anyway.&lt;br/&gt;
&lt;br/&gt;
One area where we do need to improve is in trimming down those crash reports.  There&apos;s a lot of duplicate info in there, in part because our handler and sasl_report_tty_h sometimes end up effectively logging two copies of the same crash.</comment>
                    <comment id="12772845" author="paul.joseph.davis" created="Tue, 3 Nov 2009 02:43:14 +0000 (UTC)"  >@Adam,&lt;br/&gt;
&lt;br/&gt;
Sadly, I don&apos;t know whats normal either. :) I guess maybe I was assuming that there&apos;d be a log4j style logging system that we should be plugging into. Though I have seen other loggers (RabbitMQ I think?) that looked like they were using a system log thinger. Though I definitely see your point on those being entirely too verbose for access logs.&lt;br/&gt;
&lt;br/&gt;
@Din,&lt;br/&gt;
&lt;br/&gt;
If you&apos;re still interested in taking a crack at this, I think the first step would be to check out current projects and see what they do for logging. I would suggest looking at Yaws, RabbitMQ, ejabberd to see if you can figure out if they&apos;re using a system logger similarly to ours or doing something that appears to be more built-in. If it turns out that our system isn&apos;t as non-standard as I had originally thought then this might not actually be much of a patch.&lt;br/&gt;
&lt;br/&gt;
There are plenty of other tickets that could be worked on if you&apos;re still interested in writing patches. If you want I can go through and find a couple candidates that would be of similar effort to get you started. We&apos;re always looking for fresh eyes and new ideas.</comment>
                    <comment id="12773162" author="dipthegeezer" created="Tue, 3 Nov 2009 20:15:08 +0000 (UTC)"  >Hi Paul/Adam&lt;br/&gt;
&lt;br/&gt;
Yeah that would be great. If you could let me know which tickets/tasks I could take a stab at...maybe just email me directly with a list. I wouldn&apos;t mind starting off with a few easier ones to begin with for now.&lt;br/&gt;
&lt;br/&gt;
I was a bit confused by this ticket because most of the other erlang projects I&apos;ve looked at assign their own event handler to error_logger, however rabbitmq and yaws have wrapped their customised logging around error_logger_file_h but that seems to be due to  get over some handlers not closing when swapping out....&lt;br/&gt;
&lt;br/&gt;
Anyway if you have some other stuff for me to look at  please feel free to mail me.&lt;br/&gt;
&lt;br/&gt;
Thanks&lt;br/&gt;
&lt;br/&gt;
Dip</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 1 Nov 2009 20:39:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-247] The log process should be started before any other process</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-247</link>

                    <description>Processes should be able to log their operations from the very beginning of their existence to avoid io:format() in case they need to do so. Only processes started after the log process will be able to make use of ?LOG_X. See issue 153 (&lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-153&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-153&lt;/a&gt;) for a case scenario where it would be desirable for the log process to have been started before the db process.</description>
                <environment>Any</environment>
            <key id="12414547">COUCHDB-247</key>
        <summary>The log process should be started before any other process</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ulises">Ulises Cervino Beresi</reporter>
            
    <created>Wed, 11 Feb 2009 08:40:19 +0000 (UTC)</created>
    <updated>Wed, 11 Feb 2009 19:16:56 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12672725" author="paul.joseph.davis" created="Wed, 11 Feb 2009 19:06:18 +0000 (UTC)"  >There was mention of using more of the OTP recommended stuff. Specifically of interest here is switching to using SASL for the logging. I&apos;m not sure what&apos;d be involved but I figured I should make a note of it for reference.</comment>
                    <comment id="12672730" author="ulises" created="Wed, 11 Feb 2009 19:12:14 +0000 (UTC)"  >As a note, the log process *is* being started before any other primary service (couch_primary_services). My initial report was related to issue 153 as ?LOG_ERROR, for some reason, wasn&apos;t logging the message.&lt;br/&gt;
&lt;br/&gt;
I do agree on the moving the log process to using SASL.</comment>
                    <comment id="12672733" author="damienkatz" created="Wed, 11 Feb 2009 19:16:56 +0000 (UTC)"  >Changing the logging implementation to something more standardized is a very good thing. Right now the log output format is just come random stuff I threw together.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Feb 2009 19:06:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-246] allow customization of external process timeout</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-246</link>

                    <description>&lt;br/&gt;
If an external process takes too long to respond, it is killed. The timeout is quite short (a few seconds) and is not configurable from .ini files today.&lt;br/&gt;
&lt;br/&gt;
couchdb-lucene could use this ability as the first attempt to sort on a field in a large index is slow while it builds a cache. With the timeout, it&apos;s killed and the partial work is lost.</description>
                <environment></environment>
            <key id="12414540">COUCHDB-246</key>
        <summary>allow customization of external process timeout</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Wed, 11 Feb 2009 05:36:15 +0000 (UTC)</created>
    <updated>Fri, 6 Mar 2009 18:20:26 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12672520" author="antonyblakey" created="Wed, 11 Feb 2009 05:52:42 +0000 (UTC)"  >I have this problem with _externals that implement lazy-view update semantics. The problem being that the amount of work required for the _external to catchup to the current update_seq is unknown. I experimented with a solution that allows the external to return a keep-alive message to the server, which doesn&apos;t return a value to the client but does stop the server killing the external.&lt;br/&gt;
&lt;br/&gt;
I got distracted and didn&apos;t complete that work, but I think this is a better solution than a fixed timeout. The problem with a timeout is that it doesn&apos;t account for machine performance or load, or the possible highly variable amount of work that the external needs to do on a per-request basis, whereas a keep-alive more correctly captures what you want e.g. the external process is making progress. Such a keep alive could specify a timeout value, so that the external process could control the definition of failure according to how often it will send keep-alives, but that might be an unnecessary complication.</comment>
                    <comment id="12672533" author="paul.joseph.davis" created="Wed, 11 Feb 2009 07:12:15 +0000 (UTC)"  >Adding a configurable timeout would be simple. I should&apos;ve added this during the original writing of this code. I&apos;m assuming though that when I wrote the original I thought, &amp;quot;Not important until someone complains.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Either way, the time has come.&lt;br/&gt;
&lt;br/&gt;
Adding a configurable timeout is trivial. I&apos;ll add an initial patch tomorrow most likely that would grant some *.ini control for this.&lt;br/&gt;
&lt;br/&gt;
In regards to Antony&apos;s comments I definitely agree, having a more dynamic timeout mechanism would be best, but would require me more than the expected 10 or so lines of code.&lt;br/&gt;
&lt;br/&gt;
Antony, also, when you say Keep-Alive, do you mean a heart beat to CouchDB or all the way through to the HTTP client? I&apos;d assume just to CouchDB in terms of a &amp;quot;Back off mofo, I&apos;m still working!&amp;quot; sort of way which we don&apos;t have yet.&lt;br/&gt;
&lt;br/&gt;
In another slightly unlreated context, I contemplated the other day passing a UUID with all  requests to os_process&apos;s. This would allow an asynchronous communication protocol for all things dealing with non-erlang code. In terms of view servers, we could possibly push some effort into the different view servers. I think it could also simplify internal code quite a bit. The only thing that makes me push less hard is the fact that everything is happening over stdio. I know that its optimized through the kernel and I don&apos;t have benchmarks to show that it&apos;s a bottleneck, but its like a large pink flamingo standing there staring at me.</comment>
                    <comment id="12672558" author="antonyblakey" created="Wed, 11 Feb 2009 08:53:17 +0000 (UTC)"  >I mean a keep-alive back to couch, not to the HTTP server, although the ability to propagate the keep-alive as an HTTP continue might be interesting, though I&apos;m not sure of the HTTP continue semantics.&lt;br/&gt;
&lt;br/&gt;
The keep-alive was trivial - 2/3 lines to handle the message, because IIRC the timeout is in the receive loop of the external driver. I think its not more work than the configurable option.&lt;br/&gt;
&lt;br/&gt;
As far as UUIDs are concerned, do you mean session multiplexing over the _external channel?</comment>
                    <comment id="12672727" author="jchris" created="Wed, 11 Feb 2009 19:07:55 +0000 (UTC)"  >Curently, sending log() responses occasionally is all it takes to prevent a time out. I&apos;m not suggesting that we don&apos;t need a special keep-alive intermediate response, just that it should be fairly trivial to crib from what the log case does, and, if you can&apos;t wait for the patch, you can use log() as a stand in.</comment>
                    <comment id="12679679" author="jchris" created="Fri, 6 Mar 2009 18:20:26 +0000 (UTC)"  >fixed in r751020</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 6 Mar 2009 18:20:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Feb 2009 05:52:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-245] Couch uses the erlang stdlib module regexp, which is deprecated and set to be removed. It should use the module re instead.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-245</link>

                    <description>Couch uses the erlang stdlib module regexp, which is deprecated and set to be removed. It should use the module re instead. re is not a drop in replacement for regexp, it operates on and returns binary strings instead of native strings. &lt;br/&gt;
&lt;br/&gt;
Affects files couch_config.erl, couch_config_writer.erl, couch_httpd.erl, couch_httpd_server.erl, couch_log.erl and couch_server.erl. </description>
                <environment>regexp is set to be removed from stdlib when R15 is released.</environment>
            <key id="12414535">COUCHDB-245</key>
        <summary>Couch uses the erlang stdlib module regexp, which is deprecated and set to be removed. It should use the module re instead.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="alisdair">alisdair sullivan</reporter>
            
    <created>Wed, 11 Feb 2009 04:09:18 +0000 (UTC)</created>
    <updated>Tue, 18 Aug 2009 15:50:18 +0000 (UTC)</updated>

                        <version>0.7.2</version>
                    <version>0.8</version>
                    <version>0.8.1</version>
                    <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>        <timeestimate seconds="7200">2h</timeestimate>                    

            <comments>
                    <comment id="12672590" author="kshrier" created="Wed, 11 Feb 2009 11:01:14 +0000 (UTC)"  >This file contains a patch to replace the use of the regexp module with the re module.  It modifies files couch_config.erl, couch_config_writer.erl, couch_log.erl, couch_httpd.erl, couch_httpd_db.erl, and couch_server.erl</comment>
                    <comment id="12672593" author="kshrier" created="Wed, 11 Feb 2009 11:03:39 +0000 (UTC)"  >There are 2 uses of the regexp module in the mochiweb source.  This patch replaces them with functions from the re module.  File mochiweb_skel.erl is modified.</comment>
                    <comment id="12672597" author="antonyblakey" created="Wed, 11 Feb 2009 11:11:08 +0000 (UTC)"  >Should patches to mochiweb instead be made upstream?</comment>
                    <comment id="12672601" author="janl" created="Wed, 11 Feb 2009 11:27:03 +0000 (UTC)"  >I agree on upstream: &lt;a href=&quot;http://code.google.com/p/mochiweb/&quot;&gt;http://code.google.com/p/mochiweb/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Also, as I believe the re module was introduced in R12B, we must not make sure that CouchDB refuses to build with any earlier Erlang version. Noah?</comment>
                    <comment id="12672692" author="alisdair" created="Wed, 11 Feb 2009 17:39:35 +0000 (UTC)"  >The use of regexp in mochiweb is just in the app skeleton, as far as I can tell it&apos;s not actually used anywhere by couch. It doesn&apos;t hurt to report it upstream though. &lt;br/&gt;
&lt;br/&gt;
I&apos;d thought couch was targetting R12B-5 and above, but if it needs to run on previous versions, we should provide a module that wraps re and regexp and uses the appropriate module on the appropriate runtime version.&lt;br/&gt;
</comment>
                    <comment id="12672693" author="janl" created="Wed, 11 Feb 2009 17:47:02 +0000 (UTC)"  >I think bumping the required version is just fine and adding a module to handle this is overkill.</comment>
                    <comment id="12738179" author="strattg" created="Mon, 3 Aug 2009 03:21:54 +0000 (UTC)"  >It looks like couch_rep_changes_feed.erl is now using re instead of regexp. Given that, maybe we should revisit this issue? I&apos;ve attached an updated patch that applies against r800186 and passes the Futon test suite.&lt;br/&gt;
&lt;br/&gt;
The re module&apos;s behavior seems to be to throw exceptions instead of doing {error, Reason}-style returns. There were a couple places in couch_config_writer.erl that looked like they could benefit from removal of arguably unnecessary error handling code (the regexp should never fail to be compiled, things should crash if it does), but I could be way off track with that. This is my first Erlang and CouchDB patch, so it&apos;s probably going to need some more work.</comment>
                    <comment id="12738439" author="kocolosk" created="Mon, 3 Aug 2009 17:23:38 +0000 (UTC)"  >Thanks for the updated patch, Gordon.  I think we should try to get it applied before 0.10 so that our next release builds without warnings.</comment>
                    <comment id="12743521" author="kocolosk" created="Sat, 15 Aug 2009 02:10:47 +0000 (UTC)"  >thanks Gordon and Kim for the patches.  We&apos;re now using re instead of regexp, which means that R12B-5 or higher is a requirement.</comment>
                    <comment id="12744567" author="carnold@apache.org" created="Tue, 18 Aug 2009 15:50:17 +0000 (UTC)"  >The regexp calls in Mochweb were replaced with re calls on June 25, 2009, rev 102.  Should the bundled mochiweb be updated to remove all the deprecation warnings?</comment>
                </comments>
    
    <attachments>
            <attachment id="12400010" name="couch_mochi_re_patch" size="1104" author="kshrier" created="Wed, 11 Feb 2009 11:03:38 +0000 (UTC)" />
            <attachment id="12400009" name="couch_re_patch" size="8412" author="kshrier" created="Wed, 11 Feb 2009 11:01:14 +0000 (UTC)" />
            <attachment id="12415304" name="couch_re_patch_2" size="9423" author="strattg" created="Mon, 3 Aug 2009 03:21:54 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 15 Aug 2009 02:10:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Feb 2009 11:01:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-244] Striped queries</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-244</link>

                    <description>I have implemented striped queries, where you can specify multiple startkey/endkey ranges in a single request. As a nice side effect this allows faceted search (for discrete keys). Heres an example:&lt;br/&gt;
&lt;br/&gt;
Say I have the following map function:&lt;br/&gt;
&lt;br/&gt;
function() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;emit([doc.rooms, doc.price], doc);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
where doc.rooms and doc.price are both integers. Now lets say i want to find every document with a number of rooms between 2 and 4 and a price between 100 and 1000. I can then do the following query:&lt;br/&gt;
&lt;br/&gt;
db.view(&amp;quot;my_view&amp;quot;,{},{stripes: [{startkey: [2, 100], endkey: [2, 1000]}, {startkey: [3, 100], endkey: [3, 1000]}, {startkey: [4, 100], endkey: [4, 1000]}]});&lt;br/&gt;
&lt;br/&gt;
If the view included a reduce function that would work too.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
As you can probably see this patch introduced a change to the JS API (but not the HTTP). The keys parameter is now a hash which can either take a keys param or a stripes. The keys param works as before. The stripes param takes an array of hashes each having a startkey, endkey key.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
The state of the patch is still somewhat raw, with no error checking on the stripes part of the API. Furthermore it might be useful to extend the limit, skip and descending options to the stripes.&lt;br/&gt;
&lt;br/&gt;
The patch is against the current trunk version (rev 742925) and all tests pass.</description>
                <environment></environment>
            <key id="12414482">COUCHDB-244</key>
        <summary>Striped queries</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="derfred">Frederik Fix</reporter>
            
    <created>Tue, 10 Feb 2009 12:07:20 +0000 (UTC)</created>
    <updated>Tue, 10 Feb 2009 12:08:07 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

    
    <attachments>
            <attachment id="12399908" name="striped_queries.diff" size="31903" author="derfred" created="Tue, 10 Feb 2009 12:08:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-243] Tests for extra long docid&apos;s and attachment names.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-243</link>

                    <description>Adding tests for extremely long docids and attachments.</description>
                <environment></environment>
            <key id="12414343">COUCHDB-243</key>
        <summary>Tests for extra long docid&apos;s and attachment names.</summary>

            <type id="6" iconUrl="http://issues.apache.org/jira/images/icons/test.gif">Test</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sun, 8 Feb 2009 23:45:01 +0000 (UTC)</created>
    <updated>Sun, 17 May 2009 03:09:28 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12671709" author="paul.joseph.davis" created="Mon, 9 Feb 2009 01:01:23 +0000 (UTC)"  >Just started writing tests to figure out limits for the length of a docid or attachment name. I ran into the obvious length limits on URLs pretty quick. It would appear that FF and the curl bindings for the command line test runner don&apos;t deal so well with trying to hit up to a 32K docid. FF started failing around 8K and I didn&apos;t bother checking curl&apos;s limit.&lt;br/&gt;
&lt;br/&gt;
Attachments would obviously have similar issues.&lt;br/&gt;
&lt;br/&gt;
So the question is if CouchDB should enforce a maximum, and if so, what should it be?&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12671740" author="kocolosk" created="Mon, 9 Feb 2009 05:57:13 +0000 (UTC)"  >MochiWeb has an 8k limit.  Don&apos;t know off the top of my head if it&apos;s configurable.  We had to work around it in the replicator for docs with lots of revisions.</comment>
                    <comment id="12672729" author="jchris" created="Wed, 11 Feb 2009 19:11:20 +0000 (UTC)"  >I think there&apos;s no reason to have Couch enforce a limit. There are good use cases that bypass HTTP altogether, and we should strive to make the replicator etc work with those, instead of adding arbitrary limitations based on HTTP implementation details. </comment>
                    <comment id="12672736" author="paul.joseph.davis" created="Wed, 11 Feb 2009 19:22:33 +0000 (UTC)"  >Touche. The initial tests I wrote up only showed me that FF and Curl both have limits and were throwing errors, so technically I wasn&apos;t even testing CouchDB. Perhaps we let this one drop and tell people to be aware of the mochiweb limit?</comment>
                    <comment id="12710164" author="paul.joseph.davis" created="Sun, 17 May 2009 03:09:28 +0000 (UTC)"  >Won&apos;t fix because CouchDB itself does not have any constraints on document id length.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 17 May 2009 03:09:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 9 Feb 2009 05:57:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-242] patch that allo lists to get first key and last key in tail</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-242</link>

                    <description>This patch  add the possibility to get last key and first key in list, all rows can get current row number an first/prev key. &lt;br/&gt;
&lt;br/&gt;
Lists functions have a new row_info argument that replace row_number that could be used. In head row_info is null, in tail it&apos;s null if there isn&apos;t any rows. &lt;br/&gt;
&lt;br/&gt;
row_info is an object :&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;first_key: XXX,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;row_number: XXX,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;prev_key: XXX&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
In tail, prev_key is latest key. On first row, prev_key is null.</description>
                <environment>all</environment>
            <key id="12414275">COUCHDB-242</key>
        <summary>patch that allo lists to get first key and last key in tail</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Fri, 6 Feb 2009 23:25:12 +0000 (UTC)</created>
    <updated>Tue, 10 Mar 2009 17:08:27 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12680539" author="jchris" created="Tue, 10 Mar 2009 17:08:27 +0000 (UTC)"  >fixed a few weeks ago</comment>
                </comments>
    
    <attachments>
            <attachment id="12399696" name="couchdb-diff" size="4094" author="benoitc" created="Fri, 6 Feb 2009 23:25:45 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 10 Mar 2009 17:08:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 10 Mar 2009 17:08:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-241] Add copy and move document in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-241</link>

                    <description>Create features to copy and move a document directly from the Futon administrative interface using the COPY and MOVE couchDB features</description>
                <environment></environment>
            <key id="12414247">COUCHDB-241</key>
        <summary>Add copy and move document in Futon</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="patrick.antivackis">Patrick Antivackis</reporter>
            
    <created>Fri, 6 Feb 2009 18:12:36 +0000 (UTC)</created>
    <updated>Wed, 11 Feb 2009 09:37:55 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12671229" author="patrick.antivackis" created="Fri, 6 Feb 2009 18:27:28 +0000 (UTC)"  >Here is the patch to have the copy and move functions on a document page in Futon.&lt;br/&gt;
I attached the diff and also two png that need to go in the share/www/image folder. The images are a copy of load.png.&lt;br/&gt;
Anyone that can make dedicated icons please help.</comment>
                    <comment id="12672566" author="patrick.antivackis" created="Wed, 11 Feb 2009 09:37:55 +0000 (UTC)"  >This patch provides copy and move to a new document using the Document API, any interest for I complete with the possibility to copy or move to a specified id and specified rev ?</comment>
                </comments>
    
    <attachments>
            <attachment id="12399665" name="copy.png" size="780" author="patrick.antivackis" created="Fri, 6 Feb 2009 18:27:28 +0000 (UTC)" />
            <attachment id="12399664" name="COUCHDB-241.diff" size="8411" author="patrick.antivackis" created="Fri, 6 Feb 2009 18:27:28 +0000 (UTC)" />
            <attachment id="12399666" name="move.png" size="780" author="patrick.antivackis" created="Fri, 6 Feb 2009 18:27:28 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-240] Replication breaks with large Attachments.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-240</link>

                    <description>I use the code in &lt;a href=&quot;http://code.google.com/p/couchdb-python/issues/detail?id=54&quot;&gt;http://code.google.com/p/couchdb-python/issues/detail?id=54&lt;/a&gt; to do replication between two machines.&lt;br/&gt;
&lt;br/&gt;
I&apos;m running 741265 on both machines. I have a Database with big attachments (high-res images, 31.1 GB,	34026 Docs). &amp;quot;Pull&amp;quot; replication breaks with following message sent via http:&lt;br/&gt;
&lt;br/&gt;
couchdb.client.ServerError: (500, (&apos;function_clause&apos;, &amp;quot;[{lists,map,[#Fun&amp;lt;couch_rep.10.28922857&amp;gt;,ok]},\n {couch_rep,open_doc_revs,4},\n {couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,3},\n {couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]&amp;quot;))&lt;br/&gt;
&lt;br/&gt;
With &amp;quot;push&amp;quot; replication the server just drops the connection  (httplib2/__init__.py&amp;quot;, line 715, in connect&lt;br/&gt;
socket.error: (61, &apos;Connection refused&apos;) - why &amp;quot;refused&amp;quot; instead of &amp;quot;closed&amp;quot;?). I have only been able to replicate the first 100 documents.</description>
                <environment>r 741265. Debian Linux unknown revision, FreeBSD 7.0. GBit Network connection between the hosts.</environment>
            <key id="12414145">COUCHDB-240</key>
        <summary>Replication breaks with large Attachments.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Thu, 5 Feb 2009 21:49:53 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 18:38:25 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12673385" author="mdornseif" created="Fri, 13 Feb 2009 21:46:14 +0000 (UTC)"  >The error I&apos;m seeing might actually be &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-254&quot; title=&quot;Non-Unicde characters in an attachment name render a document unreadable.&quot;&gt;&lt;strike&gt;COUCHDB-254&lt;/strike&gt;&lt;/a&gt;.</comment>
                    <comment id="12673389" author="kocolosk" created="Fri, 13 Feb 2009 21:54:52 +0000 (UTC)"  >Hi Maximillian, thanks.  I know the attachment support in the replicator needs work even if this particular problem is caused by &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-254&quot; title=&quot;Non-Unicde characters in an attachment name render a document unreadable.&quot;&gt;&lt;strike&gt;COUCHDB-254&lt;/strike&gt;&lt;/a&gt;.</comment>
                    <comment id="12674166" author="mdornseif" created="Tue, 17 Feb 2009 10:21:22 +0000 (UTC)"  >I removed the documents related to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-254&quot; title=&quot;Non-Unicde characters in an attachment name render a document unreadable.&quot;&gt;&lt;strike&gt;COUCHDB-254&lt;/strike&gt;&lt;/a&gt; from my database but replication is still broken.&lt;br/&gt;
</comment>
                    <comment id="12675749" author="dundeemt" created="Mon, 23 Feb 2009 03:23:56 +0000 (UTC)"  >I&apos;ve seen the same with attachments as small as 18MB -- see&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-user/200901.mbox/browser&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-user/200901.mbox/browser&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12679903" author="kocolosk" created="Sat, 7 Mar 2009 19:00:17 +0000 (UTC)"  >Hi Maximillian, can you try again with trunk r751306 or newer?  We rewrote the replicator and improved its memory utilization.</comment>
                    <comment id="12680079" author="mdornseif" created="Mon, 9 Mar 2009 07:30:14 +0000 (UTC)"  >I tried r751316 and still see issues. I&apos;m now trying r751605.</comment>
                    <comment id="12680249" author="mdornseif" created="Mon, 9 Mar 2009 19:55:13 +0000 (UTC)"  >I&apos;m now using r751801 on both machines.  I get a lot less error messages than before :-) Trying &amp;quot;pull&amp;quot; replication I see on the destination machine:&lt;br/&gt;
&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [error] [&amp;lt;0.2772.0&amp;gt;] streaming attachment failed with connection_closed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replicator-linked pid &amp;lt;0.2772.0&amp;gt; exited with attachment_request_failed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [error] [&amp;lt;0.2773.0&amp;gt;] streaming attachment failed with connection_closed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replication enumerator exited with pls_restart_kthxbye .. respawning&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replicator-linked pid &amp;lt;0.2773.0&amp;gt; exited with attachment_request_failed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replication enumerator exited with pls_restart_kthxbye .. respawning&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [error] [&amp;lt;0.2806.0&amp;gt;] streaming attachment failed with connection_closed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replicator-linked pid &amp;lt;0.2806.0&amp;gt; exited with attachment_request_failed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replication enumerator exited with pls_restart_kthxbye .. respawning&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [error] [&amp;lt;0.2807.0&amp;gt;] streaming attachment failed with connection_closed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replicator-linked pid &amp;lt;0.2807.0&amp;gt; exited with attachment_request_failed&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [error] [&amp;lt;0.65.0&amp;gt;] replication enumerator exited with pls_restart_kthxbye .. respawning&lt;br/&gt;
... and so on.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
On the source I see this:&lt;br/&gt;
&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:40 GMT] [info] [&amp;lt;0.516.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/MNGSB7ULVOYYVCXR01/11999_Snowboard_PRO_blau.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/AX5NEF3FGEIQQZHM01/IMG_6260.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/DSXPD7ZA4CR6TTFR01/74409.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/DSXPD7ZA4CR6TTFR01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;124468297&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/66MUJ4H533ZXF3DL01/b36b0a51be757b6d21b338520c0439d5.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/66MUJ4H533ZXF3DL01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2626715626&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.506.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/FTNUGDTJDC4EX4NO01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2130525200&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.516.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/Z6EUBABSJJRFGGBW01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;1174758156&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/53QLHO6TG5X4RUBO01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2043438337&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/J5XVD6QPSUC6QTYW01/New_01...JPG 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/J5XVD6QPSUC6QTYW01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;4092060956&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/OJ5ZNVOKDCVFSSB701/76403.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/IP6MGMXSLIZSLT6S01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2604152110&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/XX75NZYJXOYY7BV501?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;3057582815&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/NAQO6H7RHLIOE7FM01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2756407557&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.558.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/YKKC3WWDZRD5IV7B01/57403.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:41 GMT] [info] [&amp;lt;0.569.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/_all_docs_by_seq?limit=100&amp;amp;startkey=6880 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/53QLHO6TG5X4RUBO01/71570TR.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/Y6MEIUXGBOP5FUJI01/76597_.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/IP6MGMXSLIZSLT6S01/71576.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/5N52PUBPNXLOXF4J01/75008A.JPG 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/5N52PUBPNXLOXF4J01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;3204386093&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/AX5NEF3FGEIQQZHM01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;4285217492&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/J2XORR3HRCSMXF7701/65294.JPG 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/J2XORR3HRCSMXF7701?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;3119947216&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/M3G6MZBIYJRYWZU301/Multitisch_2006_.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/M3G6MZBIYJRYWZU301?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;166021924&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.552.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/M2CFHVLEWQORIMCB01/Kicker_ST_1018.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.552.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/M2CFHVLEWQORIMCB01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;3664679569&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:42 GMT] [info] [&amp;lt;0.558.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/Y6MEIUXGBOP5FUJI01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;3391344911&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.506.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/FTNUGDTJDC4EX4NO01/71422.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/F2RRFOVPZFHQLR4301/74404.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/AX5NEF3FGEIQQZHM01/IMG_6260.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/YDFKQ45LC3MDHSOD01/75210_Sportlenkdrachen_LD-120_KS_3049.png 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/YDFKQ45LC3MDHSOD01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2136613132&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/L2Z6TGHZBNKIP6TS01/Neopren_weights_Lady_green.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/L2Z6TGHZBNKIP6TS01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;1847492796&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/MNGSB7ULVOYYVCXR01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;1794236561&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/M2C4FP754G2QNJ2K01/Neopren_weights_Lady_purple.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/M2C4FP754G2QNJ2K01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;1618418127&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/OJ5ZNVOKDCVFSSB701/76403.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.552.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/A5Z6E5ZTBSXFIAVC01/72760.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.552.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/A5Z6E5ZTBSXFIAVC01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;1263711090&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.552.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/WXW2AJYKXDQ2YY6Z01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;628231131&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.558.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/F2RRFOVPZFHQLR4301?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;284397338&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:43 GMT] [info] [&amp;lt;0.558.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/OJ5ZNVOKDCVFSSB701?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;471519366&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/XX75NZYJXOYY7BV501/71590TR.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/WXW2AJYKXDQ2YY6Z01/74406_Kopie.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.506.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/2QZPNUA3IGOPKUAT01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;1401971826&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/MUQ7IUD37UBIYBHQ01/57104__.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/MUQ7IUD37UBIYBHQ01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2964667508&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/YKKC3WWDZRD5IV7B01/57403.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/YKKC3WWDZRD5IV7B01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2242812618&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:44 GMT] [info] [&amp;lt;0.552.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/UVJV6ONQL22R4T7Z01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;3010604255&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.466.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/UVJV6ONQL22R4T7Z01/74401.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.506.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/2QZPNUA3IGOPKUAT01/74407.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/DSXPD7ZA4CR6TTFR01/74409.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/DSXPD7ZA4CR6TTFR01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;124468297&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/66MUJ4H533ZXF3DL01/b36b0a51be757b6d21b338520c0439d5.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/66MUJ4H533ZXF3DL01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2626715626&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/_all_docs_by_seq?limit=100&amp;amp;startkey=6880 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.530.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/MNGSB7ULVOYYVCXR01/11999_Snowboard_PRO_blau.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/FTNUGDTJDC4EX4NO01/71422.jpg 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.536.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/FTNUGDTJDC4EX4NO01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2130525200&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/Z6EUBABSJJRFGGBW01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;1174758156&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/J5XVD6QPSUC6QTYW01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;4092060956&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.550.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/NAQO6H7RHLIOE7FM01?revs=true&amp;amp;latest=true&amp;amp;open_revs=[&amp;quot;2756407557&amp;quot;] 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:45 GMT] [info] [&amp;lt;0.576.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/_all_docs_by_seq?limit=100&amp;amp;startkey=6880 200&lt;br/&gt;
[Mon, 09 Mar 2009 19:44:46 GMT] [info] [&amp;lt;0.523.0&amp;gt;] 192.168.0.30 - - &apos;GET&apos; /huimages/J5XVD6QPSUC6QTYW01/New_01...JPG 200&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I see no exceptions anywhere. On the futon status screen I see &amp;quot;Processed source update #6880&amp;quot;. The number starts lower but always stops updating at #6880.&lt;br/&gt;
&lt;br/&gt;
Adam, if you want to, I can make the DB in question (31GB) available to you.</comment>
                    <comment id="12680347" author="kocolosk" created="Tue, 10 Mar 2009 01:03:19 +0000 (UTC)"  >Hi Maximillian, I suspect it&apos;ll be enough if you provide the documents referenced by &lt;br/&gt;
&lt;br/&gt;
/huimages/_all_docs_by_seq?limit=100&amp;amp;startkey=6880&lt;br/&gt;
&lt;br/&gt;
However you choose to do that is fine by me.  Thanks, Adam&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12699207" author="dundeemt" created="Wed, 15 Apr 2009 14:11:00 +0000 (UTC)"  >Adam, Have you had any luck with this issue?  With 0.9 rev760917&lt;br/&gt;
I am seeing  &lt;br/&gt;
** reason for termination ==&lt;br/&gt;
** attachment_request_failed&lt;br/&gt;
&lt;br/&gt;
In my log file when replicating via pull from one machine to another.  Replicating on the same machine runs without issue.</comment>
                    <comment id="12699221" author="kocolosk" created="Wed, 15 Apr 2009 14:47:40 +0000 (UTC)"  >Hi Jeff, what was the reason given in the logs on the line that begins &amp;quot; streaming attachment failed with&amp;quot;.  Was it also connection_closed as reported by Maximillian?</comment>
                    <comment id="12699232" author="dundeemt" created="Wed, 15 Apr 2009 15:04:06 +0000 (UTC)"  >[Wed, 15 Apr 2009 13:53:43 GMT] [error] [&amp;lt;0.4134.25&amp;gt;] streaming attachment failed with code 404: &lt;a href=&quot;http://carpo.delasco.pri:5984/invoices/INV00651978%2B1/PRINV00651978+1.PDF&quot;&gt;http://carpo.delasco.pri:5984/invoices/INV00651978%2B1/PRINV00651978+1.PDF&lt;/a&gt;&lt;br/&gt;
[Wed, 15 Apr 2009 13:53:46 GMT] [error] [&amp;lt;0.4791.25&amp;gt;] streaming attachment failed with status &amp;quot;404&amp;quot;&lt;br/&gt;
&lt;br/&gt;
/_utils/document.html?invoices/INV00651978+1 comes up just fine in futon and clicking on the attachment in futon, /invoices/INV00651978+1/INV00651978+1.PDF retrieves the document without error.</comment>
                    <comment id="12699264" author="kocolosk" created="Wed, 15 Apr 2009 16:32:54 +0000 (UTC)"  >ok, i assume that&apos;s a URL-encoding issue.  Will investigate.</comment>
                    <comment id="12699333" author="damienkatz" created="Wed, 15 Apr 2009 19:39:21 +0000 (UTC)"  >Adam, I think you are right. If the fix isn&apos;t too hairy, we should also add it to 0.9.1.</comment>
                    <comment id="12699414" author="kocolosk" created="Wed, 15 Apr 2009 22:03:01 +0000 (UTC)"  >It&apos;s a one-liner (+ tests).  Fixed in r765364 and merged to branches/0.9.x in r765387.&lt;br/&gt;
&lt;br/&gt;
The primary topic of this ticket still remains open.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10032">
            <name>Blocker</name>
                                        <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12408522">COUCHDB-163</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 13 Feb 2009 21:54:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-239] Futon cant handle Attachment names with slashes in it.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-239</link>

                    <description>I have managed to create files attachments with filenames starting &apos;./foo/...&apos;. See&lt;br/&gt;
&lt;a href=&quot;http://static.23.nu/md/Pictures/ZZ565827C3.png&quot;&gt;http://static.23.nu/md/Pictures/ZZ565827C3.png&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
If I want to access them in Futon it results in the URL &lt;a href=&quot;http://example.com:5984/huimages/222EPXUPYLMKM2JPBKBBFPH6U7N5UCR601/./Bilder_Photos/5-0-Multisport/5-06-Tischtennis/76253.jpg&quot;&gt;http://example.com:5984/huimages/222EPXUPYLMKM2JPBKBBFPH6U7N5UCR601/./Bilder_Photos/5-0-Multisport/5-06-Tischtennis/76253.jpg&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
this is automatically changed by my browser (Safari) to&lt;br/&gt;
&lt;a href=&quot;http://example.com:5984/huimages/222EPXUPYLMKM2JPBKBBFPH6U7N5UCR601/Bilder_Photos/5-0-Multisport/5-06-Tischtennis/76253.jpg&quot;&gt;http://example.com:5984/huimages/222EPXUPYLMKM2JPBKBBFPH6U7N5UCR601/Bilder_Photos/5-0-Multisport/5-06-Tischtennis/76253.jpg&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
resulting in {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Document is missing attachment&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
I can access the file, if I change one of the slashes to %2f:&lt;br/&gt;
&lt;a href=&quot;http://example.com:5984/huimages/222EPXUPYLMKM2JPBKBBFPH6U7N5UCR601/.%2fBilder_Photos/5-0-Multisport/5-06-Tischtennis/76253.jpg&quot;&gt;http://example.com:5984/huimages/222EPXUPYLMKM2JPBKBBFPH6U7N5UCR601/.%2fBilder_Photos/5-0-Multisport/5-06-Tischtennis/76253.jpg&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>0.9.0a731724-incubating</environment>
            <key id="12414049">COUCHDB-239</key>
        <summary>Futon cant handle Attachment names with slashes in it.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Wed, 4 Feb 2009 22:42:11 +0000 (UTC)</created>
    <updated>Wed, 4 Feb 2009 22:42:11 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-238] should throw error on creating docs with illegal private names</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-238</link>

                    <description>currently the only legal _ prefixes are _local and _design. We should test for this and return http errors. The applies to PUT and bulk-docs</description>
                <environment></environment>
            <key id="12414031">COUCHDB-238</key>
        <summary>should throw error on creating docs with illegal private names</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 4 Feb 2009 19:49:54 +0000 (UTC)</created>
    <updated>Wed, 11 Feb 2009 16:14:19 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12672116" author="paul.joseph.davis" created="Tue, 10 Feb 2009 02:08:07 +0000 (UTC)"  >Tests for document id&apos;s on PUT and _bulk_docs. Includes new invalid_docids unit test.</comment>
                    <comment id="12672667" author="damienkatz" created="Wed, 11 Feb 2009 16:14:19 +0000 (UTC)"  >Fixes checked into trunk.</comment>
                </comments>
    
    <attachments>
            <attachment id="12399875" name="COUCHDB-238.patch" size="2502" author="paul.joseph.davis" created="Tue, 10 Feb 2009 02:08:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Feb 2009 16:14:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 10 Feb 2009 02:08:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-237] Futon page for creating test cases.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-237</link>

                    <description>It&apos;d help to have a Futon page that allowed us to write test cases directly in JavaScript. I&apos;m not thinking of anything really fancy beyond a text box on a page that has couch.js and couch_test_runner.js loaded.&lt;br/&gt;
&lt;br/&gt;
Integration with a paste service for pasting links into IRC or email would also be awesome.</description>
                <environment></environment>
            <key id="12414010">COUCHDB-237</key>
        <summary>Futon page for creating test cases.</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Wed, 4 Feb 2009 17:05:40 +0000 (UTC)</created>
    <updated>Tue, 18 Aug 2009 16:05:03 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
                    <component>Test Suite</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12744515" author="sthulbourn" created="Tue, 18 Aug 2009 14:16:11 +0000 (UTC)"  >I&apos;ll look into this later today, it would be rather nice to be able to do this. :)</comment>
                    <comment id="12744550" author="paul.joseph.davis" created="Tue, 18 Aug 2009 15:26:22 +0000 (UTC)"  >Totally forgot to close this. This page now exists. You can access it from the test suite page using the &amp;quot;Custom Test&amp;quot; button at the top.&lt;br/&gt;
&lt;br/&gt;
Simon, if you have ideas for improving the functionality feel free to open a ticket with patches.</comment>
                    <comment id="12744566" author="sthulbourn" created="Tue, 18 Aug 2009 15:48:58 +0000 (UTC)"  >I presume you mean in trunk? I don&apos;t see it on my 0.9.1 release.</comment>
                    <comment id="12744575" author="paul.joseph.davis" created="Tue, 18 Aug 2009 16:05:03 +0000 (UTC)"  >Yep. It&apos;s only been in for a couple weeks.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 15:26:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Aug 2009 14:16:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-236] Test for a regression reported by jrutherford on IRC</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-236</link>

                    <description>Jrutherford experienced a temporary regression in SVN revision 738148. The error was related to _all_docs behaving oddly when using descending=true. Upgrading to trunk fixed the issue. This is just a test for the specific regression so we know about it in the future.</description>
                <environment></environment>
            <key id="12414009">COUCHDB-236</key>
        <summary>Test for a regression reported by jrutherford on IRC</summary>

            <type id="6" iconUrl="http://issues.apache.org/jira/images/icons/test.gif">Test</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Wed, 4 Feb 2009 16:57:48 +0000 (UTC)</created>
    <updated>Sun, 2 Aug 2009 07:56:54 +0000 (UTC)</updated>

                
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12670376" author="paul.joseph.davis" created="Wed, 4 Feb 2009 16:58:39 +0000 (UTC)"  >Patch to add regression test.</comment>
                    <comment id="12738011" author="paul.joseph.davis" created="Sun, 2 Aug 2009 07:56:54 +0000 (UTC)"  >No one ever re-reported this issue so ignoring.</comment>
                </comments>
    
    <attachments>
            <attachment id="12399458" name="COUCHDB-236.patch" size="1112" author="paul.joseph.davis" created="Wed, 4 Feb 2009 16:58:39 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Aug 2009 07:56:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-235] Doesn&apos;t gracefully handle malformed URLs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-235</link>

                    <description>This one took me a while to track down, and Couchdb could have helped me more :-)&lt;br/&gt;
&lt;br/&gt;
If you use curl to submit a request which includes a space, couchdb drops the connection on the floor: no response whatsoever, and nothing in logs. e.g.&lt;br/&gt;
&lt;br/&gt;
$ curl &apos;&lt;a href=&quot;http://localhost:5984/test_suite_db/_a_view/foo/bar?key=&quot;&gt;http://localhost:5984/test_suite_db/_a_view/foo/bar?key=&lt;/a&gt;&amp;quot;one two&amp;quot;&apos;&lt;br/&gt;
curl: (52) Empty reply from server&lt;br/&gt;
&lt;br/&gt;
When you check with tcpdump, it turns out that curl is not URL-encoding the space, but passing it straight through:&lt;br/&gt;
&lt;br/&gt;
...&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0x0030:  0e38 b57c 4745 5420 2f74 6573 745f 7375  .8.|GET./test_su&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0x0040:  6974 655f 6462 2f5f 615f 7669 6577 2f66  ite_db/_a_view/f&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0x0050:  6f6f 2f62 6172 3f6b 6579 3d22 6f6e 6520  oo/bar?key=&amp;quot;one.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0x0060:  7477 6f22 2048 5454 502f 312e 310d 0a55  two&amp;quot;.HTTP/1.1..U&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0x0070:  7365 722d 4167 656e 743a 2063 7572 6c2f  ser-Agent:.curl/&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0x0080:  372e 3135 2e35 2028 6936 3836 2d72 6564  7.15.5.(i686-red&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0x0090:  6861 742d 6c69 6e75 782d 676e 7529 206c  hat-linux-gnu).l&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
This happens with both versions of curl I tried (7.15.5 from CentOS 5.2, and 7.18.0 from Ubuntu Hardy)&lt;br/&gt;
&lt;br/&gt;
This is arguably a bug in curl: it should either encode the space or reject the whole URL.&lt;br/&gt;
&lt;br/&gt;
However, I wonder if couchdb could be a little more forgiving in this case, and at least return some sort of error to the client, like a 400 Bad Request.&lt;br/&gt;
&lt;br/&gt;
For comparison: under the same circumstances, Apache (2.2.8) actually accepts and processes the request, just giving a 404 if the document isn&apos;t found.&lt;br/&gt;
&lt;br/&gt;
The BNF in RFC 2616 says:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Request-Line = Method SP Request-URI SP HTTP-Version CRLF&lt;br/&gt;
&lt;br/&gt;
RFC 1738 says that space is unsafe, and unsafe characters MUST be encoded in URLs.  So Couchdb is within its rights to reject it - it would just be helpful if it could give an error.&lt;br/&gt;
</description>
                <environment>CentOS 5.2, Ubuntu Hardy&lt;br/&gt;
&lt;br/&gt;
couchdb - Apache CouchDB 0.9.0a739811-incubating</environment>
            <key id="12413989">COUCHDB-235</key>
        <summary>Doesn&apos;t gracefully handle malformed URLs</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Wed, 4 Feb 2009 12:53:14 +0000 (UTC)</created>
    <updated>Sat, 23 Jan 2010 13:56:52 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12776515" author="roshanjk" created="Wed, 11 Nov 2009 17:02:48 +0000 (UTC)"  >Noticed the same issue with CouchDB 0.11. I was trying to call a view from command line curl. The view used a composite key having a space in it. See example below:&lt;br/&gt;
&lt;br/&gt;
curl -X GET &amp;quot;&lt;a href=&quot;http://localhost:5984/mydatabase/_design/mydesign1/_view/myView?key=&quot;&gt;http://localhost:5984/mydatabase/_design/mydesign1/_view/myView?key=&lt;/a&gt;\[\&amp;quot;1234\&amp;quot;,\&amp;quot;one two\&amp;quot;\]&amp;quot;&lt;br/&gt;
&lt;br/&gt;
I get an &amp;quot;empty reply from server&amp;quot; every time. Thanks Brian for reporting this. This works perfectly well if the URL is hit from firefox.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12804081" author="supermighty" created="Sat, 23 Jan 2010 13:56:52 +0000 (UTC)"  >I am getting this same response when using the PHP CouchDB classes that are in the wiki. The response from the couch server was always an empty set.&lt;br/&gt;
&lt;br/&gt;
curl -X GET &apos;localhost:5984/db/_design/forum/_view/posts?startkey=[&amp;quot;forum/test_page_1&amp;quot;]&amp;amp;endkey=[&amp;quot;forum/test_page_1&amp;quot;, {}]&apos;&lt;br/&gt;
&lt;br/&gt;
When I removed the space I got a proper response from the server.&lt;br/&gt;
&lt;br/&gt;
I am using CouchDB 0.9.2 and PHP 5.2.6 on Debian Lenny</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Nov 2009 17:02:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-234] [PATCH] Improved Accept/Content-Type negotiation</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-234</link>

                    <description>Suggested improvement for Content-Type of responses&lt;br/&gt;
&lt;br/&gt;
Return Content-Type: application/json unless:&lt;br/&gt;
* client provides an Accept: header; and&lt;br/&gt;
* header includes text/plain, text/* or */*; and&lt;br/&gt;
* header does not have application/json earlier in the list&lt;br/&gt;
&lt;br/&gt;
This is not proper RFC 2616 negotiation - q factors are ignored - but maybe it&apos;s better than current behaviour. Tested with Firefox (which still views responses as text), but not other browsers.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12413936">COUCHDB-234</key>
        <summary>[PATCH] Improved Accept/Content-Type negotiation</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="candlerb">Brian Candler</reporter>
            
    <created>Tue, 3 Feb 2009 19:58:22 +0000 (UTC)</created>
    <updated>Thu, 8 Oct 2009 04:32:51 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12671190" author="janl" created="Fri, 6 Feb 2009 16:35:40 +0000 (UTC)"  >Interesting discussion: &lt;a href=&quot;http://simonwillison.net/2009/Feb/6/json/I&quot;&gt;http://simonwillison.net/2009/Feb/6/json/I&lt;/a&gt;</comment>
                    <comment id="12717364" author="lukevenediger" created="Mon, 8 Jun 2009 18:59:33 +0000 (UTC)"  >The link above gives a 404. This is the correct link: &lt;a href=&quot;http://simonwillison.net/2009/Feb/6/json/&quot;&gt;http://simonwillison.net/2009/Feb/6/json/&lt;/a&gt;</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10032">
            <name>Blocker</name>
                                        <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12437568">COUCHDB-521</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12399381" name="couchdb-mime.diff" size="1853" author="candlerb" created="Tue, 3 Feb 2009 19:59:19 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 6 Feb 2009 16:35:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-233]  add the current line number of displayed row in lists </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-233</link>

                    <description>This patch  add the current line number of displayed row in lists. lists functions have a new row number arguments that could be used. In head row number is null, in tail it&apos;s null if there isn&apos;t any rows or number of last row. This patch will allow us to make pagination in lists without use of ajax.&lt;br/&gt;
&lt;br/&gt;
Lists function are with this patch defined like this :&lt;br/&gt;
function(head, row, req, nbrow) {&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
where nbrow is the row line numbere. This patch only affect view server by modifying main.js and tests to &amp;quot;lists&amp;quot; test that test presence of line number and if line number is on the right position.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12413779">COUCHDB-233</key>
        <summary> add the current line number of displayed row in lists </summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 2 Feb 2009 13:33:37 +0000 (UTC)</created>
    <updated>Mon, 2 Feb 2009 20:27:44 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12669597" author="benoitc" created="Mon, 2 Feb 2009 13:41:41 +0000 (UTC)"  >this patch could also been found in my couchapp branch on github :&lt;br/&gt;
&lt;a href=&quot;http://github.com/benoitc/couchdb/commits/couchapp&quot;&gt;http://github.com/benoitc/couchdb/commits/couchapp&lt;/a&gt;</comment>
                    <comment id="12669607" author="benoitc" created="Mon, 2 Feb 2009 14:15:56 +0000 (UTC)"  >rename nbrow -&amp;gt; row_number as per suggestion of jan___ on irc.&lt;br/&gt;
&lt;br/&gt;
removed local_dev change from the diff.</comment>
                    <comment id="12669608" author="benoitc" created="Mon, 2 Feb 2009 14:18:55 +0000 (UTC)"  >nbrow -&amp;gt; row_number.</comment>
                    <comment id="12669614" author="benoitc" created="Mon, 2 Feb 2009 14:42:03 +0000 (UTC)"  >new version of the patch. This time make sure  we start from 0.</comment>
                    <comment id="12669729" author="jchris" created="Mon, 2 Feb 2009 20:27:44 +0000 (UTC)"  >applied in r740094</comment>
                </comments>
    
    <attachments>
            <attachment id="12399272" name="couchdb-lists-linenumber.diff" size="3835" author="benoitc" created="Mon, 2 Feb 2009 14:42:03 +0000 (UTC)" />
            <attachment id="12399271" name="couchdb-lists-linenumber.diff" size="3928" author="benoitc" created="Mon, 2 Feb 2009 14:18:55 +0000 (UTC)" />
            <attachment id="12399267" name="couchdb-lists-linenumber.diff" size="4194" author="benoitc" created="Mon, 2 Feb 2009 13:33:58 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Feb 2009 20:27:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Feb 2009 20:27:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-232] Testsuite fails on latest WebKit nightly.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-232</link>

                    <description>The view_collation reliably locks up the latest webkit nightly.&lt;br/&gt;
&lt;br/&gt;
Looks to be a simple difference in allowable javascript. Someone forgot to use semi-colons to terminate statements.</description>
                <environment>Latest WebKit nightly on trunk</environment>
            <key id="12413740">COUCHDB-232</key>
        <summary>Testsuite fails on latest WebKit nightly.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sun, 1 Feb 2009 22:25:33 +0000 (UTC)</created>
    <updated>Sun, 1 Feb 2009 22:31:00 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="600">0.17h</timeoriginalestimate>        <timeestimate seconds="600">0.17h</timeestimate>                    

            <comments>
                    <comment id="12669469" author="paul.joseph.davis" created="Sun, 1 Feb 2009 22:26:51 +0000 (UTC)"  >Adds semi colons to the view_collation test and etags_head test. view_collation was repeatably failing, etags didn&apos;t fail but the semi colons should be there anyway.</comment>
                    <comment id="12669471" author="jchris" created="Sun, 1 Feb 2009 22:31:00 +0000 (UTC)"  >fixed in r739872</comment>
                </comments>
    
    <attachments>
            <attachment id="12399251" name="COUCHDB-232.patch" size="5096" author="paul.joseph.davis" created="Sun, 1 Feb 2009 22:26:51 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 1 Feb 2009 22:31:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 1 Feb 2009 22:31:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-231] Make local_dev.ini generate from `make dev` and svn:ignore it</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-231</link>

                    <description>Make local_dev.ini generate from `make dev` and svn:ignore it.&lt;br/&gt;
&lt;br/&gt;
This way I&apos;ll stop losing my admin passwords when I revert to apply patches.</description>
                <environment></environment>
            <key id="12413706">COUCHDB-231</key>
        <summary>Make local_dev.ini generate from `make dev` and svn:ignore it</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Sun, 1 Feb 2009 01:20:42 +0000 (UTC)</created>
    <updated>Sun, 2 Aug 2009 07:57:24 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12738012" author="paul.joseph.davis" created="Sun, 2 Aug 2009 07:57:24 +0000 (UTC)"  >Fixed not too long ago. Didn&apos;t know the ticket existed.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Aug 2009 07:57:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Aug 2009 07:57:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-230] Add Support for Rewritable URL</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-230</link>

                    <description>It would be good if couchdb would allow to rewrite urls so that instead of having to write that:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/blogdb/_design/sofa/account.html&quot;&gt;http://127.0.0.1:5984/blogdb/_design/sofa/account.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I could just write:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/blogdb/account&quot;&gt;http://127.0.0.1:5984/blogdb/account&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
It could be done with the web server but having the rewritten rules in the db would make it a bit easier for replication so we don&apos;t have to write the rules on each web server where a db gets replicated.&lt;br/&gt;
&lt;br/&gt;
Here are a few propositions from davisp:&lt;br/&gt;
&lt;br/&gt;
&amp;lt;davisp&amp;gt; alisdair: how so? rewriting urls should be in _design documents, since they&apos;re in _design docs they should be limited to per db namespaces&lt;br/&gt;
&amp;lt;davisp&amp;gt; bobesponja: I don&apos;t know that anyone has looked at it seriously, but my first guess is that we&apos;d just make a _design/doc &amp;quot;urls&amp;quot; member that&apos;s a list of regex&apos;s and targets as is fairly standard practice&lt;br/&gt;
&amp;lt;davisp&amp;gt; bobesponja: or perhaps, regex&apos;s -&amp;gt; erlang handler&lt;br/&gt;
&amp;lt;davisp&amp;gt; the second might not be as fun</description>
                <environment></environment>
            <key id="12413653">COUCHDB-230</key>
        <summary>Add Support for Rewritable URL</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="patcito">Patrick Aljord</reporter>
            
    <created>Fri, 30 Jan 2009 19:51:55 +0000 (UTC)</created>
    <updated>Fri, 30 Jan 2009 20:10:51 +0000 (UTC)</updated>

                
                        <fixVersion>1.0</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12669005" author="paul.joseph.davis" created="Fri, 30 Jan 2009 20:10:51 +0000 (UTC)"  >There&apos;s been idle discussion about such a system on IRC and I figured that it seems like enough people are starting to have to deal with it that we should probably get some discussion going.&lt;br/&gt;
&lt;br/&gt;
The general outline that I&apos;d suggest would be to have the (one of many) standard methods using regex&apos;s to do transparent redirects (ie, the redirect is inside CouchDB not via response code).&lt;br/&gt;
&lt;br/&gt;
Couple thoughts:&lt;br/&gt;
1. All redirects should be limited to the scope of a single database.&lt;br/&gt;
2. Redirects should be specified in _design documents.&lt;br/&gt;
3. Profit&lt;br/&gt;
&lt;br/&gt;
The one specific argument against a URL rewrite mechanism I remember was from Chris on how this could cause major havoc for client libraries. I&apos;d contend that the same could be said of all the path specifications in the config files. We&apos;re giving users a tool they can use, but they only have themselves to blame if they get into a pile of hurt.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Jan 2009 20:10:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-229] Futon: &apos;Rows per page&apos; select box doesn&apos;t appear for custom views</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-229</link>

                    <description>In Futon, user-defined views don&apos;t have the paging controls visible (they exist in the page, but with &apos;display: none&apos; set on the #paging div). This doesn&apos;t affect pre-defined views (all documents, etc) or tamporary views, only user-defined views.</description>
                <environment>Futon on Apache CouchDB  0.9.0a738112-incubating</environment>
            <key id="12413537">COUCHDB-229</key>
        <summary>Futon: &apos;Rows per page&apos; select box doesn&apos;t appear for custom views</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jamesr">James Rutherford</reporter>
            
    <created>Thu, 29 Jan 2009 15:03:28 +0000 (UTC)</created>
    <updated>Thu, 29 Jan 2009 15:03:28 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-228] Futon access couchdb&apos;s config</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-228</link>

                    <description>Futon tries to access the couchdb config (/_config/query_servers) unnecessarily, causing a basic auth request if there are any &amp;quot;admins&amp;quot; configured.</description>
                <environment></environment>
            <key id="12413376">COUCHDB-228</key>
        <summary>Futon access couchdb&apos;s config</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="emgee">Matt Goodall</reporter>
            
    <created>Tue, 27 Jan 2009 13:51:59 +0000 (UTC)</created>
    <updated>Tue, 27 Jan 2009 17:20:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12667683" author="cmlenz" created="Tue, 27 Jan 2009 14:45:38 +0000 (UTC)"  >I wouldn&apos;t say &amp;quot;unnecessarily&amp;quot;, this was added for &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-202&quot; title=&quot;[PATCH] Support other languages for views in Futon&quot;&gt;&lt;strike&gt;COUCHDB-202&lt;/strike&gt;&lt;/a&gt; to be able to accurately show the list of available view languages.&lt;br/&gt;
&lt;br/&gt;
Not sure whether there&apos;s a way to suppress the auth prompt.</comment>
                    <comment id="12667728" author="emgee" created="Tue, 27 Jan 2009 17:20:46 +0000 (UTC)"  >By &amp;quot;unnecessarily&amp;quot;, I merely meant that database.html doesn&apos;t always need to access the config. For instance, if viewPath is one of _all_docs or _design_docs there&apos;s no need to populate the view editor at all. However, it would be really nice if the view editor was disabled/simplified if the user isn&apos;t in the &apos;admins&apos; list.&lt;br/&gt;
&lt;br/&gt;
Never tried this, but it ought to be possible to suppress the auth prompt by first sending a HEAD request to the view&apos;s design doc and inspecting the response&apos;s &amp;quot;Allow&amp;quot; header. If PUT is an allowed method then the view is editable and a full editor view can be displayed, including the list of languages. The CouchDB backend then just needs to send &amp;quot;Allow: GET, HEAD&amp;quot; for non-admins and &amp;quot;Allow: GET, HEAD, PUT&amp;quot; admins. You never know, it might work ;-).</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 27 Jan 2009 14:45:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-227] Large Number Support Bug</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-227</link>

                    <description>It looks like SpiderMonkey rounds large integers.  To reproduce,  create a document in Futon with a field value&lt;br/&gt;
&lt;br/&gt;
9999999999999999&lt;br/&gt;
&lt;br/&gt;
Futon will round this to 10000000000000000.  Or, create a document with that field value by some other means and then emit the field in a view.  The document will have the correct value for the field, but the value in the view will be wrong.</description>
                <environment></environment>
            <key id="12413283">COUCHDB-227</key>
        <summary>Large Number Support Bug</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 26 Jan 2009 15:43:04 +0000 (UTC)</created>
    <updated>Wed, 22 Jul 2009 21:44:38 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
                    <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12667277" author="jasondd" created="Mon, 26 Jan 2009 15:57:42 +0000 (UTC)"  >This is due to JavaScript 1.x representing all numbers as 64-bit floating point numbers, which means only 15 digits of reliability for integers (see &lt;a href=&quot;http://www.hunlock.com/blogs/The_Complete_Javascript_Number_Reference)&quot;&gt;http://www.hunlock.com/blogs/The_Complete_Javascript_Number_Reference)&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
JSON itself effectively allows arbitrary-precision decimals, as JSON is just a general-purpose data description language.  I am guessing that if the Python view server is used, then the view will return the correct values (as Python supports long integers).&lt;br/&gt;
&lt;br/&gt;
I did some research into JavaScript and precision because I wanted to use CouchDB to do financial calculations (e.g. summation of product prices).  ECMAScript 4 (or JavaScript 2) seems to support &amp;quot;real decimals&amp;quot;:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://intertwingly.net/blog/2008/07/11/Decimal-in-ECMAScript&quot;&gt;http://intertwingly.net/blog/2008/07/11/Decimal-in-ECMAScript&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://dev.opera.com/articles/view/why-i-love-ecmascript-4-real-decimals/&quot;&gt;http://dev.opera.com/articles/view/why-i-love-ecmascript-4-real-decimals/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure when Spidermonkey will have ECMAScript 4, but when it does it looks like we&apos;ll get all the juicy benefits of real decimals.  In the meantime, we should document this in case it gives anyone a nasty surprise...</comment>
                    <comment id="12734344" author="cmlenz" created="Wed, 22 Jul 2009 21:44:38 +0000 (UTC)"  >This is due to Javascript numbers using a floating point representation internally. There&apos;s nothing we can do about this until true decimal support gets added to the ECMAScript standard (or at least SpiderMonkey).</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 22 Jul 2009 21:44:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 Jan 2009 15:57:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-226] HTTP response codes on doc conflict and database conflict may not agree with HTTP spec </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-226</link>

                    <description>I&apos;m creating this issue as per Jan&apos;s request. It was originally posted to the mailing list a short while ago.&lt;br/&gt;
&lt;br/&gt;
==== &lt;br/&gt;
&lt;br/&gt;
An attempt to create an already existing database returns a 409.&lt;br/&gt;
&lt;br/&gt;
$ curl -v -s -X PUT localhost:5984/shiny_new_db 2&amp;gt;&amp;amp;1 | grep &apos;&amp;lt; HTTP&apos;&lt;br/&gt;
&amp;lt; HTTP/1.1 201 Created&lt;br/&gt;
&lt;br/&gt;
$ curl -v -s -X PUT localhost:5984/shiny_new_db 2&amp;gt;&amp;amp;1 | grep &apos;&amp;lt; HTTP&apos;&lt;br/&gt;
&amp;lt; HTTP/1.1 409 Conflict&lt;br/&gt;
&lt;br/&gt;
From the 409 section of the HTTP spec [1]&lt;br/&gt;
&amp;quot;This code is only allowed in situations where it is expected that the user might be able to resolve the conflict and resubmit the request.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
But the database already exists - there is no resolution, so I&apos;m not sure a 409 is the best response code here.&lt;br/&gt;
&lt;br/&gt;
The 412 section of the spec states&lt;br/&gt;
&amp;quot;The precondition given in one or more of the request-header fields evaluated to false&amp;quot;&lt;br/&gt;
Arguably, this is what should be returned when an attempt is made to re-create a pre-existing database - the precondition is that you can PUT to a database URI at most once.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
As for document conflict, CouchDB returns a 412.&lt;br/&gt;
&lt;br/&gt;
$ curl -v -s -X PUT -d &apos;{&amp;quot;_id&amp;quot;:&amp;quot;foo&amp;quot;}&apos; localhost:5984/shiny_new_db/foo&lt;br/&gt;
2&amp;gt;&amp;amp;1 | grep &apos;&amp;lt; HTTP&apos;&lt;br/&gt;
&amp;lt; HTTP/1.1 201 Created&lt;br/&gt;
&lt;br/&gt;
$ curl -v -s -X PUT -d &apos;{&amp;quot;_id&amp;quot;:&amp;quot;foo&amp;quot;}&apos; localhost:5984/shiny_new_db/foo&lt;br/&gt;
2&amp;gt;&amp;amp;1 | grep &apos;&amp;lt; HTTP&apos;&lt;br/&gt;
&amp;lt; HTTP/1.1 412 Precondition Failed&lt;br/&gt;
&lt;br/&gt;
I think a document conflict might have returned a 409 at some point in the past. In fact this is what the Document API wiki page [2] states it returns. Given that the user may resolve the conflict and resubmit the request, a 409 makes sense here.&lt;br/&gt;
&lt;br/&gt;
To clarify, unless I&apos;m missing something, I think an attempt to create an already existing database should return a 412 and an attempt to update a document that results in a conflict should return a 409.&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html&lt;/a&gt;&lt;br/&gt;
[2] &lt;a href=&quot;http://wiki.apache.org/couchdb/HTTP_Document_API&quot;&gt;http://wiki.apache.org/couchdb/HTTP_Document_API&lt;/a&gt;&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12413168">COUCHDB-226</key>
        <summary>HTTP response codes on doc conflict and database conflict may not agree with HTTP spec </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Sat, 24 Jan 2009 13:19:42 +0000 (UTC)</created>
    <updated>Fri, 30 Jan 2009 14:49:04 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12668732" author="jchris" created="Fri, 30 Jan 2009 03:51:15 +0000 (UTC)"  >I&apos;m committing a fix for this. It was a very easy patch to make. I figure that because it&apos;s marked &amp;quot;Blocker&amp;quot; I can assume that we&apos;re in agreement that the error codes should be swapped. &lt;br/&gt;
&lt;br/&gt;
I agree strongly with Paul&apos;s assertions that 409 is the correct error code for document update conflicts, and I agree weakly that 412 is a better error code for PUTs to existing database urls.&lt;br/&gt;
&lt;br/&gt;
Fixed in r739157</comment>
                    <comment id="12668787" author="paul.joseph.davis" created="Fri, 30 Jan 2009 09:24:46 +0000 (UTC)"  >Making a note that I agree with the 409 on document conflicts is a better reading of the HTTP spec, but we should keep it as 409 on &amp;quot;db exists&amp;quot; as well for exactly the same reason.</comment>
                    <comment id="12668887" author="paul.p.carey@gmail.com" created="Fri, 30 Jan 2009 14:49:03 +0000 (UTC)"  >So, there&apos;s consensus on returning a 409 in case of document update conflict, good.&lt;br/&gt;
&lt;br/&gt;
I&apos;m a little ambivalent about returning a 412 in case of a PUT to an existing database, although I don&apos;t think it should be a 409, because, as the spec states &amp;quot;This code is only allowed in situations where it is expected that the user might be able to resolve the conflict and resubmit the request&amp;quot;. &lt;br/&gt;
&lt;br/&gt;
If we&apos;re hunting for more suitable error codes, perhaps a 403 might be better - the server understood the request, but isn&apos;t going to fulfil it and nor should the request be repeated.&lt;br/&gt;
&lt;br/&gt;
I don&apos;t feel strongly about this though. My main issue was the response code on document conflict, this has been resolved, I&apos;m happy.  </comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Jan 2009 03:51:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Jan 2009 03:51:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-225] local-clean target removes things that shouldn&apos;t be removed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-225</link>

                    <description>`make local-clean` removes the m4/ folder and you have to do a `svn up` before you can `./bootstrap` again</description>
                <environment></environment>
            <key id="12413132">COUCHDB-225</key>
        <summary>local-clean target removes things that shouldn&apos;t be removed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Fri, 23 Jan 2009 21:38:28 +0000 (UTC)</created>
    <updated>Sun, 1 Feb 2009 08:01:50 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12669342" author="paul.joseph.davis" created="Sun, 1 Feb 2009 05:09:31 +0000 (UTC)"  >A relatively untested patch. Hopefully Noah can make use of it though. It was a rough one to track down.</comment>
                </comments>
    
    <attachments>
            <attachment id="12399227" name="COUCHDB-225.diff" size="359" author="paul.joseph.davis" created="Sun, 1 Feb 2009 05:09:31 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 1 Feb 2009 08:01:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 1 Feb 2009 05:09:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-224] Improve B-Tree implementation</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-224</link>

                    <description>&amp;nbsp;Also, the current Btree implementation isn&apos;t completely self balanacing. It&lt;br/&gt;
misses a balancing condition, partially for efficiency (it&apos;s an expensive&lt;br/&gt;
balancing operation), and for expediency. It was easier to not implement it and&lt;br/&gt;
gets the general case perormance boost.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;The thing about this is, the btree code can remain as is if the indexing&lt;br/&gt;
compaction just recopies the map values (and back indexes) and recomputes the&lt;br/&gt;
reduction values. That&apos;s a very simple design, however, if the btree is&lt;br/&gt;
completely self balancing, then the btree can be copied on a node by node basis,&lt;br/&gt;
instead of a value by value basis, and the reduction values need not be&lt;br/&gt;
recomputed all. This will make the compaction significantly faster overall.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12413129">COUCHDB-224</key>
        <summary>Improve B-Tree implementation</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Fri, 23 Jan 2009 21:05:49 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:08:23 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>1.0</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12666710" author="janl" created="Fri, 23 Jan 2009 21:06:26 +0000 (UTC)"  >Set blocking for 0.9 because I believe this will break the database file format.</comment>
                    <comment id="12680546" author="jchris" created="Tue, 10 Mar 2009 17:35:33 +0000 (UTC)"  >pushed to 0.10 as it&apos;s not necessary for the upcoming release</comment>
                    <comment id="12742156" author="janl" created="Wed, 12 Aug 2009 00:52:31 +0000 (UTC)"  >bump to 0.11</comment>
                    <comment id="12828271" author="janl" created="Mon, 1 Feb 2010 21:08:23 +0000 (UTC)"  >bumping to 1.1. for what it&apos;s worth, Robert Newson did some practical benchmaks and didn&apos;t see any performance issues with uncompacted databases. removing blocker status, too.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 10 Mar 2009 17:35:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-223] Document a way to find out failed writes fro bulk requests and async writes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-223</link>

                    <description>A bulk docs request fails if one of the containing requests fail. In favour of multi-node partitioning, this behaviour goes away and bulk writes will behave a lot like and async writes and we should document the preferred way for clients to find failed writes.</description>
                <environment></environment>
            <key id="12413126">COUCHDB-223</key>
        <summary>Document a way to find out failed writes fro bulk requests and async writes</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Fri, 23 Jan 2009 20:45:48 +0000 (UTC)</created>
    <updated>Sun, 22 Mar 2009 00:35:45 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12682200" author="davidvc" created="Mon, 16 Mar 2009 02:20:15 +0000 (UTC)"  >As an attempt to help contribute to the 0.9 release, I&apos;d be happy to document this if I understood better what the issue was.  The description is a bit cryptic.  Is there an email thread that discusses this further?  </comment>
                    <comment id="12682250" author="janl" created="Mon, 16 Mar 2009 08:43:26 +0000 (UTC)"  >Hi Dave, thanks. This is a note to document the new bulk_docs behaviour:&lt;br/&gt;
&lt;br/&gt;
Details can be found here &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200902.mbox/%3c84F66023-030A-4669-B75C-3DCC92D71A78@yahoo.com%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200902.mbox/%3c84F66023-030A-4669-B75C-3DCC92D71A78@yahoo.com%3e&lt;/a&gt; and the tests for the final API are here &lt;a href=&quot;http://svn.apache.org/viewvc/couchdb/trunk/share/www/script/test/bulk_docs.js?view=markup&quot;&gt;http://svn.apache.org/viewvc/couchdb/trunk/share/www/script/test/bulk_docs.js?view=markup&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12682420" author="damienkatz" created="Mon, 16 Mar 2009 19:26:58 +0000 (UTC)"  >Now with bulk updates, failures in the bulk update are allowed or all or nothing, and each failure is returned. See the bulk docs test for more info.&lt;br/&gt;
&lt;br/&gt;
We still need to document the api and how this works in the wiki.</comment>
                    <comment id="12682559" author="davidvc" created="Tue, 17 Mar 2009 05:08:43 +0000 (UTC)"  >I&apos;d assign myself this issue but it says I don&apos;t have permission to work on it.  I scanned the CouchDB pages, I can&apos;t find anything obvious about how to get permission.  Can someone give me permission?&lt;br/&gt;
&lt;br/&gt;
Thanks...</comment>
                    <comment id="12682638" author="janl" created="Tue, 17 Mar 2009 11:28:34 +0000 (UTC)"  >Hi Dan, I think assignments can only go to committers. I don&apos;t know why, but I think we&apos;ve got to live with it now. With your latest comment here, I think you safely claimed this issue :) Thanks for your help!</comment>
                    <comment id="12683321" author="davidvc" created="Thu, 19 Mar 2009 04:47:39 +0000 (UTC)"  >That&apos;s odd.  In Apache Derby, anybody who went through a quick signup process could own issues, even if they weren&apos;t committers.&lt;br/&gt;
&lt;br/&gt;
Anyway, I was looking at doing a first draft of this, but couldn&apos;t really figure out where to put it in the Wiki.  Perhaps it could go into howto, but is there somewhere I&apos;m missing that already talks about bulk_docs functionality where I could just append/update the information?&lt;br/&gt;
&lt;br/&gt;
Thanks!</comment>
                    <comment id="12683328" author="davidvc" created="Thu, 19 Mar 2009 05:20:12 +0000 (UTC)"  >Here&apos;s the first draft of this.  It is missing example code, but I thought you could review the overall description of the problem and new semantics while I&apos;m poking around trying to figure out what the example code should look like.  The tests are written in JavaScript, and I can pull that code for an example, but shouldn&apos;t I also describe what the underlying HTTP request should look like?&lt;br/&gt;
&lt;br/&gt;
===&lt;br/&gt;
&lt;br/&gt;
In previous releases of CouchDB, bulk updates were transactional - in particular, all requests in a bulk update failed if any request failed or was in conflict.  There were a couple of problems with this approach:&lt;br/&gt;
&lt;br/&gt;
- This doesn&apos;t actually work with replication.  Replication doesn&apos;t provide the same transactional semantics, so downstream replicas won&apos;t see &amp;quot;all-or-nothing&amp;quot; transactional semantics.  Instead, they will see documents in an inconsistent state until replication of all documents involved in the bulk update completes.  With bidirectional replication it can get even worse, because you can get edit conflicts that must be fixed manually.&lt;br/&gt;
&lt;br/&gt;
- If your database is partioned (aka &amp;quot;sharded&amp;quot;), different documents within the transaction could live on different nodes in the cluster, and these kinds of transactional semantics don&apos;t work unless you use heavy, non-scalable approaches like two-phase commit.&lt;br/&gt;
&lt;br/&gt;
With release 0.9 of CouchDB, transactional semantics have been changed to make sure CouchDB works well in replicated and partitioned environments.  There are now two transactional models supported:&lt;br/&gt;
&lt;br/&gt;
- all-or-nothing - When using _bulk_docs to update a set of documents, either all the documents will commit successfully or none will.  However, it does not do conflict checking the documents will be committed even if there are conflicts.  Conflicting versions of the document will be saved.  To use this approach, set the all_or_nothing flag when issuing a _bulk_docs request.&lt;br/&gt;
&lt;br/&gt;
TODO: Provide example code here...&lt;br/&gt;
&lt;br/&gt;
- non-atomic - In this mode, some documents may successfully be saved and some may not, and it is up to the application to check that all documents were successfully saved/updated.</comment>
                    <comment id="12688085" author="jchris" created="Sun, 22 Mar 2009 00:35:45 +0000 (UTC)"  >David,&lt;br/&gt;
&lt;br/&gt;
Thanks for documenting this. I think the appropriate place would be &lt;a href=&quot;http://wiki.apache.org/couchdb/HTTP_Document_API&quot;&gt;http://wiki.apache.org/couchdb/HTTP_Document_API&lt;/a&gt; section &amp;quot;Modify Multiple Documents With a Single Request&amp;quot;&lt;br/&gt;
&lt;br/&gt;
The only thing I&apos;d add to your above discussion is to call the non-all_or_nothing behavior the &amp;quot;default&amp;quot; so that people realize that they should expect that behavior.&lt;br/&gt;
&lt;br/&gt;
If you don&apos;t feel like closing the loop on the wiki, please make a note here so someone else can pick it up. I&apos;m closing the ticket now because I think we have the relevant information for documenting it, its just a matter of getting that info to the users.&lt;br/&gt;
&lt;br/&gt;
Thanks!&lt;br/&gt;
Chris</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 22 Mar 2009 00:35:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Mar 2009 02:20:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-222] Windows fsync problem</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-222</link>

                    <description>Via Damien c/o Jan:&lt;br/&gt;
&lt;br/&gt;
Windows has the same fsync problem, plus it also doesn&apos;t pass the flags to sallow the renaming of our own open files, needed during file compaction. Again there can be fixed in core Erlang, or our own drivers.</description>
                <environment>Windows</environment>
            <key id="12413125">COUCHDB-222</key>
        <summary>Windows fsync problem</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="deanlandolt">Dean Landolt</reporter>
            
    <created>Fri, 23 Jan 2009 20:42:36 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 20:56:12 +0000 (UTC)</updated>

                
                        <fixVersion>1.0</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666702" author="janl" created="Fri, 23 Jan 2009 20:55:53 +0000 (UTC)"  >&amp;quot;the same&amp;quot; is no guarantee that data has been written to disk. this needs to be investigated and potentially fixed in OTP.</comment>
                    <comment id="12666703" author="janl" created="Fri, 23 Jan 2009 20:56:12 +0000 (UTC)"  >bump to 1.0.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 20:55:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-221] Test that validation and authorization work properly with replicated edits.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-221</link>

                    <description>Test that the validation and authorization stuff work properly with replicated edits, the same as it does with live edits. This should already work, but its not tested. Also there is a good chance validation/authorization failures might not be handled gracefully by the replicator. It should eat failures, keeping statistics about the failures and maybe a record of the last failure, or last N failures.</description>
                <environment></environment>
            <key id="12413124">COUCHDB-221</key>
        <summary>Test that validation and authorization work properly with replicated edits.</summary>

            <type id="6" iconUrl="http://issues.apache.org/jira/images/icons/test.gif">Test</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="deanlandolt">Dean Landolt</reporter>
            
    <created>Fri, 23 Jan 2009 20:32:31 +0000 (UTC)</created>
    <updated>Mon, 16 Mar 2009 19:20:58 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12682416" author="damienkatz" created="Mon, 16 Mar 2009 19:20:58 +0000 (UTC)"  >Fixed in trunk as of r753448.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Mar 2009 19:20:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Mar 2009 19:20:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-220] Extreme sparseness in couch files</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-220</link>

                    <description>&lt;br/&gt;
When adding ten thousand documents, each with a small attachment, the discrepancy between reported file size and actual file size becomes huge;&lt;br/&gt;
&lt;br/&gt;
ls -lh shard0.couch&lt;br/&gt;
698M 2009-01-23 13:42 shard0.couch&lt;br/&gt;
&lt;br/&gt;
du -sh shard0.couch&lt;br/&gt;
57M	shard0.couch&lt;br/&gt;
&lt;br/&gt;
On filesystems that do not support write holes, this will cause an order of magnitude more I/O.&lt;br/&gt;
&lt;br/&gt;
I think it was introduced by the streaming attachment patch as each attachment is followed by huge swathes of zeroes when viewed with &apos;hd -v&apos;.&lt;br/&gt;
&lt;br/&gt;
Compacting this database reduced it to 7.8mb, indicating other sparseness besides attachments.&lt;br/&gt;
</description>
                <environment>ubuntu 8.10 64-bit, ext3</environment>
            <key id="12413090">COUCHDB-220</key>
        <summary>Extreme sparseness in couch files</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Fri, 23 Jan 2009 14:19:05 +0000 (UTC)</created>
    <updated>Thu, 9 Apr 2009 21:56:40 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12666548" author="rnewson" created="Fri, 23 Jan 2009 14:36:54 +0000 (UTC)"  >According to Wikipedia (&lt;a href=&quot;http://en.wikipedia.org/wiki/Sparse_file&quot;&gt;http://en.wikipedia.org/wiki/Sparse_file&lt;/a&gt;) HFS+ does not support sparse files.</comment>
                    <comment id="12695852" author="rnewson" created="Sun, 5 Apr 2009 12:20:14 +0000 (UTC)"  >// Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;); you may not&lt;br/&gt;
// use this file except in compliance with the License.  You may obtain a copy&lt;br/&gt;
// of the License at&lt;br/&gt;
//&lt;br/&gt;
//   &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
//&lt;br/&gt;
// Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
// distributed under the License is distributed on an &amp;quot;AS IS&amp;quot; BASIS, WITHOUT&lt;br/&gt;
// WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the&lt;br/&gt;
// License for the specific language governing permissions and limitations under&lt;br/&gt;
// the License.&lt;br/&gt;
&lt;br/&gt;
couchTests.attachment_sparseness= function(debug) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var db = new CouchDB(&amp;quot;test_suite_db&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.createDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (debug) debugger;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;for (i = 0; i &amp;lt; 1000; i++) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var binAttDoc = {&lt;br/&gt;
	  _id: (i).toString(),&lt;br/&gt;
	  _attachments:{&lt;br/&gt;
	      &amp;quot;foo.txt&amp;quot;: {&lt;br/&gt;
		  content_type:&amp;quot;text/plain&amp;quot;,&lt;br/&gt;
		  data: &amp;quot;VGhpcyBpcyBhIGJhc2U2NCBlbmNvZGVkIHRleHQ=&amp;quot;&lt;br/&gt;
	      }&lt;br/&gt;
	  }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var save_response = db.save(binAttDoc);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(save_response.ok);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var before = db.info().disk_size;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// Compact it.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(db.compact().ok);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(db.last_req.status == 202);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// compaction isn&apos;t instantaneous, loop until done&lt;br/&gt;
&amp;nbsp;&amp;nbsp;while (db.info().compact_running) {};&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var after = db.info().disk_size;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// Compaction should reduce the database slightly, but not&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// orders of magnitude (unless attachments introduce sparseness)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(after &amp;gt; before * 0.1, &amp;quot;database shrunk massively after compaction.&amp;quot;);&lt;br/&gt;
&lt;br/&gt;
};</comment>
                    <comment id="12695890" author="rnewson" created="Sun, 5 Apr 2009 19:22:00 +0000 (UTC)"  >It appears that the .couch file is extended by 64k every time a document is added (regardless of whether the document is a few hundred bytes).&lt;br/&gt;
&lt;br/&gt;
Chatting with davisp, transcript below;&lt;br/&gt;
(&lt;br/&gt;
18:27:14) davisp: got that test handy so you can run it after a slight tweak to couchdb?&lt;br/&gt;
(18:27:46) rnewson: the sparseness one? yep.&lt;br/&gt;
(18:27:53) davisp: rnewson: line 41 in couchdb_stream.erl&lt;br/&gt;
(18:28:11) davisp: Try changing that from 16#000010000 to 1&lt;br/&gt;
(18:28:39) rnewson: min_alloc, yes?&lt;br/&gt;
(18:28:39) davisp: Not sure if that&apos;ll break things or not&lt;br/&gt;
(18:28:44) rnewson: we&apos;ll soon know.&lt;br/&gt;
(18:28:49) davisp: But I ran across it when reading&lt;br/&gt;
(18:28:55) davisp: rnewson: yep on min alloc&lt;br/&gt;
(18:29:12) rnewson: yes, that did it.&lt;br/&gt;
&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
(18:34:14) rnewson: davisp: I&apos;m glad you did, the difference is dramatic, I&apos;d say this is the cause of the behavior I see.&lt;br/&gt;
(18:34:36) davisp: It could be that couch_stream has a bug that&apos;s preventing it from using leftover space&lt;br/&gt;
(18:34:43) rnewson: davisp: As I said, I actually hit the ext3 max-file-size with this problem.&lt;br/&gt;
(18:35:10) davisp: Ie, The 65K is intendeded to be used by multiple documents, but book keeping is saying to constantly create new buffers&lt;br/&gt;
&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
(19:01:00) davisp: rnewson: It just looks like the buffer state for.... oh dear god&lt;br/&gt;
(19:01:11) vmx: davisp: yes i get the idea, and the final output (e.g. in a browsers) seems to be right, but the internal representation seems a bit confusing&lt;br/&gt;
(19:01:20) rnewson: davisp: epiphany?&lt;br/&gt;
(19:01:49) davisp: rnewson: I wonder if its only holding buffer state for the durating of a single request. Try adding two attachments with the same data&lt;br/&gt;
&lt;br/&gt;
...&lt;br/&gt;
(19:10:23) davisp: It looks like a consequence of the necessary code for streaming files that didn&apos;t specify a content-length&lt;br/&gt;
(19:10:45) davisp: rnewson: Looks like ensure_buffer needs a flag&lt;br/&gt;
(19:13:01) davisp: rnewson: My guess is that you&apos;d want to add a flag in the accumulator on the PreAllocSize fold function that says if you have touched the clause that has an unknown length&lt;br/&gt;
(19:13:21) davisp: then pass that flag to ensure_buffer and if the flag is true in ensure_buffer you allocate exactly the specified size.&lt;br/&gt;
(19:13:30) davisp: instead of the MinSize bit&lt;br/&gt;
(19:13:49) rnewson: makes sense.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12695893" author="paul.joseph.davis" created="Sun, 5 Apr 2009 19:27:52 +0000 (UTC)"  >You forgot to mention the part where I said that I have absolutely no idea if MinSize is important for some other part of the code ;)&lt;br/&gt;
&lt;br/&gt;
Also, it looks like if we add a check in couch_db:doc_flush_binaries/2 to see if we&apos;re not streaming an attachment of unknown length, and then pass that information to couch_stream:ensure_buffer/2 so that couch_stream can decide if it wants to allocate exactly the requested amount or some extra it&apos;d solve the issue. The patch should be relatively trivial, but like I said, I have no idea if there is other important stuff going on there or not.</comment>
                    <comment id="12695898" author="rnewson" created="Sun, 5 Apr 2009 19:37:03 +0000 (UTC)"  >I wanted to capture the thread, so that others will have a fuller context.&lt;br/&gt;
&lt;br/&gt;
I don&apos;t think we&apos;ve found the source yet. For example, I commented out the ensure_buffer call and I still get the problem, so I don&apos;t think adding the flag you suggested will actually help. </comment>
                    <comment id="12695902" author="paul.joseph.davis" created="Sun, 5 Apr 2009 19:44:53 +0000 (UTC)"  >That&apos;s because the call to couch_file:expand/3 isn&apos;t happening until the call to couch_stream:write/2 which makes the patch slightly less trivial than I thought, but not that much harder.</comment>
                    <comment id="12695938" author="rnewson" created="Sun, 5 Apr 2009 23:23:21 +0000 (UTC)"  >&lt;br/&gt;
Don&apos;t force 64k inflation, test to demonstrate lack of sparseness.</comment>
                    <comment id="12695940" author="paul.joseph.davis" created="Sun, 5 Apr 2009 23:41:01 +0000 (UTC)"  >I think we need a slight change in case someone lies to us:&lt;br/&gt;
&lt;br/&gt;
From:&lt;br/&gt;
+    case NextAlloc of&lt;br/&gt;
+	0 -&amp;gt; NewSize = lists:max([MinAlloc, size(Bin)]);&lt;br/&gt;
+	_ -&amp;gt; NewSize = NextAlloc&lt;br/&gt;
+    end,&lt;br/&gt;
&lt;br/&gt;
To:&lt;br/&gt;
+    case NextAlloc of&lt;br/&gt;
+	0 -&amp;gt; NewSize = lists:max([MinAlloc, size(Bin)]);&lt;br/&gt;
+	_ -&amp;gt; NewSize = lists:max([NextAlloc, size(Bin)])&lt;br/&gt;
+    end,&lt;br/&gt;
&lt;br/&gt;
Otherwise we could end up writing beyond the allocated space if something gets confused.</comment>
                    <comment id="12696006" author="enda.farrell" created="Mon, 6 Apr 2009 08:36:37 +0000 (UTC)"  >I have been trying out the operational behaviour of the 0.8x release and noticed something similar to the original posting.&lt;br/&gt;
&lt;br/&gt;
The filesystem type is ext3, but the scenario is different in that there were no attachments involved. When 1.5 million 9k docs are added *in a random fashion* the .couch file ended up at 110 GB. After compaction, this reduced to a more expected 14GB. &lt;br/&gt;
&lt;br/&gt;
A similar test will be run again soon using the 0.9x release.&lt;br/&gt;
&lt;br/&gt;
/e&lt;br/&gt;
&lt;br/&gt;
* in a random fashion is to mean that the key within the single database is a Perl random number. 4 writers were populating the DB, and some key collissions were expected.</comment>
                    <comment id="12696859" author="jchris" created="Wed, 8 Apr 2009 01:26:20 +0000 (UTC)"  >I applied Robert&apos;s patch (benchmarking before and after with multiple methods) and saw very little change. I then also applied the IRC suggestion (set min_alloc=1 instead of 64kb), and saw substantial speedups as well as much tighter file sizes. &lt;br/&gt;
&lt;br/&gt;
Summary of my benchmarks:&lt;br/&gt;
&lt;br/&gt;
Bulk_docs posts of 1000 docs (roughly 100bytes each) did not seem to be effected by this patch at all.&lt;br/&gt;
&lt;br/&gt;
However, loading docs in (using a custom erlang loader) where each doc has a 4kb attachment (100 concurrent writers, with docs committed in batches of 10) I saw the big improvements. Here&apos;s what I saw after running my loader for 30 seconds:&lt;br/&gt;
&lt;br/&gt;
Before the patch:&lt;br/&gt;
&lt;br/&gt;
db-file-size: 364.8 MB&lt;br/&gt;
docs: 5690&lt;br/&gt;
bytes/doc = 67229.25 (thats more than 10x wasted space)&lt;br/&gt;
doc/sec = 190&lt;br/&gt;
&lt;br/&gt;
After the patch:&lt;br/&gt;
&lt;br/&gt;
db-file-size: 76.15 MB&lt;br/&gt;
docs: 13340 (wow, more than twice as many in the same amount of time!)&lt;br/&gt;
bytes / doc = 5985.45 (this is a better size for sure)&lt;br/&gt;
docs / sec = 445&lt;br/&gt;
&lt;br/&gt;
I&apos;ve attached the changes I made (stream.diff). I&apos;m hoping Damien can look at it before we apply it to trunk. It seems strange that bypassing min-alloc would make such a big difference, maybe there&apos;s a better answer we don&apos;t see.&lt;br/&gt;
</comment>
                    <comment id="12696888" author="paul.joseph.davis" created="Wed, 8 Apr 2009 04:52:14 +0000 (UTC)"  >Chris,&lt;br/&gt;
&lt;br/&gt;
First, I&apos;m pretty certain that this bug is only affecting document writes that include an attachment. &lt;br/&gt;
&lt;br/&gt;
You should check if your erlang loader is getting the proper attachment information all the way down into couch_db:doc_flush_binaries. My first haphazard guess is that its not. My second random guess is you could be seeing the same bug from a different code path. Also, there&apos;s another slight tweak to the patch to only go to the 65K allocation when there&apos;s a binary of unknown size.&lt;br/&gt;
&lt;br/&gt;
Either way, I&apos;m fairly certain that while changing the min_alloc to a single byte shows that there is a bug, its not the proper fix for the bug.&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12404759" name="220.patch" size="637" author="rnewson" created="Mon, 6 Apr 2009 19:34:50 +0000 (UTC)" />
            <attachment id="12404684" name="220.patch" size="613" author="rnewson" created="Sun, 5 Apr 2009 23:23:21 +0000 (UTC)" />
            <attachment id="12404685" name="attachment_sparseness.js" size="1437" author="rnewson" created="Sun, 5 Apr 2009 23:23:21 +0000 (UTC)" />
            <attachment id="12404910" name="stream.diff" size="854" author="jchris" created="Wed, 8 Apr 2009 01:26:20 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 9 Apr 2009 21:56:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 5 Apr 2009 19:27:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-219] Futon JS test for &apos;config&apos; fails when CouchDB is served behind reverse proxy on default port (80)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-219</link>

                    <description>The config test in the CouchDB JS test suite has a hardcoded assumption that the server port will always be available for use in the test.  However, when CDB is hosted behind a reverse proxy running on default port 80 there will be no such port that is part of the URL.&lt;br/&gt;
&lt;br/&gt;
Although not tested I assume this will also fail when behind an https (TLS) proxy URL.&lt;br/&gt;
&lt;br/&gt;
In this case the test fails showing:&lt;br/&gt;
&lt;br/&gt;
Assertion failed: config.httpd.port == port&lt;br/&gt;
&lt;br/&gt;
The offending line in this test is:&lt;br/&gt;
&lt;br/&gt;
var port = CouchDB.host.split(&amp;quot;:&amp;quot;).pop();&lt;br/&gt;
&lt;br/&gt;
Suggested fix would be to test whether the URL contains a &apos;:&apos;.  If not, then port should be set to 80 or 443 depending on whether the url is an http/https url.&lt;br/&gt;
&lt;br/&gt;
All other tests pass when behind a properly configured proxy.</description>
                <environment>Apache reverse proxy in front of CouchDB</environment>
            <key id="12412961">COUCHDB-219</key>
        <summary>Futon JS test for &apos;config&apos; fails when CouchDB is served behind reverse proxy on default port (80)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="grempe">Glenn Rempe</reporter>
            
    <created>Thu, 22 Jan 2009 05:20:10 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 12:28:40 +0000 (UTC)</updated>

                
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666904" author="janl" created="Sat, 24 Jan 2009 12:28:40 +0000 (UTC)"  >Duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-213&quot; title=&quot;config test failure for ports 80 and 443&quot;&gt;&lt;strike&gt;COUCHDB-213&lt;/strike&gt;&lt;/a&gt;. Closed in r737346.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                            <outwardlinks description="duplicates">
                            <issuelink>
            <issuekey id="12412682">COUCHDB-213</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:28:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:28:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-218] Name view files by function signature for no-downtime deployments</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-218</link>

                    <description>&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
When a view is altered the .view file is deleted and then recreated. Any query (with update=false) in the interim gets no results even though the results from the old view would have been adequate.&lt;br/&gt;
&lt;br/&gt;
Consider switching the replacement view file in after it&apos;s been rebuilt like db compaction does.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12412916">COUCHDB-218</key>
        <summary>Name view files by function signature for no-downtime deployments</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Wed, 21 Jan 2009 15:42:04 +0000 (UTC)</created>
    <updated>Sat, 4 Jul 2009 15:48:26 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12679751" author="jchris" created="Fri, 6 Mar 2009 22:47:25 +0000 (UTC)"  >Just had an IRC conversation about this today. Putting it here (mostly for my reference).&lt;br/&gt;
&lt;br/&gt;
The fix will be slightly less automatic than you mention (so we can stay transactional) but I think it will answer the use case. See transcript for details.&lt;br/&gt;
&lt;br/&gt;
basically, if we name view indexes after the view signature, then you can generate them on a non-queried ddoc, and then push those same new views to the active ddoc when the index is built, and it would just start using it. should be not hard to implement.&lt;br/&gt;
&lt;br/&gt;
the pattern (not implemented, requires a couch patch, is to deploy to a &amp;quot;staging&amp;quot; ddoc&lt;br/&gt;
[2:38pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
basically a ddoc that isn&apos;t used by client queries&lt;br/&gt;
[2:38pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
build the index&lt;br/&gt;
[2:39pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
and then push the new code to the production ddoc&lt;br/&gt;
[2:39pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
(with a small couch change I think we can make it flip to the new index transactionally)&lt;br/&gt;
[2:39pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
no downtime&lt;br/&gt;
[2:39pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
I&apos;ll write a jira ticket&lt;br/&gt;
[2:40pm] &amp;lt;mattetti&amp;gt;&lt;br/&gt;
that would be great, rebuilding views can be pretty slow when you have a big db&lt;br/&gt;
[2:40pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
targetting 0.10.0&lt;br/&gt;
[2:40pm] &amp;lt;mattetti&amp;gt;&lt;br/&gt;
let&apos;s get 0.9.0 out first :p&lt;br/&gt;
[2:40pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
in the mean time, version your ddoc names or something&lt;br/&gt;
[2:40pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
if you can&apos;t have downtime&lt;br/&gt;
[2:41pm] &amp;lt;mattetti&amp;gt;&lt;br/&gt;
I can have downtime right now, but I will really need conditional replication soon tho :( is that for 0.9 or 1.0? (or 0.10)&lt;br/&gt;
[2:41pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
won&apos;t make 0.9.0&lt;br/&gt;
[2:41pm] &amp;lt;jchris&amp;gt;&lt;br/&gt;
should be an easy change</comment>
                    <comment id="12719331" author="jchris" created="Sun, 14 Jun 2009 21:01:53 +0000 (UTC)"  >thinking about this patch, I realize the hard part will be deleting un-needed indexes. basically we&apos;ll need to periodically calculate the hashes of all ddocs in a database, and delete any index files who&apos;s names don&apos;t match any of the hashes. this could be triggered on ddoc update asynchronously.&lt;br/&gt;
&lt;br/&gt;
ahh, cache invalidation...</comment>
                    <comment id="12721882" author="jchris" created="Fri, 19 Jun 2009 17:06:35 +0000 (UTC)"  >as long as we&apos;re in there optimizing this stuff, we should make sure that the ddoc signature is generated the same regardless of the order of the views in the JSON document. this should be just a matter of sorting before taking the signature. it will prevent us from invalidating indexes that are actually valid.</comment>
                    <comment id="12721939" author="freddybowen" created="Fri, 19 Jun 2009 19:12:08 +0000 (UTC)"  >Maybe canonical ordering of views consistent with &lt;a href=&quot;http://github.com/jchris/canonical-json&quot;&gt;http://github.com/jchris/canonical-json&lt;/a&gt;&lt;br/&gt;
</comment>
                    <comment id="12727248" author="jchris" created="Sat, 4 Jul 2009 15:48:25 +0000 (UTC)"  >Closed in r791140</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 4 Jul 2009 15:48:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 6 Mar 2009 22:47:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-217] Store Revision of Attachments</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-217</link>

                    <description>&lt;br/&gt;
I&apos;m writing some multi-app hosting thing and besides using couchdb as database it also stores all images and stylesheets and scripts etc for the applications as attachments. I have one couchdb database per app and&lt;br/&gt;
store all resources on a single document to keep the same relative hierarchical structure I have in my apps.&lt;br/&gt;
&lt;br/&gt;
I can now fetch that document and use it to quickly find out the name, lenght and content-type of all my attachments. When the document revision changes I know that at least one of the attachments has changed, but I don&apos;t know which.&lt;br/&gt;
&lt;br/&gt;
Wouldn&apos;t it be possible to store the revision in which the attachment was created with the attachment?&lt;br/&gt;
&lt;br/&gt;
_attachments could then contain these revisions as additional property and couchdb could use that revision as ETag when serving the attachment content which would be better than using the documents revision like it is now. &lt;br/&gt;
&lt;br/&gt;
I don&apos;t know the code, so I don&apos;t know wheter this is possible..</description>
                <environment></environment>
            <key id="12412894">COUCHDB-217</key>
        <summary>Store Revision of Attachments</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="shelmberger">Sven Helmberger</reporter>
            
    <created>Wed, 21 Jan 2009 08:43:19 +0000 (UTC)</created>
    <updated>Tue, 22 Sep 2009 20:28:45 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12665778" author="janl" created="Wed, 21 Jan 2009 10:17:45 +0000 (UTC)"  >A cursory glance at the code reveals the issue: Before writing the document that we attach the attachment (heh) to, we don&apos;t know the revision id of the to-be written document to put into the attachment structure. When we return from writing the document, we know the revision id, but our attachment has been written already and we would need to change it again to put in the new revision id and that would bump the revision id again.&lt;br/&gt;
&lt;br/&gt;
It might be doable a layer further down, but I don&apos;t wont to mess with the core document writing stuff here now :)&lt;br/&gt;
&lt;br/&gt;
For anyone willing to look into this at couch_db:update_docs/4.&lt;br/&gt;
</comment>
                    <comment id="12666860" author="shelmberger" created="Sat, 24 Jan 2009 08:52:05 +0000 (UTC)"  >ok, that&apos;s unfortunate.. &lt;br/&gt;
&lt;br/&gt;
How about not using the document rev but creating a new uuid value just for the new attachment and storing that?&lt;br/&gt;
&lt;br/&gt;
I could still use the UUID to find out that the attachment has changed and you could still use that UUID as Etag.</comment>
                    <comment id="12673540" author="jchris" created="Sat, 14 Feb 2009 19:32:55 +0000 (UTC)"  >I think this ticket is doable, and I especially like the ability to provide per-attachment etags.&lt;br/&gt;
&lt;br/&gt;
However, I think it will require a change to the database file format, so if this is going to happen it should happen for 0.9.&lt;br/&gt;
&lt;br/&gt;
This would be a medium-difficult patch to pull off, so if someone has done some CouchDB internals work and wants to take it to the next level, this is a good opportunity.&lt;br/&gt;
&lt;br/&gt;
You&apos;ll want to see couch_db:doc_flush_binaries/2 for one place the internal attachment metadata is manipulated. There are a few other spots in the source you&apos;d have to touch as well. Just getting the rev onto the attachment metadata is step one. Once that&apos;s happened, using that rev as the etag will be easy.</comment>
                    <comment id="12758417" author="paul.joseph.davis" created="Tue, 22 Sep 2009 20:28:45 +0000 (UTC)"  >Sven says that the new revpos variable associated with attachments is now a functional replacement for the intent of this ticket.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310020">
            <name>Dependants</name>
                                        <inwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12415051">COUCHDB-259</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 22 Sep 2009 20:28:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 21 Jan 2009 10:17:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-216] Make couchdb adhere more to OTP guidelines</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-216</link>

                    <description>CouchDB could adhere to otp standards in a better way. &lt;br/&gt;
Currently we have:&lt;br/&gt;
- couch.app is not uptodate&lt;br/&gt;
- couch_server.erl is an amalgam of 2 behaviours, which is considered being &amp;quot;not good&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
From my beginner&apos;s perception of OTP, it seems CouchDB is not treated as a running application when it is actually running. E.g. appmon doesn&apos;t show the application once CouchDB is started. </description>
                <environment></environment>
            <key id="12412790">COUCHDB-216</key>
        <summary>Make couchdb adhere more to OTP guidelines</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="zeitgeist">Martin S</reporter>
            
    <created>Tue, 20 Jan 2009 05:45:15 +0000 (UTC)</created>
    <updated>Sun, 30 Aug 2009 20:19:25 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12665345" author="zeitgeist" created="Tue, 20 Jan 2009 05:54:25 +0000 (UTC)"  >The three patches were created by GIT and should apply cleanly onto github&apos;s couchdb as of 76b1dd9bffe80eeabe5135c170f6d9527cf1e4f1 / &lt;a href=&quot;http://svn.apache.org/repos/asf/couchdb/trunk@735875&quot;&gt;http://svn.apache.org/repos/asf/couchdb/trunk@735875&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
The same changes are part of branch merge/otp at &lt;a href=&quot;http://github.com/zeitgeist/couchdb&quot;&gt;http://github.com/zeitgeist/couchdb&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12665393" author="zeitgeist" created="Tue, 20 Jan 2009 10:25:39 +0000 (UTC)"  >jan___ / #couchdb told me that the release-file way of starting would break things on erlang upgrade. </comment>
                    <comment id="12679055" author="bbrowning" created="Thu, 5 Mar 2009 03:22:50 +0000 (UTC)"  >&lt;br/&gt;
The modules section of couch.app was outdated. Instead of updating it manually, I&apos;ve modified the Makefile to populate this based on the modules actually present when building. This should keep it from getting out of date in the future.</comment>
                    <comment id="12688330" author="jchris" created="Mon, 23 Mar 2009 17:08:28 +0000 (UTC)"  >It&apos;s generally agreed that we should make CouchDB more OTP-like. &lt;br/&gt;
&lt;br/&gt;
I&apos;m not sure about the implementation or the timeline for doing it, but I think it&apos;s the best path to auto-sharding.</comment>
                    <comment id="12741234" author="paul.joseph.davis" created="Mon, 10 Aug 2009 08:52:19 +0000 (UTC)"  >This tarball includes a script and a patch to update the CouchDB source tree fairly extensively. Among the important bits:&lt;br/&gt;
&lt;br/&gt;
The root directory now follows the: &amp;quot;src, ebin, priv, include&amp;quot; structure. The dependencies are pushed into a deps directory and each dependency gets the &amp;quot;src/ebin/include&amp;quot; treatement.&lt;br/&gt;
&lt;br/&gt;
the main CouchDB source directory has been split into a handful of directories to start organizing the modules by related functionality. This pattern is copied from the monaco application in the stdlib.&lt;br/&gt;
&lt;br/&gt;
couchspawnkillable and couchjs are now in priv/bin. couchjs still gets its /usr/local/bin script.&lt;br/&gt;
&lt;br/&gt;
couch_erl_driver is in priv/lib where it should be. I think we should be able to even remove the paths when loading this, but again I&apos;d want to double check on whether someone might have a reason for installing this elsewhere.&lt;br/&gt;
&lt;br/&gt;
I started building beam files with a call to make:all() within Erlang. This actually builds stuff quite a bit faster and so far is pretty useful. That said it kind of doesn&apos;t fit into the Autotools process because it never rebuilds beam files on change because the call is never triggered because I couldn&apos;t figure out how to add the proper dependency.&lt;br/&gt;
&lt;br/&gt;
Also, there&apos;s a weirdness in that I symlink deps/couch to the root directory so that ./utils/run can work with ERL_LIBS instead of four specifications of -pa.&lt;br/&gt;
&lt;br/&gt;
Anyway, this is an initial layout.</comment>
                    <comment id="12743921" author="rnewson" created="Sun, 16 Aug 2009 22:52:34 +0000 (UTC)"  >&lt;br/&gt;
Consider making couchdb sufficiently OTP-like to support zero time &apos;hot&apos; upgrades between releases.</comment>
                    <comment id="12748093" author="kocolosk" created="Wed, 26 Aug 2009 19:17:56 +0000 (UTC)"  >Here&apos;s an updated patch inspired by Martin&apos;s and Ben&apos;s work.  It stops short using a boot file to start CouchDB; hopefully that allays some of Jan&apos;s concerns regarding a build surviving an Erlang VM upgrade.  Highlights:&lt;br/&gt;
&lt;br/&gt;
- remove application behavior from couch_server and add it to couch_app instead&lt;br/&gt;
- starts/stops the server using OTP application controls&lt;br/&gt;
- couch.erl convenience module exports start(), stop(), restart(), reload()&lt;br/&gt;
- modules list in couch.app auto-generated using Ben&apos;s scary sed command&lt;br/&gt;
- server startup command in shell script is *much* simpler now&lt;br/&gt;
&lt;br/&gt;
I don&apos;t know if anyone was using couch_server:dev_start(), but I tried to update that correctly, too.&lt;br/&gt;
&lt;br/&gt;
Finally, I dropped `icu-config --invoke` from the startup command.  In my experience couch finds the ICU libraries just fine without it, and it causes serious problems on Mac OS X when MacPorts is used to satisfy dependencies.  In particular, it utterly breaks couchdb-lucene.</comment>
                    <comment id="12748794" author="kocolosk" created="Fri, 28 Aug 2009 11:57:45 +0000 (UTC)"  >A future improvement in this area would be to include crypto, ibrowse, mochiweb, etc. in couch&apos;s supervision tree.  At the moment we just start them if they&apos;re not already started and leave them running if couch stops.  That&apos;s not what OTP intends by &amp;quot;included_applications&amp;quot; in the .app file.</comment>
                    <comment id="12748839" author="nslater" created="Fri, 28 Aug 2009 14:55:11 +0000 (UTC)"  >There is no point updating the app file until Erlang has a way of not breaking applications on upgrade.</comment>
                    <comment id="12748844" author="paul.joseph.davis" created="Fri, 28 Aug 2009 15:02:18 +0000 (UTC)"  >Noah,&lt;br/&gt;
&lt;br/&gt;
I think you mean the rel file. The app file is a description of the application and isn&apos;t tied to the Erlang VM. I don&apos;t have any experience with Erlang&apos;s release tools, but I&apos;d agree that if it binds to a specific VM then at most we should just provide a non-standard make target to produce a release.&lt;br/&gt;
&lt;br/&gt;
Keeping the app file up to date *is* a priority as it&apos;s used for other things like detecting conflicting registered processes.</comment>
                    <comment id="12748845" author="kocolosk" created="Fri, 28 Aug 2009 15:04:38 +0000 (UTC)"  >Hmm, some folks might be packaging CouchDB as part of an Erlang release, in which case they&apos;ll be aware of the Erlang version issue.  I know at least one person who does this :-)&lt;br/&gt;
&lt;br/&gt;
I think maintaining the .app file is generally a sign of good behavior.  That said, if we&apos;re committed to not maintaining it we should remove it from the distribution.</comment>
                    <comment id="12748860" author="paul.joseph.davis" created="Fri, 28 Aug 2009 15:37:16 +0000 (UTC)"  >I&apos;d agree that people doing releases are probably advanced enough to know what they&apos;re getting into. Unless someone can figure out a sane way to make releases work, I don&apos;t think its something we should worry too much about.&lt;br/&gt;
&lt;br/&gt;
To me, removing the .app file is unacceptable. The fact that its broken is just a reminder that we&apos;ve been Doing It Wrong and should fix things, not break them even further.</comment>
                    <comment id="12749296" author="kocolosk" created="Sun, 30 Aug 2009 18:03:10 +0000 (UTC)"  >Mark, can you take a look and see how badly I broke the Windows build with this patch?  I updated couchdb.bat.tpl.in but I don&apos;t know if the build system actually loads the correct paths into the .app file on Windows.</comment>
                    <comment id="12749298" author="rnewson" created="Sun, 30 Aug 2009 18:15:12 +0000 (UTC)"  >broken on Ubuntu as basename doesn&apos;t accept -s&lt;br/&gt;
&lt;br/&gt;
from src/couchdb/Makefile.am&lt;br/&gt;
&lt;br/&gt;
couch.app: couch.app.tpl&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;modules=`find . -name &amp;quot;*.erl&amp;quot; -exec basename -s .erl {} \; | tr &apos;\n&apos; &apos;,&apos; | sed &amp;quot;s/,$$//&amp;quot;`; \&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&lt;br/&gt;
basename: invalid option -- &apos;s&apos;&lt;br/&gt;
Try `basename --help&apos; for more information.&lt;br/&gt;
</comment>
                    <comment id="12749299" author="nslater" created="Sun, 30 Aug 2009 18:16:26 +0000 (UTC)"  >&amp;quot;I think you mean the rel file.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Yes, I did.&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Keeping the app file up to date *is* a priority as it&apos;s used for other things like detecting conflicting registered processes.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Really does it do anything concrete for us? It seems like a very silly and pointless file to me.&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Hmm, some folks might be packaging CouchDB as part of an Erlang release, in which case they&apos;ll be aware of the Erlang version issue.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
I was packaging CouchDB as part of the Debian Erlang packages, and unless you tie the CouchDB package to a specific version of the Erlang package, and update them in tandem, you&apos;re hosed.&lt;br/&gt;
&lt;br/&gt;
&amp;quot;To me, removing the .app file is unacceptable. The fact that its broken is just a reminder that we&apos;ve been Doing It Wrong and should fix things, not break them even further.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
The fact that we&apos;ve only just noticed should indicate that it probably doesn&apos;t matter.</comment>
                    <comment id="12749315" author="paul.joseph.davis" created="Sun, 30 Aug 2009 20:01:12 +0000 (UTC)"  >There are quite a few Erlang tools that require the .app file to be present. Things like application:start(couchdb) require it. I&apos;m pretty sure appmon requires it. It may seem unimportant but it breaks a whole bunch of things. Consider not having a .app file like not having a setup.py in a distributed Python module.&lt;br/&gt;
&lt;br/&gt;
The .rel stuff I think is orthogonal to making a package for Debian. From what I&apos;ve read about Erlang&apos;s release tools, it seems like they were designed for pushing packages to a homogenous environment for hot code upgrades and the like. As you saw, that kinda breaks down in a Debian style distribution environment.&lt;br/&gt;
&lt;br/&gt;
Bottom line, the .rel is unimportant, but the .app is quite important.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12749316" author="kocolosk" created="Sun, 30 Aug 2009 20:11:14 +0000 (UTC)"  >Thanks Robert, hopefully fixed in r809407&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12749318" author="paul.joseph.davis" created="Sun, 30 Aug 2009 20:19:25 +0000 (UTC)"  >This patch breaks ./utils/run because of the use of ERL_LIBS now which is incompatible with how our source directory is setup. Quickest fix I can think of would be to get a copy of the old couchdb.tpl.in and use that for the utils/run. Longer term when we get around to cleaning up the tree we can revert back to using couchdb.tpl</comment>
                </comments>
    
    <attachments>
            <attachment id="12398287" name="0001-add-couch_app-and-couch_sup.patch" size="8541" author="zeitgeist" created="Tue, 20 Jan 2009 05:54:25 +0000 (UTC)" />
            <attachment id="12401480" name="0001-Generate-the-modules-section-of-couch.app-via-the-Ma.patch" size="2196" author="bbrowning" created="Thu, 5 Mar 2009 03:22:50 +0000 (UTC)" />
            <attachment id="12398288" name="0002-add-missing-registered-process-names.patch" size="886" author="zeitgeist" created="Tue, 20 Jan 2009 05:54:25 +0000 (UTC)" />
            <attachment id="12398289" name="0003-make-couchdb-startup-script-use-couch.rel.-load-conf.patch" size="5958" author="zeitgeist" created="Tue, 20 Jan 2009 05:54:25 +0000 (UTC)" />
            <attachment id="12417773" name="couch_startup_refactor.patch" size="9226" author="kocolosk" created="Wed, 26 Aug 2009 19:17:56 +0000 (UTC)" />
            <attachment id="12416033" name="rearrange.tar.gz" size="7005" author="paul.joseph.davis" created="Mon, 10 Aug 2009 08:52:19 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 5 Mar 2009 03:22:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-215] errors when creating and deleting multiple databases</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-215</link>

                    <description>creating multiple databases and then deleting them causes couchdb to start throwing exceptions ( &lt;a href=&quot;http://gist.github.com/49063&quot;&gt;http://gist.github.com/49063&lt;/a&gt; ) A cursory debugging session indicates that should_close in couch_file never returns true, the monitors list always contains the pid of the next process. Repeated use of the server in this way eventually makes it unusable.&lt;br/&gt;
&lt;br/&gt;
The following JS, &lt;a href=&quot;http://gist.github.com/48465,&quot;&gt;http://gist.github.com/48465,&lt;/a&gt; will also exhibit the issue using the Futon tests. It can appear with as few as 60 dbs depending on the client and level of concurrency&lt;br/&gt;
&lt;br/&gt;
The database names do have slashes in them but this seems irrelevant on the face of it.</description>
                <environment>OS X 10.4 Erlang latest, CouchDB trunk</environment>
            <key id="12412770">COUCHDB-215</key>
        <summary>errors when creating and deleting multiple databases</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Mon, 19 Jan 2009 19:48:04 +0000 (UTC)</created>
    <updated>Mon, 19 Jan 2009 21:08:41 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 19 Jan 2009 21:08:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-214] Futon doesn&apos;t handle slashes in doc store names</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-214</link>

                    <description>create a doc store with names &amp;quot;foo/bar&amp;quot;  and then save a custom query for it</description>
                <environment>OS X, Safari, Firefox</environment>
            <key id="12412737">COUCHDB-214</key>
        <summary>Futon doesn&apos;t handle slashes in doc store names</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Mon, 19 Jan 2009 11:36:49 +0000 (UTC)</created>
    <updated>Wed, 21 Jan 2009 20:13:32 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12665256" author="jchris" created="Mon, 19 Jan 2009 22:22:53 +0000 (UTC)"  >fixed in r735850</comment>
                    <comment id="12665405" author="dionne" created="Tue, 20 Jan 2009 11:15:01 +0000 (UTC)"  >Chris,&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;This is not entirely fixed. From overview, select a db with  &lt;br/&gt;
slashes in the name, look at a few views, go back to overview and  &lt;br/&gt;
select the db again. It throws exceptions.&lt;br/&gt;
&lt;br/&gt;
Cheers,&lt;br/&gt;
&lt;br/&gt;
Bob&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12665943" author="cmlenz" created="Wed, 21 Jan 2009 19:59:30 +0000 (UTC)"  >The rest of the issues are in Futon, I think. I&apos;ll look into them.</comment>
                    <comment id="12665952" author="cmlenz" created="Wed, 21 Jan 2009 20:13:32 +0000 (UTC)"  >The Futon side should now be fixed in r736400.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 21 Jan 2009 20:13:32 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 19 Jan 2009 22:22:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-213] config test failure for ports 80 and 443</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-213</link>

                    <description>In the config test this assertion:&lt;br/&gt;
&lt;br/&gt;
T(config.httpd.port == port);&lt;br/&gt;
&lt;br/&gt;
depends on the line:&lt;br/&gt;
&lt;br/&gt;
var port = CouchDB.host.split(&amp;quot;:&amp;quot;).pop();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;But there&apos;s no :port on when running on 80 and 443. If config.httpd.port == 80 or 443 the port assertion should be skipped (and perhaps the protocol path part checked for http:// or &lt;a href=&quot;https://)&quot;&gt;https://)&lt;/a&gt;</description>
                <environment></environment>
            <key id="12412682">COUCHDB-213</key>
        <summary>config test failure for ports 80 and 443</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="deanlandolt">Dean Landolt</reporter>
            
    <created>Sat, 17 Jan 2009 19:37:21 +0000 (UTC)</created>
    <updated>Tue, 17 Feb 2009 18:25:48 +0000 (UTC)</updated>

                
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666902" author="janl" created="Sat, 24 Jan 2009 12:27:31 +0000 (UTC)"  >Closed as of r737346</comment>
                    <comment id="12667049" author="grempe" created="Sun, 25 Jan 2009 06:29:45 +0000 (UTC)"  >I have updated my couchdb, which sits behind a proxy, and I am still seeing the same behavior.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://couchdb.rempe.org/_utils/couch_tests.html?script/couch_tests.js&quot;&gt;http://couchdb.rempe.org/_utils/couch_tests.html?script/couch_tests.js&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
This instance was built from source with commit ID &lt;a href=&apos;mailto:trunk@737346&apos;&gt;trunk@737346&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I can give you admin access for this instance.  Please contact me by email and I&apos;ll give you a password if you&apos;d like to use it for testing.&lt;br/&gt;
&lt;br/&gt;
I am still seeing the error message:&lt;br/&gt;
&lt;br/&gt;
# Assertion failed: config.httpd.port == port&lt;br/&gt;
&lt;br/&gt;
And I have confirmed that the new test is the one that is running.  I ran this in FireFox (latest) on Mac OS X.  I cleared cache before running.&lt;br/&gt;
&lt;br/&gt;
Perhaps this line is not evaluating correctly?  In which case I think the behavior would be identical to the old (broken) behavior.&lt;br/&gt;
&lt;br/&gt;
if(server_port.length == 1 &amp;amp;&amp;amp; CouchDB.inBrowser) {&lt;br/&gt;
&lt;br/&gt;
Please re-open.&lt;br/&gt;
&lt;br/&gt;
Thanks.</comment>
                    <comment id="12674289" author="janl" created="Tue, 17 Feb 2009 18:25:48 +0000 (UTC)"  >We could just drop the test for the port number as we are testing other config items as well that should pass. We probably should have done this in the first place. Any objections?</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                                        <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12412961">COUCHDB-219</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:27:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:27:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-212] tests fail running standalone with runner</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-212</link>

                    <description>some of the urls in the tests are encoded to escape slashes. This causes the curl library to return 301 error codes and dbs fail to open, etc..&lt;br/&gt;
&lt;br/&gt;
tweaked couch_js.c to add CURLOPT_FOLLOWLOCATION</description>
                <environment>OS X</environment>
            <key id="12412587">COUCHDB-212</key>
        <summary>tests fail running standalone with runner</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Fri, 16 Jan 2009 12:23:36 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 11:49:08 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12664504" author="dionne" created="Fri, 16 Jan 2009 12:25:23 +0000 (UTC)"  >added followlocation option to handle 301s</comment>
                    <comment id="12664820" author="dionne" created="Sat, 17 Jan 2009 11:20:36 +0000 (UTC)"  >PUT requests now require file size be sent to couchdb for the new streaming stuff</comment>
                    <comment id="12666893" author="janl" created="Sat, 24 Jan 2009 11:49:08 +0000 (UTC)"  >Applied in r737335. Thanks Bob.</comment>
                </comments>
    
    <attachments>
            <attachment id="12398139" name="couch_js.c.diff" size="1540" author="dionne" created="Sat, 17 Jan 2009 11:20:36 +0000 (UTC)" />
            <attachment id="12398059" name="couch_js.c.diff" size="566" author="dionne" created="Fri, 16 Jan 2009 12:25:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:49:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:49:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-211] Can&apos;t add attachments in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-211</link>

                    <description>The attachments popover is failing to submit with the error&lt;br/&gt;
&lt;br/&gt;
Error: Form elements must not be named &amp;quot;submit&amp;quot;.</description>
                <environment>Windows Firefox 3.0.5&lt;br/&gt;
CouchDB 0.9.0a734451-incubating</environment>
            <key id="12412540">COUCHDB-211</key>
        <summary>Can&apos;t add attachments in Futon</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="deanlandolt">Dean Landolt</reporter>
            
    <created>Thu, 15 Jan 2009 22:59:37 +0000 (UTC)</created>
    <updated>Fri, 16 Jan 2009 10:10:59 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12664458" author="cmlenz" created="Fri, 16 Jan 2009 10:10:59 +0000 (UTC)"  >Fixed by upgrading jquery.form plugin in r734953</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 16 Jan 2009 10:10:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 16 Jan 2009 10:10:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-210] javascript errors in Futon with firefox 3.0.5</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-210</link>

                    <description>At least at svn r734360, the drop-down items to toggle between &apos;all documents&apos;, &apos;design documents&apos; and &apos;custom query&apos; all fail (nothing happens).  Firefox&apos;s error console shows this;&lt;br/&gt;
&lt;br/&gt;
&amp;quot;console is not defined&amp;quot; and points to line 86;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;$(&amp;quot;#switch select&amp;quot;).change(function() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var viewName = $(this).val();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;console.log(viewName);  &amp;lt;----------- line 86&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (!viewName) $.cookies.remove(page.db.name + &amp;quot;.view&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;location.href = &amp;quot;?&amp;quot; + encodeURIComponent(page.db.name) +&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(viewName ? &amp;quot;/&amp;quot; + encodeURIComponent(viewName)  : &amp;quot;&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;});&lt;br/&gt;
&lt;br/&gt;
Additionally, error console shows this, but I think it&apos;s unrelated;&lt;br/&gt;
&lt;br/&gt;
Warning: Expected &apos;,&apos; or &apos;{&apos; but found &apos;html&apos;.  Ruleset ignored due to bad selector.&lt;br/&gt;
Source File: &lt;a href=&quot;http://localhost:5984/_utils/style/layout.css?0.9.0&quot;&gt;http://localhost:5984/_utils/style/layout.css?0.9.0&lt;/a&gt;&lt;br/&gt;
Line: 217&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Debian Lenny, Iceweasel 3.0.5</environment>
            <key id="12412361">COUCHDB-210</key>
        <summary>javascript errors in Futon with firefox 3.0.5</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rnewson">Robert Newson</reporter>
            
    <created>Wed, 14 Jan 2009 09:57:03 +0000 (UTC)</created>
    <updated>Wed, 14 Jan 2009 10:48:11 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12663704" author="cmlenz" created="Wed, 14 Jan 2009 10:05:49 +0000 (UTC)"  >This was already fixed in r733315.</comment>
                    <comment id="12663712" author="rnewson" created="Wed, 14 Jan 2009 10:18:38 +0000 (UTC)"  >r734360 is later than r733315, I think. I still see this. I&apos;ve done a &apos;make uninstall&apos;, &apos;make clean&apos;, make install cycle to confirm nothing was lingering from an old install.&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB 0.9.0a734360-incubating (LogLevel=info) is starting.&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12663714" author="rnewson" created="Wed, 14 Jan 2009 10:22:06 +0000 (UTC)"  >ok, I figured it out. firefox has cached the javascript files, forcing a refresh with CTRL+R resolved it.</comment>
                    <comment id="12663722" author="shelmberger" created="Wed, 14 Jan 2009 10:48:11 +0000 (UTC)"  >Wouldn&apos;t it be good to ship with a minimal dummy implementation of firebug&apos;s console API to prevent this class of errors. That could be as simple as:&lt;br/&gt;
&lt;br/&gt;
if (!this.console)&lt;br/&gt;
{&lt;br/&gt;
var dummyFn = function() { };&lt;br/&gt;
this.console = { &amp;quot;debug&amp;quot;: dummyFn, &amp;quot;info&amp;quot; : dummyFn, &amp;quot;error&amp;quot;: dummyFn, &amp;quot;warn&amp;quot;: dummyFn};&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
if you just want to swallow all console calls. you could of course just as well collect them and present them in some minimal way to ease debugging of problems within futon.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 14 Jan 2009 10:05:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 14 Jan 2009 10:05:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-209] Refine httpd_db_handlers API to map the externals from paths directly to scripts</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-209</link>

                    <description>We could change the API to map the externals from paths directly to&lt;br/&gt;
scripts, like&lt;br/&gt;
&lt;br/&gt;
[httpd_db_handlers]&lt;br/&gt;
_mypath = {couch_httpd_external, handle_external_req, &amp;quot;/path/to/my/script&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
which would be fine by me.&lt;br/&gt;
&lt;br/&gt;
The current code is like it is because the original implementation was&lt;br/&gt;
designed to have multiple scripts mounted at the /db/_external path.&lt;br/&gt;
&lt;br/&gt;
Do you mind opening a ticket about this? - I&apos;m happy to write the code&lt;br/&gt;
but I&apos;m supposed to be working on the book right now, so it&apos;ll have to&lt;br/&gt;
wait.&lt;br/&gt;
link to mail list thread:&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-user/200901.mbox/%3C5aaed53f0901120631v112916eewcc50e96c44728a3d@mail.gmail.com%3E&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-user/200901.mbox/%3C5aaed53f0901120631v112916eewcc50e96c44728a3d@mail.gmail.com%3E&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
It would appear to be a good solution to allow the flexibility desired while narrowing the number of local.ini edits to accomplish.</description>
                <environment>all</environment>
            <key id="12412263">COUCHDB-209</key>
        <summary>Refine httpd_db_handlers API to map the externals from paths directly to scripts</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="dundeemt">Jeff Hinrichs</reporter>
            
    <created>Tue, 13 Jan 2009 03:17:51 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666891" author="janl" created="Sat, 24 Jan 2009 11:42:21 +0000 (UTC)"  >API change. Mark blocking for 0.9 and assign to Chris Anderson.</comment>
                    <comment id="12670998" author="paul.joseph.davis" created="Fri, 6 Feb 2009 04:01:30 +0000 (UTC)"  >I&apos;ve been thinking about this ticket for a bit. I understand the desire to minimize the number of INI edits etc, but something keeps bothering me about removing the [external] section entirely.&lt;br/&gt;
&lt;br/&gt;
Also, is this really 0.9 blocking? I would vote that this isn&apos;t an API incompatibility.</comment>
                    <comment id="12680541" author="jchris" created="Tue, 10 Mar 2009 17:15:46 +0000 (UTC)"  >I think I agree with Paul - I&apos;m not exactly sure what I&apos;d change here...&lt;br/&gt;
&lt;br/&gt;
I think this may be tied up in the larger refactor of show/list and OTPification of CouchDB into different applications. I&apos;m moving this ticket from 0.9&lt;br/&gt;
&lt;br/&gt;
If you&apos;re using _external and you have a concrete proposal (for how you&apos;d like configuration to be different, please attach a well-commented ini file that illustrates the difference between how it is now, and how you&apos;d like it to be.)&lt;br/&gt;
&lt;br/&gt;
Maybe this ticket is just asking for something simple, but I&apos;m having a hard time wrapping my head around exactly what.</comment>
                    <comment id="12772661" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:42:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-208] Futon, add warning during database deletion that custom queries also deleted</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-208</link>

                    <description>It is not obvious that custom queries are stored in a database and that custom queries (for that database) are deleted when the database is deleted.&lt;br/&gt;
&lt;br/&gt;
Suggestion is to add a warning in Futon to advise that all custom queries (for that database) will also be deleted when a database is deleted.&lt;br/&gt;
</description>
                <environment>Any</environment>
            <key id="12412251">COUCHDB-208</key>
        <summary>Futon, add warning during database deletion that custom queries also deleted</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mmcdanie">Michael McDaniel</reporter>
            
    <created>Tue, 13 Jan 2009 01:57:42 +0000 (UTC)</created>
    <updated>Tue, 13 Jan 2009 01:57:42 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="14400">4h</timeoriginalestimate>        <timeestimate seconds="14400">4h</timeestimate>                    

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-207] href not properly closed in document view</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-207</link>

                    <description>The href in the document id at the top of the page is missing the terminating quote, so the HTML is broken. &lt;br/&gt;
</description>
                <environment></environment>
            <key id="12412237">COUCHDB-207</key>
        <summary>href not properly closed in document view</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="mstarzyk">Maciek Starzyk</reporter>
            
    <created>Mon, 12 Jan 2009 23:00:10 +0000 (UTC)</created>
    <updated>Tue, 13 Jan 2009 10:43:23 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12663144" author="mstarzyk" created="Mon, 12 Jan 2009 23:04:55 +0000 (UTC)"  >The patch.</comment>
                    <comment id="12663298" author="cmlenz" created="Tue, 13 Jan 2009 10:43:23 +0000 (UTC)"  >This has been fixed by r734091, which changed how the link is added.</comment>
                </comments>
    
    <attachments>
            <attachment id="12397729" name="href.patch" size="656" author="mstarzyk" created="Mon, 12 Jan 2009 23:04:55 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 13 Jan 2009 10:43:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 13 Jan 2009 10:43:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-206] exiting update_notification process crashes view_manager</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-206</link>

                    <description>To reproduce, add an update_notification&lt;br/&gt;
&lt;br/&gt;
sleep = /bin/sleep 5&lt;br/&gt;
&lt;br/&gt;
and start CouchDB.  When sleep returns, the os_process gen_server linked to it stops and that initiates a chain of crashes that brings down the view_manager.&lt;br/&gt;
&lt;br/&gt;
The problem is that the update_notifier gen_event code doesn&apos;t handle {&apos;EXIT&apos;, Pid, Reason} messages where Pid is not the state of that particular event handler.  The db_update event manager traps exits and forwards the &apos;EXIT&apos; message to *all* registered event handlers.  As a result, when any gen_server linked to the event manager terminates it brings down all the other event handlers with it, including the one added by couch_view.  When that event handler goes down, the event_sup gen_server linked to it exits, and that brings down couch_view itself.&lt;br/&gt;
&lt;br/&gt;
The fix is simple: just add one more clause to couch_db_update_notifier:handle_info that ignores &apos;EXIT&apos; messages if the Pid does not match the Pid of the related os_process.  I&apos;ll attach a patch to this issue.</description>
                <environment>r733674</environment>
            <key id="12412196">COUCHDB-206</key>
        <summary>exiting update_notification process crashes view_manager</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Mon, 12 Jan 2009 13:34:20 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 11:39:44 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="600">0.17h</timeoriginalestimate>        <timeestimate seconds="600">0.17h</timeestimate>                    

            <comments>
                    <comment id="12666890" author="janl" created="Sat, 24 Jan 2009 11:39:44 +0000 (UTC)"  >Committed as of r737334. Thanks Adam.</comment>
                </comments>
    
    <attachments>
            <attachment id="12397689" name="update_notification.diff" size="1256" author="kocolosk" created="Mon, 12 Jan 2009 13:40:53 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:39:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:39:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-205] Futon saves deleted fields that have just been added</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-205</link>

                    <description>To reproduce, try creating a new document in Futon.  Add one or more fields, make sure you actually call them something other than &amp;quot;unnamed...&amp;quot;, and then delete them (without saving the document in the interim).  Save the document, and the deleted fields will reappear.  This doesn&apos;t happen if you don&apos;t change the field names from &amp;quot;unnamed...&amp;quot;.</description>
                <environment></environment>
            <key id="12412116">COUCHDB-205</key>
        <summary>Futon saves deleted fields that have just been added</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Sat, 10 Jan 2009 15:12:38 +0000 (UTC)</created>
    <updated>Tue, 13 Jan 2009 10:55:38 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12663299" author="cmlenz" created="Tue, 13 Jan 2009 10:55:38 +0000 (UTC)"  >Fixed in r734098, thanks for the report!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 13 Jan 2009 10:55:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 13 Jan 2009 10:55:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-204] CouchDB stops/crashes/hangs (?) after resume from Mac OS X system hibernation and/or stand-by (&quot;sleep&quot;)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-204</link>

                    <description>I&apos;m running CouchDB 0.8.1 on Mac OS X 10.5.6 &amp;quot;Leopard&amp;quot; and after resuming from system hibernation (&amp;quot;safe sleep&amp;quot; -- by closing and reopening the laptop lid in my case, which is the factory default), the process either refuses all incoming connections, including my own Python scripts, web browser and the Futon, or has stopped running altogether. That is, I don&apos;t know which exactly is the case here but the fact is that CouchDB cannot be connected to after resuming.&lt;br/&gt;
&lt;br/&gt;
This issue always appears with &amp;quot;smart sleep / safe sleep&amp;quot; (standby plus hibernation) but only sometimes appears using &amp;quot;fast sleep&amp;quot; (hibernation turned off, standby only).&lt;br/&gt;
&lt;br/&gt;
This isn&apos;t a &amp;quot;critical&amp;quot; issue for server deployments, of course, but one of the core ideas of CouchDB is that eventually it will be deployed even to desktop clients for app &amp;amp; data replication across machines, so in this context this *is* a critical issue since you can&apos;t ask &amp;quot;ordinary&amp;quot; Mac OS X users to change their sleep settings from &amp;quot;safe&amp;quot; to &amp;quot;fast&amp;quot; using uncomprehensable terminal commands.</description>
                <environment>Mac OS X 10.5.6 &amp;quot;Leopard&amp;quot;</environment>
            <key id="12412111">COUCHDB-204</key>
        <summary>CouchDB stops/crashes/hangs (?) after resume from Mac OS X system hibernation and/or stand-by (&quot;sleep&quot;)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="roxority">Philipp Schumann</reporter>
            
    <created>Sat, 10 Jan 2009 13:30:45 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 17:10:42 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                        <fixVersion>0.10.1</fixVersion>
                    <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
                    <component>Futon</component>
                    <component>HTTP Interface</component>
                    <component>Infrastructure</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12662670" author="jchris" created="Sat, 10 Jan 2009 15:38:50 +0000 (UTC)"  >I&apos;ve never heard of this problem before. It&apos;d be helpful if you could reproduce while watching the log file. The easiest thing to do would be to have CouchDB running in a terminal. &lt;br/&gt;
&lt;br/&gt;
Here&apos;s instructions on how to get running in the foreground:&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/couchdb/Running_Couchdb_in_Dev_Mode&quot;&gt;http://wiki.apache.org/couchdb/Running_Couchdb_in_Dev_Mode&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
You might also want to edit local_dev.ini to bring the log level up to info or debug.</comment>
                    <comment id="12715209" author="jerry_sievert" created="Mon, 1 Jun 2009 19:22:24 +0000 (UTC)"  >Chris,&lt;br/&gt;
&lt;br/&gt;
I would be happy to show this to you on a tuesday if you are interested, as I noticed that the issue still exists while getting ready for my presentation.</comment>
                    <comment id="12715218" author="jchris" created="Mon, 1 Jun 2009 19:38:35 +0000 (UTC)"  >Thanks that&apos;d be helpful, maybe I can make it to beer night tuesday.</comment>
                    <comment id="12715223" author="damienkatz" created="Mon, 1 Jun 2009 20:00:04 +0000 (UTC)"  >It looks like all we need is a special flag passed to the emulator &lt;a href=&quot;http://www.erlang.org/doc/man/erl.html:&quot;&gt;http://www.erlang.org/doc/man/erl.html:&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
+c&lt;br/&gt;
Disable compensation for sudden changes of system time.&lt;br/&gt;
Normally, erlang:now/0 will not immediately reflect sudden changes in the system time, in order to keep timers (including receive-after) working. Instead, the time maintained by erlang:now/0 is slowly adjusted towards the new system time. (Slowly means in one percent adjustments; if the time is off by one minute, the time will be adjusted in 100 minutes.)&lt;br/&gt;
When the +c option is given, this slow adjustment will not take place. Instead erlang:now/0 will always reflect the current system time. Note that timers are based on erlang:now/0. If the system time jumps, timers then time out at the wrong time.&lt;br/&gt;
</comment>
                    <comment id="12715228" author="damienkatz" created="Mon, 1 Jun 2009 20:02:15 +0000 (UTC)"  >Here is a discussion about someone having the same problem, which discusses using the +c flag to fix.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://forum.trapexit.org/mailinglists/viewtopic.php?p=18159&amp;sid=40d574c11fe6d0c37533d5f8ab2d2fcf&quot;&gt;http://forum.trapexit.org/mailinglists/viewtopic.php?p=18159&amp;amp;sid=40d574c11fe6d0c37533d5f8ab2d2fcf&lt;/a&gt;</comment>
                    <comment id="12715256" author="jerry_sievert" created="Mon, 1 Jun 2009 21:09:01 +0000 (UTC)"  >thanks damien - that jives with the error messages i am getting in the log file: OS process timed out.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
this error bubbles up through the whole stack.</comment>
                    <comment id="12773134" author="kocolosk" created="Tue, 3 Nov 2009 19:21:47 +0000 (UTC)"  >Hi Damien, I tried using +c in an emulator but it doesn&apos;t seem to do what we need.  I ran the example in that forum post&lt;br/&gt;
&lt;br/&gt;
-module(foo).&lt;br/&gt;
-export([go/0,foo/0]).&lt;br/&gt;
&lt;br/&gt;
foo() -&amp;gt; &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;TS = calendar:now_to_local_time(now()), &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;io:format(&amp;quot;Tick ~p\n&amp;quot;,[TS]).&lt;br/&gt;
&lt;br/&gt;
go() -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;timer:apply_interval(1000, foo, foo, []).&lt;br/&gt;
&lt;br/&gt;
in an emulator with +c, shut down my laptop for a minute, and turned it back on.  I still got ~60 ticks at the timestamp when the machine woke up.&lt;br/&gt;
&lt;br/&gt;
It&apos;s a curious problem; it seems to me that a slowly-varying clock ought to prevent this flood, so +c would actually be the wrong thing to do.  Ulf Wiger seems to say the same thing in this very old thread:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.erlang.org/pipermail/erlang-questions/2002-March/004495.html&quot;&gt;http://www.erlang.org/pipermail/erlang-questions/2002-March/004495.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Either way, I think the better solution is to ensure that only one timer is active in our own code, which was the goal of my commits over in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-539&quot; title=&quot;couchdb spawns too many processes when system/laptop comes back from sleep.&quot;&gt;&lt;strike&gt;COUCHDB-539&lt;/strike&gt;&lt;/a&gt;.</comment>
                    <comment id="12781007" author="kocolosk" created="Sat, 21 Nov 2009 17:10:42 +0000 (UTC)"  >Fixed in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-539&quot; title=&quot;couchdb spawns too many processes when system/laptop comes back from sleep.&quot;&gt;&lt;strike&gt;COUCHDB-539&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                                        <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12438925">COUCHDB-539</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:10:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 10 Jan 2009 15:38:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-203] added total run time to the tests</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-203</link>

                    <description>added running total to footer. It provides a quick indication whether the test are faster overall or not</description>
                <environment></environment>
            <key id="12412109">COUCHDB-203</key>
        <summary>added total run time to the tests</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="dionne">Bob Dionne</reporter>
            
    <created>Sat, 10 Jan 2009 11:53:31 +0000 (UTC)</created>
    <updated>Fri, 16 Jan 2009 10:53:24 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12662653" author="dionne" created="Sat, 10 Jan 2009 11:54:50 +0000 (UTC)"  >added running total time to tests</comment>
                    <comment id="12664475" author="cmlenz" created="Fri, 16 Jan 2009 10:53:24 +0000 (UTC)"  >I&apos;ve implemented this in r734968 in a different way. Instead of keeping track of the total duration, its calculated based on the content of the duration cells for the individual tests. This way the sum is always in sync with the individual values, regardless of whether you run all or individual tests, rerun some tests, etc.&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12397602" name="couch_test_runner.diff" size="1369" author="dionne" created="Sat, 10 Jan 2009 11:54:50 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 16 Jan 2009 10:53:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 16 Jan 2009 10:53:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-202] [PATCH] Support other languages for views in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-202</link>

                    <description>Attached is a small patch to generalize Futon to support any language defined in the .ini file. If the language is recognized, Futon will use the correct &amp;quot;stub&amp;quot; map function in the edit textarea. Currently I&apos;ve added stub map methods for javascript and ruby, more could be added.&lt;br/&gt;
&lt;br/&gt;
Languages are checked on save and handled conservatively. So once a view has been created, its language cannot be changed. And when first saving a view, the target document&apos;s language is checked and an error is returned if the languages don&apos;t match.</description>
                <environment></environment>
            <key id="12412085">COUCHDB-202</key>
        <summary>[PATCH] Support other languages for views in Futon</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="codekitchen">Brian Palmer</reporter>
            
    <created>Fri, 9 Jan 2009 23:04:58 +0000 (UTC)</created>
    <updated>Wed, 14 Jan 2009 22:01:11 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12662553" author="codekitchen" created="Fri, 9 Jan 2009 23:05:43 +0000 (UTC)"  >Patch against the latest SVN trunk r733173</comment>
                    <comment id="12662554" author="codekitchen" created="Fri, 9 Jan 2009 23:08:15 +0000 (UTC)"  >I forgot to mention one small quirk, the most logical place for the language select dropdown is in the bottom bar of the #viewcode element. However there&apos;s a problem with safari and the resizable drag handle on that bar, preventing the select from being clicked. So on safari I move it down below, which is ugly. If anybody knows of a fix that&apos;d be awesome.</comment>
                    <comment id="12663901" author="cmlenz" created="Wed, 14 Jan 2009 22:01:11 +0000 (UTC)"  >Thanks a bunch for that patch, this is something I wanted to add for quite some time! I&apos;ve integrated it in slightly modified form in r734528.</comment>
                </comments>
    
    <attachments>
            <attachment id="12397571" name="Futon_languages_support.patch" size="5858" author="codekitchen" created="Fri, 9 Jan 2009 23:05:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 14 Jan 2009 22:01:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 14 Jan 2009 22:01:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-201] per-database configuration</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-201</link>

                    <description>I have one large database that contains only one document type that I need to run an update_notification script on, but I&apos;d really rather the script not have to get triggered for the other databases as well.&lt;br/&gt;
&lt;br/&gt;
It&apos;d be a huge improvement if you could specify per-database configuration in the .ini file. Probably not for all options does it make sense (address, port come to mind) but a few of the key options that I think it would really make sense for:&lt;br/&gt;
&lt;br/&gt;
* external processes&lt;br/&gt;
* update_notifications&lt;br/&gt;
* database_dir</description>
                <environment></environment>
            <key id="12412064">COUCHDB-201</key>
        <summary>per-database configuration</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="codekitchen">Brian Palmer</reporter>
            
    <created>Fri, 9 Jan 2009 17:50:18 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:59 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772673" author="kocolosk" created="Mon, 2 Nov 2009 20:39:59 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:39:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-200] Source Tab of documents of futon should be editable.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-200</link>

                    <description>I changed the futon code to provide an editable source view for documents. changes are both saved and synced to the &amp;quot;fields&amp;quot; tab, a cookie is set to restore the last active tab.&lt;br/&gt;
&lt;br/&gt;
In addition, browse.js contained a comment that two methods should be module private, so I changed the code to wrap everything in an anonymous closure to enable private module variables.</description>
                <environment></environment>
            <key id="12411894">COUCHDB-200</key>
        <summary>Source Tab of documents of futon should be editable.</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="shelmberger">Sven Helmberger</reporter>
            
    <created>Wed, 7 Jan 2009 20:27:05 +0000 (UTC)</created>
    <updated>Tue, 22 Sep 2009 19:38:02 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12721638" author="dwalters" created="Fri, 19 Jun 2009 03:37:36 +0000 (UTC)"  >Patch against the current trunk that makes the source view editable, using the same inline edit functionality as the tabular view.</comment>
                    <comment id="12722211" author="shelmberger" created="Sat, 20 Jun 2009 16:01:34 +0000 (UTC)"  >The new patch looks very good and seems to be less intrusive than mine.&lt;br/&gt;
&lt;br/&gt;
The only thing missing from it in my view would be the option to have the source view as primary document view/being activated on entering a document.</comment>
                    <comment id="12758271" author="paul.joseph.davis" created="Tue, 22 Sep 2009 15:30:52 +0000 (UTC)"  >I rebased Dan&apos;s patch against trunk. I was very much uncertain on where the if(noReload) clause in the last hunk should go. There&apos;s a new conditonal where it was and I wasn&apos;t certain if this should go in or out of that.&lt;br/&gt;
&lt;br/&gt;
Other than that, it works for me. I&apos;m willing to commit it if someone will verifies it works for them as well.</comment>
                    <comment id="12758368" author="shelmberger" created="Tue, 22 Sep 2009 19:02:49 +0000 (UTC)"  >The patch works for me except for a wrong error message in case of an JSON error on the source tab. &lt;br/&gt;
&lt;br/&gt;
changed the comparison from&lt;br/&gt;
&lt;br/&gt;
if (msg == &amp;quot;parseJSON&amp;quot;) &lt;br/&gt;
&lt;br/&gt;
to&lt;br/&gt;
&lt;br/&gt;
if (msg == &amp;quot;parseJSON&amp;quot; || msg == &amp;quot;JSON.parse&amp;quot;) &lt;br/&gt;
&lt;br/&gt;
like below and it worked perfectly.</comment>
                    <comment id="12758370" author="shelmberger" created="Tue, 22 Sep 2009 19:03:35 +0000 (UTC)"  >changed patch for better error messages</comment>
                    <comment id="12758389" author="paul.joseph.davis" created="Tue, 22 Sep 2009 19:38:02 +0000 (UTC)"  >Applied as of  r817793</comment>
                </comments>
    
    <attachments>
            <attachment id="12420298" name="couchdb-200-SH.patch" size="5085" author="shelmberger" created="Tue, 22 Sep 2009 19:03:35 +0000 (UTC)" />
            <attachment id="12420275" name="couchdb-200.patch" size="5061" author="paul.joseph.davis" created="Tue, 22 Sep 2009 15:30:52 +0000 (UTC)" />
            <attachment id="12411181" name="couchdb-srcedit.patch" size="5195" author="dwalters" created="Fri, 19 Jun 2009 03:37:36 +0000 (UTC)" />
            <attachment id="12397325" name="futon-srcedit.patch" size="9350" author="shelmberger" created="Wed, 7 Jan 2009 20:28:02 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 22 Sep 2009 19:38:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 19 Jun 2009 03:37:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-199] Changes to couch_db.hrl should cause all the .erl files to be rebuilt</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-199</link>

                    <description>When the couch_db.hrl file is changed, all files that include it should be modified. It is only used by src/couchdb/*.erl, so we don&apos;t have to rebuild mochiweb for this.</description>
                <environment></environment>
            <key id="12411875">COUCHDB-199</key>
        <summary>Changes to couch_db.hrl should cause all the .erl files to be rebuilt</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 7 Jan 2009 18:24:48 +0000 (UTC)</created>
    <updated>Wed, 7 Jan 2009 22:02:48 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12661733" author="janl" created="Wed, 7 Jan 2009 22:02:48 +0000 (UTC)"  >Fixed in r732528.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Jan 2009 22:02:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Jan 2009 22:02:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-198] Can&apos;t upload attachments &gt; 410MB</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-198</link>

                    <description>Can&apos;t upload attachments &amp;gt; 410MB in a document.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Steps to reproduce :&lt;br/&gt;
&lt;br/&gt;
1) Create empty db &amp;quot;test&amp;quot; with an empty document with id &amp;quot;blah&amp;quot;&lt;br/&gt;
2) Create fake file of 410MB : &lt;br/&gt;
dd if=/dev/zero of=test.mp3 bs=1024 count=420000&lt;br/&gt;
3) upload it with curl :&lt;br/&gt;
curl -X PUT --data-binary &amp;quot;@test.mp3&amp;quot; --header &amp;quot;Accept: application/json&amp;quot; --header &amp;quot;Content-Type: application/mpeg&amp;quot; --header &amp;quot;Transfer-Encoding: chunked&amp;quot; --header &amp;quot;Expect:&amp;quot; -v &lt;a href=&quot;http://127.0.0.1:5984/test/blah/test?rev=2559770741&quot;&gt;http://127.0.0.1:5984/test/blah/test?rev=2559770741&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Result :&lt;br/&gt;
&lt;br/&gt;
in curl :&lt;br/&gt;
* About to connect() to 127.0.0.1 port 5984 (#0)&lt;br/&gt;
*   Trying 127.0.0.1... connected&lt;br/&gt;
* Connected to 127.0.0.1 (127.0.0.1) port 5984 (#0)&lt;br/&gt;
&amp;gt; PUT /test/blah/test?rev=2559770741 HTTP/1.1&lt;br/&gt;
&amp;gt; User-Agent: curl/7.18.2 (x86_64-pc-linux-gnu) libcurl/7.18.2 OpenSSL/0.9.8g zlib/1.2.3.3 libidn/1.8 libssh2/0.18&lt;br/&gt;
&amp;gt; Host: 127.0.0.1:5984&lt;br/&gt;
&amp;gt; Accept: application/json&lt;br/&gt;
&amp;gt; Content-Type: application/mpeg&lt;br/&gt;
&amp;gt; Transfer-Encoding: chunked&lt;br/&gt;
&amp;gt; &lt;br/&gt;
* Empty reply from server&lt;br/&gt;
* Connection #0 to host 127.0.0.1 left intact&lt;br/&gt;
curl: (52) Empty reply from server&lt;br/&gt;
* Closing connection #0&lt;br/&gt;
&lt;br/&gt;
Couchdb :&lt;br/&gt;
[debug] [&amp;lt;0.61.0&amp;gt;] &apos;PUT&apos; /test/blah/test?rev=2559770741 {1,1}&lt;br/&gt;
Headers: [{&apos;Accept&apos;,&amp;quot;application/json&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;application/mpeg&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;127.0.0.1:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Transfer-Encoding&apos;,&amp;quot;chunked&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&amp;quot;curl/7.18.2 (x86_64-pc-linux-gnu) libcurl/7.18.2 OpenSSL/0.9.8g zlib/1.2.3.3 libidn/1.8 libssh2/0.18&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Then all the machine seem to freeze (core duo amd64 4400+ with 2 Go of ram) and connection failed.&lt;br/&gt;
</description>
                <environment>linux 2.6.26 (debian) or Openbsd 4.4-current</environment>
            <key id="12411734">COUCHDB-198</key>
        <summary>Can&apos;t upload attachments &gt; 410MB</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 6 Jan 2009 00:59:14 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 12:04:34 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12661093" author="benoitc" created="Tue, 6 Jan 2009 09:50:50 +0000 (UTC)"  >just to add more info, i tested size of 410Mb and lower without any problem.</comment>
                    <comment id="12666900" author="janl" created="Sat, 24 Jan 2009 12:04:34 +0000 (UTC)"  >Closed by request of reporter.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:04:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:04:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-197] Replication renders CouchDB unresponsive.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-197</link>

                    <description>I am quite sure this is not the same issue as in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-193&quot; title=&quot;Replicating a DB to itself puts the server in a strange state&quot;&gt;&lt;strike&gt;COUCHDB-193&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
Im trying to replicte a somewhat big database {&amp;quot;doc_count&amp;quot;:541394,&amp;quot;doc_del_count&amp;quot;:265692,&amp;quot;update_seq&amp;quot;:2118390,&amp;quot;purge_seq&amp;quot;:0,&amp;quot;compact_running&amp;quot;:false,&amp;quot;disk_size&amp;quot;:16552608803} to an other machine. &lt;br/&gt;
&lt;br/&gt;
I started replication with this:&lt;br/&gt;
&lt;br/&gt;
send: &apos;POST /_replicate HTTP/1.1\r\nHost: couchdb1.local.xxx:5984\r\nAccept-Encoding: identity\r\ncontent-length: 90\r\ncontent-type: application/json\r\naccept: application/json\r\nuser-agent: couchdb-python 0.5dev-r127\r\n\r\n&apos;&lt;br/&gt;
send: &apos;{&amp;quot;source&amp;quot;: &amp;quot;hulog_events&amp;quot;, &amp;quot;target&amp;quot;: &amp;quot;&lt;a href=&quot;http://couchdb2.local.xxx:5984/hulog_events&quot;&gt;http://couchdb2.local.xxx:5984/hulog_events&lt;/a&gt;&amp;quot;}&apos;&lt;br/&gt;
reply: &apos;&apos;&lt;br/&gt;
connect: (couchdb1.local.hudora.biz, 5984)&lt;br/&gt;
send: &apos;POST /_replicate HTTP/1.1\r\nHost: couchdb1.local.xxxx:5984\r\nAccept-Encoding: identity\r\ncontent-length: 90\r\ncontent-type: application/json\r\naccept: application/json\r\nuser-agent: couchdb-python 0.5dev-r127\r\n\r\n&apos;&lt;br/&gt;
send: &apos;{&amp;quot;source&amp;quot;: &amp;quot;hulog_events&amp;quot;, &amp;quot;target&amp;quot;: &amp;quot;&lt;a href=&quot;http://couchdb2.local.xxxx:5984/hulog_events&quot;&gt;http://couchdb2.local.xxxx:5984/hulog_events&lt;/a&gt;&amp;quot;}&apos;&lt;br/&gt;
(no reply so far)&lt;br/&gt;
&lt;br/&gt;
On the source server (couchdb1) I see following logentries:&lt;br/&gt;
&lt;br/&gt;
Mon, 05 Jan 2009 19:34:21 GMT] [info] [&amp;lt;0.12745.45&amp;gt;] 192.168.0.30 - - &apos;POST&apos; /_replicate 200&lt;br/&gt;
[Mon, 05 Jan 2009 19:35:36 GMT] [info] [&amp;lt;0.107.0&amp;gt;] Compaction for db &amp;quot;hulog_events_test&amp;quot; completed.&lt;br/&gt;
[Mon, 05 Jan 2009 19:35:45 GMT] [info] [&amp;lt;0.12746.45&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /hulog_events/ 200&lt;br/&gt;
[Mon, 05 Jan 2009 19:35:46 GMT] [info] [&amp;lt;0.95.0&amp;gt;] Compaction for db &amp;quot;eap&amp;quot; completed.&lt;br/&gt;
[Mon, 05 Jan 2009 19:42:17 GMT] [error] [&amp;lt;0.12765.45&amp;gt;] ** Generic server &amp;lt;0.12765.45&amp;gt; terminating &lt;br/&gt;
** Last message in was {&apos;EXIT&apos;,&amp;lt;0.12762.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{timeout,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.12768.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{write,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;0,0,1,36,131,104,2,104,1,108,0,0,0,8,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,7,112,114,111,100,117,99,116,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,8,54,53,49,52,48,47,69,75,104,2,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,11,116,114,97,110,115,97,99,116,105,111,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;110,109,0,0,0,8,114,101,116,114,105,101,118,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,104,2,109,0,0,0,4,116,121,112,101,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,4,117,110,105,116,104,2,109,0,0,0,11,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,99,104,105,118,101,100,95,97,116,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,22,50,48,48,56,48,50,50,50,84,49,50,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;52,48,53,46,53,50,54,51,56,52,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,10,99,114,101,97,116,101,100,95,97,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,22,50,48,48,55,49,49,50,56,84,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,52,50,48,54,46,51,52,52,54,49,56,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,4,112,114,111,112,104,1,108,0,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,104,2,109,0,0,0,8,108,111,99,97,116,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;111,110,109,0,0,0,6,65,85,83,76,65,71,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,6,104,101,105,103,104,116,98,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;7,158,106,104,2,109,0,0,0,3,109,117,105,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,18,51,52,48,48,53,57,57,56,49,48,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,48,51,49,50,53,50,104,2,109,0,0,0,8,113,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;117,97,110,116,105,116,121,97,11,106,106&amp;gt;&amp;gt;}]}}}&lt;br/&gt;
** When Server state == {file_descriptor,prim_file,{#Port&amp;lt;0.904761&amp;gt;,24}}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {timeout,{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.12768.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{write,&amp;lt;&amp;lt;0,0,1,36,131,104,2,104,1,108,0,0,0,8,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,7,112,114,111,100,117,99,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,8,54,53,49,52,48,47,69,75,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,11,116,114,97,110,115,97,99,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,111,110,109,0,0,0,8,114,101,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,105,101,118,101,104,2,109,0,0,0,4,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,121,112,101,109,0,0,0,4,117,110,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,104,2,109,0,0,0,11,97,114,99,104,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;118,101,100,95,97,116,109,0,0,0,22,50,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,56,48,50,50,50,84,49,50,49,52,48,53,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;46,53,50,54,51,56,52,104,2,109,0,0,0,10,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;99,114,101,97,116,101,100,95,97,116,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,22,50,48,48,55,49,49,50,56,84,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,52,50,48,54,46,51,52,52,54,49,56,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,4,112,114,111,112,104,1,108,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,2,104,2,109,0,0,0,8,108,111,99,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,111,110,109,0,0,0,6,65,85,83,76,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;65,71,104,2,109,0,0,0,6,104,101,105,103,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;104,116,98,0,0,7,158,106,104,2,109,0,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,109,117,105,109,0,0,0,18,51,52,48,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,57,57,56,49,48,48,48,48,51,49,50,53,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,104,2,109,0,0,0,8,113,117,97,110,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;105,116,121,97,11,106,106&amp;gt;&amp;gt;}]}}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 19:42:57 GMT] [error] [&amp;lt;0.12765.45&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.12765.45&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.12765.45&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{timeout,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.12768.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{write,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;0,0,1,36,131,104,2,104,1,108,0,0,0,8,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,7,112,114,111,100,117,99,116,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,8,54,53,49,52,48,47,69,75,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,11,116,114,97,110,115,97,99,116,105,111,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;110,109,0,0,0,8,114,101,116,114,105,101,118,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,104,2,109,0,0,0,4,116,121,112,101,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,4,117,110,105,116,104,2,109,0,0,0,11,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,99,104,105,118,101,100,95,97,116,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,22,50,48,48,56,48,50,50,50,84,49,50,49,52,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,53,46,53,50,54,51,56,52,104,2,109,0,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;10,99,114,101,97,116,101,100,95,97,116,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,22,50,48,48,55,49,49,50,56,84,49,53,52,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,48,54,46,51,52,52,54,49,56,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,4,112,114,111,112,104,1,108,0,0,0,2,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,8,108,111,99,97,116,105,111,110,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,6,65,85,83,76,65,71,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,6,104,101,105,103,104,116,98,0,0,7,158,106,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;104,2,109,0,0,0,3,109,117,105,109,0,0,0,18,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;51,52,48,48,53,57,57,56,49,48,48,48,48,51,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,53,50,104,2,109,0,0,0,8,113,117,97,110,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,116,121,97,11,106,106&amp;gt;&amp;gt;}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{couch_file,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[&amp;lt;0.12762.45&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[#Port&amp;lt;0.904761&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,987},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,836156}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 19:43:02 GMT] [error] [&amp;lt;0.22399.43&amp;gt;] ** Generic server &amp;lt;0.22399.43&amp;gt; terminating &lt;br/&gt;
** Last message in was {&apos;EXIT&apos;,&amp;lt;0.10848.41&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{timeout,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.12768.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{write,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;0,0,1,36,131,104,2,104,1,108,0,0,0,8,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,7,112,114,111,100,117,99,116,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,8,54,53,49,52,48,47,69,75,104,2,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,11,116,114,97,110,115,97,99,116,105,111,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;110,109,0,0,0,8,114,101,116,114,105,101,118,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,104,2,109,0,0,0,4,116,121,112,101,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,4,117,110,105,116,104,2,109,0,0,0,11,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,99,104,105,118,101,100,95,97,116,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,22,50,48,48,56,48,50,50,50,84,49,50,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;52,48,53,46,53,50,54,51,56,52,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,10,99,114,101,97,116,101,100,95,97,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,22,50,48,48,55,49,49,50,56,84,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,52,50,48,54,46,51,52,52,54,49,56,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,4,112,114,111,112,104,1,108,0,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,104,2,109,0,0,0,8,108,111,99,97,116,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;111,110,109,0,0,0,6,65,85,83,76,65,71,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,6,104,101,105,103,104,116,98,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;7,158,106,104,2,109,0,0,0,3,109,117,105,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,18,51,52,48,48,53,57,57,56,49,48,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,48,51,49,50,53,50,104,2,109,0,0,0,8,113,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;117,97,110,116,105,116,121,97,11,106,106&amp;gt;&amp;gt;}]}}}&lt;br/&gt;
** When Server state == {file_descriptor,prim_file,{#Port&amp;lt;0.904494&amp;gt;,16}}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** {timeout,{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.12768.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{write,&amp;lt;&amp;lt;0,0,1,36,131,104,2,104,1,108,0,0,0,8,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,7,112,114,111,100,117,99,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,8,54,53,49,52,48,47,69,75,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,11,116,114,97,110,115,97,99,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,111,110,109,0,0,0,8,114,101,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,105,101,118,101,104,2,109,0,0,0,4,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,121,112,101,109,0,0,0,4,117,110,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,104,2,109,0,0,0,11,97,114,99,104,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;118,101,100,95,97,116,109,0,0,0,22,50,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,56,48,50,50,50,84,49,50,49,52,48,53,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;46,53,50,54,51,56,52,104,2,109,0,0,0,10,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;99,114,101,97,116,101,100,95,97,116,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,22,50,48,48,55,49,49,50,56,84,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,52,50,48,54,46,51,52,52,54,49,56,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,4,112,114,111,112,104,1,108,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,2,104,2,109,0,0,0,8,108,111,99,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,111,110,109,0,0,0,6,65,85,83,76,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;65,71,104,2,109,0,0,0,6,104,101,105,103,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;104,116,98,0,0,7,158,106,104,2,109,0,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,109,117,105,109,0,0,0,18,51,52,48,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,57,57,56,49,48,48,48,48,51,49,50,53,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,104,2,109,0,0,0,8,113,117,97,110,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;105,116,121,97,11,106,106&amp;gt;&amp;gt;}]}}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 19:43:28 GMT] [error] [&amp;lt;0.22399.43&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.22399.43&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.22399.43&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{timeout,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.12768.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{write,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;0,0,1,36,131,104,2,104,1,108,0,0,0,8,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,7,112,114,111,100,117,99,116,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,8,54,53,49,52,48,47,69,75,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,11,116,114,97,110,115,97,99,116,105,111,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;110,109,0,0,0,8,114,101,116,114,105,101,118,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;101,104,2,109,0,0,0,4,116,121,112,101,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,4,117,110,105,116,104,2,109,0,0,0,11,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,99,104,105,118,101,100,95,97,116,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,22,50,48,48,56,48,50,50,50,84,49,50,49,52,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,53,46,53,50,54,51,56,52,104,2,109,0,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;10,99,114,101,97,116,101,100,95,97,116,109,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,22,50,48,48,55,49,49,50,56,84,49,53,52,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,48,54,46,51,52,52,54,49,56,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,4,112,114,111,112,104,1,108,0,0,0,2,104,2,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,8,108,111,99,97,116,105,111,110,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,6,65,85,83,76,65,71,104,2,109,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,6,104,101,105,103,104,116,98,0,0,7,158,106,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;104,2,109,0,0,0,3,109,117,105,109,0,0,0,18,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;51,52,48,48,53,57,57,56,49,48,48,48,48,51,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,53,50,104,2,109,0,0,0,8,113,117,97,110,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,116,121,97,11,106,106&amp;gt;&amp;gt;}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{couch_file,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.10848.41&amp;gt;,&amp;lt;0.10847.41&amp;gt;,couch_server,couch_primary_services,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&apos;DOWN&apos;,#Ref&amp;lt;0.0.81.132266&amp;gt;,process,&amp;lt;0.10847.41&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{timeout,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.12768.45&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{write,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;0,0,1,36,131,104,2,104,1,108,0,0,0,8,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,7,112,114,111,100,117,99,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;109,0,0,0,8,54,53,49,52,48,47,69,75,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,11,116,114,97,110,115,97,99,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,111,110,109,0,0,0,8,114,101,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;114,105,101,118,101,104,2,109,0,0,0,4,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,121,112,101,109,0,0,0,4,117,110,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,104,2,109,0,0,0,11,97,114,99,104,105,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;118,101,100,95,97,116,109,0,0,0,22,50,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;48,56,48,50,50,50,84,49,50,49,52,48,53,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;46,53,50,54,51,56,52,104,2,109,0,0,0,10,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;99,114,101,97,116,101,100,95,97,116,109,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,22,50,48,48,55,49,49,50,56,84,49,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,52,50,48,54,46,51,52,52,54,49,56,104,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2,109,0,0,0,4,112,114,111,112,104,1,108,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0,0,0,2,104,2,109,0,0,0,8,108,111,99,97,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;116,105,111,110,109,0,0,0,6,65,85,83,76,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;65,71,104,2,109,0,0,0,6,104,101,105,103,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;104,116,98,0,0,7,158,106,104,2,109,0,0,0,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;3,109,117,105,109,0,0,0,18,51,52,48,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;53,57,57,56,49,48,48,48,48,51,49,50,53,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;50,104,2,109,0,0,0,8,113,117,97,110,116,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;105,116,121,97,11,106,106&amp;gt;&amp;gt;}]}}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[#Port&amp;lt;0.904494&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[{&amp;lt;0.10847.41&amp;gt;,{#Ref&amp;lt;0.0.81.132266&amp;gt;,1}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,987},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,5627554}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
(and nothing further)&lt;br/&gt;
&lt;br/&gt;
I still can access couchdb1 (the source) but every trivial request takes exactly 5015ms:&lt;br/&gt;
&lt;br/&gt;
balancer:/filespace/couchdb/log# time curl -i &lt;a href=&quot;http://127.0.0.1:5984/&quot;&gt;http://127.0.0.1:5984/&lt;/a&gt;&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
Server: CouchDB/0.9.0a731357-incubating (Erlang OTP/R12B)&lt;br/&gt;
Date: Mon, 05 Jan 2009 20:45:46 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Content-Length: 102&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.9.0a731357-incubating&amp;quot;,&amp;quot;start_time&amp;quot;:&amp;quot;Sun, 04 Jan 2009 21:43:13 GMT&amp;quot;}&lt;br/&gt;
real	0m5.015s&lt;br/&gt;
user	0m0.008s&lt;br/&gt;
sys	0m0.000s&lt;br/&gt;
&lt;br/&gt;
For these accesses no log entries  on couchdb1 are created.&lt;br/&gt;
&lt;br/&gt;
Meanwhile on the destination server (couchdb2) I can see lot of activity:&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 20:47:58 GMT] [info] [&amp;lt;0.19601.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
... 40 lines...&lt;br/&gt;
[Mon, 05 Jan 2009 20:47:58 GMT] [info] [&amp;lt;0.19644.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
[Mon, 05 Jan 2009 20:48:13 GMT] [info] [&amp;lt;0.19652.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
... ca 200 lines&lt;br/&gt;
[Mon, 05 Jan 2009 20:48:13 GMT] [info] [&amp;lt;0.19744.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
[Mon, 05 Jan 2009 20:48:28 GMT] [info] [&amp;lt;0.19747.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
... ca 200 lines&lt;br/&gt;
[Mon, 05 Jan 2009 20:48:28 GMT] [info] [&amp;lt;0.19844.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
[Mon, 05 Jan 2009 20:48:43 GMT] [info] [&amp;lt;0.19944.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
... ca 200 lines&lt;br/&gt;
[Mon, 05 Jan 2009 20:48:58 GMT] [info] [&amp;lt;0.19948.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
... ca 200 lines&lt;br/&gt;
[Mon, 05 Jan 2009 20:48:58 GMT] [info] [&amp;lt;0.20044.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
[Mon, 05 Jan 2009 20:49:13 GMT] [info] [&amp;lt;0.20045.5&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
&lt;br/&gt;
But the number of documents on the destination servers hasnt been incerasing in the meantime:&lt;br/&gt;
{&amp;quot;db_name&amp;quot;:&amp;quot;hulog_events&amp;quot;,&amp;quot;doc_count&amp;quot;:25926,&amp;quot;doc_del_count&amp;quot;:10074,&amp;quot;update_seq&amp;quot;:36000,&amp;quot;purge_seq&amp;quot;:0,&amp;quot;compact_running&amp;quot;:false,&amp;quot;disk_size&amp;quot;:21927524}&lt;br/&gt;
&lt;br/&gt;
couchdb1 is CouchDB 0.9.0a731357-incubating&lt;br/&gt;
couchdb2 is CouchDB 0.9.0a730405-incubating</description>
                <environment></environment>
            <key id="12411716">COUCHDB-197</key>
        <summary>Replication renders CouchDB unresponsive.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Mon, 5 Jan 2009 20:58:17 +0000 (UTC)</created>
    <updated>Fri, 30 Jan 2009 01:41:52 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12660928" author="mdornseif" created="Mon, 5 Jan 2009 21:11:00 +0000 (UTC)"  >Wit a much smaller databases (700 docs) it works:&lt;br/&gt;
&lt;br/&gt;
connect: (couchdb2.local.xxxx, 5984)&lt;br/&gt;
send: &apos;GET /_all_dbs HTTP/1.1\r\nHost: couchdb2.local.xxxx:5984\r\naccept-encoding: compress, gzip\r\naccept: application/json\r\nuser-agent: couchdb-python 0.5dev-r127\r\n\r\n&apos;&lt;br/&gt;
reply: &apos;HTTP/1.1 200 OK\r\n&apos;&lt;br/&gt;
header: Server: CouchDB/0.9.0a731656-incubating (Erlang OTP/R12B)&lt;br/&gt;
header: Date: Mon, 05 Jan 2009 21:07:40 GMT&lt;br/&gt;
header: Content-Type: application/json&lt;br/&gt;
header: Content-Length: 115&lt;br/&gt;
header: Cache-Control: must-revalidate&lt;br/&gt;
send: &apos;POST /_replicate HTTP/1.1\r\nHost: couchdb1.local.xxx:5984\r\nAccept-Encoding: identity\r\ncontent-length: 72\r\ncontent-type: application/json\r\naccept: application/json\r\nuser-agent: couchdb-python 0.5dev-r127\r\n\r\n&apos;&lt;br/&gt;
send: &apos;{&amp;quot;source&amp;quot;: &amp;quot;eap&amp;quot;, &amp;quot;target&amp;quot;: &amp;quot;&lt;a href=&quot;http://couchdb2.local.xxx:5984/eap&quot;&gt;http://couchdb2.local.xxx:5984/eap&lt;/a&gt;&amp;quot;}&apos;&lt;br/&gt;
reply: &apos;HTTP/1.1 200 OK\r\n&apos;&lt;br/&gt;
header: Server: CouchDB/0.9.0a731724-incubating (Erlang OTP/R12B)&lt;br/&gt;
header: Date: Mon, 05 Jan 2009 21:07:51 GMT&lt;br/&gt;
header: Content-Type: application/json&lt;br/&gt;
header: Content-Length: 307&lt;br/&gt;
header: Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
({&apos;status&apos;: &apos;200&apos;, &apos;content-length&apos;: &apos;307&apos;, &apos;server&apos;: &apos;CouchDB/0.9.0a731724-incubating (Erlang OTP/R12B)&apos;, &apos;cache-control&apos;: &apos;must-revalidate&apos;, &apos;date&apos;: &apos;Mon, 05 Jan 2009 21:07:51 GMT&apos;, &apos;content-type&apos;: &apos;application/json&apos;}, {&apos;ok&apos;: True, &apos;source_last_seq&apos;: 9393, &apos;session_id&apos;: &apos;707886e5455c294729146eadfa98ca28&apos;, &apos;history&apos;: [{&apos;missing_found&apos;: 1005, &apos;end_last_seq&apos;: 9393, &apos;docs_written&apos;: 1005, &apos;start_time&apos;: &apos;Mon, 05 Jan 2009 21:07:40 GMT&apos;, &apos;docs_read&apos;: 1005, &apos;start_last_seq&apos;: 8234, &apos;end_time&apos;: &apos;Mon, 05 Jan 2009 21:07:50 GMT&apos;, &apos;missing_checked&apos;: 3083}]})&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12660934" author="mdornseif" created="Mon, 5 Jan 2009 21:19:19 +0000 (UTC)"  >I upgraded the destination server (couchdb2) to 0.9.0a731656-incubating and restarted both servers. Then I re-initiated replication.&lt;br/&gt;
&lt;br/&gt;
I now observe no excessive response times to other clients and no a 100% CPU use as I have seen before. &lt;br/&gt;
&lt;br/&gt;
I now also see the number of documents increasing on the destination server.  If this replication runs without issues I will close this issue.</comment>
                    <comment id="12660939" author="mdornseif" created="Mon, 5 Jan 2009 21:32:23 +0000 (UTC)"  >This time the source server gave a somewhat less mysterious entry in it&apos;s error log:&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.149.3&amp;gt; with exit value: {{badmatch,{error,closed}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.148.3&amp;gt; with exit value: {{badmatch,{error,closed}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.147.3&amp;gt; with exit value: {{badmatch,{error,econnreset}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [&amp;lt;0.254.3&amp;gt;] ** Generic server &amp;lt;0.254.3&amp;gt; terminating &lt;br/&gt;
** Last message in was {tcp_closed,#Port&amp;lt;0.41326&amp;gt;}&lt;br/&gt;
** When Server state == {state,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{request,#Ref&amp;lt;0.0.8.247273&amp;gt;,&amp;lt;0.150.3&amp;gt;,0,http,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;couchdb2.local.xxx&amp;quot;,5984},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/hulog_events/_missing_revs&amp;quot;,[],post,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{http_request_h,undefined,&amp;quot;keep-alive&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;couchdb2.local.xxx&amp;quot;,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,&amp;quot;0&amp;quot;,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;application/json; charset=utf-8&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;09445122472897-20080716T050500.000000\&amp;quot;:[\&amp;quot;4273862330\&amp;quot;]}&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{http_options,&amp;quot;HTTP/1.1&amp;quot;,infinity,true,[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;&lt;a href=&quot;http://couchdb2.local.xxx:5984/hulog_events/_missing_revs&quot;&gt;http://couchdb2.local.xxx:5984/hulog_events/_missing_revs&lt;/a&gt;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],none,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{tcp_session,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{&amp;quot;couchdb2.local.xxx&amp;quot;,5984},&amp;lt;0.254.3&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;false,http,#Port&amp;lt;0.41326&amp;gt;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{httpc_response,parse,[nolimit,false]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[],[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;new,[],nolimit,nolimit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{options,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{undefined,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;5000,101,2,disabled,enabled,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{timers,[],undefined},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpc_manager,undefined}&lt;br/&gt;
** Reason for termination == &lt;br/&gt;
** session_remotly_closed&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [&amp;lt;0.254.3&amp;gt;] {error_report,&amp;lt;0.34.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.254.3&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.254.3&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,{exit,session_remotly_closed,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{gen_server,terminate,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{httpc_handler,init,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[httpc_handler_sup,httpc_sup,inets_sup,&amp;lt;0.35.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.41.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,2584},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,920}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.146.3&amp;gt; with exit value: {{badmatch,{error,econnreset}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [&amp;lt;0.41.0&amp;gt;] {error_report,&amp;lt;0.34.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.41.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,httpc_handler_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,session_remotly_closed},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.254.3&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,undefined},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{httpc_handler,start_link,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{request,#Ref&amp;lt;0.0.8.247273&amp;gt;,&amp;lt;0.150.3&amp;gt;,0,http,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;couchdb2.local.xxx&amp;quot;,5984},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/hulog_events/_missing_revs&amp;quot;,[],post,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{http_request_h,undefined,&amp;quot;keep-alive&amp;quot;,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;couchdb2.local.xxx&amp;quot;,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,[],undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,&amp;quot;0&amp;quot;,undefined,undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;undefined,undefined,undefined,undefined,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;application/json; charset=utf-8&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;09445122472897-20080716T050500.000000\&amp;quot;:[\&amp;quot;4273862330\&amp;quot;]}&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{http_options,&amp;quot;HTTP/1.1&amp;quot;,infinity,true,[],undefined,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;&lt;a href=&quot;http://couchdb2.local.xxx:5984/hulog_events/_missing_revs&quot;&gt;http://couchdb2.local.xxx:5984/hulog_events/_missing_revs&lt;/a&gt;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],none,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{options,{undefined,[]},5000,101,2,disabled,enabled,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpc_manager]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,temporary},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,4000},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,worker}]}]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.145.3&amp;gt; with exit value: {{badmatch,{error,econnreset}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.144.3&amp;gt; with exit value: {{badmatch,{error,econnreset}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.143.3&amp;gt; with exit value: {{badmatch,{error,econnreset}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.142.3&amp;gt; with exit value: {{badmatch,{error,econnreset}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.141.3&amp;gt; with exit value: {{badmatch,{error,econnreset}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.150.3&amp;gt; with exit value: {{badmatch,{error,session_remotly_closed}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.153.3&amp;gt; with exit value: {{badmatch,{error,closed}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.152.3&amp;gt; with exit value: {{badmatch,{error,closed}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [emulator] Error in process &amp;lt;0.151.3&amp;gt; with exit value: {{badmatch,{error,closed}},[{couch_rep,do_http_request,4},{couch_rep,get_missing_revs,2},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [&amp;lt;0.60.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.60.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.60.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{exit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,wait_result,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-pmap/2-lc$^0/1-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-pmap/2-lc$^0/1-0-&apos;,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,enum_docs_parallel,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,enum_docs_since,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,pull_rep,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,replicate2,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,replicate,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{mochiweb_socket_server,acceptor_loop,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_httpd,couch_secondary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245606&amp;gt;,process,&amp;lt;0.149.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,closed}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245605&amp;gt;,process,&amp;lt;0.148.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,closed}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245604&amp;gt;,process,&amp;lt;0.147.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245603&amp;gt;,process,&amp;lt;0.146.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245602&amp;gt;,process,&amp;lt;0.145.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245601&amp;gt;,process,&amp;lt;0.144.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245600&amp;gt;,process,&amp;lt;0.143.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245599&amp;gt;,process,&amp;lt;0.142.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245607&amp;gt;,process,&amp;lt;0.150.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,session_remotly_closed}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245610&amp;gt;,process,&amp;lt;0.153.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,closed}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245609&amp;gt;,process,&amp;lt;0.152.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,closed}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;DOWN&apos;,#Ref&amp;lt;0.0.8.245608&amp;gt;,process,&amp;lt;0.151.3&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,closed}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.57.0&amp;gt;,&amp;lt;0.32739.2&amp;gt;,#Port&amp;lt;0.1160&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request_body,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;{\&amp;quot;source\&amp;quot;: \&amp;quot;hulog_events\&amp;quot;, \&amp;quot;target\&amp;quot;: \&amp;quot;&lt;a href=&quot;http://couchdb2.local.xxx:5984/hulog_events&quot;&gt;http://couchdb2.local.xxx:5984/hulog_events&lt;/a&gt;\&amp;quot;}&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request_recv,true}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,17711},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,1163662}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{neighbour,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.32739.2&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{erlang,apply,2}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{current_function,{couch_rep,save_docs_buffer,3}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.60.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,waiting},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,17711},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,5},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,2082}]}]]}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:45 GMT] [error] [&amp;lt;0.57.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.57.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,235,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,econnreset}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_rep,do_http_request,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,get_missing_revs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}}}}}&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:20:51 GMT] [info] [&amp;lt;0.262.3&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /hulog_events/ 200&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
On the destination server can see nothing unusual at 21:20:51. Somebody still continues to request revisions:&lt;br/&gt;
&lt;br/&gt;
[Mon, 05 Jan 2009 21:29:58 GMT] [info] [&amp;lt;0.16391.2&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
[Mon, 05 Jan 2009 21:29:58 GMT] [info] [&amp;lt;0.16394.2&amp;gt;] 172.28.4.107 - - &apos;POST&apos; /hulog_events/_missing_revs 200&lt;br/&gt;
&lt;br/&gt;
The servers are NTP syncronisized with a timedrift of perhaps a few ms.&lt;br/&gt;
&lt;br/&gt;
The beam process on the source machine now uses 100% CPU but client access hasn&apos;t slowed down.</comment>
                    <comment id="12660961" author="kocolosk" created="Mon, 5 Jan 2009 22:31:01 +0000 (UTC)"  >Hi Maximillian and devs, I&apos;ve seen these errors on occasion as well, but haven&apos;t had time to dig deep and figure out the best way to handle them.  Right now, couch_rep:do_http_request doesn&apos;t try to match any of the errors that you saw after you upgraded the target:&lt;br/&gt;
&lt;br/&gt;
{error,closed}&lt;br/&gt;
{error,econnreset}&lt;br/&gt;
{error,session_remotly_closed}&lt;br/&gt;
&lt;br/&gt;
At first glance I&apos;m not sure I understand why the replication still seems to be going forward.  I could be missing something simple.&lt;br/&gt;
&lt;br/&gt;
For what it&apos;s worth, replication seems to work better if you initiate on the target server.  That way, it&apos;s all GET requests underneath instead of POSTs.  Its faster and introduces a smaller combined load on the servers, since the target Couch can use a single persistent TCP connection to the source and pipeline its requests.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll try to take a closer look at this soon, but unfortunately it&apos;s not an easy one to reproduce.  Regards,&lt;br/&gt;
&lt;br/&gt;
Adam</comment>
                    <comment id="12661185" author="mdornseif" created="Tue, 6 Jan 2009 16:09:34 +0000 (UTC)"  >Following Adams suggestion I initiated replication on the destination server, changing direction from push to pull. &lt;br/&gt;
&lt;br/&gt;
So far it looks quite good. 10.6 GB / 522008 Docs have been replicated without any issues so far.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12664702" author="jasondd" created="Fri, 16 Jan 2009 22:10:55 +0000 (UTC)"  >I&apos;m having this problem with &amp;quot;push&amp;quot; replication as well, and I&apos;ve found that doing &amp;quot;pull&amp;quot; replication works fine.</comment>
                    <comment id="12664708" author="jasondd" created="Fri, 16 Jan 2009 22:17:24 +0000 (UTC)"  >Actually, I spoke too soon... I think &amp;quot;pull&amp;quot; replication works better but it does still crash occasionally.  Perhaps it is something that only happens on slow DSL connections?</comment>
                    <comment id="12664712" author="jasondd" created="Fri, 16 Jan 2009 22:25:10 +0000 (UTC)"  >Here are some errors I&apos;m getting when doing &amp;quot;pull&amp;quot; replication:&lt;br/&gt;
&lt;br/&gt;
[Fri, 16 Jan 2009 22:25:41 GMT] [error] [emulator] Error in process &amp;lt;0.12080.0&amp;gt; with exit value: {{badmatch,{error,no_scheme}},[{couch_rep,do_http_request,4},{couch_rep,open_doc_revs,4},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
[Fri, 16 Jan 2009 22:26:37 GMT] [error] [emulator] Error in process &amp;lt;0.12085.0&amp;gt; with exit value: {{badmatch,{error,no_scheme}},[{couch_rep,do_http_request,4},{couch_rep,open_doc_revs,4},{couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,4},{couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]}&lt;br/&gt;
&lt;br/&gt;
I&apos;m running latest trunk at the time of writing: r735146.</comment>
                    <comment id="12664731" author="damienkatz" created="Fri, 16 Jan 2009 23:16:23 +0000 (UTC)"  >Fyi, I just looked into this issue briefly and the no_scheme errors are from the inets http client and from attempting operations without the http:|https: portion of the uri.&lt;br/&gt;
</comment>
                    <comment id="12666688" author="kocolosk" created="Fri, 23 Jan 2009 20:31:21 +0000 (UTC)"  >Jason helped me look into this in some more detail.  As Damien noted, the no_scheme error means the http request didn&apos;t have an http:|https: in the URI.  This happens during replication because of the 301 redirect on _design%2F URLs (remember, couch_rep encodes all docids, including design docs -- that may not be necessary anymore).  CouchDB&apos;s redirect response includes a Location header without any scheme.  According to Section 14.30 of rfc2616, that&apos;s illegal.&lt;br/&gt;
&lt;br/&gt;
I hacked in an absolute URI in the Location header, but there may be additional problems.  The Erlang HTTP client hangs after automatically handling one of these redirects.  Eventually, the remote CouchDB server closes the connections, but that kills all the requests in the pipeline.  I don&apos;t have a patch at the ready, but some opportunities for working around this limitation include&lt;br/&gt;
&lt;br/&gt;
a) handling the redirect manually in the replication code instead of letting the HTTP client do it automatically&lt;br/&gt;
&lt;br/&gt;
b) retrying GET requests in the event of failures (we could do this anyway to try to provide a smoother experience)&lt;br/&gt;
&lt;br/&gt;
I haven&apos;t had a chance to dig in on the more frequent errors encountered in POST-based replications.  Best, Adam</comment>
                    <comment id="12666923" author="jasondd" created="Sat, 24 Jan 2009 13:32:23 +0000 (UTC)"  >Here&apos;s a simple test for replication of design docs over HTTP that fails in current trunk (r737346).</comment>
                    <comment id="12666925" author="janl" created="Sat, 24 Jan 2009 13:36:42 +0000 (UTC)"  >Seems serious enough to mark it blocking for 0.9.</comment>
                    <comment id="12666933" author="janl" created="Sat, 24 Jan 2009 14:13:02 +0000 (UTC)"  >Set 0.9 version.</comment>
                    <comment id="12666947" author="jasondd" created="Sat, 24 Jan 2009 16:03:27 +0000 (UTC)"  >This patch makes CouchDB return absolute URIs in Location: headers. It does this using the Host: header sent by the client (this is mandatory if HTTP/1.1 is used), or if not present, it constructs the server name from the IP address and port number of the socket the request was sent on.&lt;br/&gt;
&lt;br/&gt;
It also contains a workaround for a problem I noticed where http:request doesn&apos;t set the Host: header properly: it neglects to set the port for some reason.&lt;br/&gt;
&lt;br/&gt;
As I&apos;m an Erlang newbie, I&apos;d be grateful if someone more experienced could check the patch over.</comment>
                    <comment id="12666958" author="jasondd" created="Sat, 24 Jan 2009 17:40:32 +0000 (UTC)"  >Updated patch after feedback from Jan: renamed uses of &amp;quot;netloc&amp;quot; to &amp;quot;host&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve also updated the couch_rep Host: workaround to only set the Host: header if it&apos;s not already set.</comment>
                    <comment id="12666962" author="kocolosk" created="Sat, 24 Jan 2009 17:59:43 +0000 (UTC)"  >Here&apos;s another patch that should improve the stability and performance of push replication.  Previously we were POSTing to _missing_revs on the target DB once for each document in the source DB.  Limitations in the Erlang HTTP client forced a new connection to be negotiated each time.&lt;br/&gt;
&lt;br/&gt;
This patch changes the workflow to POST to _missing_revs once per 100 docs.  As a result the total # of HTTP requests required to push to a remote target is 2*N/100 (one _missing_revs and one _bulk_docs every 100 docs).  &lt;br/&gt;
&lt;br/&gt;
In my limited testing push replication is much more stable and slightly faster as well.</comment>
                    <comment id="12667127" author="jasondd" created="Sun, 25 Jan 2009 19:43:46 +0000 (UTC)"  >Slightly tweaked patch: better naming and removed compiler warning about unused variable.</comment>
                    <comment id="12667130" author="jasondd" created="Sun, 25 Jan 2009 20:18:04 +0000 (UTC)"  >I&apos;d be interested if anyone else can reproduce any errors with the &amp;quot;replication&amp;quot; test when using the couch_redirects.3.diff patch above.  I can reproduce strange problems on a Debian box, which look like a possible bug in inets&apos; http:request().  The test runs fine on my Mac OS X and Ubuntu boxes using the same versions of Erlang.  The Debian box is actually a VPS running with smp=8 and an average load of 7, so maybe the problem only occurs under high load.  I&apos;ve tried disabling smp but the problem still occurs.  Here&apos;s a sample of the kind of error I&apos;m getting:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;{badmatch,\n    {error,\n        {bad_return_value,\n            {error,\n                {invalid_version,\n                    \&amp;quot;\\\&amp;quot;_revs\\\&amp;quot;:[\\\&amp;quot;1947022206\\\&amp;quot;]}}\\r\\n1\\r\\n]\\r\\n0\\r\\n\\r\\nHTTP/1.1\&amp;quot;}}}}}&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;[{couch_rep,do_http_request,4},\n {couch_rep,open_doc_revs,4},\n {couch_rep,&apos;-enum_docs_parallel/3-fun-1-&apos;,3},\n {couch_rep,&apos;-spawn_worker/3-fun-0-&apos;,3}]&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Further notes:&lt;br/&gt;
&lt;br/&gt;
1. It looks like this is happening in inets&apos; http client when it is attempting to parse the HTTP version line, which is why I&apos;m thinking there is some weird concurrency issue here.&lt;br/&gt;
2. The other thing is that this problem *only occurs* with the patch applied, which means there may be something wrong with http:request&apos;s handling of 301/302 redirects in a pipelined situation.&lt;br/&gt;
3. When I comment out the {max_pipeline_length, 101} option, the errors no longer occur, indicating there may be a problem with pipelining.</comment>
                    <comment id="12667415" author="jasondd" created="Mon, 26 Jan 2009 21:01:59 +0000 (UTC)"  >This patch integrates ibrowse 1.4.1 (from &lt;a href=&quot;http://sourceforge.net/cvs/?group_id=73688)&quot;&gt;http://sourceforge.net/cvs/?group_id=73688)&lt;/a&gt; with couch_rep.erl.  It mostly seems to have cleaned up my strange problems, although I do still get occasional connection_closed errors.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve made it retry requests up to 10 times if errors are encountered, and I&apos;ve limited this to GET requests on Adam Kocoloski&apos;s suggestion.&lt;br/&gt;
&lt;br/&gt;
This patch also includes my couch_redirects.3 patch.&lt;br/&gt;
&lt;br/&gt;
Apparently ibrowse is &amp;quot;dual-licensed&amp;quot; under LGPL and BSD so I think it&apos;s safe...</comment>
                    <comment id="12667723" author="kocolosk" created="Tue, 27 Jan 2009 16:52:24 +0000 (UTC)"  >Hi Jason, looks pretty good from my end.  We can actually retry all requests, not just GETs, and I think we should also retry if we get back a 500 status code. &lt;br/&gt;
&lt;br/&gt;
Will couch_httpd:absolute_uri work behind an SSL proxy?</comment>
                    <comment id="12667806" author="kocolosk" created="Tue, 27 Jan 2009 21:01:28 +0000 (UTC)"  >Hi Jason, a couple of other suggestions: &lt;br/&gt;
&lt;br/&gt;
1) the 5 second timeout seems to be too short for push replication. I had legitimate _bulk_docs requests that took longer than 5 seconds in my testing.&lt;br/&gt;
&lt;br/&gt;
2) I saw plenty of connection_closed errors when doing push replication. I added chunked transfer encoding to the list of ibrowse options and the problem went away. I&apos;ll try to do a better job of figuring out why MochiWeb wanted to close the connection there.</comment>
                    <comment id="12668011" author="jasondd" created="Wed, 28 Jan 2009 12:12:56 +0000 (UTC)"  >Hi Adam, thanks for the feedback.  I&apos;ve updated the code and put it on github to keep better track of it: &lt;a href=&quot;http://github.com/jasondavies/couchdb/tree/master&quot;&gt;http://github.com/jasondavies/couchdb/tree/master&lt;/a&gt; (feel free to fork and make further changes).  It now retries all requests and also retries if it gets a 500 error response.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve tested redirects (using couchdb_httpd:absolute_uri) behind an nginx SSL proxy and they work fine.  The only problem is that nginx appears to automatically rewrite design doc URLs so they don&apos;t need to redirect (i.e. _design%2Ftest -&amp;gt; _design/test).  The /_utils URL redirects to /_utils/ properly as expected though.  The only requirement is that the proxy rewrites the request&apos;s Host: and the response&apos;s Location: headers appropriately - I&apos;m not sure if all proxies do this.&lt;br/&gt;
&lt;br/&gt;
1) I&apos;ve changed the 5 second timeout to be 10 seconds for now.  Any ideas what an appropriate value should be?&lt;br/&gt;
&lt;br/&gt;
2) What value of ChunkSize should we use here?  I agree that getting to the bottom of these errors would be a good idea, in case there is something amiss in MochiWeb...</comment>
                    <comment id="12668212" author="jasondd" created="Wed, 28 Jan 2009 23:04:59 +0000 (UTC)"  >Re: using an nginx SSL proxy: the redirection does work fine if you use proxy_pass &lt;a href=&quot;http://backend;&quot;&gt;http://backend;&lt;/a&gt; instead of proxy_pass &lt;a href=&quot;http://backend/;&quot;&gt;http://backend/;&lt;/a&gt;</comment>
                    <comment id="12668575" author="jchris" created="Thu, 29 Jan 2009 19:55:15 +0000 (UTC)"  >I&apos;m preparing this for commit at &lt;a href=&quot;http://github.com/jchris/couchdb/tree/repfix&quot;&gt;http://github.com/jchris/couchdb/tree/repfix&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I think we can push the subtle issues with timeout length and ChunkSize into new tickets if there end up being problems with it.&lt;br/&gt;
&lt;br/&gt;
I still want to run the patch by Damien, as he has long-term plans for replication changes which may preclude using ibrowse, but I don&apos;t see why off the top of my head.&lt;br/&gt;
&lt;br/&gt;
Thanks for your work, Jason and Adam, and for bring this issue up, Maximillian.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12668607" author="kocolosk" created="Thu, 29 Jan 2009 21:16:19 +0000 (UTC)"  >Hi Chris, thanks.  I&apos;d vote for using the default ibrowse timeout and chunked transfer encoding in the commit.  Pull request on the way.</comment>
                    <comment id="12668639" author="jchris" created="Thu, 29 Jan 2009 22:17:02 +0000 (UTC)"  >fixed in r739047</comment>
                </comments>
    
    <attachments>
            <attachment id="12398658" name="couch_redirects.2.diff" size="4485" author="jasondd" created="Sat, 24 Jan 2009 17:40:32 +0000 (UTC)" />
            <attachment id="12398696" name="couch_redirects.3.diff" size="4494" author="jasondd" created="Sun, 25 Jan 2009 19:43:46 +0000 (UTC)" />
            <attachment id="12398656" name="couch_redirects.diff" size="4306" author="jasondd" created="Sat, 24 Jan 2009 16:03:27 +0000 (UTC)" />
            <attachment id="12398647" name="couch_tests.js.diff" size="799" author="jasondd" created="Sat, 24 Jan 2009 13:32:23 +0000 (UTC)" />
            <attachment id="12398765" name="ibrowse.diff" size="117139" author="jasondd" created="Mon, 26 Jan 2009 21:01:59 +0000 (UTC)" />
            <attachment id="12398660" name="push_replication_fix.diff" size="2975" author="kocolosk" created="Sat, 24 Jan 2009 17:59:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 29 Jan 2009 22:17:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 5 Jan 2009 22:31:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-196] Bug in _all_docs: extra incorrect row returned when ?key= is specified</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-196</link>

                    <description>I first noticed this when attempting to reverse the order of docs displayed in Futon, when listing the design docs.  When the order is reversed, non-design docs are displayed.&lt;br/&gt;
&lt;br/&gt;
After digging deeper I discovered that querying _all_docs with key=&amp;quot;Z&amp;quot; can potentially return two rows, with keys &amp;quot;Z&amp;quot; and &amp;quot;a&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
I will attach a test case to reproduce this.  My locale is set to en_GB.UTF-8, which could be related to this problem.</description>
                <environment></environment>
            <key id="12411687">COUCHDB-196</key>
        <summary>Bug in _all_docs: extra incorrect row returned when ?key= is specified</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Mon, 5 Jan 2009 13:38:06 +0000 (UTC)</created>
    <updated>Fri, 9 Jan 2009 19:06:26 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12660749" author="jasondd" created="Mon, 5 Jan 2009 13:38:49 +0000 (UTC)"  >Test for _all_docs that fails in my environment.</comment>
                    <comment id="12660765" author="jasondd" created="Mon, 5 Jan 2009 14:06:03 +0000 (UTC)"  >Removed locale from title of bug as the test case failed for rboyd too, who has the en_US locale.  The non-design-doc problem occurred for him as well.</comment>
                    <comment id="12660823" author="jasondd" created="Mon, 5 Jan 2009 17:22:17 +0000 (UTC)"  >Updated patch without extraneous console.log() statement.</comment>
                    <comment id="12661778" author="jchris" created="Wed, 7 Jan 2009 23:37:22 +0000 (UTC)"  >I&apos;ve attached another patch (really just a snapshot of my working setup, with debug logging in the erl files and console.log in the tests)&lt;br/&gt;
&lt;br/&gt;
It does indeed seem that collation by id is playing by different rules than collation by view key. I&apos;m not done investigating this yet, but I agree, we should get to the bottom of it.</comment>
                    <comment id="12661974" author="dionne" created="Thu, 8 Jan 2009 14:16:50 +0000 (UTC)"  >attached is a simpler test case that exhibits the bug. I stepped into this a bit in a debugger. The AdapterFun (line#-288 in couch_httpd_db) is called twice with oth records &amp;quot;Z&amp;quot; and &amp;quot;a&amp;quot;, which the debug statements already confirm. Not too up on the code yet so I&apos;m not sure if it&apos;s in couch_httpd_view:make_view_fold_fun or couch_db:enum_docs.  Here&apos;s what the state looks like the first time through:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://gist.github.com/44721&quot;&gt;http://gist.github.com/44721&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12661975" author="dionne" created="Thu, 8 Jan 2009 14:18:53 +0000 (UTC)"  >smaller test case that fails</comment>
                    <comment id="12662167" author="dionne" created="Thu, 8 Jan 2009 23:27:25 +0000 (UTC)"  >This patch changes the use of A &amp;lt; B to couch_util:collate  which seems to fix the collation issue. It breaks a couple of other tests which need to be reviewed for correctness.&lt;br/&gt;
&lt;br/&gt;
The main issue is that using A &amp;lt; B  fails for &amp;lt;&amp;lt;&amp;quot;a&amp;quot;&amp;gt;&amp;gt; and &amp;lt;&amp;lt;&amp;quot;Z&amp;quot;&amp;gt;&amp;gt;</comment>
                    <comment id="12662235" author="kocolosk" created="Fri, 9 Jan 2009 03:36:23 +0000 (UTC)"  >Hi Bob, thanks for looking into this.  I&apos;d argue for replacing that entire function with couch_view:less_json/2&lt;br/&gt;
&lt;br/&gt;
diff --git a/src/couchdb/couch_db_updater.erl b/src/couchdb/couch_db_updater.erl&lt;br/&gt;
index 049a354..38885f8 100644&lt;br/&gt;
--- a/src/couchdb/couch_db_updater.erl&lt;br/&gt;
+++ b/src/couchdb/couch_db_updater.erl&lt;br/&gt;
@@ -253,13 +253,8 @@ init_db(DbName, Filepath, Fd, Header0) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Header = simple_upgrade_record(Header0, #db_header{}),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, SummaryStream} = couch_stream:open(Header#db_header.summary_stream_state, Fd),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok = couch_stream:set_min_buffer(SummaryStream, 10000),&lt;br/&gt;
-    Less =&lt;br/&gt;
-        fun(A,B) when A==B -&amp;gt; false;&lt;br/&gt;
-        (nil, _) -&amp;gt; true; % nil - special key sorts before all&lt;br/&gt;
-        ({}, _) -&amp;gt; false; % {} -&amp;gt; special key sorts after all&lt;br/&gt;
-        (A, B) -&amp;gt; A &amp;lt; B&lt;br/&gt;
-        end,&lt;br/&gt;
-            &lt;br/&gt;
+    Less = fun couch_view:less_json/2,&lt;br/&gt;
+    &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, IdBtree} = couch_btree:open(Header#db_header.fulldocinfo_by_id_btree_state, Fd,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{split, fun(X) -&amp;gt; btree_by_id_split(X) end},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{join, fun(X,Y) -&amp;gt; btree_by_id_join(X,Y) end},&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
The DB behavior seems to be the same either way, and the fewer places we have this collaction algorithm coded up the better.  I looked into the 2 test suite failures that show up as a result of applying either of these patches.  The failure in design docs occurs because the test suite expects to find the document &amp;quot;_design/test&amp;quot; in the _all_docs view between &amp;quot;_design%2F&amp;quot; and &amp;quot;_design%2FZZZ&amp;quot;.  That expectation is erroneous.  I&apos;m not sure why it worked before.&lt;br/&gt;
&lt;br/&gt;
The second failure occurs in view_include_docs where an _all_docs view is queried with limit=2&amp;amp;skip=1.  In the trunk code _design docs sort after docs with stringified integers for ids.  Your patch causes the _design docs to sort first, which I believe is the correct behavior.  Again, the test suite&apos;s expectation is probably wrong.&lt;br/&gt;
</comment>
                    <comment id="12662422" author="jchris" created="Fri, 9 Jan 2009 16:50:02 +0000 (UTC)"  >Thanks for looking into this guys - here&apos;s the patch I&apos;m showing to Damien before applying.&lt;br/&gt;
&lt;br/&gt;
The only substantial difference is more testing. (I&apos;m using less_json in the updater)</comment>
                    <comment id="12662436" author="jchris" created="Fri, 9 Jan 2009 17:29:52 +0000 (UTC)"  >After discussing with Damien, it seems the issue is more subtle than we&apos;d appreciated.&lt;br/&gt;
&lt;br/&gt;
All-docs will continue to use Erlang binary comparisons instead of unicode collation. This is a tradeoff as write-speed is more important than human-friendly all-docs ordering.&lt;br/&gt;
&lt;br/&gt;
However, the current system has a bug, which is that the all-docs http api is trying to use unicode collation on the endkeys, when it should be using binary comparisons. The fix should be relatively simple, but won&apos;t yield the exact same behavior for the list of docs as it does for the list of view keys.</comment>
                    <comment id="12662439" author="kocolosk" created="Fri, 9 Jan 2009 17:36:27 +0000 (UTC)"  >Hi Chris, I just caught the end of your discussion on IRC.  This seems like a reasonable compromise, although I haven&apos;t seen any numbers on Couch&apos;s ICU collation performance so I can&apos;t say whether it would make a noticeable difference.</comment>
                    <comment id="12662477" author="jchris" created="Fri, 9 Jan 2009 19:06:26 +0000 (UTC)"  >Resolved by r733116.&lt;br/&gt;
&lt;br/&gt;
Docids do not use the same collation as string view keys, so the _all_docs view was getting endkeys wrong. Fixed so that all_doc uses the same comparison as doc insertion to handle endkeys.</comment>
                </comments>
    
    <attachments>
            <attachment id="12397352" name="collation_ids.diff" size="4378" author="jchris" created="Wed, 7 Jan 2009 23:37:22 +0000 (UTC)" />
            <attachment id="12397129" name="collation_test.2.diff" size="721" author="jasondd" created="Mon, 5 Jan 2009 17:22:17 +0000 (UTC)" />
            <attachment id="12397123" name="collation_test.diff" size="979" author="jasondd" created="Mon, 5 Jan 2009 13:38:49 +0000 (UTC)" />
            <attachment id="12397460" name="couch_db_updater.diff" size="741" author="dionne" created="Thu, 8 Jan 2009 23:27:25 +0000 (UTC)" />
            <attachment id="12397532" name="docid_collation.diff" size="1774" author="jchris" created="Fri, 9 Jan 2009 16:50:02 +0000 (UTC)" />
            <attachment id="12397424" name="view_coll.js" size="1041" author="dionne" created="Thu, 8 Jan 2009 14:18:53 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 9 Jan 2009 19:06:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Jan 2009 23:37:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-195] test issue to check mail routing to dev@couchdb</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-195</link>

                    <description></description>
                <environment></environment>
            <key id="12411686">COUCHDB-195</key>
        <summary>test issue to check mail routing to dev@couchdb</summary>

            <type id="6" iconUrl="http://issues.apache.org/jira/images/icons/test.gif">Test</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="geir">Geir Magnusson Jr</reporter>
            
    <created>Mon, 5 Jan 2009 13:14:03 +0000 (UTC)</created>
    <updated>Mon, 5 Jan 2009 13:22:43 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12660746" author="geir" created="Mon, 5 Jan 2009 13:22:43 +0000 (UTC)"  >it works...</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 5 Jan 2009 13:22:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-194] [startkey, endkey[: provide a right-open range selection method</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-194</link>

                    <description>While writing something about using CouchDB I came across the issue of &amp;quot;slice indexes&amp;quot; (called startkey and endkey in CouchDB lingo).&lt;br/&gt;
&lt;br/&gt;
I found no exact definition of startkey and endkey anywhere in the documentation. Testing reveals that access on _all_docs and on views documents are retuned in the interval&lt;br/&gt;
&lt;br/&gt;
[startkey, endkey] = (startkey &amp;lt;= k &amp;lt;= endkey).&lt;br/&gt;
&lt;br/&gt;
I don&apos;t know if this was a conscious design decision. But I like to promote a slightly different interpretation (and thus API change):&lt;br/&gt;
&lt;br/&gt;
[startkey, endkey[ = (startkey &amp;lt;= k &amp;lt; endkey).&lt;br/&gt;
&lt;br/&gt;
Both approaches are valid and used in the real world. Ruby uses the inclusive (&amp;quot;right-closed&amp;quot; in math speak) first approach:&lt;br/&gt;
&lt;br/&gt;
&amp;gt;&amp;gt; l = [1,2,3,4]&lt;br/&gt;
&amp;gt;&amp;gt; l.slice(1,2)&lt;br/&gt;
=&amp;gt; [2, 3]&lt;br/&gt;
&lt;br/&gt;
Python uses the exclusive (&amp;quot;right-open&amp;quot; in math speak) second approach:&lt;br/&gt;
&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; l = [1,2,3,4]&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; l[1,2]&lt;br/&gt;
[2]&lt;br/&gt;
&lt;br/&gt;
For array indices both work fine and which one to prefer is mostly an issue of habit. In spoken language both approaches are used: &amp;quot;Have the Software done until saturday&amp;quot; probably means right-open to the client and right-closed to the coder.&lt;br/&gt;
&lt;br/&gt;
But if you are working with keys that are more than array indexes, then right-open is much easier to handle. That is because you have to *guess* the biggest value you want to get. The Wiki at &lt;a href=&quot;http://wiki.apache.org/couchdb/View_collation&quot;&gt;http://wiki.apache.org/couchdb/View_collation&lt;/a&gt; contains an example of that problem:&lt;br/&gt;
&lt;br/&gt;
It is suggested that you use&lt;br/&gt;
startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design/ZZZZZZZZZ&amp;quot;&lt;br/&gt;
or&lt;br/&gt;
startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design/\u9999&#8243;&lt;br/&gt;
to get a list of all design documents - also the replication system in the db core uses the same hack.&lt;br/&gt;
&lt;br/&gt;
This breaks if a design document is named &amp;quot;ZZZZZZZZZTop&amp;quot; or &amp;quot;\9999I&amp;#xF1;t&amp;#xEB;rn&amp;#xE2;ti&amp;#xF4;n&amp;#xE0;liz&amp;#xE6;ti&amp;#xF8;n&amp;quot;. Such names might be unlikely but we are computer scientists; &amp;quot;unlikely&amp;quot; is a bad approach to software engineering.&lt;br/&gt;
&lt;br/&gt;
The think what we really want to ask CouchDB is to &amp;quot;get all documents with keys starting with &apos;_design/&apos;&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
This is basically impossible to do with right-closed intervals. We could use startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design0&#8243; (&apos;0&#8242; is the ASCII character after &apos;/&apos;) and this will work fine ... until there is actually a document with the key &amp;quot;_design0&#8243; in the system. Unlikely, but ...&lt;br/&gt;
&lt;br/&gt;
To make selection by intervals reliable currently clients have to guess the last key (the ZZZZ approach) or use the fist key not to include (the _design0 approach) and then post process the result to remove the last element returned if it exactly matches the given endkey value.&lt;br/&gt;
&lt;br/&gt;
If couchdb would change to a right-open interval approach post processing would go away in most cases. See &lt;a href=&quot;http://blogs.23.nu/c0re/2008/12/building-a-track-and-trace-application-with-couchdb/&quot;&gt;http://blogs.23.nu/c0re/2008/12/building-a-track-and-trace-application-with-couchdb/&lt;/a&gt; for two real world examples.&lt;br/&gt;
&lt;br/&gt;
At least for string keys and float keys changing the meaning to [startkey, endkey[ would allow selections like&lt;br/&gt;
&lt;br/&gt;
* &amp;quot;all strings starting with &apos;abc&apos;&amp;quot;&lt;br/&gt;
* all numbers between 10.5 and 11&lt;br/&gt;
&lt;br/&gt;
It also would hopefully break not to much existing code. Since the notion of endkey seems to be already considered &amp;quot;fishy&amp;quot; (see the ZZZZZ approach) most code seems to try to avoid that issue. For example &apos;startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design/ZZZZZZZZZ&amp;quot;&apos; still would work unless you have a design document being named exactly &amp;quot;ZZZZZZZZZ&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12411654">COUCHDB-194</key>
        <summary>[startkey, endkey[: provide a right-open range selection method</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Sun, 4 Jan 2009 22:00:51 +0000 (UTC)</created>
    <updated>Tue, 27 Oct 2009 10:15:13 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>2</votes>
    
                                        

            <comments>
                    <comment id="12666888" author="janl" created="Sat, 24 Jan 2009 11:21:45 +0000 (UTC)"  >This got some support form Damien. We should find a consensus for 0.9.</comment>
                    <comment id="12670911" author="mdornseif" created="Thu, 5 Feb 2009 21:32:12 +0000 (UTC)"  >So far nobody seems against it.&lt;br/&gt;
&lt;br/&gt;
The downside is that it MIGHT break some existing code.</comment>
                    <comment id="12671231" author="jchris" created="Fri, 6 Feb 2009 18:28:12 +0000 (UTC)"  >I just want to express my support for the change. Let&apos;s not forget this one, it will be a fair amount of work I think.</comment>
                    <comment id="12671239" author="paul.joseph.davis" created="Fri, 6 Feb 2009 18:52:40 +0000 (UTC)"  >My vote would be to make left and right ends optionally open or closed. I can put some time into trying my hand a patch pretty soon.&lt;br/&gt;
&lt;br/&gt;
So I&apos;m clear, with this patch we would expect users to use something like &apos;startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design0&amp;quot;&amp;amp;open_end=true&apos; right?</comment>
                    <comment id="12671246" author="deanlandolt" created="Fri, 6 Feb 2009 19:05:31 +0000 (UTC)"  >Anybody have any idea how this would this effect endkey_docid? If passed as part of the request, it would usurp the open_end param, correct?&lt;br/&gt;
&lt;br/&gt;
And should it be called open_end given it would apply to startkey (or startkey_docid) with descending=true queries? Of course, I can&apos;t think of anything much better...</comment>
                    <comment id="12671339" author="paul.joseph.davis" created="Fri, 6 Feb 2009 21:39:01 +0000 (UTC)"  >open_end would actually be applied against the {key, docid} pairs, so *key_docid would not usurp.&lt;br/&gt;
&lt;br/&gt;
open_end and the corresponding open_start would behave in the same manner as startkey and endkey, as in, when you use descending=true you must also swap your open options.&lt;br/&gt;
&lt;br/&gt;
At least that&apos;s how I would expect it to work. Perhaps there&apos;s an argument for some other behavior I&apos;m missing.</comment>
                    <comment id="12671348" author="paul.joseph.davis" created="Fri, 6 Feb 2009 21:54:47 +0000 (UTC)"  >Chris hit the reply button:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; The open/closed distinction is counter-intuitive to me, maybe the&lt;br/&gt;
&amp;gt; options api would be better off as inclusive_start=true&lt;br/&gt;
&amp;gt; inclusive_end=true (the current behavior) being the default, where&lt;br/&gt;
&amp;gt; either can be overridden with false.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; Maybe defaulting to inclusive_end=false (a change in default behavior)&lt;br/&gt;
&amp;gt; would be better, but let&apos;s play with it a little first.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;m officially convinced on s/open/inclusive/&lt;br/&gt;
&lt;br/&gt;
I&apos;d say implement it keeping current behavior then ask on the dev/user lists for a vote on changing default behavior. I think it could affect paging code that people are probably testing thoroughly.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12682174" author="jchris" created="Sun, 15 Mar 2009 20:57:34 +0000 (UTC)"  >Moved to 0.9 but we can push back if the API change is not a problem to have later.</comment>
                    <comment id="12683434" author="jchris" created="Thu, 19 Mar 2009 11:22:35 +0000 (UTC)"  >r755926 adds an inclusive_end query option, defaulting to true (the previous behavior).&lt;br/&gt;
&lt;br/&gt;
inclusive_end=false will make the endkey and open-interval. I&apos;m open to switching this to the default, but I won&apos;t do that unless there is a strong call for it.</comment>
                    <comment id="12696651" author="thisfred" created="Tue, 7 Apr 2009 17:55:02 +0000 (UTC)"  >Worth noting:&lt;br/&gt;
&lt;br/&gt;
The builtin &amp;quot;_all_docs_by_seq&amp;quot; view right now returns everything with key: startkey &amp;lt; key &amp;lt;= endkey&lt;br/&gt;
&lt;br/&gt;
I would like to know what the intended consistent way will be, so that I can already make my higher level API work that way, and not ahve to break clients&apos; code when this gets changed/fixed.</comment>
                    <comment id="12743063" author="jchris" created="Fri, 14 Aug 2009 03:34:08 +0000 (UTC)"  >Eric,&lt;br/&gt;
&lt;br/&gt;
Patches are totally welcome on this. _by_seq probably didn&apos;t get much attention lately, as I think it&apos;s still deprecated in favor of _changes.&lt;br/&gt;
&lt;br/&gt;
It&apos;s worth noting that docids are not collated with ICU when they are in the _all_docs view, so there are some places the collation rules can differ.&lt;br/&gt;
&lt;br/&gt;
if you are able to prepare a test case illustrating the change you&apos;d like, it probably won&apos;t be hard to find something to finish the patch.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12746609" author="janl" created="Sun, 23 Aug 2009 14:44:55 +0000 (UTC)"  >remove fix version. If you feel like this should be in 0.11, re-assign.</comment>
                    <comment id="12770445" author="maxime" created="Tue, 27 Oct 2009 10:15:13 +0000 (UTC)"  >I suggest to generalize to left or/and right opened range.&lt;br/&gt;
&lt;br/&gt;
Because, to select a left opened range of keys, we have to use a tip.&lt;br/&gt;
&lt;br/&gt;
Exemple :&lt;br/&gt;
&lt;br/&gt;
keys = [1, 2, 3, 4, 5]&lt;br/&gt;
to select where   2&amp;lt;key&lt;br/&gt;
We have to do : startkey=2&amp;amp;skip=1&lt;br/&gt;
&lt;br/&gt;
But :&lt;br/&gt;
If keys are no unique, the &amp;quot;skip&amp;quot; tip no more works.&lt;br/&gt;
Ex: keys = [1, 2, 2, 3, 4, 5]&lt;br/&gt;
The request startkey=2&amp;amp;skip=1 doesn&apos;t work because a &amp;quot;2&amp;quot; key is returned.&lt;br/&gt;
&lt;br/&gt;
(ps: non unique keys can be a wanted result)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:21:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-193] Replicating a DB to itself puts the server in a strange state</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-193</link>

                    <description>&lt;br/&gt;
I initiated by error a replication to the local machine in a totally stupid fashion. Basically I did something like this (using python-couchdb):&lt;br/&gt;
&lt;br/&gt;
src_server = couchdb.client.Server(&apos;&lt;a href=&quot;http://localhost:5984&apos;)&quot;&gt;http://localhost:5984&apos;)&lt;/a&gt;&lt;br/&gt;
src_server.resource.post(&apos;_replicate&apos;, {&apos;source&apos;: dbname, &apos;target&apos;: &apos;&lt;a href=&quot;http://localhost:5984/%s&quot;&gt;http://localhost:5984/%s&lt;/a&gt;&apos; % dbname})&lt;br/&gt;
&lt;br/&gt;
This resulted in the following strange log entries. The strange thing is, it pushed the server in a &amp;quot;strange&amp;quot; state, where I even wasn&apos;t able to create new databases.&lt;br/&gt;
&lt;br/&gt;
2009-01-04 20:14:38.221693500 [info] [&amp;lt;0.22446.191&amp;gt;] 172.28.4.107 - - &apos;PUT&apos; /hulog_events_test/_local%2Fbalancer:hulog_events_test:http:%2F%2Fcouchdb.local.xxx:5984%2Fhulog_events_test 412&lt;br/&gt;
2009-01-04 20:14:38.221698500 [info] [&amp;lt;0.20194.191&amp;gt;] 172.30.20.74 - - &apos;POST&apos; /_replicate 200&lt;br/&gt;
2009-01-04 20:15:47.905980500 [info] [&amp;lt;0.22451.191&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /hulog_events/ 200&lt;br/&gt;
2009-01-04 20:20:54.741438500 [info] [&amp;lt;0.22654.191&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /hulog_events/ 200&lt;br/&gt;
2009-01-04 20:25:47.221129500 [info] [&amp;lt;0.22655.191&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /hulog_events/ 200&lt;br/&gt;
2009-01-04 20:28:03.452784500 [info] [&amp;lt;0.22656.191&amp;gt;] 172.30.20.74 - - &apos;GET&apos; /_utils/browse/_create_database.html 200&lt;br/&gt;
2009-01-04 20:28:18.445906500 [error] [&amp;lt;0.22656.191&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
2009-01-04 20:28:18.445910500     {&amp;lt;0.22656.191&amp;gt;,crash_report,&lt;br/&gt;
2009-01-04 20:28:18.445913500      [[{pid,&amp;lt;0.22656.191&amp;gt;},&lt;br/&gt;
2009-01-04 20:28:18.445915500        {registered_name,[]},&lt;br/&gt;
2009-01-04 20:28:18.445917500        {error_info,&lt;br/&gt;
2009-01-04 20:28:18.445919500            {exit,&lt;br/&gt;
2009-01-04 20:28:18.445921500                {timeout,&lt;br/&gt;
2009-01-04 20:28:18.445923500                    {gen_server,call,&lt;br/&gt;
2009-01-04 20:28:18.445925500                        [couch_server,&lt;br/&gt;
2009-01-04 20:28:18.445928500                         {create,&amp;lt;&amp;lt;&amp;quot;mypl_audit_replication&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
2009-01-04 20:28:18.445957500                             [{user_ctx,{user_ctx,null,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}}]}]}},&lt;br/&gt;
2009-01-04 20:28:18.445960500                [{gen_server,call,2},&lt;br/&gt;
2009-01-04 20:28:18.445962500                 {couch_server,create,2},&lt;br/&gt;
2009-01-04 20:28:18.445965500                 {couch_httpd_db,create_db_req,2},&lt;br/&gt;
2009-01-04 20:28:18.445967500                 {couch_httpd,handle_request,3},&lt;br/&gt;
2009-01-04 20:28:18.445969500                 {mochiweb_http,headers,4},&lt;br/&gt;
2009-01-04 20:28:18.445976500                 {proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
2009-01-04 20:28:18.445978500        {initial_call,{mochiweb_socket_server,acceptor_loop,[&apos;Argument__1&apos;]}},&lt;br/&gt;
2009-01-04 20:28:18.445981500        {ancestors,&lt;br/&gt;
2009-01-04 20:28:18.445983500            [couch_httpd,couch_secondary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
2009-01-04 20:28:18.445985500        {messages,[]},&lt;br/&gt;
2009-01-04 20:28:18.445988500        {links,[#Port&amp;lt;0.1869511&amp;gt;,&amp;lt;0.56.0&amp;gt;]},&lt;br/&gt;
2009-01-04 20:28:18.445994500        {dictionary,[]},&lt;br/&gt;
2009-01-04 20:28:18.445996500        {trap_exit,false},&lt;br/&gt;
2009-01-04 20:28:18.445998500        {status,running},&lt;br/&gt;
2009-01-04 20:28:18.446000500        {heap_size,4181},&lt;br/&gt;
2009-01-04 20:28:18.446002500        {stack_size,23},&lt;br/&gt;
2009-01-04 20:28:18.446014500        {reductions,5599}],&lt;br/&gt;
2009-01-04 20:28:18.446016500       []]}}&lt;br/&gt;
2009-01-04 20:28:19.096792500 [error] [&amp;lt;0.56.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
2009-01-04 20:28:19.096796500     {&amp;lt;0.56.0&amp;gt;,std_error,&lt;br/&gt;
2009-01-04 20:28:19.096798500      {mochiweb_socket_server,235,&lt;br/&gt;
2009-01-04 20:28:19.096800500          {child_error,&lt;br/&gt;
2009-01-04 20:28:19.096802500              {timeout,&lt;br/&gt;
2009-01-04 20:28:19.096804500                  {gen_server,call,&lt;br/&gt;
2009-01-04 20:28:19.096807500                      [couch_server,&lt;br/&gt;
2009-01-04 20:28:19.096809500                       {create,&amp;lt;&amp;lt;&amp;quot;mypl_audit_replication&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
2009-01-04 20:28:19.096811500                           [{user_ctx,{user_ctx,null,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}}]}]}}}}}}&lt;br/&gt;
2009-01-04 20:28:19.190123500 &lt;br/&gt;
2009-01-04 20:28:19.190127500 =ERROR REPORT==== 4-Jan-2009::20:28:19 ===&lt;br/&gt;
2009-01-04 20:28:19.190130500 {mochiweb_socket_server,235,&lt;br/&gt;
2009-01-04 20:28:19.190132500     {child_error,&lt;br/&gt;
2009-01-04 20:28:19.190134500         {timeout,&lt;br/&gt;
2009-01-04 20:28:19.190136500             {gen_server,call,&lt;br/&gt;
2009-01-04 20:28:19.190138500                 [couch_server,&lt;br/&gt;
2009-01-04 20:28:19.190140500                  {create,&amp;lt;&amp;lt;&amp;quot;mypl_audit_replication&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
2009-01-04 20:28:19.190143500                      [{user_ctx,{user_ctx,null,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}}]}]}}}}&lt;br/&gt;
2009-01-04 20:28:19.369207500 [info] [&amp;lt;0.22657.191&amp;gt;] 172.30.20.74 - - &apos;PUT&apos; /mypl_audit_replication/ 409&lt;br/&gt;
2009-01-04 20:30:47.447703500 [info] [&amp;lt;0.22662.191&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /hulog_events/ 200&lt;br/&gt;
2009-01-04 20:35:59.219916500 [info] [&amp;lt;0.22663.191&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /hulog_events/ 200&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12411647">COUCHDB-193</key>
        <summary>Replicating a DB to itself puts the server in a strange state</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Sun, 4 Jan 2009 19:42:37 +0000 (UTC)</created>
    <updated>Sat, 15 Aug 2009 05:13:10 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12743525" author="kocolosk" created="Sat, 15 Aug 2009 02:26:36 +0000 (UTC)"  >I tried this on trunk.  The replicator crashes hard, but the server as a whole appears to be fine.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll see what I can do about detecting this loop.</comment>
                    <comment id="12743526" author="kocolosk" created="Sat, 15 Aug 2009 02:31:29 +0000 (UTC)"  >Hah, now I see what&apos;s happening on trunk -- when the target tries to save the _local doc it fails as a conflict (because the source has already saved it).  Then I try to turn the string &amp;lt;&amp;lt;&amp;quot;Invalid rev format&amp;quot;&amp;gt;&amp;gt; into a revision and everything crashes.&lt;br/&gt;
&lt;br/&gt;
Perhaps couch_rep_httpc should just throw an exception if it encounters a conflict.</comment>
                    <comment id="12743548" author="kocolosk" created="Sat, 15 Aug 2009 05:13:10 +0000 (UTC)"  >Fixed.  If you try to replicate a DB to itself, the replication will proceed, but no checkpoints will be saved, and the logs will say&lt;br/&gt;
&lt;br/&gt;
&amp;quot;checkpoint failure: conflict (are you replicating to yourself?)&amp;quot;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 15 Aug 2009 05:13:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 15 Aug 2009 02:26:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-192] Display query errors in a message panel above the Custom Query editor</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-192</link>

                    <description>Display error messages for bad queries in a message panel above the Custom Query editor. Currently, errors are displayed in a JavaScript alert box. Once the user clicks OK he may forget what the error message was. It would be better to show this in a panel above the editor.</description>
                <environment>Ubuntu 8.10 (eeebuntu), asus eee pc 904hd, couchdb v 0.9.0a729754-incubating.</environment>
            <key id="12411638">COUCHDB-192</key>
        <summary>Display query errors in a message panel above the Custom Query editor</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="lukevenediger">Luke Venediger</reporter>
            
    <created>Sun, 4 Jan 2009 14:17:08 +0000 (UTC)</created>
    <updated>Sun, 4 Jan 2009 14:41:22 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>        <timeestimate seconds="86400">24h</timeestimate>                    

            <comments>
                    <comment id="12660575" author="lukevenediger" created="Sun, 4 Jan 2009 14:41:22 +0000 (UTC)"  >This error was due to the POST url containing an unrecognised query parameter. The url had a query param called &amp;quot;limit&amp;quot;, as in:&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view?limit=10&amp;group=true&quot;&gt;http://127.0.0.1:5984/test/_temp_view?limit=10&amp;amp;group=true&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
This caused the error to return and show up in a message box. However, badly formed javascript does not evoke an error response from the server.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-191] Bad javascript syntax in Futon&apos;s custom query editor doesn&apos;t show an error when run. </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-191</link>

                    <description>In the custom view editor, Futon doesn&apos;t report an error when there is bad syntax in the javascript. &lt;br/&gt;
&lt;br/&gt;
To reproduce:&lt;br/&gt;
1. Browse to &lt;a href=&quot;http://localhost:5984/_utils/&quot;&gt;http://localhost:5984/_utils/&lt;/a&gt;&lt;br/&gt;
2. Open a database&lt;br/&gt;
3. Change the view to &amp;quot;Custom Query...&amp;quot;&lt;br/&gt;
4. In the view code section:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;change: emit(null, doc);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;to: emit(null, doc&lt;br/&gt;
5. Click &amp;quot;Run&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Actual results:&lt;br/&gt;
The page returns with an empty table below the query editor.&lt;br/&gt;
&lt;br/&gt;
Expected results:&lt;br/&gt;
The page should return showing a message like &amp;quot;Error in view. Missing &apos;)&apos; after doc, line 3&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Notes:&lt;br/&gt;
The http response was 200 OK, where it should&apos;ve been a 400 - Bad Request.   </description>
                <environment>OS: EEEubuntu (based on Ubuntu 8.10). Hardware: EEE PC 904hd. Browser: Firefox 3.0.5. </environment>
            <key id="12411635">COUCHDB-191</key>
        <summary>Bad javascript syntax in Futon&apos;s custom query editor doesn&apos;t show an error when run. </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="lukevenediger">Luke Venediger</reporter>
            
    <created>Sun, 4 Jan 2009 10:32:13 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:58 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>        <timeestimate seconds="172800">48h</timeestimate>                    

            <comments>
                    <comment id="12660569" author="lukevenediger" created="Sun, 4 Jan 2009 13:45:08 +0000 (UTC)"  >I&apos;ve just discovered that the page does in fact report the error, via a javascript alertbox. It could probably be a bit more user-friendly, but I&apos;ll close this issue and open a new one with a feature request.</comment>
                    <comment id="12660576" author="lukevenediger" created="Sun, 4 Jan 2009 14:43:46 +0000 (UTC)"  >I resolved this issue in error. My POST request was sending a bad query parameter called &amp;quot;limit&amp;quot; in the url:&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/test/_temp_view?limit=10&amp;group=true&quot;&gt;http://127.0.0.1:5984/test/_temp_view?limit=10&amp;amp;group=true&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Once this is removed, sending malformed javascript does not evoke an error response form the server. Rather, it returns an empty response, with an http status of 200.</comment>
                    <comment id="12772666" author="kocolosk" created="Mon, 2 Nov 2009 20:39:58 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10001">
            <name>dependent</name>
                            <outwardlinks description="depends upon">
                            <issuelink>
            <issuekey id="12403568">COUCHDB-111</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 20:39:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-190] _uuid should respond to GET, not POST</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-190</link>

                    <description>The /_uuid resource can happily return a response to a GET without being unresty. In fact, supporting POST is probably incorrect as it implies it would change server state.&lt;br/&gt;
&lt;br/&gt;
Quick summary:&lt;br/&gt;
&lt;br/&gt;
* _uuid never changes server state&lt;br/&gt;
* calling _uuid multiple times does not impact other clients&lt;br/&gt;
* that the resource returns something different each time it is requested does not mean it cannot be a POST&lt;br/&gt;
* GET with proper cache control (i.e. don&apos;t cache it ever) will work equally well&lt;br/&gt;
&lt;br/&gt;
Full discussion can be found on the user m.l., &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-user/200901.mbox/%3C21939021.1440421230910477169.JavaMail.servlet@perfora%3E&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-user/200901.mbox/%3C21939021.1440421230910477169.JavaMail.servlet@perfora%3E&lt;/a&gt;.</description>
                <environment></environment>
            <key id="12411612">COUCHDB-190</key>
        <summary>_uuid should respond to GET, not POST</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="emgee">Matt Goodall</reporter>
            
    <created>Sat, 3 Jan 2009 15:11:13 +0000 (UTC)</created>
    <updated>Wed, 11 Feb 2009 16:13:32 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666917" author="janl" created="Sat, 24 Jan 2009 12:58:37 +0000 (UTC)"  >Set blocking for 0.9.</comment>
                    <comment id="12667934" author="zdzolton" created="Wed, 28 Jan 2009 04:38:32 +0000 (UTC)"  >* Changed the _uuids handler to use the GET method. &lt;br/&gt;
* Updated the uuid tests to use the GET method.&lt;br/&gt;
* Added test to ensure 405 status is returned for POST requests.&lt;br/&gt;
* Updated CouchDB.newUuids() function to use GET.</comment>
                    <comment id="12670849" author="zdzolton" created="Thu, 5 Feb 2009 18:35:47 +0000 (UTC)"  >Patch to fix COUCH-190:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* Changed /_uuids action to GET instead of POST&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* Added broadly-compatible cache-busting headers to response&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* Added to unit tests to JavaScript suite</comment>
                    <comment id="12671893" author="janl" created="Mon, 9 Feb 2009 15:21:35 +0000 (UTC)"  >From dev@;&lt;br/&gt;
&lt;br/&gt;
The patch looks solid assuming that using a date from 1900 is kosher.&lt;br/&gt;
Getting it accepted means waiting for one of the devs to go on a close&lt;br/&gt;
out spree. Its on the blocking list so don&apos;t worry about it missing&lt;br/&gt;
0.9&lt;br/&gt;
&lt;br/&gt;
HTH,&lt;br/&gt;
Paul Davis&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12672666" author="damienkatz" created="Wed, 11 Feb 2009 16:13:32 +0000 (UTC)"  >Patch merged to trunk.</comment>
                </comments>
    
    <attachments>
            <attachment id="12399582" name="COUCH-190.diff" size="3702" author="zdzolton" created="Thu, 5 Feb 2009 18:35:47 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 11 Feb 2009 16:12:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:58:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-189] couchdb carsh on large attachment upload (282Mb)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-189</link>

                    <description>On openbsd while uploading attachment of size 282Mb ( &lt;a href=&quot;http://www.zshare.net/audio/52598389508eaa43/&quot;&gt;http://www.zshare.net/audio/52598389508eaa43/&lt;/a&gt; ) couchdb crash after some times with error :&lt;br/&gt;
&lt;br/&gt;
eheap_alloc: Cannot allocate 239144240 bytes of memory (of type &amp;quot;heap&amp;quot;).&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>openbsd 4.4-current i386</environment>
            <key id="12411604">COUCHDB-189</key>
        <summary>couchdb carsh on large attachment upload (282Mb)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Fri, 2 Jan 2009 22:20:13 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 12:58:03 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12660407" author="benoitc" created="Fri, 2 Jan 2009 22:21:22 +0000 (UTC)"  >crash dump.</comment>
                    <comment id="12660432" author="jchris" created="Sat, 3 Jan 2009 00:59:16 +0000 (UTC)"  >Was this via a direct attachment PUT or through a document update? It certainly looks like Couch was buffering the file in memory somewhere.</comment>
                    <comment id="12660437" author="benoitc" created="Sat, 3 Jan 2009 01:24:48 +0000 (UTC)"  >Ah indeed forgot to describe it. I just created an empty document and add attachment to it via futon.</comment>
                    <comment id="12666916" author="janl" created="Sat, 24 Jan 2009 12:58:03 +0000 (UTC)"  >The new attachment streaming should have fixed that. Please reopen, if it didn&apos;t.</comment>
                </comments>
    
    <attachments>
            <attachment id="12397039" name="erl_crash.dump" size="543556" author="benoitc" created="Fri, 2 Jan 2009 22:21:22 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:58:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 3 Jan 2009 00:59:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-188] _bulk_docs fails when deleting and adding a doc with the same id</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-188</link>

                    <description>CouchDB returns a &amp;quot;412 Precondition Failed&amp;quot; when the list of changes sent to _bulk_docs deletes a document and later creates a document with the same id as the deleted document:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;docs&amp;quot;: [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;_id&amp;quot;: &amp;quot;docid&amp;quot;, &amp;quot;_rev&amp;quot;: &amp;quot;&amp;lt;rev&amp;gt;&amp;quot;, &amp;quot;_deleted&amp;quot;: true},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;_id&amp;quot;: &amp;quot;docid&amp;quot;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;]}&lt;br/&gt;
&lt;br/&gt;
Once fixed, the response JSON document  will return the same docid twice in the list but it&apos;s presumably ordered consistently with the request data so any client should be able to understand the response.&lt;br/&gt;
&lt;br/&gt;
Demonstrating the problem using curl is easy enough:&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT &lt;a href=&quot;http://localhost:5984/test&quot;&gt;http://localhost:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
&lt;br/&gt;
$ curl -X PUT -d &amp;quot;{}&amp;quot; &lt;a href=&quot;http://localhost:5984/test/docid&quot;&gt;http://localhost:5984/test/docid&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;docid&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;4140747751&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST -d &apos;{&amp;quot;docs&amp;quot;: [{&amp;quot;_id&amp;quot;: &amp;quot;docid&amp;quot;, &amp;quot;_rev&amp;quot;: &amp;quot;4140747751&amp;quot;, &amp;quot;_deleted&amp;quot;: true}, {&amp;quot;_id&amp;quot;: &amp;quot;docid&amp;quot;}]}&apos; &lt;a href=&quot;http://localhost:5984/test/_bulk_docs&quot;&gt;http://localhost:5984/test/_bulk_docs&lt;/a&gt;&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;conflict&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Document update conflict.&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Note: this is likely related to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-172&quot; title=&quot;updating and deleting the same document with _bulk_docs&quot;&gt;&lt;strike&gt;COUCHDB-172&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
</description>
                <environment>CouchDB revision 730414.</environment>
            <key id="12411531">COUCHDB-188</key>
        <summary>_bulk_docs fails when deleting and adding a doc with the same id</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="emgee">Matt Goodall</reporter>
            
    <created>Wed, 31 Dec 2008 17:00:33 +0000 (UTC)</created>
    <updated>Tue, 2 Feb 2010 00:56:52 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666910" author="janl" created="Sat, 24 Jan 2009 12:51:09 +0000 (UTC)"  >bulk update will get a new behaviour in 0.9. Closing</comment>
                    <comment id="12666980" author="emgee" created="Sat, 24 Jan 2009 20:35:02 +0000 (UTC)"  >Agh, sorry! I&apos;ll repost to the list.&lt;br/&gt;
&lt;br/&gt;
- Matt&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[...]&lt;br/&gt;
</comment>
                    <comment id="12666981" author="emgee" created="Sat, 24 Jan 2009 20:35:02 +0000 (UTC)"  >Hi,&lt;br/&gt;
&lt;br/&gt;
I&apos;m a bit confused why this was closed. Perhaps a description of the&lt;br/&gt;
&amp;quot;new behaviour&amp;quot; is available somewhere?&lt;br/&gt;
&lt;br/&gt;
The only mention of anything related to a change in _bulk_docs I&apos;ve&lt;br/&gt;
*noticed* is about not failing everything in the list of updates&lt;br/&gt;
(might be nice if that was optional, actually) and the associated&lt;br/&gt;
error reporting. However, that doesn&apos;t necessarily fix the problem I&lt;br/&gt;
described.&lt;br/&gt;
&lt;br/&gt;
Can anyone explain how the planned change fixes things?&lt;br/&gt;
&lt;br/&gt;
Thanks, Matt&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12689742" author="emgee" created="Thu, 26 Mar 2009 23:46:02 +0000 (UTC)"  >Testing against trunk shows that the new behaviour still has the same error. I think the following test shows the problem.&lt;br/&gt;
&lt;br/&gt;
couchTests.bulkdocs_delete_create = function(debug) {&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var db = new CouchDB(&amp;quot;test_suite_db&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;db.createDb();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var results = db.bulkSave([{_id: &apos;foo&apos;}]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var orig_rev = results[0].rev;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;var results = db.bulkSave([{_id: &apos;foo&apos;, _rev: orig_rev, _deleted: true}, {_id: &apos;foo&apos;}]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(!results[0].error);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(results[1].rev != orig_rev);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(!results[1].error);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T(results[1].rev != orig_rev);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;};&lt;br/&gt;
</comment>
                    <comment id="12779718" author="emgee" created="Wed, 18 Nov 2009 23:01:29 +0000 (UTC)"  >Just came across this issue and tested against the 0.10 branch. It&apos;s still happening, I don&apos;t believe it should ever have been closed.</comment>
                    <comment id="12779736" author="paul.joseph.davis" created="Wed, 18 Nov 2009 23:40:06 +0000 (UTC)"  >&lt;br/&gt;
couchTests.custom_test = function(debug) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var db = new CouchDB(&amp;quot;test_suite_db&amp;quot;, {&amp;quot;X-Couch-Full-Commit&amp;quot;:&amp;quot;false&amp;quot;});&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.deleteDb(); &lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.createDb(); &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var results = db.bulkSave([{_id: &apos;foo&apos;}]); &lt;br/&gt;
&amp;nbsp;&amp;nbsp;var orig_rev = results[0].rev; &lt;br/&gt;
&amp;nbsp;&amp;nbsp;results = db.bulkSave([&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{_id: &apos;foo&apos;, _rev: &amp;quot;2-eec205a9d413992850a6e32678485900&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{_id: &apos;foo&apos;, _rev: orig_rev, _deleted: true}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;alert(JSON.stringify(results));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(results[0].error === undefined);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(results[1].error === undefined);&lt;br/&gt;
};&lt;br/&gt;
&lt;br/&gt;
Slightly interesting, the order of updates is backwards. Also, it works if we specify what the _rev would be after the delete call. </comment>
                    <comment id="12828377" author="janl" created="Tue, 2 Feb 2010 00:56:52 +0000 (UTC)"  >Bump to 0.11 and set blocking.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:51:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-187] suggestion to add html document creation to build system</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-187</link>

                    <description>&amp;gt;  If you would like to create html documentation of your source-code                                 &lt;br/&gt;
&amp;gt;  install, you can do the following ...                                                              &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;  $ cd /path/to/couchdb/src/couchdb                                                                  &lt;br/&gt;
&amp;gt;  $ erl -noshell -eval &amp;quot;edoc:application(couchdb, \&amp;quot;.\&amp;quot;, [])&amp;quot; -s init stop                           &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;  $ cd /path/to/couchdb/src/mochiweb                                                                 &lt;br/&gt;
&amp;gt;  $ erl -noshell -eval &amp;quot;edoc:application(mochiweb, \&amp;quot;.\&amp;quot;, [])&amp;quot; -s init stop                          &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;  The erl command will create a  /src/mochiweb/doc and  src/couchdb/doc                              &lt;br/&gt;
&amp;gt;  directory with the html.                                                                           &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;  edoc had no complaints compiling the documentation as of version                                   &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;  $ couchdb -V                                                                                       &lt;br/&gt;
&amp;gt;  couchdb - Apache CouchDB 0.9.0a729929-incubating                                                   &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;  Then, point browser to &lt;a href=&quot;file:///path/to/couchdb/src/couchdb/doc/index.html&quot;&gt;file:///path/to/couchdb/src/couchdb/doc/index.html&lt;/a&gt;                          &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt; ~Michael                                                                                            &lt;br/&gt;
&amp;gt; P.S. perhaps a doc/index.html target could be added to Makefiles,                                   &lt;br/&gt;
&amp;gt;      something similar to                                                                           &lt;br/&gt;
&amp;gt;                                                                                                     &lt;br/&gt;
&amp;gt; doc/index.html : $(SRC)                                                                             &lt;br/&gt;
&amp;gt;    erl -noshell -eval &amp;quot;edoc:application(couchdb, \&amp;quot;.\&amp;quot;, [])&amp;quot; -s init stop                           &lt;br/&gt;
&amp;gt;    </description>
                <environment>GNU/Linux with Erlang, CouchDB</environment>
            <key id="12411496">COUCHDB-187</key>
        <summary>suggestion to add html document creation to build system</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mmcdanie">Michael McDaniel</reporter>
            
    <created>Tue, 30 Dec 2008 21:37:31 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:38:35 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="14400">4h</timeoriginalestimate>        <timeestimate seconds="14400">4h</timeestimate>                    

    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12407234">COUCHDB-146</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-186] Bookmarkable URLs in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-186</link>

                    <description>This is a nice-to-have: make Futon&apos;s URLs bookmarkable by putting various data about the current page in the URL fragment (after the &apos;#&apos; character).</description>
                <environment></environment>
            <key id="12411483">COUCHDB-186</key>
        <summary>Bookmarkable URLs in Futon</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Tue, 30 Dec 2008 18:01:23 +0000 (UTC)</created>
    <updated>Thu, 8 Jan 2009 10:23:31 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12660404" author="lukevenediger" created="Fri, 2 Jan 2009 22:16:26 +0000 (UTC)"  >This is possible using jquery.history.js. The site uses an iframe for the main content area, so any changes to the iframe would need to update the main window&apos;s hash location. &lt;br/&gt;
&lt;br/&gt;
A simple way to get around it is to attach the iframe&apos;s current path to the end of the main window&apos;s url. So, if the iframe&apos;s on /browse/index.html, the main window&apos;s url would be _utils/#/browse/index.html&lt;br/&gt;
&amp;nbsp;</comment>
                    <comment id="12660462" author="jasondd" created="Sat, 3 Jan 2009 12:50:31 +0000 (UTC)"  >Here&apos;s a working patch that uses jquery.history.js (originally downloaded from &lt;a href=&quot;http://www.mikage.to/jquery/jquery_history.html&quot;&gt;http://www.mikage.to/jquery/jquery_history.html&lt;/a&gt; )&lt;br/&gt;
&lt;br/&gt;
Edit: I was originally unsure whether MIT is compatible with ASF but after reading &lt;a href=&quot;http://apache.org/legal/3party.html&quot;&gt;http://apache.org/legal/3party.html&lt;/a&gt; it looks like it is, so jquery.history.js should be safe to include.</comment>
                    <comment id="12660535" author="lukevenediger" created="Sun, 4 Jan 2009 06:29:07 +0000 (UTC)"  >Wow that works nicely, well done Jason! I&apos;ve clicked around a bit and the url bar is updating. Back and forward browser buttons are also working. So do we mark this as resolved, or does that get done by the couchdb committers?&lt;br/&gt;
</comment>
                    <comment id="12660557" author="jasondd" created="Sun, 4 Jan 2009 10:55:41 +0000 (UTC)"  >Thanks! I&apos;m guessing it&apos;ll be marked as resolved when a committer applies the patch to trunk?&lt;br/&gt;
&lt;br/&gt;
I just noticed that I&apos;d inadvertently included my reduce pagination fix in the first patch above, so I&apos;m attaching a simpler patch now with only the bookmarkable URLs fix.</comment>
                    <comment id="12660560" author="lukevenediger" created="Sun, 4 Jan 2009 12:00:46 +0000 (UTC)"  >Nice! I&apos;ve tested your new patch and it works. I&apos;ve added a feature to update the main window&apos;s document title based on the page you&apos;re on. It also includes the name of the database or document that you&apos;re viewing.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve made a new svn diff patch that has your new changes included. </comment>
                    <comment id="12660599" author="jasondd" created="Sun, 4 Jan 2009 17:24:01 +0000 (UTC)"  >Cool, nice feature addition.  I&apos;ve updated your patch to include jquery.history.js, and I&apos;ve also replaced some tabs with spaces for consistency.</comment>
                    <comment id="12660606" author="lukevenediger" created="Sun, 4 Jan 2009 17:57:50 +0000 (UTC)"  >Cool thanks Jason, I&apos;ll use spaces from here on.</comment>
                    <comment id="12661655" author="jchris" created="Wed, 7 Jan 2009 18:22:11 +0000 (UTC)"  >applied in r732413. Thanks, this is a nice addition!</comment>
                    <comment id="12661926" author="cmlenz" created="Thu, 8 Jan 2009 10:22:30 +0000 (UTC)"  >The jquery.history integration was backed out in r732510, r732511, and r732519 because it caused very irritating &amp;quot;bounce back&amp;quot; effects in Safari.</comment>
                    <comment id="12661927" author="cmlenz" created="Thu, 8 Jan 2009 10:23:31 +0000 (UTC)"  >... and r732675 addresses this issue in a different (cleaner) way, by getting rid of the iframe structure in Futon entirely.</comment>
                </comments>
    
    <attachments>
            <attachment id="12397075" name="bookmarkable_futon.2.diff" size="7379" author="jasondd" created="Sun, 4 Jan 2009 10:55:41 +0000 (UTC)" />
            <attachment id="12397076" name="bookmarkable_futon.3.diff" size="3188" author="lukevenediger" created="Sun, 4 Jan 2009 12:00:46 +0000 (UTC)" />
            <attachment id="12397083" name="bookmarkable_futon.4.diff" size="8604" author="jasondd" created="Sun, 4 Jan 2009 17:24:00 +0000 (UTC)" />
            <attachment id="12397050" name="bookmarkable_futon.diff" size="11262" author="jasondd" created="Sat, 3 Jan 2009 12:50:31 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 8 Jan 2009 10:23:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 2 Jan 2009 22:16:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-185] group=true is silently dropped in non-reduce views</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-185</link>

                    <description>If you query a view without a reduce() function and pass group=true the group parameter is ignored. This does certainly not follow the principle of least astonishment.&lt;br/&gt;
&lt;br/&gt;
One might argue, that requesting grouping on something without reduce is generally an error and thus should result in an HTTP error, but this might break to much existing code.&lt;br/&gt;
&lt;br/&gt;
But at least the fact, that the parameter was ignored should be logged.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;</description>
                <environment></environment>
            <key id="12411363">COUCHDB-185</key>
        <summary>group=true is silently dropped in non-reduce views</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mdornseif">Maximillian Dornseif</reporter>
            
    <created>Sat, 27 Dec 2008 19:06:04 +0000 (UTC)</created>
    <updated>Fri, 20 Mar 2009 10:59:15 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12659367" author="mdornseif" created="Sat, 27 Dec 2008 19:08:01 +0000 (UTC)"  >This is a crude implementation of logging a message when group=true is set on map-only views.</comment>
                    <comment id="12666914" author="janl" created="Sat, 24 Jan 2009 12:56:25 +0000 (UTC)"  >API discussion, set blocking for 0.9.&lt;br/&gt;
&lt;br/&gt;
This could be a &amp;quot;400 Bad Request&amp;quot;:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;10.4.1 400 Bad Request&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;The request could not be understood by the server due to malformed syntax. The client SHOULD NOT repeat the request without modifications.&lt;br/&gt;
&lt;br/&gt;
-- RFC 2616.</comment>
                    <comment id="12669316" author="paul.joseph.davis" created="Sun, 1 Feb 2009 01:57:59 +0000 (UTC)"  >This patch causes an error for any map-view that has a group=true and/or group_level specified. Technically if you group_level=0, it won&apos;t be caught because that&apos;s the default value in the view parameter record.&lt;br/&gt;
&lt;br/&gt;
Also, this introduces a slight bug into Futon the first time you visit a _design/document view that contains a reduce function. Before group=true was basically being passed to everything. I have to get some input from cmlenz on how to detect the _design doc view and if it has a reduce method. Might require some modification to the view drop down etc.&lt;br/&gt;
&lt;br/&gt;
Also, this throws an error just like all other query_parse_errors, so I think it&apos;s technically a 500 error instead of a 400 as suggested.&lt;br/&gt;
&lt;br/&gt;
Includes test case in the couch_tests.js</comment>
                    <comment id="12683842" author="jchris" created="Fri, 20 Mar 2009 10:59:15 +0000 (UTC)"  >fixed in r756413</comment>
                </comments>
    
    <attachments>
            <attachment id="12399219" name="COUCHDB-185.patch" size="3838" author="paul.joseph.davis" created="Sun, 1 Feb 2009 01:57:59 +0000 (UTC)" />
            <attachment id="12396798" name="group-drop-warning.patch" size="1243" author="mdornseif" created="Sat, 27 Dec 2008 19:08:01 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 20 Mar 2009 10:59:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:56:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-184] Send Etag for standalone attachment requests</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-184</link>

                    <description>GET /db/doc/fie.txt does not send an Etag header. The attached patch adds this header based on the containing document&apos;s `_rev`-value. Includes a test.</description>
                <environment></environment>
            <key id="12411327">COUCHDB-184</key>
        <summary>Send Etag for standalone attachment requests</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Thu, 25 Dec 2008 18:27:45 +0000 (UTC)</created>
    <updated>Mon, 29 Dec 2008 20:14:53 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12659641" author="janl" created="Mon, 29 Dec 2008 20:14:53 +0000 (UTC)"  >added in r729992</comment>
                </comments>
    
    <attachments>
            <attachment id="12396774" name="attachment-etag.diff" size="1601" author="janl" created="Thu, 25 Dec 2008 18:29:47 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Dec 2008 20:14:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-183] No pagination in Futon for reduce views</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-183</link>

                    <description>Futon doesn&apos;t support paginating of reduce views at the moment, which can be confusing for new users.  This is due to the difficulty of efficiently working out the total number of rows available from a reduce view.&lt;br/&gt;
&lt;br/&gt;
I propose displaying something like &amp;quot;Showing x-y rows of unknown&amp;quot; at the bottom, and showing a next/previous link if there are more results to be displayed.  An efficient way to calculate whether there are next/previous results would be to fetch 1 + rows_per_page + 1 (with appropriate offset parameter etc.)&lt;br/&gt;
&lt;br/&gt;
I did start working on a patch - will post it here when it is done.</description>
                <environment></environment>
            <key id="12411302">COUCHDB-183</key>
        <summary>No pagination in Futon for reduce views</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Wed, 24 Dec 2008 16:09:57 +0000 (UTC)</created>
    <updated>Fri, 20 Mar 2009 12:18:43 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12659153" author="jasondd" created="Wed, 24 Dec 2008 20:34:06 +0000 (UTC)"  >This patch enables pagination for reduce views in Futon.&lt;br/&gt;
&lt;br/&gt;
Still to do:&lt;br/&gt;
&amp;nbsp;a) it currently always shows next/prev links even if they link to a page containing no rows&lt;br/&gt;
&amp;nbsp;b) if you continue to the next/prev page from a zero-row page it will show rows from the beginning/end of the keyspace respectively (giving the illusion of a circular ordering, perhaps not ideal!)</comment>
                    <comment id="12676376" author="jasondd" created="Tue, 24 Feb 2009 19:37:45 +0000 (UTC)"  >Updated patch for latest trunk (r747465).  Also the next/prev links are now disabled appropriately when at beginning or end of the keyspace.&lt;br/&gt;
&lt;br/&gt;
Still to do: get rid of empty pages at beinning/end of keyspace.  This is a nice-to-have feature, and will involve fetching rows_per_page + 1 so we know whether to enable next/prev buttons or not.</comment>
                    <comment id="12682453" author="jasondd" created="Mon, 16 Mar 2009 20:44:05 +0000 (UTC)"  >Updated patch to fetch rows_per_page + 1 rows so that the next/prev links can be enabled/disabled appropriately.  This is done for both reduce and non-reduce views as we can&apos;t tell which they are until the response is returned.</comment>
                    <comment id="12682649" author="janl" created="Tue, 17 Mar 2009 12:06:12 +0000 (UTC)"  >I applied the patch to my local copy and using reduce pagination looks sold.</comment>
                    <comment id="12683860" author="jchris" created="Fri, 20 Mar 2009 12:18:43 +0000 (UTC)"  >applied in r756428</comment>
                </comments>
    
    <attachments>
            <attachment id="12400875" name="futon_reduce_pagination.2.diff" size="4373" author="jasondd" created="Tue, 24 Feb 2009 19:37:45 +0000 (UTC)" />
            <attachment id="12402314" name="futon_reduce_pagination.3.diff" size="6185" author="jasondd" created="Mon, 16 Mar 2009 20:44:05 +0000 (UTC)" />
            <attachment id="12396749" name="futon_reduce_pagination.diff" size="3805" author="jasondd" created="Wed, 24 Dec 2008 20:34:06 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 20 Mar 2009 12:18:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 17 Mar 2009 12:06:12 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-182] README file issues</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-182</link>

                    <description>The README file contains the following lines:&lt;br/&gt;
&lt;br/&gt;
To load the launchd configuration you must run the following command:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;sudo launchctl load /usr/local/Library/LaunchDaemons/org.apache.couchdb&lt;br/&gt;
&lt;br/&gt;
You can stop the Apache CouchDB daemon by running the following command:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;sudo launchctl unload /usr/local/Library/LaunchDaemons/org.apache.couchdb&lt;br/&gt;
&lt;br/&gt;
In both commands, the file name needs to have &amp;quot;.plist&amp;quot; appended.</description>
                <environment>Mac OS X 10.5, Power Mac G5</environment>
            <key id="12411286">COUCHDB-182</key>
        <summary>README file issues</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rdm@cfcl.com">Rich Morin</reporter>
            
    <created>Wed, 24 Dec 2008 05:15:00 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 12:54:02 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666912" author="janl" created="Sat, 24 Jan 2009 12:54:02 +0000 (UTC)"  >This has been fixed in trunk. Thanks Rich.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:54:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:54:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-181] Should check permissions when starting</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-181</link>

                    <description>When couchdb starts up it should check and warn about permissions on files and directories that it needs to write in/on. Now it just starts, outputs the config (does it always do that when something is wrong?) and does nothing.&lt;br/&gt;
&lt;br/&gt;
~/soffa % sudo -u nobody bin/couchdb &lt;br/&gt;
Apache CouchDB 0.8.1-incubating (LogLevel=info)&lt;br/&gt;
Apache CouchDB is starting.&lt;br/&gt;
&lt;br/&gt;
Config Info /home/simmel/soffa/etc/couchdb/couch.ini:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;CurrentWorkingDir=/home/simmel/soffa&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;DbRootDir=/home/simmel/soffa/var/lib/couchdb&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;BindAddress=&amp;quot;127.0.0.1&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Port=&amp;quot;5984&amp;quot;                                                             &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;DocumentRoot=/home/simmel/soffa/share/couchdb/www&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;LogFile=/home/simmel/soffa/var/log/couchdb/couch.log&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;UtilDriverDir=/home/simmel/soffa/lib/couchdb/erlang/lib/couch-0.8.1-incu&lt;br/&gt;
bating/priv/lib&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;DbUpdateNotificationProcesses=&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;FullTextSearchQueryServer=&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;javascript=/home/simmel/soffa/bin/couchjs /home/simmel/soffa/share/couch&lt;br/&gt;
db/server/main.js&lt;br/&gt;
&lt;br/&gt;
The issue here is that ~/soffa/var/ is not writeable for the nobody user but couchdb should warn about it.</description>
                <environment>OpenBSD 4.4-RELEASE, Erlang 5.6.3</environment>
            <key id="12411238">COUCHDB-181</key>
        <summary>Should check permissions when starting</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="simmel">Simon Lundstrom</reporter>
            
    <created>Tue, 23 Dec 2008 11:14:36 +0000 (UTC)</created>
    <updated>Tue, 23 Dec 2008 11:14:36 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-180] Too many view files may be held open, rendering CouchDB unusable</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-180</link>

                    <description>On trunk (rev 728285), CouchDB will hold onto view files for a certain request pattern. &lt;br/&gt;
&lt;br/&gt;
Once a threshold of open files has been exceeded, all requests to CouchDB will result in {error,emfile}.&lt;br/&gt;
&lt;br/&gt;
The attached test case runs through the following sequence n times.&lt;br/&gt;
&lt;br/&gt;
delete db&lt;br/&gt;
create db&lt;br/&gt;
create doc&lt;br/&gt;
query non existant view&lt;br/&gt;
create view&lt;br/&gt;
query view&lt;br/&gt;
&lt;br/&gt;
On my machine a value of about 250 for n is enough for the threshold to be exceeded. Regardless, running lsof clearly shows CouchDB holding multiple refs to the same view file.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;</description>
                <environment>OS X 10.5.5</environment>
            <key id="12411095">COUCHDB-180</key>
        <summary>Too many view files may be held open, rendering CouchDB unusable</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Sat, 20 Dec 2008 16:39:11 +0000 (UTC)</created>
    <updated>Mon, 22 Dec 2008 23:29:06 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12658315" author="paul.joseph.davis" created="Sat, 20 Dec 2008 19:29:48 +0000 (UTC)"  >In this particular case the error is stemming from the fact that the gen_server in couch_view_group.erl was not closing it&apos;s view file descriptor contained in the Group. Looking around I noticed that there are a couple places where we&apos;re not closing the file descriptor properly so I just put the call to close in terminate/2.&lt;br/&gt;
&lt;br/&gt;
I don&apos;t actually think this is the correct patch to apply because I&apos;m pretty sure there are corner cases in temp views that could cause breakage. (Specifcally, one temp view hitting a reset condition and then causing the entire file to be closed even out from underneath other temp views.)&lt;br/&gt;
&lt;br/&gt;
The proper answer to this I think will be to make sure that all view files are opened in the ref_counted mode which also means that couch_view will require work to deref all it&apos;s temp view file handles etc. Damien mentioned at one point that the fd even for permanent views should be opened by couch_view. This could work but a few of the reset functions will need to be switched from an outright delete to a truncate so as to not confuse couch_view.&lt;br/&gt;
&lt;br/&gt;
Anyone have other ideas?</comment>
                </comments>
    
    <attachments>
            <attachment id="12396548" name="COUCHDB-180.patch" size="1534" author="paul.joseph.davis" created="Sat, 20 Dec 2008 19:29:48 +0000 (UTC)" />
            <attachment id="12396544" name="test_for_open_files.js" size="556" author="paul.p.carey@gmail.com" created="Sat, 20 Dec 2008 16:39:41 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 22 Dec 2008 23:29:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 20 Dec 2008 19:29:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-179] CouchDB crashes when GETting view from a legacy DB</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-179</link>

                    <description>Working with a legacy DB (which works just fine with version r725308) makes beam.smp use up all the memory until it is killed by the kernel.&lt;br/&gt;
&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&apos;mailto:couchdb@dyc-ucbdesk&apos;&gt;couchdb@dyc-ucbdesk&lt;/a&gt;:/opt/couchdb-trunk-dk-fix$ ./bin/couchdb -i&lt;br/&gt;
Erlang (BEAM) emulator version 5.6.4 [source] [64-bit] [smp:2] [async-threads:0] [hipe] [kernel-poll:true]&lt;br/&gt;
&lt;br/&gt;
Eshell V5.6.4  (abort with ^G)&lt;br/&gt;
1&amp;gt; Apache CouchDB 0.9.0a727978-incubating (LogLevel=info) is starting.&lt;br/&gt;
[info] [&amp;lt;0.67.0&amp;gt;] Starting process for: action&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
&lt;br/&gt;
1&amp;gt; SyntaxError: syntax error&lt;br/&gt;
&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
eheap_alloc: Cannot allocate 1167696400 bytes of memory (of type &amp;quot;heap&amp;quot;).&lt;br/&gt;
Aborted&lt;br/&gt;
&lt;br/&gt;
It looks like it tries to recompute the view on GETting it.&lt;br/&gt;
&lt;br/&gt;
View&lt;br/&gt;
&lt;br/&gt;
index/by_timestamp&lt;br/&gt;
map:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;emit(doc.timestamp, null);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
DB size is .5G, avg doc size is 3M, doc structure:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&apos;text&apos;: &apos;long string ... really long&apos;,&lt;br/&gt;
&amp;nbsp;&apos;id&apos;: &apos;my IDS&apos;,&lt;br/&gt;
&amp;nbsp;&apos;timestamp&apos;: &apos;date&apos; // e.g. 2008-12-13T03:51:57.732618&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
default.ini and local.ini for latest couchdb are not changed at all except for the DB dir location.</description>
                <environment>uname -a&lt;br/&gt;
Linux dyc-ucbdesk 2.6.24-22-generic #1 SMP Mon Nov 24 19:35:06 UTC 2008 x86_64 GNU/Linux&lt;br/&gt;
erl&lt;br/&gt;
Erlang (BEAM) emulator version 5.6.4 [source] [64-bit] [smp:2] [async-threads:0] [hipe] [kernel-poll:true]&lt;br/&gt;
CouchDB&lt;br/&gt;
Apache CouchDB 0.9.0a727978-incubating (LogLevel=info) is starting.</environment>
            <key id="12411043">COUCHDB-179</key>
        <summary>CouchDB crashes when GETting view from a legacy DB</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ulises">Ulises Cervino Beresi</reporter>
            
    <created>Fri, 19 Dec 2008 12:00:48 +0000 (UTC)</created>
    <updated>Sat, 21 Nov 2009 17:13:14 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12781010" author="kocolosk" created="Sat, 21 Nov 2009 17:13:14 +0000 (UTC)"  >We broke backwards compatibility in the 0.9.0 release.  Reading legacy DBs requires a dump and reimport</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:13:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Nov 2009 17:13:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-178] $PREFIX/etc/default/couchdb not installed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-178</link>

                    <description>/usr/local/etc/default/couchdb isn&apos;t installed on a fresh checkout of trunk under Ubuntu 8.10. As a result, the default init script creates couchdb.stdout and couchdb.stderr files in the current directory when run.</description>
                <environment>Ubuntu 8.10</environment>
            <key id="12410666">COUCHDB-178</key>
        <summary>$PREFIX/etc/default/couchdb not installed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nolan">Nolan Darilek</reporter>
            
    <created>Sun, 14 Dec 2008 20:19:40 +0000 (UTC)</created>
    <updated>Fri, 20 Mar 2009 17:10:28 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12682199" author="nslater" created="Mon, 16 Mar 2009 02:06:30 +0000 (UTC)"  >This works for me, can someone else confirm please, or I will close.&lt;br/&gt;
&lt;br/&gt;
Would like to see the output from &amp;quot;make install&amp;quot; included.&lt;br/&gt;
</comment>
                    <comment id="12682202" author="dundeemt" created="Mon, 16 Mar 2009 02:28:50 +0000 (UTC)"  >as of couchdb - Apache CouchDB 0.9.0a752084 I am no longer experiencing this situation on Ubuntu 8.04&lt;br/&gt;
&lt;br/&gt;
# etc/default/couchdb.tpl.  Generated from couchdb.tpl.in by configure.&lt;br/&gt;
&lt;br/&gt;
# Sourced by init script for configuration.&lt;br/&gt;
&lt;br/&gt;
COUCHDB_USER=couchdb&lt;br/&gt;
COUCHDB_INI_FILE=/usr/local/etc/couchdb/couch.ini&lt;br/&gt;
COUCHDB_PID_FILE=/usr/local/var/run/couchdb.pid&lt;br/&gt;
COUCHDB_STDOUT_FILE=/dev/null&lt;br/&gt;
COUCHDB_STDERR_FILE=/dev/null&lt;br/&gt;
COUCHDB_RESPAWN_TIMEOUT=5&lt;br/&gt;
&lt;br/&gt;
However, on Ubuntu 8.10&lt;br/&gt;
/usr/local/etc/default/couchdb does not exist and couchdb.stdout / couchdb.stderr are created in what ever directory you issue the start/restart command from.&lt;br/&gt;
&lt;br/&gt;
I am including the output of sudo make install </comment>
                    <comment id="12682210" author="paul.joseph.davis" created="Mon, 16 Mar 2009 03:19:49 +0000 (UTC)"  >After a clean install on Ubuntu 8.10 I am also experiencing no $PREFIX/etc/default action.&lt;br/&gt;
&lt;br/&gt;
I&apos;m attaching both the config.log and `sudo make install` output for reference.</comment>
                    <comment id="12682343" author="amoshayes" created="Mon, 16 Mar 2009 16:01:38 +0000 (UTC)"  >I have the same result as Paul.</comment>
                    <comment id="12683945" author="nslater" created="Fri, 20 Mar 2009 17:10:27 +0000 (UTC)"  >Fixed in r756618. Thank you.</comment>
                </comments>
    
    <attachments>
            <attachment id="12402237" name="config.log" size="28278" author="paul.joseph.davis" created="Mon, 16 Mar 2009 03:19:49 +0000 (UTC)" />
            <attachment id="12402236" name="makeinstall.out" size="35325" author="paul.joseph.davis" created="Mon, 16 Mar 2009 03:19:49 +0000 (UTC)" />
            <attachment id="12402234" name="output.txt" size="36620" author="dundeemt" created="Mon, 16 Mar 2009 02:28:50 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 20 Mar 2009 17:10:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Mar 2009 02:06:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-177] Malformed JSON returned by keys based query</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-177</link>

                    <description>If not all keys exist for a keys based query on a reduce view, malformed JSON may be returned. &lt;br/&gt;
&lt;br/&gt;
The attached test case queries a view that returns an array commencing with a comma character.&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;rows&amp;quot;:[,{&amp;quot;key&amp;quot;:&amp;quot;1&amp;quot;,&amp;quot;value&amp;quot;:1}]}</description>
                <environment></environment>
            <key id="12410657">COUCHDB-177</key>
        <summary>Malformed JSON returned by keys based query</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Sun, 14 Dec 2008 16:39:05 +0000 (UTC)</created>
    <updated>Tue, 16 Dec 2008 22:03:40 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12656412" author="paul.joseph.davis" created="Sun, 14 Dec 2008 17:03:06 +0000 (UTC)"  >This fixes it. The couch_httpd_view reduce output method wasn&apos;t respecting the AccSeparator character returned after couch_view:reduce_fold.</comment>
                    <comment id="12657185" author="jchris" created="Tue, 16 Dec 2008 22:03:40 +0000 (UTC)"  >fixed in r727156</comment>
                </comments>
    
    <attachments>
            <attachment id="12396033" name="COUCHDB-177.patch" size="988" author="paul.joseph.davis" created="Sun, 14 Dec 2008 17:03:06 +0000 (UTC)" />
            <attachment id="12396030" name="keys_based_query.sh" size="546" author="paul.p.carey@gmail.com" created="Sun, 14 Dec 2008 16:39:26 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 16 Dec 2008 22:03:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 14 Dec 2008 17:03:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-176] Test Suite fails to run</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-176</link>

                    <description>Installed CouchDB trunk from SVN, (chmod|chown) -R couchdb (/usr/local/etc/couchdb | /usr/local/var/lib/couchdb | /usr/local/var/log/couchdb), ran couchdb as couchdb user (sudo -u couchdb couchdb). Went to &lt;a href=&quot;http://127.0.0.1:5984/_utils/index.html,&quot;&gt;http://127.0.0.1:5984/_utils/index.html,&lt;/a&gt; clicked Test Suite, clicked Run All, was presented with errors.&lt;br/&gt;
&lt;br/&gt;
The first test fails with&lt;br/&gt;
&lt;br/&gt;
basics	error	1248ms	 &lt;br/&gt;
&lt;br/&gt;
Assertion failed: db.info().db_name == &amp;quot;test_suite_db&amp;quot;&lt;br/&gt;
Assertion failed: db.info().doc_count == 0&lt;br/&gt;
Assertion failed: db.info().doc_count == 4&lt;br/&gt;
Exception raised: {&amp;quot;error&amp;quot;:&amp;quot;conflict&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Document update conflict.&amp;quot;,&amp;quot;stacktrace&amp;quot;:&amp;quot;n/a; see &apos;opera:config#UserPrefs|Exceptions Have Stacktrace&apos;\u0000&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
All subsequent tests (until an apparent hang at view_collation) failed with (e.g.):&lt;br/&gt;
&lt;br/&gt;
all_docs	error	16ms	 &lt;br/&gt;
&lt;br/&gt;
Exception raised: {&amp;quot;error&amp;quot;:&amp;quot;file_exists&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;The database could not be created, the file already exists.&amp;quot;,&amp;quot;stacktrace&amp;quot;:&amp;quot;n/a; see &apos;opera:config#UserPrefs|Exceptions Have Stacktrace&apos;\u0000&amp;quot;}</description>
                <environment>Apache CouchDB 0.9.0a725828-incubating compiled from SVN on OS X 10.5.5, erlang 5.6.5, Opera 9.62</environment>
            <key id="12410521">COUCHDB-176</key>
        <summary>Test Suite fails to run</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="weilawei">Rob Crowther</reporter>
            
    <created>Thu, 11 Dec 2008 22:58:46 +0000 (UTC)</created>
    <updated>Tue, 16 Dec 2008 21:24:43 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12655834" author="kocolosk" created="Fri, 12 Dec 2008 00:58:13 +0000 (UTC)"  >Hi, I can reproduce this one.  It looks like db.deleteDb() is a no-op with Opera 9.62 (at least the DELETE operation never shows up in the log).  As a result db.createDb() results in a 409 every time.&lt;br/&gt;
&lt;br/&gt;
Adam</comment>
                    <comment id="12657168" author="jchris" created="Tue, 16 Dec 2008 21:24:43 +0000 (UTC)"  >Rob,&lt;br/&gt;
&lt;br/&gt;
We&apos;re currently supporting just Firefox 3 with the Test Suite. We&apos;ve got nothing against other browsers, it&apos;s just easier to debug CouchDB if we&apos;re not also debugging an HTTP stack implementation. Does the test suite pass for you on FF?&lt;br/&gt;
&lt;br/&gt;
If you have an idea about how to get DELETE support working in Opera, we&apos;d love a patch.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 16 Dec 2008 21:24:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 00:58:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-175] configure accepts ICU version &gt;=3.0, but it won&apos;t compile without 3.4.1</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-175</link>

                    <description>configure passes with ICU 3.0, but make says:&lt;br/&gt;
couch_erl_driver.c:27:30: unicode/ucasemap.h: No such file or directory&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
make is right, because that file does not exist in ICU versions before 3.4.1</description>
                <environment>CentOS 4 with ICU build from source from &lt;a href=&quot;http://icu-project.org/download/&quot;&gt;http://icu-project.org/download/&lt;/a&gt;</environment>
            <key id="12410414">COUCHDB-175</key>
        <summary>configure accepts ICU version &gt;=3.0, but it won&apos;t compile without 3.4.1</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="juozasg">Juozas Gaigalas</reporter>
            
    <created>Wed, 10 Dec 2008 23:32:57 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 12:52:45 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="1200">0.33h</timeoriginalestimate>        <timeestimate seconds="1200">0.33h</timeestimate>                    

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-174] Docs with lots of revisions break replication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-174</link>

                    <description>When replicating from a remote source CouchDB uses the open_revs query string parameter in a document request and supplies a list of revisions that are present on the source but not on the target.  If this list is very large the resulting URL might exceed 8 KB, in which case MochiWeb/gen_tcp will not serve the request.&lt;br/&gt;
&lt;br/&gt;
I&apos;m sure there are a number of ways to work around this limitation.  I&apos;m attaching a patch that checks if the URL formed from the list of revs to open will be larger than 8 KB, and if so chunks the list and makes multiple smaller requests.  Best,&lt;br/&gt;
&lt;br/&gt;
Adam</description>
                <environment></environment>
            <key id="12410338">COUCHDB-174</key>
        <summary>Docs with lots of revisions break replication</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Wed, 10 Dec 2008 05:16:11 +0000 (UTC)</created>
    <updated>Tue, 16 Dec 2008 22:24:23 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12657194" author="jchris" created="Tue, 16 Dec 2008 22:24:23 +0000 (UTC)"  >fixed in r727182</comment>
                </comments>
    
    <attachments>
            <attachment id="12395715" name="couch_rep.diff" size="1807" author="kocolosk" created="Wed, 10 Dec 2008 05:16:59 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 16 Dec 2008 22:24:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 16 Dec 2008 22:24:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-173] autoconfig rerun weirdness</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-173</link>

                    <description>When I ./bootstrap &amp;amp;&amp;amp; ./configure &amp;amp;&amp;amp; make &amp;amp;&amp;amp; make install trunk and then tweak configure.ac and run make again, make runs all the autotools again, with this result:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&lt;a href=&apos;mailto:jan@jan-lehnardts-macbook&apos;&gt;jan@jan-lehnardts-macbook&lt;/a&gt; ~/Work/couchdb-all/branches/use-osx-bundled-icu2&amp;gt; make                                                                                           &lt;br/&gt;
cd . &amp;amp;&amp;amp; /bin/sh /Users/jan/Work/couchdb-all/branches/use-osx-bundled-icu2/build-aux/missing --run aclocal-1.10                                                            &lt;br/&gt;
cd . &amp;amp;&amp;amp; /bin/sh /Users/jan/Work/couchdb-all/branches/use-osx-bundled-icu2/build-aux/missing --run automake-1.10 --foreign                                                 &lt;br/&gt;
cd . &amp;amp;&amp;amp; /bin/sh /Users/jan/Work/couchdb-all/branches/use-osx-bundled-cu2/build-aux/missing --run autoconf                                                                &lt;br/&gt;
configure.ac:107: error: possibly undefined macro: AC_CHECK_CURL                                     &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;If this token and others are legitimate, please use m4_pattern_allow. See the Autoconf documentation.                                                                 &lt;br/&gt;
make: *** [configure] Error 1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
Running ./bootstrap &amp;amp;&amp;amp; ./configure manually works.&lt;br/&gt;
&lt;br/&gt;
Only that that fails with the &amp;quot;possibly undefined AC_CHECK_URL&amp;quot; error. it is not smart enough to do what ./bootstrap does.</description>
                <environment></environment>
            <key id="12410087">COUCHDB-173</key>
        <summary>autoconfig rerun weirdness</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Fri, 5 Dec 2008 15:58:26 +0000 (UTC)</created>
    <updated>Fri, 5 Dec 2008 17:51:43 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12653875" author="janl" created="Fri, 5 Dec 2008 17:51:43 +0000 (UTC)"  >dupe of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-165&quot; title=&quot;Automatic autotools invocation fails&quot;&gt;&lt;strike&gt;COUCHDB-165&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 5 Dec 2008 17:51:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 5 Dec 2008 17:51:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-172] updating and deleting the same document with _bulk_docs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-172</link>

                    <description>Trying to update and delete the same document with a single _bulk_docs POST should generate a 412 conflict error, but it does not.  I&apos;ll attach a patch shortly which includes a failing test.  See also mid:&lt;a href=&apos;mailto:20081203163944.GW13753@ginosko.local&apos;&gt;20081203163944.GW13753@ginosko.local&lt;/a&gt; and the ensuing thread on couchdb-dev.</description>
                <environment></environment>
            <key id="12410021">COUCHDB-172</key>
        <summary>updating and deleting the same document with _bulk_docs</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mndrix">Michael Hendricks</reporter>
            
    <created>Thu, 4 Dec 2008 22:50:33 +0000 (UTC)</created>
    <updated>Sat, 21 Mar 2009 14:44:15 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12653532" author="mndrix" created="Thu, 4 Dec 2008 22:51:37 +0000 (UTC)"  >Adds a failing test for conflicting _bulk_docs usage</comment>
                    <comment id="12666911" author="janl" created="Sat, 24 Jan 2009 12:52:25 +0000 (UTC)"  >Leaving this one open so we have a reminder.</comment>
                    <comment id="12669341" author="paul.joseph.davis" created="Sun, 1 Feb 2009 04:57:01 +0000 (UTC)"  >This patch shows that updating and deleting a doc actually does trigger a conflict error. There&apos;s a slight different in that the original patch never edits the doc, dunno if this means that couchdb is smart enough to not change the rev when there&apos;s no update or there was a fix somewhere else. Either or, patch should demonstrate the reported bug is invalid.</comment>
                    <comment id="12688036" author="jchris" created="Sat, 21 Mar 2009 14:44:15 +0000 (UTC)"  >regression test applied in r756953 (passes with no other work)</comment>
                </comments>
    
    <attachments>
            <attachment id="12395342" name="0001-Failing-test-for-conflicting-bulk_docs.patch" size="1135" author="mndrix" created="Thu, 4 Dec 2008 22:51:37 +0000 (UTC)" />
            <attachment id="12399225" name="COUCHDB-172.patch" size="799" author="paul.joseph.davis" created="Sun, 1 Feb 2009 04:57:01 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 21 Mar 2009 14:44:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:52:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-171] Futon app not showing data in Firefox3.1b2</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-171</link>

                    <description>No data is displayed in the Futon application under Firefox3.1b2. Checked against Camino and Safari and both work.</description>
                <environment>Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b2) Gecko/20081125 Firefox/3.1b2</environment>
            <key id="12409890">COUCHDB-171</key>
        <summary>Futon app not showing data in Firefox3.1b2</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="a.schiavini">Andrea Schiavini</reporter>
            
    <created>Thu, 4 Dec 2008 08:07:59 +0000 (UTC)</created>
    <updated>Sat, 10 Jan 2009 18:22:08 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12653232" author="djc" created="Thu, 4 Dec 2008 09:14:43 +0000 (UTC)"  >This is because of a bug in Firefox: &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=459161&quot;&gt;https://bugzilla.mozilla.org/show_bug.cgi?id=459161&lt;/a&gt;.</comment>
                    <comment id="12662346" author="shelmberger" created="Fri, 9 Jan 2009 12:05:07 +0000 (UTC)"  >This patch temporarily fixes the issue by changing json2.js to always create a new JSON object when loaded.</comment>
                    <comment id="12662651" author="shelmberger" created="Sat, 10 Jan 2009 11:21:36 +0000 (UTC)"  >An update for the initial patch. This one is a little less hackish. It actually checks whether JSON.stringify misbehaves in a firefox3.1beta specific way before overwriting the native JSON impl with a new one.</comment>
                    <comment id="12662672" author="djc" created="Sat, 10 Jan 2009 16:45:40 +0000 (UTC)"  >I&apos;m not completely sure this is worth fixing in Futon if it&apos;s a Firefox bug that will be fixed soon (before 3.1 comes out, anyway... might even be before 3.1b3 comes out, which should be this month).</comment>
                    <comment id="12662681" author="shelmberger" created="Sat, 10 Jan 2009 18:22:08 +0000 (UTC)"  >not sure if it&apos;s worth it either.. but it&apos;s a working fix people can apply themselves.. and it was really easy to write..</comment>
                </comments>
    
    <attachments>
            <attachment id="12397601" name="futon_firefox3.1beta-updated.patch" size="592" author="shelmberger" created="Sat, 10 Jan 2009 11:21:36 +0000 (UTC)" />
            <attachment id="12397506" name="futon_firefox3.1beta_fix.patch" size="415" author="shelmberger" created="Fri, 9 Jan 2009 12:05:07 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Jan 2009 18:25:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 4 Dec 2008 09:14:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-170] user provided javascript lib path should precede system library paths</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-170</link>

                    <description>In configure.ac, this line:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;LIB_FLAGS=&amp;quot;-L/usr/local/lib -L/opt/local/lib $JS_LIB_FLAGS&amp;quot;&lt;br/&gt;
&lt;br/&gt;
makes it difficult to provide an alternative path to the javascript library, which you might want to provide when building couch for use in a standalone environment such as CouchDBX. That line would be better as:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;LIB_FLAGS=&amp;quot;$JS_LIB_FLAGS -L/usr/local/lib -L/opt/local/lib&amp;quot;&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>OSX 10.5</environment>
            <key id="12409869">COUCHDB-170</key>
        <summary>user provided javascript lib path should precede system library paths</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="antonyblakey">Antony Blakey</reporter>
            
    <created>Thu, 4 Dec 2008 02:34:01 +0000 (UTC)</created>
    <updated>Wed, 18 Feb 2009 09:55:04 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12674553" author="janl" created="Wed, 18 Feb 2009 09:55:04 +0000 (UTC)"  >This is fixed in r745459. Thanks for reporting.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 18 Feb 2009 09:55:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 18 Feb 2009 09:55:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-169] POSIX shell incompatibilities </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-169</link>

                    <description>&amp;gt; My local &amp;quot;checkbashisms&amp;quot; doesn&apos;t seem to complain at all. The [ ... ] syntax is just a shortcut for &amp;quot;test&amp;quot; and I would prefer to avoid it if possible. Could you check for me that using &amp;quot;test expr&amp;quot; wouldn&apos;t work in its place.                                       &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
No, &amp;quot;test expr&amp;quot; doesn&apos;t work. After test you can only have arguments to test, not shell expressions. It is possible of course to do:                                            &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
if test `echo 2&amp;gt; /dev/null &amp;gt;&amp;gt; $PID_FILE; echo $?` -gt 0; then                                           &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
For proof, see the man page: &lt;a href=&quot;http://docs.sun.com/app/docs/doc/816-5165/test-1?l=en&amp;q=man&amp;a=view&quot;&gt;http://docs.sun.com/app/docs/doc/816-5165/test-1?l=en&amp;amp;q=man&amp;amp;a=view&lt;/a&gt;         &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;gt; This seems reasonable, though checkbashisms doesn&apos;t report anything.                                  &lt;br/&gt;
&amp;gt;                                                                                                       &lt;br/&gt;
&amp;gt; I am wondering if your Solaris shell is POSIXly correct. Could you provide me with a pointer to its manual, please?                                                                 &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
It doesn&apos;t get more POSIX than Solaris :).                                                              &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
$ /bin/sh                                                                                               &lt;br/&gt;
$ echo $(echo yes)                                                                                      &lt;br/&gt;
syntax error: `(&apos; unexpected                                                                            &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
Here is the man page. Note that the &amp;quot;Command substitution&amp;quot; section doesn&apos;t mention anything about $() syntax.                                                                      &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&lt;a href=&quot;http://docs.sun.com/app/docs/doc/816-5165/sh-1?l=en&amp;q=man&amp;a=view&quot;&gt;http://docs.sun.com/app/docs/doc/816-5165/sh-1?l=en&amp;amp;q=man&amp;amp;a=view&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
You may want to have a our collaborative notes over there:     &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;- &lt;a href=&quot;http://wiki.joyent.com/accelerators:setup-couchdb&quot;&gt;http://wiki.joyent.com/accelerators:setup-couchdb&lt;/a&gt;                                                     &lt;br/&gt;
&amp;nbsp;- &lt;a href=&quot;http://discuss.joyent.com/viewtopic.php?id=24108&quot;&gt;http://discuss.joyent.com/viewtopic.php?id=24108&lt;/a&gt;  </description>
                <environment>Solaris</environment>
            <key id="12409766">COUCHDB-169</key>
        <summary>POSIX shell incompatibilities </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Wed, 3 Dec 2008 16:13:53 +0000 (UTC)</created>
    <updated>Fri, 20 Mar 2009 17:28:13 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12683954" author="nslater" created="Fri, 20 Mar 2009 17:28:13 +0000 (UTC)"  >Fixed in r756665. Thank you.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 20 Mar 2009 17:28:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-168] allow user-configurable directory for view indexes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-168</link>

                    <description>Hi, I&apos;d like to be able to store the DBs and the view indexes in separate locations.  This patch creates a new config variable called &amp;quot;view_index_dir&amp;quot; that allows for that.  Best, Adam&lt;br/&gt;
&lt;br/&gt;
diff --git a/trunk/etc/couchdb/default.ini.tpl.in b/trunk/etc/couchdb/default.ini.tpl.in&lt;br/&gt;
index f4eb49f..c9143cf 100644&lt;br/&gt;
--- a/trunk/etc/couchdb/default.ini.tpl.in&lt;br/&gt;
+++ b/trunk/etc/couchdb/default.ini.tpl.in&lt;br/&gt;
@@ -4,6 +4,7 @@&lt;br/&gt;
&lt;br/&gt;
[couchdb]&lt;br/&gt;
database_dir = %localstatelibdir%&lt;br/&gt;
+view_index_dir = %localstatelibdir%&lt;br/&gt;
util_driver_dir = %couchprivlibdir%&lt;br/&gt;
max_document_size = 4294967296 ; 4 GB&lt;br/&gt;
view_timeout = 5000 ; 5 seconds&lt;br/&gt;
diff --git a/trunk/src/couchdb/couch_view.erl b/trunk/src/couchdb/couch_view.erl&lt;br/&gt;
index 4ebbb13..086e39f 100644&lt;br/&gt;
--- a/trunk/src/couchdb/couch_view.erl&lt;br/&gt;
+++ b/trunk/src/couchdb/couch_view.erl&lt;br/&gt;
@@ -238,10 +238,10 @@ fold(#view{btree=Btree}, StartKey, Dir, Fun, Acc) -&amp;gt;&lt;br/&gt;
&lt;br/&gt;
init([]) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;% read configuration settings and register for configuration changes&lt;br/&gt;
-    RootDir = couch_config:get(&amp;quot;couchdb&amp;quot;, &amp;quot;database_dir&amp;quot;),&lt;br/&gt;
+    RootDir = couch_config:get(&amp;quot;couchdb&amp;quot;, &amp;quot;view_index_dir&amp;quot;),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Self = self(),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ok = couch_config:register(&lt;br/&gt;
-        fun(&amp;quot;couchdb&amp;quot;, &amp;quot;database_dir&amp;quot;)-&amp;gt;&lt;br/&gt;
+        fun(&amp;quot;couchdb&amp;quot;, &amp;quot;view_index_dir&amp;quot;)-&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit(Self, config_change)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end),&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12409691">COUCHDB-168</key>
        <summary>allow user-configurable directory for view indexes</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 2 Dec 2008 21:57:31 +0000 (UTC)</created>
    <updated>Thu, 12 Feb 2009 08:30:03 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12672914" author="jchris" created="Thu, 12 Feb 2009 08:30:03 +0000 (UTC)"  >applied in r743653 - thanks</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 12 Feb 2009 08:30:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 12 Feb 2009 08:30:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-167] Files can not be attached to documents with forward slashes in their names to simulate a folder hierarchy</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-167</link>

                    <description>Steps to reproduce:&lt;br/&gt;
&lt;br/&gt;
1) Download sample files from &lt;a href=&quot;http://walgran.com/justin/CouchDB-nested-attachment-sample.zip&quot;&gt;http://walgran.com/justin/CouchDB-nested-attachment-sample.zip&lt;/a&gt;&lt;br/&gt;
2) Unzip CouchDB-nested-attachment-sample.zip&lt;br/&gt;
3) Create a new CouchDB database&lt;br/&gt;
4) Create a new document called &amp;quot;_design/nested&amp;quot;&lt;br/&gt;
5) Add &amp;quot;index.html,&amp;quot; &amp;quot;pickle.gif&amp;quot; and &amp;quot;images/pickle.gif&amp;quot; as attachments to the document&lt;br/&gt;
6) Browse the  index.html attachment&lt;br/&gt;
&lt;br/&gt;
Expected Behavior:&lt;br/&gt;
&lt;br/&gt;
Browsing index.html shows two copies of pickle.gif on the page&lt;br/&gt;
&lt;br/&gt;
Error:&lt;br/&gt;
&lt;br/&gt;
The second image fails to load. &lt;br/&gt;
&lt;br/&gt;
Notes:&lt;br/&gt;
&lt;br/&gt;
Damien suggested using directory separators within file names to simulate folder hierarchies in a November 28th response to the  &lt;a href=&apos;mailto:couchdb-user@incubator.apache.org&apos;&gt;couchdb-user@incubator.apache.org&lt;/a&gt; mailing list.</description>
                <environment>Mac OS X 10.5.5, MacBook Pro, CouchDB 0.9.0a721757-incubating </environment>
            <key id="12409628">COUCHDB-167</key>
        <summary>Files can not be attached to documents with forward slashes in their names to simulate a folder hierarchy</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jwalgran">Justin Walgran</reporter>
            
    <created>Tue, 2 Dec 2008 08:54:18 +0000 (UTC)</created>
    <updated>Tue, 30 Dec 2008 07:06:25 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12652350" author="tlrobinson" created="Tue, 2 Dec 2008 12:37:26 +0000 (UTC)"  >When I used Futon to add the attachment it used a colon instead of a forward slash, so I could access the image at &lt;a href=&quot;http://localhost:5984/test/_design%2Fnested/images%3Apickle.gif&quot;&gt;http://localhost:5984/test/_design%2Fnested/images%3Apickle.gif&lt;/a&gt; (%3A is a colon)&lt;br/&gt;
&lt;br/&gt;
You can use &amp;quot;%2F&amp;quot; in place of a forward slash, in which case it shows up as a forward slash in Futon, but actually requires &amp;quot;%2F&amp;quot; in the URL.&lt;br/&gt;
&lt;br/&gt;
If you *actually* try to save an attachment with a forward slash in it the request actually crashes. For example, this:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;curl -v -H &amp;quot;Content-Type: image/gif&amp;quot; -T ~/pickle.gif &lt;a href=&quot;http://localhost:5984/test/_design%2Fnested/images/pickle.gif?rev=3329617083&quot;&gt;http://localhost:5984/test/_design%2Fnested/images/pickle.gif?rev=3329617083&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
causes this error:&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.290.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.290.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.290.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_httpd_db,db_req,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{httpd,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_request,#Port&amp;lt;0.1604&amp;gt;,&apos;PUT&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/test/_design%2Fnested/images/pickle.gif?rev=3329617083&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{6,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;user-agent&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;User-Agent&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;curl/7.19.2 (i386-apple-darwin9.5.0) libcurl/7.19.2 zlib/1.2.3&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;host&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Host&apos;,&amp;quot;localhost:5984&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;accept&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Accept&apos;,&amp;quot;*/*&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;content-type&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Type&apos;,&amp;quot;image/gif&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;content-length&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&apos;Content-Length&apos;,&amp;quot;806152&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;expect&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;Expect&amp;quot;,&amp;quot;100-continue&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,nil}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;PUT&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;&amp;lt;&amp;quot;test&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;_design/nested&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;images&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;pickle.gif&amp;quot;&amp;gt;&amp;gt;],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dict,2,16,16,8,80,48,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{[],[],[],[],[],[],[],[],[],[],[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[&amp;lt;&amp;lt;&amp;quot;_temp_view&amp;quot;&amp;gt;&amp;gt;|&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_httpd.7.18882544&amp;gt;]],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[&amp;lt;&amp;lt;&amp;quot;_view&amp;quot;&amp;gt;&amp;gt;|#Fun&amp;lt;couch_httpd.7.18882544&amp;gt;]],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],[]}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,nil,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db,&amp;lt;0.122.0&amp;gt;,&amp;lt;0.123.0&amp;gt;,nil,&amp;lt;0.121.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{db_header,0,11,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{4833,9263},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1891797,{4,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1891616,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nil,0,nil,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stream,&amp;lt;0.124.0&amp;gt;,&amp;lt;0.121.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.121.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1891797,{4,0}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.6.124665223&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.7.45786599&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.5.74731249&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.8.118159480&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.121.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{1891616,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.9.48828661&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.10.81431945&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.5.112258129&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_db_updater.11.102742899&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{btree,&amp;lt;0.121.0&amp;gt;,nil,#Fun&amp;lt;couch_btree.0.23070627&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.1.117278773&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#Fun&amp;lt;couch_btree.2.112258129&amp;gt;,nil},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;11,&amp;lt;&amp;lt;&amp;quot;test&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;/usr/local/var/lib/couchdb/test.couch&amp;quot;,[],[],nil,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{user_ctx,nil,[&amp;lt;&amp;lt;&amp;quot;_admin&amp;quot;&amp;gt;&amp;gt;]}}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd_db,do_db_req,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p_do_apply,3}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,{mochiweb_socket_server,acceptor_loop,[&apos;Argument__1&apos;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[couch_httpd,couch_secondary_services,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.56.0&amp;gt;,#Port&amp;lt;0.1604&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,987},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,1446}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
[error] [&amp;lt;0.56.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.56.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,235,{child_error,function_clause}}}}&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 2-Dec-2008::04:34:56 ===&lt;br/&gt;
{mochiweb_socket_server,235,{child_error,function_clause}}&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12659756" author="jchris" created="Tue, 30 Dec 2008 07:06:25 +0000 (UTC)"  >fixed in r729587</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 30 Dec 2008 07:06:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 2 Dec 2008 12:37:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-166] Request with include_docs=true&amp;reduce=false fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-166</link>

                    <description>There seems to be an issue related to parameter order, which I think is a bug, given that they are named.&lt;br/&gt;
&lt;br/&gt;
This request will work:&lt;br/&gt;
/testdb/_view/user/all?reduce=false&amp;amp;include_docs=true&lt;br/&gt;
&lt;br/&gt;
This request will fail:&lt;br/&gt;
/testdb/_view/user/all?include_docs=true&amp;amp;reduce=false&lt;br/&gt;
producing following error with status 500:&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;query_parse_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Bad URL query key for reduce operation: include_docs&amp;quot;}</description>
                <environment>Tested on Linux with CouchDB 0.9.0a720489</environment>
            <key id="12409447">COUCHDB-166</key>
        <summary>Request with include_docs=true&amp;reduce=false fails</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="manveru">Michael Fellinger</reporter>
            
    <created>Fri, 28 Nov 2008 13:24:29 +0000 (UTC)</created>
    <updated>Wed, 7 Jan 2009 17:34:12 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12651665" author="skarab" created="Fri, 28 Nov 2008 20:54:42 +0000 (UTC)"  >The accumulator of a fold function shouldn&apos;t be examined unless order matters.  In this case, the arguments should be treated the same regardless of order.&lt;br/&gt;
&lt;br/&gt;
The attached patch inspects the arguments after they have been folded.</comment>
                    <comment id="12651688" author="manveru" created="Sat, 29 Nov 2008 02:49:57 +0000 (UTC)"  >That patch fixes it, thanks</comment>
                    <comment id="12651776" author="manveru" created="Sun, 30 Nov 2008 02:49:19 +0000 (UTC)"  >Seems like it does not pass the tests though</comment>
                    <comment id="12651849" author="skarab" created="Sun, 30 Nov 2008 18:21:13 +0000 (UTC)"  >Corrected patch which now passes all tests.</comment>
                    <comment id="12661644" author="jchris" created="Wed, 7 Jan 2009 17:34:12 +0000 (UTC)"  >applied in r732407. Thanks!</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12406793">COUCHDB-138</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12394968" name="patch" size="1507" author="skarab" created="Sun, 30 Nov 2008 18:21:48 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Jan 2009 17:34:12 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 28 Nov 2008 20:54:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-165] Automatic autotools invocation fails</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-165</link>

                    <description>When I ./bootstrap &amp;amp;&amp;amp; ./configure &amp;amp;&amp;amp; make &amp;amp;&amp;amp; make install trunk and then&lt;br/&gt;
tweak&lt;br/&gt;
configure.ac and run make again, make runs all the autotools again, with&lt;br/&gt;
this result:&lt;br/&gt;
&lt;br/&gt;
jan ~/Work/couchdb-all/branches/use-osx-bundled-&lt;br/&gt;
icu2&amp;gt; make&lt;br/&gt;
cd . &amp;amp;&amp;amp; /bin/sh /Users/jan/Work/couchdb-all/branches/use-osx-bundled-&lt;br/&gt;
icu2/build-aux/missing --run aclocal-1.10&lt;br/&gt;
cd . &amp;amp;&amp;amp; /bin/sh /Users/jan/Work/couchdb-all/branches/use-osx-bundled-&lt;br/&gt;
icu2/build-aux/missing --run automake-1.10 --foreign&lt;br/&gt;
cd . &amp;amp;&amp;amp; /bin/sh /Users/jan/Work/couchdb-all/branches/use-osx-bundled-&lt;br/&gt;
icu2/build-aux/missing --run autoconf&lt;br/&gt;
configure.ac:107: error: possibly undefined macro: AC_CHECK_CURL&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;If this token and others are legitimate, please use&lt;br/&gt;
m4_pattern_allow.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;See the Autoconf documentation.&lt;br/&gt;
make: *** [configure] Error 1&lt;br/&gt;
&lt;br/&gt;
Running ./bootstrap &amp;amp;&amp;amp; ./configure manually works.</description>
                <environment></environment>
            <key id="12409413">COUCHDB-165</key>
        <summary>Automatic autotools invocation fails</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Thu, 27 Nov 2008 23:31:44 +0000 (UTC)</created>
    <updated>Sat, 17 Oct 2009 12:54:29 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12766901" author="janl" created="Sat, 17 Oct 2009 12:54:29 +0000 (UTC)"  >I haven&apos;t seen this in a while, closing</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310010">
            <name>Incorporates</name>
                                        <inwardlinks description="is part of">
                            <issuelink>
            <issuekey id="12430453">COUCHDB-414</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 17 Oct 2009 12:54:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-164] Make error messages more &quot;verbose&quot;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-164</link>

                    <description>The following error designates that there is no space left on device, it could say just that. :-)&lt;br/&gt;
&lt;br/&gt;
[Tue, 18 Nov 2008 18:20:25 GMT] [error] [&amp;lt;0.57.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.57.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;235,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{{badmatch,{{error,enospc},4414824448}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_stream,write_data,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_stream,write_data,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_stream,handle_call,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,handle_msg,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.11747.125&amp;gt;,&lt;br/&gt;
</description>
                <environment>Linux till-laptop 2.6.24-21-generic #1 SMP Tue Oct 21 23:09:30 UTC 2008 x86_64 GNU/Linux</environment>
            <key id="12408762">COUCHDB-164</key>
        <summary>Make error messages more &quot;verbose&quot;</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="till">Till Klampaeckel</reporter>
            
    <created>Tue, 18 Nov 2008 19:19:13 +0000 (UTC)</created>
    <updated>Tue, 18 Nov 2008 19:26:49 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12648717" author="paul.joseph.davis" created="Tue, 18 Nov 2008 19:26:49 +0000 (UTC)"  >I dunno about changing the actual traceback report, but I would think a no space error should get bubbled up and sent to the client.&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 18 Nov 2008 19:26:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-163] replicate attachments without Base64 encoding</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-163</link>

                    <description>CouchDB currently replicates attachments by inlining them in the JSON representation of the document.  This puts a load on the DB in the case of large attachments.  It might be possible to avoid inlining attachments by&lt;br/&gt;
&lt;br/&gt;
a) adding a {new_edits, false} equivalent option in the standalone attachment API, or&lt;br/&gt;
&lt;br/&gt;
b) accepting a multipart format that would allow JSON docs and binary attachments to be transmitted in one shot, or&lt;br/&gt;
&lt;br/&gt;
c) something I haven&apos;t thought of yet&lt;br/&gt;
&lt;br/&gt;
Regards, Adam</description>
                <environment></environment>
            <key id="12408522">COUCHDB-163</key>
        <summary>replicate attachments without Base64 encoding</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="kocolosk">Adam Kocoloski</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Fri, 14 Nov 2008 19:42:59 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 18:39:22 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666885" author="janl" created="Sat, 24 Jan 2009 11:17:59 +0000 (UTC)"  >Multipart requests are on the roadmap for 0.9. Marking as blocking.</comment>
                    <comment id="12678139" author="kocolosk" created="Mon, 2 Mar 2009 22:46:19 +0000 (UTC)"  >I put together an alternative to multipart that uses a separate request for each attachment in a document.  It could be a good choice for this ticket.  Details are at:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200902.mbox/%3c5A96DE04-A57E-4741-B636-D3FB637D0B8F@gmail.com%3e&quot;&gt;http://mail-archives.apache.org/mod_mbox/couchdb-dev/200902.mbox/%3c5A96DE04-A57E-4741-B636-D3FB637D0B8F@gmail.com%3e&lt;/a&gt;</comment>
                    <comment id="12682641" author="janl" created="Tue, 17 Mar 2009 11:36:07 +0000 (UTC)"  >Move blocking from 0.9 to 0.10.</comment>
                    <comment id="12688318" author="jchris" created="Mon, 23 Mar 2009 16:34:25 +0000 (UTC)"  >This ticket is half-fixed: pull replication is correct. Push replication still uses the base64 encoding. </comment>
                    <comment id="12742141" author="janl" created="Wed, 12 Aug 2009 00:35:25 +0000 (UTC)"  >bump to 0.11</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10032">
            <name>Blocker</name>
                            <outwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12414145">COUCHDB-240</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12415845">COUCHDB-270</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:17:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-162] improve configure script&apos;s ability to find erl_driver.h</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-162</link>

                    <description>Hi, if I configure and install Erlang with a custom --prefix=/path/to/erlang, CouchDB&apos;s configure script finds `erl` and `erlc` from the environment, but it usually needs to be told about the location or erl_driver.h:&lt;br/&gt;
&lt;br/&gt;
./configure --with-erlang=/path/to/erlang/lib/erlang/usr/include&lt;br/&gt;
&lt;br/&gt;
It&apos;d be nice if the configure script could check that location automatically, e.g. determining /path/to/erlang by stripping bin/erl off the path to `erl` that it found earlier.  &lt;br/&gt;
&lt;br/&gt;
Alternatively, I think --with-erlang ought to be modified to take the path to the base of the Erlang installation, rather than the exact path to the location of the folder containing erl_driver.h.  Best,&lt;br/&gt;
&lt;br/&gt;
Adam</description>
                <environment></environment>
            <key id="12408512">COUCHDB-162</key>
        <summary>improve configure script&apos;s ability to find erl_driver.h</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Fri, 14 Nov 2008 17:31:23 +0000 (UTC)</created>
    <updated>Wed, 1 Apr 2009 15:18:25 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666884" author="janl" created="Sat, 24 Jan 2009 11:17:22 +0000 (UTC)"  >Assign to Noah &amp;quot;I am the build system&amp;quot; Slater :-)</comment>
                    <comment id="12694574" author="breun" created="Wed, 1 Apr 2009 15:18:25 +0000 (UTC)"  >I ran into ./configure not being able to find erl_driver.h on Red Hat Enterprise Linux 5.3 x86_64 (erlang package installed from the EPEL repository). I thought maybe it was because of the 64-bitness of this system, but maybe it was because of this issue.&lt;br/&gt;
&lt;br/&gt;
Anyway, this worked:&lt;br/&gt;
&lt;br/&gt;
./configure --with-erlang=/usr/lib64/erlang/usr/include</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:17:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-161] Range Request support for attachments</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-161</link>

                    <description>Support for byte ranges in attachment requests (a la &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)&lt;/a&gt; would allow couch to be a more robust data store for media-heavy applications, for instance, streaming audio or video.</description>
                <environment></environment>
            <key id="12408371">COUCHDB-161</key>
        <summary>Range Request support for attachments</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="deanlandolt">Dean Landolt</reporter>
            
    <created>Wed, 12 Nov 2008 20:38:42 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:57 +0000 (UTC)</updated>

                        <version>0.11</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12647048" author="deanlandolt" created="Wed, 12 Nov 2008 20:40:46 +0000 (UTC)"  >Whoops -- forgot to change the priority from major.</comment>
                    <comment id="12770511" author="janl" created="Tue, 27 Oct 2009 13:55:55 +0000 (UTC)"  >Nice to have in 0.11.</comment>
                    <comment id="12772665" author="kocolosk" created="Mon, 2 Nov 2009 20:39:57 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 27 Oct 2009 13:55:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-160] replication performance improvements</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-160</link>

                    <description>I wrote some code to speed up CouchDB&apos;s replication process by parallelizing document requests and using _bulk_docs to write changes to the target.  I tested the speedup as follows:&lt;br/&gt;
&lt;br/&gt;
* 1000 document DB, 1022 update_seq, ~450 KB after compaction&lt;br/&gt;
* local and remote machines have ~45 ms latency&lt;br/&gt;
* timed requests using timer:tc(couch_rep, replicate, [&amp;lt;&amp;lt;&amp;quot;source&amp;quot;&amp;gt;&amp;gt;, &amp;lt;&amp;lt;&amp;quot;target&amp;quot;&amp;gt;&amp;gt;]&lt;br/&gt;
* all replications are &amp;quot;from scratch&amp;quot;&lt;br/&gt;
&lt;br/&gt;
trunk:&lt;br/&gt;
local-local     115&lt;br/&gt;
local-remote    145&lt;br/&gt;
remote-remote   173&lt;br/&gt;
remote-local    146&lt;br/&gt;
db size after replication: 1.8 MB&lt;br/&gt;
&lt;br/&gt;
patch:&lt;br/&gt;
local-local     1.83&lt;br/&gt;
local-remote    38&lt;br/&gt;
remote-remote   64&lt;br/&gt;
remote-local    35&lt;br/&gt;
db size after replication: 453 KB&lt;br/&gt;
&lt;br/&gt;
I&apos;ll attach the patch as an update to this issue.  It might be worth exposing the &amp;quot;batch size&amp;quot; (currently 100 docs) as a configurable parameter.  Comments welcome.  Best, &lt;br/&gt;
&lt;br/&gt;
Adam&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12408277">COUCHDB-160</key>
        <summary>replication performance improvements</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 11 Nov 2008 18:53:04 +0000 (UTC)</created>
    <updated>Tue, 16 Dec 2008 21:49:09 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12646630" author="kocolosk" created="Tue, 11 Nov 2008 18:54:52 +0000 (UTC)"  >should have mentioned before -- the times quoted are in seconds.</comment>
                    <comment id="12647361" author="kocolosk" created="Thu, 13 Nov 2008 18:44:36 +0000 (UTC)"  >Here&apos;s an updated patch that uses persistent connections and pipelining to further accelerate replications where the source is remote.  Updated benchmarks indicate a 3x improvement in performance for remote-local relative to my first patch, or a total of 10x faster replications than trunk:&lt;br/&gt;
&lt;br/&gt;
parallel+pipeline:&lt;br/&gt;
local-remote    31&lt;br/&gt;
remote-remote   36&lt;br/&gt;
remote-local    13&lt;br/&gt;
&lt;br/&gt;
Note the asymmetry for local-remote vs. remote-local.  Replications to remote targets are still negotiating a new TCP connection for every POST.  Now, we&apos;re not allowed to pipeline POSTs, but there&apos;s nothing wrong with using persistent connections.  Last I heard, Erlang&apos;s HTTP client needs to be updated to deal with that particular use case:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.erlang.org/pipermail/erlang-questions/2008-August/037113.html&quot;&gt;http://www.erlang.org/pipermail/erlang-questions/2008-August/037113.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Best, Adam</comment>
                    <comment id="12647420" author="kocolosk" created="Thu, 13 Nov 2008 22:03:51 +0000 (UTC)"  >forgot to increase the pipeline length in the last version.  The goal is for the entire replication to use 1 persistent connection.</comment>
                    <comment id="12648635" author="kocolosk" created="Tue, 18 Nov 2008 16:01:16 +0000 (UTC)"  >Updated the diff so it can applied against current trunk (r718409) and fixed a bug on my end that the test suite didn&apos;t catch. I&apos;ll see if I can extend the test suite coverage.</comment>
                    <comment id="12657176" author="jchris" created="Tue, 16 Dec 2008 21:49:09 +0000 (UTC)"  >applied in 727171, thanks Adam!</comment>
                </comments>
    
    <attachments>
            <attachment id="12394177" name="couch_rep.erl.diff" size="10452" author="kocolosk" created="Tue, 18 Nov 2008 16:01:15 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 16 Dec 2008 21:49:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 16 Dec 2008 21:49:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-159] Compaction Failure: Compaction file still behind main file</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-159</link>

                    <description>I get the following errors when attempting to compact a database.  Using SVN r712872.  The first few lines appear many hundreds of times before it stops trying to spawn processes.&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.75.0&amp;gt;] Compaction file still behind main file (update seq=916. compact update seq=181). Retrying.&lt;br/&gt;
...&lt;br/&gt;
[snip]&lt;br/&gt;
...&lt;br/&gt;
[info] [&amp;lt;0.75.0&amp;gt;] Compaction file still behind main file (update seq=916. compact update seq=181). Retrying.&lt;br/&gt;
[info] [&amp;lt;0.75.0&amp;gt;] Compaction file still behind main file (update seq=916. compact update seq=181). Retrying.&lt;br/&gt;
[info] [&amp;lt;0.75.0&amp;gt;] Compaction file still behind main file (update seq=916. compact update seq=181). Retrying.&lt;br/&gt;
[info] [&amp;lt;0.75.0&amp;gt;] Compaction file still behind main file (update seq=916. compact update seq=181). Retrying.&lt;br/&gt;
[info] [&amp;lt;0.75.0&amp;gt;] Compaction file still behind main file (update seq=916. compact update seq=181). Retrying.&lt;br/&gt;
[error] [emulator] Too many processes&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 11-Nov-2008::14:44:31 ===&lt;br/&gt;
Too many processes&lt;br/&gt;
&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.13098.44&amp;gt; with exit value: {system_limit,[{erlang,spawn_opt,[proc_lib,init_p,[&amp;lt;0.13098.44&amp;gt;,[],gen,init_it,[gen_server,&amp;lt;0.13098.44&amp;gt;,&amp;lt;0.13098.44&amp;gt;,couch_stream,{{1522827,2681},&amp;lt;0.14451.46&amp;gt;},[]]],[link]]},{proc_lib,start_link,5},{couch_stream,open,2},{couch_db_updater,init_db,4},{couch_db_updater,start_copy_compact_int... &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 11-Nov-2008::14:44:31 ===&lt;br/&gt;
Error in process &amp;lt;0.13098.44&amp;gt; with exit value: {system_limit,[{erlang,spawn_opt,[proc_lib,init_p,[&amp;lt;0.13098.44&amp;gt;,[],gen,init_it,[gen_server,&amp;lt;0.13098.44&amp;gt;,&amp;lt;0.13098.44&amp;gt;,couch_stream,{{1522827,2681},&amp;lt;0.14451.46&amp;gt;},[]]],[link]]},{proc_lib,start_link,5},{couch_stream,open,2},{couch_db_updater,init_db,4},{couch_db_updater,start_copy_compact_int... &lt;br/&gt;
</description>
                <environment>Ubuntu 8.10</environment>
            <key id="12408248">COUCHDB-159</key>
        <summary>Compaction Failure: Compaction file still behind main file</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Tue, 11 Nov 2008 14:55:48 +0000 (UTC)</created>
    <updated>Fri, 12 Dec 2008 19:43:11 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12656129" author="damienkatz" created="Fri, 12 Dec 2008 19:43:11 +0000 (UTC)"  >This issue should be fixed in trunk.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 19:43:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 19:43:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-158] User definable sort directions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-158</link>

                    <description>At the request of arachnid on IRC here is the implemented user definable sort directions.&lt;br/&gt;
&lt;br/&gt;
The patch allows for views that emit keys as arrays to sort the view based on the position in the array.&lt;br/&gt;
&lt;br/&gt;
Sorts are specified as an array of boolean values in the view definition. Temporary views can also post a sort array with the view definition.</description>
                <environment>Trunk hopefully</environment>
            <key id="12408117">COUCHDB-158</key>
        <summary>User definable sort directions</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sun, 9 Nov 2008 21:49:20 +0000 (UTC)</created>
    <updated>Sun, 2 Aug 2009 08:07:45 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12646118" author="paul.joseph.davis" created="Sun, 9 Nov 2008 21:49:55 +0000 (UTC)"  >The patch</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10032">
            <name>Blocker</name>
                                        <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12430646">COUCHDB-415</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12393596" name="user_sort.patch" size="21032" author="paul.joseph.davis" created="Sun, 9 Nov 2008 21:49:55 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-157] re-encode &apos;/&apos; in document IDs when replicating from a remote source</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-157</link>

                    <description>CouchDB&apos;s replication fails when a remote source contains documents with slashes in their IDs.  This includes both design docs and regular documents with a %2F in the ID.</description>
                <environment>&lt;a href=&apos;mailto:trunk@r712388&apos;&gt;trunk@r712388&lt;/a&gt;</environment>
            <key id="12408078">COUCHDB-157</key>
        <summary>re-encode &apos;/&apos; in document IDs when replicating from a remote source</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Sun, 9 Nov 2008 06:33:51 +0000 (UTC)</created>
    <updated>Sun, 9 Nov 2008 22:39:48 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12646049" author="kocolosk" created="Sun, 9 Nov 2008 06:36:14 +0000 (UTC)"  >patch adding a check for this failure mode to the test suite</comment>
                    <comment id="12646110" author="kocolosk" created="Sun, 9 Nov 2008 19:47:02 +0000 (UTC)"  >here&apos;s a one-line patch against r712388 to resolve this issue</comment>
                    <comment id="12646125" author="jchris" created="Sun, 9 Nov 2008 22:39:48 +0000 (UTC)"  >patched applied in r712578</comment>
                </comments>
    
    <attachments>
            <attachment id="12393594" name="couch_rep.diff" size="781" author="kocolosk" created="Sun, 9 Nov 2008 19:47:02 +0000 (UTC)" />
            <attachment id="12393579" name="couch_tests_replication.diff" size="752" author="kocolosk" created="Sun, 9 Nov 2008 06:36:14 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 9 Nov 2008 22:39:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 9 Nov 2008 22:39:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-156] views should have input document settings</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-156</link>

                    <description>Noticed that _design docs are appearing to be sent to views. Later I&apos;ll write a test case.</description>
                <environment>Trunk</environment>
            <key id="12408053">COUCHDB-156</key>
        <summary>views should have input document settings</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sat, 8 Nov 2008 02:41:32 +0000 (UTC)</created>
    <updated>Sun, 1 Feb 2009 22:21:42 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12646698" author="jchris" created="Tue, 11 Nov 2008 22:28:56 +0000 (UTC)"  >The _design docs should get sent to views. For example, what if I want a view of design docs with a view called &amp;quot;by_tags&amp;quot;?</comment>
                    <comment id="12646710" author="jchris" created="Tue, 11 Nov 2008 22:47:38 +0000 (UTC)"  >Nevermind. Damien has spoken:&lt;br/&gt;
&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; should be fixed, like this: &amp;lt;&amp;lt;?DESIGN_DOC_PREFIX, _/binary&amp;gt;&amp;gt;&lt;br/&gt;
&amp;lt;jchris&amp;gt; damienkatz: why skip design docs in views?&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; because you rarely want them, and ususally you only have small number of design docs.&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; but views can have a flag to control things like that.&lt;br/&gt;
&amp;lt;jchris&amp;gt; I&apos;ll be wanting to find all the design docs with an index.html attachment&lt;br/&gt;
&amp;lt;jchris&amp;gt; and I&apos;ve written code that autogenerates scores of ddocs&lt;br/&gt;
&amp;lt;jchris&amp;gt; having a flag would do the trick&lt;br/&gt;
&amp;lt;jchris&amp;gt; but I wonder if it is not more complex than necessary&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; jchris: yes, add support for view options.&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; we already need it for the sort order thing&lt;br/&gt;
&amp;lt;jchris&amp;gt; &amp;quot;options&amp;quot; : {&amp;quot;sort&amp;quot;:[true,false], &amp;quot;include_design_docs&amp;quot;:true, ... }&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; and it would be nice to send more or less doc meta data, or things like binaries too.&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; right&lt;br/&gt;
&amp;lt;jchris&amp;gt; &amp;quot;all_revs&amp;quot;&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; right&lt;br/&gt;
&amp;lt;jchris&amp;gt; ok, good, attaching this transcript to the ticket and reopening&lt;br/&gt;
</comment>
                    <comment id="12666883" author="janl" created="Sat, 24 Jan 2009 11:14:15 +0000 (UTC)"  >API change, blocking for 0.9. please discuss.</comment>
                    <comment id="12668708" author="jchris" created="Fri, 30 Jan 2009 01:56:02 +0000 (UTC)"  >This change would be backwards compatible, so I&apos;m fine not marking it as a blocker. It would also be a good ticket for someone new to the code to work on, as it would be hard to get it drastically wrong.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll leave as blocker for now, but I&apos;ll say I&apos;m +1 on letting it slide until it has a sponsor.</comment>
                    <comment id="12669324" author="paul.joseph.davis" created="Sun, 1 Feb 2009 03:05:52 +0000 (UTC)"  >Allows users to optionally include _design documents in views. This setting is affects all views in a design document because multiple views may sure the same index but specify different include semantics.&lt;br/&gt;
&lt;br/&gt;
To include _design docs in views, you just need to add a `&amp;quot;include_design&amp;quot;: true` member to the root of your design document.</comment>
                    <comment id="12669440" author="paul.joseph.davis" created="Sun, 1 Feb 2009 20:41:52 +0000 (UTC)"  >Git Fail.</comment>
                    <comment id="12669464" author="jchris" created="Sun, 1 Feb 2009 22:21:42 +0000 (UTC)"  >fixed in r739866</comment>
                </comments>
    
    <attachments>
            <attachment id="12399246" name="COUCHDB-156.2.patch" size="11105" author="paul.joseph.davis" created="Sun, 1 Feb 2009 20:41:52 +0000 (UTC)" />
            <attachment id="12399223" name="COUCHDB-156.patch" size="331" author="paul.joseph.davis" created="Sun, 1 Feb 2009 03:05:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 1 Feb 2009 22:21:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 11 Nov 2008 22:28:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-155] status code for invalid database names</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-155</link>

                    <description>This is a follow-up from the discussion on &lt;a href=&apos;mailto:couchdb-dev@incubator.apache.org&apos;&gt;couchdb-dev@incubator.apache.org&lt;/a&gt; that started with mid:&lt;a href=&apos;mailto:20081101161957.GI10893@ginosko.ndrix.org&apos;&gt;20081101161957.GI10893@ginosko.ndrix.org&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
When trying to create a new database with an invalid database name, CouchDB responds with a 500 status code.  It should respond with a 400 status code.&lt;br/&gt;
&lt;br/&gt;
Patch to follow.</description>
                <environment></environment>
            <key id="12408040">COUCHDB-155</key>
        <summary>status code for invalid database names</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mndrix">Michael Hendricks</reporter>
            
    <created>Fri, 7 Nov 2008 21:59:12 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 11:07:33 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666880" author="janl" created="Sat, 24 Jan 2009 11:07:33 +0000 (UTC)"  >Link to the unicode-FTW ticket for Antony. As far as I understand, we won&apos;t have any &amp;quot;invalid database names&amp;quot; any more.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12396899">COUCHDB-67</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12393531" name="0001-Respond-with-400-status-code-after-an-invalid-databa.patch" size="1834" author="mndrix" created="Fri, 7 Nov 2008 22:01:06 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:07:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-154] Support gzip content in POST requests</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-154</link>

                    <description>When sending large amounts of data to CouchDB it&apos;d be nice to have support for Content-Encoding: gzip or Transfer-Encoding: gzip (in the client to server direction).</description>
                <environment></environment>
            <key id="12407918">COUCHDB-154</key>
        <summary>Support gzip content in POST requests</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ask">Ask Bj&#248;rn Hansen</reporter>
            
    <created>Thu, 6 Nov 2008 05:19:12 +0000 (UTC)</created>
    <updated>Thu, 6 Nov 2008 05:19:12 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>2</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-153] Erlang should warn about log/data file permissions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-153</link>

                    <description>CouchDB is installed as root for most people, and hence without remembering to change the permissions on the log/data directories, errors are very common. The problems caused by incorrect permissions can be very confusing. We should re-add the checks for these that used to be in the init script, but place them in CouchDB core. We need to do this so that the multiple configuration settings will be taken account for.</description>
                <environment></environment>
            <key id="12407814">COUCHDB-153</key>
        <summary>Erlang should warn about log/data file permissions</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Tue, 4 Nov 2008 22:55:08 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:50:04 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12667284" author="ulises" created="Mon, 26 Jan 2009 16:21:10 +0000 (UTC)"  >Attached a patch that somewhat &amp;quot;fixes&amp;quot; this issue. The check tries to create the directory assigned in the .ini file and if it fails instructs couchdb to stop starting up while reporting (with a nicer than erlang errors message) what the problem was.</comment>
                    <comment id="12671703" author="janl" created="Mon, 9 Feb 2009 00:17:26 +0000 (UTC)"  >Hi Ulises, thanks for the patch, we&apos;re getting there, but we&apos;re not quite there yet.&lt;br/&gt;
&lt;br/&gt;
- tabs -&amp;gt; spaces.&lt;br/&gt;
- there&apos;s a ?LOG_ERROR statement and an io:format() saying the same. I assume we only need the ?LOG_ERROR.&lt;br/&gt;
- we&apos;re bailing out after the pretty error message gets logged. I don&apos;t think there&apos;s a need to return a pretty State record and instead just stop() us, which in turn stops couch_server_sup():&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;?LOG_ERROR(&amp;quot;Couldn&apos;t create/access ~p (reason:~p)~n&amp;quot;, [RootDir, Error]),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;stop() % terminate CouchDB&lt;br/&gt;
- this still creates the rather ugly:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;init terminating in do_boot&amp;quot;,{{badmatch,{error,shutdown}},[{couch_server_sup,start_server,1},{erl_eval,do_apply,5},{erl_eval,exprs,5},{init,start_it,1},{init,start_em,1}]}}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Crash dump was written to: erl_crash.dump&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;init terminating in do_boot ()&lt;br/&gt;
&lt;br/&gt;
The badmatch happens in the Erlang application do_boot function and I don&apos;t know if there&apos;s a way to catch errors there and the we&apos;ve got to live with this error, but it might be worth looking into options to make this nicer.&lt;br/&gt;
&lt;br/&gt;
Again, thanks for your efforts. If you or anyone wants to pick this up, that&apos;d be great.</comment>
                    <comment id="12671765" author="ulises" created="Mon, 9 Feb 2009 08:45:34 +0000 (UTC)"  >I&apos;m happy to take on this.&lt;br/&gt;
&lt;br/&gt;
As for your comments:&lt;br/&gt;
&lt;br/&gt;
tabs -&amp;gt; spaces: yes, bloody erlang-mode, for some reason it refuses to use spaces instead of tabs, my fault entirely, I thought I had fixed it.&lt;br/&gt;
?LOG_ERROR + io:format(): I wanted both immediate messaging as logging for future reference. Somehow (and I could be wrong here) with a single ?LOG_ERROR you wouldn&apos;t get the message on the console.&lt;br/&gt;
as for pretty return vs. stop(): stop() didn&apos;t seem to stop the whole boot process. My limited knowledge prevented me from investigating further why stop() (what&apos;s actually intuitive) didn&apos;t stop.&lt;br/&gt;
ugly message: yes, but that&apos;s at a higher level. Either we tackle this from a higher level in do_boot (if at all possible as you suggest) or we live with the extra ugly message taking comfort that at least the one before makes a bit more sense.&lt;br/&gt;
&lt;br/&gt;
Either way, I&apos;m on it.</comment>
                    <comment id="12671789" author="janl" created="Mon, 9 Feb 2009 09:58:02 +0000 (UTC)"  >Thanks for taking care.&lt;br/&gt;
&lt;br/&gt;
?LOG_* corresponds to the log levels the users sets in his ini. INFO is the default. A problem is starting CouchDB in in the background `couchdb -b`. where you do not get any messages. io:format() should be avoided. The problem here is that logging is a secondary service which has not been started yet and things are not get logged to the logfile.&lt;br/&gt;
&lt;br/&gt;
Another catch is starting CouchDB in the background where you don&apos;t get any message&lt;br/&gt;
&lt;br/&gt;
stop() calls couch_server_sup:stop() calls   catch exit(whereis(couch_server_sup), normal). which I believe causes CouchDB to terminate.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12671791" author="ulises" created="Mon, 9 Feb 2009 10:01:10 +0000 (UTC)"  >Right, good stuff then.&lt;br/&gt;
&lt;br/&gt;
Will remove appropriate io:formats and stick to ?LOG_X. Will try again with stop() even though it didn&apos;t do as advertised the first time (maybe I missed something).</comment>
                    <comment id="12672551" author="ulises" created="Wed, 11 Feb 2009 08:36:55 +0000 (UTC)"  >New patch. This time it reports a pretty message and stops the bootup process (perhaps in an ugly fashion). Still makes use of io:format() as the log server hasn&apos;t been started at this point.&lt;br/&gt;
&lt;br/&gt;
Output from console:&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB 0.9.0a-incubating (LogLevel=error) is starting.&lt;br/&gt;
[error] Can&apos;t access &amp;quot;/arse/foo&amp;quot; (reason: eacces)&lt;br/&gt;
&lt;br/&gt;
Ulises-Cervi-o-Beresis-Computer:couchdb ulises$</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12438444">COUCHDB-538</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12390563">COUCHDB-11</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12399993" name="issue-153.patch" size="1304" author="ulises" created="Wed, 11 Feb 2009 08:36:55 +0000 (UTC)" />
            <attachment id="12398739" name="issue-153.patch" size="1468" author="ulises" created="Mon, 26 Jan 2009 16:21:10 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 Jan 2009 16:21:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-152] fix : $abs_top_srcdir isn&apos;t set, ./utils/run fail after make dev</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-152</link>

                    <description>On openbsd-current and maybe some other system with older autotools $abs_top_srcdir isn&apos;t set. So make dev don&apos;t replace path in config files and ./utils/run failed with error :&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;init terminating in &lt;br/&gt;
do_boot&amp;quot;,{undef,[{couch_server,start,[[&amp;quot;/etc/couchdb/default_dev.ini&amp;quot;,&amp;quot;/etc/couchdb/local_dev.ini&amp;quot;]]},{erl_eval,do_apply,5},{erl_eval,exprs,5},{init,start_it,1},{init,start_em,1}]}}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
find attached patch that fix it. In the same time i set abs_top_builddir.</description>
                <environment>openbsd-current</environment>
            <key id="12407681">COUCHDB-152</key>
        <summary>fix : $abs_top_srcdir isn&apos;t set, ./utils/run fail after make dev</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Mon, 3 Nov 2008 00:21:09 +0000 (UTC)</created>
    <updated>Mon, 3 Nov 2008 09:06:30 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12644634" author="benoitc" created="Mon, 3 Nov 2008 00:22:28 +0000 (UTC)"  >patch that fix this issue. Since I test it on openbsd it also fix the pb with -lcrypto linking</comment>
                    <comment id="12644666" author="janl" created="Mon, 3 Nov 2008 09:06:30 +0000 (UTC)"  >Patch applied in r710027. Thanks!</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310010">
            <name>Incorporates</name>
                            <outwardlinks description="incorporates">
                            <issuelink>
            <issuekey id="12407679">COUCHDB-151</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12393224" name="patch-configure_ac" size="634" author="benoitc" created="Mon, 3 Nov 2008 00:22:28 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 3 Nov 2008 09:06:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 3 Nov 2008 09:06:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-151] pb when building couchdb with &quot;-lcrypt&quot;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-151</link>

                    <description>On openbsd and probably netbsd -lcrypt don&apos;t exist. You should use -lcrypto.&lt;br/&gt;
&lt;br/&gt;
Find attached the patch that fix this error.</description>
                <environment>openbsd</environment>
            <key id="12407679">COUCHDB-151</key>
        <summary>pb when building couchdb with &quot;-lcrypt&quot;</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sun, 2 Nov 2008 23:38:32 +0000 (UTC)</created>
    <updated>Mon, 3 Nov 2008 09:02:20 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12644632" author="benoitc" created="Sun, 2 Nov 2008 23:39:24 +0000 (UTC)"  >patch that fix this issue.</comment>
                    <comment id="12644633" author="benoitc" created="Sun, 2 Nov 2008 23:44:59 +0000 (UTC)"  >the patch provided here don&apos;t detect -crypto  but provide its support depending on platform. Though all bsd incorporate openssl in their base so adding -crypto to all bsd could be enough.</comment>
                    <comment id="12644665" author="janl" created="Mon, 3 Nov 2008 09:02:20 +0000 (UTC)"  >Patch applied as of r710026. Thanks!&lt;br/&gt;
&lt;br/&gt;
My FreeBSD `$ man 3 crypt` says `crypt()` is defined in -lcrypt. We don&apos;t actually need OpenSSL for this one IMHO. Benoit, is there a -lcrypt for OpenBSD?&lt;br/&gt;
&lt;br/&gt;
Maybe this should be detected using the regular `./configure`-magic. Although I found plenty of other open source projects that do it this way.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310010">
            <name>Incorporates</name>
                                        <inwardlinks description="is part of">
                            <issuelink>
            <issuekey id="12407681">COUCHDB-152</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12405530">COUCHDB-131</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12393223" name="patch-configure_ac" size="281" author="benoitc" created="Sun, 2 Nov 2008 23:39:24 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 3 Nov 2008 09:02:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 3 Nov 2008 09:02:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-150] Remind developers of the next step after &apos;make dev&apos;</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-150</link>

                    <description>The &apos;make dev&apos; target is very convenient.  I find that I often forget what command I need to run after &apos;make dev&apos; to start the CouchDB server from the source tree.  Adding a reminder in the Makefile helps.  Patch to follow.</description>
                <environment>Darwin Kernel Version 8.11.1&lt;br/&gt;
OS X 10.4.11</environment>
            <key id="12407643">COUCHDB-150</key>
        <summary>Remind developers of the next step after &apos;make dev&apos;</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mndrix">Michael Hendricks</reporter>
            
    <created>Sat, 1 Nov 2008 03:39:58 +0000 (UTC)</created>
    <updated>Sun, 2 Nov 2008 13:42:17 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12644484" author="mndrix" created="Sat, 1 Nov 2008 03:42:23 +0000 (UTC)"  >Patch to implement a reminder about ./utils/run</comment>
                    <comment id="12644585" author="janl" created="Sun, 2 Nov 2008 13:42:17 +0000 (UTC)"  >Fixed as of r709882. Thank you!</comment>
                </comments>
    
    <attachments>
            <attachment id="12393185" name="0001-Remind-developers-of-the-step-after-make-dev.patch" size="934" author="mndrix" created="Sat, 1 Nov 2008 03:42:23 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Nov 2008 13:42:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Nov 2008 13:42:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-149] Compactation failure when *.compact file reach 2116687115 (ap. 2GB) size</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-149</link>

                    <description>CouchDB is has been working 3 days without stop. I tried to insert large amount of data. From time to time I was doing compactation.&lt;br/&gt;
&lt;br/&gt;
One when database has 50GB of size and 3 mln records, then tried second time when there was 4,7 mln records and 12 GB but something failed. I tried to restart compaction from futon interface but it wasn&apos;t working.&lt;br/&gt;
&lt;br/&gt;
On console where was working inserting script written in erlang I received message.&lt;br/&gt;
&lt;br/&gt;
Err add {event,{session,965,3,2005718},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{session_data,os,&amp;quot;Ubuntu 8.10&amp;quot;,icecast,&amp;quot;WinampMPEG/5.53&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{listener,999999999999999,12301897,&amp;quot;85.112.221.200&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1213297703,undefined,21,undefined,undefined}  {ok,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{&amp;quot;HTTP/1.1&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;500,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Internal Server Error&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&amp;quot;cache-control&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;must-revalidate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;date&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Fri, 31 Oct 2008 19:13:43 GMT&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;server&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;CouchDB/0.8.1-incubating (Erlang OTP/R12B)&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;content-length&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;1665&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;content-type&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;text/plain;charset=utf-8&amp;quot;}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;{\&amp;quot;error\&amp;quot;:\&amp;quot;EXIT\&amp;quot;,\&amp;quot;reason\&amp;quot;:\&amp;quot;{{function_clause,\\n     [{couch_db,&apos;-copy_docs\\/3-fun-0-&apos;,\\n          [not_found,&amp;lt;0.24367.262&amp;gt;,\\n           {stream,&amp;lt;0.25264.262&amp;gt;,&amp;lt;0.25263.262&amp;gt;},\\n           &amp;lt;0.25263.262&amp;gt;]},\\n      {lists,map,2},\\n      {lists,map,2},\\n      {couch_db,copy_docs,3},\\n      {couch_db,&apos;-copy_compact_docs\\/2-fun-0-&apos;,4},\\n      {couch_btree,stream_kv_node2,7},\\n      {couch_btree,stream_kp_node,6},\\n      {couch_btree,stream_kp_node,7}]},\\n {gen_server,call,\\n     [&amp;lt;0.24368.262&amp;gt;,\\n      {update_docs,\\n          [[{doc,\\\&amp;quot;965:3:2005718\\\&amp;quot;,\\n                [\\\&amp;quot;102178913\\\&amp;quot;],\\n                {obj,\\n                    [{\\\&amp;quot;type\\\&amp;quot;,\\\&amp;quot;event\\\&amp;quot;},\\n                     {\\\&amp;quot;session\\\&amp;quot;,\\n                      {obj,\\n                          [{\\\&amp;quot;server_id\\\&amp;quot;,965},\\n                           {\\\&amp;quot;instance_id\\\&amp;quot;,3},\\n                           {\\\&amp;quot;id\\\&amp;quot;,2005718}]}},\\n                     {\\\&amp;quot;session_data\\\&amp;quot;,\\n                      {obj,\\n                          [{\\\&amp;quot;origin\\\&amp;quot;,\\\&amp;quot;os\\\&amp;quot;},\\n                           {\\\&amp;quot;os_type\\\&amp;quot;,\\\&amp;quot;Ubuntu 8.10\\\&amp;quot;},\\n                           {\\\&amp;quot;server_type\\\&amp;quot;,\\\&amp;quot;icecast\\\&amp;quot;},\\n                           {\\\&amp;quot;player\\\&amp;quot;,\\\&amp;quot;WinampMPEG\\/5.53\\\&amp;quot;}]}},\\n                     {\\\&amp;quot;listener\\\&amp;quot;,\\n                      {obj,\\n                          [{\\\&amp;quot;pid\\\&amp;quot;,999999999999999},\\n                           {\\\&amp;quot;gg\\\&amp;quot;,12301897},\\n                           {\\\&amp;quot;ip\\\&amp;quot;,\\\&amp;quot;85.112.221.200\\\&amp;quot;}]}},\\n                     {\\\&amp;quot;start_time\\\&amp;quot;,1213297703},\\n                     {\\\&amp;quot;end_time\\\&amp;quot;,\\\&amp;quot;undefined\\\&amp;quot;},\\n                     {\\\&amp;quot;channel\\\&amp;quot;,21},\\n                     {\\\&amp;quot;intro\\\&amp;quot;,\\\&amp;quot;undefined\\\&amp;quot;}]},\\n                [],false,[]}]],\\n          [new_edits]},\\n      infinity]}}\&amp;quot;}&amp;quot;}}&lt;br/&gt;
&lt;br/&gt;
I think that the most important part is error reason:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;{\&amp;quot;error\&amp;quot;:\&amp;quot;EXIT\&amp;quot;,\&amp;quot;reason\&amp;quot;:\&amp;quot;{{function_clause,\\n     [{couch_db,&apos;-copy_docs\\/3-fun-0-&apos;,\\n          [not_found,&amp;lt;0.24367.262&amp;gt;,\\n           {stream,&amp;lt;0.25264.262&amp;gt;,&amp;lt;0.25263.262&amp;gt;},\\n           &amp;lt;0.25263.262&amp;gt;]},\\n      {lists,map,2},\\n      {lists,map,2},\\n      {couch_db,copy_docs,3},\\n      {couch_db,&apos;-copy_compact_docs\\/2-fun-0-&apos;,4},\\n      {couch_btree,stream_kv_node2,7},\\n      {couch_btree,stream_kp_node,6},\\n      {couch_btree,stream_kp_node,7}]},\\n {gen_server,call,\\n     [&amp;lt;0.24368.262&amp;gt;,\\n      {update_docs,\\n          [[{doc,\\\&amp;quot;965:3:2005718\\\&amp;quot;,\\n                [\\\&amp;quot;102178913\\\&amp;quot;],\\n                {obj,\\n                    [{\\\&amp;quot;type\\\&amp;quot;,\\\&amp;quot;event\\\&amp;quot;},\\n                     {\\\&amp;quot;session\\\&amp;quot;,\\n                      {obj,\\n                          [{\\\&amp;quot;server_id\\\&amp;quot;,965},\\n                          &lt;br/&gt;
&lt;br/&gt;
or second time&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;quot;{\&amp;quot;error\&amp;quot;:\&amp;quot;EXIT\&amp;quot;,\&amp;quot;reason\&amp;quot;:\&amp;quot;{noproc,{gen_server,call,\\n                    [&amp;lt;0.25341.262&amp;gt;,{pread_bin,18695772967},infinity]}}\&amp;quot;}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
It is strange that compaction alway failed when *.compact file has 2116687115 or 2116963527 bytes of size. Always approximately 2GB.&lt;br/&gt;
&lt;br/&gt;
Is it bug? or there is some config parameter which says about result compact file size. If here is one, why file before compaction can has 50 GB size?&lt;br/&gt;
&lt;br/&gt;
Im sory for my poor English.</description>
                <environment>Ubuntu 8.04 2.6.24-21-generic x86_64 GNU/Linux processor Duo 2 Quad, 8 GB RAM</environment>
            <key id="12407628">COUCHDB-149</key>
        <summary>Compactation failure when *.compact file reach 2116687115 (ap. 2GB) size</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="melon">Pawe&#322; Melon</reporter>
            
    <created>Fri, 31 Oct 2008 21:05:30 +0000 (UTC)</created>
    <updated>Fri, 31 Oct 2008 21:40:43 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12644435" author="damienkatz" created="Fri, 31 Oct 2008 21:40:43 +0000 (UTC)"  >This looks very similar to a bug that is fixed in trunk. If you can reproduce this with a recent trunk, please reopen.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 31 Oct 2008 21:40:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 31 Oct 2008 21:40:43 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-148] Small edits on OS X aspects of README</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-148</link>

                    <description>See list discussion, and attached patch.</description>
                <environment></environment>
            <key id="12407514">COUCHDB-148</key>
        <summary>Small edits on OS X aspects of README</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="febeling">Florian Ebeling</reporter>
            
    <created>Thu, 30 Oct 2008 11:46:50 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 10:40:11 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666874" author="janl" created="Sat, 24 Jan 2009 10:40:11 +0000 (UTC)"  >Committed a slightly revised version in r737327. Thanks Florian.</comment>
                </comments>
    
    <attachments>
            <attachment id="12393052" name="patch-README" size="2873" author="febeling" created="Thu, 30 Oct 2008 12:37:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 10:40:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 10:40:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-147] Make Futon an Extensible/Embedabble Authoring Tool</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-147</link>

                    <description>For folks wishing to build stackless web applications on top of couchdb, futon is good place to start. In my own work, I&apos;ve attempted to integrate futon into my application to create an app that hosts its own development environment much the same way as wikis combine authoring as well as presentation.  I believe the seaside smalltalk framework takes this approach as well. &lt;br/&gt;
&lt;br/&gt;
Please consider evolving futon to become more extensible and embeddable. &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;stackless web application : An application that requires little more than HTTP, HTML, and JavaScript. </description>
                <environment></environment>
            <key id="12407247">COUCHDB-147</key>
        <summary>Make Futon an Extensible/Embedabble Authoring Tool</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="robevans">Rob Evans</reporter>
            
    <created>Sun, 26 Oct 2008 15:39:40 +0000 (UTC)</created>
    <updated>Sun, 4 Jan 2009 18:28:05 +0000 (UTC)</updated>

                
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12659751" author="jchris" created="Tue, 30 Dec 2008 06:54:11 +0000 (UTC)"  >yes, I love that standalone app stuff!&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://jchris.mfdz.com/code/2008/10/standalone_applications_with_co&quot;&gt;http://jchris.mfdz.com/code/2008/10/standalone_applications_with_co&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
can you share your futon work?</comment>
                    <comment id="12659757" author="robevans" created="Tue, 30 Dec 2008 07:07:26 +0000 (UTC)"  >Chris, &lt;br/&gt;
&lt;br/&gt;
I&apos;ll package up what I have and send it to you. It may take a week for me to get this to you... holiday&apos;s and all. </comment>
                    <comment id="12660616" author="jasondd" created="Sun, 4 Jan 2009 18:28:05 +0000 (UTC)"  >I&apos;m also interested in making Futon more extensible.  It would be really nice to have plugins that could inject arbitrary bits of functionality into Futon, e.g. TinyMCE, date pickers etc.&lt;br/&gt;
&lt;br/&gt;
I&apos;m thinking Futon could load some arbitrary JavaScript from a specially-named document in each database, e.g. with id &amp;quot;_utils/Futon&amp;quot;.  This would be loaded after the Futon JavaScript stuff, so the latter could be overridden.  The Futon JavaScript stuff would need to be restructured slightly to use callbacks where appropriate.&lt;br/&gt;
&lt;br/&gt;
To use TinyMCE as an editor you could then do something like this:&lt;br/&gt;
&lt;br/&gt;
var old_value_callback = value_callback;&lt;br/&gt;
function value_callback(doc, key) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (doc.type == &apos;blog_entry&apos;) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (key == &apos;content&apos;) return showTinyMCE(doc[key]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (key == &apos;pub_date&apos;) return showDatePicker(doc[key]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;return old_value_callback(doc, key);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
There are security considerations with relying on a specially-named document in each database if you replicate an untrusted database onto your CouchDB instance, and then run Futon on it.&lt;br/&gt;
&lt;br/&gt;
I&apos;d be interested in seeing Rob&apos;s work on this.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 30 Dec 2008 06:54:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-146] get edoc generation working</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-146</link>

                    <description>&amp;nbsp;* make &amp;quot;edoc&amp;quot; target and exclude from &amp;quot;all&amp;quot;&lt;br/&gt;
&amp;nbsp;* make sure documentation is distributed and doesn&apos;t break distcheck</description>
                <environment></environment>
            <key id="12407234">COUCHDB-146</key>
        <summary>get edoc generation working</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 25 Oct 2008 19:30:43 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:38:35 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12411496">COUCHDB-187</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-145] Please Don&apos;t Immediately Execute a Map Function from Futon When Starting New Custom Query</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-145</link>

                    <description>Hello,&lt;br/&gt;
&lt;br/&gt;
With a very large database (~ 1 million records) it is very painful (i.e. takes a very long time and consumes lots of resources) to run the default map function immediately when a new Custom Query... window is launched from Futon.&lt;br/&gt;
&lt;br/&gt;
Without any way to kill a map function, I would recommend *not* running any query or map function by default when displaying the Custom Query... window.&lt;br/&gt;
&lt;br/&gt;
Thanks,&lt;br/&gt;
Seth&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12407221">COUCHDB-145</key>
        <summary>Please Don&apos;t Immediately Execute a Map Function from Futon When Starting New Custom Query</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="seth.ladd">Seth Ladd</reporter>
            
    <created>Sat, 25 Oct 2008 08:38:37 +0000 (UTC)</created>
    <updated>Tue, 30 Dec 2008 06:55:00 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12659169" author="jasondd" created="Wed, 24 Dec 2008 23:15:59 +0000 (UTC)"  >This is fixed in trunk as of r723793.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 30 Dec 2008 06:55:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 24 Dec 2008 23:15:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-144] Allow design docs to specify custom sort orders for composite keys</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-144</link>

                    <description>Currently, there is no way to construct an index with different sort orders on different subkeys. For example, you might want to have a view of users sorted by city ascending, then age descending. With some data types this is easy enough to fudge by negating the values (eg, integers, floats, bools), but with strings this is currently practically impossible to achieve. I&apos;m implementing a CouchDB interface for App Engine apps, and this issue is a blocker, preventing me from finishing it.&lt;br/&gt;
&lt;br/&gt;
From a conversation with damienkatz in IRC:&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; I was going to say it seems fine to add key array collation info the design docs&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; something like {key_array_collation:[&amp;quot;asc&amp;quot;, &amp;quot;desc&amp;quot;, &amp;quot;desc&amp;quot;], ...}&lt;br/&gt;
&amp;lt;damienkatz&amp;gt; create a new bug for it.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12407187">COUCHDB-144</key>
        <summary>Allow design docs to specify custom sort orders for composite keys</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="arachnid">Nick Johnson</reporter>
            
    <created>Fri, 24 Oct 2008 15:45:13 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 11:09:38 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666881" author="janl" created="Sat, 24 Jan 2009 11:09:38 +0000 (UTC)"  >Dupe of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-158&quot; title=&quot;User definable sort directions&quot;&gt;COUCHDB-158&lt;/a&gt;. Closing this because the later one has a patch attached. Paul says this is non-blocking for 0.9 and low-priority for 1.0. But the patch should be easy enough to integrate if somebody really needs this.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:09:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:09:38 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-143] Automatic links to referenced docids to aid navigation</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-143</link>

                    <description>Having spent a lot of time in Futon recently, I thought it would be useful to be able to navigate to a referenced document directly from the referring document.&lt;br/&gt;
&lt;br/&gt;
For example, my &amp;quot;comment&amp;quot; documents have &amp;quot;post_id&amp;quot;, which references the docid of a blog post.&lt;br/&gt;
&lt;br/&gt;
It took a couple of minutes implement this patch.  It adds a small &amp;quot;ID: ...&amp;quot; link underneath each field value, after performing a lookup on _all_docs to see if a document with that field value exists.</description>
                <environment>Tested in Mozilla Firefox 3.0 and Google Chrome</environment>
            <key id="12407077">COUCHDB-143</key>
        <summary>Automatic links to referenced docids to aid navigation</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Thu, 23 Oct 2008 10:22:39 +0000 (UTC)</created>
    <updated>Thu, 23 Oct 2008 10:25:27 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12642129" author="jasondd" created="Thu, 23 Oct 2008 10:23:57 +0000 (UTC)"  >Simple implementation, which adds links to referred docids where appropriate.</comment>
                    <comment id="12642130" author="jasondd" created="Thu, 23 Oct 2008 10:25:27 +0000 (UTC)"  >Future work could involve iterating over complex field values (lists and dicts) to see if they contain docid links too.&lt;br/&gt;
&lt;br/&gt;
This could also be made more performant if there was a way to lookup multiple docids simultaneously (I think there is already an issue open for this).</comment>
                </comments>
    
    <attachments>
            <attachment id="12392710" name="docid_lookup.diff" size="1840" author="jasondd" created="Thu, 23 Oct 2008 10:23:57 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-142] Test case submissions from Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-142</link>

                    <description>Bit of insight while helping trogdoro submit a failing test case for couch. it&apos;d be fairly awesome if we had an interface within futon for writing failing cases. Major bonus points for making a &amp;quot;Submit to JIRA&amp;quot; button. Major extra super x10 multiplier bonus points if there were a build bot style thing that would actually confirm the failing case on either the latest SVN version, last release, or both versions of couch.</description>
                <environment>Futon Interface</environment>
            <key id="12407053">COUCHDB-142</key>
        <summary>Test case submissions from Futon</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Thu, 23 Oct 2008 04:48:55 +0000 (UTC)</created>
    <updated>Tue, 21 Jul 2009 21:48:29 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
                    <component>Infrastructure</component>
                    <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12733843" author="cmlenz" created="Tue, 21 Jul 2009 21:48:29 +0000 (UTC)"  >I see you&apos;ve already added this in r793214.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 21:48:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Jul 2009 21:48:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-141] Short-Cut replication initialisation for large databases that are guaranteed to be equal</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-141</link>

                    <description>In a situation where a large database is made available on multiple nodes by copying over the .couch file and where multi-master-replication should keep all nodes in sync, the initial replication in each direction takes quite some time, trying to determine if all databases are in the same state. When we copy the .couch files, they are guaranteed to be equal. It would be nice to be able to tell CouchDB that it doesn&apos;t actually have to iterate through all dbs and just accept the fact that we tell it that they are equal.</description>
                <environment></environment>
            <key id="12406995">COUCHDB-141</key>
        <summary>Short-Cut replication initialisation for large databases that are guaranteed to be equal</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Wed, 22 Oct 2008 13:18:26 +0000 (UTC)</created>
    <updated>Thu, 20 Aug 2009 12:27:41 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12433553">COUCHDB-477</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-140] &quot;total_rows&quot; is not set when a reduce function is specified</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-140</link>

                    <description>I first noticed this when using Futon: one of my views only displayed 10 rows in Futon, with no &amp;quot;next&amp;quot; button, as it thought there were only 10 rows in total.  In fact there were 63, but after some debugging I found that the problem was that the view was not setting &amp;quot;total_rows&amp;quot; in the JSON response, whenever a reduce function was in use.&lt;br/&gt;
&lt;br/&gt;
See attached test case.</description>
                <environment>Debian</environment>
            <key id="12406953">COUCHDB-140</key>
        <summary>&quot;total_rows&quot; is not set when a reduce function is specified</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jasondd">Jason Davies</reporter>
            
    <created>Tue, 21 Oct 2008 21:07:24 +0000 (UTC)</created>
    <updated>Fri, 12 Dec 2008 19:44:57 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12641594" author="jasondd" created="Tue, 21 Oct 2008 21:10:03 +0000 (UTC)"  >Test case showing that &amp;quot;total_rows&amp;quot; isn&apos;t set when a reduce function is used.</comment>
                    <comment id="12656128" author="damienkatz" created="Fri, 12 Dec 2008 19:40:42 +0000 (UTC)"  >This is a design limitation of the reduce functionality.</comment>
                    <comment id="12656130" author="jasondd" created="Fri, 12 Dec 2008 19:44:57 +0000 (UTC)"  >Ah yes, I realised this after discussions on IRC, sorry I didn&apos;t get round to closing this issue. As for Futon, it would be nice to support paging for reduce views, but that can wait for another ticket.</comment>
                </comments>
    
    <attachments>
            <attachment id="12392604" name="couch_tests.js.diff" size="679" author="jasondd" created="Tue, 21 Oct 2008 21:10:03 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 19:40:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 19:40:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-139] group=true must be passed to a query that submits a keys array when reduce=false</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-139</link>

                    <description>If a query is made against a view passing reduce=false as a query param and setting keys as a post param, the following error messages is returned.&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;query_parse_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Multi-key fetches for a reduce view must include group=true&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
I believe that setting reduce=false should obviate the need to set group=true</description>
                <environment></environment>
            <key id="12406794">COUCHDB-139</key>
        <summary>group=true must be passed to a query that submits a keys array when reduce=false</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Mon, 20 Oct 2008 12:01:42 +0000 (UTC)</created>
    <updated>Tue, 21 Oct 2008 20:06:49 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12640985" author="paul.p.carey@gmail.com" created="Mon, 20 Oct 2008 12:02:30 +0000 (UTC)"  >Test attached</comment>
                    <comment id="12641565" author="jchris" created="Tue, 21 Oct 2008 20:06:49 +0000 (UTC)"  >fixed in 706744</comment>
                </comments>
    
    <attachments>
            <attachment id="12392471" name="couch_tests.js.view_multi_key_design.diff" size="529" author="paul.p.carey@gmail.com" created="Mon, 20 Oct 2008 12:02:30 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Oct 2008 20:06:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Oct 2008 20:06:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-138] reduce=false &amp; include_docs=true cannot be combined in a query</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-138</link>

                    <description>Passing ?reduce=false&amp;amp;include_docs=true to a query results in the following error message&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;query_parse_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Bad URL query key for reduce operation: include_docs&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
I believe that the presence of a reduce function should not prevent include_docs from working. </description>
                <environment></environment>
            <key id="12406793">COUCHDB-138</key>
        <summary>reduce=false &amp; include_docs=true cannot be combined in a query</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Mon, 20 Oct 2008 11:54:27 +0000 (UTC)</created>
    <updated>Wed, 7 Jan 2009 10:30:34 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12640983" author="paul.p.carey@gmail.com" created="Mon, 20 Oct 2008 11:55:14 +0000 (UTC)"  >Test attached</comment>
                    <comment id="12641554" author="jchris" created="Tue, 21 Oct 2008 19:49:59 +0000 (UTC)"  >fixed in r706735</comment>
                    <comment id="12661511" author="juliensanchez" created="Wed, 7 Jan 2009 10:30:34 +0000 (UTC)"  >Order matters:&lt;br/&gt;
reduce=false&amp;amp;include_docs=true OK&lt;br/&gt;
include_docs=true&amp;amp;reduce=false NOK&lt;br/&gt;
&lt;br/&gt;
Patch available, minor correction</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12409447">COUCHDB-166</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12392470" name="couch_tests.js.view_include_docs.diff" size="505" author="paul.p.carey@gmail.com" created="Mon, 20 Oct 2008 11:55:14 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Oct 2008 19:49:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Oct 2008 19:49:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-137] Get filtered data from many views with one request</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-137</link>

                    <description>This patch allows to request any numbers of views by one http request.&lt;br/&gt;
Result of each view can be processed by chain of filters defined in a request.&lt;br/&gt;
Also user can define a filters to united data.&lt;br/&gt;
&lt;br/&gt;
For example, filter can sort data by any way you want or returns a totaly new data set.&lt;br/&gt;
&lt;br/&gt;
How to apply patch:&lt;br/&gt;
1) copy patch to couchdb source dir&lt;br/&gt;
2) Extract patch archive by command:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ tar -xzvf patch.11.10.08.1.tar.gz&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;this add a new file &amp;quot;src/couchdb/couch_httpd_general_view.erl&amp;quot; and patch itself.&lt;br/&gt;
&lt;br/&gt;
3)  apply patch &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$ patch -p0 &amp;lt; 11.10.2008.1.patch&lt;br/&gt;
&lt;br/&gt;
4) add to local.ini next lines&lt;br/&gt;
[httpd_global_handlers]                                                                                       &lt;br/&gt;
_general_view = {couch_httpd_general_view, handle_general_view_req}&lt;br/&gt;
&lt;br/&gt;
5) make, make install and restart couchdb&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
p.s. i&apos;ve done patch against 703638 revision&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12406237">COUCHDB-137</key>
        <summary>Get filtered data from many views with one request</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="vad">Vadim Sukhanov</reporter>
            
    <created>Sat, 11 Oct 2008 16:30:00 +0000 (UTC)</created>
    <updated>Sat, 11 Oct 2008 16:35:52 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12638770" author="vad" created="Sat, 11 Oct 2008 16:35:52 +0000 (UTC)"  >sample script to test patch.</comment>
                </comments>
    
    <attachments>
            <attachment id="12391937" name="patch.11.10.08.1.tar.gz" size="4487" author="vad" created="Sat, 11 Oct 2008 16:32:05 +0000 (UTC)" />
            <attachment id="12391938" name="test_filters.pl" size="2627" author="vad" created="Sat, 11 Oct 2008 16:35:52 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-136] &quot;created&quot; db notifier event is missing</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-136</link>

                    <description>Update notification for creating databases was missing.</description>
                <environment></environment>
            <key id="12406230">COUCHDB-136</key>
        <summary>&quot;created&quot; db notifier event is missing</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="vmx">Volker Mische</reporter>
            
    <created>Sat, 11 Oct 2008 06:44:30 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 22:31:09 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12638724" author="vmx" created="Sat, 11 Oct 2008 06:46:05 +0000 (UTC)"  >Notify when a database was created.</comment>
                    <comment id="12666756" author="janl" created="Fri, 23 Jan 2009 22:31:09 +0000 (UTC)"  >Committed in r707076. Thanks Volker!</comment>
                </comments>
    
    <attachments>
            <attachment id="12391930" name="notify_created.patch" size="653" author="vmx" created="Sat, 11 Oct 2008 06:46:05 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:31:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:31:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-135] Offset regression between 0.8.0 and trunk</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-135</link>

                    <description>The offset returned for certain map queries differs between 0.8.0 and 0.9.0r702929.&lt;br/&gt;
&lt;br/&gt;
The attached test can be pasted into couch_tests.js. It passes in 0.8.0 and fails in 0.9.&lt;br/&gt;
&lt;br/&gt;
I believe the skip query param must be passed for this bug to be exhibited. </description>
                <environment>OSX 10.5</environment>
            <key id="12406198">COUCHDB-135</key>
        <summary>Offset regression between 0.8.0 and trunk</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.p.carey@gmail.com">Paul Carey</reporter>
            
    <created>Fri, 10 Oct 2008 19:02:26 +0000 (UTC)</created>
    <updated>Tue, 17 Mar 2009 10:40:25 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12639090" author="paul.p.carey@gmail.com" created="Mon, 13 Oct 2008 16:21:00 +0000 (UTC)"  >The RelaxDB library contains a couple of hundred lines of pagination related test code - the majority of the tests rely on the correct offset being returned.&lt;br/&gt;
&lt;br/&gt;
All these tests pass against 0.8.0, but some fail against trunk. An inconsistent number of tests fail against trunk. Typically 2, sometimes 3.&lt;br/&gt;
&lt;br/&gt;
If you&apos;re interested in running these pagination tests against CouchDB, run the following &lt;br/&gt;
&lt;br/&gt;
git clone &lt;a href=&quot;git://github.com/paulcarey/relaxdb.git&quot;&gt;git://github.com/paulcarey/relaxdb.git&lt;/a&gt; &amp;amp;&amp;amp; cd relaxdb &amp;amp;&amp;amp; git checkout a8a2d496462ad&lt;br/&gt;
and then simply&lt;br/&gt;
spec spec/paginate_spec.rb&lt;br/&gt;
&lt;br/&gt;
The following shows the result of inconsistent test failures.&lt;br/&gt;
&lt;a href=&quot;http://friendpaste.com/RHKnkRpG&quot;&gt;http://friendpaste.com/RHKnkRpG&lt;/a&gt;</comment>
                    <comment id="12666759" author="janl" created="Fri, 23 Jan 2009 22:32:24 +0000 (UTC)"  >API breaks for 0.9.</comment>
                    <comment id="12670625" author="paul.joseph.davis" created="Thu, 5 Feb 2009 04:09:10 +0000 (UTC)"  >This should fix the offset calculation errors. Damien should look over it and Paul Carey should double check that it fixes his issues.&lt;br/&gt;
&lt;br/&gt;
The way I understand things is that basically when the view was folding over the btree, pre-calculated values were not being properly remembered in the Reds variable that gets passed around. Specifically, when a kp node was passed over (ie, not examined by drop_nodes), any of the reductions associated with that node were being lost simply because they weren&apos;t added to the list.&lt;br/&gt;
&lt;br/&gt;
Hopefully that makes sense to someone else too.</comment>
                    <comment id="12670736" author="paul.p.carey@gmail.com" created="Thu, 5 Feb 2009 12:36:16 +0000 (UTC)"  >Applying this patch put a big smile on my face - it does indeed fix the main offset calculation error. &lt;br/&gt;
&lt;br/&gt;
However, running my test suite, I now see very sporadic errors which makes me think there&apos;s still a race condition lurking somewhere. Running my pagination tests suite 100 times results in about 82k requests to CouchDB and 8k test assertions. I had 8 assertions fail over the 100 test runs. I&apos;m fairly sure the issue doesn&apos;t lie with my test suite or lib.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll have a go at creating a test that reproduces the failure. </comment>
                    <comment id="12670753" author="paul.p.carey@gmail.com" created="Thu, 5 Feb 2009 14:15:18 +0000 (UTC)"  >This imaginatively titled test case does trigger what I believe is a race condition. The wrong offset is returned roughly one time in ten (on my machine).&lt;br/&gt;
&lt;br/&gt;
Potentially of interest is that once the wrong offset is returned for a query, it&apos;s always returned for that same query - i.e. it doesn&apos;t appear that the query is being satisfied before the index has been fully built.</comment>
                    <comment id="12670886" author="paul.joseph.davis" created="Thu, 5 Feb 2009 20:16:50 +0000 (UTC)"  >I&apos;m pretty sure that &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-135&quot; title=&quot;Offset regression between 0.8.0 and trunk&quot;&gt;&lt;strike&gt;COUCHDB-135&lt;/strike&gt;&lt;/a&gt; was actually (at least) two different bugs. One with propogating row count reductions, the other has to do with when a skip is specified and you skip out of the first KV node. Hopefully this fix works.</comment>
                    <comment id="12670893" author="paul.p.carey@gmail.com" created="Thu, 5 Feb 2009 20:33:33 +0000 (UTC)"  >The new patch nails this issue. I&apos;ve run all the tests from my lib a few hundred times. No failures. Happy days!</comment>
                    <comment id="12674790" author="paul.joseph.davis" created="Wed, 18 Feb 2009 21:34:43 +0000 (UTC)"  >Rebased to trunk. It&apos;d be nice to get this applied seeing as its a pretty nasty bug in the offset calculations.</comment>
                    <comment id="12674794" author="paul.joseph.davis" created="Wed, 18 Feb 2009 21:40:37 +0000 (UTC)"  >Forgot to add the JS test files to share/Makefile.am</comment>
                    <comment id="12682549" author="paul.joseph.davis" created="Tue, 17 Mar 2009 03:51:18 +0000 (UTC)"  >I committed the tests only to trunk as they passed after Damien&apos;s btree work earlier today. I&apos;d close this ticket but alas I have no such permission.</comment>
                </comments>
    
    <attachments>
            <attachment id="12400452" name="COUCHDB-135.patch" size="13110" author="paul.joseph.davis" created="Wed, 18 Feb 2009 21:40:37 +0000 (UTC)" />
            <attachment id="12391898" name="view_offsets.js" size="1376" author="paul.p.carey@gmail.com" created="Fri, 10 Oct 2008 19:03:02 +0000 (UTC)" />
            <attachment id="12399564" name="view_offsets2.js" size="1288" author="paul.p.carey@gmail.com" created="Thu, 5 Feb 2009 14:15:17 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 17 Mar 2009 10:40:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:32:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-134] ?LOG_ERROR macro is silently ignored</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-134</link>

                    <description>The ?LOG_ERROR macro incorrectly uses error_logger:info_report/2 instead of error_logger:error_report/2.</description>
                <environment></environment>
            <key id="12406026">COUCHDB-134</key>
        <summary>?LOG_ERROR macro is silently ignored</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="skarab">Hunter Morris</reporter>
            
    <created>Wed, 8 Oct 2008 15:20:19 +0000 (UTC)</created>
    <updated>Fri, 12 Dec 2008 19:37:07 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="900">0.25h</timeoriginalestimate>        <timeestimate seconds="900">0.25h</timeestimate>                    

            <comments>
                    <comment id="12637957" author="skarab" created="Wed, 8 Oct 2008 15:20:44 +0000 (UTC)"  >Quick patch to solve this issue.</comment>
                </comments>
    
    <attachments>
            <attachment id="12391743" name="couch-log.diff" size="373" author="skarab" created="Wed, 8 Oct 2008 15:20:44 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 19:37:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-133] Strange &quot;random&quot; error in view update</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-133</link>

                    <description>Never experiencing this when running an application normally, but when I run a test suite, which of course executes lots of queries in a quite short time frame. The error I get back from CouchDB (revision 700854) is:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Error (500) in request: error ({{nocatch,{error,eacces}},[{couch_view,start_update_loop,4}]}).&lt;br/&gt;
&lt;br/&gt;
This does not always seem to happen in the same test case, and after that error I can&apos;t connect to CouchDB for a short tim espan anymore (less then a second), but it comes back most times.&lt;br/&gt;
&lt;br/&gt;
Some times CouchDB stops responding completely until it is restarted after that error.&lt;br/&gt;
&lt;br/&gt;
A request causing this for example looks like:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; GET /arbit_test/_view/users/user?key=null HTTP/1.1&lt;br/&gt;
&amp;gt; Host: localhost&lt;br/&gt;
&amp;gt; Connection: Keep-Alive&lt;br/&gt;
&lt;br/&gt;
&amp;gt; HTTP/1.1 500 Internal Server Error &lt;br/&gt;
&amp;gt; Server: CouchDB/0.9.0a694945-incubating (Erlang OTP/R12B)&lt;br/&gt;
&amp;gt; Date: Wed, 01 Oct 2008 18:27:33 GMT&lt;br/&gt;
&amp;gt; Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&amp;gt; Content-Length: 90&lt;br/&gt;
&amp;gt; Cache-Control: must-revalidate&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; {&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{{nocatch,{error,eacces}},[{couch_view,start_update_loop,4}]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
The full HTTP log of a test run and the corresponding couch.log with log level=debug can be found here:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://k023.de/http.log&quot;&gt;http://k023.de/http.log&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://k023.de/couch.log&quot;&gt;http://k023.de/couch.log&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I hope this helps debugging this issue. If you need more information you may contact me on IRC (timezone: GMT; nick: koredn) in the CouchDB channel.&lt;br/&gt;
&lt;br/&gt;
If you want to run the test suite yourself, to reproduce the failures, you&apos;d need PHP 5.3 (sic!) and the latest version of PHPUnit[1] installed. Then you can just do so, by executing:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; svn co &lt;a href=&quot;svn://arbitracker.org/arbit/trunk&quot;&gt;svn://arbitracker.org/arbit/trunk&lt;/a&gt; arbit ; cd arbit&lt;br/&gt;
&amp;gt; ./runTests controller&lt;br/&gt;
&lt;br/&gt;
Kind regards,&lt;br/&gt;
Kore&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://www.phpunit.de/manual/3.3/en/installation.html&quot;&gt;http://www.phpunit.de/manual/3.3/en/installation.html&lt;/a&gt;</description>
                <environment>Linux 2.6.26-gentoo-r1 #3 PREEMPT</environment>
            <key id="12405567">COUCHDB-133</key>
        <summary>Strange &quot;random&quot; error in view update</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="apache@kore-nordmann.de">Kore Nordmann</reporter>
            
    <created>Wed, 1 Oct 2008 19:26:45 +0000 (UTC)</created>
    <updated>Fri, 3 Oct 2008 08:15:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12636393" author="damienkatz" created="Thu, 2 Oct 2008 16:40:58 +0000 (UTC)"  >This appears to be a case of CouchDB trying to open index files that were created by a different user. The pauses are because Erlang is restarting CouchDB components in an attempt to recover after the file open failures.&lt;br/&gt;
&lt;br/&gt;
Try deleting the index file to the test databases (&amp;quot;rm -rf .test_suite_db*_design&amp;quot; in the database dir) and restart couchdb.</comment>
                    <comment id="12636568" author="apache@kore-nordmann.de" created="Fri, 3 Oct 2008 08:15:46 +0000 (UTC)"  >Thanks for the help, that worked. One single view definition file really was owned by a different user.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 2 Oct 2008 16:40:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 2 Oct 2008 16:40:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-132] Merge ./configure options --with-js-include and --with-js-lib into --with-js</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-132</link>

                    <description>Spidermonkey, like most packages, uses a single $prefix directory under which headers and libraries are placed under include/ and lib/ subdirectories. So specifying both seems redundant.</description>
                <environment></environment>
            <key id="12405549">COUCHDB-132</key>
        <summary>Merge ./configure options --with-js-include and --with-js-lib into --with-js</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Wed, 1 Oct 2008 15:40:31 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 22:29:13 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12638533" author="janl" created="Fri, 10 Oct 2008 11:02:39 +0000 (UTC)"  >I found out that some Linux distros use lib64 for 64-bit libraries,&lt;br/&gt;
so SpiderMonkey would live in /usr/local/include/*.h * /usr/local/lib64/*.so&lt;br/&gt;
&lt;br/&gt;
So maybe we can add --with-js=/usr/local for the regular installs and &lt;br/&gt;
keep the separate options. We can also just close this request.</comment>
                    <comment id="12666754" author="janl" created="Fri, 23 Jan 2009 22:29:13 +0000 (UTC)"  >Silly idea.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:29:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-131] ./configure should check for crypto / OpenSSL availability in Erlang</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-131</link>

                    <description>CouchDB relies on OpenSSL (through Erlang&apos;s crypto module) to generate UUIDs. Erlang can be configured to not include crypto. CouchDB dies a horrible (read: cryptic error message) death. ./configure could check for the availability of crypto in the Erlang installation.&lt;br/&gt;
&lt;br/&gt;
This could also be solved by bundling a standalone UUID generation library. According to Damien, this is the mid-term solution.</description>
                <environment></environment>
            <key id="12405530">COUCHDB-131</key>
        <summary>./configure should check for crypto / OpenSSL availability in Erlang</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Wed, 1 Oct 2008 11:31:48 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:37:06 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12772841" author="kocolosk" created="Tue, 3 Nov 2009 02:37:06 +0000 (UTC)"  >Duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-106&quot; title=&quot;check for Erlang OpenSSL support in configure&quot;&gt;COUCHDB-106&lt;/a&gt;</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12407679">COUCHDB-151</issuekey>
        </issuelink>
                    </outwardlinks>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12402614">COUCHDB-106</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Nov 2009 02:37:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 3 Nov 2009 02:37:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-130] Allow sort order to be specified in design documents</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-130</link>

                    <description>By default, a &apos;smart&apos; sort order for strings in view keys is employed. It would be useful if one could specify a different sort order (such as raw, by unicode codepoint, etc) in a design document - either per-view, or per-document.</description>
                <environment></environment>
            <key id="12405411">COUCHDB-130</key>
        <summary>Allow sort order to be specified in design documents</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="arachnid">Nick Johnson</reporter>
            
    <created>Mon, 29 Sep 2008 18:37:21 +0000 (UTC)</created>
    <updated>Mon, 29 Sep 2008 18:37:21 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-129] add bash_completion scripts</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-129</link>

                    <description></description>
                <environment></environment>
            <key id="12405312">COUCHDB-129</key>
        <summary>add bash_completion scripts</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 28 Sep 2008 14:04:28 +0000 (UTC)</created>
    <updated>Sun, 28 Sep 2008 14:04:28 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-128] couchdb is not starting properly from init.d script in trunk</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-128</link>

                    <description></description>
                <environment></environment>
            <key id="12405311">COUCHDB-128</key>
        <summary>couchdb is not starting properly from init.d script in trunk</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 28 Sep 2008 14:03:46 +0000 (UTC)</created>
    <updated>Sun, 26 Jul 2009 13:03:01 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12670996" author="paul.joseph.davis" created="Fri, 6 Feb 2009 03:52:26 +0000 (UTC)"  >Is there no more information on this ticket? I routinely us /usr/local/etc/init.d/couchdb to start and stop couchdb on Linux.</comment>
                    <comment id="12671440" author="patrick.antivackis" created="Sat, 7 Feb 2009 10:16:24 +0000 (UTC)"  >On my side there are two things that should be changed in this file&lt;br/&gt;
&lt;br/&gt;
1) change the first line&lt;br/&gt;
#!/bin/sh -e&lt;br/&gt;
by&lt;br/&gt;
#!/bin/sh&lt;br/&gt;
in fact, i tested Linux Fedora, CentOs and Linux Mandriva and all not succeed to start with the -e flag.&lt;br/&gt;
&lt;br/&gt;
If i do  with the original init script :&lt;br/&gt;
/opt/couchdb/etc/rc.d/couchdb start&lt;br/&gt;
Nothing is started&lt;br/&gt;
&lt;br/&gt;
if i do with the original script :&lt;br/&gt;
/bin/sh /opt/couchdb/etc/rc.d/couchdb start&lt;br/&gt;
I get a :&lt;br/&gt;
Starting database server couchdb&lt;br/&gt;
And couch is indeed started.&lt;br/&gt;
&lt;br/&gt;
If i edit the init script and remove the -e flag and launch&lt;br/&gt;
/opt/couchdb/etc/rc.d/couchdb start&lt;br/&gt;
I get a :&lt;br/&gt;
Starting database server couchdb&lt;br/&gt;
And couch is indeed started.&lt;br/&gt;
&lt;br/&gt;
I look in all the scripts in /etc/init.d and none have the -e flag&lt;br/&gt;
&lt;br/&gt;
2) it should be necesssary to add &lt;br/&gt;
COUCHDB_USER=couchdb&lt;br/&gt;
in the init script to reflect the security consideration in the README file in order to not start couch as a root user&lt;br/&gt;
&lt;br/&gt;
Regards</comment>
                    <comment id="12682198" author="nslater" created="Mon, 16 Mar 2009 02:04:28 +0000 (UTC)"  >The &amp;quot;-e&amp;quot; line should be POSIX compatible.&lt;br/&gt;
&lt;br/&gt;
Debian mandates the use of POSIX compatible shell scripts so that the shell can&lt;br/&gt;
be changed from bash, sh, ash, or dash. If it is claimed that this is the case,&lt;br/&gt;
I would like to see pointers to man pages detailing the problems.&lt;br/&gt;
&lt;br/&gt;
The CouchDB username is set from /etc/default/couchdb. Please check here.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12735383" author="dmacvicar" created="Sun, 26 Jul 2009 13:03:01 +0000 (UTC)"  >The attached patch fixes the same issue on openSUSE.&lt;br/&gt;
&lt;br/&gt;
The problem was that the status and stop functions did not pass the custom pid file (which was moved from /var/run/couchdb.pid to /var/run/couchdb/couchdb.pid to have it running as couchdb user).&lt;br/&gt;
&lt;br/&gt;
With this patch the init script reports the correct status and starts/stops the server without problem.</comment>
                </comments>
    
    <attachments>
            <attachment id="12414550" name="couchdb-init.diff" size="1304" author="dmacvicar" created="Sun, 26 Jul 2009 13:03:01 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 6 Feb 2009 03:52:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-127] couchdb tarball should not include ./bootstrap</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-127</link>

                    <description></description>
                <environment></environment>
            <key id="12405310">COUCHDB-127</key>
        <summary>couchdb tarball should not include ./bootstrap</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 28 Sep 2008 14:03:13 +0000 (UTC)</created>
    <updated>Sun, 22 Feb 2009 16:56:55 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12675672" author="janl" created="Sun, 22 Feb 2009 16:56:55 +0000 (UTC)"  >&lt;a href=&apos;mailto:jan@dahlia&apos;&gt;jan@dahlia&lt;/a&gt; ~/Work/couchdb/trunk/apache-couchdb-0.9.0a746669&amp;gt; find . -name bootstrap&lt;br/&gt;
&lt;a href=&apos;mailto:jan@dahlia&apos;&gt;jan@dahlia&lt;/a&gt; ~/Work/couchdb/trunk/apache-couchdb-0.9.0a746669&amp;gt;&lt;br/&gt;
&lt;br/&gt;
this is no longer the case. I don&apos;t know in which revision this was fixed. closing.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 22 Feb 2009 16:56:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 22 Feb 2009 16:56:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-126] problem with runner.c</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-126</link>

                    <description>16:47 &amp;lt; jan____&amp;gt; nslater: runner.c problem persists                                                      &lt;br/&gt;
16:48 &amp;lt; jan____&amp;gt; test/Makefile.in:runner_beam_SOURCES = runner.c                                         &lt;br/&gt;
16:48 &amp;lt; jan____&amp;gt; test/Makefile.in:SOURCES = runner.c                                                     &lt;br/&gt;
16:48 &amp;lt; jan____&amp;gt; test/Makefile.in:DIST_SOURCES = runner.c&lt;br/&gt;
&lt;br/&gt;
The build tests should not be picking up &amp;quot;runner.c&amp;quot; automatically.</description>
                <environment></environment>
            <key id="12405309">COUCHDB-126</key>
        <summary>problem with runner.c</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 28 Sep 2008 14:02:22 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 20:30:42 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666686" author="janl" created="Fri, 23 Jan 2009 20:30:42 +0000 (UTC)"  >runner.c is gone</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 20:30:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 20:30:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-125] automake is loosing path escaping with spaces in filenames</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-125</link>

                    <description>Build with &amp;quot;./configure --prefix=/tmp/foo\ bar&amp;quot;  and see autogenerated code here:                                                                             &lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://friendpaste.com/3j5wk4cD&quot;&gt;http://friendpaste.com/3j5wk4cD&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
14:39 &amp;lt; jan____&amp;gt; nslater: the install target in src/couchdb for  couch_erl_driver.so uses $s to put in a path, the evaluation gets rid of the escaping                                           &lt;br/&gt;
14:41 &amp;lt; jan____&amp;gt; see the &amp;quot;$$p&amp;quot; &amp;lt;- that&apos;s where the path-escaping gets lost&lt;br/&gt;
&lt;br/&gt;
Sample error message:&lt;br/&gt;
&lt;br/&gt;
/usr/bin/install -c -m 644 &apos;couch_server_sup.beam&apos; &apos;/tmp/foo                                             &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/ebin/couch_server_sup.beam&apos;                     &lt;br/&gt;
/usr/bin/install -c -m 644 &apos;couch_stream.beam&apos; &apos;/tmp/foo                                                 &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/ebin/couch_stream.beam&apos;                         &lt;br/&gt;
/usr/bin/install -c -m 644 &apos;couch_util.beam&apos; &apos;/tmp/foo                                                   &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/ebin/couch_util.beam&apos;                           &lt;br/&gt;
/usr/bin/install -c -m 644 &apos;couch_view.beam&apos; &apos;/tmp/foo                                                   &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/ebin/couch_view.beam&apos;                           &lt;br/&gt;
/usr/bin/install -c -m 644 &apos;couch_db_updater.beam&apos; &apos;/tmp/foo                                             &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/ebin/couch_db_updater.beam&apos;                     &lt;br/&gt;
test -z &amp;quot;/tmp/foo bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/include&amp;quot; || /bin/mkdir -p     &lt;br/&gt;
&amp;quot;/tmp/foo bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/include&amp;quot;                              &lt;br/&gt;
/usr/bin/install -c -m 644 &apos;couch_db.hrl&apos; &apos;/tmp/foo                                                      &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/include/couch_db.hrl&apos;                           &lt;br/&gt;
test -z &amp;quot;/tmp/foo bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/priv/lib&amp;quot; || /bin/mkdir -p    &lt;br/&gt;
&amp;quot;/tmp/foo bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/priv/lib&amp;quot;                             &lt;br/&gt;
/bin/sh ../../libtool   --mode=install /usr/bin/install -c &apos;couch_erl_driver.la&apos; &apos;/tmp/foo               &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/priv/lib/couch_erl_driver.la&apos;                   &lt;br/&gt;
/usr/bin/install -c .libs/couch_erl_driver.so /tmp/foo                                                   &lt;br/&gt;
bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/priv/lib/couch_erl_driver.so                    &lt;br/&gt;
/usr/bin/install: target                                                                                 &lt;br/&gt;
`bar/lib/couchdb/erlang/lib/couch-0.9.0a694426-incubating/priv/lib/couch_erl_driver.so&apos; is not a         &lt;br/&gt;
directory                                                                                                &lt;br/&gt;
make[2]: *** [install-couchprivlibLTLIBRARIES] Error 1                                                   &lt;br/&gt;
make[2]: Leaving directory `/home/nslater/software/apache/couchdb/trunk/src/couchdb&apos;                     &lt;br/&gt;
make[1]: *** [install-am] Error 2                                                                        &lt;br/&gt;
make[1]: Leaving directory `/home/nslater/software/apache/couchdb/trunk/src/couchdb&apos;                     &lt;br/&gt;
make: *** [install-recursive] Error 1    </description>
                <environment></environment>
            <key id="12405308">COUCHDB-125</key>
        <summary>automake is loosing path escaping with spaces in filenames</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 28 Sep 2008 14:01:20 +0000 (UTC)</created>
    <updated>Sun, 5 Jul 2009 18:44:32 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12727355" author="nslater" created="Sun, 5 Jul 2009 18:44:32 +0000 (UTC)"  >Looks like an upstream WONTFIX:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://lists.gnu.org/archive/html/bug-automake/2007-10/msg00005.html&quot;&gt;http://lists.gnu.org/archive/html/bug-automake/2007-10/msg00005.html&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 5 Jul 2009 18:44:32 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-124] Adding first and last sort keys</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-124</link>

                    <description>We should add values to the view query that are guranteed to be sorted first or last.&lt;br/&gt;
&lt;br/&gt;
Simple example, given an emitted key of something like [doc.tag, doc.descr] currently to get the data for a specific tag we would use something like:&lt;br/&gt;
&lt;br/&gt;
startkey=[&apos;tag_name&apos;]&amp;amp;endkey=[&apos;tag_name&apos;, &apos;ZZZZZZ&apos;] which is a bit hackish at best.&lt;br/&gt;
&lt;br/&gt;
Perhaps startkey=[&apos;tag_name&apos;,_first_]&amp;amp;endkey=[&apos;tag_name&apos;,_last_]&lt;br/&gt;
&lt;br/&gt;
Obviously _first_ and _last_ are crappy. And _first_ would even be optional. But hopefully that conveys the idea.</description>
                <environment></environment>
            <key id="12404999">COUCHDB-124</key>
        <summary>Adding first and last sort keys</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 23 Sep 2008 19:28:32 +0000 (UTC)</created>
    <updated>Sun, 28 Sep 2008 18:36:53 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12635215" author="tapwater" created="Sun, 28 Sep 2008 07:33:10 +0000 (UTC)"  >I think this is a great idea. Perhaps something along the lines of _null could work, since its meaning could be interpreted by its context.</comment>
                    <comment id="12635245" author="jchris" created="Sun, 28 Sep 2008 18:35:20 +0000 (UTC)"  >We discussed this on IRC - there&apos;s not a good reason to add this. See &lt;a href=&quot;http://wiki.apache.org/couchdb/ViewCollation&quot;&gt;http://wiki.apache.org/couchdb/ViewCollation&lt;/a&gt; for full documentation of the JSON sort order.&lt;br/&gt;
&lt;br/&gt;
In the case of the example given, there is no need for the &apos;ZZZZ&apos; string, this is equivalent and not hackish.&lt;br/&gt;
&lt;br/&gt;
startkey=[&amp;quot;tag_name&amp;quot;]&amp;amp;endkey=[&amp;quot;tag_name&amp;quot;, {}]&lt;br/&gt;
&lt;br/&gt;
of course, this doesn&apos;t help with the case of &lt;br/&gt;
&lt;br/&gt;
startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design/ZZZZZZZZZ&amp;quot;&lt;br/&gt;
&lt;br/&gt;
which we see frequently. But there&apos;s no way a &amp;quot;special&amp;quot; value can help with a string range, because we can&apos;t allow the special value *inside* the string without opening a whole can of worms. If you didn&apos;t want to be hackish while defining a string range you could use a super-high unicode character.&lt;br/&gt;
&lt;br/&gt;
startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design/\u9999&amp;quot;&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 28 Sep 2008 18:36:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 28 Sep 2008 07:33:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-123] Error (54 &apos;Connection reset by peer&apos;) when try to fetch item from db</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-123</link>

                    <description>I recently play with django+couchdb using couchdb-python.&lt;br/&gt;
&lt;br/&gt;
Sometimes I met a error like this:&lt;br/&gt;
&lt;br/&gt;
=============================================&lt;br/&gt;
Environment:&lt;br/&gt;
&lt;br/&gt;
Request&lt;br/&gt;
Method: GET&lt;br/&gt;
Request URL:&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:8000/blog/detail/76157aebf566c3ab5dfa126f7c68f5d6/&quot;&gt;http://127.0.0.1:8000/blog/detail/76157aebf566c3ab5dfa126f7c68f5d6/&lt;/a&gt;&lt;br/&gt;
Django Version: 1.0-final-SVN-unknown&lt;br/&gt;
Python Version: 2.5.2&lt;br/&gt;
Installed Applications:&lt;br/&gt;
[&apos;django.contrib.auth&apos;, &apos;django.contrib.contenttypes&apos;,&lt;br/&gt;
&apos;django.contrib.sessions&apos;, &apos;django.contrib.sites&apos;, &apos;djcouch.blog&apos;]&lt;br/&gt;
Installed Middleware:&lt;br/&gt;
(&apos;django.middleware.common.CommonMiddleware&apos;,&lt;br/&gt;
&apos;django.contrib.sessions.middleware.SessionMiddleware&apos;,&lt;br/&gt;
&apos;django.contrib.auth.middleware.AuthenticationMiddleware&apos;)&lt;br/&gt;
Traceback:&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/django/core/handlers/base.py&amp;quot;&lt;br/&gt;
in get_response 86. response = callback(request, *callback_args,&lt;br/&gt;
**callback_kwargs)&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/Users/zai/workspace/python/djcode/djcouch/../djcouch/blog/views.py&amp;quot;&lt;br/&gt;
in detail 18. post = db.get(id)&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/lib/python2.5/site-packages/CouchDB-0.4-py2.5.egg/couchdb/client.py&amp;quot;&lt;br/&gt;
in get 295. return Document(self.resource.get(id, **options))&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/lib/python2.5/site-packages/CouchDB-0.4-py2.5.egg/couchdb/client.py&amp;quot;&lt;br/&gt;
in get 646. return self._request(&apos;GET&apos;, path, headers=headers,&lt;br/&gt;
**params)&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/lib/python2.5/site-packages/CouchDB-0.4-py2.5.egg/couchdb/client.py&amp;quot;&lt;br/&gt;
in _request 674. body=body, headers=headers)&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/lib/python2.5/site-packages/httplib2-0.4.0-py2.5.egg/httplib2/__init__.py&amp;quot;&lt;br/&gt;
in request 1050. (response, content) = self._request(conn, authority,&lt;br/&gt;
uri, request_uri, method, body, headers, redirections, cachekey)&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/lib/python2.5/site-packages/httplib2-0.4.0-py2.5.egg/httplib2/__init__.py&amp;quot;&lt;br/&gt;
in _request 854. (response, content) = self._conn_request(conn,&lt;br/&gt;
request_uri, method, body, headers)&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/lib/python2.5/site-packages/httplib2-0.4.0-py2.5.egg/httplib2/__init__.py&amp;quot;&lt;br/&gt;
in _conn_request 824. response = conn.getresponse()&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/httplib.py&amp;quot;&lt;br/&gt;
in getresponse 928. response.begin()&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/httplib.py&amp;quot;&lt;br/&gt;
in begin 385. version, status, reason = self._read_status()&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/httplib.py&amp;quot;&lt;br/&gt;
in _read_status 343. line = self.fp.readline()&lt;br/&gt;
File&lt;br/&gt;
&amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/socket.py&amp;quot;&lt;br/&gt;
in readline 331. data = recv(1)&lt;br/&gt;
Exception Type: error at /blog/detail/76157aebf566c3ab5dfa126f7c68f5d6/&lt;br/&gt;
Exception Value: (54, &apos;Connection reset by peer&apos;)&lt;br/&gt;
&lt;br/&gt;
=============================================&lt;br/&gt;
&lt;br/&gt;
I&apos;m new to python and couchdb, so I&apos;m not sure it&apos;s a bug of django, couchdb or the python client.&lt;br/&gt;
&lt;br/&gt;
Any ideas?&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Thank you,</description>
                <environment>Mac OS 10.5&lt;br/&gt;
Python 2.5.2&lt;br/&gt;
couchdb-python 0.4&lt;br/&gt;
Django 1.0</environment>
            <key id="12404784">COUCHDB-123</key>
        <summary>Error (54 &apos;Connection reset by peer&apos;) when try to fetch item from db</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="4">Incomplete</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="senmiao">Senmiao Liu</reporter>
            
    <created>Sat, 20 Sep 2008 08:07:06 +0000 (UTC)</created>
    <updated>Mon, 15 Dec 2008 22:44:15 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12632924" author="senmiao" created="Sat, 20 Sep 2008 08:08:19 +0000 (UTC)"  >Error file when get item from db</comment>
                    <comment id="12632925" author="senmiao" created="Sat, 20 Sep 2008 08:11:21 +0000 (UTC)"  >Error file when try to save new item into couchdb</comment>
                    <comment id="12656785" author="damienkatz" created="Mon, 15 Dec 2008 22:44:15 +0000 (UTC)"  >We need reproducible test case.</comment>
                </comments>
    
    <attachments>
            <attachment id="12390567" name="error at _blog_detail_76157aebf566c3ab5dfa126f7c68f5d6_.html" size="83001" author="senmiao" created="Sat, 20 Sep 2008 08:08:19 +0000 (UTC)" />
            <attachment id="12390568" name="error at _blog_new_.html" size="86100" author="senmiao" created="Sat, 20 Sep 2008 08:11:21 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 15 Dec 2008 22:44:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 15 Dec 2008 22:44:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-122] PUTting standalone attachments &gt;1Mb cause connection reset</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-122</link>

                    <description>Attempting to upload attachments to documents, whereby an attachment &amp;gt;1Mb causes the CouchDB server to reset the socket connection, and not response with a &amp;quot;sensible&amp;quot; error message.&lt;br/&gt;
&lt;br/&gt;
Modifying MAX_RECV_BODY in src/mochiweb/mochweb_request.erl (line 46) to something bigger, say 128Mb, causes the problem to disappear for reasonably large files such as mp3 files. Obviously, the problem of no &amp;quot;sensible&amp;quot; error message still remains, and the socket connection will simply be reset should the upload exceed 128Mb.&lt;br/&gt;
&lt;br/&gt;
(any attachments &amp;lt;1mb work fine and are stored properly)</description>
                <environment>Ubuntu 8.04 x86 32-bit</environment>
            <key id="12404574">COUCHDB-122</key>
        <summary>PUTting standalone attachments &gt;1Mb cause connection reset</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="ijonas">Ijonas Kisselbach</reporter>
            
    <created>Wed, 17 Sep 2008 21:19:35 +0000 (UTC)</created>
    <updated>Tue, 23 Sep 2008 17:51:01 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12633825" author="janl" created="Tue, 23 Sep 2008 17:51:01 +0000 (UTC)"  >Fixed as of r698260</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 23 Sep 2008 17:51:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 23 Sep 2008 17:51:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-121] changes to test files do not cause make to rebuild beam files</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-121</link>

                    <description>Changes to the Erlang files under /test do not cause &amp;quot;make check&amp;quot; to rebuild the beam files.</description>
                <environment></environment>
            <key id="12404305">COUCHDB-121</key>
        <summary>changes to test files do not cause make to rebuild beam files</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 13 Sep 2008 17:43:19 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 22:26:56 +0000 (UTC)</updated>

                
                        <fixVersion>1.0</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666753" author="janl" created="Fri, 23 Jan 2009 22:26:56 +0000 (UTC)"  >make check is not make test.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:26:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:26:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-120] Allow databases to be &quot;rolled back&quot; to a specific sequence ID.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-120</link>

                    <description>Rolling back databases to a specific seq_id would allow for &amp;quot;undoing&amp;quot; replication. possible use-cases included replication with an untrustworthy replication partner. &lt;br/&gt;
&lt;br/&gt;
(we should think about repl-ed and advocate safer-replication. advocating abstinence is another option, but that system is prone to #fail).</description>
                <environment></environment>
            <key id="12404299">COUCHDB-120</key>
        <summary>Allow databases to be &quot;rolled back&quot; to a specific sequence ID.</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sat, 13 Sep 2008 16:20:09 +0000 (UTC)</created>
    <updated>Mon, 29 Jun 2009 04:42:10 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12725036" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:42:10 +0000 (UTC)"  >Now that we have tail append headers we could do this pretty easily at the batch level IIUC. I reckon implementation would be &amp;quot;read back to last valid header, append a copy of it to end of file&amp;quot; type of operation.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:42:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-119] incremental local-remote replication broken: record documents have different formats</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-119</link>

                    <description>If I turn on debug-level messages in CouchDB trunk (690670) and run the replication portion of the test suite, I see messages like the following.  The (local) source DB record is represented using atoms for the document attributes, but the record in the (remote) target DB is represented using binary strings.  The result is that the replication in this case (and in the remote source-local target case) starts from sequence 0 every time.&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.250.0&amp;gt;] 127.0.0.1 - - &apos;GET&apos; /test_suite_db_b/_local/mbp:test_suite_db_a:&lt;a href=&quot;http://127.0.0.1:5984/test_suite_db_b&quot;&gt;http://127.0.0.1:5984/test_suite_db_b&lt;/a&gt; 200&lt;br/&gt;
[debug] [&amp;lt;0.63.0&amp;gt;] Found existing replication record on target&lt;br/&gt;
[info] [&amp;lt;0.63.0&amp;gt;] Replication records differ. Performing full replication instead of incremental.&lt;br/&gt;
[debug] [&amp;lt;0.63.0&amp;gt;] Record on source:[{session_id,&amp;lt;&amp;lt;&amp;quot;ff21c6245d467bfce2916b8a6315ddf0&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{source_last_seq,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{history,[{[{start_time,&amp;lt;&amp;lt;&amp;quot;Tue, 09 Sep 2008 17:09:15 GMT&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{end_time,&amp;lt;&amp;lt;&amp;quot;Tue, 09 Sep 2008 17:09:16 GMT&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{start_last_seq,0},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{end_last_seq,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{missing_checked,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{missing_found,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{docs_read,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{docs_written,10}]}]}]&lt;br/&gt;
Record on target:[{&amp;lt;&amp;lt;&amp;quot;session_id&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;ff21c6245d467bfce2916b8a6315ddf0&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;source_last_seq&amp;quot;&amp;gt;&amp;gt;,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;history&amp;quot;&amp;gt;&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{[{&amp;lt;&amp;lt;&amp;quot;start_time&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;Tue, 09 Sep 2008 17:09:15 GMT&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;end_time&amp;quot;&amp;gt;&amp;gt;,&amp;lt;&amp;lt;&amp;quot;Tue, 09 Sep 2008 17:09:16 GMT&amp;quot;&amp;gt;&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;start_last_seq&amp;quot;&amp;gt;&amp;gt;,0},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;end_last_seq&amp;quot;&amp;gt;&amp;gt;,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;missing_checked&amp;quot;&amp;gt;&amp;gt;,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;missing_found&amp;quot;&amp;gt;&amp;gt;,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;docs_read&amp;quot;&amp;gt;&amp;gt;,10},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;&amp;lt;&amp;quot;docs_written&amp;quot;&amp;gt;&amp;gt;,10}]}]}]&lt;br/&gt;
&lt;br/&gt;
One possible patch is to encode/decode the local replication doc before the comparison, but maybe the developers have a better solution.&lt;br/&gt;
</description>
                <environment>Erlang/OTP R12B-3, CouchDB &lt;a href=&apos;mailto:trunk@690670&apos;&gt;trunk@690670&lt;/a&gt;</environment>
            <key id="12404008">COUCHDB-119</key>
        <summary>incremental local-remote replication broken: record documents have different formats</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 9 Sep 2008 17:27:51 +0000 (UTC)</created>
    <updated>Wed, 24 Sep 2008 18:04:49 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12629543" author="kocolosk" created="Tue, 9 Sep 2008 17:29:56 +0000 (UTC)"  >sends local docs through a JSON roundtrip to get them in the same format as the remote replication history docs.</comment>
                    <comment id="12629946" author="jchris" created="Wed, 10 Sep 2008 20:29:44 +0000 (UTC)"  >Adam,&lt;br/&gt;
&lt;br/&gt;
Thanks for finding this! (it&apos;s another JSON regression...)&lt;br/&gt;
&lt;br/&gt;
This patch here should fix the problem without requiring the JSON round trip. &lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12629969" author="kocolosk" created="Wed, 10 Sep 2008 21:10:46 +0000 (UTC)"  >Cool, that&apos;s definitely a better patch.  Regards,&lt;br/&gt;
&lt;br/&gt;
Adam&lt;br/&gt;
</comment>
                    <comment id="12633959" author="jchris" created="Tue, 23 Sep 2008 23:04:13 +0000 (UTC)"  >fixed in r698333 - however, this bug is hard to test for, using the current replication status response.</comment>
                </comments>
    
    <attachments>
            <attachment id="12389860" name="incremental_rep.diff" size="2427" author="jchris" created="Wed, 10 Sep 2008 20:29:44 +0000 (UTC)" />
            <attachment id="12389760" name="incremental_replication_patch.diff" size="806" author="kocolosk" created="Tue, 9 Sep 2008 17:29:56 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 24 Sep 2008 18:04:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 10 Sep 2008 20:29:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-118] PATCH JSON Regression - CouchDB crash on rendering very large integers</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-118</link>

                    <description>Creating documents with gigantic integers works fine, but rendering them causes a crash as mochijson2 tries to call float(I) and Erlang is not capable of handling it. There&apos;s nothing in the JSON spec[1] to suggest that huge integers must be rendered as float, so I removed that guard from mochijson2. This fixes the bug.&lt;br/&gt;
&lt;br/&gt;
I included no Futon tests because the numbers we&apos;re dealing with are too large to be managed by Javascript. However, I will attach a Ruby test that shows the bug. It is worth noting that the Ruby test passes on old (cjson) versions of CouchDB.&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://www.ietf.org/rfc/rfc4627.txt?number=4627&quot;&gt;http://www.ietf.org/rfc/rfc4627.txt?number=4627&lt;/a&gt;</description>
                <environment></environment>
            <key id="12403949">COUCHDB-118</key>
        <summary>PATCH JSON Regression - CouchDB crash on rendering very large integers</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Tue, 9 Sep 2008 01:07:42 +0000 (UTC)</created>
    <updated>Sun, 21 Sep 2008 13:23:58 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12633067" author="jchris" created="Sun, 21 Sep 2008 13:23:58 +0000 (UTC)"  >fixed in r697512</comment>
                </comments>
    
    <attachments>
            <attachment id="12389714" name="huge_int_bug_test.rb" size="3271" author="jchris" created="Tue, 9 Sep 2008 01:08:51 +0000 (UTC)" />
            <attachment id="12389713" name="huge_int_fix.diff" size="705" author="jchris" created="Tue, 9 Sep 2008 01:08:17 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 21 Sep 2008 13:23:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-117] HTTP status code when recreating a database</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-117</link>

                    <description>If one accidentally tries to create a database when a database by that name already exists, CouchDB trunk (tested at revision 691322) responds with a 500 status code.  In slightly older versions of the trunk, the response code was 409 and the error message helpfully indicated that a database by that name already exists.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll attach a patch that restores the 409 code and error message.  I submitted this patch to the developer&apos;s mailing list on August 23rd.  It appears not to have been noticed by the core developers, so I&apos;m re-posting it here.</description>
                <environment>Mac OS X 10.4.11</environment>
            <key id="12403837">COUCHDB-117</key>
        <summary>HTTP status code when recreating a database</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="mndrix">Michael Hendricks</reporter>
            
    <created>Sat, 6 Sep 2008 22:24:21 +0000 (UTC)</created>
    <updated>Tue, 21 Oct 2008 19:35:11 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
                    <component>Test Suite</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12628920" author="mndrix" created="Sat, 6 Sep 2008 22:25:13 +0000 (UTC)"  >Patch to restore 409 status code when creating a database that already exists.</comment>
                    <comment id="12628974" author="jchris" created="Sun, 7 Sep 2008 14:32:53 +0000 (UTC)"  >Thanks Michael,&lt;br/&gt;
&lt;br/&gt;
This is the best place to put these patches. Expect a patch-application frenzy next week. </comment>
                </comments>
    
    <attachments>
            <attachment id="12389623" name="0001-Status-code-when-creating-a-database-twice.patch" size="1639" author="mndrix" created="Sat, 6 Sep 2008 22:25:13 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Oct 2008 19:35:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 7 Sep 2008 14:32:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-116] Spider wiki for usernames</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-116</link>

                    <description>We need to contact all the contributors, so we can license the documentation content under Apache 2.0.&lt;br/&gt;
&lt;br/&gt;
Here is an example url:&lt;br/&gt;
&lt;a href=&quot;http://web.archive.org/web/20071029003611/www.couchdbwiki.com/index.php?title=Main_Page&amp;action=history&quot;&gt;http://web.archive.org/web/20071029003611/www.couchdbwiki.com/index.php?title=Main_Page&amp;amp;action=history&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Maybe archive.org has a bulk export feature for domains?</description>
                <environment></environment>
            <key id="12403828">COUCHDB-116</key>
        <summary>Spider wiki for usernames</summary>

            <type id="3" iconUrl="http://issues.apache.org/jira/images/icons/task.gif">Task</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Sat, 6 Sep 2008 17:28:27 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:29:13 +0000 (UTC)</updated>

                
                
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12725037" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:44:58 +0000 (UTC)"  >Do we need this still? My first impression is that I probably skipped past a &amp;quot;you license this for ASF use&amp;quot; because the ASF is generally pretty good about law issues.</comment>
                    <comment id="12733596" author="janl" created="Tue, 21 Jul 2009 11:28:27 +0000 (UTC)"  >yeah, I don&apos;t think this is being accounted for. we should resolve that eventually (rather sooner than later). so that at least all new contributions are covered</comment>
                    <comment id="12738007" author="paul.joseph.davis" created="Sun, 2 Aug 2009 07:28:55 +0000 (UTC)"  >What do the other ASF projects do for their wiki additions? Randomly considering, it seems like someone somewhere probably considered this. Did I perhaps check a box when I created my account that says CC license for updates or something?</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:44:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-115] include conflicting doc-ids in the _bulk_docs 412 response JSON</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-115</link>

                    <description>This was discussed on the mailing list here:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/incubator-couchdb-dev/200807.mbox/%3C5879e51d0807251020vef95736ncbcaf2c81297384@mail.gmail.com%3E&quot;&gt;http://mail-archives.apache.org/mod_mbox/incubator-couchdb-dev/200807.mbox/%3C5879e51d0807251020vef95736ncbcaf2c81297384@mail.gmail.com%3E&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;m adding it as a ticket because I&apos;m having the experience that it would make my current script run much faster. Also its a little hard to see exactly how to make the patch.&lt;br/&gt;
&lt;br/&gt;
This is a proposed way the 412 response body could look:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;ok&amp;quot;:false,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;conflict_revs&amp;quot;: [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;id&amp;quot;: &amp;quot;0&amp;quot;, &amp;quot;attempted_rev&amp;quot;: &amp;quot;1001&amp;quot;, &amp;quot;current_rev&amp;quot;: &amp;quot;1002&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;id&amp;quot;: &amp;quot;2&amp;quot;, &amp;quot;attempted_rev&amp;quot;: &amp;quot;5000&amp;quot;, &amp;quot;current_rev&amp;quot;: &amp;quot;5002&amp;quot;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
}&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12403798">COUCHDB-115</key>
        <summary>include conflicting doc-ids in the _bulk_docs 412 response JSON</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Fri, 5 Sep 2008 21:35:46 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 22:22:18 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666744" author="janl" created="Fri, 23 Jan 2009 22:21:06 +0000 (UTC)"  >we&apos;ll get a new bulk-docs behaviour in 0.9 that addresses this.</comment>
                    <comment id="12666746" author="janl" created="Fri, 23 Jan 2009 22:21:59 +0000 (UTC)"  >wrong state, JIRA won&apos;t let me change without the reopen, will close in a minute.</comment>
                    <comment id="12666747" author="janl" created="Fri, 23 Jan 2009 22:22:18 +0000 (UTC)"  >see second last comment.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:22:18 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:21:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-114] Add a &apos;dev&apos; make target and a script (./utils/run) to run a development instance</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-114</link>

                    <description></description>
                <environment></environment>
            <key id="12403663">COUCHDB-114</key>
        <summary>Add a &apos;dev&apos; make target and a script (./utils/run) to run a development instance</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="skarab">Hunter Morris</reporter>
            
    <created>Thu, 4 Sep 2008 08:52:12 +0000 (UTC)</created>
    <updated>Thu, 23 Oct 2008 21:42:28 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12628284" author="skarab" created="Thu, 4 Sep 2008 09:09:33 +0000 (UTC)"  >The following should also be added to svn:ignore:&lt;br/&gt;
&lt;br/&gt;
-- trunk:&lt;br/&gt;
&lt;br/&gt;
tmp&lt;br/&gt;
&lt;br/&gt;
-- trunk/utils:&lt;br/&gt;
&lt;br/&gt;
Makefile.in&lt;br/&gt;
Makefile&lt;br/&gt;
run&lt;br/&gt;
&lt;br/&gt;
-- trunk/etc/couchdb:&lt;br/&gt;
&lt;br/&gt;
default_dev.ini&lt;br/&gt;
&lt;br/&gt;
-- trunk/bin:&lt;br/&gt;
&lt;br/&gt;
couchjs_dev</comment>
                    <comment id="12628300" author="skarab" created="Thu, 4 Sep 2008 10:22:53 +0000 (UTC)"  >This adds a couchjs_dev script which launches the JS view server without requiring make install. I missed this in testing my previous patch.</comment>
                    <comment id="12628431" author="msciab" created="Thu, 4 Sep 2008 19:01:19 +0000 (UTC)"  >I tried this patch against the trunk. It applies nicely but after ./configure ; make ; make dev if I try ./utils/run I get:&lt;br/&gt;
&lt;br/&gt;
./utils/run &lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,{undef,[{couch_server,start,[[&amp;quot;/etc/couchdb/default_dev.ini&amp;quot;,&amp;quot;/etc/couchdb/local_dev.ini&amp;quot;]]},{erl_eval,do_apply,5},{erl_eval,exprs,5},{init,start_it,1},{init,start_em,1}]}}&lt;br/&gt;
&lt;br/&gt;
Crash dump was written to: erl_crash.dump&lt;br/&gt;
init terminating in do_boot ()</comment>
                    <comment id="12628655" author="skarab" created="Fri, 5 Sep 2008 15:34:37 +0000 (UTC)"  >Did you apply both of the attached patches?&lt;br/&gt;
&lt;br/&gt;
Judging by your error output, it looks like your ./utils/run script had the wrong variables substituted. Can you tell me what the DEFAULT_INI_FILE variable is set to at the top of that file?</comment>
                    <comment id="12642291" author="janl" created="Thu, 23 Oct 2008 21:42:28 +0000 (UTC)"  >Fixed as of r707480. Thanks Hunter!</comment>
                </comments>
    
    <attachments>
            <attachment id="12389490" name="couch-utils.2.patch" size="1994" author="skarab" created="Thu, 4 Sep 2008 10:22:53 +0000 (UTC)" />
            <attachment id="12389485" name="couch-utils.patch" size="6999" author="skarab" created="Thu, 4 Sep 2008 09:38:36 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Oct 2008 21:42:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 4 Sep 2008 19:01:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-113] prblem with unicode in url parameters</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-113</link>

                    <description>I trying to pass the key [&amp;quot;40c71da841a985dad0f34fa56cad5c4c&amp;quot;, &amp;quot;je_mange_du_riz_y&amp;#xE9;y&amp;#xE9;&amp;quot;] in the view but never get result. I tried tis urls : &lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/couchit/_view/page/by_slug?key=%5B%2240c71da841a985dad0f34fa56cad5c4c%22%2C+%22je_mange_du_riz_y%5Cu00e9y%5Cu00e9%22%5D&quot;&gt;http://127.0.0.1:5984/couchit/_view/page/by_slug?key=%5B%2240c71da841a985dad0f34fa56cad5c4c%22%2C+%22je_mange_du_riz_y%5Cu00e9y%5Cu00e9%22%5D&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&apos;je_mange_du_riz_y&amp;#xE9;y&amp;#xE9;&apos; is encoded in raw unicode : je_mange_du_riz_y\u00e9y\u00e9 like I get from the json feed in futon.&lt;br/&gt;
&lt;br/&gt;
I also tryed to pass directly the url :&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5984/couchit/_view/page/by_slug?key=%5B%2240c71da841a985dad0f34fa56cad5c4c%22%2C+%22je_mange_du_riz_y%C3%A9y%C3%A9%22%5D&quot;&gt;http://127.0.0.1:5984/couchit/_view/page/by_slug?key=%5B%2240c71da841a985dad0f34fa56cad5c4c%22%2C+%22je_mange_du_riz_y%C3%A9y%C3%A9%22%5D&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
(so y&amp;#xE9;y&amp;#xE9; isn&apos;t in raw unicode) but same result. Any idee how to solve it. Did I do something wrong ?&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>osx 10.5</environment>
            <key id="12403642">COUCHDB-113</key>
        <summary>prblem with unicode in url parameters</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Wed, 3 Sep 2008 21:45:29 +0000 (UTC)</created>
    <updated>Wed, 7 Jan 2009 19:13:23 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12628182" author="benoitc" created="Wed, 3 Sep 2008 22:34:34 +0000 (UTC)"  >mmm please close it, it was a bug in my application. Sorry for the noise :/</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Jan 2009 19:13:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-112] etc/default/couchdb still points at couch.ini </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-112</link>

                    <description>etc/default/couchdb still points at couch.ini (instead of default.ini and local.ini)&lt;br/&gt;
&lt;br/&gt;
this keeps launching with&lt;br/&gt;
&lt;br/&gt;
/usr/local/etc/rc.d/couchdb start&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;from picking up local config values&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12403588">COUCHDB-112</key>
        <summary>etc/default/couchdb still points at couch.ini </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 3 Sep 2008 04:41:31 +0000 (UTC)</created>
    <updated>Thu, 11 Sep 2008 19:30:00 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12627904" author="jchris" created="Wed, 3 Sep 2008 05:00:34 +0000 (UTC)"  >the ghetto fix I&apos;ve done for this so far is:&lt;br/&gt;
&lt;br/&gt;
COUCHDB_INI_FILE=&amp;quot;/usr/local/etc/couchdb/default.ini -c /usr/local/etc/couchdb/local.ini&amp;quot;&lt;br/&gt;
&lt;br/&gt;
but maybe we should change a few scripts, and either specify a COUCHDB_INI_DIR or env variables for both the default and the local ini files.</comment>
                    <comment id="12630323" author="nslater" created="Thu, 11 Sep 2008 19:30:00 +0000 (UTC)"  >I have remove the PID and INI options from the etc/default file and added COUCHDB_OPTIONS variable.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 11 Sep 2008 19:30:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 11 Sep 2008 19:30:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-111] Javascript Error Tracebacks</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-111</link>

                    <description>Improve the errors reported by the javascript view server to provide a more friendly error report when something goes wrong. Ideally a complete traceback but anything would be better than the erlang traceback informing the user that the server died.</description>
                <environment></environment>
            <key id="12403568">COUCHDB-111</key>
        <summary>Javascript Error Tracebacks</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 2 Sep 2008 22:45:42 +0000 (UTC)</created>
    <updated>Mon, 29 Jun 2009 04:40:42 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12659753" author="jchris" created="Tue, 30 Dec 2008 07:02:13 +0000 (UTC)"  >I think the best way to handle this is to get the error all the way out to the browser. I&apos;m working on it wrt to forms, then we can standardize main.js to use it.</comment>
                    <comment id="12662064" author="lukevenediger" created="Thu, 8 Jan 2009 19:06:52 +0000 (UTC)"  >Passing a better error message back to the browser would enable better error reporting to the user.&lt;br/&gt;
&lt;br/&gt;
It would be preferable to see the SpiderMonkey error along with a line number for where the error occurred.</comment>
                    <comment id="12725035" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:40:42 +0000 (UTC)"  >Chris A. added some better error messages a couple commits  (maybe last 20?). Is this ticket still valid?</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10001">
            <name>dependent</name>
                                        <inwardlinks description="is depended upon by">
                            <issuelink>
            <issuekey id="12411635">COUCHDB-191</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 30 Dec 2008 07:02:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-110] Compaction Fails with Error</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-110</link>

                    <description>Recently my CouchDB has started acting a little funny. When I issue a compaction command like so:&lt;br/&gt;
&lt;br/&gt;
$ curl -X POST &lt;a href=&quot;http://localhost:5984/valinor/_compact&quot;&gt;http://localhost:5984/valinor/_compact&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I receive the following in my logs:&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB 0.8.1-incubating (LogLevel=info)&lt;br/&gt;
Apache CouchDB is starting.&lt;br/&gt;
&lt;br/&gt;
Apache CouchDB has started. Time to relax.&lt;br/&gt;
[info] [&amp;lt;0.60.0&amp;gt;] Starting compaction for db &amp;quot;valinor&amp;quot;&lt;br/&gt;
[info] [&amp;lt;0.56.0&amp;gt;] 127.0.0.1 - - &amp;quot;POST /valinor/_compact&amp;quot; 202&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.62.0&amp;gt; with exit value: {function_clause,[{couch_db,&apos;-copy_docs/3-fun-0-&apos;,[not_found,&amp;lt;0.58.0&amp;gt;,{stream,&amp;lt;0.64.0&amp;gt;,&amp;lt;0.63.0&amp;gt;},&amp;lt;0.63.0&amp;gt;]},{lists,map,2},{lists,map,2},{couch_db,copy_docs,3},{couch_db,copy_compact_docs,2},{couch_db,start_copy_compact_int,2}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 1-Sep-2008::12:33:17 ===&lt;br/&gt;
Error in process &amp;lt;0.62.0&amp;gt; with exit value: {function_clause,[{couch_db,&apos;-copy_docs/3-fun-0-&apos;,[not_found,&amp;lt;0.58.0&amp;gt;,{stream,&amp;lt;0.64.0&amp;gt;,&amp;lt;0.63.0&amp;gt;},&amp;lt;0.63.0&amp;gt;]},{lists,map,2},{lists,map,2},{couch_db,copy_docs,3},{couch_db,copy_compact_docs,2},{couch_db,start_copy_compact_int,2}]}&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{function_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db,&apos;-copy_docs/3-fun-0-&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[not_found,&amp;lt;0.58.0&amp;gt;,{stream,&amp;lt;0.64.0&amp;gt;,&amp;lt;0.63.0&amp;gt;},&amp;lt;0.63.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,map,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,map,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,copy_docs,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,copy_compact_docs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,start_copy_compact_int,2}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.59.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;valinor&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,open,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;valinor&amp;quot;,&amp;quot;/usr/local/var/lib/couchdb/valinor.couch&amp;quot;]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}</description>
                <environment>Debian Stable with Erlang 5.6.3</environment>
            <key id="12403508">COUCHDB-110</key>
        <summary>Compaction Fails with Error</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="blt">Brian L. Troutwine</reporter>
            
    <created>Mon, 1 Sep 2008 19:39:57 +0000 (UTC)</created>
    <updated>Tue, 2 Sep 2008 17:14:42 +0000 (UTC)</updated>

                        <version>0.8.1</version>
            
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12627749" author="damienkatz" created="Tue, 2 Sep 2008 17:14:42 +0000 (UTC)"  >Looks we don&apos;t have a reproducible scenario.&lt;br/&gt;
&lt;br/&gt;
It would be nice if we could get more information for tracking purposes:&lt;br/&gt;
What OS? Was this database created with a previous version of CouchDB? Were there any recent power failures or OS crashes? How was the database being used?</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 2 Sep 2008 17:14:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 2 Sep 2008 17:14:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-109] _all_docs doesn&apos;t work with descending=true and no startkey/endkey</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-109</link>

                    <description>&lt;a href=&quot;http://127.0.0.1:5984/test_suite_db/_all_docs?descending=true&quot;&gt;http://127.0.0.1:5984/test_suite_db/_all_docs?descending=true&lt;/a&gt; &lt;br/&gt;
&lt;br/&gt;
gives 0 rows, but&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://127.0.0.1:5985/test_suite_db/_all_docs?descending=false&quot;&gt;http://127.0.0.1:5985/test_suite_db/_all_docs?descending=false&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
works fine.&lt;br/&gt;
&lt;br/&gt;
Test is attached.</description>
                <environment></environment>
            <key id="12403506">COUCHDB-109</key>
        <summary>_all_docs doesn&apos;t work with descending=true and no startkey/endkey</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Mon, 1 Sep 2008 18:20:22 +0000 (UTC)</created>
    <updated>Fri, 30 Jan 2009 18:45:05 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12642055" author="trogdoro" created="Thu, 23 Oct 2008 05:08:04 +0000 (UTC)"  >Problem seems to have resurfaced when larger numbers of docs exist.</comment>
                    <comment id="12642285" author="jchris" created="Thu, 23 Oct 2008 21:21:50 +0000 (UTC)"  >discussion on IRC and the new test patch make this worth another look</comment>
                    <comment id="12666760" author="janl" created="Fri, 23 Jan 2009 22:34:36 +0000 (UTC)"  >Blocking for 0.9</comment>
                    <comment id="12668973" author="jchris" created="Fri, 30 Jan 2009 18:45:05 +0000 (UTC)"  >fixed in r739170</comment>
                </comments>
    
    <attachments>
            <attachment id="12389307" name="all_docs_descending.diff" size="631" author="jchris" created="Mon, 1 Sep 2008 18:20:56 +0000 (UTC)" />
            <attachment id="12392697" name="all_docs_descending_lots_of_docs.diff" size="522" author="trogdoro" created="Thu, 23 Oct 2008 05:08:04 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Jan 2009 18:45:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 23 Oct 2008 05:08:04 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-108] PATCH (JSON branch) _all_docs give no docs with startkey </title>
<link>http://issues.apache.org/jira/browse/COUCHDB-108</link>

                    <description>The design docs weren&apos;t showing in Futon. This fixes that and adds a test.</description>
                <environment></environment>
            <key id="12403367">COUCHDB-108</key>
        <summary>PATCH (JSON branch) _all_docs give no docs with startkey </summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Fri, 29 Aug 2008 14:46:44 +0000 (UTC)</created>
    <updated>Thu, 4 Sep 2008 16:59:46 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
            <attachment id="12389173" name="all_docs_startkey.diff" size="1011" author="jchris" created="Fri, 29 Aug 2008 14:47:08 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 4 Sep 2008 16:59:46 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-107] [PATCH] End JSON responses with newline char</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-107</link>

                    <description>This patch adds a newline character to all JSON responses.</description>
                <environment></environment>
            <key id="12402889">COUCHDB-107</key>
        <summary>[PATCH] End JSON responses with newline char</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Fri, 22 Aug 2008 17:06:41 +0000 (UTC)</created>
    <updated>Tue, 24 Feb 2009 18:12:19 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666742" author="janl" created="Fri, 23 Jan 2009 22:19:19 +0000 (UTC)"  >This issue was temporarily solved by Damien saying &amp;quot;no newline&amp;quot;, but the JIRA issue is still open. Close as Won&apos;t Fix or fix for 0.9 as this is API breaking. Please discuss (again, sorry)</comment>
                    <comment id="12667223" author="cmlenz" created="Mon, 26 Jan 2009 11:57:37 +0000 (UTC)"  >Here&apos;s an updated patch against current trunk (r737063), as the old one no longer applied.</comment>
                    <comment id="12676353" author="nslater" created="Tue, 24 Feb 2009 18:12:19 +0000 (UTC)"  >Patch edited and committed as r747465.</comment>
                </comments>
    
    <attachments>
            <attachment id="12388757" name="newline.diff" size="1467" author="jchris" created="Fri, 22 Aug 2008 17:09:39 +0000 (UTC)" />
            <attachment id="12398727" name="newline2.patch" size="1666" author="cmlenz" created="Mon, 26 Jan 2009 11:57:37 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Feb 2009 18:12:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:19:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-106] check for Erlang OpenSSL support in configure</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-106</link>

                    <description>We need to check to see if Erlang has been compiled with OpenSSL support.&lt;br/&gt;
&lt;br/&gt;
The following command might be useful:&lt;br/&gt;
&lt;br/&gt;
erl -eval &apos;application:load(crypto), exit(has_crypto)&apos;</description>
                <environment></environment>
            <key id="12402614">COUCHDB-106</key>
        <summary>check for Erlang OpenSSL support in configure</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Tue, 19 Aug 2008 08:45:19 +0000 (UTC)</created>
    <updated>Tue, 3 Nov 2009 02:35:04 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12755478" author="foamdino" created="Tue, 15 Sep 2009 13:19:51 +0000 (UTC)"  >Patch to configure.ac to check that Erlang has been installed with OpenSSL (&apos;crypto&apos;) support</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12405530">COUCHDB-131</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12419629" name="check_crypto.patch" size="517" author="foamdino" created="Tue, 15 Sep 2009 13:19:51 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Sep 2009 13:19:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-105] provide DARWIN and WIN32 define flags for couch_erl_driver.c</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-105</link>

                    <description>See the Automake manual:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://www.gnu.org/software/automake/manual/automake.html#Conditional-Sources&quot;&gt;http://www.gnu.org/software/automake/manual/automake.html#Conditional-Sources&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
We want to use &amp;quot;-DDARWIN&amp;quot; instead of using additional source files.</description>
                <environment></environment>
            <key id="12402518">COUCHDB-105</key>
        <summary>provide DARWIN and WIN32 define flags for couch_erl_driver.c</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 17 Aug 2008 08:23:50 +0000 (UTC)</created>
    <updated>Thu, 4 Dec 2008 21:18:50 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12623179" author="nslater" created="Sun, 17 Aug 2008 08:25:31 +0000 (UTC)"  >Jan think&apos;s there is probably a way to get this done automatically, and I think he might be right - but not in the core of Automake. Search the Autoconf Macro Archive for prebuilt solutions.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-104] modify ./configure to produce config.nice</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-104</link>

                    <description>PHP&apos;s build system produces a config.nice file, we should replicate this functionality.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://cvs.php.net/viewvc.cgi/php-src/acinclude.m4?view=markup&quot;&gt;http://cvs.php.net/viewvc.cgi/php-src/acinclude.m4?view=markup&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
See if you can find an autoconf macro.</description>
                <environment></environment>
            <key id="12402517">COUCHDB-104</key>
        <summary>modify ./configure to produce config.nice</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 17 Aug 2008 07:56:40 +0000 (UTC)</created>
    <updated>Wed, 15 Jul 2009 01:57:20 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666740" author="janl" created="Fri, 23 Jan 2009 22:14:27 +0000 (UTC)"  >minor</comment>
                    <comment id="12731243" author="jameshenstridge" created="Wed, 15 Jul 2009 01:57:20 +0000 (UTC)"  >For what it is worth, that generated config.nice script seems to be doing the same thing as running &amp;quot;./config.status --recheck&amp;quot;.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:14:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-103] Document sealing no longer works with Mozilla spidermonkey 1.8</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-103</link>

                    <description>In the spidermonkey engine, we use a built-in function sealing for sealing documents so that map functions of arrays no longer works. Array sealing no longer works with javascript 1.8, meaning our document that contain arrays cannot be sealed. The sealing is meant to prevent map functions from modifying the same document that will be passed to other map functions.&lt;br/&gt;
&lt;br/&gt;
The (hopefully temporary) fix here is to simply remove the document sealing, and map function placed in the same design document will have to be trustworthy that they don&apos;t modify the document (the same document is passed to multiple map functions). Non-trustworthy map functions can be placed in their own design documents, they will be run in isolation.&lt;br/&gt;
</description>
                <environment>all</environment>
            <key id="12402020">COUCHDB-103</key>
        <summary>Document sealing no longer works with Mozilla spidermonkey 1.8</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="damienkatz">Damien Katz</reporter>
            
    <created>Fri, 8 Aug 2008 17:46:10 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 20:39:59 +0000 (UTC)</updated>

                        <version>0.7.2</version>
                    <version>0.8</version>
            
                        <fixVersion>0.11</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666735" author="janl" created="Fri, 23 Jan 2009 22:07:30 +0000 (UTC)"  >This will be fixed in Spidermonkey 1.9: &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=449657&quot;&gt;https://bugzilla.mozilla.org/show_bug.cgi?id=449657&lt;/a&gt; &lt;br/&gt;
&lt;br/&gt;
maybe we should detect that at ./configure time and advice installation of spidermonkey 1.7 or 1.6 or 1.9 or later.</comment>
                    <comment id="12772672" author="kocolosk" created="Mon, 2 Nov 2009 20:39:59 +0000 (UTC)"  >0.10.0 is out the door, adjusting FixFor on all remaining unresolved issues to 0.11 by default</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:07:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-102] External Server Support</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-102</link>

                    <description>External Server Support&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
Based on jchris&apos;s Action Server code. Exposes an &amp;quot;_external&amp;quot; interface akin to the view server, but using a json line protocol communicates to an external process. There&apos;s a section in couch.ini that allows for custom external processes to be setup. Ie:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
[Couch External Servers]&lt;br/&gt;
fti = /path/to/couchdb-xapian-query&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
Would result in the url &amp;quot;&lt;a href=&quot;http://localhost:5984/db/_external/fti&quot;&gt;http://localhost:5984/db/_external/fti&lt;/a&gt;&amp;quot; being available. Notice the correspondence in the url to the fti specified in the config.</description>
                <environment></environment>
            <key id="12402019">COUCHDB-102</key>
        <summary>External Server Support</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Fri, 8 Aug 2008 17:45:52 +0000 (UTC)</created>
    <updated>Tue, 30 Dec 2008 06:56:37 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Full-Text Search</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12620989" author="paul.joseph.davis" created="Fri, 8 Aug 2008 17:47:42 +0000 (UTC)"  >This patch should apply cleanly against the current trunk.</comment>
                </comments>
    
    <attachments>
            <attachment id="12387837" name="0001-External-Server-Support.patch" size="15046" author="paul.joseph.davis" created="Fri, 8 Aug 2008 17:47:42 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 30 Dec 2008 06:56:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-101] posting multiple keys to a view (or temp view) allows you to fetch just the rows that match the specified keys</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-101</link>

                    <description>This patch allows a POST body like&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;keys&amp;quot;:[&amp;quot;key1&amp;quot;,&amp;quot;key2&amp;quot;,&amp;quot;key3&amp;quot;,&amp;quot;key4&amp;quot;]}&lt;br/&gt;
&lt;br/&gt;
to the _view or _temp_view endpoints to return just the view rows that match those keys. &lt;br/&gt;
&lt;br/&gt;
It works for map views, as well as reduce views (so long as group=true).</description>
                <environment></environment>
            <key id="12401909">COUCHDB-101</key>
        <summary>posting multiple keys to a view (or temp view) allows you to fetch just the rows that match the specified keys</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Thu, 7 Aug 2008 16:44:58 +0000 (UTC)</created>
    <updated>Mon, 6 Oct 2008 04:39:51 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12636995" author="jchris" created="Mon, 6 Oct 2008 04:39:51 +0000 (UTC)"  >fixed in r701814</comment>
                </comments>
    
    <attachments>
            <attachment id="12387746" name="multi_key_views.diff" size="11799" author="jchris" created="Thu, 7 Aug 2008 16:45:31 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 6 Oct 2008 04:39:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-100] DELETE on non-existent DB now returns 500 instead of 404</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-100</link>

                    <description>Previously (0.8.0), a DELETE request on a non-existent DB would return a 404 status code and the message&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Today&apos;s trunk now returns a 500 status code and the message&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;not_found&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
This breaks the test suite as it&apos;s currently written, since the deleteDb() function expects a 404 or 200 status code and will raise an exception if anything else is encountered.  To reproduce, run the test suite without creating the &amp;quot;test_suite_db&amp;quot; beforehand (or delete it if it exists).&lt;br/&gt;
</description>
                <environment>trunk @ 682809</environment>
            <key id="12401737">COUCHDB-100</key>
        <summary>DELETE on non-existent DB now returns 500 instead of 404</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="kocolosk">Adam Kocoloski</reporter>
            
    <created>Tue, 5 Aug 2008 22:29:09 +0000 (UTC)</created>
    <updated>Thu, 7 Aug 2008 21:20:35 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12620083" author="kocolosk" created="Tue, 5 Aug 2008 23:07:48 +0000 (UTC)"  >Hi, I did a little sleuthing and found that I could trace the problem down to &lt;br/&gt;
&lt;br/&gt;
handle_call({open, DbName, Options}, {FromPid,_}, Server)&lt;br/&gt;
&lt;br/&gt;
in couch_server.erl.  Specifically, in line 175 the call to &lt;br/&gt;
&lt;br/&gt;
couch_db:start_link(DbName, Filepath, Options)&lt;br/&gt;
&lt;br/&gt;
returns {error,not_found}, which is sent back up the chain until it hits a handle_db_request in couch_httpd.erl that isn&apos;t prepared to deal with it:&lt;br/&gt;
&lt;br/&gt;
handle_db_request(Req, Method, {DbName, Rest}) -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case couch_db:open(DbName, []) of&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ok, Db} -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;handle_db_request(Req, Method, {DbName, Db, Rest})&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;after&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;couch_db:close(Db)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Error -&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throw(Error)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end;&lt;br/&gt;
&lt;br/&gt;
Then everything goes boom.  Hope it helps, Adam</comment>
                    <comment id="12620753" author="janl" created="Thu, 7 Aug 2008 21:20:34 +0000 (UTC)"  >Fixed in trunk as of r683704.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 7 Aug 2008 21:20:35 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 7 Aug 2008 21:20:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-99] Broken pagination when browsing database</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-99</link>

                    <description>The pagination is broken when browsing a database. For example, on initially clicking to view the database I see &amp;quot;Showing 1-25 of 7357 rows&amp;quot;. Then after clicking the &apos;Next Page&apos; link, I get &amp;quot;Showing 2-26 of 7357 rows&amp;quot;.&lt;br/&gt;
</description>
                <environment>Debian server, Firefox 3 client</environment>
            <key id="12401690">COUCHDB-99</key>
        <summary>Broken pagination when browsing database</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="ciarang">Ciaran Gultnieks</reporter>
            
    <created>Tue, 5 Aug 2008 11:37:01 +0000 (UTC)</created>
    <updated>Tue, 21 Oct 2008 18:48:42 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12634259" author="jchris" created="Wed, 24 Sep 2008 19:17:36 +0000 (UTC)"  >This is a problem with the _all_docs view not returning the correct offset. Instead of giving the actual offset, _all_docs returns the skip value as the offset. Investigating a fix...&lt;br/&gt;
&lt;br/&gt;
Normal views don&apos;t have this problem, just _all_docs.</comment>
                    <comment id="12634330" author="jchris" created="Wed, 24 Sep 2008 22:54:36 +0000 (UTC)"  >After some debugging, I&apos;m stumped, but the place to pickup, for anyone who&apos;s interested, I think, is&lt;br/&gt;
&lt;br/&gt;
couchdb_updater:btree_by_id_reduce(reduce, FullDocInfos)&lt;br/&gt;
&lt;br/&gt;
If you log the FullDocInfos, you&apos;ll see that some of the arguments as they come in, don&apos;t match the full_doc_info record. Hence, they are not counted in either column.&lt;br/&gt;
&lt;br/&gt;
It seems that docs that come before the startkey are the ones that don&apos;t show up as full_doc_info records in the function, and those which are after the startkey are just fine. I&apos;m not sure why this would be -- might be in the heart of couch_btree:stream_kp_node, but I can&apos;t see a reason for this behavior. &lt;br/&gt;
&lt;br/&gt;
Or I could be on the totally wrong track. When this bug is fixed I&apos;ll definitely be curious to read the diffs!</comment>
                    <comment id="12636174" author="jchris" created="Wed, 1 Oct 2008 21:04:31 +0000 (UTC)"  >This patch is merely the test that must pass in order to verify that the bug has been fixed. Uploading it here so that others may attack the bug with confidence.</comment>
                    <comment id="12641408" author="jasondd" created="Tue, 21 Oct 2008 15:29:08 +0000 (UTC)"  >I&apos;m seeing a possibly related issue: when displaying custom view, only the first 10 rows are shown, with no &amp;quot;next&amp;quot; link, even though there are 31 rows in total.  I can view the 31 rows if I set the number of rows per page to 100 instead of 10.&lt;br/&gt;
&lt;br/&gt;
When viewing the JSON generated by the view in question, it has no &amp;quot;total_rows&amp;quot; attribute set.  I don&apos;t know if that&apos;s normal, but that might help find the source of the problem.</comment>
                    <comment id="12641493" author="damienkatz" created="Tue, 21 Oct 2008 18:48:42 +0000 (UTC)"  >Fix because skipped reduction values weren&apos;t getting assembled before reduction.&lt;br/&gt;
&lt;br/&gt;
Callers of btrees are allowed to use complex objects instead of key/value pair tuples, if they also provide a function to extract the key and the value from the complex object, and another function to re-assemble it. This re-assemble step wasn&apos;t happening with certain skipped keys, meaning they couldn&apos;t be reduced properly.</comment>
                </comments>
    
    <attachments>
            <attachment id="12391316" name="test_all_docs_offset.diff" size="545" author="jchris" created="Wed, 1 Oct 2008 21:04:31 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 21 Oct 2008 18:48:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 24 Sep 2008 19:17:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-98] PATCH _load_docs API for multiple docs from a single request</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-98</link>

                    <description>PATCH so that POST to _load_docs with a POST body like:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;ids&amp;quot;:[&amp;quot;0&amp;quot;,&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]}&lt;br/&gt;
&lt;br/&gt;
returns the documents with ids 0, 1, 2, and 3.&lt;br/&gt;
&lt;br/&gt;
I&apos;m seeking feedback on the names and structure of the API.</description>
                <environment></environment>
            <key id="12401653">COUCHDB-98</key>
        <summary>PATCH _load_docs API for multiple docs from a single request</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Mon, 4 Aug 2008 21:16:25 +0000 (UTC)</created>
    <updated>Mon, 11 Aug 2008 00:32:56 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
            <attachment id="12387525" name="load_bulk_docs.diff" size="2811" author="jchris" created="Mon, 4 Aug 2008 21:17:33 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 11 Aug 2008 00:32:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-97] Bulk insert needs to specify on conflict error which doc is conflicting</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-97</link>

                    <description>The current error couchdb gives is a 412 error:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;conflict&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Update conflict&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
This type of error needs to give which document(s) were conflicted, at the very least.</description>
                <environment>using couchdb 0.9.0a677590-incubating, POSTing 20 thousand documents to _bulk_insert via curl --data-binary</environment>
            <key id="12400943">COUCHDB-97</key>
        <summary>Bulk insert needs to specify on conflict error which doc is conflicting</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="tapwater">Gilbert B Garza</reporter>
            
    <created>Thu, 24 Jul 2008 18:57:08 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 12:49:34 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666909" author="janl" created="Sat, 24 Jan 2009 12:49:34 +0000 (UTC)"  >0.9 will get a new bulk insert behaviour. Closing.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:49:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 12:49:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-96] Call to gen_server:call can time out</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-96</link>

                    <description>When running long view updates I have encountered the following error in the log file, with no other useful information.&lt;br/&gt;
&lt;br/&gt;
HTTP Error (code 500): {timeout,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.63.0&amp;gt;,{pread_bin,2779756233}]}}</description>
                <environment></environment>
            <key id="12400314">COUCHDB-96</key>
        <summary>Call to gen_server:call can time out</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="tilgovi">Randall Leeds</reporter>
            
    <created>Tue, 15 Jul 2008 20:00:27 +0000 (UTC)</created>
    <updated>Fri, 12 Dec 2008 19:39:30 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12656127" author="damienkatz" created="Fri, 12 Dec 2008 19:39:30 +0000 (UTC)"  >couch_file calls no longer timeout.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 19:39:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 12 Dec 2008 19:39:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-95] HTTP/mochiweb failures when tested via Safari</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-95</link>

                    <description>The tests randomly fail, but from Safari they seem to fail much more often than other browsers. We think it&apos;s a timing bug inside mochiweb, and Safari has a fast javascript engine and triggers it more reliably.&lt;br/&gt;
&lt;br/&gt;
Typically when there is a test failure, an error like this is reported at the Erlang console:&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.2821.0&amp;gt;] {error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.2821.0&amp;gt;,crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.2821.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{case_clause,{error,einval}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request,get,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,acceptor_loop,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&amp;lt;0.110.0&amp;gt;,#Port&amp;lt;0.164&amp;gt;,#Fun&amp;lt;mochiweb_http.1.62821608&amp;gt;}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_httpd,couch_server_sup,&amp;lt;0.31.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.110.0&amp;gt;,#Port&amp;lt;0.369&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,[{mochiweb_request_qs,[{&amp;quot;rev&amp;quot;,&amp;quot;2421655930&amp;quot;}]}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,4181},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,23},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,79705}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
[error] [&amp;lt;0.110.0&amp;gt;] {error_report,&amp;lt;0.24.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.110.0&amp;gt;,std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,235,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,{case_clause,{error,einval}}}}}}&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 15-Jul-2008::13:54:26 ===&lt;br/&gt;
{mochiweb_socket_server,235,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,{case_clause,{error,einval}}}}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Running test suite from Safari on OS X with a local couchdb instance</environment>
            <key id="12400306">COUCHDB-95</key>
        <summary>HTTP/mochiweb failures when tested via Safari</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="damienkatz">Damien Katz</reporter>
            
    <created>Tue, 15 Jul 2008 18:00:45 +0000 (UTC)</created>
    <updated>Fri, 25 Jul 2008 16:38:09 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>0.8.1</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12616940" author="cmlenz" created="Fri, 25 Jul 2008 16:38:09 +0000 (UTC)"  >This was fixed in r679636.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 25 Jul 2008 16:38:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 25 Jul 2008 16:38:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-94] Set up a buildbot-like continuous integration tool for the CouchDB project</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-94</link>

                    <description>We need continuous integration.&lt;br/&gt;
&lt;br/&gt;
We need to find out if the ASF provides that and if it does, how we can use it. If not, we need to look for alternatives.&lt;br/&gt;
&lt;br/&gt;
This is up for grabs, if you want to take care of that, assign this task to yourself.</description>
                <environment></environment>
            <key id="12400174">COUCHDB-94</key>
        <summary>Set up a buildbot-like continuous integration tool for the CouchDB project</summary>

            <type id="3" iconUrl="http://issues.apache.org/jira/images/icons/task.gif">Task</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sat, 12 Jul 2008 21:40:01 +0000 (UTC)</created>
    <updated>Mon, 2 Nov 2009 21:21:27 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12621707" author="mscholl" created="Tue, 12 Aug 2008 06:05:27 +0000 (UTC)"  >We are working on an open source continuous integration software which works &apos;erlang style&apos;. &lt;br/&gt;
The backend of the software utilizes erlang for distribution, control and execution of &apos;distributed test&apos; jobs. Jobs itself are created and started via a webgui. &lt;br/&gt;
Are you interested in our software?!</comment>
                    <comment id="12621754" author="nslater" created="Tue, 12 Aug 2008 10:04:27 +0000 (UTC)"  >Jan, what specifically did you in mind given CouchDB&apos;s lack of command line tests?&lt;br/&gt;
&lt;br/&gt;
As it currently stands, the entire source is built for distribution each night by my systems and published as a nightly build. As the unit tests are integrated with the build, if any part of this fails I will get an email with the details. If you want, I can make it so that these emails are sent to couchdb-dev.&lt;br/&gt;
&lt;br/&gt;
For now, this provides a sort of poor-man&apos;s continuous integration.</comment>
                    <comment id="12621755" author="nslater" created="Tue, 12 Aug 2008 10:06:07 +0000 (UTC)"  >Also, Apache do not provide this for us, see &lt;a href=&quot;http://www.apache.org/dev/nightly-builds.html&quot;&gt;http://www.apache.org/dev/nightly-builds.html&lt;/a&gt;</comment>
                    <comment id="12621772" author="janl" created="Tue, 12 Aug 2008 11:08:16 +0000 (UTC)"  >Noah, this was meant as a general todo item. And as a reminder to check what the ASF does for us. Not much as the link suggests. Having your build results and stats recorded somewhere would be nice. Note that I am not an expert on continuous integration, I might miss something obvious.&lt;br/&gt;
&lt;br/&gt;
Also, CLI tests are coming with the merge of the runtimeconfig branch, they &amp;quot;just&amp;quot; need to be expanded :)&lt;br/&gt;
&lt;br/&gt;
If that software does make sense for us to use, I don&apos;t know, we should have a look at it. </comment>
                    <comment id="12621780" author="nslater" created="Tue, 12 Aug 2008 11:34:36 +0000 (UTC)"  >Oh sure, and my comment just meant to be informational.&lt;br/&gt;
&lt;br/&gt;
I&apos;ll have a ponder about publishing the output of the nightly builds, could be useful.</comment>
                    <comment id="12621797" author="janl" created="Tue, 12 Aug 2008 12:37:45 +0000 (UTC)"  >Noah, having stats about timing of test runs might give us hints about performance regressions for example.</comment>
                    <comment id="12621803" author="mndrix" created="Tue, 12 Aug 2008 12:59:04 +0000 (UTC)"  >It would be convenient to publish the results of the nightly builds by storing the results in a CouchDB instance.  That would give us a nice, permanent history of the results.  Maybe with documents something like this:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;date&amp;quot; : &amp;quot;2008-08-12&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;revision&amp;quot; : &amp;quot;123456&amp;quot;, // Subversion revision number&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;duration&amp;quot; : &amp;quot;252&amp;quot;, // number of seconds required to complete the test suite&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;test_count&amp;quot; : &amp;quot;75&amp;quot;, // total number of tests&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;failed&amp;quot; : [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;conflicts&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;bulk_docs&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
</comment>
                    <comment id="12646041" author="bbrowning" created="Sun, 9 Nov 2008 01:01:58 +0000 (UTC)"  >ASF uses Hudson for continuous integration. Information for getting things setup are here:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/general/Hudson&quot;&gt;http://wiki.apache.org/general/Hudson&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Hudson is typically used with Java projects but it should be pretty easy to get it to build CouchDB. I have experience with Hudson and if needed can provide assistance to the ASF Hudson maintainers to get things setup.</comment>
                    <comment id="12772698" author="kocolosk" created="Mon, 2 Nov 2009 21:21:27 +0000 (UTC)"  >gmcdonald helped set up a Buildbot instance for us:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/builders/couchdb-trunk&quot;&gt;http://ci.apache.org/builders/couchdb-trunk&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/builders/couchdb-coverage&quot;&gt;http://ci.apache.org/builders/couchdb-coverage&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://ci.apache.org/projects/couchdb/cover/index.html&quot;&gt;http://ci.apache.org/projects/couchdb/cover/index.html&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 2 Nov 2009 21:21:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 12 Aug 2008 06:05:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-93] Add option to run CouchDB with Erlang&apos;s profiling tools</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-93</link>

                    <description>Erlang comes with a set of code coverage and profiling tools that can be helpful to track down performance problems as well as performance regressions over time. It would be nice if it would be easy to profile CouchDB with these tools. &lt;br/&gt;
&lt;br/&gt;
coverage needs a different build, so --with-coverage makes sense.&lt;br/&gt;
&lt;br/&gt;
Profiling does not need a recompilation and would best&lt;br/&gt;
served (IMHO) as couchdb --profile-function-calls and --profile-function-times&lt;br/&gt;
or however that would be integrated into the command.&lt;br/&gt;
&lt;br/&gt;
couchdb --profile=function-calls --profile=function-call-times&lt;br/&gt;
--profile=function-fall-times-cpu or have some way to pass&lt;br/&gt;
options down to the profiler, you get the idea, some way of&lt;br/&gt;
specifying at runtime how to profile CouchDB.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12400173">COUCHDB-93</key>
        <summary>Add option to run CouchDB with Erlang&apos;s profiling tools</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sat, 12 Jul 2008 21:37:37 +0000 (UTC)</created>
    <updated>Sat, 12 Jul 2008 21:37:37 +0000 (UTC)</updated>

                
                        <fixVersion>1.0</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-92] Have compaction work on view indexes</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-92</link>

                    <description>Right now, view indexes just grow and grow with each new index update. Since they are just indexes, and not the data itself, compaction is simply a matter of deleting the index files.&lt;br/&gt;
&lt;br/&gt;
Also, the current Btree implementation isn&apos;t completely self balanacing. It misses a balancing condition, partially for efficiency (it&apos;s an expensive balancing operation), and for expediency. It was easier to not implement it and gets the general case perormance boost.&lt;br/&gt;
&lt;br/&gt;
The thing about this is, the btree code can remain as is if the indexing compaction just recopies the map values (and back indexes) and recomputes the reduction values. That&apos;s a very simple design, however, if the btree is completely self balancing, then the btree can be copied on a node by node basis, instead of a value by value basis, and the reduction values need not be recomputed all. This will make the compaction significantly faster overall.</description>
                <environment></environment>
            <key id="12400172">COUCHDB-92</key>
        <summary>Have compaction work on view indexes</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sat, 12 Jul 2008 21:28:07 +0000 (UTC)</created>
    <updated>Sun, 19 Jul 2009 19:47:03 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>0.10</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>3</votes>
    
                                        

            <comments>
                    <comment id="12666701" author="janl" created="Fri, 23 Jan 2009 20:55:00 +0000 (UTC)"  >pull into 0.9. please discuss.</comment>
                    <comment id="12677080" author="kocolosk" created="Thu, 26 Feb 2009 18:13:54 +0000 (UTC)"  >Hi, I took a shot at compacting views this week.  Initial results look promising.  I took the simpler approach of letting the compaction recompute the reductions.  I also let the MapReduce view updater take care of the situation where the compacted view is still behind the main view due to documents being updated during compaction.  The draft API is&lt;br/&gt;
&lt;br/&gt;
HTTP&lt;br/&gt;
POST /dbname/_compact/groupname =&amp;gt; 202 {&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
&lt;br/&gt;
Erlang&lt;br/&gt;
couch_view_compactor:start_compact(&amp;lt;&amp;lt;&amp;quot;dbname&amp;quot;&amp;gt;&amp;gt;, &amp;lt;&amp;lt;&amp;quot;_design/groupname&amp;quot;&amp;gt;&amp;gt;) -&amp;gt; ok&lt;br/&gt;
&lt;br/&gt;
Code is available on GitHub at&lt;br/&gt;
&lt;a href=&quot;http://github.com/kocolosk/couchdb/tree/jira-92&quot;&gt;http://github.com/kocolosk/couchdb/tree/jira-92&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Cheers, Adam</comment>
                    <comment id="12695794" author="kocolosk" created="Sat, 4 Apr 2009 22:10:36 +0000 (UTC)"  >Actually, I think it&apos;d be better if the interface was&lt;br/&gt;
&lt;br/&gt;
HTTP&lt;br/&gt;
POST /dbname/_compact/groupname =&amp;gt; 202 {&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
&lt;br/&gt;
Erlang&lt;br/&gt;
couch_view_compactor:start_compact(&amp;lt;&amp;lt;&amp;quot;dbname&amp;quot;&amp;gt;&amp;gt;, &amp;lt;&amp;lt;&amp;quot;groupname&amp;quot;&amp;gt;&amp;gt;) -&amp;gt; ok&lt;br/&gt;
&lt;br/&gt;
If no one objects I&apos;ll add this trunk before 0.10</comment>
                    <comment id="12695798" author="jchris" created="Sat, 4 Apr 2009 23:06:27 +0000 (UTC)"  >I think it should go into trunk, for sure.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12733056" author="kocolosk" created="Sun, 19 Jul 2009 19:47:02 +0000 (UTC)"  >committed a long time ago, forgot to close the issue</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 19 Jul 2009 19:47:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 26 Feb 2009 18:13:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-91] Enable View Server to support full text search</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-91</link>

                    <description>CouchDB should do view intersections with full text results. &lt;br/&gt;
&lt;br/&gt;
A fulltext index would always index an entire database.&lt;br/&gt;
&lt;br/&gt;
At query time, CouchDB gets back a list of matching documents and then finds the emited view rows from those documents,  and returns them sorted by relevance score. This will require some enhancements to the internal view API, but the data and required index (views keys by doc id) already exist to make this efficient.</description>
                <environment></environment>
            <key id="12400171">COUCHDB-91</key>
        <summary>Enable View Server to support full text search</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Sat, 12 Jul 2008 21:20:54 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 21:57:01 +0000 (UTC)</updated>

                
                
                        <component>Full-Text Search</component>
                    <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666733" author="janl" created="Fri, 23 Jan 2009 21:57:01 +0000 (UTC)"  >Paul Davis will open another ticket with the most recent discussion and solutions on Fulltext search for views and dbs.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:57:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-90] A custom query should not run until the user clicks the &quot;Run&quot; button</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-90</link>

                    <description>The view build time for new/custom queries against a large database is long and processor intensive. In addition the default custom view functions (emit all docs with a null key) are only useful as a guide/template.&lt;br/&gt;
&lt;br/&gt;
I suggest that the custom query tool only requests the view once the user explicitly clicks on the &amp;quot;Run&amp;quot; button. It would also make more sense if the &amp;quot;View Code&amp;quot; panel is always visible.</description>
                <environment></environment>
            <key id="12400155">COUCHDB-90</key>
        <summary>A custom query should not run until the user clicks the &quot;Run&quot; button</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="emgee">Matt Goodall</reporter>
            
    <created>Sat, 12 Jul 2008 09:53:47 +0000 (UTC)</created>
    <updated>Thu, 8 Jan 2009 10:18:16 +0000 (UTC)</updated>

                        <version>0.9</version>
            
                
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12659870" author="jasondd" created="Tue, 30 Dec 2008 17:57:11 +0000 (UTC)"  >This is a duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-145&quot; title=&quot;Please Don&apos;t Immediately Execute a Map Function from Futon When Starting New Custom Query&quot;&gt;&lt;strike&gt;COUCHDB-145&lt;/strike&gt;&lt;/a&gt; and should be closed.</comment>
                    <comment id="12661923" author="cmlenz" created="Thu, 8 Jan 2009 10:18:16 +0000 (UTC)"  >Closing as dupe of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-145&quot; title=&quot;Please Don&apos;t Immediately Execute a Map Function from Futon When Starting New Custom Query&quot;&gt;&lt;strike&gt;COUCHDB-145&lt;/strike&gt;&lt;/a&gt; as suggested</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 8 Jan 2009 10:18:16 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 30 Dec 2008 17:57:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-89] DELETE on a DB returns 200 and not 202 as documented</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-89</link>

                    <description>When deleting an existing database, all works ok but the returned HTTP code is 200 and not 202 as documented (&lt;a href=&quot;http://wiki.apache.org/couchdb/HttpDatabaseApi&quot;&gt;http://wiki.apache.org/couchdb/HttpDatabaseApi&lt;/a&gt;) &lt;br/&gt;
&lt;br/&gt;
In fact, the documentation is a bit ambigous because it says &apos;202 OK&apos; and not &apos;202 Accepted&apos; or &apos;200 OK&apos;. &lt;br/&gt;
&lt;br/&gt;
While 202 makes more sense to me, this might be intentional in which case let me know and I will update the Wiki (or you do it ;) )&lt;br/&gt;
</description>
                <environment>Ubuntu Linux x86_64, CouchDB From SVN, revision 674345</environment>
            <key id="12399678">COUCHDB-89</key>
        <summary>DELETE on a DB returns 200 and not 202 as documented</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="shahar.e">Shahar Evron</reporter>
            
    <created>Sun, 6 Jul 2008 20:55:50 +0000 (UTC)</created>
    <updated>Sun, 6 Jul 2008 21:51:10 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12610868" author="cmlenz" created="Sun, 6 Jul 2008 21:41:44 +0000 (UTC)"  >The HTTP spec says: &amp;quot;A successful response SHOULD be 200 (OK) if the response includes an entity describing the status, 202 (Accepted) if the action has not yet been enacted, or 204 (No Content) if the action has been enacted but the response does not include an entity.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
The deletion is immediately performed by CouchDB, so 202 is inappropriate, and as the response contains a JSON body ({ok: true} IIRC), 204 would be incorrect, too. That leaves us with 200 :)&lt;br/&gt;
&lt;br/&gt;
So, this should indeed be updated in the Wiki, please go forward and update it!</comment>
                    <comment id="12610871" author="shahar.e" created="Sun, 6 Jul 2008 21:51:10 +0000 (UTC)"  >Wiki is fixed - no need to fix code ;)&lt;br/&gt;
Thanks!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 6 Jul 2008 21:51:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 6 Jul 2008 21:41:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-88] Installation refinement for Ubuntu 8.04</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-88</link>

                    <description>&lt;a href=&quot;http://incubator.apache.org/couchdb/docs/installation.html&quot;&gt;http://incubator.apache.org/couchdb/docs/installation.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
lists the following dependencies: &lt;br/&gt;
apt-get install build-essential erlang libicu36 libicu36-dev libmozjs-dev&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
However, libicu36-dev is no longer valid.  It should be libicu-dev, making the statement:&lt;br/&gt;
apt-get install build-essential erlang libicu36 libicu-dev libmozjs-dev</description>
                <environment>Ubuntu Hardy Heron 8.04</environment>
            <key id="12399333">COUCHDB-88</key>
        <summary>Installation refinement for Ubuntu 8.04</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="dundeemt">Jeff Hinrichs</reporter>
            
    <created>Tue, 1 Jul 2008 02:49:00 +0000 (UTC)</created>
    <updated>Tue, 1 Jul 2008 11:57:52 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12609536" author="nslater" created="Tue, 1 Jul 2008 11:57:52 +0000 (UTC)"  >This has been fixed in 0.8.0. Thank you for your bug report.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 1 Jul 2008 11:57:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 1 Jul 2008 11:57:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-87] Should not send transfer-encoding: chunked to an HTTP/1.0 client.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-87</link>

                    <description>Transfer-Encoding: chunked is only specified in HTTP/1.1 making it incorrect to send it to a client who advertises themselves as HTTP/1.0.&lt;br/&gt;
&lt;br/&gt;
This currently causes Paisley which is an HTTP/1.0 client to hang waiting for CouchDB to sever the connection.  Which may indicate that CouchDB is also trying to use a persistent connection by default which is also not allowed in HTTP/1.0.</description>
                <environment></environment>
            <key id="12399136">COUCHDB-87</key>
        <summary>Should not send transfer-encoding: chunked to an HTTP/1.0 client.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="dreid">David Reid</reporter>
            
    <created>Fri, 27 Jun 2008 04:15:02 +0000 (UTC)</created>
    <updated>Fri, 27 Jun 2008 21:57:15 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12608831" author="cmlenz" created="Fri, 27 Jun 2008 16:48:26 +0000 (UTC)"  >I can&apos;t reproduce this problem here:&lt;br/&gt;
&lt;br/&gt;
$ telnet 127.0.0.1 5984&lt;br/&gt;
Trying 127.0.0.1...&lt;br/&gt;
Connected to localhost.&lt;br/&gt;
Escape character is &apos;^]&apos;.&lt;br/&gt;
GET /blog/_all_docs?count=1 HTTP/1.0&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 200 OK&lt;br/&gt;
Server: CouchDB/0.8.0-incubating (Erlang OTP/R12B)&lt;br/&gt;
Date: Fri, 27 Jun 2008 16:47:34 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:0,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;0086A43F2BCCD05824A6EABD29EEE088&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;0086A43F2BCCD05824A6EABD29EEE088&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;2239156694&amp;quot;}}&lt;br/&gt;
]}Connection closed by foreign host.&lt;br/&gt;
</comment>
                    <comment id="12608851" author="dreid" created="Fri, 27 Jun 2008 17:38:44 +0000 (UTC)"  >Ok, so with telnet the connection gets severed correctly.  Perhaps it is getting severed with paisley too and something else is going wrong because it received chunked data.  However&lt;br/&gt;
&lt;br/&gt;
However couchdb built from the 0.8.0 tarball definitely exhibits this behavior. I&apos;ve tested with and without a count argument and both are using the chunked Transfer-Encoding.&lt;br/&gt;
&lt;br/&gt;
$ telnet localhost 5984&lt;br/&gt;
Trying ::1...&lt;br/&gt;
telnet: connect to address ::1: Connection refused&lt;br/&gt;
Trying fe80::1...&lt;br/&gt;
telnet: connect to address fe80::1: Connection refused&lt;br/&gt;
Trying 127.0.0.1...&lt;br/&gt;
Connected to localhost.&lt;br/&gt;
Escape character is &apos;^]&apos;.&lt;br/&gt;
GET /mydb/_all_docs HTTP/1.0&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 200 OK&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
Date: Fri, 27 Jun 2008 17:33:59 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
94&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:2,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;0efd8309b5bf3de2f46374b38bcfa88b&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;0efd8309b5bf3de2f46374b38bcfa88b&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1770569613&amp;quot;}}&lt;br/&gt;
3b&lt;br/&gt;
,&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;mydoc&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;mydoc&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;541388443&amp;quot;}}&lt;br/&gt;
4&lt;br/&gt;
&lt;br/&gt;
]}&lt;br/&gt;
0&lt;br/&gt;
&lt;br/&gt;
Connection closed by foreign host.&lt;br/&gt;
</comment>
                    <comment id="12608930" author="dreid" created="Fri, 27 Jun 2008 21:57:14 +0000 (UTC)"  >An old mochiweb was being loaded because of sudo couchdb still loading my user&apos;s ~/.erlang</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 27 Jun 2008 21:57:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 27 Jun 2008 16:48:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-86] (CouchDB on Windows) compaction can not be done.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-86</link>

                    <description>During compacting, rename the current DB file to a .old file is not allowed on Windows.&lt;br/&gt;
&lt;br/&gt;
A possible workaround for this could be: &lt;br/&gt;
1. Close current DB file (.couch);&lt;br/&gt;
2. Send db_updated to update to use .compact;&lt;br/&gt;
3. After 5sec, delete the .couch file;  ---- This is done in a linked process, after that, this process send a message to update_loop;&lt;br/&gt;
4. After received the message in update_loop, close current DB file which is a .compact file, then rename it to .couch;&lt;br/&gt;
5. Finally, db_updated again to use this new .couch file.&lt;br/&gt;
&lt;br/&gt;
Maybe, there would be a &amp;quot;pause&amp;quot; in service?&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Windows XP,    Erlang/OTP R12B-3</environment>
            <key id="12398966">COUCHDB-86</key>
        <summary>(CouchDB on Windows) compaction can not be done.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="zhengji.li">Li Zhengji</reporter>
            
    <created>Wed, 25 Jun 2008 06:26:18 +0000 (UTC)</created>
    <updated>Mon, 29 Jun 2009 04:34:57 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>1.0</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="18000">5h</timeoriginalestimate>        <timeestimate seconds="18000">5h</timeestimate>                    

            <comments>
                    <comment id="12666730" author="janl" created="Fri, 23 Jan 2009 21:55:08 +0000 (UTC)"  >flag for 1.0. Windows support would be nice. </comment>
                    <comment id="12725034" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:34:57 +0000 (UTC)"  >We shouldn&apos;t allow interruptions in service just because Windows doesn&apos;t allow the unlink/replace semantics. See the notes on &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-67&quot; title=&quot;Allow unicode chars in database names and _design documents (was: Allow periods (&amp;quot;.&amp;quot;) in database names)&quot;&gt;COUCHDB-67&lt;/a&gt; for a lead on getting compaction to work for windows.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:34:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:55:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-85] couch_server:all_databases() does not work on file name case-insensitive OS, such as Windows.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-85</link>

                    <description>&amp;quot;Filename -- Root&amp;quot;: the &amp;quot;--&amp;quot; here will not work as we want obviously. For example, Filename = &amp;quot;e:/aa.couch&amp;quot;, Root = &amp;quot;E:/&amp;quot;, then (Filename -- Root) = &amp;quot;eaa.couch&amp;quot;. Not to say &amp;quot;/&amp;quot; and &amp;quot;\&amp;quot; on Windows.  &lt;br/&gt;
&lt;br/&gt;
&amp;quot;--&amp;quot; should not be used here. The simple way to do this would be: delete(FileName, 1, length(Root)).</description>
                <environment>Windows XP,  Erlang/OTP R12B-3</environment>
            <key id="12398883">COUCHDB-85</key>
        <summary>couch_server:all_databases() does not work on file name case-insensitive OS, such as Windows.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="zhengji.li">Li Zhengji</reporter>
            
    <created>Tue, 24 Jun 2008 01:17:48 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:16:30 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>1.0</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>        <timeestimate seconds="7200">2h</timeestimate>                    

            <comments>
                    <comment id="12609183" author="zhengji.li" created="Mon, 30 Jun 2008 08:32:13 +0000 (UTC)"  >Please review my resolution. &lt;br/&gt;
&lt;br/&gt;
all_databases() -&amp;gt;&lt;br/&gt;
	{ok, Root} = gen_server:call(couch_server, get_root),&lt;br/&gt;
	DbNameStart = string:len(Root) + 1,&lt;br/&gt;
	Filenames = &lt;br/&gt;
	filelib:fold_files(Root, &amp;quot;^[a-z0-9\\_\\$()\\+\\-]*[\\.]couch$&amp;quot;, true,&lt;br/&gt;
		fun(Filename, AccIn) -&amp;gt;&lt;br/&gt;
			case string:substr(Filename, DbNameStart) of&lt;br/&gt;
			[$/ | RelativeFilename] -&amp;gt; ok;&lt;br/&gt;
			RelativeFilename -&amp;gt; ok&lt;br/&gt;
			end,&lt;br/&gt;
			[filename:rootname(RelativeFilename, &amp;quot;.couch&amp;quot;) | AccIn]&lt;br/&gt;
		end, []),&lt;br/&gt;
	{ok, Filenames}.</comment>
                    <comment id="12666731" author="janl" created="Fri, 23 Jan 2009 21:55:39 +0000 (UTC)"  >flag for 1.0</comment>
                    <comment id="12666739" author="janl" created="Fri, 23 Jan 2009 22:13:54 +0000 (UTC)"  >Antony says, fixing &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-67&quot; title=&quot;Allow unicode chars in database names and _design documents (was: Allow periods (&amp;quot;.&amp;quot;) in database names)&quot;&gt;COUCHDB-67&lt;/a&gt; will fix this. mark as future-dupe :-)</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12396899">COUCHDB-67</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 22:13:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:55:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-84] Reduce with group=true and count set to less than the # of returned rows, fails to close the json array</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-84</link>

                    <description>Running a request with group=true and a count which limits the amount of rows returned, results in invalid JSON (and a 500 error being logged by CouchDB). The problems has been reproduced in a test case attached to this ticket.&lt;br/&gt;
&lt;br/&gt;
The fix may be a little iffy (I changed some code that was probably like it was for a reason...) so please review before applying the patch.</description>
                <environment></environment>
            <key id="12398811">COUCHDB-84</key>
        <summary>Reduce with group=true and count set to less than the # of returned rows, fails to close the json array</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Mon, 23 Jun 2008 06:04:36 +0000 (UTC)</created>
    <updated>Tue, 29 Jul 2008 18:35:22 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>0.8.1</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12607247" author="jchris" created="Mon, 23 Jun 2008 14:53:05 +0000 (UTC)"  >I&apos;m afraid my fix for the invalid JSON bug might lead to CouchDB calculating the group=true results for the whole view, even it it only returns n = count of them. I&apos;ve noticed that the fix, while it works in against the test suite, doesn&apos;t stay fixed when the data set is large.</comment>
                    <comment id="12607385" author="cmlenz" created="Mon, 23 Jun 2008 21:33:26 +0000 (UTC)"  >Patch applied in r670774. Thanks!</comment>
                    <comment id="12616990" author="jchris" created="Fri, 25 Jul 2008 18:26:19 +0000 (UTC)"  >The old fix continues to calculate the group reduce view long after the count has been reached. This new patch makes these queries MUCH faster, as well as fixing a potential invalid JSON response on very large data sets.</comment>
                    <comment id="12616992" author="jchris" created="Fri, 25 Jul 2008 18:27:35 +0000 (UTC)"  >This patch works with couch_btree&apos;s throw() to catch the view generation, so that valid JSON is produced and the function isn&apos;t run across the entire data set.</comment>
                    <comment id="12617041" author="cmlenz" created="Fri, 25 Jul 2008 20:21:16 +0000 (UTC)"  >Is that test case you added supposed to fail without the patch? It seems to be working okay for me.</comment>
                    <comment id="12617834" author="cmlenz" created="Tue, 29 Jul 2008 16:18:56 +0000 (UTC)"  >Can you please file this second problem as a new issue? We&apos;d like to get 0.8.1 out without this patch, but seeing how the first patch has been integrated and merged...</comment>
                    <comment id="12617899" author="damienkatz" created="Tue, 29 Jul 2008 18:35:22 +0000 (UTC)"  >Fixed in trunk in 680796. Used an approach similar to the last proposed fix, but with the &amp;quot;try catch&amp;quot; happening in the btree code. This fix probably won&apos;t make in into 0.8.1, but its not critical.</comment>
                </comments>
    
    <attachments>
            <attachment id="12386906" name="group_view_count.diff" size="1987" author="jchris" created="Fri, 25 Jul 2008 18:27:35 +0000 (UTC)" />
            <attachment id="12384469" name="missing_json_end.diff" size="1529" author="jchris" created="Mon, 23 Jun 2008 06:05:15 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 29 Jul 2008 16:18:56 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Jun 2008 21:33:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-83] undefined in an array as a key causes an Erlang error</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-83</link>

                    <description>Whenever a view emits an array containing undefined as a key an Erlang is thrown:&lt;br/&gt;
&lt;br/&gt;
For example, if there&apos;s at least one document in the db without foo being set, the following view&lt;br/&gt;
&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;emit([doc.foo], doc);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
triggers&lt;br/&gt;
&lt;br/&gt;
{{nocatch,{bad_value,&amp;quot;Cannot encode &apos;undefined&apos; value as JSON&amp;quot;}},&lt;br/&gt;
&amp;nbsp;[{couch_query_servers,prompt,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{couch_query_servers,&apos;-map_docs/2-fun-0-&apos;,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{lists,map,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{couch_query_servers,map_docs,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{couch_view,view_compute,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{couch_view,update_group,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;{couch_view,temp_update_loop,2}]}&lt;br/&gt;
&lt;br/&gt;
OTOH, &lt;br/&gt;
&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;emit(doc.foo, doc);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
causes no problems.</description>
                <environment></environment>
            <key id="12398795">COUCHDB-83</key>
        <summary>undefined in an array as a key causes an Erlang error</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="rszopa">Ryszard Szopa</reporter>
            
    <created>Sun, 22 Jun 2008 23:54:51 +0000 (UTC)</created>
    <updated>Mon, 23 Jun 2008 20:38:03 +0000 (UTC)</updated>

                        <version>0.7.2</version>
                    <version>0.8</version>
            
                        <fixVersion>0.8.1</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12607364" author="cmlenz" created="Mon, 23 Jun 2008 20:17:05 +0000 (UTC)"  >Should be fixed by r670732.</comment>
                    <comment id="12607370" author="cmlenz" created="Mon, 23 Jun 2008 20:38:02 +0000 (UTC)"  >Well, together with r670737, at least.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Jun 2008 20:17:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Jun 2008 20:17:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-82] total_rows should be the number of rows returned if the count parameter is not supplied</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-82</link>

                    <description>I need the ability to paginate though a subset of a view. I make view requests with startkey, endkey, and count. I would like to paginate through these rows, but I cannot know the total rows between startkey and endkey without making an extra view which adds up the totals.&lt;br/&gt;
&lt;br/&gt;
It would be much better if total_rows, returned in the view, reflected the number of rows that would be returned had the count parameter not been supplied.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12398611">COUCHDB-82</key>
        <summary>total_rows should be the number of rows returned if the count parameter is not supplied</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="antirobotrobot">antirobotrobot</reporter>
            
    <created>Thu, 19 Jun 2008 18:27:09 +0000 (UTC)</created>
    <updated>Tue, 9 Sep 2008 10:25:07 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12608055" author="antirobotrobot" created="Wed, 25 Jun 2008 14:32:04 +0000 (UTC)"  >Why this is necessary: without it the majority of pagination use cases will require two requests. One map request to get the rows, and a second map-reduce request to calculate the total rows.&lt;br/&gt;
&lt;br/&gt;
Imagine a livejournal-like application with blog posts owned by different users. We want a paginated view of a single user&apos;s posts. Certainly one view could be made which does&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;emit( [doc.user_id, doc.post_date], doc );&lt;br/&gt;
And we can query all of the posts of John using startkey=[&amp;quot;john&amp;quot;] endkey=[&amp;quot;john&amp;quot;, []]. Happily CouchDB tries to solve pagination for us, so we attached count=10 to the view query to get the first 10 posts of john. However, the total_rows parameter returned by the request tells us how many posts there are in total, not how many John has. This can be solved with a second  request. Or alternatively it could be solved by having a view for each user on livejournal.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12629437" author="janl" created="Tue, 9 Sep 2008 10:24:52 +0000 (UTC)"  >CouchDB streams view results directly from the index to the client, there is no way to know in advance how big a result set is and buffering everything to do a count is not a good idea. won&apos;t fix. a workaround is a reduce function to do the counting for you.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Sep 2008 10:25:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Sep 2008 10:24:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-81] Design document not selectable from the top right select (on Opera 9.5)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-81</link>

                    <description>You cannot see any views you create because of a bug on the Opera side (same for IE actually).</description>
                <environment>Opera 9.5</environment>
            <key id="12398509">COUCHDB-81</key>
        <summary>Design document not selectable from the top right select (on Opera 9.5)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="greut">Yoan Blanc</reporter>
            
    <created>Wed, 18 Jun 2008 14:01:28 +0000 (UTC)</created>
    <updated>Fri, 25 Jul 2008 16:07:40 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8.1</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12605951" author="greut" created="Wed, 18 Jun 2008 14:02:51 +0000 (UTC)"  >Patch that avoid using jQuery for adding option inside the optgroup...&lt;br/&gt;
&lt;br/&gt;
see &lt;a href=&quot;http://dev.jquery.com/ticket/3040&quot;&gt;http://dev.jquery.com/ticket/3040&lt;/a&gt;</comment>
                    <comment id="12607543" author="greut" created="Tue, 24 Jun 2008 10:04:32 +0000 (UTC)"  >A more jQuery-friendy patch. The only problem was $(&amp;quot;&amp;lt;optiongroup&amp;gt;&amp;lt;/optiongroup&amp;gt;&amp;quot;) and the workaround is: $(document.createElement(&amp;quot;optiongroup&amp;quot;));&lt;br/&gt;
&lt;br/&gt;
First patch is obsolete imho.</comment>
                    <comment id="12616931" author="cmlenz" created="Fri, 25 Jul 2008 16:07:40 +0000 (UTC)"  >Patch applied in r679846. Thanks a lot!</comment>
                </comments>
    
    <attachments>
            <attachment id="12384216" name="browse_opera950.js.patch" size="1412" author="greut" created="Wed, 18 Jun 2008 14:02:51 +0000 (UTC)" />
            <attachment id="12384574" name="browse_opera950_20080624.js.patch" size="1437" author="greut" created="Tue, 24 Jun 2008 10:04:32 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 25 Jul 2008 16:07:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 25 Jul 2008 16:07:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-80] LD_LIBRARY_PATH shouldn&apos;t be needed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-80</link>

                    <description>This should be configured at build time, see:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://xahlee.org/UnixResource_dir/_/ldpath.html&quot;&gt;http://xahlee.org/UnixResource_dir/_/ldpath.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html&quot;&gt;http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html&lt;/a&gt;</description>
                <environment></environment>
            <key id="12398360">COUCHDB-80</key>
        <summary>LD_LIBRARY_PATH shouldn&apos;t be needed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="4" iconUrl="http://issues.apache.org/jira/images/icons/status_reopened.gif">Reopened</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Mon, 16 Jun 2008 19:06:48 +0000 (UTC)</created>
    <updated>Sun, 2 Aug 2009 19:16:19 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12738013" author="paul.joseph.davis" created="Sun, 2 Aug 2009 08:00:27 +0000 (UTC)"  >Nothing needs LD_LIBRARY_PATH anymore so I&apos;m closing this.</comment>
                    <comment id="12738118" author="paul.joseph.davis" created="Sun, 2 Aug 2009 19:16:19 +0000 (UTC)"  >As I explained in IRC, LD_LIBRARY_PATH is for people that don&apos;t feel like putting their libraries into directories that are searched by ld by default. The proper way to do make the LD_LIBRARY_PATH disappear is to tell people to use the system default paths, change their ld.so.conf or deal with LD_LIBRARY_PATH.&lt;br/&gt;
&lt;br/&gt;
Most of the reports I&apos;ve seen on this are in reference to spidermonkey on OS X. Checking the build instructions at [1] shows that we&apos;re telling people to put the library in a unsearched library path...&lt;br/&gt;
&lt;br/&gt;
The proper directions are to either use a command like this:&lt;br/&gt;
&lt;br/&gt;
JS_DIST=/usr/local/ make -f Makefile.ref export&lt;br/&gt;
&lt;br/&gt;
to install the bits into a default searched directory (On OS X, I seem to recall that not all distros search /usr/local/lib but I could be making that up...)&lt;br/&gt;
&lt;br/&gt;
Or we can add a couple symlinks like such:&lt;br/&gt;
&lt;br/&gt;
JS_DIST=/usr/local/spidermonkey make -f Makefile.ref export&lt;br/&gt;
sudo ln -s /usr/local/spidermonkey/lib/libjs.dylib /usr/local/lib&lt;br/&gt;
sudo ln -s /usr/local/spidermonkey/include /usr/local/include/js&lt;br/&gt;
&lt;br/&gt;
in case people don&apos;t want to install directly into those directories for some odd reason.&lt;br/&gt;
&lt;br/&gt;
I verified both approaches but I have a port version of spidermonkey installed so I would like someone without the port version installed to double check that it wasn&apos;t sneaking in there somehow. otool said it wasn&apos;t but who can be certain without checking.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Just to point out, there&apos;s still noting in CouchDB that needs LD_LIBRARY_PATH XD</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Aug 2009 08:00:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-79] it shouldn&apos;t be possible to delete documents that don&apos;t exist in a bulk upload</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-79</link>

                    <description>If you try to delete in _bulk_docs (by setting the attribute &amp;quot;_deleted&amp;quot; to true) a document that doesn&apos;t exist (either because it doesn&apos;t have an id, or because it has an id not present in the database), CouchDB replies with a happy 201 (created). This is not a good behavior: if I am trying to delete something that&apos;s not in the database, then I am probably doing something wrong, and I&apos;d like to know it: the whole transaction (bulk upload) should fail.&lt;br/&gt;
&lt;br/&gt;
Also, the present behavior is inconsistent with respect to deleting with a DELETE request, which returns a 404.</description>
                <environment></environment>
            <key id="12398281">COUCHDB-79</key>
        <summary>it shouldn&apos;t be possible to delete documents that don&apos;t exist in a bulk upload</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rszopa">Ryszard Szopa</reporter>
            
    <created>Sat, 14 Jun 2008 21:09:40 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 21:52:36 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12605104" author="janl" created="Sat, 14 Jun 2008 21:23:21 +0000 (UTC)"  >Re: &amp;quot;either because it doesn&apos;t have an id, or because it has an id not present in the database&amp;quot; &amp;lt;- in CouchDB&apos;s case this is synonymous. If something exists in a database it has an id.&lt;br/&gt;
&lt;br/&gt;
In general I think we agreed on behaving _bulk_docs like a proper transaction and if a DELETE causes an error, the transaction should be aborted. We also agreed on introducing the old behaviour with an optional member (_ignore_errors or so) that allows fire-and-forget type of bulk requests. This might be relevant to this discussion.</comment>
                    <comment id="12666729" author="janl" created="Fri, 23 Jan 2009 21:52:36 +0000 (UTC)"  >We&apos;ll get a different build update behaviour for 0.9. closing as invalid.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:52:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 14 Jun 2008 21:23:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-78] CouchDB crashed Erland</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-78</link>

                    <description>Not sure if this is a CouchDB or Erlang bug or both. Please, forward to Erland team if appropriate.&lt;br/&gt;
&lt;br/&gt;
What happened:&lt;br/&gt;
I&apos;ve started several thousands of atomic inserts with modified sample php script from &lt;a href=&quot;http://wiki.apache.org/couchdb/GettingStartedWithPhp&quot;&gt;http://wiki.apache.org/couchdb/GettingStartedWithPhp&lt;/a&gt;&lt;br/&gt;
In the middle of insert loop I initiated database compact from localhost:5984/_utils interface.&lt;br/&gt;
Several thousands of inserts later CouchDB dumped the following error and terminated:&lt;br/&gt;
&lt;br/&gt;
[ ...similar successfull POSTs are cut &apos;till this point... ]&lt;br/&gt;
[info] [&amp;lt;0.23823.0&amp;gt;] 127.0.0.1 - - &amp;quot;POST /test&amp;quot; 201&lt;br/&gt;
[info] [&amp;lt;0.91.0&amp;gt;] Compaction file still behind main file (update seq=8728. compact update seq=8727). Retrying.&lt;br/&gt;
[info] [&amp;lt;0.23830.0&amp;gt;] 127.0.0.1 - - &amp;quot;POST /test&amp;quot; 201&lt;br/&gt;
[info] [&amp;lt;0.91.0&amp;gt;] Compaction file still behind main file (update seq=8729. compact update seq=8728). Retrying.&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.23848.0&amp;gt; with exit value: {{case_clause,{error,{{badmatch,{error,emfile}},[{couch_file,init,1},{gen_server,init_it,6},{proc_lib,init_p,5}]}}},[{couch_db,start_copy_compact_int,2}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 12-Jun-2008::19:06:07 ===&lt;br/&gt;
Error in process &amp;lt;0.23848.0&amp;gt; with exit value: {{case_clause,{error,{{badmatch,{error,emfile}},[{couch_file,init,1},{gen_server,init_it,6},{proc_lib,init_p,5}]}}},[{couch_db,start_copy_compact_int,2}]}&lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{case_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,emfile}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_file,init,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,init_it,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db,start_copy_compact_int,2}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.90.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;test&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;test&amp;quot;,&amp;quot;/usr/local/var/lib/apache-couchdb/test.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.90.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;test&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;test&amp;quot;,&amp;quot;/usr/local/var/lib/apache-couchdb/test.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.90.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;test&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;test&amp;quot;,&amp;quot;/usr/local/var/lib/apache-couchdb/test.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.90.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;test&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;test&amp;quot;,&amp;quot;/usr/local/var/lib/apache-couchdb/test.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[info] [&amp;lt;0.23837.0&amp;gt;] HTTP Error (code 500): {&apos;EXIT&apos;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{{case_clause,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{badmatch,{error,emfile}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_file,init,1},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,init_it,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_db,start_copy_compact_int,2}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{gen_server,call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;lt;0.90.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{update_docs,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{doc,&amp;quot;a2f6aac30a31e34aedc253ae17c3eaa2&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;4020863542&amp;quot;],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{obj,[{&amp;quot;index&amp;quot;,5777},{&amp;quot;data&amp;quot;,&amp;quot;Foo&amp;quot;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[],false,[]}]],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[new_edits]}]}}}&lt;br/&gt;
[error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.90.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;test&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;test&amp;quot;,&amp;quot;/usr/local/var/lib/apache-couchdb/test.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.47.0&amp;gt;] {error_report,&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.47.0&amp;gt;,supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.90.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;test&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;test&amp;quot;,&amp;quot;/usr/local/var/lib/apache-couchdb/test.couch&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,shutdown}&lt;br/&gt;
</description>
                <environment>Linux 2.6.25.4-30.fc9.i686 #1 SMP Wed May 21 18:12:35 EDT 2008 i686 i686 i386 GNU/Linux&lt;br/&gt;
</environment>
            <key id="12398170">COUCHDB-78</key>
        <summary>CouchDB crashed Erland</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="sergeyk">Sergey Kurtsev</reporter>
            
    <created>Thu, 12 Jun 2008 15:21:56 +0000 (UTC)</created>
    <updated>Thu, 12 Jun 2008 18:23:28 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12604539" author="sergeyk" created="Thu, 12 Jun 2008 15:29:05 +0000 (UTC)"  >Erlang crash dump is in attached file.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Erlang version R12B-1.1.fc9  is from Fedora repository.</comment>
                    <comment id="12604604" author="damienkatz" created="Thu, 12 Jun 2008 18:23:28 +0000 (UTC)"  >Problem was couchdb failing to close file handles during compaction reattempts. Fixed in revision 667188.&lt;br/&gt;
&lt;br/&gt;
Note, it is not a good idea to attempt compaction on a database is near full capacity for its write load. The problem is the compaction process may never catch up with the writes if they never let up, and eventually it will run out of disk space.&lt;br/&gt;
&lt;br/&gt;
Compaction should be attempted when the write load is less than full capacity. Read load won&apos;t affect its ability to complete however.</comment>
                </comments>
    
    <attachments>
            <attachment id="12383919" name="erl_crash.dump" size="431099" author="sergeyk" created="Thu, 12 Jun 2008 15:29:05 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 12 Jun 2008 18:23:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 12 Jun 2008 18:23:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-77] Querying views with update=false should not update views</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-77</link>

                    <description>Querying a view with update=false should respond immediately with results from the latest available view index, even if the view is currently being updated for another request. Sometimes stale data is better than data that could possibly take forever.&lt;br/&gt;
&lt;br/&gt;
Looking through the code my guess is that update=false is being dropped on the floor somewhere between the http request parser and the actual view response generation code. Wish I could say for sure why it&apos;s not working, but I&apos;ve verified that .view files are modified even when update=false is passed in.</description>
                <environment></environment>
            <key id="12397492">COUCHDB-77</key>
        <summary>Querying views with update=false should not update views</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 4 Jun 2008 17:32:35 +0000 (UTC)</created>
    <updated>Fri, 30 Jan 2009 03:17:07 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
                    <component>Documentation</component>
            
            <due></due>
    
            <votes>2</votes>
    
                                        

            <comments>
                    <comment id="12666727" author="janl" created="Fri, 23 Jan 2009 21:50:25 +0000 (UTC)"  >update=false is now stale=ok with clearly defined semantics. but it needs to be documented. Chris?</comment>
                    <comment id="12668725" author="jchris" created="Fri, 30 Jan 2009 03:17:07 +0000 (UTC)"  >documented on &lt;a href=&quot;http://wiki.apache.org/couchdb/HTTP_view_API&quot;&gt;http://wiki.apache.org/couchdb/HTTP_view_API&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Jan 2009 03:17:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:50:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-76] API access to the Map side of Map/Reduce pairs</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-76</link>

                    <description>Everytime I create a reduce function, I also make a separate view that has a byte-identical map (w/o the reduce), just to have access to the map that gets generated anyway. It seems like the API could make the map side available, even when there is a reduce. Keeping the two view functions identical is hard to do without automating it, and the consequences of failing to keep them in sync can be expensive.&lt;br/&gt;
&lt;br/&gt;
This would require a change to the external api, because currently the only way to distinguish between map and reduce functions is through view name. The new way would require something like /my-db/_view/mydesign/mymapreduce?map_only=true or somesuch.</description>
                <environment></environment>
            <key id="12397484">COUCHDB-76</key>
        <summary>API access to the Map side of Map/Reduce pairs</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Wed, 4 Jun 2008 15:42:26 +0000 (UTC)</created>
    <updated>Sat, 20 Sep 2008 22:20:15 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12633015" author="jchris" created="Sat, 20 Sep 2008 22:20:15 +0000 (UTC)"  >applied patch from Paul Davis via&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/davisp/couchdb/tree/reduceonly&quot;&gt;http://github.com/davisp/couchdb/tree/reduceonly&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 20 Sep 2008 22:20:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-75] CouchDB crash on large insert</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-75</link>

                    <description>I&apos;ve managed to kill couchdb with a crash. Mentioned it to jan and he said to post the logs.&lt;br/&gt;
&lt;br/&gt;
I haven&apos;t seen this with running the xapian indexer, but even if that&apos;s the case it would still seem that something is wrong to allow one of the external processes to crash the entire erlang process.&lt;br/&gt;
&lt;br/&gt;
Anyway, the log, an erlang dump, and the script I used to import the data that causes the error fairly reproducibly will be attached.&lt;br/&gt;
&lt;br/&gt;
The script expects wikipedia abstracts as input. They can be downloaded from:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://download.wikimedia.org/enwiki/latest/enwiki-latest-abstract.xml&quot;&gt;http://download.wikimedia.org/enwiki/latest/enwiki-latest-abstract.xml&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Alternatively they can just be loaded from the url, but I dunno if that will trigger the error.&lt;br/&gt;
</description>
                <environment>couchdb trunk patched with the json full text search patch using xapian as an indexer.&lt;br/&gt;
</environment>
            <key id="12397231">COUCHDB-75</key>
        <summary>CouchDB crash on large insert</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sat, 31 May 2008 18:33:02 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 21:50:54 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12601405" author="paul.joseph.davis" created="Sat, 31 May 2008 18:34:43 +0000 (UTC)"  >Error log, erlang dump, and a script that triggers the error.</comment>
                    <comment id="12666728" author="janl" created="Fri, 23 Jan 2009 21:50:54 +0000 (UTC)"  >Closed on reporter&apos;s request</comment>
                </comments>
    
    <attachments>
            <attachment id="12383174" name="wiki.tar.gz" size="9521358" author="paul.joseph.davis" created="Sat, 31 May 2008 18:34:43 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:50:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:50:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-74] CouchDB full text searching</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-74</link>

                    <description>The presented patch now applies to trunk. This patch only changes the protocol used to communicate with an external query server.&lt;br/&gt;
&lt;br/&gt;
*IMPORTANT*&lt;br/&gt;
Before applying the patch, you must run the following command from the root couchdb project director:&lt;br/&gt;
$ svn mv src/couchdb/couch_ft_query.erl src/couchdb/couch_query.erl&lt;br/&gt;
&lt;br/&gt;
*NOTE*&lt;br/&gt;
The python scripts for indexing and searching a database can now be found at:&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/couchprojects/&quot;&gt;http://code.google.com/p/couchprojects/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
To check out:&lt;br/&gt;
svn checkout &lt;a href=&quot;http://couchprojects.googlecode.com/svn/trunk/query_servers/xapian&quot;&gt;http://couchprojects.googlecode.com/svn/trunk/query_servers/xapian&lt;/a&gt; couchdb-xapian&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>trunk</environment>
            <key id="12397206">COUCHDB-74</key>
        <summary>CouchDB full text searching</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Fri, 30 May 2008 21:34:38 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 20:52:10 +0000 (UTC)</updated>

                
                
                        <component>Full-Text Search</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12601264" author="paul.joseph.davis" created="Fri, 30 May 2008 21:37:05 +0000 (UTC)"  >See the ticket for instructions.</comment>
                    <comment id="12601372" author="olly" created="Sat, 31 May 2008 10:14:36 +0000 (UTC)"  >You can get backported packages for x86 and x86-64 for all recent versions of Debian and Ubuntu (including gutsy) from xapian.org - see the download page for details.  Currently these are for 1.0.5, which includes user metadata support (which was added in 1.0.3).</comment>
                    <comment id="12601401" author="paul.joseph.davis" created="Sat, 31 May 2008 17:32:54 +0000 (UTC)"  >I made the json communication stuffs appliable to trunk.&lt;br/&gt;
&lt;br/&gt;
### IMPORTANT ###&lt;br/&gt;
&lt;br/&gt;
To apply this patch correctly, you must first do:&lt;br/&gt;
&lt;br/&gt;
$ svn mv src/couchdb/couch_ft_query.erl src/couchdb/couch_query.erl&lt;br/&gt;
&lt;br/&gt;
After renaming the file, the patch should apply cleanly.&lt;br/&gt;
&lt;br/&gt;
After some discussions on IRC about the incompatibilities of Xapian and ASF, I&apos;ll be opening a google code project for the indexer/query-server scripts used.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12666698" author="janl" created="Fri, 23 Jan 2009 20:52:10 +0000 (UTC)"  >The patch is way out of date and there are more recent efforts to get fulltext into CouchDB. Closing as irrelevant.</comment>
                </comments>
    
    <attachments>
            <attachment id="12383172" name="json_communication.patch" size="7781" author="paul.joseph.davis" created="Sat, 31 May 2008 17:32:54 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 20:52:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 31 May 2008 10:14:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-73] Updated the couchdb &lt;-&gt; external query server protocol to JSON</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-73</link>

                    <description>I&apos;ve written a patch that upgrades the FullTextSearchQueryServer protocol to json documents.&lt;br/&gt;
&lt;br/&gt;
The patch also renames the FullTextSearchQueryServer variables to ExternalQueryServer so that it&apos;s apparent that its not just limited to fulltext stuffs.&lt;br/&gt;
&lt;br/&gt;
Also, couch_ft_query.erl has been renamed to couch_query.erl&lt;br/&gt;
&lt;br/&gt;
DbUpdateNotification is not affected by this patch.&lt;br/&gt;
&lt;br/&gt;
All parameters passed to &lt;a href=&quot;http://example.com/dbname/_search&quot;&gt;http://example.com/dbname/_search&lt;/a&gt; are passed along to the query server as a json document.&lt;br/&gt;
&lt;br/&gt;
Query server responses are one of:&lt;br/&gt;
&lt;br/&gt;
{ &amp;quot;status&amp;quot;: &amp;quot;error&amp;quot;, &amp;quot;message&amp;quot;: &amp;quot;Failed cause its a full moon&amp;quot; }\n\n&lt;br/&gt;
or&lt;br/&gt;
{ &amp;quot;status&amp;quot;: &amp;quot;ok&amp;quot;, &amp;quot;results&amp;quot;: [ { json obj }, { json obj }, .... ] }&lt;br/&gt;
json obj&apos;s are free form. No restrictions are made on them.&lt;br/&gt;
&lt;br/&gt;
A response of any other form generates an error.&lt;br/&gt;
&lt;br/&gt;
I move to rename the FullTextSearch engine stuffs around JIRA and the Wiki to say ExternalQueryServer.</description>
                <environment>branch/lucene-search</environment>
            <key id="12397117">COUCHDB-73</key>
        <summary>Updated the couchdb &lt;-&gt; external query server protocol to JSON</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Thu, 29 May 2008 22:51:18 +0000 (UTC)</created>
    <updated>Wed, 4 Jun 2008 23:07:40 +0000 (UTC)</updated>

                
                
                        <component>Full-Text Search</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12602496" author="paul.joseph.davis" created="Wed, 4 Jun 2008 23:07:40 +0000 (UTC)"  >This issue is superceded by issue 74&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/COUCHDB-74&quot;&gt;https://issues.apache.org/jira/browse/COUCHDB-74&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
            <attachment id="12383058" name="external_query_server.diff" size="9553" author="paul.joseph.davis" created="Thu, 29 May 2008 22:51:45 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 23:07:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-72] Long _design documents result in error_header_too_large error</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-72</link>

                    <description>When first accessing a large view, CouchDB returns the following error both to Futon and its couch.log&lt;br/&gt;
&lt;br/&gt;
[Thu, 29 May 2008 17:53:21 GMT] [error] [emulator] Error in process &amp;lt;0.724.0&amp;gt; with exit value: {{badmatch,{error,error_header_too_large}},[{couch_view,reset_file,4},{couch_view,start_update_loop,4}]}&lt;br/&gt;
&lt;br/&gt;
The threshold of view size to cause this error is somewhere between 1800 bytes (works) and 3500 bytes (breaks).&lt;br/&gt;
&lt;br/&gt;
Removing content from the design document to bring it below the threshold does not fix the problem, instead a new error is thrown:&lt;br/&gt;
&lt;br/&gt;
[Thu, 29 May 2008 17:46:16 GMT] [error] [emulator] Error in process &amp;lt;0.717.0&amp;gt; with exit value: {{badmatch,eof},[{couch_file,read_header,2},{couch_view,start_update_loop,4}]}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>OS X (Leopard) MacBook, plenty of RAM and disk.</environment>
            <key id="12397091">COUCHDB-72</key>
        <summary>Long _design documents result in error_header_too_large error</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Thu, 29 May 2008 17:57:35 +0000 (UTC)</created>
    <updated>Fri, 18 Jul 2008 11:34:05 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12607534" author="cmlenz" created="Tue, 24 Jun 2008 09:42:50 +0000 (UTC)"  >As far as I know this was fixed by Damien in r667236.</comment>
                    <comment id="12607535" author="cmlenz" created="Tue, 24 Jun 2008 09:43:16 +0000 (UTC)"  >Oops, wrong fix version.</comment>
                    <comment id="12614700" author="janl" created="Fri, 18 Jul 2008 11:34:03 +0000 (UTC)"  >Installing the latest Erlang version (R12B-3 at this point) solves this problem.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Jun 2008 09:42:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Jun 2008 09:42:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-71] Add screenshots of Futon to the CouchDB website</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-71</link>

                    <description></description>
                <environment></environment>
            <key id="12397081">COUCHDB-71</key>
        <summary>Add screenshots of Futon to the CouchDB website</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Thu, 29 May 2008 15:10:50 +0000 (UTC)</created>
    <updated>Tue, 9 Sep 2008 11:44:28 +0000 (UTC)</updated>

                
                
                        <component>Documentation</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12628050" author="ranok" created="Wed, 3 Sep 2008 16:52:54 +0000 (UTC)"  >I can do this if you want, as it&apos;s a pretty simple task (good for greenhorns like me). If you could reply with which operations you&apos;d like to be screen shot, or I can take a number of them and upload them for your perusal.</comment>
                    <comment id="12628282" author="janl" created="Thu, 4 Sep 2008 08:53:48 +0000 (UTC)"  >Hi Jacob,&lt;br/&gt;
&lt;br/&gt;
thanks for offering help! I think we could do with some shots of the most common tasks, browsing/creating dbs &amp;amp; docs, editing views, running  the test suite and replication, but feel free to do what you feel like looks good :-)&lt;br/&gt;
&lt;br/&gt;
Cheers&lt;br/&gt;
Jan&lt;br/&gt;
--</comment>
                    <comment id="12628391" author="ranok" created="Thu, 4 Sep 2008 17:22:59 +0000 (UTC)"  >5 screen shots of various futon tools and pages.</comment>
                    <comment id="12629441" author="janl" created="Tue, 9 Sep 2008 10:32:58 +0000 (UTC)"  >Jacob, the shots looks quite decent, thanks! Now who&apos;s going to put them on the site? :-)</comment>
                    <comment id="12629442" author="cmlenz" created="Tue, 9 Sep 2008 10:39:28 +0000 (UTC)"  >Actually I&apos;d prefer screenshots where the top bar looks right. There&apos;s some issue with the fonts/sizes on Firefox on Linux/Gnome/whatever that &amp;quot;breaks&amp;quot; it, although it works nicely on all other browsers and platforms I tested.</comment>
                    <comment id="12629452" author="ranok" created="Tue, 9 Sep 2008 11:39:02 +0000 (UTC)"  >Christopher,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;I&apos;ll redo the screen shots in Opera as I only have Linux + GNOME.&lt;br/&gt;
&lt;br/&gt;
Jan,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;If I was given access and showed how I could take care of putting them up and any other site work.</comment>
                    <comment id="12629456" author="nslater" created="Tue, 9 Sep 2008 11:42:39 +0000 (UTC)"  >I like the way that OS X takes screenshots, with the minimal window decoration and lovely drop shadow.&lt;br/&gt;
&lt;br/&gt;
If we&apos;re not going to use OS X for this though, I would prefer that we at least used a free software browser.</comment>
                    <comment id="12629458" author="janl" created="Tue, 9 Sep 2008 11:44:28 +0000 (UTC)"  >Jacob: We can&apos;t give you write access directly, but you can check out the site&apos;s source at &lt;a href=&quot;http://svn.apache.org/repos/asf/incubator/couchdb/site/&quot;&gt;http://svn.apache.org/repos/asf/incubator/couchdb/site/&lt;/a&gt; and send in patches.&lt;br/&gt;
&lt;br/&gt;
Cheers,&lt;br/&gt;
Jan&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12389516" name="futonscreenshots.tar.gz" size="381353" author="ranok" created="Thu, 4 Sep 2008 17:22:59 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 3 Sep 2008 16:52:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-70] See if the plists package improves CouchDB&apos;s performance</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-70</link>

                    <description>The plists module claims to be a drop-in replacement for OTP&apos;s standard lists module. It&apos;s implementation allows list operations to run in parallel claiming speed-ups on multi-core, multi-CPU and multi-node-VM setups. We could check if CouchDB would benefit from that. plists lives at &lt;a href=&quot;http://code.google.com/p/plists/&quot;&gt;http://code.google.com/p/plists/&lt;/a&gt; and is released under the MIT license.&lt;br/&gt;
</description>
                <environment>All</environment>
            <key id="12396908">COUCHDB-70</key>
        <summary>See if the plists package improves CouchDB&apos;s performance</summary>

            <type id="3" iconUrl="http://issues.apache.org/jira/images/icons/task.gif">Task</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 16:50:56 +0000 (UTC)</created>
    <updated>Tue, 27 May 2008 16:50:56 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-69] Allow selective retaining of older revisions to a document</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-69</link>

                    <description>At the moment, compaction gets rid of all old revisions of a document. Also, replication also deals with the latest revision. It would be nice if it would be possible to specify a list of revisions to keep around that do not get compacted away and replicated.</description>
                <environment>All</environment>
            <key id="12396901">COUCHDB-69</key>
        <summary>Allow selective retaining of older revisions to a document</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 16:03:03 +0000 (UTC)</created>
    <updated>Sun, 23 Aug 2009 10:42:37 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12600174" author="paul.joseph.davis" created="Tue, 27 May 2008 16:18:42 +0000 (UTC)"  >An extension of this that might prove useful would be to have the ability to disable compaction completely for a given database. Using revisions for versioning could prove useful, but the fear that compaction is triggered accidentally might prevent its widespread use.</comment>
                    <comment id="12600181" author="janl" created="Tue, 27 May 2008 16:27:56 +0000 (UTC)"  >Heya Paul,&lt;br/&gt;
this might tie in with &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-66&quot;&gt;http://issues.apache.org/jira/browse/COUCHDB-66&lt;/a&gt;</comment>
                    <comment id="12600431" author="nslater" created="Wed, 28 May 2008 10:53:57 +0000 (UTC)"  >As a note to anyone viewing this issue, please read:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/couchdb/DocumentRevisions&quot;&gt;http://wiki.apache.org/couchdb/DocumentRevisions&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
At the moment, document revisions are internal-use-only and are not designed for applications to make direct use of. To implement a fix for this issue the revision system would need to be redesigned to provide revisions intended for client use and manipulation.</comment>
                    <comment id="12673754" author="snej" created="Sun, 15 Feb 2009 21:59:43 +0000 (UTC)"  >Maybe this goes without saying, but this would be excellent for implementing wikis or other version-control systems.&lt;br/&gt;
It would also help in designing distributed systems where there is less mutual trust between instances -- pulling a new version of a document from a peer is less dangerous if the existing version persists and can be rolled back to.</comment>
                    <comment id="12725032" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:30:47 +0000 (UTC)"  >We&apos;ve beat it into peoples heads to not rely on the internal _revisions for user access except for in the hopefully rare &amp;quot;Oops undo&amp;quot; situation. If someone has a convincing argument to implement this feel free to reopen.</comment>
                    <comment id="12742819" author="jasondd" created="Thu, 13 Aug 2009 13:02:19 +0000 (UTC)"  >First stab at allowing old revisions to survive compaction *and* be replicated.  Note that this required a change to the by_seq B-tree.&lt;br/&gt;
&lt;br/&gt;
I&apos;m still working on making this configurable: currently you need to set the HISTORY_ENABLED macro to true in couch_db.hrl for this to be turned on.</comment>
                    <comment id="12742843" author="jasondd" created="Thu, 13 Aug 2009 14:47:51 +0000 (UTC)"  >Updated patch allowing per-db configuration.</comment>
                    <comment id="12743669" author="jasondd" created="Sat, 15 Aug 2009 10:19:53 +0000 (UTC)"  >Latest patch with support for deleting old revs.  My solution is that when history is turned on, the compactor will only delete old revs if they have doubled-up delete nodes, which won&apos;t occur normally.  Doubled-up delete nodes can be created by deleting old revs and specifing ?forget=true as a query parameter. These double-up nodes should also get replicated.  Would appreciate a review by someone.</comment>
                    <comment id="12743670" author="jasondd" created="Sat, 15 Aug 2009 10:32:40 +0000 (UTC)"  >Patch against latest trunk.</comment>
                    <comment id="12743671" author="jasondd" created="Sat, 15 Aug 2009 10:33:58 +0000 (UTC)"  >Patch against latest trunk.</comment>
                    <comment id="12743682" author="kocolosk" created="Sat, 15 Aug 2009 11:49:51 +0000 (UTC)"  >Is the forget=true part necessary?  What would happen if I just&lt;br/&gt;
&lt;br/&gt;
DELETE /db/doc?rev=old-revision&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12743723" author="jchris" created="Sat, 15 Aug 2009 15:17:38 +0000 (UTC)"  >The patch looks good pretty solid.&lt;br/&gt;
&lt;br/&gt;
forget=true is necessary b/c otherwise DELETE would not be idempotent. Deleting once to set _deleted=true and again to remove from history would wreck havoc in the face of unreliable intermediaries.&lt;br/&gt;
&lt;br/&gt;
My one question is why match on double-deleted leaves and not the Rev&apos;s history=true/false value? Maybe I&apos;m missing something but it seems like you could avoid doing two couch_db:update_doc calls to forget history, if you just looked at the history value during compaction.</comment>
                    <comment id="12743729" author="kocolosk" created="Sat, 15 Aug 2009 15:44:53 +0000 (UTC)"  >I haven&apos;t been paying close enough attention, but I missed the part where _deleted=true revisions were kept in the history.  I assume that&apos;s so the deletion replicates to any other servers that are also storing history?</comment>
                    <comment id="12743868" author="paul.joseph.davis" created="Sun, 16 Aug 2009 18:29:24 +0000 (UTC)"  >After taking a closer look at this, I&apos;m with Chris and Adam that the double deleted leaf thing is kind of weird. I didn&apos;t sink far enough in to think of anything better, but it does seem kind of odd.&lt;br/&gt;
&lt;br/&gt;
Two notes about testing. I&apos;d like to see alot more thorough tests for this. Its kind of big, so making sure we understand how things are changing would be good. Plus it&apos;d help to have better tests for the rev tree behavior for people learning about revisions. I&apos;d vote for dropping 95% of what&apos;s in history.js to focus on testing the behavior of revisions. I&apos;d also vote for renaming it to rev_tree.js or similar and including basic revision tree info.&lt;br/&gt;
&lt;br/&gt;
Also, could you add an etap test 066-kt-get-nodes.t or similar or add to one of the existing tests for your new code in couch_key_tree.erl?</comment>
                    <comment id="12745008" author="jasondd" created="Wed, 19 Aug 2009 11:41:09 +0000 (UTC)"  >Latest version of patch.  Fixes bugs with replication.</comment>
                    <comment id="12746186" author="damienkatz" created="Fri, 21 Aug 2009 20:02:07 +0000 (UTC)"  >Some comments about the patch:&lt;br/&gt;
It is now storing the information for every edit in the by_seq index. When there are a lot of edits, this slows things downs a lot during view building as it now has to read the meta data for every old rev off disk (could be 1000s), though it&apos;s only concerned with the latest rev and it&apos;s conflicts.&lt;br/&gt;
&lt;br/&gt;
With history on, we don&apos;t delete old entries from the by_seq index. Why when the old info is now in the new node?:&lt;br/&gt;
+        RemoveSeqs = if HistoryEnabled -&amp;gt; []; true -&amp;gt; RemoveSeqs0 end,&lt;br/&gt;
&lt;br/&gt;
During compaction, it will copy the same unchanged binary over and over for each rev. So document with an attachment that is editted 50 times, but the attachment is not, it will make 50 copies of the attachment.</comment>
                    <comment id="12746585" author="jasondd" created="Sun, 23 Aug 2009 10:42:37 +0000 (UTC)"  >Thanks for the excellent feedback Damien.&lt;br/&gt;
&lt;br/&gt;
Firstly, I thought that adding the old revinfos to the by_seq index would be a relatively cheap operation, as we are simply taking them from #doc_info{revs=Revs}, and this is already done for conflicts and deleted revs.  So I don&apos;t understand why my patch involves *reading* meta data for every old rev from the disk when updating the by_seq index i.e. in this line:&lt;br/&gt;
&lt;br/&gt;
HistoryRevInfos = if HistoryEnabled -&amp;gt; [{Rev, Seq, Bp} ||&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#rev_info{rev=Rev,seq=Seq,historical=true,body_sp=Bp} &amp;lt;- Revs];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;true -&amp;gt; [] end,&lt;br/&gt;
&lt;br/&gt;
But yes, it does mean that we are *storing* potentially 1000s of revs in this index now, so I&apos;m sure that would impact performance when updating the index.  With your second point in mind, I&apos;m wondering whether it would be more efficient to never delete old entries from the by_seq index (unless we purge), thus saving us having to store all the old revs each time.&lt;br/&gt;
&lt;br/&gt;
In response to your last point about multiple copies of attachments, this could be solved if we kept an index of attachments by MD5 hash.  I believe rnewson is keen to get something like this in, so that if you upload the same attachment to multiple docs, it only needs to store it once.</comment>
                </comments>
    
    <attachments>
            <attachment id="12416443" name="history_revs.2.patch" size="25499" author="jasondd" created="Thu, 13 Aug 2009 14:47:51 +0000 (UTC)" />
            <attachment id="12416655" name="history_revs.3.patch" size="28112" author="jasondd" created="Sat, 15 Aug 2009 10:19:52 +0000 (UTC)" />
            <attachment id="12416657" name="history_revs.4.patch" size="28170" author="jasondd" created="Sat, 15 Aug 2009 10:33:58 +0000 (UTC)" />
            <attachment id="12417011" name="history_revs.5.patch" size="27998" author="jasondd" created="Wed, 19 Aug 2009 11:41:09 +0000 (UTC)" />
            <attachment id="12416435" name="history_revs.patch" size="14764" author="jasondd" created="Thu, 13 Aug 2009 13:02:19 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:30:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 27 May 2008 16:18:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-68] Add bi-directional replication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-68</link>

                    <description>Add a API call that triggers two unidirectional replications from A to B and B to A. No guarantees about atomicity are made. This is pure syntactic sugar.</description>
                <environment>All</environment>
            <key id="12396900">COUCHDB-68</key>
        <summary>Add bi-directional replication</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:59:03 +0000 (UTC)</created>
    <updated>Tue, 27 May 2008 15:59:03 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                        </customfields>
    
</item>

<item>
<title>[COUCHDB-67] Allow unicode chars in database names and _design documents (was: Allow periods (&quot;.&quot;) in database names)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-67</link>

                    <description>Allow periods in database names. We need to find out if a period is among the &amp;quot;safe&amp;quot; characters that can be used for filenames on most filesystems.</description>
                <environment>All</environment>
            <key id="12396899">COUCHDB-67</key>
        <summary>Allow unicode chars in database names and _design documents (was: Allow periods (&quot;.&quot;) in database names)</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:57:25 +0000 (UTC)</created>
    <updated>Mon, 1 Feb 2010 21:17:42 +0000 (UTC)</updated>

                
                        <fixVersion>0.12</fixVersion>
            
                        <component>Database Core</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12619281" author="tswicegood" created="Sat, 2 Aug 2008 21:07:39 +0000 (UTC)"  >So long as you don&apos;t allow it to start with a period, you should be fine on the big three (*nix, BSD, and Windows).  See the docs for git-check-ref-format - it&apos;s explicitly bound to what a filesystem will allow.</comment>
                    <comment id="12619324" author="janl" created="Sun, 3 Aug 2008 13:09:02 +0000 (UTC)"  >Heya Travis, that&apos;s great news. The restriction to safe names comes from Damien (I just relayed the info) and he&apos;s used to writing code for all sorts of obscure platforms. the question here is if we are okay with &amp;quot;just&amp;quot; the major three or do we want more and does the mean that we need to be more careful and put some more research into obsucre FS issues? :)&lt;br/&gt;
&lt;br/&gt;
I&apos;d say that they are okay, but I am far from a platform expert.&lt;br/&gt;
&lt;br/&gt;
More input appreciated.</comment>
                    <comment id="12619340" author="nslater" created="Sun, 3 Aug 2008 16:04:21 +0000 (UTC)"  >How doable is it that databases are saved to the filesystem using a hash?&lt;br/&gt;
&lt;br/&gt;
This way we could allow any arbitary database names.&lt;br/&gt;
&lt;br/&gt;
Might even be a nice one for me to work on while practicing Erlang. ;)</comment>
                    <comment id="12619368" author="jchris" created="Sun, 3 Aug 2008 19:15:02 +0000 (UTC)"  >Being able to identify particular databases (and views indexes) in the filesystem is very handy when I&apos;m doing backups, watching view-generation progress, or moving data across machines - the hash approach wouldn&apos;t make this impossible, but it would add an extra non-obvious step.&lt;br/&gt;
&lt;br/&gt;
Unless there&apos;s a compelling case for allowing wide choice of database and view names, I&apos;d prefer to have a transparent mapping between the filesystem and CouchDB&apos;s interface.</comment>
                    <comment id="12619369" author="janl" created="Sun, 3 Aug 2008 19:20:55 +0000 (UTC)"  >I agree with Chris</comment>
                    <comment id="12619371" author="nslater" created="Sun, 3 Aug 2008 19:28:28 +0000 (UTC)"  >Good point, I had not thought about that.&lt;br/&gt;
&lt;br/&gt;
How about we don&apos;t put any restrictions, try to create whatever file results from the creation of the database and if the OS returns an error, bubble that up to the HTTP level?</comment>
                    <comment id="12619372" author="janl" created="Sun, 3 Aug 2008 19:33:50 +0000 (UTC)"  >Not a good idea when replicating between hosts that don&apos;t support one form or another. I think a common baseline is the way to go.</comment>
                    <comment id="12619385" author="nslater" created="Sun, 3 Aug 2008 22:28:49 +0000 (UTC)"  >Good point.</comment>
                    <comment id="12666734" author="janl" created="Fri, 23 Jan 2009 22:00:26 +0000 (UTC)"  >Flag for 0.9. I believe Antony&apos;s work on unicode-support for database names will solve this.</comment>
                    <comment id="12666737" author="antonyblakey" created="Fri, 23 Jan 2009 22:08:53 +0000 (UTC)"  >Yes, and I anticipate solving issue 85 with this.</comment>
                    <comment id="12666871" author="janl" created="Sat, 24 Jan 2009 10:29:04 +0000 (UTC)"  >Changed title by Antony&apos;s request.</comment>
                    <comment id="12675747" author="jchris" created="Mon, 23 Feb 2009 03:13:02 +0000 (UTC)"  >The work that Antony did so far is available (more or less) at &lt;a href=&quot;http://github.com/AntonyBlakey/couchdb.notsogood/commit/8e60f9f990e1c987088fc7bff37c60641fb10d01&quot;&gt;http://github.com/AntonyBlakey/couchdb.notsogood/commit/8e60f9f990e1c987088fc7bff37c60641fb10d01&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
It&apos;s against an old version of CouchDB, and is missing a few features, but the main module should be relatively the right thing.</comment>
                    <comment id="12682642" author="janl" created="Tue, 17 Mar 2009 11:37:01 +0000 (UTC)"  >Move blocking form 0.9 to 0.10.</comment>
                    <comment id="12725028" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:15:20 +0000 (UTC)"  >If/when this ticket goes anywhere, be sure and address the concerns from &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-44&quot; title=&quot;CouchDB should use a VERSION file in the database directory&quot;&gt;&lt;strike&gt;COUCHDB-44&lt;/strike&gt;&lt;/a&gt; for a VERSION files.&lt;br/&gt;
&lt;br/&gt;
Also, wrapping the Windows support that Mark Hammond and nrstott (sorry I don&apos;t remember the real name there) might benefit from the compaction incompatibilities if we go to a directory-per-database model. As in, write a file that is &amp;quot;Active db file&amp;quot; and then we can write new files and atomically crush the active pointer and then delete old versions. Or something like that.</comment>
                    <comment id="12725463" author="nslater" created="Tue, 30 Jun 2009 04:02:46 +0000 (UTC)"  >Ignore previous comment from Paul, &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-44&quot; title=&quot;CouchDB should use a VERSION file in the database directory&quot;&gt;&lt;strike&gt;COUCHDB-44&lt;/strike&gt;&lt;/a&gt; is invalid. Thanks.</comment>
                    <comment id="12726281" author="mhammond" created="Thu, 2 Jul 2009 00:23:22 +0000 (UTC)"  >I notice the github link to this patch is now invalid - does anyone have a link to a repo with these patches, or a guess about when it might have been posted to the mailing lists, or...?</comment>
                    <comment id="12742140" author="janl" created="Wed, 12 Aug 2009 00:32:55 +0000 (UTC)"  >bump to 0.11</comment>
                    <comment id="12828273" author="janl" created="Mon, 1 Feb 2010 21:17:42 +0000 (UTC)"  >bump version, un-block.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                            <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12398883">COUCHDB-85</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12408040">COUCHDB-155</issuekey>
        </issuelink>
                    </outwardlinks>
                                </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 2 Aug 2008 21:07:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-66] Add read-only mode</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-66</link>

                    <description>Allow CouchDB to run in read-only mode so that multiple instances can run on a singe database file where only one instance has write access to the database.</description>
                <environment>All</environment>
            <key id="12396898">COUCHDB-66</key>
        <summary>Add read-only mode</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:56:04 +0000 (UTC)</created>
    <updated>Mon, 29 Jun 2009 04:32:21 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
                    <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12725033" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:32:21 +0000 (UTC)"  >Marking as won&apos;t fix. It&apos;s been more than a year and no one has added anything. I reckon that if people are wanting read-only slaves they should setup replication.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:32:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:32:21 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-65] Add file-descriptor caching</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-65</link>

                    <description>Add caching to file-descriptors for database- and index files to speed up performance with lots of databases.</description>
                <environment>All</environment>
            <key id="12396896">COUCHDB-65</key>
        <summary>Add file-descriptor caching</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:54:27 +0000 (UTC)</created>
    <updated>Tue, 9 Sep 2008 10:30:32 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12629440" author="janl" created="Tue, 9 Sep 2008 10:30:32 +0000 (UTC)"  >Implemented as of r682560</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Sep 2008 10:30:32 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-64] Enable selective replication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-64</link>

                    <description>Make it possible to filter the set of documents that is to be replicated. Also allow replication to omit attachment-data.</description>
                <environment>All</environment>
            <key id="12396895">COUCHDB-64</key>
        <summary>Enable selective replication</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:53:06 +0000 (UTC)</created>
    <updated>Sat, 9 Jan 2010 17:46:32 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>Replication</component>
            
            <due></due>
    
            <votes>2</votes>
    
                                        

            <comments>
                    <comment id="12688327" author="jchris" created="Mon, 23 Mar 2009 17:01:52 +0000 (UTC)"  >This may be related to the Comet-style replication / all_docs, so it will require more discussion, but I&apos;d like to target it for 0.10</comment>
                    <comment id="12798013" author="v.mitache" created="Fri, 8 Jan 2010 13:49:16 +0000 (UTC)"  >&amp;nbsp;Filtered replication, using already in place _changes filter.&lt;br/&gt;
&amp;nbsp;Added two extra options for _replicate handler&lt;br/&gt;
&amp;nbsp;{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;source:..&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;target:..&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;filter&amp;quot;: &amp;quot;designDoc/filterFn&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;filter_params&amp;quot; : &amp;quot;p1=v1&amp;amp;p2=v2..&amp;quot; // optional query params - will be passed to _changes handler&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
design doc example&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_id&amp;quot;: &amp;quot;_design/d1&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;_rev&amp;quot;: &amp;quot;19-d2e5f7715acdbe68938925fe2a22d192&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;language&amp;quot;: &amp;quot;javascript&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;filters&amp;quot;: {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;none&amp;quot;: &amp;quot;function(doc, req) { return false; }&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;design_docs&amp;quot;: &amp;quot;function(doc, req) { return doc._id.match(&apos;_design/(.*)&apos;)}&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;by_location&amp;quot;: &amp;quot;function(doc, req) { var location_tags = req.query.location_tags; \n if(!location_tags) {return false;} \n if(!doc.location_tags) {return true;} \n location_tags = location_tags.split(&apos;,&apos;); \n for(var x=0; x &amp;lt; location_tags.length;x++) { \n for(var y = 0;y &amp;lt; doc.location_tags.length;y++) { \n if(location_tags[x] == doc.location_tags[y]) {return true;} \n } \n } \n return false;}&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
test command line(s) :&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;curl -X POST -d &amp;quot;{\&amp;quot;source\&amp;quot;:&amp;lt;src_db&amp;gt;,\&amp;quot;target\&amp;quot;:&amp;lt;target_db&amp;gt;.\&amp;quot;filter\&amp;quot;:\&amp;quot;d1/design_docs\&amp;quot;}&amp;quot; &lt;a href=&quot;http://host:port/dbname/_replicate&quot;&gt;http://host:port/dbname/_replicate&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
OR&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;curl -X POST -d &amp;quot;{\&amp;quot;source\&amp;quot;:&amp;lt;src_db&amp;gt;,\&amp;quot;target\&amp;quot;:&amp;lt;target_db&amp;gt;.\&amp;quot;filter\&amp;quot;:\&amp;quot;d1/by_location\&amp;quot;,\&amp;quot;filter_params\&amp;quot;:\&amp;quot;location_tag=loc1\&amp;quot;}&amp;quot; &lt;a href=&quot;http://host:port/dbname/_replicate&quot;&gt;http://host:port/dbname/_replicate&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12798042" author="kocolosk" created="Fri, 8 Jan 2010 15:32:48 +0000 (UTC)"  >Thanks for the patch.  Using _changes is certainly the way to accomplish this.  I have a couple of comments:&lt;br/&gt;
&lt;br/&gt;
1) The patch only addresses filtered replication from a remote source.  Ultimately we want it to work for local sources too.  Note that couch_rep_changes_feed:init/1 has two clauses, one for remote sources and one for local sources.&lt;br/&gt;
&lt;br/&gt;
2) Can you write tests?  Either JS or etap is fine.&lt;br/&gt;
&lt;br/&gt;
3) The patch doesn&apos;t follow our coding conventions, specifically 4-space indents and a soft limit of 80 characters per line.&lt;br/&gt;
&lt;br/&gt;
Best, Adam</comment>
                    <comment id="12798069" author="v.mitache" created="Fri, 8 Jan 2010 16:59:11 +0000 (UTC)"  >1) Sorry , I&apos;m not very familiar to couchdb sources, yet .. I&apos;m new to&lt;br/&gt;
erlang, and I&apos;m new to couchdb sources too (a couple of days of&lt;br/&gt;
digging on both :D )  .. I&apos;ll check the API and I think I&apos;ll fix that.&lt;br/&gt;
2) I&apos;ll write some test code&lt;br/&gt;
3) I&apos;ll follow the rules :) .. again, first I tried to get it working&lt;br/&gt;
the way I felt I need it, and I was curious if this was the proper way&lt;br/&gt;
of doing it.. Next iteration I&apos;ll take care of all the issues&lt;br/&gt;
Thanks,&lt;br/&gt;
Viorel&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12798367" author="v.mitache" created="Sat, 9 Jan 2010 15:17:58 +0000 (UTC)"  >&amp;nbsp;Iteration 2 of the replication filter patch. </comment>
                    <comment id="12798381" author="jchris" created="Sat, 9 Jan 2010 17:46:32 +0000 (UTC)"  >A similar feature worth bringing up in this context:&lt;br/&gt;
&lt;br/&gt;
I&apos;d like the ability to replicate a selection of documents by id. This is better than a filter for eg: pulling just the design documents from a large database.&lt;br/&gt;
&lt;br/&gt;
This would probably involve POSTing the list of docids to the replicator.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="12310000">
            <name>Duplicate</name>
                                        <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12439693">COUCHDB-556</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
            <attachment id="12429823" name="replicate_filter.patch" size="12339" author="v.mitache" created="Sat, 9 Jan 2010 15:17:58 +0000 (UTC)" />
            <attachment id="12429751" name="replication_filter.patch" size="4320" author="v.mitache" created="Fri, 8 Jan 2010 13:49:16 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 17:01:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-63] Do not require attachments to be encoded in base64</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-63</link>

                    <description>At the moment an attachment&apos;s data must be encoded in base64. With larger attachments this leads to significant overhead on the client. It would be nice if the encoding would not be required and data could be stored as-is.</description>
                <environment>All</environment>
            <key id="12396894">COUCHDB-63</key>
        <summary>Do not require attachments to be encoded in base64</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:51:13 +0000 (UTC)</created>
    <updated>Mon, 14 Jul 2008 20:22:36 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12613443" author="janl" created="Mon, 14 Jul 2008 20:22:36 +0000 (UTC)"  >As of revision 675699, CouchDB has a RESTful API for attachments that doesn&apos;t require base64 encoding of data.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Jul 2008 20:22:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-62] Do not duplicate attachments with multiple revisions of a document</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-62</link>

                    <description>Currently attachments are stored for every revision of a document even if the attachment doesn&apos;t change. This could be avoided. </description>
                <environment>All</environment>
            <key id="12396893">COUCHDB-62</key>
        <summary>Do not duplicate attachments with multiple revisions of a document</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:48:22 +0000 (UTC)</created>
    <updated>Mon, 23 Mar 2009 17:00:39 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12688325" author="jchris" created="Mon, 23 Mar 2009 17:00:39 +0000 (UTC)"  >This has been fixed a while now. Currently, though if you make the same binary attachment to many different docs, multiple copies of it are stored on disk.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 17:00:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 17:00:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-61] Separate storage of attachments from the main database file</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-61</link>

                    <description>At the moment all document- and attachment-data go into the same database file. It would be nice if the attachments could be saved in a different file. This would enable the use of slower and cheaper hardware for attachment storage and faster hardware for the document and index data storage.</description>
                <environment>All</environment>
            <key id="12396892">COUCHDB-61</key>
        <summary>Separate storage of attachments from the main database file</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="7">Later</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:46:32 +0000 (UTC)</created>
    <updated>Mon, 29 Jun 2009 04:23:19 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12659369" author="mdornseif" created="Sat, 27 Dec 2008 19:32:13 +0000 (UTC)"  >This is not only the issue of hardware costs but also of absolute performance. Access patterns for Documents and attachments are very different to my understanding:&lt;br/&gt;
&lt;br/&gt;
The documents need random access (for &lt;a href=&quot;http://localhost:5984/test/some_doc_id)&quot;&gt;http://localhost:5984/test/some_doc_id)&lt;/a&gt; and &amp;quot;traversal&amp;quot; access for view generation. Huge binary attachments in the document file make this operations more expensive and render os level caching less effective.&lt;br/&gt;
&lt;br/&gt;
So at least for the use case big attatchments and few changes to the attatchments but small(ish) documents many changes to the documents having documents out of the main database file would be very helpful.&lt;br/&gt;
&amp;nbsp;</comment>
                    <comment id="12659374" author="janl" created="Sat, 27 Dec 2008 20:00:17 +0000 (UTC)"  >Hi Max,&lt;br/&gt;
&lt;br/&gt;
thanks for your comment.&lt;br/&gt;
&lt;br/&gt;
Attachments are stored in the same file as the documents, but they are already stored apart from documents. Huge Attachments do not affect view building or general document access.</comment>
                    <comment id="12659425" author="mdornseif" created="Sun, 28 Dec 2008 10:20:51 +0000 (UTC)"  >To my understanding of OS access pattern they actually do interfere with document  access and view building.&lt;br/&gt;
&lt;br/&gt;
Lets say you have 100 MB of documents and 100 GB of attatchments. To my (very limited) understanding in the current database file &amp;quot;normal&amp;quot; b+-tree pages and attatchments  would be interleaved. So on disk (assuming best-case continues allocation) it would look something like&lt;br/&gt;
&lt;br/&gt;
DAAADADDAAAAAAAADADDAAAAAAADAAAADAAAAADAAAAADAAAAADADAAAAAADA&lt;br/&gt;
&lt;br/&gt;
(D=doc, A=attatchment)&lt;br/&gt;
&lt;br/&gt;
So if I want to access the whole B+-Tree (all &amp;quot;Ds&amp;quot;) for an operation I have to skip around in the file by using seeks or some other techniques. Seeks harm the caching ability of the OS and are generally slow. And the OS obviously is not able to read the whole 100.1 GB file in  a single chunk into it&apos;s cache.&lt;br/&gt;
&lt;br/&gt;
Compare that to having two files:&lt;br/&gt;
&lt;br/&gt;
DDDDDDDDDDDDDD = document file, 100 MB&lt;br/&gt;
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA = attachment file, 100 GB&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
Now the OS caching subsystem can happily read the whole document file into RAM. Even if CouchDB uses seeks they can be served from the cache.  The OS doesn&apos;t have to work around the huge binary chunks of seldom accessed attachment data.&lt;br/&gt;
&lt;br/&gt;
Generally to get most out of the I/O optimizations of an Operating System don&apos;t save data with different  access patterns in the same file. The exact impact differs very much from OS to OS but this is one of the main reasons why databases (even MySQL) use different files for different parts of the database - unless they manage diskspace independently of the OS with raw partitions.&lt;br/&gt;
&lt;br/&gt;
All this assumes that you access and change attachments less often than your documents and documents are considerable smaller than attachments. I would call this a save bet for most CouchDB use cases.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12659455" author="janl" created="Sun, 28 Dec 2008 19:03:20 +0000 (UTC)"  >Damien via dev@&lt;br/&gt;
&lt;br/&gt;
&amp;quot;What you are proposing is grouping the document data together for better OS caching performance, but CouchDB already does that. Documents bodies are written to contiguous regions, one after another, the attachments are stored in separate locations in the file.&lt;br/&gt;
&lt;br/&gt;
-Damien&lt;br/&gt;
&amp;quot;&lt;br/&gt;
&lt;br/&gt;
&#8212; this is what I meant with my previous comment :)</comment>
                    <comment id="12672908" author="mdornseif" created="Thu, 12 Feb 2009 08:07:01 +0000 (UTC)"  >31.2 GB	database with 34175 documents. Typical Document size is 300 bytes the rest is attachments.&lt;br/&gt;
So we can assume about 15 MB for Documents and about 30 GB for attachments.&lt;br/&gt;
&lt;br/&gt;
While accessing documents by key is decently fast view generation is extremely slow.</comment>
                    <comment id="12725031" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:23:19 +0000 (UTC)"  >Marking as do it later. Unless someone steps up with convincing numbers and a patch I don&apos;t see why we should keep this around. I&apos;m not convinced that the slow view generation is a result of interspersed attachment storage.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:23:19 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 27 Dec 2008 19:32:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-60] Make maximum document size a configuration option</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-60</link>

                    <description>At the moment the maximum document size is hardcoded to 4GB. It would be nice if this limit could be configured. I will add this to the runtimeconfig branch.</description>
                <environment>All</environment>
            <key id="12396891">COUCHDB-60</key>
        <summary>Make maximum document size a configuration option</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="janl">Jan Lehnardt</reporter>
            
    <created>Tue, 27 May 2008 15:42:07 +0000 (UTC)</created>
    <updated>Fri, 30 Jan 2009 03:06:48 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12602317" author="cmlenz" created="Wed, 4 Jun 2008 15:16:13 +0000 (UTC)"  >I think a better solution would be to remove the limit on HTTP request bodies in general.</comment>
                    <comment id="12628388" author="jchris" created="Thu, 4 Sep 2008 17:12:27 +0000 (UTC)"  >the new default.ini files contain this paramater, but AFAIK couch_httpd still uses the the hardcoded macro MAX_DOC_SIZE</comment>
                    <comment id="12666743" author="janl" created="Fri, 23 Jan 2009 22:20:33 +0000 (UTC)"  >This is non-breaking API improvement, but it&apos;d be nice if we can get this out for 0.9.</comment>
                    <comment id="12668722" author="jchris" created="Fri, 30 Jan 2009 03:06:48 +0000 (UTC)"  >fixed in 739153</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Jan 2009 03:06:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 15:16:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-59] Log messages from view functions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-59</link>

                    <description>Allow calls to log(message) to be shown in the couch.log.</description>
                <environment></environment>
            <key id="12396784">COUCHDB-59</key>
        <summary>Log messages from view functions</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Sun, 25 May 2008 22:22:05 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:24:37 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599731" author="jchris" created="Sun, 25 May 2008 22:23:03 +0000 (UTC)"  >function to log to couch.log</comment>
                    <comment id="12599797" author="cmlenz" created="Mon, 26 May 2008 09:25:01 +0000 (UTC)"  >Patch applied in r660140. Thanks!</comment>
                </comments>
    
    <attachments>
            <attachment id="12382741" name="simple_js_logging.diff" size="510" author="jchris" created="Sun, 25 May 2008 22:23:03 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:25:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:25:01 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-58] CouchDB should print a friendly error if configure port not available</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-58</link>

                    <description>Now that CouchDB can run multiple instances at once the problem of the default port being taken by the first instance is likely to be more common. At the moment CouchDB fails with a messy traceback. CouchDB should print the following message and exit:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Apache CouchDB cannot open the configured port:</description>
                <environment></environment>
            <key id="12396744">COUCHDB-58</key>
        <summary>CouchDB should print a friendly error if configure port not available</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="janl">Jan Lehnardt</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Fri, 23 May 2008 22:12:15 +0000 (UTC)</created>
    <updated>Tue, 24 Jun 2008 09:45:51 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599525" author="nslater" created="Fri, 23 May 2008 22:12:38 +0000 (UTC)"  >Rather: &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Apache CouchDB cannot open the configured port: XXXX</comment>
                    <comment id="12607537" author="cmlenz" created="Tue, 24 Jun 2008 09:45:51 +0000 (UTC)"  >This is a duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-11&quot; title=&quot;CouchDB should handle errors when opening port gracefully&quot;&gt;&lt;strike&gt;COUCHDB-11&lt;/strike&gt;&lt;/a&gt;.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Jun 2008 09:45:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Jun 2008 09:45:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-57] Javascript helper functions for use in map and reduce functions</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-57</link>

                    <description>I&apos;ve been playing with Reduce, and enjoying it. I added a two functions: unique() and collect() - they are similar to sum() in that they transform arrays. Unique also has an option to provide a count of items found in the source array.&lt;br/&gt;
&lt;br/&gt;
I just wanted to share these function with everyone and suggest that a helper namespace be established in the view server to contain functions like these.</description>
                <environment></environment>
            <key id="12396372">COUCHDB-57</key>
        <summary>Javascript helper functions for use in map and reduce functions</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jchris">Chris Anderson</reporter>
            
    <created>Tue, 20 May 2008 06:39:54 +0000 (UTC)</created>
    <updated>Wed, 4 Jun 2008 17:35:23 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
            <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>        <timeestimate seconds="3600">1h</timeestimate>                    

            <comments>
                    <comment id="12598203" author="jchris" created="Tue, 20 May 2008 07:00:07 +0000 (UTC)"  >playing with Spidermonkey more and realized that my collect() is available natively as myarray.map(). The unique() function should still be useful.</comment>
                    <comment id="12602375" author="jchris" created="Wed, 4 Jun 2008 17:35:23 +0000 (UTC)"  >after becoming more familiar with the js view server, I think it&apos;s fine that unique() not be included in the package.</comment>
                </comments>
    
    <attachments>
            <attachment id="12382351" name="js_helpers.diff" size="1062" author="jchris" created="Tue, 20 May 2008 06:40:53 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 17:35:23 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-56] Allow refreshing of a list of documents or a single document in one click</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-56</link>

                    <description>Doesn&apos;t seem to be a way to refresh the view of single document or a list of documents (e.g. the database view or some custom view) with a single click - currently requires switching to some other part of the UI then back again, which gets annoying if you&apos;re updating the data elsewhere in the background.&lt;br/&gt;
&lt;br/&gt;
Perhaps the name of the database / view / document at the top in the breadcrumb trail could be an active link which allows the currently displayed data to be refreshed.</description>
                <environment></environment>
            <key id="12396263">COUCHDB-56</key>
        <summary>Allow refreshing of a list of documents or a single document in one click</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="harryf">Harry Fuecks</reporter>
            
    <created>Sat, 17 May 2008 22:04:38 +0000 (UTC)</created>
    <updated>Thu, 8 Jan 2009 10:21:02 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599721" author="cmlenz" created="Sun, 25 May 2008 21:51:03 +0000 (UTC)"  >Some browsers (correctly) allow you to just reload the page, and they will preserve the content of the iframe. I know this works in Safari and Firefox 3, I think it works in IE but I&apos;m not sure I&apos;ve actually tested it recently.</comment>
                    <comment id="12607555" author="greut" created="Tue, 24 Jun 2008 11:01:00 +0000 (UTC)"  >A patch that transform the breadcrumb into links, to allow easier refresh.&lt;br/&gt;
&lt;br/&gt;
Overview &amp;gt; dbname&lt;br/&gt;
Overview &amp;gt; dbname &amp;gt; docname&lt;br/&gt;
Overview &amp;gt; dbname &amp;gt; viewname&lt;br/&gt;
&lt;br/&gt;
No more &amp;quot;h1 strong&amp;quot; only &amp;quot;h1 a.dbname&amp;quot; and &amp;quot;.current&amp;quot; sets the last element of the breadcrumb.&lt;br/&gt;
&lt;br/&gt;
I also added some scope=&amp;quot;row&amp;quot;, scope=&amp;quot;col&amp;quot; to th&apos;s and renamed tbody.footer into tfoot.footer, I think it makes sense.</comment>
                    <comment id="12642123" author="jasondd" created="Thu, 23 Oct 2008 09:08:49 +0000 (UTC)"  >It would also be nice if a fragment identifier was updated depending on the current view, to allow bookmarking or permalinking.  This might fix refreshing for browsers that don&apos;t support iframe preservation on refresh.</comment>
                    <comment id="12661924" author="cmlenz" created="Thu, 8 Jan 2009 10:21:02 +0000 (UTC)"  >This has been addressed in r732675 by getting rid of the iframe structure, which means you can simply hit the browsers &amp;quot;reload&amp;quot; button now.</comment>
                </comments>
    
    <attachments>
            <attachment id="12384577" name="couchdb-56_20080624.patch" size="7788" author="greut" created="Tue, 24 Jun 2008 11:01:00 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 8 Jan 2009 10:21:02 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 21:51:03 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-55] Mochi thinks request is over when it&apos;s not. (delayed packets)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-55</link>

                    <description>When the request is broken up as such:&lt;br/&gt;
&lt;br/&gt;
Packet #1&lt;br/&gt;
-----------&lt;br/&gt;
PUT /db/doc HTTP/1.1&lt;br/&gt;
Transfer-Encoding:chunked&lt;br/&gt;
Content-Type:application/json&lt;br/&gt;
Host: localhost&lt;br/&gt;
&lt;br/&gt;
Packet #2&lt;br/&gt;
------------------&lt;br/&gt;
1234&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;ima&amp;quot; : &amp;quot;doc&amp;quot;&lt;br/&gt;
}&lt;br/&gt;
0&lt;br/&gt;
&lt;br/&gt;
Mochi ignores the fact that Transfer-Encoding: chunked is set, and gives a 500 error after packet #1 before it receives packet #2.</description>
                <environment>Ubuntu 8.04&lt;br/&gt;
CouchDB trunk</environment>
            <key id="12396159">COUCHDB-55</key>
        <summary>Mochi thinks request is over when it&apos;s not. (delayed packets)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="nietsnie">Jeff Davey</reporter>
            
    <created>Fri, 16 May 2008 00:53:32 +0000 (UTC)</created>
    <updated>Tue, 24 Jun 2008 19:51:25 +0000 (UTC)</updated>

                
                        <fixVersion>0.8.1</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12602341" author="cmlenz" created="Wed, 4 Jun 2008 16:42:14 +0000 (UTC)"  >You get the same behavior when not using chunked encoding in the request.CouchDB does not read the complete request body before dispatching requests to request handlers. Thus you can get the 404 response before even sending the body.&lt;br/&gt;
&lt;br/&gt;
MochiWeb should automatically close the connection in this case though, so that the unread data doesn&apos;t corrupt the next request.</comment>
                    <comment id="12602342" author="cmlenz" created="Wed, 4 Jun 2008 16:43:58 +0000 (UTC)"  >MochiWeb ticket and patch created here:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=15&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=15&lt;/a&gt;</comment>
                    <comment id="12607742" author="cmlenz" created="Tue, 24 Jun 2008 19:51:25 +0000 (UTC)"  >Should be fixed by the upgrade to MochiWeb r82 in r671125 (the patch I linked to above got integrated).</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Jun 2008 19:51:25 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 16:42:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-54] Error 500 on views when no data indexed</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-54</link>

                    <description>when theer are no data indexed by the view and you call the view it return an error 500 rather than a 404 not found :&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;EXIT&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{function_clause,[{cjson,tokenize,[undefined,{decoder,utf8,null,1,1,any}]},\\n {cjson,decode1,2},\\n {cjson,json_decode,2},\\n {couch_httpd,handle_db_request,3},\\n {couch_httpd,handle_request,2},\\n {mochiweb_http,headers,4},\\n {proc_lib,init_p,5}]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12395972">COUCHDB-54</key>
        <summary>Error 500 on views when no data indexed</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 13 May 2008 20:53:21 +0000 (UTC)</created>
    <updated>Mon, 23 Jun 2008 21:27:41 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599723" author="cmlenz" created="Sun, 25 May 2008 21:56:59 +0000 (UTC)"  >I can&apos;t reproduce this... can you please provide some more details on how to reproduce?</comment>
                    <comment id="12607382" author="cmlenz" created="Mon, 23 Jun 2008 21:27:41 +0000 (UTC)"  >Feedback on IRC suggests this is fixed.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Jun 2008 21:27:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 21:56:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-53] Incorporating JSearch to CouchDB</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-53</link>

                    <description>JSearch is a prototype that we developed for indexing and searching Json documents, and we are enthusiastic about contributing it to CouchDB. JSearch converts a given Json document to a Lucene document for indexing. The conversion is lossless and preserves all structural information in the original Json document. We achieve that by storing the encoding of Json structures in the payload of the posting list in a Lucene index. JSearch has a simple query language that combines fulltext search and structural querying. To qualify as a match, a document has to match both the JSON structures as well as the Boolean constraints specified in the query. Suppose that we have indexed the following two JSON documents:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;d1={ A: [ { B: &amp;quot;b1&amp;quot;,  C: &amp;quot;c1&amp;quot; },&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ B: &amp;quot;b2&amp;quot;,  C: &amp;quot;c2&amp;quot; },&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;d2={ A: [ { B: &amp;quot;b1&amp;quot;,  C: &amp;quot;c2&amp;quot; },&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ B: &amp;quot;b2&amp;quot;,  C: &amp;quot;c1&amp;quot; },&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
One can issue the following two JSeach queries.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;P={ A: [ { B: &amp;quot;b1&amp;quot; &amp;amp;&amp;amp; C: &amp;quot;c1&amp;quot; } ] }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Q={ A: [ { B: &amp;quot;b1&amp;quot;} &amp;amp;&amp;amp; {C: &amp;quot;c1&amp;quot; } ] }&lt;br/&gt;
Query P (&amp;quot;&amp;amp;&amp;amp;&amp;quot; specifies conjunction) matches d1, but not d2. The reason is that d2 doesn&apos;t have the proper B and C fields within the same JSON object. On the other hand, query Q matches both d1 and d2, since it doesn&apos;t require the B field and the C field to be in the same JSON object.&lt;br/&gt;
&lt;br/&gt;
Here is a summary of the querying features in JSearch&lt;br/&gt;
1. arbitrary conjunctive and disjunctive constraints&lt;br/&gt;
2. text search on atomic values of string type&lt;br/&gt;
3. range constraints on atomic values (only those of string and long types are currently supported)&lt;br/&gt;
4. document level matching&lt;br/&gt;
&lt;br/&gt;
The easiest way to know more about JSeach is to give it a try. Download the attached tgz file. Follow the readme file in it and try some of the examples. The attachment also includes all Java source code (I can provide more technical details if needed). I am very interested in your feedback. Does JSearch fit into CouchDB? What other features are needed? How should JSearch be integrated (from Jan&apos;s mail, it seems that some infrastructure is already in-place)? Thanks,&lt;br/&gt;
</description>
                <environment>JSearch is developed in Java</environment>
            <key id="12395846">COUCHDB-53</key>
        <summary>Incorporating JSearch to CouchDB</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="7">Later</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="junrao">Jun Rao</reporter>
            
    <created>Mon, 12 May 2008 16:14:53 +0000 (UTC)</created>
    <updated>Mon, 29 Jun 2009 04:18:30 +0000 (UTC)</updated>

                
                
                        <component>Full-Text Search</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12596112" author="junrao" created="Mon, 12 May 2008 16:21:10 +0000 (UTC)"  >Initial JSearch package uploaded. Untar it and follow the instructions in the readme file. The package includes all Java source code.</comment>
                    <comment id="12666723" author="janl" created="Fri, 23 Jan 2009 21:37:42 +0000 (UTC)"  >The JSearch team showed no further interest here and I don&apos;t see the CouchDB community waiting for this either: reducing to minor priority.</comment>
                    <comment id="12725030" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:18:30 +0000 (UTC)"  >Further decrementing in importance. Its been quite a long time with not stepping up. Obviously, feel free to reopen if you want to add to this.</comment>
                </comments>
    
    <attachments>
            <attachment id="12381889" name="jsearch_full.tgz" size="1290600" author="junrao" created="Mon, 12 May 2008 16:21:10 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:18:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:37:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-52] building with a --prefix that has an ending slash confuses serve_file()</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-52</link>

                    <description>configuring with:&lt;br/&gt;
&lt;br/&gt;
$ ./configure --prefix=$HOME/couchdb/&lt;br/&gt;
&lt;br/&gt;
caused the futon interface to 404 because it couldn&apos;t handle a &amp;quot;$HOME/couchdb//share/couchdb/www&amp;quot; path (I&apos;m guessing), note the double-slashes.&lt;br/&gt;
&lt;br/&gt;
Configuring with an ending slash on the --prefix works.</description>
                <environment>osx</environment>
            <key id="12395821">COUCHDB-52</key>
        <summary>building with a --prefix that has an ending slash confuses serve_file()</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="johansorensen">Johan S&#248;rensen</reporter>
            
    <created>Mon, 12 May 2008 10:53:59 +0000 (UTC)</created>
    <updated>Mon, 23 Mar 2009 18:02:05 +0000 (UTC)</updated>

                        <version>0.8</version>
            
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12596133" author="naderman" created="Mon, 12 May 2008 17:03:42 +0000 (UTC)"  >I had the same problem and fixed it by removing the trailing slash. I assume your last sentence was supposed to say &amp;quot;Configuring without an ending slash on the --prefix works.&amp;quot;?</comment>
                    <comment id="12596388" author="ranok" created="Tue, 13 May 2008 13:04:42 +0000 (UTC)"  >Perhaps add a note of this to the README or the ./configure help. I ran into this same issue when building from SVN.</comment>
                    <comment id="12599537" author="nslater" created="Fri, 23 May 2008 23:04:23 +0000 (UTC)"  >This has been fixed in the runtimeconfig branch which should be merged before 0.8.&lt;br/&gt;
&lt;br/&gt;
Thank you for your bug report.</comment>
                    <comment id="12603017" author="cmlenz" created="Fri, 6 Jun 2008 12:26:18 +0000 (UTC)"  >I think we shouldn&apos;t resolve issues fixed on branches before they are merged back. Also, why wasn&apos;t this fixed on trunk, I can&apos;t see any way it depends on runtimeconfig?</comment>
                    <comment id="12603310" author="nslater" created="Sat, 7 Jun 2008 16:27:17 +0000 (UTC)"  >Agreed. This has been fixed in r664363 on trunk.</comment>
                    <comment id="12605381" author="nslater" created="Mon, 16 Jun 2008 19:05:05 +0000 (UTC)"  >The fix for this was implemented in the wrong place (at build time) and was causing too many problems so it has been backed out.&lt;br/&gt;
&lt;br/&gt;
The correct place to fix this issue is in the database core, by calculating the abspath of any local filenames used in the configuration.</comment>
                    <comment id="12688355" author="janl" created="Mon, 23 Mar 2009 18:02:05 +0000 (UTC)"  >I can&apos;t reproduce this issue on current trunk (r757473). Can you reopen if you still see this issue and include a information about your system configuration and detailed steps to reproduce?</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 23 Mar 2009 18:02:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 12 May 2008 17:03:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-51] Minor improvement to README regarding boostrap dependencies</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-51</link>

                    <description>Ola,&lt;br/&gt;
&lt;br/&gt;
just pulled down source via SVN, read the README, and bumped into this in:&lt;br/&gt;
&lt;br/&gt;
It says&lt;br/&gt;
&lt;br/&gt;
&amp;quot;&amp;quot;&amp;quot;&lt;br/&gt;
If you are running a Debian GNU/Linux system (or a derivative such as Ubuntu&lt;br/&gt;
GNU/Linux) you can install these dependencies using the `apt-get` command:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;apt-get install automake autoconf libtool subversion-tools help2man&lt;br/&gt;
&amp;quot;&amp;quot;&amp;quot;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Should add &amp;quot;xsltproc&amp;quot; to the list.  That makes ./bootstrap work (at least on my variant of linux)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Since I&apos;m here, I&apos;ll just mention this... The next set of dependencies, you give the hint to do apt-cache search libicu.  The results of that for Ubuntu 8.0.4, that line would be:&lt;br/&gt;
&lt;br/&gt;
apt-get install build-essential erlang libicu38 libicu-dev libmozjs-dev&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
after that... the install went great.    Don&apos;t know if this is worth adding to the README or not, but hope it helps in some way...&lt;br/&gt;
thanks,&lt;br/&gt;
&lt;br/&gt;
--nickg&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Ubuntu 8.0.4 (Hardy)</environment>
            <key id="12395573">COUCHDB-51</key>
        <summary>Minor improvement to README regarding boostrap dependencies</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="5" iconUrl="http://issues.apache.org/jira/images/icons/priority_trivial.gif">Trivial</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nickgsuperstar">Nick Galbreath</reporter>
            
    <created>Wed, 7 May 2008 22:51:57 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:27:37 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12595175" author="nslater" created="Thu, 8 May 2008 09:46:50 +0000 (UTC)"  >For your first issue, xsltproc should be listed as a dependancy of the subversion-tools package. If this is not the case you should file a bug with Ubuntu.&lt;br/&gt;
&lt;br/&gt;
I have corrected the dependancy line as reported in your second issue.&lt;br/&gt;
&lt;br/&gt;
Thanks for your contribution to Apache CouchDB!&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 8 May 2008 09:47:20 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 8 May 2008 09:46:50 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-50] Compaction throws error and makes web un-reachable and erlang terminates</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-50</link>

                    <description>After clicking the &amp;quot;Compact Database&amp;quot; button in the CouchDB _utils/index.html on a small database (5 documents), I get this:&lt;br/&gt;
&lt;br/&gt;
[debug] [&amp;lt;0.190.0&amp;gt;] Compaction process spawned for db &amp;quot;jeff&amp;quot;&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.190.0&amp;gt; with exit value: {{case_clause,{14108,65536}},[{couch_stream,stream_data,6},{couch_stream,copy,4},{couch_stream,copy_to_new_stream,4},{couch_db,&apos;-copy_raw_doc/4-fun-0-&apos;,3},{lists,map,2},{couch_db,copy_raw_doc,4},{couch_db,copy_rev_tree,4},{couch_db... &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 30-Apr-2008::12:51:33 ===&lt;br/&gt;
Error in process &amp;lt;0.190.0&amp;gt; with exit value: {{case_clause,{14108,65536}},[{couch_stream,stream_data,6},{couch_stream,copy,4},{couch_stream,copy_to_new_stream,4},{couch_db,&apos;-copy_raw_doc/4-fun-0-&apos;,3},{lists,map,2},{couch_db,copy_raw_doc,4},{couch_db,copy_rev_tree,4},{couch_db... &lt;br/&gt;
&lt;br/&gt;
[error] [&amp;lt;0.45.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,child_terminated},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{case_clause,{14108,65536}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{couch_stream,stream_data,6},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_stream,copy,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_stream,copy_to_new_stream,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-copy_raw_doc/4-fun-0-&apos;,3},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{lists,map,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,copy_raw_doc,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,copy_rev_tree,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&apos;-copy_docs/3-fun-0-&apos;,4}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.150.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;jeff&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;jeff&amp;quot;,&amp;quot;/usr/local/var/lib/couchdb/jeff.couch&amp;quot;,[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.45.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.150.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;jeff&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;jeff&amp;quot;,&amp;quot;/usr/local/var/lib/couchdb/jeff.couch&amp;quot;,[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.45.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.150.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;jeff&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;jeff&amp;quot;,&amp;quot;/usr/local/var/lib/couchdb/jeff.couch&amp;quot;,[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.45.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.150.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;jeff&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;jeff&amp;quot;,&amp;quot;/usr/local/var/lib/couchdb/jeff.couch&amp;quot;,[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.45.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.150.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;jeff&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;jeff&amp;quot;,&amp;quot;/usr/local/var/lib/couchdb/jeff.couch&amp;quot;,[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
[error] [&amp;lt;0.45.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.45.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;supervisor_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{supervisor,{local,couch_server_sup}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{errorContext,start_error},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,file_exists},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{offender,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{pid,&amp;lt;0.150.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{name,&amp;quot;jeff&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mfa,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_db,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;create,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[&amp;quot;jeff&amp;quot;,&amp;quot;/usr/local/var/lib/couchdb/jeff.couch&amp;quot;,[]]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{restart_type,transient},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{shutdown,infinity},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_type,supervisor}]}]}}&lt;br/&gt;
{&amp;quot;init terminating in do_boot&amp;quot;,shutdown}&lt;br/&gt;
</description>
                <environment>Linux, trunk revision 652071</environment>
            <key id="12395096">COUCHDB-50</key>
        <summary>Compaction throws error and makes web un-reachable and erlang terminates</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nietsnie">Jeff Davey</reporter>
            
    <created>Wed, 30 Apr 2008 18:53:08 +0000 (UTC)</created>
    <updated>Fri, 25 Jul 2008 15:27:08 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12593726" author="janl" created="Fri, 2 May 2008 07:07:07 +0000 (UTC)"  >Fixed in trunk as of revision 652489</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 2 May 2008 07:07:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 2 May 2008 07:07:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-49] A patch for the _design%2Fname hack.</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-49</link>

                    <description>I think I&apos;ve managed to make a trivial patch so that design documents can be accessed without the %2F hackery. Its pretty simple. Any request that starts with _design is joined back with it&apos;s url and then sent to handle_doc_request/5 methods.</description>
                <environment></environment>
            <key id="12395018">COUCHDB-49</key>
        <summary>A patch for the _design%2Fname hack.</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Tue, 29 Apr 2008 21:47:18 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:21:01 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12593136" author="paul.joseph.davis" created="Tue, 29 Apr 2008 21:47:59 +0000 (UTC)"  >Hopefully this passes muster.</comment>
                    <comment id="12599728" author="cmlenz" created="Sun, 25 May 2008 22:06:07 +0000 (UTC)"  >The URL encoding is not hackery. Slashes in document IDs are not allowed unencoded, and the document ID of a design document is still just a document ID. So requiring the slash to be encoded is more consistent, IMHO.</comment>
                    <comment id="12599729" author="paul.joseph.davis" created="Sun, 25 May 2008 22:21:05 +0000 (UTC)"  >I see where you&apos;re coming from. But I&apos;m left with the question of whether _design is part of the document name or if _design is more of a namespace for design documents.&lt;br/&gt;
&lt;br/&gt;
Personally, I could see it going either way, but I haven&apos;t groked the internals enough to know if there&apos;s a reason somewhere else that requires the _design as an actual part of the name or not.</comment>
                    <comment id="12602237" author="cmlenz" created="Wed, 4 Jun 2008 10:41:36 +0000 (UTC)"  >Damien said on IRC he didn&apos;t have a problem with special-casing design doc URLs as you suggest.&lt;br/&gt;
&lt;br/&gt;
What finally pushed me over in favor of this is the Apache&apos;s mod_proxy unescapes URLs, so in such a setup, CouchDB would actually see the raw slash. While it&apos;s clear that mod_proxy is broken here (at least in reverse proxying mode), I do want to be able to at least edit my design docs in Futon when going through the proxy. :P</comment>
                    <comment id="12602239" author="cmlenz" created="Wed, 4 Jun 2008 10:42:07 +0000 (UTC)"  >Slightly modified patch applied in r663055. Thanks!</comment>
                    <comment id="12602266" author="spgarbet" created="Wed, 4 Jun 2008 12:44:30 +0000 (UTC)"  >Minor Nit?&lt;br/&gt;
&lt;br/&gt;
Line 60-62 of couch_httpd.erl says:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;% for the path, use the raw path with the query string and fragment&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;% removed, but URL quoting left intact&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{Path, _, _} = mochiweb_util:urlsplit_path(Req:get(raw_path)),&lt;br/&gt;
&lt;br/&gt;
Should this comment be changed to reflect this modification?</comment>
                    <comment id="12602274" author="cmlenz" created="Wed, 4 Jun 2008 12:55:34 +0000 (UTC)"  >No, that hasn&apos;t changed, we still want the raw URL. There&apos;s just a special exception for design doc URLs.</comment>
                </comments>
    
    <attachments>
            <attachment id="12381142" name="design_url_escape.patch" size="763" author="paul.joseph.davis" created="Tue, 29 Apr 2008 21:47:59 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 10:42:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 22:06:07 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-48] Invalid character in request causes double HTTP response -- 200 and 500</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-48</link>

                    <description>I inadvertently created a document with an ID which contains the sequence &amp;quot;%da&amp;quot;, which when URL-decoded is apparently not a valid UTF-8 character. Instead of receiving the appropriate error, I got an HTTP 200 followed by an HTTP 500, both in response to the same request.&lt;br/&gt;
&lt;br/&gt;
Additionally, the document seems to have been created, since accessing certain pages of the list of documents in the built-in web interface causes the same 500 error to show up in the CouchDB logs.&lt;br/&gt;
&lt;br/&gt;
Here is a Wireshark capture which explains the issue:&lt;br/&gt;
&lt;br/&gt;
GET /mnemosyne/id-containing-the-sequence-%da HTTP/1.1&lt;br/&gt;
&lt;br/&gt;
Host: localhost:5984&lt;br/&gt;
&lt;br/&gt;
User-Agent: Drakma/0.11.5 (SBCL 1.0.12; Linux; 2.6.22-2-686; &lt;a href=&quot;http://weitz.de/drakma/)&quot;&gt;http://weitz.de/drakma/)&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Accept: */*&lt;br/&gt;
&lt;br/&gt;
Connection: close&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
&lt;br/&gt;
Etag: &amp;quot;2795559181&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Date: Tue, 29 Apr 2008 03:09:58 GMT&lt;br/&gt;
&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 500 Internal Server Error&lt;br/&gt;
&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
&lt;br/&gt;
Date: Tue, 29 Apr 2008 03:09:58 GMT&lt;br/&gt;
&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
3b&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;EXIT&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{ucs,{bad_utf8_character_code}}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
0&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>Debian (/etc/debian_version says lenny/sid, can never keep their versioning straight). Running CouchDB built from today&apos;s source. Accessing via ClouchDB.</environment>
            <key id="12394951">COUCHDB-48</key>
        <summary>Invalid character in request causes double HTTP response -- 200 and 500</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="enn">Eli Naeher</reporter>
            
    <created>Tue, 29 Apr 2008 03:29:19 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:21:38 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12596362" author="ranok" created="Tue, 13 May 2008 11:28:10 +0000 (UTC)"  >When run from SVN (r. 655820) it properly gives a 404 error:&lt;br/&gt;
&lt;br/&gt;
GET /test_suite_db_a/foo%da HTTP/1.1&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 404 Object Not Found&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
Date: Tue, 13 May 2008 11:27:03 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
28&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}&lt;br/&gt;
0&lt;br/&gt;
</comment>
                    <comment id="12599724" author="cmlenz" created="Sun, 25 May 2008 21:58:58 +0000 (UTC)"  >Yeah, as this seems to work okay in trunk (maybe since the move to MochiWeb?), this issue can be closed.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 21:58:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 13 May 2008 11:28:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-47] --with-js-lib configure flag does not work</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-47</link>

                    <description>When trying to build against my source distribution of Spidermonkey the build script acknowledges the existence of libjs but gives an error message that the header files (jsapi.h) is not present. This seems to be due to an error in the test file the build script constructs to test the include of the header file.</description>
                <environment>OSX Leopard, Spidermonkey 1.7, Erlang 5.6, CouchDB r650729</environment>
            <key id="12394935">COUCHDB-47</key>
        <summary>--with-js-lib configure flag does not work</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="rrees">Robert Rees</reporter>
            
    <created>Mon, 28 Apr 2008 21:01:17 +0000 (UTC)</created>
    <updated>Mon, 16 Jun 2008 19:01:31 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12592895" author="janl" created="Mon, 28 Apr 2008 21:06:49 +0000 (UTC)"  >Please see &lt;a href=&quot;http://wiki.apache.org/couchdb/InstallingSpiderMonkey&quot;&gt;http://wiki.apache.org/couchdb/InstallingSpiderMonkey&lt;/a&gt;</comment>
                    <comment id="12592899" author="rrees" created="Mon, 28 Apr 2008 21:25:24 +0000 (UTC)"  >Realised the original title gave the wrong idea about the bug. The issue is not that you can&apos;t build on OSX but that the configure flag is not working properly.</comment>
                    <comment id="12592901" author="nslater" created="Mon, 28 Apr 2008 21:30:16 +0000 (UTC)"  >Please follow the first few steps from here:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;http://wiki.apache.org/couchdb/Troubleshooting&quot;&gt;http://wiki.apache.org/couchdb/Troubleshooting&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
If it still doesn&apos;t work can you:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* provide details about what flags you are using&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* provide the a listing of directory contents of the directories you are passing to configure&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* attach the full output of running ./configure&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* attach the full config.log file</comment>
                    <comment id="12592914" author="rrees" created="Mon, 28 Apr 2008 22:32:23 +0000 (UTC)"  >The problem is this line:&lt;br/&gt;
&lt;br/&gt;
configure:19518: gcc -c -g -O2 -L/usr/local/lib -L/opt/local/lib -L/Users/rrees/Documents/dev/js/src/Darwin_DBG.OBJ/ -I${exec_prefix}/lib/erlang/usr/include -I/usr/lib/erlang/usr/include -I/usr/local/lib/erlang/usr/include -I/opt/local/lib/erlang/usr/include -I/Users/rrees/Documents/dev/js/src/ -DXP_UNIX   conftest.c &amp;gt;&amp;amp;5&lt;br/&gt;
In file included from /Users/rrees/Documents/dev/js/src/jspubtd.h:45,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;from /Users/rrees/Documents/dev/js/src/jsapi.h:47,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;from conftest.c:56:&lt;br/&gt;
/Users/rrees/Documents/dev/js/src/jstypes.h:245:71: error: jsautocfg.h: No such file or directory&lt;br/&gt;
&lt;br/&gt;
Ignoring my local stuff the jsautocfg.h is under the Darwin_DBG.OBJ directory not under js/src. Both directories need to be -I on the cc line.</comment>
                    <comment id="12592997" author="nslater" created="Tue, 29 Apr 2008 10:26:01 +0000 (UTC)"  >Sorry to be a pain but could you explain this more or follow the steps outlined previously.</comment>
                    <comment id="12593066" author="rrees" created="Tue, 29 Apr 2008 17:48:56 +0000 (UTC)"  >Yeah I&apos;ll try and explain a bit better and provide a hacky fix that might explain better than just words! I have built Spidermonkey using the default instructions and the during the build the jsautocfg.h is created in the target (DARWIN_DBG.OBJ). I imagine that during the install process for Spidermonkey the headers from both source and target platform are placed in the same include directory, however by default the headers in both js/src/ and js/src/TARGET_PLATFORM need to be included.&lt;br/&gt;
&lt;br/&gt;
So for example I have managed to fix the issue by changing the --with-js-lib case to the following:&lt;br/&gt;
&lt;br/&gt;
# Check whether --with-js-lib was given.&lt;br/&gt;
if test &amp;quot;${with_js_lib+set}&amp;quot; = set; then&lt;br/&gt;
&amp;nbsp;&amp;nbsp;withval=$with_js_lib; JS_LIB_FLAGS=&amp;quot;-L$withval&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;JS_INCLUDE_FLAGS=&amp;quot;$JS_INCLUDE_FLAGS -I$withval&amp;quot;&lt;br/&gt;
fi&lt;br/&gt;
&lt;br/&gt;
Looking at it again I think the issue is that -with-js-include is probably meant to point at an installed Spidermonkey whereas I am building ICU, Spidermonkey and CouchDB side by side without ever installing any of them to /usr/local (or similar).&lt;br/&gt;
&lt;br/&gt;
If this is the case then the bug could probably be resolved by documentation and I could just symbolically link jsautocfg.h to js/src to make this compilation step pass.</comment>
                    <comment id="12596027" author="nslater" created="Mon, 12 May 2008 10:31:04 +0000 (UTC)"  >It shouldn&apos;t matter where you install them, /usr/local is not special in any way. Have you tried using the --with-js-include option as well, you will need it to get the header files included.</comment>
                    <comment id="12599726" author="cmlenz" created="Sun, 25 May 2008 22:03:01 +0000 (UTC)"  >I think this should be closed, we should be able to expect dependencies to be correctly installed, not only compiled.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/couchdb/InstallingSpiderMonkey&quot;&gt;http://wiki.apache.org/couchdb/InstallingSpiderMonkey&lt;/a&gt; contains (some) documentation on how to install SpiderMonkey from source.</comment>
                    <comment id="12605378" author="nslater" created="Mon, 16 Jun 2008 19:01:31 +0000 (UTC)"  >Agreed. If anything is missing from the documentation, it should be added it to the wiki page mentioned above.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Jun 2008 19:01:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 28 Apr 2008 21:06:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-46] Time out after saving a design document in Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-46</link>

                    <description>Occasionally, after saving a View in futon, I noticed that occasionally the first hit to the view results in a timeout. It appears that its generally required to change the number of documents in the view to cause a timeout. This only happens on the first request to the view and subsequent request are all fine.&lt;br/&gt;
&lt;br/&gt;
Captured headers and output from a time out:&lt;br/&gt;
&lt;br/&gt;
Response Headers&lt;br/&gt;
Transfer-Encoding	chunked&lt;br/&gt;
Server	MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
Date	Sun, 27 Apr 2008 18:38:44 GMT&lt;br/&gt;
Content-Type	text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
Request Headers&lt;br/&gt;
Host	nebula:5984&lt;br/&gt;
User-Agent	Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en-US; rv:1.8.1.14) Gecko/20080404 Firefox/2.0.0.14&lt;br/&gt;
Accept	text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5&lt;br/&gt;
Accept-Language	en-us,en;q=0.5&lt;br/&gt;
Accept-Encoding	gzip,deflate&lt;br/&gt;
Accept-Charset	ISO-8859-1,utf-8;q=0.7,*;q=0.7&lt;br/&gt;
Keep-Alive	300&lt;br/&gt;
Connection	keep-alive&lt;br/&gt;
&lt;br/&gt;
Response:&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;wait_timeout&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
CouchDB log:&lt;br/&gt;
[info] [&amp;lt;0.227.0&amp;gt;] HTTP Error (code 500): wait_timeout&lt;br/&gt;
[info] [&amp;lt;0.227.0&amp;gt;] 172.18.130.165 - - &amp;quot;GET /test/_view/all/tree&amp;quot; 500</description>
                <environment>Futon on Apache CouchDB 0.7.3a650295&lt;br/&gt;
Linux nebula 2.6.22-14-server #1 SMP Tue Feb 12 03:10:53 UTC 2008 x86_64 GNU/Linux&lt;br/&gt;
Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en-US; rv:1.8.1.14) Gecko/20080404 Firefox/2.0.0.14</environment>
            <key id="12394879">COUCHDB-46</key>
        <summary>Time out after saving a design document in Futon</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="paul.joseph.davis">Paul Joseph Davis</reporter>
            
    <created>Sun, 27 Apr 2008 18:57:28 +0000 (UTC)</created>
    <updated>Mon, 29 Jun 2009 04:16:48 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>Futon</component>
                    <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12594729" author="wojo" created="Tue, 6 May 2008 22:54:13 +0000 (UTC)"  >This is also happening to me with both couchjs and a custom PHP view server. &lt;br/&gt;
&lt;br/&gt;
Changing the view definition causes the first page load to freeze on the view, but subsequent ones load just fine. It is intermittently for me, too.&lt;br/&gt;
&lt;br/&gt;
If I just hit refresh in the browser it&apos;ll abort the hung request and load up properly. Happens in firefox as well as using curl.&lt;br/&gt;
&lt;br/&gt;
Message I get: &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;[info] [&amp;lt;0.165.0&amp;gt;] HTTP Error (code 500): wait_timeout</comment>
                    <comment id="12725029" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:16:48 +0000 (UTC)"  >This hasn&apos;t been reproduced or complained about lately so I&apos;m closing.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:16:48 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 6 May 2008 22:54:13 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-45] Error when concurrently hitting HTTP. Seems that it doesn&apos;t honor Connection: Close</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-45</link>

                    <description>While doing some load testing against couch, i&apos;ve noticed that it throws errors when sending concurrently with more than 40 threads.&lt;br/&gt;
&lt;br/&gt;
I&apos;m guessing that it&apos;s trying to send something back to the client after the socket has already been closed. I&apos;m using Connection: Close in the headers on the http client. &lt;br/&gt;
&lt;br/&gt;
{mochiweb_socket_server,221,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,{{case_clause,{error,enotconn}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request,get,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}}}&lt;br/&gt;
[error] [&amp;lt;0.4889.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.4889.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;crash_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[{pid,&amp;lt;0.4889.0&amp;gt;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{registered_name,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{error_info,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{case_clause,{error,enotconn}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request,get,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{initial_call,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;acceptor_loop,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{&amp;lt;0.53.0&amp;gt;,#Port&amp;lt;0.125&amp;gt;,#Fun&amp;lt;mochiweb_http.1.62821608&amp;gt;}]}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{ancestors,[couch_httpd,couch_server_sup,&amp;lt;0.1.0&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{messages,[]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{links,[&amp;lt;0.53.0&amp;gt;,#Port&amp;lt;0.3453&amp;gt;]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{dictionary,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request_body,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&amp;lt;&amp;quot;{ \&amp;quot;sender\&amp;quot; : \&amp;quot;bob\&amp;quot;, \&amp;quot;recipient\&amp;quot; : \&amp;quot;test1\&amp;quot;, \&amp;quot;flagNew\&amp;quot; : true }&amp;quot;&amp;gt;&amp;gt;}]},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{trap_exit,false},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{status,running},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{heap_size,6765},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{stack_size,21},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reductions,5351}],&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[]]}}&lt;br/&gt;
[error] [&amp;lt;0.53.0&amp;gt;] {error_report,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;0.22.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;0.53.0&amp;gt;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;std_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_socket_server,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;221,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{child_error,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{case_clause,{error,enotconn}},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[{mochiweb_request,get,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{couch_httpd,handle_request,2},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{mochiweb_http,headers,4},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{proc_lib,init_p,5}]}}}}}&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment>linux</environment>
            <key id="12394743">COUCHDB-45</key>
        <summary>Error when concurrently hitting HTTP. Seems that it doesn&apos;t honor Connection: Close</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="nietsnie">Jeff Davey</reporter>
            
    <created>Thu, 24 Apr 2008 22:17:44 +0000 (UTC)</created>
    <updated>Mon, 15 Dec 2008 22:48:42 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12656787" author="damienkatz" created="Mon, 15 Dec 2008 22:48:42 +0000 (UTC)"  >This might have been fixed by an earlier fix to mochiweb library dealing with closing http connections. I&apos;m going to assume this was fixed too as well, but please reopen if the symptoms remain.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 15 Dec 2008 22:48:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 15 Dec 2008 22:48:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-44] CouchDB should use a VERSION file in the database directory</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-44</link>

                    <description>Packaging CouchDB for Debian would be a lot easier if CouchDB used a VERSION file (or similar) in the database directory to indicate which database format was in use. With this in place automated installation scripts could warn, error or perform upgrades when a conflicting version was about to be installed.</description>
                <environment></environment>
            <key id="12394294">COUCHDB-44</key>
        <summary>CouchDB should use a VERSION file in the database directory</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Fri, 18 Apr 2008 10:02:50 +0000 (UTC)</created>
    <updated>Tue, 30 Jun 2009 04:01:50 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12725027" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:13:09 +0000 (UTC)"  >Marking this as duplicate and adding a comment to &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-67&quot; title=&quot;Allow unicode chars in database names and _design documents (was: Allow periods (&amp;quot;.&amp;quot;) in database names)&quot;&gt;COUCHDB-67&lt;/a&gt;. Once we go to directory style databases a VERSION file would be simple if we even decide to got that route. This ticket is quite old so it doesn&apos;t take into account the code that&apos;s been written to seamlessly updates databse versions via compaction. Also, we can&apos;t go with a single VERSION file per node because we can technically have multiple DB file versions per server.</comment>
                    <comment id="12725462" author="nslater" created="Tue, 30 Jun 2009 04:01:50 +0000 (UTC)"  >Invalid anyway, I fixed this in Debian using versioned root directories.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:13:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:13:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-43] Calling a non existing view returns 500 and not 404</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-43</link>

                    <description>CouchDB built from trunk r. 649204&lt;br/&gt;
&lt;br/&gt;
When trying to call a non-existing view document the server returns an HTTP 500 message. &lt;br/&gt;
It is expected that a 404 message would be returned instead. &lt;br/&gt;
&lt;br/&gt;
Example:&lt;br/&gt;
&lt;br/&gt;
GET /porcupine/_view/wikipage/hierarchy?startkey=%5B%22Home%22%5D&amp;amp;endkey=%5B%22Home%22%2C2%5D HTTP/1.1&lt;br/&gt;
Date: Thu, 17 Apr 08 23:41:36 +0300&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 500 Internal Server Error&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
Date: Thu, 17 Apr 2008 20:41:36 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
9a&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{{nocatch,{not_found,missing}},\n [{couch_db,open_doc_int,3},\n  {couch_db,open_doc,3},\n  {couch_view,start_update_loop,4}]}&amp;quot;}&lt;br/&gt;
0&lt;br/&gt;
</description>
                <environment>Linux i386, glibc 2.7</environment>
            <key id="12394239">COUCHDB-43</key>
        <summary>Calling a non existing view returns 500 and not 404</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="shahar.e">Shahar Evron</reporter>
            
    <created>Thu, 17 Apr 2008 20:41:56 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:20:00 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12596357" author="ranok" created="Tue, 13 May 2008 11:16:09 +0000 (UTC)"  >Seems to give the correct response (r. 655815).&lt;br/&gt;
&lt;br/&gt;
GET /porcupine/ HTTP/1.1&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 404 Object Not Found&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
Date: Tue, 13 May 2008 11:14:04 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
28&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}&lt;br/&gt;
0&lt;br/&gt;
&lt;br/&gt;
(I have no database porcupine)</comment>
                    <comment id="12599725" author="cmlenz" created="Sun, 25 May 2008 22:00:32 +0000 (UTC)"  >Right, this seems to work okay in trunk, although I&apos;m not sure when it was fixed :/</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 22:00:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 13 May 2008 11:16:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-42] Sending &quot;Content-length: 0&quot; in PUT requests causes connection to close</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-42</link>

                    <description>CouchDb built from trunk rev. 649048&lt;br/&gt;
&lt;br/&gt;
When sending a PUT request with no body and &amp;quot;Content-length: 0&amp;quot; header, the connection is closed by the HTTP server after the response is received. This happens when creating a new DB for example (no body is sent).&lt;br/&gt;
&lt;br/&gt;
For example from telnet:&lt;br/&gt;
---- code ----&lt;br/&gt;
$ telnet localhost 5984&lt;br/&gt;
Trying 127.0.0.1...&lt;br/&gt;
Connected to localhost.&lt;br/&gt;
Escape character is &apos;^]&apos;.&lt;br/&gt;
PUT /test_db HTTP/1.1&lt;br/&gt;
Host: localhost&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 201 Created&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
Date: Thu, 17 Apr 2008 20:33:40 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
b&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
0&lt;br/&gt;
---- end code ----&lt;br/&gt;
&lt;br/&gt;
In the above example the connection is not closed and all is fine.  However:&lt;br/&gt;
&lt;br/&gt;
---- code ----&lt;br/&gt;
PUT /test_db2 HTTP/1.1&lt;br/&gt;
Host: localhost&lt;br/&gt;
Content-length: 0&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 201 Created&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
Date: Thu, 17 Apr 2008 20:33:59 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
b&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
0&lt;br/&gt;
&lt;br/&gt;
Connection closed by foreign host.&lt;br/&gt;
---- end code ----&lt;br/&gt;
</description>
                <environment>Linux/Gentoo i386, glibc 2.7&lt;br/&gt;
</environment>
            <key id="12394238">COUCHDB-42</key>
        <summary>Sending &quot;Content-length: 0&quot; in PUT requests causes connection to close</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="shahar.e">Shahar Evron</reporter>
            
    <created>Thu, 17 Apr 2008 20:32:18 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:20:18 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599733" author="cmlenz" created="Sun, 25 May 2008 23:10:08 +0000 (UTC)"  >Filed a bug against MochiWeb, including a patch:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;a href=&quot;http://code.google.com/p/mochiweb/issues/detail?id=12&quot;&gt;http://code.google.com/p/mochiweb/issues/detail?id=12&lt;/a&gt;</comment>
                    <comment id="12599791" author="cmlenz" created="Mon, 26 May 2008 09:08:14 +0000 (UTC)"  >Should be fixed by r660136.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:08:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:10:08 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-41] Differentiate between not existent database and not existant document in response on 404</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-41</link>

                    <description>Currently it is not possible to know from a request on a not existent document in the database, if the database does not exist, or if it is just the document which is missing.&lt;br/&gt;
&lt;br/&gt;
It would be nice to have this information in the response JSON structure, so that the application using the CouchDB could handle such errors more gracefully. An extract from a CouchDB interaction showing the problem:&lt;br/&gt;
&lt;br/&gt;
== Ensure database is absent&lt;br/&gt;
&lt;br/&gt;
DELETE /test HTTP/1.0&lt;br/&gt;
Host: localhost&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 404 Object Not Found&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Connection: close&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
== Try GET on absent database&lt;br/&gt;
&lt;br/&gt;
GET /test/not_existant HTTP/1.0&lt;br/&gt;
Host: localhost&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 404 Object Not Found&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Connection: close&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
== Create database, but not the document&lt;br/&gt;
&lt;br/&gt;
PUT /test HTTP/1.0&lt;br/&gt;
Host: localhost&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 201 Created&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Connection: close&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
&lt;br/&gt;
== Try to fetch document again&lt;br/&gt;
&lt;br/&gt;
GET /test/not_existant HTTP/1.0&lt;br/&gt;
Host: localhost&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 404 Object Not Found&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Tue, 15 Apr 2008 20:54:20 GMT&lt;br/&gt;
Connection: close&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}</description>
                <environment>CouchDB 0.7.2</environment>
            <key id="12394086">COUCHDB-41</key>
        <summary>Differentiate between not existent database and not existant document in response on 404</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="apache@kore-nordmann.de">Kore Nordmann</reporter>
            
    <created>Wed, 16 Apr 2008 10:50:14 +0000 (UTC)</created>
    <updated>Sun, 17 May 2009 03:55:40 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12589498" author="apache@kore-nordmann.de" created="Wed, 16 Apr 2008 11:01:35 +0000 (UTC)"  >Fixed title, thanks Jan.</comment>
                    <comment id="12675450" author="till" created="Fri, 20 Feb 2009 19:41:37 +0000 (UTC)"  >So since they currently both read &amp;quot;missing&amp;quot;, I&apos;d like more obvious &amp;quot;error messages&amp;quot;:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Document not found.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Database does not exist.&amp;quot;</comment>
                    <comment id="12675451" author="janl" created="Fri, 20 Feb 2009 19:42:56 +0000 (UTC)"  >bumping to blocker as this is an API change.</comment>
                    <comment id="12710166" author="paul.joseph.davis" created="Sun, 17 May 2009 03:55:40 +0000 (UTC)"  >When requesting a database that doesn&apos;t exist, the body is now:&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;: &amp;quot;not_found&amp;quot;, &amp;quot;reason&amp;quot;: &amp;quot;no_db_file&amp;quot;}</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 17 May 2009 03:55:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 20 Feb 2009 19:41:37 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-40] Transfer-Encoding: Chunked on HTTP 1.0 request</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-40</link>

                    <description>The following request:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; DELETE /test HTTP/1.0&lt;br/&gt;
&amp;gt; Host: localhost&lt;br/&gt;
&lt;br/&gt;
is responded like:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; HTTP/1.0 404 Object Not Found&lt;br/&gt;
&amp;gt; Transfer-Encoding: chunked&lt;br/&gt;
&amp;gt; Server: MochiWeb/1.0 (Any of you quaids got a smint?)&lt;br/&gt;
&amp;gt; Date: Tue, 15 Apr 2008 20:39:07 GMT&lt;br/&gt;
&amp;gt; Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; 28&lt;br/&gt;
&amp;gt; {&amp;quot;error&amp;quot;:&amp;quot;not_found&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;missing&amp;quot;}&lt;br/&gt;
&amp;gt; 0&lt;br/&gt;
&lt;br/&gt;
while chunked transfer-encoding is only supported by HTTP 1.1.</description>
                <environment>Irrelevant</environment>
            <key id="12394036">COUCHDB-40</key>
        <summary>Transfer-Encoding: Chunked on HTTP 1.0 request</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="apache@kore-nordmann.de">Kore Nordmann</reporter>
            
    <created>Tue, 15 Apr 2008 20:38:08 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 11:50:57 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12589241" author="apache@kore-nordmann.de" created="Tue, 15 Apr 2008 21:14:09 +0000 (UTC)"  >This happens since the merge of the mochiweb branch, more specifically in revision 648222.</comment>
                    <comment id="12589929" author="benoitc" created="Thu, 17 Apr 2008 10:18:26 +0000 (UTC)"  >I can confirm this behaviour. When you use nginx or http proxy wich are http 1.0 proxies, they get chunked http so you can&apos;t have proxy over couchdb for now. Tested with this config in nginx :&lt;br/&gt;
&lt;br/&gt;
server {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;listen        80;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;server_name   couchdb;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;location / {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_pass &lt;a href=&quot;http://127.0.0.1:5984;&quot;&gt;http://127.0.0.1:5984;&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_redirect off;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   Port             $proxy_port;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   X-Real-IP        $remote_addr;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
nginx display of course unparsed http chunk. For example on index page :&lt;br/&gt;
&lt;br/&gt;
2e&lt;br/&gt;
{&amp;quot;couchdb&amp;quot;:&amp;quot;Welcome&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;0.7.3a648149&amp;quot;}&lt;br/&gt;
0&lt;br/&gt;
&lt;br/&gt;
the same with lighttpd :&lt;br/&gt;
&lt;br/&gt;
$HTTP[&amp;quot;host&amp;quot;] == &amp;quot;couchdb&amp;quot; {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;server.document-root  = &amp;quot;/var/www/htdocs&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;proxy.server  = ( &amp;quot;&amp;quot; =&amp;gt; &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;((&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;host&amp;quot; =&amp;gt; &amp;quot;127.0.0.1&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;port&amp;quot; =&amp;gt; 5984&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;))&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;)&lt;br/&gt;
}&lt;br/&gt;
</comment>
                    <comment id="12590443" author="benoitc" created="Fri, 18 Apr 2008 13:26:37 +0000 (UTC)"  >This patch send valid http 1.0 response when you have 1.0 request. I can now post/put/delete doc, remove database. and replicate a database over a proxy. Everything work in HTTP/1.1 with chunks.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This is a work in progress, for now test suite for unknow reason don&apos;t  work with such messages :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;1. Exception raised: {&amp;quot;message&amp;quot;:&amp;quot;syntax error&amp;quot;,&amp;quot;fileName&amp;quot;:&amp;quot;&lt;a href=&quot;http://couchdb/_utils/script/json2.js&quot;&gt;http://couchdb/_utils/script/json2.js&lt;/a&gt;&amp;quot;,&amp;quot;lineNumber&amp;quot;:150,&amp;quot;stack&amp;quot;:&amp;quot;()@:0\neval(\&amp;quot;()\&amp;quot;)@:0\n(\&amp;quot;\&amp;quot;)@&lt;a href=&quot;http://couchdb/_utils/script/json2.js:150&quot;&gt;http://couchdb/_utils/script/json2.js:150&lt;/a&gt;\n()@&lt;a href=&quot;http://couchdb/_utils/script/couch.js:35&quot;&gt;http://couchdb/_utils/script/couch.js:35&lt;/a&gt;\n(undefined)@&lt;a href=&quot;http://couchdb/_utils/script/couch_tests.js:905&quot;&gt;http://couchdb/_utils/script/couch_tests.js:905&lt;/a&gt;\nrun(3)@&lt;a href=&quot;http://couchdb/_utils/script/couch_tests.js:945&quot;&gt;http://couchdb/_utils/script/couch_tests.js:945&lt;/a&gt;\n@:0\n&amp;quot;,&amp;quot;name&amp;quot;:&amp;quot;SyntaxError&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
Firebug show me that DELETE doc is launch 2 times and don&apos;t work the second time since the doc don&apos;t exist any more. The first delete don&apos;t send an ok.&lt;br/&gt;
&lt;br/&gt;
anyway this patch mostly work, I have to have something stable this week-end.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12590631" author="benoitc" created="Fri, 18 Apr 2008 22:30:25 +0000 (UTC)"  >New patch that fix all issue i had with previous one. &lt;br/&gt;
&lt;br/&gt;
Now *couchdb send valid http 1.0 response* (mean no chunks and valid length). Views, attachments, db create/delete, doc create/delete/update work. &lt;br/&gt;
&lt;br/&gt;
*All tests pass*. Tested over a nginx proxy. &lt;br/&gt;
&lt;br/&gt;
ok for that ? </comment>
                    <comment id="12591815" author="guby" created="Wed, 23 Apr 2008 21:55:42 +0000 (UTC)"  >Unfortunately the patch doesn&apos;t work on the latest trunk version as of writing this...</comment>
                    <comment id="12591989" author="benoitc" created="Thu, 24 Apr 2008 11:44:56 +0000 (UTC)"  >mm patch apply well here on latest trunk (r650977) and was reported to  work on irc :)&lt;br/&gt;
&lt;br/&gt;
patch -p0 -i thepatch in top directory of couchdb sources&lt;br/&gt;
&lt;br/&gt;
You could also use these patches :&lt;br/&gt;
&lt;a href=&quot;http://babilu.metavers.net/couchdb/patches/patch-share_www_script_couch_js&quot;&gt;http://babilu.metavers.net/couchdb/patches/patch-share_www_script_couch_js&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://babilu.metavers.net/couchdb/patches/patch-src_couchdb_couch_httpd_erl&quot;&gt;http://babilu.metavers.net/couchdb/patches/patch-src_couchdb_couch_httpd_erl&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Same patch but splitted in two for my openbsd port.</comment>
                    <comment id="12592012" author="guby" created="Thu, 24 Apr 2008 12:22:50 +0000 (UTC)"  >You are right. It still works on the trunk (r651236).&lt;br/&gt;
share/www/script/couch.js has been replaced with a jquery so if one ignores the first half of the patch and only applies the second half, it works perfectly!&lt;br/&gt;
&lt;br/&gt;
Thank you very much!</comment>
                    <comment id="12592021" author="benoitc" created="Thu, 24 Apr 2008 12:25:59 +0000 (UTC)"  >afaik couch.js is still used for test suite. It&apos;s needed since a body can&apos;t be null on http 1.0 which broke all tests before this patch</comment>
                    <comment id="12592031" author="guby" created="Thu, 24 Apr 2008 12:39:03 +0000 (UTC)"  >you are right... I must have been really tired, I couldn&apos;t find the file.&lt;br/&gt;
</comment>
                    <comment id="12592323" author="benoitc" created="Fri, 25 Apr 2008 09:46:34 +0000 (UTC)"  >patch against jquerycouch.js that complete  compat_http10_couchdb_r649048.diff  .  the body shouldn&apos;t be null on Post/Put query.</comment>
                    <comment id="12592699" author="cmlenz" created="Sun, 27 Apr 2008 23:25:57 +0000 (UTC)"  >I think it&apos;d be nice if a fix could be done in MochiWeb itself. See this thread:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;a href=&quot;http://groups.google.com/group/mochiweb/browse_thread/thread/971a1e70ee9561b9&quot;&gt;http://groups.google.com/group/mochiweb/browse_thread/thread/971a1e70ee9561b9&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I&apos;m attaching a patch for you to try. Please report if this fixes the issue (the JS changes will still be necessary), and I&apos;ll file a ticket with the patch against the MochiWeb project.</comment>
                    <comment id="12592778" author="benoitc" created="Mon, 28 Apr 2008 09:36:21 +0000 (UTC)"  >this patch work but only when you add the content-length header to http/1.0 request.&lt;br/&gt;
I don&apos;t know yet if it should be handled by mochiweb or not. I think it should but didn&apos;t have time yet to extend your patch for this.  &lt;br/&gt;
&lt;br/&gt;
On the other hand a quick patch on couch_httpd.erl allowed me to confirm that. Patch attached.&lt;br/&gt;
&lt;br/&gt;
Tested on nginx &amp;amp; squid.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12592825" author="cmlenz" created="Mon, 28 Apr 2008 15:05:04 +0000 (UTC)"  >Are you saying the response requires a Content-Length header to work with those proxies? The change to MochiWeb does not set the content-length, because that would require buffering in all those instances where we actually use chunking, and that would suck.&lt;br/&gt;
&lt;br/&gt;
Instead of the content-length, it relies on the server closing the connection when the last piece of data has been sent. I don&apos;t see why that should not work with proper HTTP/1.0 clients.</comment>
                    <comment id="12592916" author="cmlenz" created="Mon, 28 Apr 2008 22:33:51 +0000 (UTC)"  >The first patch against MochiWeb did not work when the client request included&lt;br/&gt;
a &amp;quot;Connection: Keep-Alive&amp;quot; header.  This new version fixes that.</comment>
                    <comment id="12593127" author="benoitc" created="Tue, 29 Apr 2008 21:26:09 +0000 (UTC)"  >second patch seem to work. Works well with squid but had some oddities with nginx I didn&apos;t solve yet. &lt;br/&gt;
On nginx I have to put keepalive_timeout at 0 to have it working.  It works with this setting. I suspect some&lt;br/&gt;
problem with keep-alive so. &lt;br/&gt;
&lt;br/&gt;
However when I add Content-Length header  on send_json func, everything works like a charm. I will &lt;br/&gt;
do more tests tomorrow.</comment>
                    <comment id="12593185" author="cmlenz" created="Wed, 30 Apr 2008 00:47:10 +0000 (UTC)"  >The second patch has been accepted into the MochiWeb project, and has been applied to the version in CouchDB trunk in r652206.&lt;br/&gt;
&lt;br/&gt;
About adding a Content-Length header... there are many places (for example view results) where we use start_json_response and Resp:write_chunk instead of just send_json; those are the cases where we&apos;d need to do buffering of the complete response if we wanted to set the Content-Length appropriately. So I&apos;m pretty sure that&apos;s not a viable option unless we decide on doing response buffering, which I personally don&apos;t think would be a good idea.&lt;br/&gt;
&lt;br/&gt;
Waiting for some more feedback before resolving this. Also, I&apos;d like some details on why those JS changes are necessary. And links, specs, etc?</comment>
                    <comment id="12593246" author="benoitc" created="Wed, 30 Apr 2008 07:05:41 +0000 (UTC)"  >Sound goof, did the patch have been tested on all http1/0 proxy ? &lt;br/&gt;
&lt;br/&gt;
About changes in javascript :&lt;br/&gt;
&lt;br/&gt;
From the rfc 1945 who define http/1.0 :&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;A valid Content-Length is required on all HTTP/1.0 POST requests. An&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;HTTP/1.0 server should respond with a 400 (bad request) message if it&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;cannot determine the length of the request message&apos;s content.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Proxies like nginx are very strict about it. More over nginx don&apos;t accept in proxy mode the POST/PUT request without body like a quick search in google would told you.&lt;br/&gt;
&lt;br/&gt;
About content-length :&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;When an Entity-Body is included with a message, the length of that&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;body may be determined in one of two ways. If a Content-Length header&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;field is present, its value in bytes represents the length of the&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Entity-Body. Otherwise, the body length is determined by the closing&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;of the connection by the server.&lt;br/&gt;
&lt;br/&gt;
So indeed there is no need to bufferize the response if you close the connection at the end. &lt;br/&gt;
Just better to do it when you can it help the client to optimize the connection. So in the case you could do it like in send_json why not ?&lt;br/&gt;
&lt;br/&gt;
All this stuff need more tests anyway I already provided some results on ml, did you see them ?</comment>
                    <comment id="12594080" author="benoitc" created="Sun, 4 May 2008 12:03:21 +0000 (UTC)"  >I have some problem with latest change on OpenBSD -current: I can&apos;t ask any more to close the connection &lt;br/&gt;
in http headers (&amp;quot;Connecttion: close&amp;quot;). &lt;br/&gt;
If I do this I get &amp;quot; Connection reset by peer&amp;quot; error. I don&apos;t reproduce it on a 2.6.24 linux kernel though. &lt;br/&gt;
Didn&apos;t test it yet with freebsd. &lt;br/&gt;
</comment>
                    <comment id="12594230" author="benoitc" created="Mon, 5 May 2008 12:53:39 +0000 (UTC)"  >I solve problem of connection reset by peer with a patch against httplib2 :&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/httplib2/issues/detail?id=24&quot;&gt;http://code.google.com/p/httplib2/issues/detail?id=24&lt;/a&gt; . &lt;br/&gt;
&lt;br/&gt;
The socket wasn&apos;t close if you use connection:close header.</comment>
                    <comment id="12598808" author="cmlenz" created="Wed, 21 May 2008 21:57:00 +0000 (UTC)"  >As of r 658408 we only use chunked encoding where it&apos;s actually needed. Simple responses use no chunked encoding and include a Content-Length header.&lt;br/&gt;
</comment>
                    <comment id="12599818" author="cmlenz" created="Mon, 26 May 2008 11:52:51 +0000 (UTC)"  >Okay, the Javascript/XHR issues were addressed in r660170, so I think this issue should be fixed.</comment>
                </comments>
    
    <attachments>
            <attachment id="12380544" name="compat_http10_couchdb_r649048.diff" size="7122" author="benoitc" created="Fri, 18 Apr 2008 22:30:25 +0000 (UTC)" />
            <attachment id="12381004" name="mochiweb_chunking_http10.diff" size="1792" author="cmlenz" created="Sun, 27 Apr 2008 23:25:57 +0000 (UTC)" />
            <attachment id="12381058" name="mochiweb_chunking_http10_2.diff" size="2876" author="cmlenz" created="Mon, 28 Apr 2008 22:33:51 +0000 (UTC)" />
            <attachment id="12380914" name="patch-share_www_script_jquery_couch_js" size="947" author="benoitc" created="Fri, 25 Apr 2008 09:46:34 +0000 (UTC)" />
            <attachment id="12381022" name="patch-src_couchdb_couch_httpd_erl" size="759" author="benoitc" created="Mon, 28 Apr 2008 09:37:49 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 11:52:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 17 Apr 2008 10:18:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-39] Unable to view/edit documents with spaces in document ID</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-39</link>

                    <description>Futon double-encodes the document ID, mangling spaces (and other characters?)&lt;br/&gt;
&apos; &apos; -&amp;gt; &apos;%25%20&apos;&lt;br/&gt;
&lt;br/&gt;
I created a document named &amp;quot;test id&amp;quot; and tried to view it. Futon could not load the document. Log shows:&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.51.0&amp;gt;] HTTP Request: GET /test/test%2520me?revs_info=true HTTP/1.1&lt;br/&gt;
[info] [&amp;lt;0.51.0&amp;gt;] HTTP Error (code 404): {obj,[{error,&amp;quot;not_found&amp;quot;},{reason,&amp;quot;missing&amp;quot;}]}&lt;br/&gt;
[info] [&amp;lt;0.51.0&amp;gt;] HTTP Response Code:404&lt;br/&gt;
</description>
                <environment>CouchDB trunk 0.7.3a644509, Erlang 5.6.2 on Linux</environment>
            <key id="12393676">COUCHDB-39</key>
        <summary>Unable to view/edit documents with spaces in document ID</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="koz">Ivan Kozik</reporter>
            
    <created>Thu, 10 Apr 2008 16:40:37 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 11:42:49 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12588208" author="cmlenz" created="Sat, 12 Apr 2008 07:27:44 +0000 (UTC)"  >Fixed in r647314. Thanks for the report!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 12 Apr 2008 07:27:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 12 Apr 2008 07:27:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-38] [patch] &apos;Compact&apos; button for Futon</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-38</link>

                    <description>A small patch to allow DB compacting through the Futon GUI.&lt;br/&gt;
&lt;br/&gt;
Patch is at: &lt;a href=&quot;http://files.jimlindley.com/2008/add_compact_button.diff&quot;&gt;http://files.jimlindley.com/2008/add_compact_button.diff&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Additionally, there is an icon that goes along with the patch, and the patch expects to be in trunk/share/www/image/compact.gif (couchdb will not make without it due to build dep)&lt;br/&gt;
&lt;br/&gt;
That file can be downloaded separately here: &lt;a href=&quot;http://files.jimlindley.com/2008/compact.gif&quot;&gt;http://files.jimlindley.com/2008/compact.gif&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I was having trouble including the file encoding correctly with the patch, sorry!</description>
                <environment>&#127;n/a</environment>
            <key id="12393606">COUCHDB-38</key>
        <summary>[patch] &apos;Compact&apos; button for Futon</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="jlindley">Jim Lindley</reporter>
            
    <created>Thu, 10 Apr 2008 01:27:16 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:23:44 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12587600" author="cmlenz" created="Thu, 10 Apr 2008 11:35:11 +0000 (UTC)"  >Patch (slightly modified) applied in r646734. Thanks!</comment>
                    <comment id="12587632" author="jlindley" created="Thu, 10 Apr 2008 13:13:37 +0000 (UTC)"  >There&apos;s a small typo in the compact database dialog (my should be may).&lt;br/&gt;
&lt;br/&gt;
Patch is at &lt;a href=&quot;http://files.jimlindley.com/2008/fix_futon_compact_database_typo.diff&quot;&gt;http://files.jimlindley.com/2008/fix_futon_compact_database_typo.diff&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 10 Apr 2008 11:35:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Thu, 10 Apr 2008 11:35:11 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-37] can&apos;t upload a doc of 13 Mo</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-37</link>

                    <description>Server crash if you try to PUT a doc of 13Mo in a database.  No important log in couch.log nor http_*. The server just crash and restart.. It result in refusing the connection of the client. Tested several times on 3 differents machines.</description>
                <environment>Linux double core amd64/ intel core2duo, Openbsd -current, couchdb 0.7.3a646416</environment>
            <key id="12393585">COUCHDB-37</key>
        <summary>can&apos;t upload a doc of 13 Mo</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Wed, 9 Apr 2008 21:59:21 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:23:30 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12590734" author="jcollie" created="Sun, 20 Apr 2008 04:21:49 +0000 (UTC)"  >I tried creating a 7Mb document with 0.7.3a648222.  This version with the mochikit web server checks for bodies larger than 1Mb and returns a 500 error.  Is there a reason for not allowing larger documents?</comment>
                    <comment id="12599730" author="cmlenz" created="Sun, 25 May 2008 22:22:57 +0000 (UTC)"  >The limit to document PUT has been changed to 4GB in r660050.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 22:22:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 20 Apr 2008 04:21:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-36] Save Revision from Compaction</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-36</link>

                    <description>Allow setting a flag in a document to prevent deleting outdated document revisions during a compaction.&lt;br/&gt;
&lt;br/&gt;
Use case: need to refer to previous revisions for legal/accounting purposes, or using a document as a template to interpret other documents which may have been created from that specific template/document.</description>
                <environment>standard environment</environment>
            <key id="12393537">COUCHDB-36</key>
        <summary>Save Revision from Compaction</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="jlindley">Jim Lindley</reporter>
            
    <created>Wed, 9 Apr 2008 14:49:56 +0000 (UTC)</created>
    <updated>Mon, 14 Apr 2008 15:44:52 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12588614" author="jlindley" created="Mon, 14 Apr 2008 15:44:52 +0000 (UTC)"  >Revisions shouldn&apos;t be used for archival purposes, so saving them from compaction doesn&apos;t make sense.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Apr 2008 15:44:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-35] When accessing a view that doesn&apos;t exist an error occurs in the process</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-35</link>

                    <description>I am on the trunk release.&lt;br/&gt;
Previously when accessing a view that didn&apos;t exist I would just get a document missing error which would be reasonable. Now the same happens if I just try to access a missing design document like this:&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.147.0&amp;gt;] HTTP Request: GET /kleio/_view/couch_object_has_many_relations/&lt;br/&gt;
&lt;br/&gt;
But if I try to invoke the view with it&apos;s full URL I get an error:&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.147.0&amp;gt;] HTTP Request: GET /kleio/_view/couch_object_has_many_relations/related_documents?key=[%22FF539E4677343A9F504D7BFB329F949E%22,%22subscriptions%22] HTTP/1.1&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.148.0&amp;gt; with exit value: {{nocatch,{not_found,missing}},[{couch_db,open_doc_int,3},{couch_db,open_doc,3},{couch_view,start_update_loop,4}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 9-Apr-2008::04:01:36 ===&lt;br/&gt;
Error in process &amp;lt;0.148.0&amp;gt; with exit value: {{nocatch,{not_found,missing}},[{couch_db,open_doc_int,3},{couch_db,open_doc,3},{couch_view,start_update_loop,4}]}&lt;br/&gt;
&lt;br/&gt;
Hope this helps you!&lt;br/&gt;
&lt;br/&gt;
If you have any questions regarding how to reproduce the error please feel free to email me!&lt;br/&gt;
&lt;br/&gt;
Best regards&lt;br/&gt;
Sebastian&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12393484">COUCHDB-35</key>
        <summary>When accessing a view that doesn&apos;t exist an error occurs in the process</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="guby">Sebastian Probst Eide</reporter>
            
    <created>Wed, 9 Apr 2008 04:08:40 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 21:31:36 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666720" author="janl" created="Fri, 23 Jan 2009 21:31:36 +0000 (UTC)"  >This was most likely in various refactorings.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:31:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:31:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-34] Enable replicator to use HTTP authentication</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-34</link>

                    <description>You can currently give the CouchDB replicator HTTP URIs to remote databases. However, if one of those remote instances is behind HTTP authentication, the replication will fail. It should be possible to specify authentication credentials to the replicator, which it would then use in response to 401 responses.</description>
                <environment></environment>
            <key id="12393169">COUCHDB-34</key>
        <summary>Enable replicator to use HTTP authentication</summary>

            <type id="2" iconUrl="http://issues.apache.org/jira/images/icons/newfeature.gif">New Feature</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="damienkatz">Damien Katz</assignee>
            
                        <reporter username="cmlenz">Christopher Lenz</reporter>
            
    <created>Fri, 4 Apr 2008 21:03:32 +0000 (UTC)</created>
    <updated>Mon, 16 Mar 2009 19:18:22 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12666717" author="janl" created="Fri, 23 Jan 2009 21:18:59 +0000 (UTC)"  >This DB authentication in trunk, we should get that fixed in 0.9.</comment>
                    <comment id="12667764" author="kocolosk" created="Tue, 27 Jan 2009 19:29:21 +0000 (UTC)"  >I can submit a patch for this if we decide on the API for specifying credentials.  The JSON object POSTed to _replicate looks like&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;source&amp;quot;: &amp;quot;&lt;a href=&quot;http://example.com:5984/dbname&quot;&gt;http://example.com:5984/dbname&lt;/a&gt;&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;target&amp;quot;: &amp;quot;dbname&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;source_options&amp;quot;: { &amp;quot;headers&amp;quot;: [ {K,V} ] },&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;target_options: { }&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
Do we want to make clients do the Base64 encoding themselves?  In that case, they can stick the authentication header in the JSON object.  Do we want some alternative option in the _options Objects?  Do we want to support &lt;a href=&quot;http://user:&quot;&gt;http://user:&lt;/a&gt;&lt;a href=&apos;mailto:pass@host&apos;&gt;pass@host&lt;/a&gt;:port URLs?</comment>
                    <comment id="12668724" author="kocolosk" created="Fri, 30 Jan 2009 03:15:47 +0000 (UTC)"  >So, the CouchDB replicator works with HTTP authentication already.  Since we have no restrictions on reader access, we only have to worry about two cases:  local target and remote target.&lt;br/&gt;
&lt;br/&gt;
Local Target: specify credentials in the POST to replicate.  Either of the following works:&lt;br/&gt;
curl -X POST &lt;a href=&quot;http://admin:&quot;&gt;http://admin:&lt;/a&gt;&lt;a href=&apos;mailto:mysecretpassword@localhost&apos;&gt;mysecretpassword@localhost&lt;/a&gt;:5984/_replicate works&lt;br/&gt;
curl -X POST &lt;a href=&quot;http://localhost:5984/_replicate&quot;&gt;http://localhost:5984/_replicate&lt;/a&gt; -H &amp;quot;Authorization:Basic YWRtaW46bXlzZWNyZXRwYXNzd29yZA==&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Remote Target: specify credentials in the JSON body.  This works in trunk:&lt;br/&gt;
&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;source&amp;quot;:&amp;quot;test_suite_db_a&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;target&amp;quot;:&amp;quot;&lt;a href=&quot;http://admin:&quot;&gt;http://admin:&lt;/a&gt;&lt;a href=&apos;mailto:mysecretpassword@localhost&apos;&gt;mysecretpassword@localhost&lt;/a&gt;:5984/test_suite_db_b&amp;quot;&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
This works if you the header value in couch_httpd_misc_handlers:handle_replicate_req using ?b2l:&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;source&amp;quot;:&amp;quot;test_suite_db_a&amp;quot;, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;target&amp;quot;:&amp;quot;&lt;a href=&quot;http://localhost:5984/test_suite_db_b&quot;&gt;http://localhost:5984/test_suite_db_b&lt;/a&gt;&amp;quot;, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;quot;target_options&amp;quot;:{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;headers&amp;quot;:{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Authorization&amp;quot;:&amp;quot;Basic YWRtaW46bXlzZWNyZXRwYXNzd29yZA==&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
One thing we could do is format a nice 401 response if the replicator fails because of missing credentials.  Currently the replicator crashes when update_docs fails and no response is sent to the client.  In the local target case returning a 401 is a no brainer.  &lt;br/&gt;
&lt;br/&gt;
In the remote target case it&apos;s a little weird because the credentials need to be sent in the JSON body.  One idea might be to set realm=&amp;quot;target&amp;quot; in the response.  CouchDB-aware clients would know that means the credentials need to go in the body, not the URL or Headers.</comment>
                    <comment id="12668767" author="kocolosk" created="Fri, 30 Jan 2009 06:33:42 +0000 (UTC)"  >I posted some code that makes Couch respond with a 401 status code if a user attempts a replication without proper authentication:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://github.com/kocolosk/couchdb/tree/jira-34&quot;&gt;http://github.com/kocolosk/couchdb/tree/jira-34&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Getting that to work was slightly tricky since it required tracking exceptions across processes.  I chose to rework a bit of the message passing in the replication module as a result.&lt;br/&gt;
&lt;br/&gt;
One downside of this fix is that the replication test will get stuck if run in a browser on a server that has admins defined.  Previously that test would just fail when it tried to replicate to a &amp;quot;remote&amp;quot; target, but now when the 401 code comes back the browser keeps asking for credentials, not realizing that the credentials belong in the JSON body instead of the Authorization Header.&lt;br/&gt;
&lt;br/&gt;
The response in the case of a local target is the usual&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;unauthorized&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;You are not a server or database admin.&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
but if you attempt an unauthorized replication to a remote target you&apos;ll receive&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;unauthorized&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;Please authenticate to the target server in the JSON body.&amp;quot;}</comment>
                    <comment id="12682415" author="damienkatz" created="Mon, 16 Mar 2009 19:18:22 +0000 (UTC)"  >Fixed as part of the replication security worked recently checked in.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Mar 2009 19:18:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:18:59 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-33] NS_ERROR_FAILURE on custom query interface</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-33</link>

                    <description>javascript error, cusrom query feature don&apos;t work. I get this error :&lt;br/&gt;
Component return failure code 0x80004005(NS_ERROR_FAILURE)&lt;br/&gt;
[nslXMLHttpRequest.send]</description>
                <environment>Openbsd 4.3 -current , trunk r642768</environment>
            <key id="12392856">COUCHDB-33</key>
        <summary>NS_ERROR_FAILURE on custom query interface</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 1 Apr 2008 19:16:29 +0000 (UTC)</created>
    <updated>Wed, 2 Apr 2008 00:18:42 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12584259" author="benoitc" created="Tue, 1 Apr 2008 19:17:10 +0000 (UTC)"  >screenshot of error.</comment>
                    <comment id="12584365" author="benoitc" created="Wed, 2 Apr 2008 00:18:42 +0000 (UTC)"  >replication from 0.7.2 to latest trunk was the cause of error. I had also to clean all configuration files.</comment>
                </comments>
    
    <attachments>
            <attachment id="12379054" name="2008-04-01-211133_1028x762_scrot.png" size="109001" author="benoitc" created="Tue, 1 Apr 2008 19:17:09 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 2 Apr 2008 00:18:42 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-32] map function timeout</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-32</link>

                    <description>I can&apos;t have any results with views on 229 items in database. Each execution give this result :&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;map_process_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;map function timed out&amp;quot;} . _adhoc views_ work.&lt;br/&gt;
&lt;br/&gt;
debug log :&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:17 GMT] [info] [&amp;lt;0.68.0&amp;gt;] HTTP Request: GET /test/_view/paste/all HTTP/1.1&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:17 GMT] [debug] [&amp;lt;0.68.0&amp;gt;] Headers: [{&amp;quot;connection&amp;quot;,&amp;quot;keep-alive&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;keep-alive&amp;quot;,&amp;quot;300&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;accept-charset&amp;quot;,&amp;quot;ISO-8859-1,utf-8;q=0.7,*;q=0.7&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;accept-encoding&amp;quot;,&amp;quot;gzip,deflate&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;accept-language&amp;quot;,&amp;quot;en-us,en;q=0.5&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;accept&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;user-agent&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.8.1.13) Gecko/20080325 Ubuntu/7.10 (gutsy) Firefox/2.0.0.13&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;host&amp;quot;,&amp;quot;localhost:5984&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:17 GMT] [debug] [&amp;lt;0.68.0&amp;gt;] Body: []&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:18 GMT] [info] [&amp;lt;0.77.0&amp;gt;] Spawning new text/javascript instance.&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:30 GMT] [error] [emulator] Error in process &amp;lt;0.77.0&amp;gt; with exit value: {{nocatch,{map_process_error,&amp;quot;map function timed out&amp;quot;}},[{couch_query_servers,readline,2},{couch_query_servers,read_json,1},{couch_query_servers,&apos;-map_docs/2-fun-0-&apos;,2},{lists,map,2},{couch_query_servers,map_docs,2... &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:30 GMT] [info] [&amp;lt;0.68.0&amp;gt;] HTTP Error (code 500): {obj,[{error,&amp;quot;map_process_error&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&amp;quot;map function timed out&amp;quot;}]}&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:30 GMT] [debug] [&amp;lt;0.68.0&amp;gt;] HTTP Response Headers (code 500): [{&amp;quot;cache-control&amp;quot;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;pragma&amp;quot;,&amp;quot;no-cache&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;expires&amp;quot;,&amp;quot;Tue, 01 Apr 2008 01:36:30 GMT&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;transfer-encoding&amp;quot;,&amp;quot;chunked&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;content-type&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;text/plain;charset=utf-8&amp;quot;}]&lt;br/&gt;
&lt;br/&gt;
[Tue, 01 Apr 2008 01:36:30 GMT] [info] [&amp;lt;0.68.0&amp;gt;] HTTP Response Code:500&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
View tested :&lt;br/&gt;
function(doc) { &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;if (doc.type == &apos;snippet&apos;) map(doc._id, doc); &lt;br/&gt;
}</description>
                <environment>ubuntu/ openbsd . dualcore amd64 440+ with 2go of ram, couchdb version 0.7.2</environment>
            <key id="12392798">COUCHDB-32</key>
        <summary>map function timeout</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="2" iconUrl="http://issues.apache.org/jira/images/icons/priority_critical.gif">Critical</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Tue, 1 Apr 2008 01:46:10 +0000 (UTC)</created>
    <updated>Wed, 7 Jan 2009 18:27:22 +0000 (UTC)</updated>

                
                
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12584063" author="benoitc" created="Tue, 1 Apr 2008 08:55:16 +0000 (UTC)"  >make more tests tomorrow. I can reproduce this issue on freebsd.&lt;br/&gt;
&lt;br/&gt;
In fact when I do a simple view :&lt;br/&gt;
&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;map(null, doc);&lt;br/&gt;
]&lt;br/&gt;
&lt;br/&gt;
it timeout (on 229 results)&lt;br/&gt;
&lt;br/&gt;
when I specify id :&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;if (doc._id == &apos;goodid&apos;)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;map(doc._id, doc);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
it work.&lt;br/&gt;
&lt;br/&gt;
is there someting to do about such timeout ?</comment>
                    <comment id="12584066" author="benoitc" created="Tue, 1 Apr 2008 09:05:05 +0000 (UTC)"  >obvioudl I have made more tests this morning. forget &apos;tomorrow&apos; ;)</comment>
                    <comment id="12599420" author="derekhaas" created="Fri, 23 May 2008 16:33:22 +0000 (UTC)"  >This is most likely because there is a hardcoded 5 second timeout per document defined for the query servers.  src/couchdb/couch_query_servers.erl.  If you want a quick fix, go into src/couchdb/couch_query_servers.erl, and at line 25 you&apos;ll see the timeout() function...you can up that value and recompile to be less likely to get a timeout error.</comment>
                    <comment id="12661656" author="jchris" created="Wed, 7 Jan 2009 18:27:22 +0000 (UTC)"  >The view_timeout is now a configuration parameter.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 7 Jan 2009 18:27:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 May 2008 16:33:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-31] Another test</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-31</link>

                    <description>Test.</description>
                <environment></environment>
            <key id="12390620">COUCHDB-31</key>
        <summary>Another test</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Mon, 10 Mar 2008 00:53:55 +0000 (UTC)</created>
    <updated>Mon, 10 Mar 2008 00:56:36 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 10 Mar 2008 00:56:36 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-30] Just a simple test</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-30</link>

                    <description>Test</description>
                <environment></environment>
            <key id="12390619">COUCHDB-30</key>
        <summary>Just a simple test</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Mon, 10 Mar 2008 00:46:14 +0000 (UTC)</created>
    <updated>Mon, 10 Mar 2008 00:49:29 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 10 Mar 2008 00:49:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-29] Test</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-29</link>

                    <description>Test</description>
                <environment></environment>
            <key id="12390616">COUCHDB-29</key>
        <summary>Test</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 9 Mar 2008 23:01:23 +0000 (UTC)</created>
    <updated>Sun, 9 Mar 2008 23:01:51 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12576832" author="nslater" created="Sun, 9 Mar 2008 23:01:38 +0000 (UTC)"  >Test</comment>
                    <comment id="12576833" author="nslater" created="Sun, 9 Mar 2008 23:01:51 +0000 (UTC)"  >Test</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 9 Mar 2008 23:01:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-28] warning when building couchdb 0.7.2 with erlang RB12.1</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-28</link>

                    <description>get wranings on import modules in erlang code. log attached (from a compilation on openbsd)</description>
                <environment>all</environment>
            <key id="12390612">COUCHDB-28</key>
        <summary>warning when building couchdb 0.7.2 with erlang RB12.1</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sun, 9 Mar 2008 20:52:40 +0000 (UTC)</created>
    <updated>Sun, 25 May 2008 23:25:26 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12589217" author="cmlenz" created="Tue, 15 Apr 2008 20:12:06 +0000 (UTC)"  >Most of those errors should have gone away now thanks to the switch to MochiWeb. Someone with R12B should try the build, and hopefully close this issue.</comment>
                    <comment id="12599737" author="janl" created="Sun, 25 May 2008 23:25:26 +0000 (UTC)"  >fixed in trunk</comment>
                </comments>
    
    <attachments>
            <attachment id="12377494" name="couchdb-0.7.2.log" size="94873" author="benoitc" created="Sun, 9 Mar 2008 20:53:31 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:25:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Apr 2008 20:12:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-27] performance tests on openbsd, linux, macosx on 3 machines with couchdb 7.2</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-27</link>

                    <description>Quick test on couchdb. It consist on creating 100 docs, fetching them and deleting them serially. Test was done with couchdb-python on couchdb 0.7.2 (code attached).  It appear macosx is better. I have same difference with test suite.&lt;br/&gt;
&lt;br/&gt;
Results OpenBSD (amd64 64 X2 Dual Core Processor 4400+ 2go of ram))&lt;br/&gt;
=======================&lt;br/&gt;
Create Time: 39.6011528969 secs&lt;br/&gt;
Fetch Time : 19.8005139828 secs&lt;br/&gt;
Delete Time : 39.6008718014ecs&lt;br/&gt;
&lt;br/&gt;
Results linux (same machine as above)&lt;br/&gt;
=======================&lt;br/&gt;
Create Time: 9.7383852005 secs&lt;br/&gt;
Fetch Time : 3.96818208694 secs&lt;br/&gt;
Delete Time : 9.25578308105ecs&lt;br/&gt;
&lt;br/&gt;
Results Linux (Intel quadcores 4 go of ram)&lt;br/&gt;
&amp;nbsp;=======================&lt;br/&gt;
Create Time: 8.34433197975 secs&lt;br/&gt;
etch Time : 4.10443782806 secs&lt;br/&gt;
Delete Time : 8.70160794258 secs&lt;br/&gt;
&lt;br/&gt;
Results OSX (mac mini g4 1.5ghz)&lt;br/&gt;
=======================&lt;br/&gt;
Create Time: 3.89569687843 secs&lt;br/&gt;
Fetch Time : 2.90024995804 secs&lt;br/&gt;
Delete Time : 7.2784512043ecs&lt;br/&gt;
</description>
                <environment>OpenBSD 4.3-current, Linux 2.6.22/2.6.24, MacOSX 10.5 - couchdb 0.7.2 - erlang RB12.1</environment>
            <key id="12390611">COUCHDB-27</key>
        <summary>performance tests on openbsd, linux, macosx on 3 machines with couchdb 7.2</summary>

            <type id="6" iconUrl="http://issues.apache.org/jira/images/icons/test.gif">Test</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sun, 9 Mar 2008 20:33:57 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 14:03:57 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12576818" author="benoitc" created="Sun, 9 Mar 2008 20:34:42 +0000 (UTC)"  >simple and stupid script to test couchdb.</comment>
                    <comment id="12576916" author="cmlenz" created="Mon, 10 Mar 2008 09:41:44 +0000 (UTC)"  >This may actually be an issue with couchdb-python (or httplib2) on some platforms. You may want to try using plain curl instead.</comment>
                    <comment id="12577085" author="benoitc" created="Mon, 10 Mar 2008 17:38:36 +0000 (UTC)"  >here is the test script with plain curl.&lt;br/&gt;
&lt;br/&gt;
Results are completly different (mostly I think because it open a process for each curl dispatched on cpu).&lt;br/&gt;
&lt;br/&gt;
Linux (amd64 dualcore) :&lt;br/&gt;
100 docs created in 3s&lt;br/&gt;
100 docs fetched in 1s&lt;br/&gt;
100 docs deleted in 0s&lt;br/&gt;
&lt;br/&gt;
Linux (intel x86_64 quadcore) :&lt;br/&gt;
--------------------------&lt;br/&gt;
100 docs created in 2s&lt;br/&gt;
100 docs fetched in 1s&lt;br/&gt;
100 docs deleted in 1s&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Mac mini (g4 1.5) :&lt;br/&gt;
--------------------------&lt;br/&gt;
100 docs created in 8s&lt;br/&gt;
100 docs fetched in 4s&lt;br/&gt;
100 docs deleted in 5s&lt;br/&gt;
&lt;br/&gt;
On openbsd results are worst ...</comment>
                    <comment id="12577094" author="benoitc" created="Mon, 10 Mar 2008 17:52:59 +0000 (UTC)"  >results on openbsd :&lt;br/&gt;
&lt;br/&gt;
100 docs created in 52s&lt;br/&gt;
100 docs fetched in 50s&lt;br/&gt;
100 docs deleted in 50s&lt;br/&gt;
&lt;br/&gt;
i don&apos;t understand why its worst than on the mac mini. It should be faster since it&apos;s a better machine. Any hint could be appreciated. Think it could be related to http server crash. Any idee how to get crash dump from this one ?</comment>
                    <comment id="12577095" author="benoitc" created="Mon, 10 Mar 2008 17:55:00 +0000 (UTC)"  >fixed for openbsd which is less tolerant with commands syntax</comment>
                    <comment id="12594626" author="wojo" created="Tue, 6 May 2008 16:40:08 +0000 (UTC)"  >Just for another point of reference, I benchmarked with the shell script using curl on FreeBSD and got:&lt;br/&gt;
&lt;br/&gt;
Results :&lt;br/&gt;
--------------------------&lt;br/&gt;
100 docs created in 3s&lt;br/&gt;
100 docs fetched in 1s&lt;br/&gt;
100 docs deleted in 1s&lt;br/&gt;
&lt;br/&gt;
So at least it is not a problem on all BSDs.</comment>
                    <comment id="12594848" author="benoitc" created="Wed, 7 May 2008 10:38:10 +0000 (UTC)"  >could give more details about your setup and what did you use for your tests ? I didn&apos;t have such resulst on fbsd 7, same machine.</comment>
                    <comment id="12595198" author="benoitc" created="Thu, 8 May 2008 12:01:00 +0000 (UTC)"  >I did more tests this afternoon and noticed something weird :&lt;br/&gt;
&lt;br/&gt;
If I connect in http/1.1 i have results around 24s.&lt;br/&gt;
&lt;br/&gt;
If I connect in http/1.0 or explicitly close the connection with http header Connection:close, results down to :&lt;br/&gt;
docs createds in 3s&lt;br/&gt;
docs deleted in 1s&lt;br/&gt;
&lt;br/&gt;
(doc deleted don&apos;t work anymore on last trunk). &lt;br/&gt;
&lt;br/&gt;
Seem like couchdb try to reuse the socket even if the client isn&apos;t here anymore.</comment>
                    <comment id="12599727" author="cmlenz" created="Sun, 25 May 2008 22:04:09 +0000 (UTC)"  >Can you provide some updated info on this no that we&apos;ve enabled TCP_NODELAY, and considering what we learnt about the IPV6 (non-)support?</comment>
                    <comment id="12666932" author="benoitc" created="Sat, 24 Jan 2009 14:03:57 +0000 (UTC)"  >seem to be fixed tright now. Results on openbsd :&lt;br/&gt;
&lt;br/&gt;
--------------------------&lt;br/&gt;
100 docs created in 2s&lt;br/&gt;
100 docs fetched in 1s&lt;br/&gt;
100 docs deleted in 1s&lt;br/&gt;
</comment>
                </comments>
    
    <attachments>
            <attachment id="12377493" name="test_couchdb.py" size="670" author="benoitc" created="Sun, 9 Mar 2008 20:34:42 +0000 (UTC)" />
            <attachment id="12377538" name="test_couchdb.sh" size="2086" author="benoitc" created="Mon, 10 Mar 2008 17:55:00 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 14:03:57 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 10 Mar 2008 09:41:44 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-26] http error at each request  on couchd db (latest trunk or 0.7.2)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-26</link>

                    <description>there is an http error at each request (PUT, POST, DELETE) :&lt;br/&gt;
&lt;br/&gt;
[06/Mar/2008:15:25:07 +0100] server crash for 127.0.0.1, reason: &amp;quot;Error reading &lt;br/&gt;
request: Unexpected message received: \n{&apos;EXIT&apos;,&amp;lt;0.98.0&amp;gt;,normal}\n&amp;quot;&lt;br/&gt;
&lt;br/&gt;
could be the cause of bad performances on FreeBSD or OpenBSD. Error occurs on MacOSX but less frequently.</description>
                <environment>Freebsd 7-stable, Openbsd 4.3-current</environment>
            <key id="12390608">COUCHDB-26</key>
        <summary>http error at each request  on couchd db (latest trunk or 0.7.2)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="benoitc">Benoit Chesneau</reporter>
            
    <created>Sun, 9 Mar 2008 20:19:17 +0000 (UTC)</created>
    <updated>Fri, 14 Nov 2008 03:59:09 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12576816" author="benoitc" created="Sun, 9 Mar 2008 20:21:33 +0000 (UTC)"  >couchdb logs.</comment>
                    <comment id="12599794" author="cmlenz" created="Mon, 26 May 2008 09:14:47 +0000 (UTC)"  >Are you still getting this after the MochiWeb merge?</comment>
                    <comment id="12647514" author="jchris" created="Fri, 14 Nov 2008 03:59:09 +0000 (UTC)"  >I haven&apos;t seen anything like this lately. Granted I&apos;m on OSX and Ubuntu mostly.</comment>
                </comments>
    
    <attachments>
            <attachment id="12377492" name="couchdb_logs_20080309.tar.gz" size="879531" author="benoitc" created="Sun, 9 Mar 2008 20:21:33 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Nov 2008 03:59:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:14:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-25] Javascript view on big dataset crashes couchjs?</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-25</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
&lt;br/&gt;
Not entirely sure. I have been doing some testing with CouchDB, essentially&lt;br/&gt;
downloading messages from twitter for a few days and dumping them in a&lt;br/&gt;
database. I would attach the DB file, but it&apos;s like 120MB big. Then when I&lt;br/&gt;
run a simple view on it, even the simple:&lt;br/&gt;
function(doc) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;map(null, doc);  &lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
I get to see the following messages in the server log. Sometimes it works&lt;br/&gt;
though, so it seems kind of arbitrary:&lt;br/&gt;
&lt;br/&gt;
-----&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.2776.1&amp;gt; with exit value:&lt;br/&gt;
{{nocatch,{map_process_error,{exit_status,0}}},[{couch_query_servers,readline,2},{couch_query_servers,read_json,1},{couch_query_servers,&apos;-map_docs/2-fun-0-&apos;,2},{lists,map,2},{lists,map,2},{couch_query_servers,map_docs...&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 7-Mar-2008::15:45:48 ===&lt;br/&gt;
Error in process &amp;lt;0.2776.1&amp;gt; with exit value:&lt;br/&gt;
{{nocatch,{map_process_error,{exit_status,0}}},[{couch_query_servers,readline,2},{couch_query_servers,read_json,1},{couch_query_servers,&apos;-map_docs/2-fun-0-&apos;,2},{lists,map,2},{lists,map,2},{couch_query_servers,map_docs...&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.2775.1&amp;gt;] HTTP Error (code 500): {obj,[{error,&amp;quot;map_process_error&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&amp;quot;{exit_status,0}&amp;quot;}]}&lt;br/&gt;
[info] [&amp;lt;0.2775.1&amp;gt;] HTTP Response Code:500&lt;br/&gt;
-----&lt;br/&gt;
&lt;br/&gt;
What version of the product are you using? On what operating system?&lt;br/&gt;
&lt;br/&gt;
This only occurs on the subversion trunk build on Ubuntu Linux 7.10. On the&lt;br/&gt;
current release version it works fine.&lt;br/&gt;
&lt;br/&gt;
Please provide any additional information below.&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
If you want the .couch files with which this happens, let me know.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Okay, can you make the DB file available somehow and send me a link to it to cmlenz at gmx.de? I think it &lt;br/&gt;
should compress fairly well BTW.</description>
                <environment></environment>
            <key id="12390578">COUCHDB-25</key>
        <summary>Javascript view on big dataset crashes couchjs?</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 9 Mar 2008 00:01:19 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 12:23:09 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>JavaScript View Server</component>
            
            <due></due>
    
            <votes>1</votes>
    
                                        

            <comments>
                    <comment id="12578574" author="bcalder" created="Fri, 14 Mar 2008 02:22:49 +0000 (UTC)"  >I get the same error on my MacOS X (10.5) build (CouchDB 0.7.3a776).  No problem with a small database with a few records, but using a 1.7GB, ~150000 record database the outcome is the same:&lt;br/&gt;
&lt;br/&gt;
[error] [emulator] Error in process &amp;lt;0.121.0&amp;gt; with exit value: {{nocatch,{map_process_error,{exit_status,0}}},[{couch_query_servers,readline,2},{couch_query_servers,read_json,1},{couch_query_servers,&apos;-map_docs/2-fun-0-&apos;,2},{lists,map,2},{lists,map,2},{couch_query_servers,map_docs... &lt;br/&gt;
&lt;br/&gt;
=ERROR REPORT==== 13-Mar-2008::19:22:37 ===&lt;br/&gt;
Error in process &amp;lt;0.121.0&amp;gt; with exit value: {{nocatch,{map_process_error,{exit_status,0}}},[{couch_query_servers,readline,2},{couch_query_servers,read_json,1},{couch_query_servers,&apos;-map_docs/2-fun-0-&apos;,2},{lists,map,2},{lists,map,2},{couch_query_servers,map_docs... &lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.120.0&amp;gt;] HTTP Error (code 500): {obj,[{error,&amp;quot;map_process_error&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&amp;quot;{exit_status,0}&amp;quot;}]}&lt;br/&gt;
[info] [&amp;lt;0.120.0&amp;gt;] HTTP Response Code:500&lt;br/&gt;
&lt;br/&gt;
____&lt;br/&gt;
&lt;br/&gt;
Update:&lt;br/&gt;
It seems that with 1000 of my documents, it takes around 3-4 updates (repeated requests of &lt;a href=&quot;http://localhost:5984/test/_view/search/all&quot;&gt;http://localhost:5984/test/_view/search/all&lt;/a&gt; where all = &amp;quot;function(doc) { map(null, doc.name) }&amp;quot;) for the server to catch up.  The first updates give the familiar {&amp;quot;error&amp;quot;:&amp;quot;map_process_error&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{exit_status,0}&amp;quot;} with a ~1 sec delay, then you get the expected result very quickly.  The size of the 1000 document database is:&lt;br/&gt;
&lt;br/&gt;
original: 6531094&lt;br/&gt;
after first search: 7159862&lt;br/&gt;
after second search: 7913923&lt;br/&gt;
after third search: 8380923&lt;br/&gt;
after fourth search: 8380923&lt;br/&gt;
&lt;br/&gt;
(in this test, the 3rd search was successful, no growth when idle)&lt;br/&gt;
&lt;br/&gt;
With 3000 documents, I get a similar result, only it takes more refreshing.&lt;br/&gt;
&lt;br/&gt;
CouchDB seems to be updating it&apos;s view index only while the query is running.  Appending ?update=false at every other step gives the &amp;quot;total_rows&amp;quot; that have been indexed (in my case, growing by about 250 docs with each refresh).  According to &lt;a href=&quot;http://www.couchdbwiki.com/index.php?title=Technical_Overview#View_Indexes&quot;&gt;http://www.couchdbwiki.com/index.php?title=Technical_Overview#View_Indexes&lt;/a&gt; , &amp;quot;To keep view querying fast, the view engine maintains cached indexes of its views, and incrementally updates them to reflect changes in the database.&amp;quot;  It seems that the initial index is not automatically built.&lt;br/&gt;
&lt;br/&gt;
If this is the expected behavior, how can I force a complete build of the view index? &lt;br/&gt;
&lt;br/&gt;
regards&lt;br/&gt;
</comment>
                    <comment id="12581710" author="cmlenz" created="Mon, 24 Mar 2008 22:44:02 +0000 (UTC)"  >The problem is caused by a hard-coded branch limit in our SpiderMonkey wrapper, which was added to combat potential memory leaks. As this issue shows, that was a bad idea, as it breaks creating view indices over large datasets. Doh.&lt;br/&gt;
&lt;br/&gt;
The attached patch removes the branch limit, and also fixes a memory leak in the decoding of strings in the readline() function. Seems to work nicely here.</comment>
                    <comment id="12583246" author="cmlenz" created="Sat, 29 Mar 2008 00:14:28 +0000 (UTC)"  >Patch applied in r642448.</comment>
                </comments>
    
    <attachments>
            <attachment id="12378518" name="issue25.diff" size="933" author="cmlenz" created="Mon, 24 Mar 2008 22:44:02 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 29 Mar 2008 00:14:28 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Mar 2008 02:22:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-24] Loading multiple IDs from the database in a single call</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-24</link>

                    <description>Hi&lt;br/&gt;
It would be great if it was possible to load several IDs from the database using a single call.&lt;br/&gt;
Currently it is only possible to load one key at a time or a range og keys, but in many cases I find &lt;br/&gt;
that it is needed to load several keys, that are not in sequence, at once.&lt;br/&gt;
&lt;br/&gt;
Please view this discussion thread for more information if you want.&lt;br/&gt;
&lt;a href=&quot;http://groups.google.com/group/couchdb/browse_thread/thread/08d4ff4abcb30f26?hl=en&quot;&gt;http://groups.google.com/group/couchdb/browse_thread/thread/08d4ff4abcb30f26?hl=en&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Thanks for a great DB and keep up the good work!&lt;br/&gt;
&lt;br/&gt;
Best regards&lt;br/&gt;
Sebastian </description>
                <environment></environment>
            <key id="12390577">COUCHDB-24</key>
        <summary>Loading multiple IDs from the database in a single call</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 9 Mar 2008 00:00:45 +0000 (UTC)</created>
    <updated>Fri, 14 Nov 2008 03:57:51 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12628917" author="mndrix" created="Sat, 6 Sep 2008 22:08:55 +0000 (UTC)"  >A note so that this doesn&apos;t get lost: Chris Anderson proposed a patch in &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-98&quot; title=&quot;PATCH _load_docs API for multiple docs from a single request&quot;&gt;&lt;strike&gt;COUCHDB-98&lt;/strike&gt;&lt;/a&gt; that implements this request.</comment>
                    <comment id="12647513" author="jchris" created="Fri, 14 Nov 2008 03:57:51 +0000 (UTC)"  >fixed (duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-98&quot; title=&quot;PATCH _load_docs API for multiple docs from a single request&quot;&gt;&lt;strike&gt;COUCHDB-98&lt;/strike&gt;&lt;/a&gt;)</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Nov 2008 03:57:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 6 Sep 2008 22:08:55 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-23] Make build system check bootstrapping</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-23</link>

                    <description>If you make the bootstrap write out the svn revision ID and the build&lt;br/&gt;
process check the revision ID it may be possible to error out when the user&lt;br/&gt;
has done an &amp;quot;svn up&amp;quot; without bootstrapping.</description>
                <environment></environment>
            <key id="12390576">COUCHDB-23</key>
        <summary>Make build system check bootstrapping</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="1" iconUrl="http://issues.apache.org/jira/images/icons/status_open.gif">Open</status>
                        <resolution id="-1">Unresolved</resolution>
            
    
                        <assignee username="nslater">Noah Slater</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sun, 9 Mar 2008 00:00:22 +0000 (UTC)</created>
    <updated>Tue, 30 Jun 2009 04:00:33 +0000 (UTC)</updated>

                
                
                        <component>Build System</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12725026" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:07:45 +0000 (UTC)"  >Noah, care to add anything to this? I understand the make idiot proof idea but I haven&apos;t seen it as that big of a problem. I&apos;ve occasionally run into the &amp;quot;wtf?&amp;quot; problems but just fall back to `./bootstrap &amp;amp;&amp;amp; ./configure &amp;amp;&amp;amp; ./make` to see if that works. In other words, I&apos;d say just close this unless you feel motivated to add the check.</comment>
                    <comment id="12725461" author="nslater" created="Tue, 30 Jun 2009 04:00:33 +0000 (UTC)"  >No, please leave open. I will fix this Real Soon Now.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 29 Jun 2009 04:07:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-22] http://demos.couchdb.com/ not working</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-22</link>

                    <description>Looks like &lt;a href=&quot;http://demos.couchdb.com/&quot;&gt;http://demos.couchdb.com/&lt;/a&gt; is now working.</description>
                <environment></environment>
            <key id="12390575">COUCHDB-22</key>
        <summary>http://demos.couchdb.com/ not working</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:59:59 +0000 (UTC)</created>
    <updated>Mon, 16 Jun 2008 19:02:17 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 16 Jun 2008 19:02:17 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                            </customfields>
    
</item>

<item>
<title>[COUCHDB-21] _design_docs view</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-21</link>

                    <description>RFE&lt;br/&gt;
&lt;br/&gt;
Design docs don&apos;t show up in views, so the only way to get a list of them is like this, a la the built-&lt;br/&gt;
in admin web app:&lt;br/&gt;
&lt;br/&gt;
GET /my_awesome_db/_all_docs?startkey=&amp;quot;_design/&amp;quot;&amp;amp;endkey=&amp;quot;_design/ZZZ&amp;quot;&lt;br/&gt;
&lt;br/&gt;
a built-in _design_docs view would obviate the need for such hackery.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Upon further consideration, I think it would be more useful to provide a means by which design docs could be &lt;br/&gt;
included in views.  That would allow you to extract some useful information about the views available in a design &lt;br/&gt;
doc.  E.g. you can return for each design doc an object with view names as keys, and the values being the &lt;br/&gt;
arguments to the map() calls within the view function.</description>
                <environment></environment>
            <key id="12390573">COUCHDB-21</key>
        <summary>_design_docs view</summary>

            <type id="5" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Wish</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="3">Duplicate</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:58:31 +0000 (UTC)</created>
    <updated>Sat, 24 Jan 2009 11:13:53 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666726" author="janl" created="Fri, 23 Jan 2009 21:45:40 +0000 (UTC)"  >This is an addition to the API, still flag it for 0.9 to get the API solidified.</comment>
                    <comment id="12666882" author="janl" created="Sat, 24 Jan 2009 11:13:53 +0000 (UTC)"  >This is a duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-156&quot; title=&quot;views should have input document settings&quot;&gt;&lt;strike&gt;COUCHDB-156&lt;/strike&gt;&lt;/a&gt;. Closing this earlier report because the later one has more discussion.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sat, 24 Jan 2009 11:13:53 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:45:40 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-20] Output from update listener causes error messages/db server crash</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-20</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
&lt;br/&gt;
1. Write a program/script that continuously reads its stdin and writes &lt;br/&gt;
something to stdout as stdin line has arrived&lt;br/&gt;
&lt;br/&gt;
2. Register it as a db update listener in couch.ini&lt;br/&gt;
&lt;br/&gt;
[Couch]&lt;br/&gt;
...&lt;br/&gt;
DbUpdateNotificationProcess=/path/to/daemon&lt;br/&gt;
&lt;br/&gt;
3. Start couchdb. Each time db is updated, the listener program receives &lt;br/&gt;
input and writes back to stdout.&lt;br/&gt;
&lt;br/&gt;
This causes long and obscure error messages in couchdb server concole &lt;br/&gt;
output (not showed here). According to [1], listener is not supposed to &lt;br/&gt;
send anything back.&lt;br/&gt;
&lt;br/&gt;
It is therefore proposed that whatever is received from the listener is &lt;br/&gt;
merely logged in special log file e. g. notifier_log (which may be &lt;br/&gt;
redirected to /dev/null in couch.ini if not needed).&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[1] &lt;br/&gt;
&lt;a href=&quot;http://groups.google.com/group/couchdb/browse_thread/thread/a81fb0058ae2430&quot;&gt;http://groups.google.com/group/couchdb/browse_thread/thread/a81fb0058ae2430&lt;/a&gt;&lt;br/&gt;
b/7285fb233fa10368#7285fb233fa10368</description>
                <environment></environment>
            <key id="12390572">COUCHDB-20</key>
        <summary>Output from update listener causes error messages/db server crash</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="paul.joseph.davis">Paul Joseph Davis</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:57:58 +0000 (UTC)</created>
    <updated>Sun, 2 Aug 2009 08:06:34 +0000 (UTC)</updated>

                
                        <fixVersion>0.10</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666714" author="janl" created="Fri, 23 Jan 2009 21:16:30 +0000 (UTC)"  >Flag for 1.0. This should be an easy one.</comment>
                    <comment id="12725025" author="paul.joseph.davis" created="Mon, 29 Jun 2009 04:05:09 +0000 (UTC)"  >I&apos;m thinking we just mark this as invalid. If people don&apos;t want to munge their logs then they should write their update_notifiers to not write to stdout. The logic to make ports reactive would require a bit of rework.&lt;br/&gt;
&lt;br/&gt;
Ps. I realize its been months since the action, but I&apos;m gonna go through and start triaging.&lt;br/&gt;
Pps. Sorry for ticket spam.</comment>
                    <comment id="12738014" author="paul.joseph.davis" created="Sun, 2 Aug 2009 08:06:34 +0000 (UTC)"  >Ignoring this for now because fixing would require quite a bit of effort given the way things are written. Plus as we&apos;re we may be dropping external listening to update notifications the whole problem might disappear anyway.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 2 Aug 2009 08:06:34 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:16:30 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-19] Large base64 attachment bodies must be single-line</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-19</link>

                    <description>The Wiki documentation does not reflect that large attachments, when &lt;br/&gt;
encoded with Base64 should not have line-breaks (otherwise upload fails). &lt;br/&gt;
The whole base64 string must be on a single line. Therefore, output from &lt;br/&gt;
e. g. base64 program is not immediately usable; it must be preprocessed to &lt;br/&gt;
remove line breaks.</description>
                <environment></environment>
            <key id="12390571">COUCHDB-19</key>
        <summary>Large base64 attachment bodies must be single-line</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:57:34 +0000 (UTC)</created>
    <updated>Fri, 23 Jan 2009 21:33:47 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12591749" author="olleolleolle" created="Wed, 23 Apr 2008 19:22:51 +0000 (UTC)"  >&lt;a href=&quot;http://wiki.apache.org/couchdb/HttpDocumentApi&quot;&gt;http://wiki.apache.org/couchdb/HttpDocumentApi&lt;/a&gt; (the Attachments section near the end) now has this wording:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;NB: Any base64 data you send has to be on a single line of characters, so pre-process your data to remove any carriage returns. &lt;br/&gt;
&lt;br/&gt;
Any other places you think need information?</comment>
                    <comment id="12666721" author="janl" created="Fri, 23 Jan 2009 21:33:46 +0000 (UTC)"  >this has been fixed in the wiki for a while.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:33:47 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 23 Apr 2008 19:22:51 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-18] Unicode document names</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-18</link>

                    <description>The documentation at &lt;br/&gt;
&lt;a href=&quot;http://www.couchdbwiki.com/index.php?title=HTTP_Doc_API#Valid_Document_Names&quot;&gt;http://www.couchdbwiki.com/index.php?title=HTTP_Doc_API#Valid_Document_Names&lt;/a&gt;&lt;br/&gt;
notes that valid document names (_id) are only [a-zA-Z0-9_] (for now). The&lt;br/&gt;
behaviour for non-ASCII names is not specified.&lt;br/&gt;
&lt;br/&gt;
For now what happens is that CouchDB treats document names in a url like&lt;br/&gt;
iso-8859-1.. for ex. this is a dump of the HTTP traffic:&lt;br/&gt;
&lt;br/&gt;
PUT /test/%D0%B0%D0%B0%D0%B0%D0%B0 HTTP/1.1&lt;br/&gt;
Host: localhost:5984&lt;br/&gt;
Accept-Encoding: identity&lt;br/&gt;
Content-Length: 40&lt;br/&gt;
content-type: application/json&lt;br/&gt;
accept: application/json&lt;br/&gt;
user-agent: couchdb-python 0.2&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;message&amp;quot;: &amp;quot;the medium is the message&amp;quot;}&lt;br/&gt;
HTTP/1.1 201 Created&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Sat, 05 Jan 2008 17:58:58 GMT&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Sat, 05 Jan 2008 17:58:58 GMT&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Etag: 3412642223&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
57&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;\u00d0\u00b0\u00d0\u00b0\u00d0\u00b0\u00d0\u00b0&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;3412642223&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
0&lt;br/&gt;
&lt;br/&gt;
The string %D0%B0%D0%B0%D0%B0%D0%B0 was converted to&lt;br/&gt;
&amp;quot;\u00d0\u00b0\u00d0\u00b0\u00d0\u00b0\u00d0\u00b0&amp;quot; ... while the intended&lt;br/&gt;
behavior was to get a Cyrillic (utf-8) document name.&lt;br/&gt;
&lt;br/&gt;
Also couchdb-python and the javascript library that ships with couchdb&lt;br/&gt;
assume that utf-8 is used as an encoding of the unicode document names.&lt;br/&gt;
&lt;br/&gt;
Everything tested with CouchDB 0.7.2&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Forgot to add... the expected output would be &amp;quot;id&amp;quot;:&amp;quot;\u0430\u0430\u0430\u0430&amp;quot; . for ex:&lt;br/&gt;
&lt;br/&gt;
$ python&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; unquote(&apos;%D0%B0%D0%B0%D0%B0%D0%B0&apos;).decode(&apos;utf-8&apos;)&lt;br/&gt;
u&apos;\u0430\u0430\u0430\u0430&apos;</description>
                <environment></environment>
            <key id="12390570">COUCHDB-18</key>
        <summary>Unicode document names</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:56:52 +0000 (UTC)</created>
    <updated>Fri, 14 Nov 2008 04:01:06 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12647515" author="jchris" created="Fri, 14 Nov 2008 04:01:06 +0000 (UTC)"  >This has been fixed for a while</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Nov 2008 04:01:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 14 Nov 2008 04:01:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-17] Internal Server Errors do not format response correctly</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-17</link>

                    <description>The JSON returned from 500 responses seems to be escaped. For example, I get&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 500 Internal Server Error&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Wed, 26 Dec 2007 23:50:01 GMT&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Wed, 26 Dec 2007 23:50:01 GMT&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;error&amp;quot;:&amp;quot;EXIT&amp;quot;,&amp;quot;reason&amp;quot;:&amp;quot;{function_clause,[{cjson,tokenize,[\&amp;quot;A\&amp;quot;,{decoder,utf8,null,1,1,any}]},\n                  &lt;br/&gt;
{cjson,decode1,2},\n                  {cjson,json_decode,2},\n                  {mod_couch,&apos;-&lt;br/&gt;
view_parse_query\/1-fun-0-&apos;,2},\n                  {lists,foldl,3},\n                  &lt;br/&gt;
{mod_couch,send_view,2},\n                  {mod_couch,do,1},\n                  &lt;br/&gt;
{httpd_response,traverse_modules,2}]}&amp;quot;}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
-- &lt;a href=&apos;mailto:ry@tinyclouds.org&apos;&gt;ry@tinyclouds.org&lt;/a&gt;</description>
                <environment></environment>
            <key id="12390569">COUCHDB-17</key>
        <summary>Internal Server Errors do not format response correctly</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="2">Won&apos;t Fix</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:56:19 +0000 (UTC)</created>
    <updated>Wed, 4 Jun 2008 16:09:39 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12602332" author="cmlenz" created="Wed, 4 Jun 2008 16:09:39 +0000 (UTC)"  >The response body is a JSON object, and the reason just contains the Erlang error as a string. Line breaks etc need to be escaped in JSON strings.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 16:09:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 16:09:39 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-16] _bulk_docs returns results in reverse order</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-16</link>

                    <description>Posting to /database/_bulk_docs will return a JSON object which looks like&lt;br/&gt;
this:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;ok&amp;quot;: true,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;results&amp;quot;: [&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;a&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;3465402201&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;b&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;914573466&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;c&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;2541681057&amp;quot;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
however, the &amp;quot;results&amp;quot; part of these response orders the docResults&lt;br/&gt;
opposite of the array posted to _bulk_docs.&lt;br/&gt;
&lt;br/&gt;
I&apos;ve attached a unit test which demonstrates this.&lt;br/&gt;
&lt;br/&gt;
-- &lt;a href=&apos;mailto:ry@tinyclouds.org&apos;&gt;ry@tinyclouds.org&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 2 by coldredlemur, Dec 25, 2007&lt;br/&gt;
&lt;br/&gt;
Actually, replacing the foldl with a  foldr in mod_couch:handle_bulk_doc_update fixes the problem. (I don&apos;t  &lt;br/&gt;
know what&apos;s going on in that function, so someone should verify that this is the accurate fix.)&lt;br/&gt;
&lt;br/&gt;
-- ry&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12390568">COUCHDB-16</key>
        <summary>_bulk_docs returns results in reverse order</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:54:46 +0000 (UTC)</created>
    <updated>Wed, 4 Jun 2008 15:46:05 +0000 (UTC)</updated>

                
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12602325" author="cmlenz" created="Wed, 4 Jun 2008 15:46:05 +0000 (UTC)"  >This works as expected in trunk (I think it already worked in 0.7.2, but I may be wrong), and I just added a test case in r663239.</comment>
                </comments>
    
    <attachments>
            <attachment id="12377467" name="bulk_reverse_fix.diff" size="409" author="nslater" created="Sat, 8 Mar 2008 23:55:52 +0000 (UTC)" />
            <attachment id="12377466" name="reverse_bulk_results_test.diff" size="1037" author="nslater" created="Sat, 8 Mar 2008 23:55:40 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 15:46:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 4 Jun 2008 15:46:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-15] Error inserting attachment with empty data</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-15</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
1. Insert a document like: {&amp;quot;_attachments&amp;quot;: {&amp;quot;foo&amp;quot;: {&amp;quot;data&amp;quot;: &amp;quot;&amp;quot;}}}&lt;br/&gt;
&lt;br/&gt;
What is the expected output? What do you see instead?&lt;br/&gt;
&lt;br/&gt;
I&apos;d expect it to add the 0-length attachment, but I get this error in the log:&lt;br/&gt;
[info] [&amp;lt;0.1541.0&amp;gt;] HTTP Error (code 500): {obj,[{error,&amp;quot;EXIT&amp;quot;},&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{reason,&amp;quot;{function_clause,[{couch_util,decode1,[undefined]},\n                  &lt;br/&gt;
{couch_util,decodeBase64,1},\n                  {couch_doc,&apos;-from_json_obj/1-fun-0-&apos;,1},\n                  &lt;br/&gt;
{lists,flatmap,2},\n                  {couch_doc,from_json_obj,1},\n                  &lt;br/&gt;
{mod_couch,handle_doc_put,2},\n                  {mod_couch,do,1},\n                  &lt;br/&gt;
{httpd_response,traverse_modules,2}]}&amp;quot;}]}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
What version of the product are you using? On what operating system?&lt;br/&gt;
This happens on 0.7.2 and trunk</description>
                <environment></environment>
            <key id="12390567">COUCHDB-15</key>
        <summary>Error inserting attachment with empty data</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:54:10 +0000 (UTC)</created>
    <updated>Fri, 18 Jul 2008 09:12:14 +0000 (UTC)</updated>

                        <version>0.7.2</version>
                    <version>0.8</version>
            
                        <fixVersion>0.8.1</fixVersion>
            
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12614677" author="janl" created="Fri, 18 Jul 2008 09:12:14 +0000 (UTC)"  >Fixed in 677682</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 18 Jul 2008 09:12:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 18 Jul 2008 09:12:14 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-14] DELETE /todo/?rev=undefined deletes all docs in a db</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-14</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
1. Create a DB&lt;br/&gt;
2. Create some docs&lt;br/&gt;
3. Run &apos;DELETE /todo/?rev=undefined&apos; &lt;br/&gt;
&lt;br/&gt;
What is the expected output? What do you see instead?&lt;br/&gt;
I expect an error or something, but not all docs vanishing</description>
                <environment></environment>
            <key id="12390566">COUCHDB-14</key>
        <summary>DELETE /todo/?rev=undefined deletes all docs in a db</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:53:46 +0000 (UTC)</created>
    <updated>Sun, 25 May 2008 23:22:05 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599735" author="cmlenz" created="Sun, 25 May 2008 23:22:05 +0000 (UTC)"  >The operation DELETE /dbname deletes the database, not just all documents. That works as designed and expected.&lt;br/&gt;
&lt;br/&gt;
If you try DELETE /dbname/docid?rev=undefined you&apos;ll get a conflict error because the rev doesn&apos;t match the latest, also working as expected.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:22:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:22:05 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-13] ETags in response headers do not follow the spec</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-13</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
1. Request a document&lt;br/&gt;
2. See for yourself :)&lt;br/&gt;
&lt;br/&gt;
What is the expected output? What do you see instead?&lt;br/&gt;
Expected is&lt;br/&gt;
a) that the header name is &amp;quot;ETag&amp;quot;, not &amp;quot;Etag&amp;quot;&lt;br/&gt;
b) that the value is a quoted string&lt;br/&gt;
Incorrect actual value example:&lt;br/&gt;
Etag: 2184611109&lt;br/&gt;
Correct expected value example:&lt;br/&gt;
ETag: 2184611109&lt;br/&gt;
&lt;br/&gt;
What version of the product are you using? On what operating system?&lt;br/&gt;
trunk r591, Mac OS X 10.5.0&lt;br/&gt;
&lt;br/&gt;
Please provide any additional information below.&lt;br/&gt;
&lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.11&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.11&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 1 by dzuelke, Nov 16, 2007&lt;br/&gt;
&lt;br/&gt;
Bah, of course the expected value is&lt;br/&gt;
ETag: &amp;quot;2184611109&amp;quot;&lt;br/&gt;
with quotes.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 2 by nslater, Nov 17, 2007&lt;br/&gt;
&lt;br/&gt;
Note: The case of a HTTP header is not important.&lt;br/&gt;
&lt;br/&gt;
It can be &amp;quot;etag&amp;quot;, &amp;quot;Etag&amp;quot;, &amp;quot;ETag&amp;quot;, &amp;quot;eTag&amp;quot;, &amp;quot;etAg&amp;quot; or any other combination.&lt;br/&gt;
&lt;br/&gt;
The only thing that needs to change here are the quotes.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 3 by dzuelke, Nov 17, 2007&lt;br/&gt;
&lt;br/&gt;
Granted, header field names are case insensitive, but I guess it cannot hurt to stick to the spec, which uses &lt;br/&gt;
&amp;quot;ETag&amp;quot; :)&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 4 by &lt;a href=&apos;mailto:aristid....@gmx.de&apos;&gt;aristid....@gmx.de&lt;/a&gt;, Jan 26, 2008&lt;br/&gt;
&lt;br/&gt;
A fix relative to rev 640 is attached.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12390565">COUCHDB-13</key>
        <summary>ETags in response headers do not follow the spec</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:52:13 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 11:44:57 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12588786" author="cmlenz" created="Mon, 14 Apr 2008 20:44:41 +0000 (UTC)"  >This is fixed on the mochiweb branch.</comment>
                    <comment id="12589215" author="cmlenz" created="Tue, 15 Apr 2008 20:09:09 +0000 (UTC)"  >Now that the mochiweb branch has been merged back into trunk, this is fixed.</comment>
                </comments>
    
    <attachments>
            <attachment id="12377465" name="couchdb.patch" size="3133" author="nslater" created="Sat, 8 Mar 2008 23:53:09 +0000 (UTC)" />
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Apr 2008 20:09:09 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Apr 2008 20:44:41 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-12] Using the @ symbol in the document ID causes strange results in CouchDB browser (under the _utils path)</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-12</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
1. Within the CouchDB browser interface (_utils) create a document with an&lt;br/&gt;
id of &lt;a href=&apos;mailto:johndoe@gmail.com&apos;&gt;johndoe@gmail.com&lt;/a&gt; - succeeds&lt;br/&gt;
2. Now try and do anything with that document through the browser&lt;br/&gt;
interface:  The path changes to question marks - you cannot delete the&lt;br/&gt;
document from the browser interface or add fields to the document&lt;br/&gt;
3.&lt;br/&gt;
&lt;br/&gt;
What is the expected output? What do you see instead?&lt;br/&gt;
Does not appear to be a valid document.&lt;br/&gt;
&lt;br/&gt;
What version of the product are you using? On what operating system?&lt;br/&gt;
Latest version 0.7xx from svn on Ubuntu&lt;br/&gt;
&lt;br/&gt;
Please provide any additional information below.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 1 by &lt;a href=&apos;mailto:Jer...@marzhillstudios.com&apos;&gt;Jer...@marzhillstudios.com&lt;/a&gt;, Nov 27, 2007&lt;br/&gt;
&lt;br/&gt;
This could be slightly related to the issue I just posted. I&apos;d imagine applying my&lt;br/&gt;
patch would give him an error message about the revision not applying.&lt;br/&gt;
&lt;br/&gt;
It sounds like the same problem that occurs when you click the next and previous&lt;br/&gt;
links for a document. since the @ symbol is how you request revisions couchdb will&lt;br/&gt;
misinterpret the document request as a document revision request.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 2 by &lt;a href=&apos;mailto:Jer...@marzhillstudios.com&apos;&gt;Jer...@marzhillstudios.com&lt;/a&gt;, Nov 27, 2007&lt;br/&gt;
&lt;br/&gt;
here is a patch that at least returns an error message and redirects to the database&lt;br/&gt;
page again.&lt;br/&gt;
&lt;br/&gt;
It doesn&apos;t tackle the real problem which is that an @ symbol is allowed unescaped in&lt;br/&gt;
a docid.&lt;br/&gt;
&lt;br/&gt;
Apologies but it includes my previous patch for the doc revision requests problem&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 4 by cmlenz, Feb 07, 2008&lt;br/&gt;
&lt;br/&gt;
Thanks for reporting this, I&apos;ll look into it.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12390564">COUCHDB-12</key>
        <summary>Using the @ symbol in the document ID causes strange results in CouchDB browser (under the _utils path)</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:50:56 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 11:43:35 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>Futon</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12588452" author="itay" created="Sun, 13 Apr 2008 23:11:26 +0000 (UTC)"  >Is there any update on this? This still happens on a project I am working on, and kind of renders Futon useless.&lt;br/&gt;
&lt;br/&gt;
Thanks!</comment>
                    <comment id="12589023" author="cmlenz" created="Tue, 15 Apr 2008 10:57:49 +0000 (UTC)"  >This has been fixed by merging the futon-async branch into trunk as of r648074.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Apr 2008 10:57:49 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 13 Apr 2008 23:11:26 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-11] CouchDB should handle errors when opening port gracefully</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-11</link>

                    <description>ATM CouchDB crashes loud and hard when it tries to open a port that is not&lt;br/&gt;
available. There should be some error handling code in place that produces&lt;br/&gt;
a nice message like so:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;Could not open port %d: %s&amp;quot; % (port_number, message)&lt;br/&gt;
&lt;br/&gt;
Obviously, the above is written in Python - but you get the idea.</description>
                <environment></environment>
            <key id="12390563">COUCHDB-11</key>
        <summary>CouchDB should handle errors when opening port gracefully</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:50:07 +0000 (UTC)</created>
    <updated>Sun, 25 Jan 2009 17:21:33 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12607538" author="cmlenz" created="Tue, 24 Jun 2008 09:47:15 +0000 (UTC)"  >See also duplicate &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-58&quot; title=&quot;CouchDB should print a friendly error if configure port not available&quot;&gt;&lt;strike&gt;COUCHDB-58&lt;/strike&gt;&lt;/a&gt;.</comment>
                    <comment id="12647517" author="jchris" created="Fri, 14 Nov 2008 04:15:17 +0000 (UTC)"  >The behavior seems to have gotten worse lately. Checking on this issue, for me, when I have CouchDB running on port 5984, and then I try to launch another copy also on the same port, I get no error at all.&lt;br/&gt;
&lt;br/&gt;
It may be helpful to note that if I start Couch A, and make a request, CouchA responds. Then when I start Couch B, and request again, Couch A still responds. &lt;br/&gt;
&lt;br/&gt;
OTOH, starting fresh from no couches, if I start Couch A, and then Couch B, and then make an http request, it goes to Couch B. Oh nevermind it&apos;s not that deterministic. I&apos;ll have to do more testing to see what happens (not that it matters).&lt;br/&gt;
&lt;br/&gt;
The easiest thing would be to make Couch fail fast and clear if it&apos;s port is already taken.</comment>
                    <comment id="12667107" author="jchris" created="Sun, 25 Jan 2009 17:21:33 +0000 (UTC)"  >This seems to have been fixed for a few weeks now. The failure message prints as:&lt;br/&gt;
&lt;br/&gt;
Failure to start Mochiweb: eaddrinuse&lt;br/&gt;
&lt;br/&gt;
Which is not the prettiest, but will work for any Mochiweb error. We could add a lookup table with pretty error message, but for now I think this is informative enough.</comment>
                </comments>
    
    <issuelinks>
                <issuelinktype id="10030">
            <name>Reference</name>
                                        <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12407814">COUCHDB-153</issuekey>
        </issuelink>
                    </inwardlinks>
                    </issuelinktype>
            </issuelinks>
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 Jan 2009 17:21:33 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 24 Jun 2008 09:47:15 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-10] Creating a view with an unknown content type should return 415 Unsupported Media Type</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-10</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
1. Create a view using an unsupported content type&lt;br/&gt;
2. Server returns a 500 response&lt;br/&gt;
&lt;br/&gt;
What is the expected output? What do you see instead?&lt;br/&gt;
Server to return a 415 Unsupported Media Type response</description>
                <environment></environment>
            <key id="12390562">COUCHDB-10</key>
        <summary>Creating a view with an unknown content type should return 415 Unsupported Media Type</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="3" iconUrl="http://issues.apache.org/jira/images/icons/priority_major.gif">Major</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:49:44 +0000 (UTC)</created>
    <updated>Sun, 25 May 2008 23:25:27 +0000 (UTC)</updated>

                
                
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599738" author="cmlenz" created="Sun, 25 May 2008 23:25:27 +0000 (UTC)"  >As CouchDB no longer allows specification of the view server via a MIME type, this request makes no sense anymore.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:25:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:25:27 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-9]     Support application/javascript for views out of the box</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-9</link>

                    <description>What steps will reproduce the problem?&lt;br/&gt;
1. Create a view with the content type application/javascript without&lt;br/&gt;
editing couch.ini&lt;br/&gt;
&lt;br/&gt;
What is the expected output? What do you see instead?&lt;br/&gt;
Support application/javascript and application/ecmascript out of the box&lt;br/&gt;
since it&apos;s now the recommended MIME types for Javascript. Note that this&lt;br/&gt;
also includes the optional charset parameter.&lt;br/&gt;
&lt;br/&gt;
What version of the product are you using? On what operating system?&lt;br/&gt;
trunk&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Quite a few Ajatus users are reporting this issue... For example:&lt;br/&gt;
&lt;a href=&quot;http://jaiku.com/channel/ajatus/presence/20256271&quot;&gt;http://jaiku.com/channel/ajatus/presence/20256271&lt;/a&gt;</description>
                <environment></environment>
            <key id="12390561">COUCHDB-9</key>
        <summary>    Support application/javascript for views out of the box</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:49:14 +0000 (UTC)</created>
    <updated>Mon, 26 May 2008 09:19:06 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599795" author="cmlenz" created="Mon, 26 May 2008 09:19:06 +0000 (UTC)"  >View servers/languages no longer map to MIME types. See &lt;a href=&quot;http://markmail.org/message/h54f3axl2hnk62jv&quot;&gt;http://markmail.org/message/h54f3axl2hnk62jv&lt;/a&gt;</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:19:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:19:06 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-8] 201 Creates responses to POST requests should contain a Location HTTP header</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-8</link>

                    <description>201 POST requests create new documents at a server-defined URI, and that URI should be communicated to HTTP clients via the Location header.</description>
                <environment></environment>
            <key id="12390560">COUCHDB-8</key>
        <summary>201 Creates responses to POST requests should contain a Location HTTP header</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:48:40 +0000 (UTC)</created>
    <updated>Fri, 30 Jan 2009 01:41:09 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12666715" author="janl" created="Fri, 23 Jan 2009 21:17:29 +0000 (UTC)"  >flag for 0.9 since this changes the API (albeit in an additional fashion, it&apos;d be nice to have that rock solid).</comment>
                    <comment id="12668701" author="jchris" created="Fri, 30 Jan 2009 01:40:58 +0000 (UTC)"  >fixed in r739133</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 30 Jan 2009 01:40:58 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 23 Jan 2009 21:17:29 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-7] couchdb.com should redirect to couchdb.org</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-7</link>

                    <description>couchdb.com and any other domains should redirect nicely to couchdb.org.&lt;br/&gt;
&lt;br/&gt;
This is so:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;1. There is only one canonical URI for each resource.&lt;br/&gt;
&amp;nbsp;2. To make sure that maximum google/delicious/dig/reddit juice is gained.</description>
                <environment></environment>
            <key id="12390559">COUCHDB-7</key>
        <summary>couchdb.com should redirect to couchdb.org</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:47:55 +0000 (UTC)</created>
    <updated>Mon, 26 May 2008 09:09:31 +0000 (UTC)</updated>

                
                
                        <component>Infrastructure</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599792" author="cmlenz" created="Mon, 26 May 2008 09:09:31 +0000 (UTC)"  >Both couchdb.org and couchdb.com now redirect to the new &lt;a href=&quot;http://incubator.apache.org/couchdb/&quot;&gt;http://incubator.apache.org/couchdb/&lt;/a&gt; site.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:09:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:09:31 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-6]     _utils/couch_tests.html does not work behind a reverse proxy</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-6</link>

                    <description>&amp;quot;CouchDb Tests&lt;br/&gt;
&lt;br/&gt;
This is a document that loads up CouchDb javascript tests.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
is displayed, but no tests running (no dots, no success message).&lt;br/&gt;
errorconsole in firebug gives an error on parseJSON, line 291, but no&lt;br/&gt;
further error description.&lt;br/&gt;
&lt;br/&gt;
only tested with nginx (proxy_pass &lt;a href=&quot;http://127.0.0.1:8888;)&quot;&gt;http://127.0.0.1:8888;)&lt;/a&gt;. not sure if&lt;br/&gt;
it&apos;s really a couchdb bug.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 2 by cmlenz, Feb 07, 2008&lt;br/&gt;
&lt;br/&gt;
This works for me in 0.7.2 with a properly configured Apache2/mod_proxy setup (including ProxyPassReverse, &lt;br/&gt;
not sure how it works with nginx), except for the replication tests (but I think that&apos;s because I&apos;ve put the proxy &lt;br/&gt;
behind digest authentication).&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12390558">COUCHDB-6</key>
        <summary>    _utils/couch_tests.html does not work behind a reverse proxy</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="5">Cannot Reproduce</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:47:23 +0000 (UTC)</created>
    <updated>Sun, 25 May 2008 23:26:45 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599739" author="cmlenz" created="Sun, 25 May 2008 23:26:45 +0000 (UTC)"  >Closing this as we got no further feedback, and this &amp;quot;worksforme&amp;quot;.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:26:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:26:45 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-5] Implement COPY and MOVE HTTP methods</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-5</link>

                    <description>and use proper HTTP response codes and all that&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 2 by nslater, Oct 04, 2007&lt;br/&gt;
&lt;br/&gt;
I would like to see a MOVE operation result in a Permanent Redirect being returned&lt;br/&gt;
for the original location until such time as the original location is overwritten&lt;br/&gt;
with a new document.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12390557">COUCHDB-5</key>
        <summary>Implement COPY and MOVE HTTP methods</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:46:38 +0000 (UTC)</created>
    <updated>Tue, 9 Sep 2008 10:27:23 +0000 (UTC)</updated>

                
                        <fixVersion>0.9</fixVersion>
            
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12581213" author="bcalder" created="Fri, 21 Mar 2008 23:02:54 +0000 (UTC)"  >Perhaps implemented with a user modifiable reserved key (no MOVE operation required).  301 seems to be the most important.  A query-string option could be set to perform operations on the &amp;quot;moved&amp;quot; document.</comment>
                    <comment id="12629438" author="janl" created="Tue, 9 Sep 2008 10:27:23 +0000 (UTC)"  >Added as of r685171</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 9 Sep 2008 10:27:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Fri, 21 Mar 2008 23:02:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-4] Use HTTP Etags for cache support</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-4</link>

                    <description>CouchDb currently puts a number of headers in HTTP responses that disable&lt;br/&gt;
any caching. However, the docid and rev that are part of every document&lt;br/&gt;
would make it extremely easy to instead generate solid Etag headers, and&lt;br/&gt;
then return 204 Not Modified responses for GET and HEAD requests if the&lt;br/&gt;
client sends along the most current Etag value.&lt;br/&gt;
&lt;br/&gt;
For example, instead of:&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Sat, 15 Sep 2007 11:21:41 GMT&lt;br/&gt;
Cache-Control: no-cache&lt;br/&gt;
Pragma: no-cache&lt;br/&gt;
Expires: Sat, 15 Sep 2007 11:21:41 GMT&lt;br/&gt;
&lt;br/&gt;
CouchDB should return something like:&lt;br/&gt;
&lt;br/&gt;
HTTP/1.1 200 OK&lt;br/&gt;
Server: inets/develop&lt;br/&gt;
Date: Sat, 15 Sep 2007 11:21:41 GMT&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
Etag: ${docid}@${rev}&lt;br/&gt;
&lt;br/&gt;
Sufficiently sophisticated clients (such as Python httplib2) could then use&lt;br/&gt;
If-None-Match to perform conditional GET requests.&lt;br/&gt;
&lt;br/&gt;
Thinking about it again, as the docid is already in the URL, only the rev&lt;br/&gt;
is needed in the Etag headers.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 1 by &lt;a href=&apos;mailto:cml...@gmx.de&apos;&gt;cml...@gmx.de&lt;/a&gt;, Oct 01, 2007&lt;br/&gt;
&lt;br/&gt;
See also &lt;a href=&quot;http://intertwingly.net/blog/2007/09/24/Tests-Id-Like-CouchDB-to-Pass#etag&quot;&gt;http://intertwingly.net/blog/2007/09/24/Tests-Id-Like-CouchDB-to-Pass#etag&lt;/a&gt;&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12390556">COUCHDB-4</key>
        <summary>Use HTTP Etags for cache support</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="1" iconUrl="http://issues.apache.org/jira/images/icons/priority_blocker.gif">Blocker</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="jchris">Chris Anderson</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:45:48 +0000 (UTC)</created>
    <updated>Wed, 12 Aug 2009 03:21:24 +0000 (UTC)</updated>

                
                        <fixVersion>0.11</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599798" author="cmlenz" created="Mon, 26 May 2008 09:28:54 +0000 (UTC)"  >This is done for documents, but it would be nice to have for other resources, too. Views, most importantly.</comment>
                    <comment id="12629439" author="janl" created="Tue, 9 Sep 2008 10:27:41 +0000 (UTC)"  >long time ago</comment>
                    <comment id="12629451" author="cmlenz" created="Tue, 9 Sep 2008 11:28:03 +0000 (UTC)"  >But, there&apos;s no Etag support for views yet, only documents. I think having cacheable views is pretty important.</comment>
                    <comment id="12666749" author="janl" created="Fri, 23 Jan 2009 22:23:18 +0000 (UTC)"  >Mark this blocking for 0.9. I believe Chris is working on this.</comment>
                    <comment id="12666757" author="antonyblakey" created="Fri, 23 Jan 2009 22:31:35 +0000 (UTC)"  >This wouldn&apos;t be theoretically secure unless the etag include a UUID for the database, assigned when a database is created. That&apos;s the equivalent of a _rev for the database.&lt;br/&gt;
&lt;br/&gt;
I wonder about the guarantee on _revs: If I delete a document and then recreate it, is there any possibility of a &apos;reuse&apos; of _rev? I would have hoped not. In which case, is that uniqueness scoped to the database or is it universal? This affects my first point.</comment>
                    <comment id="12673745" author="jchris" created="Sun, 15 Feb 2009 20:38:03 +0000 (UTC)"  >Closed r744747&lt;br/&gt;
&lt;br/&gt;
View etags are now provided. See note in the source about how they could be more efficient. Changes arity on make_view_fold_fun etc. Closes &lt;a href=&quot;http://issues.apache.org/jira/browse/COUCHDB-4&quot; title=&quot;Use HTTP Etags for cache support&quot;&gt;&lt;strike&gt;COUCHDB-4&lt;/strike&gt;&lt;/a&gt;&lt;br/&gt;
</comment>
                    <comment id="12688643" author="emgee" created="Tue, 24 Mar 2009 11:18:48 +0000 (UTC)"  >The view etags are not unique enough to work correctly. If a database is deleted and created with the same name, and the same number of documents is added then the etag does not change and caching breaks. There needs to be some database uid included in the etag.&lt;br/&gt;
&lt;br/&gt;
$ curl -X &amp;quot;PUT&amp;quot; &lt;a href=&quot;http://localhost:5984/test&quot;&gt;http://localhost:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X &amp;quot;POST&amp;quot; -d &amp;quot;{}&amp;quot; &lt;a href=&quot;http://localhost:5984/test&quot;&gt;http://localhost:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;9a59fd2772c04b75b9584fe48227e55b&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-2431529710&amp;quot;}&lt;br/&gt;
$ nc localhost 5984&lt;br/&gt;
GET /test/_all_docs HTTP/1.0&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 200 OK&lt;br/&gt;
Server: CouchDB/0.9.0a (Erlang OTP/R12B)&lt;br/&gt;
Etag: &amp;quot;40KWB93PS9PRNQP491WC04H50&amp;quot;&lt;br/&gt;
Date: Tue, 24 Mar 2009 10:51:27 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;9a59fd2772c04b75b9584fe48227e55b&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;9a59fd2772c04b75b9584fe48227e55b&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-2431529710&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
$ curl -X &amp;quot;DELETE&amp;quot; &lt;a href=&quot;http://localhost:5984/test&quot;&gt;http://localhost:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X &amp;quot;PUT&amp;quot; &lt;a href=&quot;http://localhost:5984/test&quot;&gt;http://localhost:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true}&lt;br/&gt;
$ curl -X &amp;quot;POST&amp;quot; -d &amp;quot;{}&amp;quot; &lt;a href=&quot;http://localhost:5984/test&quot;&gt;http://localhost:5984/test&lt;/a&gt;&lt;br/&gt;
{&amp;quot;ok&amp;quot;:true,&amp;quot;id&amp;quot;:&amp;quot;6c4e1a7b9a8442beaa6065489bfe0d0b&amp;quot;,&amp;quot;rev&amp;quot;:&amp;quot;1-4205788982&amp;quot;}&lt;br/&gt;
$ nc localhost 5984&lt;br/&gt;
GET /test/_all_docs HTTP/1.0&lt;br/&gt;
&lt;br/&gt;
HTTP/1.0 200 OK&lt;br/&gt;
Server: CouchDB/0.9.0a (Erlang OTP/R12B)&lt;br/&gt;
Etag: &amp;quot;40KWB93PS9PRNQP491WC04H50&amp;quot;&lt;br/&gt;
Date: Tue, 24 Mar 2009 10:52:01 GMT&lt;br/&gt;
Content-Type: text/plain;charset=utf-8&lt;br/&gt;
Cache-Control: must-revalidate&lt;br/&gt;
&lt;br/&gt;
{&amp;quot;total_rows&amp;quot;:1,&amp;quot;offset&amp;quot;:0,&amp;quot;rows&amp;quot;:[&lt;br/&gt;
{&amp;quot;id&amp;quot;:&amp;quot;6c4e1a7b9a8442beaa6065489bfe0d0b&amp;quot;,&amp;quot;key&amp;quot;:&amp;quot;6c4e1a7b9a8442beaa6065489bfe0d0b&amp;quot;,&amp;quot;value&amp;quot;:{&amp;quot;rev&amp;quot;:&amp;quot;1-4205788982&amp;quot;}}&lt;br/&gt;
]}&lt;br/&gt;
</comment>
                    <comment id="12688650" author="janl" created="Tue, 24 Mar 2009 11:38:28 +0000 (UTC)"  >Reopening per user request. Matt, can you provide a javascript test suite file that reproduces the issue?</comment>
                    <comment id="12689728" author="emgee" created="Thu, 26 Mar 2009 23:24:16 +0000 (UTC)"  >Add the following to the end of the etags_views test.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;// A new database should have unique view etags.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.createDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.save({a: 1});&lt;br/&gt;
&amp;nbsp;&amp;nbsp;xhr = CouchDB.request(&amp;quot;GET&amp;quot;, &amp;quot;/test_suite_db/_all_docs&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;var etag = xhr.getResponseHeader(&amp;quot;etag&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.deleteDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.createDb();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;db.save({a: 2});&lt;br/&gt;
&amp;nbsp;&amp;nbsp;xhr = CouchDB.request(&amp;quot;GET&amp;quot;, &amp;quot;/test_suite_db/_all_docs&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;T(etag != xhr.getResponseHeader(&amp;quot;etag&amp;quot;));&lt;br/&gt;
</comment>
                    <comment id="12742158" author="janl" created="Wed, 12 Aug 2009 00:53:04 +0000 (UTC)"  >bump to 0.11</comment>
                    <comment id="12742195" author="jchris" created="Wed, 12 Aug 2009 03:21:24 +0000 (UTC)"  >closed in r803358&lt;br/&gt;
&lt;br/&gt;
thanks for the tests, Matt!</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Wed, 12 Aug 2009 03:21:24 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 26 May 2008 09:28:54 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-3] Does not seem to support HEAD</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-3</link>

                    <description>The HTTP verb HEAD is like GET except the body of the response is omitted.&lt;br/&gt;
I wanted to use HEAD to check whether a document exists without downloading&lt;br/&gt;
the whole thing, but it does not appear to be supported?I get an error&lt;br/&gt;
trace instead.&lt;br/&gt;
&lt;br/&gt;
--Jan: Correct, this is not yet supported.&lt;br/&gt;
&lt;br/&gt;
--cmlenz: See also 646C2A4C7B8E6B6A6FFA36171F78158C.&lt;br/&gt;
&lt;br/&gt;
--Jan: sorry, reference deleted.</description>
                <environment></environment>
            <key id="12390555">COUCHDB-3</key>
        <summary>Does not seem to support HEAD</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="cmlenz">Christopher Lenz</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:45:00 +0000 (UTC)</created>
    <updated>Fri, 6 Jun 2008 11:09:53 +0000 (UTC)</updated>

                        <version>0.7.2</version>
            
                        <fixVersion>0.8</fixVersion>
            
                        <component>HTTP Interface</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12588785" author="cmlenz" created="Mon, 14 Apr 2008 20:44:10 +0000 (UTC)"  >The mochiweb branch has full support for the HEAD method.</comment>
                    <comment id="12589213" author="cmlenz" created="Tue, 15 Apr 2008 20:08:22 +0000 (UTC)"  >And now that the mochiweb branch has landed, this is also fixed in trunk.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 15 Apr 2008 20:08:22 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Mon, 14 Apr 2008 20:44:10 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-2] Socket errors under high load</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-2</link>

                    <description>Doing some basic load testing with ab, I found that on my machine (amd64,&lt;br/&gt;
ubuntu feisty, couch svn r186), couch starts encountering socket errors at&lt;br/&gt;
concurrency levels above 600. Example:&lt;br/&gt;
&lt;br/&gt;
ab -n 1000 -c 600 &lt;a href=&quot;http://localhost:8888/ab_test/hello.txt&quot;&gt;http://localhost:8888/ab_test/hello.txt&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Yields 1000 successful requests, but if I bump -c up to 700, requests start&lt;br/&gt;
to fail with errors like:&lt;br/&gt;
&lt;br/&gt;
[info] [&amp;lt;0.21516.0&amp;gt;] HTTP Error (code 500): {obj,[{error,{obj,&lt;br/&gt;
[{id,&amp;quot;EXIT&amp;quot;}, {reason,&lt;br/&gt;
&amp;quot;{{badmatch,socketclosed},[{modcouch,sendjson,4},{modcouch,do,1},{httpdresponse,traversemodules,2},{httpdresponse,generateandsendresponse,1},{httpdrequesthandler,handleresponse,1},{genserver,handlemsg,6},{proclib,init_p,5}]}&amp;quot;}]}}]}&lt;br/&gt;
&lt;br/&gt;
Is there any other testing I can do or information I can provide to help&lt;br/&gt;
track down the problem?&lt;br/&gt;
&lt;br/&gt;
(Hit enter before entering my email, sorry: jpellerin at gmail d com)&lt;br/&gt;
&lt;br/&gt;
--Jan:&lt;br/&gt;
&lt;br/&gt;
You&apos;re likely to hit an OS limit there.&lt;br/&gt;
&lt;br/&gt;
-- JP:&lt;br/&gt;
&lt;br/&gt;
I don&apos;t think so, since I haven&apos;t seen this with yaws under equivalent&lt;br/&gt;
load. Yaws can handle up to my system&apos;s max open files without failing, and&lt;br/&gt;
when it hits that, ab itself fails, not yaws. In this case yaws is running&lt;br/&gt;
a simple appmod that loads a file from a mnesia table:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&apos;mailto:jhp@jpdesk&apos;&gt;jhp@jpdesk&lt;/a&gt;:~/work/cloud/nimbus$ ab -n 10000 -c 1000&lt;br/&gt;
&lt;a href=&quot;http://localhost:8002/content/hello.txt&quot;&gt;http://localhost:8002/content/hello.txt&lt;/a&gt; This is ApacheBench, Version&lt;br/&gt;
2.0.40-dev &amp;lt;$Revision: 1.146 $&amp;gt; apache-2.0 Copyright 1996 Adam Twiss, Zeus&lt;br/&gt;
Technology Ltd, &lt;a href=&quot;http://www.zeustech.net/&quot;&gt;http://www.zeustech.net/&lt;/a&gt; Copyright 2006 The Apache Software&lt;br/&gt;
Foundation, &lt;a href=&quot;http://www.apache.org/&quot;&gt;http://www.apache.org/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Benchmarking localhost (be patient) [...] Finished 10000 requests&lt;br/&gt;
&lt;br/&gt;
Server Software: Yaws/1.68 Server Hostname: localhost Server Port: 8002&lt;br/&gt;
&lt;br/&gt;
Document Path: /content/hello.txt Document Length: 6 bytes&lt;br/&gt;
&lt;br/&gt;
Concurrency Level: 1000 Time taken for tests: 7.244038 seconds Complete&lt;br/&gt;
requests: 10000 Failed requests: 0 Write errors: 0&lt;br/&gt;
&lt;br/&gt;
(etc), with no errors in yaws itself. So I believe this is a bug in couchDB&lt;br/&gt;
or couch_inets, not a configuration issue.&lt;br/&gt;
&lt;br/&gt;
--Jan&lt;br/&gt;
&lt;br/&gt;
Thanks for the detailed analysis! We&apos;re on it.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 1 by damienkatz, Sep 26, 2007&lt;br/&gt;
&lt;br/&gt;
Can someone check and see how the performance of the standard Erlang inets http server holds up under the &lt;br/&gt;
same stress test? That&apos;s what CouchDB is using, and it would be very helpful to see if that&apos;s the limiting factor.&lt;br/&gt;
&lt;br/&gt;
In which case we might need to switch to YAWS or another erlang http implementation.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Comment 2 by damienkatz, Sep 28, 2007&lt;br/&gt;
&lt;br/&gt;
This bug needs test code before it can be verified.&lt;br/&gt;
&lt;br/&gt;
Either the original test code, or new test code written in Erlang would be good too.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12390554">COUCHDB-2</key>
        <summary>Socket errors under high load</summary>

            <type id="1" iconUrl="http://issues.apache.org/jira/images/icons/bug.gif">Bug</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="6" iconUrl="http://issues.apache.org/jira/images/icons/status_closed.gif">Closed</status>
                        <resolution id="6">Invalid</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:44:12 +0000 (UTC)</created>
    <updated>Tue, 27 May 2008 16:07:52 +0000 (UTC)</updated>

                
                
                
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12600167" author="janl" created="Tue, 27 May 2008 16:07:52 +0000 (UTC)"  >This is related to the inets http server CouchDB used to use. It has since switched to mochiweb and a similar issue has yet to be reported. Closing as invalid.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 27 May 2008 16:07:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Tue, 27 May 2008 16:07:52 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>

<item>
<title>[COUCHDB-1] MIME types for attachments</title>
<link>http://issues.apache.org/jira/browse/COUCHDB-1</link>

                    <description>There is AFAICT currently no standard way to associate a MIME type with&lt;br/&gt;
attachments. This is needed for CouchDB to be able to serve the attachment&lt;br/&gt;
with the correct Content-Type header.&lt;br/&gt;
&lt;br/&gt;
There&apos;s already a type field in the attachment JSON structure, which I&apos;d&lt;br/&gt;
suggest should be renamed to encoding, as it&apos;s intended to determine how&lt;br/&gt;
the content has been encoded in the JSON data (for example &amp;quot;base64&amp;quot;). With&lt;br/&gt;
that out of the way, the type field should contain the MIME type. When an&lt;br/&gt;
attachment is added, the client should be able to specify the MIME type&lt;br/&gt;
using this field, but CouchDB could use a sane default&lt;br/&gt;
(&amp;quot;application/octet-stream&amp;quot;) if the field is missing.</description>
                <environment></environment>
            <key id="12390553">COUCHDB-1</key>
        <summary>MIME types for attachments</summary>

            <type id="4" iconUrl="http://issues.apache.org/jira/images/icons/improvement.gif">Improvement</type>

    
            <priority id="4" iconUrl="http://issues.apache.org/jira/images/icons/priority_minor.gif">Minor</priority>    
        <status id="5" iconUrl="http://issues.apache.org/jira/images/icons/status_resolved.gif">Resolved</status>
                        <resolution id="1">Fixed</resolution>
            
    
                        <assignee username="-1">Unassigned</assignee>
            
                        <reporter username="nslater">Noah Slater</reporter>
            
    <created>Sat, 8 Mar 2008 23:42:31 +0000 (UTC)</created>
    <updated>Sun, 25 May 2008 23:24:00 +0000 (UTC)</updated>

                
                
                        <component>Database Core</component>
            
            <due></due>
    
            <votes>0</votes>
    
                                        

            <comments>
                    <comment id="12599736" author="cmlenz" created="Sun, 25 May 2008 23:24:00 +0000 (UTC)"  >Attachments now have a &amp;quot;content-type&amp;quot; field that&apos;s used as the Content-Type when retrieved. Not sure when it was added, but it&apos;s there.</comment>
                </comments>
    
    <attachments>
        </attachments>

    <subtasks>
        </subtasks>

            <customfields>
                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                    <customfieldname>Time in Status</customfieldname>
                    <customfieldvalues>
                        
                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310221" key="com.atlassian.jira.ext.charting:resolutiondate">
                    <customfieldname>Resolution Date</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:24:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                    <customfieldname>Date of First Response</customfieldname>
                    <customfieldvalues>
                        <customfieldvalue>Sun, 25 May 2008 23:24:00 +0000 (UTC)</customfieldvalue>

                    </customfieldvalues>
                </customfield>
                        </customfields>
    
</item>
</channel>
</rss>